!function(e){function t(r){if(_[r])return _[r].exports;var a=_[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var _={};t.m=e,t.c=_,t.d=function(e,_,r){t.o(e,_)||Object.defineProperty(e,_,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var _=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(_,"a",_),_},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=84)}([function(e,t,_){"use strict";var r=_(32),a={};t.a=function(e,t,_){function n(){return function(e){return e=e||"__b4w_default",void 0!==o[e]?o[e]:(o[e]=i?{}:n(),t(e,o[e]),o[e])}}var o={},i="__"==e.split("").slice(0,2).join("");if(void 0!==a[e])return a[e];var s=i?n():n()();return r.a._n_module[e]=a[e]=s,s}},function(e,t,_){"use strict";function r(e,t){function _(e,t){var _=[];e[0].indexOf("%c")>-1?_.push(e[0].replace("%c","%c"+t+": ")):_.push(t+": "+e[0]);for(var r=1;r<e.length;r++)_.push(e[r]);return _}function r(){i++;var e=_(arguments,"B4W ERROR");console.error.apply(console,e)}function a(e){e in E||(E[e]=e,r([e]))}function n(e,t){a(e+"() is deprecated, use "+t+"() instead.")}var o=!1,i=0,s=0,E={};t.set_verbose=function(e){o=e},t.log_raw=function(){console.log.apply(console,arguments)},t.log=function(){if(o){var e=_(arguments,"B4W LOG");console.log.apply(console,e)}},t.compose_args_prefix=_,t.error=r,t.error_once=a,t.error_deprecated=n,t.error_deprecated_arr=function(e,t){switch(t.length>1){case!0:a(e+"() is deprecated, use "+t.slice(0,-1).join("(), ")+"() or "+t[t.length-1]+"() instead.");break;case!1:n(e,t[0])}},t.error_deprecated_cfg=function(e,t){a(void 0===t?'Config option "'+e+'" is deprecated.':'Config option "'+e+'" is deprecated, use "'+t+'" instead.')},t.warn=function(){s++;var e=_(arguments,"B4W WARN");console.warn.apply(console,e)},t.info=function(){var e=_(arguments,"B4W INFO");console.info.apply(console,e)},t.export_error=function(){i++;var e=_(arguments,"B4W EXPORT ERROR");console.error.apply(console,e)},t.export_warn=function(){s++;var e=_(arguments,"B4W EXPORT WARNING");console.warn.apply(console,e)},t.time=function(){o&&console.time.apply(console,arguments)},t.timeEnd=function(){o&&console.timeEnd.apply(console,arguments)},t.group=function(){console.group.apply(console,arguments)},t.groupCollapsed=function(){console.groupCollapsed.apply(console,arguments)},t.groupEnd=function(){console.groupEnd.apply(console,arguments)},t.clear=function(){"function"==typeof console.clear&&console.clear.apply(console,arguments)},t.get_warning_count=function(){return s},t.get_error_count=function(){return i},t.clear_errors_warnings=function(){s=0,i=0}}var a=_(0),n=Object(a.a)("print",r);Object(a.a)("__print",r),t.a=n},function(e,t,_){"use strict";function r(e){return void 0!==e}function a(e,t,_){for(var r=[],a=_.length,n=0;n<a;n++){var o=_[n];o[e]==t&&r.push(o)}return r}function n(e){return new Float32Array(e)}function o(e,t){var _=e.length,r=new Float32Array(_+t.length);return r.set(e),r.set(t,_),r}function i(e,t){var _=e.length,r=new Uint32Array(_+t.length);return r.set(e),r.set(t,_),r}function s(){var e=new Uint16Array([255]);return 255==new DataView(e.buffer).getUint16(0,!0)}function E(e,t){var _,r,a=[],n={},o=t.length;for(_=0;_<o;_++)n[t[_]]=!0;for(o=e.length,_=0;_<o;_++)(r=e[_])in n&&a.push(r);return a}function c(e){return e>0?1:e<0?-1:0}function l(e,t,_){for(var r=0;r<_.length;r++){var a=_[r];if(a[e]===t)return a}return null}function T(e,t,_){for(var r=0;r<e.length;r++)if(e[r][t]==_)return r;return-1}function d(e,t){for(var _=0;_<e.length;_++)if(e[_]==t)return;e.push(t)}function u(e,t,_,r){return r||(r=new Float32Array(16)),rt.identity(r),r[12]=e,r[13]=t,r[14]=_,r}function f(e){var t=Math.floor(e[0]/Jt),_=e[0]%Jt,r=Vt*_-Wt*t;return e[0]=r>0?r:r+qt,(e[0]-1)/(qt-1)}function P(e,t){return t||(t=[]),t[0]=zt+Math.floor(e),t}function A(e,t){var _=st;return _[0]=e[2],_[1]=e[1],_[2]=e[0],S(_,jt,t),t}function S(e,t,_){var r=e[0],a=e[1],n=e[2],o=Math.cos(r/2),i=Math.cos(a/2),s=Math.cos(n/2),E=Math.sin(r/2),c=Math.sin(a/2),l=Math.sin(n/2);if(Qt.indexOf(t)>-1)var T=Math.cos((r+n)/2),d=Math.sin((r+n)/2),u=Math.cos((r-n)/2),f=Math.sin((r-n)/2),P=Math.cos((n-r)/2),A=Math.sin((n-r)/2);switch(t){case Ut:_[0]=i*d,_[1]=c*u,_[2]=c*f,_[3]=i*T;break;case wt:_[0]=c*f,_[1]=i*d,_[2]=c*u,_[3]=i*T;break;case Ct:_[0]=c*u,_[1]=c*f,_[2]=i*d,_[3]=i*T;break;case Dt:_[0]=i*d,_[1]=c*A,_[2]=c*P,_[3]=i*T;break;case Ft:_[0]=c*P,_[1]=i*d,_[2]=c*A,_[3]=i*T;break;case Gt:_[0]=c*A,_[1]=c*P,_[2]=i*d,_[3]=i*T;break;case kt:_[0]=E*i*s+o*c*l,_[1]=o*c*s-E*i*l,_[2]=o*i*l+E*c*s,_[3]=o*i*s-E*c*l;break;case Kt:_[0]=o*i*l+E*c*s,_[1]=E*i*s+o*c*l,_[2]=o*c*s-E*i*l,_[3]=o*i*s-E*c*l;break;case Bt:_[0]=o*c*s-E*i*l,_[1]=o*i*l+E*c*s,_[2]=E*i*s+o*c*l,_[3]=o*i*s-E*c*l;break;case Xt:_[0]=E*i*s-o*c*l,_[1]=o*i*l-E*c*s,_[2]=o*c*s+E*i*l,_[3]=o*i*s+E*c*l;break;case Ht:_[0]=o*c*s+E*i*l,_[1]=E*i*s-o*c*l,_[2]=o*i*l-E*c*s,_[3]=o*i*s+E*c*l;break;case jt:_[0]=o*i*l-E*c*s,_[1]=o*c*s+E*i*l,_[2]=E*i*s-o*c*l,_[3]=o*i*s+E*c*l}return _}function p(e,t,_){var r=e[0],a=e[1],n=e[2],o=e[3];switch(t){case Ut:_[0]=Math.atan2(r*a+n*o,a*o-r*n),_[1]=Math.acos(1-2*(a*a+n*n)),_[2]=Math.atan2(r*a-n*o,r*n+a*o);break;case wt:_[0]=Math.atan2(r*o+a*n,n*o-r*a),_[1]=Math.acos(1-2*(r*r+n*n)),_[2]=Math.atan2(a*n-r*o,r*a+n*o);break;case Ct:_[0]=Math.atan2(r*n+a*o,r*o-a*n),_[1]=Math.acos(1-2*(r*r+a*a)),_[2]=Math.atan2(r*n-a*o,r*o+a*n);break;case Dt:_[0]=Math.atan2(r*n-a*o,r*a+n*o),_[1]=Math.acos(1-2*(a*a+n*n)),_[2]=Math.atan2(r*n+a*o,n*o-r*a);break;case Ft:_[0]=Math.atan2(r*a-n*o,r*o+a*n),_[1]=Math.acos(1-2*(r*r+n*n)),_[2]=Math.atan2(r*a+n*o,r*o-a*n);break;case Gt:_[0]=Math.atan2(a*n-r*o,r*n+a*o),_[1]=Math.acos(1-2*(r*r+a*a)),_[2]=Math.atan2(r*o+a*n,a*o-r*n);break;case kt:_[0]=Math.atan2(2*(r*o-a*n),1-2*(r*r+a*a)),_[1]=Math.asin(2*(r*n+a*o)),_[2]=Math.atan2(2*(n*o-r*a),1-2*(a*a+n*n));break;case Kt:var i=r*a+n*o;i>.499999?(_[0]=0,_[1]=Math.PI/2,_[2]=2*Math.atan2(r,o)):i<-.499999?(_[0]=0,_[1]=-Math.PI/2,_[2]=-2*Math.atan2(r,o)):(_[0]=Math.atan2(2*(a*o-r*n),1-2*(a*a+n*n)),_[1]=Math.asin(2*(r*a+n*o)),_[2]=Math.atan2(2*(r*o-a*n),1-2*(r*r+n*n)));break;case Bt:_[0]=Math.atan2(2*(n*o-r*a),1-2*(r*r+n*n)),_[1]=Math.asin(2*(r*o+a*n)),_[2]=Math.atan2(2*(a*o-r*n),1-2*(r*r+a*a));break;case Xt:_[0]=Math.atan2(2*(r*o+a*n),1-2*(r*r+n*n)),_[1]=Math.asin(2*(n*o-r*a)),_[2]=Math.atan2(2*(r*n+a*o),1-2*(a*a+n*n));break;case Ht:_[0]=Math.atan2(2*(r*n+a*o),1-2*(r*r+a*a)),_[1]=Math.asin(2*(r*o-a*n)),_[2]=Math.atan2(2*(r*a+n*o),1-2*(r*r+n*n));break;case jt:var i=a*o-r*n;i>.499999?(_[0]=0,_[1]=Math.PI/2,_[2]=-2*Math.atan2(n,o)):i<-.499999?(_[0]=0,_[1]=-Math.PI/2,_[2]=2*Math.atan2(n,o)):(_[0]=Math.atan2(2*(r*a+n*o),1-2*(a*a+n*n)),_[1]=Math.asin(2*(a*o-r*n)),_[2]=Math.atan2(2*(r*o+a*n),1-2*(r*r+a*a)))}return _}function O(e,t){var _=Math.cos(e[0]),r=Math.cos(e[1]),a=Math.cos(e[2]),n=Math.sin(e[0]),o=Math.sin(e[1]),i=Math.sin(e[2]),s=_*a,E=_*i,c=n*a,l=n*i;return t[0]=r*a,t[1]=r*i,t[2]=-o,t[3]=o*c-E,t[4]=o*l+s,t[5]=r*n,t[6]=o*s+l,t[7]=o*E-c,t[8]=r*_,t}function v(e,t){var _=p(e,jt,st);return t[0]=_[2],t[1]=_[1],t[2]=_[0],t}function m(e,t,_){return _||(_=new Float32Array(3)),ot.transformQuat(t,e,_),_}function N(e,t,_){_||(_=new Float32Array(4)),e=ot.normalize(e,st);var r=ot.dot(t,e),a=ot.cross(t,e,Et),n=Math.acos(r);return _[0]=a[0]*Math.sin(n/2),_[1]=a[1]*Math.sin(n/2),_[2]=a[2]*Math.sin(n/2),_[3]=Math.cos(n/2),_}function g(e,t,_,r){return r||(r=new Float32Array(4)),ot.transformQuat(_,t,r),r[3]=-ot.dot(e,r),r}function R(e,t,_,r){if(0==_)return e;r=r||[];for(var a=0;a<e.length;a++)r[a]=(1-_)*e[a]+_*t[a];return r}function I(e){if(!(e instanceof Object))return e;var t,_=e.constructor;switch(_){case Int8Array:case Uint8Array:case Uint8ClampedArray:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:t=new _(e);break;case Array:t=new _(e.length);for(var r=0;r<e.length;r++)t[r]=I(e[r]);break;default:t=new _;for(var a in e)e.hasOwnProperty(a)&&(t[a]=I(e[a]))}return t}function b(e){var t=e instanceof Array?[]:{};for(var _ in e)if(e.hasOwnProperty(_))if(e[_]instanceof Object){var r=e[_].constructor;switch(r){case Int8Array:case Uint8Array:case Uint8ClampedArray:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:t[_]=new r(e[_]);break;case Array:t[_]=e[_].slice(0);break;default:t[_]=e[_]}}else t[_]=e[_];return t}function h(e,t){t||(t=new Float32Array(4)),_t.fromMat4(e,St);var _=St[0],r=St[3],a=St[6],n=St[1],o=St[4],i=St[7],s=St[2],E=St[5],c=St[8],l=Math.sqrt(_*_+r*r+a*a)||1,T=Math.sqrt(n*n+o*o+i*i)||1,d=Math.sqrt(s*s+E*E+c*c)||1;return St[0]/=l,St[3]/=l,St[6]/=l,St[1]/=T,St[4]/=T,St[7]/=T,St[2]/=d,St[5]/=d,St[8]/=d,nt.fromMat3(St,t),nt.normalize(t,t),t}function Y(e,t){return t||(t=new Float32Array(3)),t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function L(e){return Pt[0]=.577350269189626,Pt[1]=.577350269189626,Pt[2]=.577350269189626,Pt[3]=0,it.transformMat4(Pt,e,Pt),it.length(Pt)}function M(e,t){var _=t.left,r=t.right,a=t.top,n=t.bottom,o=t.near,i=t.far;return _[0]=e[3]+e[0],_[1]=e[7]+e[4],_[2]=e[11]+e[8],_[3]=e[15]+e[12],r[0]=e[3]-e[0],r[1]=e[7]-e[4],r[2]=e[11]-e[8],r[3]=e[15]-e[12],a[0]=e[3]-e[1],a[1]=e[7]-e[5],a[2]=e[11]-e[9],a[3]=e[15]-e[13],n[0]=e[3]+e[1],n[1]=e[7]+e[5],n[2]=e[11]+e[9],n[3]=e[15]+e[13],o[0]=e[3]+e[2],o[1]=e[7]+e[6],o[2]=e[11]+e[10],o[3]=e[15]+e[14],i[0]=e[3]-e[2],i[1]=e[7]-e[6],i[2]=e[11]-e[10],i[3]=e[15]-e[14],x(_),x(r),x(a),x(n),x(o),x(i),t}function x(e){var t=e[0],_=e[1],r=e[2],a=e[3],n=Math.sqrt(t*t+_*_+r*r);n=1/n,e[0]=t*n,e[1]=_*n,e[2]=r*n,e[3]=a*n}function y(e,t,_){return _<-at.P(e,t.near)||_<-at.P(e,t.left)||_<-at.P(e,t.right)||_<-at.P(e,t.top)||_<-at.P(e,t.bottom)||_<-at.P(e,t.far)}function U(e,t,_,r,a){var n=ot.dot(_,t.far),o=ot.dot(r,t.far),i=ot.dot(a,t.far),s=Math.sqrt(n*n+o*o+i*i);return s<-at.P(e,t.near)||s<-at.P(e,t.far)||(n=ot.dot(_,t.left),o=ot.dot(r,t.left),i=ot.dot(a,t.left),Math.sqrt(n*n+o*o+i*i)<-at.P(e,t.left)||(n=ot.dot(_,t.right),o=ot.dot(r,t.right),i=ot.dot(a,t.right),Math.sqrt(n*n+o*o+i*i)<-at.P(e,t.right)||(n=ot.dot(_,t.top),o=ot.dot(r,t.top),i=ot.dot(a,t.top),Math.sqrt(n*n+o*o+i*i)<-at.P(e,t.top)||(n=ot.dot(_,t.bottom),o=ot.dot(r,t.bottom),i=ot.dot(a,t.bottom),Math.sqrt(n*n+o*o+i*i)<-at.P(e,t.bottom)))))}function w(e,t,_,r){r||(r=0);for(var a=e.length,n=0;n<a;n+=3){var o=e[n],i=e[n+1],s=e[n+2];_[r+n]=t[0]*o+t[4]*i+t[8]*s+t[12],_[r+n+1]=t[1]*o+t[5]*i+t[9]*s+t[13],_[r+n+2]=t[2]*o+t[6]*i+t[10]*s+t[14]}return _}function C(e,t,_,r){r=r||0;for(var a=e.length,n=Nt,o=0;o<a;o+=4){n[0]=e[o],n[1]=e[o+1],n[2]=e[o+2],n[3]=e[o+3];var i=n[3]>0;nt.multiply(t,n,n),(i&&n[3]<0||!i&&n[3]>0)&&it.scale(n,-1,n),_[r+o]=n[0],_[r+o+1]=n[1],_[r+o+2]=n[2],_[r+o+3]=n[3]}return _}function D(e,t,_){_||(_=new Float32Array(3));var r=Pt;r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=0,it.transformMat4(r,t,r),_[0]=r[0],_[1]=r[1],_[2]=r[2]}function F(e,t){t||(t=[]);for(var _=0;_<e.length;_+=3){var r=new Float32Array([e[_],e[_+1],e[_+2]]);t[_/3]=r}return t}function G(e,t,_,r){if(r<_)return _;var a=_+Math.floor((r-_)/2);return e[a]>t?G(e,t,_,a-1):e[a]<t?G(e,t,a+1,r):a}function k(e,t){for(var _=0;_<e.length;_++)if(e[_]!=t[_])return!1;return!0}function K(e,t,_,r,a){a||(a=new Float32Array(3));var n=rt.fromRotationTranslation(_,r,vt);if(1!==t){var o=rt.identity(mt),i=ot.set(t,t,t,st);rt.scale(o,i,o),rt.multiply(n,o,n)}return ot.transformMat4(e,n,a),a}function B(e,t,_,r){r||(r=new Float32Array(3));var a=st;ot.subtract(t,e,a),ot.transformQuat(a,_,a),ot.subtract(t,a,r)}function X(){var e=st;e[0]=0,e[1]=0,e[2]=0;var t=new Float32Array(16),_=new Float32Array(16),r=new Float32Array(16),a=new Float32Array(16),n=new Float32Array(16),o=new Float32Array(16);return rt.lookAt(e,[-1,0,0],[0,-1,0],t),rt.scale(t,[-1,1,1],t),rt.scale(t,[-1,1,-1],_),rt.lookAt(e,[0,-1,0],[0,0,-1],r),rt.scale(r,[1,1,-1],r),rt.scale(r,[1,-1,-1],a),rt.lookAt(e,[0,0,-1],[0,-1,0],n),rt.scale(n,[-1,1,1],n),rt.scale(n,[-1,1,-1],o),[t,_,r,a,n,o]}function H(){var e=st;e[0]=0,e[1]=0,e[2]=0;var t=new Float32Array(16),_=new Float32Array(16),r=new Float32Array(16),a=new Float32Array(16),n=new Float32Array(16),o=new Float32Array(16);return rt.lookAt(e,[1,0,0],[0,-1,0],t),rt.scale(t,[-1,1,-1],_),rt.lookAt(e,[0,1,0],[0,0,1],r),rt.scale(r,[1,-1,-1],a),rt.lookAt(e,[0,0,1],[0,-1,0],n),rt.scale(n,[-1,1,-1],o),[t,_,r,a,n,o]}function j(e,t){for(var _=t,r=0;r<e.length;r++){_=(_<<5)-_+e.charCodeAt(r),_&=_}return _}function Q(e,t){return t[15]=1,t[14]=0,t[13]=0,t[12]=0,t[11]=0,t[10]=e[8],t[9]=e[7],t[8]=e[6],t[7]=0,t[6]=e[5],t[5]=e[4],t[4]=e[3],t[3]=0,t[2]=e[2],t[1]=e[1],t[0]=e[0],t}function z(e,t){t||(t=e);var _=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];if(_>0){t[3]=2*Math.acos(e[3]);var r=1/Math.sqrt(_);t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r}else t[3]=0,t[0]=1,t[1]=0,t[2]=0;return t}function V(e){return(e*=34*e+1)%289}function q(e){return e-Math.floor(e)}function W(e){return isNaN(e)||void 0===e?NaN:0|e}function J(e){return e*Math.PI/180}function Z(e){return 180*e/Math.PI}function $(e){var t=.211324865405187,_=.366025403784439,r=-.577350269189626,a=.024390243902439,n=e[0]*_+e[1]*_,o=Math.floor(e[0]+n),i=Math.floor(e[1]+n),s=o*t+i*t,E=e[0]-o+s,c=e[1]-i+s,l=E>c?1:0,T=1-l,d=E+t-l,u=c+t-T,f=E+r,P=c+r;o%=289,i%=289;var A=V(V(i)+o),S=V(V(i+T)+o+l),p=V(V(i+1)+o+1),O=Math.max(.5-(E*E+c*c),0),v=Math.max(.5-(d*d+u*u),0),m=Math.max(.5-(f*f+P*P),0);O*=O*O*O,v*=v*v*v,m*=m*m*m;var N=2*q(A*a)-1,g=2*q(S*a)-1,R=2*q(p*a)-1,I=Math.abs(N)-.5,b=Math.abs(g)-.5,h=Math.abs(R)-.5,Y=Math.floor(N+.5),L=Math.floor(g+.5),M=Math.floor(R+.5),x=N-Y,y=g-L,U=R-M;return O*=1.79284291400159-.85373472095314*(x*x+I*I),v*=1.79284291400159-.85373472095314*(y*y+b*b),m*=1.79284291400159-.85373472095314*(U*U+h*h),130*(O*(x*E+I*c)+v*(y*d+b*u)+m*(U*f+h*P))}function ee(e){return te((34*e+5)*e)}function te(e){return e-289*Math.floor(e/289)}function _e(e){return e-7*Math.floor(e/7)}function re(e){var t=1/7,_=t/2,r=te(Math.floor(e[0])),a=te(Math.floor(e[1])),n=q(e[0]),o=q(e[1]),i=n-.5,s=n-1.5,E=i,c=s,l=o-.5,T=l,d=o-1.5,u=d,f=ee(r),P=ee(r+1),A=f,S=P;f=ee(f+a),P=ee(P+a),A=ee(A+a+1),S=ee(S+a+1);var p=_e(f)*t+_,O=_e(P)*t+_,v=_e(A)*t+_,m=_e(S)*t+_,N=_e(Math.floor(f*t))*t+_,g=_e(Math.floor(P*t))*t+_,R=_e(Math.floor(A*t))*t+_,I=_e(Math.floor(S*t))*t+_,b=i+.7*p,h=s+.7*O,Y=E+.7*v,L=c+.7*m,M=l+.7*N,x=T+.7*g,y=d+.7*R,U=u+.7*I,w=b*b+M*M,C=h*h+x*x,D=Y*Y+y*y,F=L*L+U*U;return Math.min(w,C,D,F)}function ae(e,t,_,r,a){a||(a=new Float32Array(4));var n=ot.transformQuat(t,e,st),o=_[0],i=_[1],s=_[2],E=St;return E[0]=i*i+s*s,E[1]=-i*o,E[2]=-s*o,E[3]=-o*i,E[4]=o*o+s*s,E[5]=-s*i,E[6]=-o*s,E[7]=-i*s,E[8]=o*o+i*i,ot.transformMat3(n,E,n),ot.normalize(n,n),nt.rotationTo(r,n,a),a}function ne(e,t){t||(t=new Float32Array(4));var _=Pt,r=At;return _=nt.setAxisAngle([0,0,1],Math.PI,nt.create()),r=nt.setAxisAngle([1,0,0],Math.PI/2,nt.create()),nt.multiply(_,r,_),nt.multiply(e,_,t),t}function oe(e,t,_){return e<t&&(e=t),e>_&&(e=_),e}function ie(e,t,_,r){if(r){var a=Math.exp(-_/r);return(1-a)*e+a*t}return e}function se(e,t,_,r,a){if(a||(a=new Float32Array(e.length)),r)for(var n=Math.exp(-_/r),o=0;o<a.length;o++)a[o]=(1-n)*e[o]+n*t[o];else ot.copy(e,a);return a}function Ee(e,t,_,r,a){if(a||(a=new Float32Array(e.length)),r){var n=Math.exp(-_/r);nt.slerp(e,t,n,a)}else nt.copy(e,a);return a}function ce(e){return!!("object"==typeof e&&e.buffer&&e.buffer instanceof ArrayBuffer)}function le(e,t){return!!(e instanceof Array||e.buffer&&e.buffer instanceof ArrayBuffer)&&(!(!t||t!=e.length)||!t)}function Te(e,t){var _=_t.fromQuat(e,St),r=st;r[0]=_[6],r[1]=_[7],r[2]=_[8];var a=ot.cross(Lt,r,r);ot.normalize(a,a);var n=_[4];!t&&n>0&&(a[0]*=-1,a[1]*=-1,a[2]*=-1);var o=Et;o[0]=_[0],o[1]=_[1],o[2]=_[2],ot.normalize(o,o);var i=At;nt.rotationTo(o,a,i),nt.multiply(i,e,e)}function de(e,t,_,r){var a=_*t-.5,n=r*t-.5,o=a-Math.floor(a),i=n-Math.floor(n);a=Math.floor(a),n=Math.floor(n);var s=t-1;return(e[n*t+a]*(1-o)+e[n*t+Math.min(a+1,s)]*o)*(1-i)+(e[Math.min(n+1,s)*t+a]*(1-o)+e[Math.min(n+1,s)*t+Math.min(a+1,s)]*o)*i}function ue(e){for(var t=0,_=0;_<3;_++)(e&1<<_)>0&&t++;return t}function fe(e){for(var t=[0,0,0],_=0;_<3;_++)(e&1<<_)>0&&(t[2-_]=1);return t}function Pe(e,t){var _=0;return 1!=t&&2!=t||(4&e)>0&&_++,2==t&&(2&e)>0&&_++,_}function Ae(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})}function Se(e){var t=0;for(var _ in e)e.hasOwnProperty(_)&&t++;return t}function pe(e){return e.length?e[Math.floor(Math.random()*e.length)]:null}function Oe(e,t,_){_||(_=new Float32Array(3)),_[0]=e[0]-t[0],_[1]=e[1]-t[1],_[2]=0,ot.normalize(_,_)}function ve(e,t,_){var r=e[0],a=e[1],n=e[2],o=t[0],i=t[1],s=t[2],E=t[3],c=i*n-s*a,l=s*r-o*n,T=o*a-i*r,d=i*T-s*l,u=s*c-o*T,f=o*l-i*c;return c*=2*E,l*=2*E,T*=2*E,d*=2,u*=2,f*=2,_[0]=r+c+d,_[1]=a+l+u,_[2]=n+T+f,_}function me(e,t,_){var r=e-t,a=_-t;return t+(r-Math.floor(r/a)*a)}function Ne(e){return me(e,0,2*Math.PI)}function ge(e,t){for(var _ in e){var r=!0,a=e[_],n=t[_];switch(typeof a){case"number":case"string":case"boolean":r=a==n;break;case"object":r=Re(a,n)}if(!r)return!1}return!0}function Re(e,t){if(e&&t){var _=e instanceof Array;if(_!=t instanceof Array)return!1;var r=e.buffer instanceof ArrayBuffer&&"undefined"!==e.byteLength;if(r!=(t.buffer instanceof ArrayBuffer&&"undefined"!==t.byteLength))return!1;if(_){if(e.length!=t.length)return!1;for(var a=0;a<e.length;a++)if(!Ie(e[a],t[a]))return!1}else if(r){if(e.length!=t.length)return!1;for(var a=0;a<e.length;a++)if(e[a]!=t[a])return!1}else{switch(e.constructor){case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLRenderbuffer:case WebGLTexture:case WebGLBuffer:return e==t}for(var n in e)if(!Ie(e[n],t[n]))return!1;for(var n in t)if(!(n in e))return!1}return!0}return!(e||t)}function Ie(e,t){if(typeof e!=typeof t)return!1;switch(typeof e){case"number":case"string":case"boolean":return e==t;case"object":return Re(e,t);default:return!0}}function be(e,t){var _=e[0],r=e[1],a=e[2],n=e[3];return t[0]=r,t[1]=a,t[2]=n,t[3]=_,t}function he(e,t,_,r){var a=Pt;a.set(e),a[3]=t;var n=At;st[0]=_[3],st[1]=_[4],st[2]=_[5],n.set(st),n[3]=0;var o=it.dot(a,n);if(0==o)return null;var i=At;ot.copy(_,st),i.set(st),i[3]=1;var s=it.dot(a,i),E=-s/o;return r[0]=_[0]+E*_[3],r[1]=_[1]+E*_[4],r[2]=_[2]+E*_[5],r}function Ye(e,t,_,r){var a=t[0]-e[0],n=_[0]-e[0],o=t[1]-e[1],i=_[1]-e[1],s=t[2]-e[2],E=_[2]-e[2];return r[0]=o*E-s*i,r[1]=n*s-a*E,r[2]=a*i-o*n,r}function Le(e,t,_){var r=st,a=ot.dot(e,t);return a<-.9999999?(ot.cross(ht,e,r),ot.length(r)<1e-6&&ot.cross(Yt,e,r),ot.normalize(r,r),nt.setAxisAngle(r,Math.PI,_)):(ot.cross(e,t,r),_.set(r),_[3]=1+a,nt.normalize(_,_)),_}function Me(e,t,_){if(t==_)return _-e;e=Ne(e),t=Ne(t),_=Ne(_);var r=2*Math.PI-t;if(t=0,_+=r,_=Ne(_),e+=r,(e=Ne(e))>_){var a=_-e,n=2*Math.PI-e;return-a>n?n:a}return 0}function xe(e,t,_){return isFinite(t)&&isFinite(_)&&(e=oe(e,t,_)),e*e*(3-2*e)}function ye(e,t,_){return t+e*(_-t)}function Ue(e,t){for(var _=0;_<e.length;_++)for(var r=0;r<t.length;r++)if(t[r]==e[_])return!0;return!1}function we(e,t){for(var _=Math.max(e.length,t.length),r=0;r<_;r++){var a=r>=e.length?0:e[r],n=r>=t.length?0:t[r],o=c(a-n);if(o)return o}return 0}function Ce(e){return e.join(".")}function De(e){return e.split(".").map(function(e){return 0|e})}function Fe(e,t){return t[0]=Math.pow(e[0],$t),t[1]=Math.pow(e[1],$t),t[2]=Math.pow(e[2],$t),t}function Ge(e,t){return t[0]=Math.pow(e[0],1/$t),t[1]=Math.pow(e[1],1/$t),t[2]=Math.pow(e[2],1/$t),t}function ke(e){return 0!=parseInt(e.toString(2).substr(1),2)}function Ke(e,t,_,r){return r[0]=e[0],r[1]=t[0],r[2]=_[0],r[3]=e[1],r[4]=t[1],r[5]=_[1],r[6]=e[2],r[7]=t[2],r[8]=_[2],r}function Be(){var e=[{}];return e.length=0,e}function Xe(e){var t=Math.round(32767.5*(e+1)-32768);return oe(t||0,-32768,32767)}function He(e){return oe((e+32768)/32767.5-1,-1,1)}function je(e){return oe(Math.round(255*e),0,255)}function Qe(e){return oe(e/255,0,1)}function ze(e,t,_,r){var a=ot.subtract(_,t,st),n=ot.subtract(r,_,Et),o=ot.subtract(t,r,ct),i=ot.subtract(e,t,lt),s=ot.subtract(e,_,Tt),E=ot.subtract(e,r,dt),c=ot.cross(a,n,ut);if(ot.dot(ot.cross(c,a,ft),i)>=0&&ot.dot(ot.cross(c,n,ft),s)>=0&&ot.dot(ot.cross(c,o,ft),E)>=0){var l=ot.length(c),T=ot.dot(c,i);return Math.abs(T/l)}var d=ot.scale(a,oe(ot.dot(a,i)/ot.length(a),0,1),ft),u=ot.length(ot.subtract(i,d,ft)),f=ot.scale(n,oe(ot.dot(n,s)/ot.length(n),0,1),ft),P=ot.length(ot.subtract(s,f,ft)),A=ot.scale(o,oe(ot.dot(o,E)/ot.length(o),0,1),ft),S=ot.length(ot.subtract(E,A,ft));return Math.min(Math.min(u,P),S)}function Ve(e,t,_,r,a){if(_||r){var n=nt.identity(Nt);if(_){var o=nt.setAxisAngle(t,_,gt);nt.multiply(n,o,n)}var i=nt.copy(e,a);if(r){var s=m(i,ht,st),E=nt.setAxisAngle(s,r,gt);nt.normalize(E,E),nt.multiply(n,E,n)}nt.multiply(n,i,i),nt.normalize(i,i)}}function qe(e,t,_,r){var a=Et;m(t,r,a),ot.normalize(a,a);var n=ct;ot.subtract(_,e,n),ot.normalize(n,n);var o=Le(a,n,Pt);nt.multiply(o,t,t),nt.normalize(t,t)}function We(e,t,_,r){var a=ot.transformQuat(t,e,Et),n=ot.dot(r,_),o=ot.scale(r,n,ct),i=ot.subtract(_,o,ct),s=nt.identity(Nt);ot.normalize(i,i),Math.abs(ot.dot(a,i))<.999999&&Le(a,i,s),nt.normalize(s,s),nt.multiply(s,e,e)}function Je(e,t){for(var _=2*Math.PI,r=[],a=0;a<3;a++)r[a]=e[a]-t[a],r[a]>5.1?(e[a]-=r[a]/_*_,r[a]=e[a]-t[a]):r[a]<-5.1&&(e[a]+=-r[a]/_*_,r[a]=e[a]-t[a]);Math.abs(r[0])>3.2&&Math.abs(r[1])<1.6&&Math.abs(r[2])<1.6&&(r[0]>0?e[0]-=_:e[0]+=_),Math.abs(r[1])>3.2&&Math.abs(r[2])<1.6&&Math.abs(r[0])<1.6&&(r[1]>0?e[1]-=_:e[1]+=_),Math.abs(r[2])>3.2&&Math.abs(r[0])<1.6&&Math.abs(r[1])<1.6&&(r[2]>0?e[2]-=_:e[2]+=_)}function Ze(e,t,_){var r=O(t,St),a=O(e,pt);return tt(_t.multiply(a,r,Ot),_)}function $e(e,t,_){var r=Math.sqrt(e[0]*e[0]+e[1]*e[1]);r>1e-6?(t[0]=Math.atan2(e[5],e[8]),t[1]=Math.atan2(-e[2],r),t[2]=Math.atan2(e[1],e[0]),_[0]=Math.atan2(-e[5],-e[8]),_[1]=Math.atan2(-e[2],-r),_[2]=Math.atan2(-e[1],-e[0])):(t[0]=Math.atan2(-e[7],e[4]),t[1]=Math.atan2(-e[2],r),t[2]=0,ot.copy(t,_))}function et(e,t,_){var r=_t.fromQuat(e,St),a=st,n=Et;$e(r,a,n);var o=Math.abs(a[0]-t[0])+Math.abs(a[1]-t[1])+Math.abs(a[2]-t[2]),i=Math.abs(n[0]-t[0])+Math.abs(n[1]-t[1])+Math.abs(n[2]-t[2]),s=o>i?n:a;return ot.copy(s,_),_}function tt(e,t){var _=st,r=Et;$e(e,_,r);var a=Math.abs(_[0])+Math.abs(_[1])+Math.abs(_[2]),n=Math.abs(r[0])+Math.abs(r[1])+Math.abs(r[2]),o=a>n?r:_;return ot.copy(o,t),t}_.d(t,"m",function(){return Rt}),_.d(t,"k",function(){return It}),_.d(t,"n",function(){return bt}),_.d(t,"d",function(){return ht}),_.d(t,"e",function(){return Yt}),_.d(t,"f",function(){return Lt}),_.d(t,"a",function(){return Mt}),_.d(t,"b",function(){return xt}),_.d(t,"c",function(){return yt}),_.d(t,"o",function(){return Ut}),_.d(t,"v",function(){return wt}),_.d(t,"x",function(){return Ct}),_.d(t,"q",function(){return Dt}),_.d(t,"s",function(){return Ft}),_.d(t,"z",function(){return Gt}),_.d(t,"p",function(){return kt}),_.d(t,"u",function(){return Kt}),_.d(t,"w",function(){return Bt}),_.d(t,"r",function(){return Xt}),_.d(t,"t",function(){return Ht}),_.d(t,"y",function(){return jt}),_.d(t,"j",function(){return Zt}),_.d(t,"g",function(){return e_}),_.d(t,"l",function(){return t_}),_.d(t,"h",function(){return __}),_.d(t,"i",function(){return r_}),t._16=r,t._17=a,t._1=n,t._2=o,t._66=i,t.K=s,t.D=E,t._49=c,t._18=l,t._9=T,t.C=d,t._59=u,t._39=f,t._13=P,t.Y=A,t._26=S,t._36=p,t.Z=O,t._35=v,t._33=m,t.U=N,t._60=g,t.G=R,t.O=I,t.N=b,t._23=h,t._25=Y,t._24=L,t._0=M,t._55=y,t.X=U,t._27=w,t._37=C,t._67=D,t._68=F,t.F=G,t.P=k,t._62=K,t._45=B,t._5=X,t._6=H,t._11=j,t._22=Q,t._32=z,t._63=W,t.T=J,t._38=Z,t._54=$,t.J=re,t._29=ae,t.I=ne,t.M=oe,t._50=ie,t._53=se,t._51=Ee,t._14=ce,t._15=le,t.R=Te,t._7=de,t._42=ue,t._43=fe,t._41=Pe,t._4=Ae,t._8=Se,t._40=pe,t._12=Oe,t._61=ve,t.B=me,t.A=Ne,t._58=ge,t._28=be,t._21=he,t._10=Ye,t._47=Le,t.H=Me,t._52=xe,t._19=ye,t.E=Ue,t._69=we,t._70=Ce,t._57=De,t._56=Fe,t._20=Ge,t.L=ke,t.W=Ke,t.S=Be,t._3=Xe,t._48=He,t._65=je,t._64=Qe,t.V=ze,t._46=Ve,t._30=qe,t._31=We,t.Q=Je,t._44=Ze,t._34=et;var _t=_(27),rt=_(21),at=_(41),nt=_(9),ot=_(3),it=_(7),st=new Float32Array(3),Et=new Float32Array(3),ct=new Float32Array(3),lt=new Float32Array(3),Tt=new Float32Array(3),dt=new Float32Array(3),ut=new Float32Array(3),ft=new Float32Array(3),Pt=new Float32Array(4),At=new Float32Array(4),St=new Float32Array(9),pt=new Float32Array(9),Ot=new Float32Array(9),vt=new Float32Array(16),mt=new Float32Array(16),Nt=nt.create(),gt=nt.create(),Rt=new Float32Array([0,0,0]),It=new Float32Array([0,0,0,1]),bt=(new Float32Array([0,0,0,1,0,0,0,1]),new Float32Array([1,1,1])),ht=new Float32Array([1,0,0]),Yt=new Float32Array([0,1,0]),Lt=new Float32Array([0,0,1]),Mt=new Float32Array([-1,0,0]),xt=new Float32Array([0,-1,0]),yt=new Float32Array([0,0,-1]),Ut=0,wt=1,Ct=2,Dt=3,Ft=4,Gt=5,kt=6,Kt=7,Bt=8,Xt=9,Ht=10,jt=11,Qt=[Ut,wt,Ct,Ft,Gt],zt=5e4,Vt=48271,qt=2147483647,Wt=qt%Vt,Jt=Math.floor(qt/Vt),Zt=[new Float32Array([0,0,-1,0,0,-1,0,0,-1,0,0,0,0,0,0,1]),new Float32Array([0,0,1,0,0,-1,0,0,1,0,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,-1,0,0,0,0,-1,0,0,0,0,1]),new Float32Array([-1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1])],$t=2.2,e_=1,t_=2,__=4,r_=4},function(e,t,_){"use strict";function r(){var e=new D(3);return e[0]=0,e[1]=0,e[2]=0,e}function a(e){var t=new D(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function n(e,t,_){var r=new D(3);return r[0]=e,r[1]=t,r[2]=_,r}function o(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function i(e,t,_,r){return r[0]=e,r[1]=t,r[2]=_,r}function s(e,t,_){return _[0]=e[0]+t[0],_[1]=e[1]+t[1],_[2]=e[2]+t[2],_}function E(e,t,_){return _[0]=e[0]-t[0],_[1]=e[1]-t[1],_[2]=e[2]-t[2],_}function c(e,t,_){return _[0]=e[0]*t[0],_[1]=e[1]*t[1],_[2]=e[2]*t[2],_}function l(e,t,_){return _[0]=e[0]/t[0],_[1]=e[1]/t[1],_[2]=e[2]/t[2],_}function T(e,t,_){return _[0]=Math.min(e[0],t[0]),_[1]=Math.min(e[1],t[1]),_[2]=Math.min(e[2],t[2]),_}function d(e,t,_){return _[0]=Math.max(e[0],t[0]),_[1]=Math.max(e[1],t[1]),_[2]=Math.max(e[2],t[2]),_}function u(e,t,_){return _[0]=e[0]*t,_[1]=e[1]*t,_[2]=e[2]*t,_}function f(e,t,_,r){return r[0]=e[0]+t[0]*_,r[1]=e[1]+t[1]*_,r[2]=e[2]+t[2]*_,r}function P(e,t){var _=t[0]-e[0],r=t[1]-e[1],a=t[2]-e[2];return Math.sqrt(_*_+r*r+a*a)}function A(e,t){var _=t[0]-e[0],r=t[1]-e[1],a=t[2]-e[2];return _*_+r*r+a*a}function S(e){var t=e[0],_=e[1],r=e[2];return Math.sqrt(t*t+_*_+r*r)}function p(e){var t=e[0],_=e[1],r=e[2];return t*t+_*_+r*r}function O(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function v(e,t){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function m(e,t){var _=e[0],r=e[1],a=e[2],n=_*_+r*r+a*a;return n>0&&(n=1/Math.sqrt(n),t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n),t}function N(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function g(e,t,_){var r=e[0],a=e[1],n=e[2],o=t[0],i=t[1],s=t[2];return _[0]=a*s-n*i,_[1]=n*o-r*s,_[2]=r*i-a*o,_}function R(e,t,_,r){var a=e[0],n=e[1],o=e[2];return r[0]=a+_*(t[0]-a),r[1]=n+_*(t[1]-n),r[2]=o+_*(t[2]-o),r}function I(e,t,_,r,a,n){var o=a*a,i=o*(2*a-3)+1,s=o*(a-2)+a,E=o*(a-1),c=o*(3-2*a);return n[0]=e[0]*i+t[0]*s+_[0]*E+r[0]*c,n[1]=e[1]*i+t[1]*s+_[1]*E+r[1]*c,n[2]=e[2]*i+t[2]*s+_[2]*E+r[2]*c,n}function b(e,t,_,r,a,n){var o=1-a,i=o*o,s=a*a,E=i*o,c=3*a*i,l=3*s*o,T=s*a;return n[0]=e[0]*E+t[0]*c+_[0]*l+r[0]*T,n[1]=e[1]*E+t[1]*c+_[1]*l+r[1]*T,n[2]=e[2]*E+t[2]*c+_[2]*l+r[2]*T,n}function h(e,t){var _=2*F()*Math.PI,r=2*F()-1,a=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(_)*a,t[1]=Math.sin(_)*a,t[2]=r*e,t}function Y(e,t,_){var r=e[0],a=e[1],n=e[2],o=t[3]*r+t[7]*a+t[11]*n+t[15];return o=o||1,_[0]=(t[0]*r+t[4]*a+t[8]*n+t[12])/o,_[1]=(t[1]*r+t[5]*a+t[9]*n+t[13])/o,_[2]=(t[2]*r+t[6]*a+t[10]*n+t[14])/o,_}function L(e,t,_){var r=e[0],a=e[1],n=e[2];return _[0]=r*t[0]+a*t[3]+n*t[6],_[1]=r*t[1]+a*t[4]+n*t[7],_[2]=r*t[2]+a*t[5]+n*t[8],_}function M(e,t,_){var r=e[0],a=e[1],n=e[2],o=t[0],i=t[1],s=t[2],E=t[3],c=E*r+i*n-s*a,l=E*a+s*r-o*n,T=E*n+o*a-i*r,d=-o*r-i*a-s*n;return _[0]=c*E+d*-o+l*-s-T*-i,_[1]=l*E+d*-i+T*-o-c*-s,_[2]=T*E+d*-s+c*-i-l*-o,_}function x(e,t,_,r){var a=[],n=[];return a[0]=e[0]-t[0],a[1]=e[1]-t[1],a[2]=e[2]-t[2],n[0]=a[0],n[1]=a[1]*Math.cos(_)-a[2]*Math.sin(_),n[2]=a[1]*Math.sin(_)+a[2]*Math.cos(_),r[0]=n[0]+t[0],r[1]=n[1]+t[1],r[2]=n[2]+t[2],r}function y(e,t,_,r){var a=[],n=[];return a[0]=e[0]-t[0],a[1]=e[1]-t[1],a[2]=e[2]-t[2],n[0]=a[2]*Math.sin(_)+a[0]*Math.cos(_),n[1]=a[1],n[2]=a[2]*Math.cos(_)-a[0]*Math.sin(_),r[0]=n[0]+t[0],r[1]=n[1]+t[1],r[2]=n[2]+t[2],r}function U(e,t,_,r){var a=[],n=[];return a[0]=e[0]-t[0],a[1]=e[1]-t[1],a[2]=e[2]-t[2],n[0]=a[0]*Math.cos(_)-a[1]*Math.sin(_),n[1]=a[0]*Math.sin(_)+a[1]*Math.cos(_),n[2]=a[2],r[0]=n[0]+t[0],r[1]=n[1]+t[1],r[2]=n[2]+t[2],r}function w(e,t){var _=n(e[0],e[1],e[2]),r=n(t[0],t[1],t[2]);m(_,_),m(r,r);var a=N(_,r);return a>1?0:Math.acos(a)}function C(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}Object.defineProperty(t,"__esModule",{value:!0}),t.create=r,t.clone=a,t.fromValues=n,t.copy=o,t.set=i,t.add=s,t.subtract=E,_.d(t,"sub",function(){return E}),t.multiply=c,_.d(t,"mul",function(){return c}),t.divide=l,_.d(t,"div",function(){return l}),t.min=T,t.max=d,t.scale=u,t.scaleAndAdd=f,t.distance=P,_.d(t,"dist",function(){return P}),t.squaredDistance=A,_.d(t,"sqrDist",function(){return A}),t.length=S,_.d(t,"len",function(){return S}),t.squaredLength=p,_.d(t,"sqrLen",function(){return p}),t.negate=O,t.inverse=v,t.normalize=m,t.dot=N,t.cross=g,t.lerp=R,t.hermite=I,t.bezier=b,t.random=h,t.transformMat4=Y,t.transformMat3=L,t.transformQuat=M,t.rotateX=x,t.rotateY=y,t.rotateZ=U,_.d(t,"forEach",function(){return G}),t.angle=w,t.str=C;var D="undefined"!=typeof Float32Array?Float32Array:Array,F=Math.random,G=function(){var e=r();return function(t,_,r,a,n,o){var i,s;for(_||(_=3),r||(r=0),s=a?Math.min(a*_+r,t.length):t.length,i=r;i<s;i+=_)e[0]=t[i],e[1]=t[i+1],e[2]=t[i+2],n(e,o,e),t[i]=e[0],t[i+1]=e[1],t[i+2]=e[2];return t}}()},function(e,t,_){"use strict";function r(e,t){function _(e,_){switch(e){case"allow_cors":t.defaults.allow_cors=_;break;case"allow_hidpi":t.defaults.allow_hidpi=_;break;case"alpha":t.context.alpha=_;break;case"alpha_sort":t.defaults.alpha_sort=_;break;case"alpha_sort_threshold":t.defaults.alpha_sort_threshold=_;break;case"anaglyph_use":l.error_deprecated_cfg("anaglyph_use","stereo"),t.defaults.stereo=_?"ANAGLYPH":t.defaults.stereo;break;case"animation_framerate":t.animation.framerate=_;break;case"anisotropic_filtering":t.defaults.anisotropic_filtering=_;break;case"antialiasing":t.defaults.antialiasing=_;break;case"assets_dir":case"assets_path":t.assets.path=_;break;case"assets_dds_available":t.assets.dds_available=_;break;case"assets_pvr_available":t.assets.pvr_available=_;break;case"assets_min50_available":t.assets.min50_available=_;break;case"audio":t.sfx.webaudio=_;break;case"background_color":t.defaults.background_color=_;break;case"bloom":t.defaults.bloom=_;break;case"built_in_module_name":t.paths.built_in_data_module=_;break;case"canvas_resolution_factor":t.defaults.canvas_resolution_factor=_;break;case"console_verbose":t.defaults.console_verbose=_;break;case"compositing":t.defaults.compositing=_;break;case"dof":t.defaults.dof=_;break;case"do_not_load_resources":t.defaults.do_not_load_resources=_;break;case"god_rays":t.defaults.god_rays=_;break;case"stereo":t.defaults.stereo=_;break;case"lod_leap_smooth_threshold":t.defaults.lod_leap_smooth_threshold=_;break;case"lod_smooth_transitions":t.defaults.lod_smooth_transitions=_;break;case"max_fps":t.defaults.max_fps=_;break;case"max_fps_physics":t.physics.max_fps=_;break;case"media_auto_activation":t.defaults.media_auto_activation=_;break;case"motion_blur":t.defaults.motion_blur=_;break;case"physics_enabled":t.physics.enabled=_;break;case"physics_uranium_path":a()?(t.physics.uranium_path=_+t.physics.wasmjs_file,t.physics.uranium_bin=_+t.physics.wasm_file):(t.physics.uranium_path=_+t.physics.asmjs_file,t.physics.uranium_bin=_+t.physics.mem_file),t.physics.uranium_dir=_;break;case"physics_use_wasm":t.physics.use_wasm=_;break;case"physics_calc_fps":t.physics.calc_fps=_;break;case"physics_use_workers":t.physics.use_workers=_;break;case"precision":t.defaults.precision=_;break;case"prevent_caching":t.assets.prevent_caching=_;break;case"quality":t.defaults.quality=_;break;case"reflections":t.defaults.reflections=_;break;case"refractions":t.defaults.refractions=_;break;case"sfx_mix_mode":t.sfx.mix_mode=_;break;case"shaders_dir":case"shaders_path":t.paths.shaders_path=_;break;case"shadows":t.defaults.shadows=_;break;case"show_hud_debug_info":t.defaults.show_hud_debug_info=_;break;case"smaa":l.error_deprecated_cfg("smaa"),t.defaults.smaa=_;break;case"smaa_search_texture_path":l.error_deprecated_cfg("smaa_search_texture_path"),t.paths.smaa_search_texture_path=_;break;case"smaa_area_texture_path":l.error_deprecated_cfg("smaa_area_texture_path"),t.paths.smaa_area_texture_path=_;break;case"ssao":t.defaults.ssao=_;break;case"debug_view":t.defaults.debug_view=_;break;case"enable_selectable":t.defaults.enable_selectable=_;break;case"enable_outlining":t.defaults.enable_outlining=_;break;case"outlining_overview_mode":t.outlining.outlining_overview_mode=_;break;case"glow_materials":t.defaults.glow_materials=_;break;case"url_params":t.defaults.url_params=_;break;case"use_min50":t.defaults.use_min50=_;break;case"enable_texture_cache":t.defaults.enable_texture_cache=_;break;case"gl_debug":t.defaults.gl_debug=_;break;case"srgb_type":t.defaults.srgb_type=_;break;case"shadow_blur_samples":t.defaults.shadow_blur_samples=_;break;case"reflection_quality":t.defaults.reflection_quality=_;break;case"assets_gzip_available":t.defaults.assets_gzip_available=_;break;case"debug_loading":t.defaults.debug_loading=_;break;case"msaa_samples":t.defaults.msaa_samples=_;break;default:l.error("Unknown config property: "+e)}}function r(){return n.a.module_check(t.paths.built_in_data_module)}function a(){return t.physics.use_wasm&&window.WebAssembly}function E(){for(var e=t.paths,_=null,r=!1,a=document.getElementsByTagName("script"),n=0;n<a.length;n++){for(var o=a[n].src,i=0;i<e.js_src_search_paths.length;i++){var s=e.js_src_search_paths[i];if(o.indexOf(s)>=0&&(_=o,a[n].attributes["b4w-offset"])){_=_.substring(0,_.lastIndexOf("/"))+"/"+a[n].attributes["b4w-offset"].value,r=!0;break}}if(r)break}_||(l.warn("Couldn't determine path to ancillary resources, fallback to the current page directory"),_=document.location.href);var E=_.indexOf("?");return E>=0&&(_=_.substring(0,E)),_.substring(0,_.lastIndexOf("/"))}var c=Object(o.a)(e),l=Object(i.a)(e);t.P_LOW=1,t.P_HIGH=2,t.P_ULTRA=3,t.P_CUSTOM=4,t.P_AUTO=5,t.context={alpha:!0,antialias:!1,premultipliedAlpha:!0},t.context_save=s.O(t.context),t.defaults={alpha_sort:!0,alpha_sort_threshold:.1,min_format_version:[6,3],max_fps:1e4,console_verbose:!1,do_not_load_resources:!1,use_min50:!1,enable_texture_cache:!0,fps_measurement_interval:1,fps_callback_interval:5,background_color:[0,0,0,0],canvas_resolution_factor:1,texture_min_filter:3,allow_cors:!1,force_low_quality_nodes:!1,anisotropic_available:!0,anisotropic_filtering:!0,texture_lod_available:!1,tex_float_available:!1,tex_hfloat_available:!1,tex_float_lin_available:!1,tex_hfloat_lin_available:!1,cbuffer_float_available:!1,cbuffer_hfloat_available:!1,show_hud_debug_info:!1,depth_tex_available:!0,shadows:!0,stereo:"NONE",reflections:!0,refractions:!0,ssao:!0,dof:!0,god_rays:!0,bloom:!0,motion_blur:!0,compositing:!0,antialiasing:!0,smaa:!1,debug_view:!1,water_wireframe_debug:!1,foam:!0,parallax:!0,dynamic_grass:!0,water_dynamic:!0,shore_smoothing:!0,shore_distance:!0,use_compression:!0,precision:"highp",quality:t.P_HIGH,allow_vertex_textures:!0,lod_leap_smooth_threshold:3,assets_gzip_available:!1,no_phy_interp_hack:!1,shader_constants_hack:!1,disable_blend_shadows_hack:!1,vert_anim_mix_normals_hack:!1,is_mobile_device:!1,init_wa_context_hack:!1,clear_procedural_sky_hack:!1,sky_update_hack:!1,seq_video_fallback:!1,allow_hidpi:!1,shadows_color_slink_hack:!1,mobile_firefox_media_hack:!1,ipad_video_hack:!1,enable_selectable:!0,enable_outlining:!0,lod_smooth_transitions:!0,glow_materials:!0,ie11_edge_touchscreen_hack:!1,firefox_tex_reuse_hack:!1,loaded_data_version:[0,0],quality_aa_method:!0,skinning_hack:!1,url_params:null,webgl2:!0,msaa_samples:4,compared_mode_depth:!1,safari_canvas_alpha_hack:!1,safari_glow_hack:!1,resize_cubemap_canvas_hack:!1,resize_texture_canvas_hack:!1,chrome_html_bkg_music_hack:!1,ie_edge_anchors_floor_hack:!1,ie11_edge_mouseoffset_hack:!1,media_auto_activation:!0,max_cast_lamps:4,mac_os_shadow_hack:!1,gl_debug:!1,check_framebuffer_hack:!1,allow_instanced_arrays_ext:!1,allow_vao_ext:!1,compress_format:"dds",shadow_blur_samples:"",reflection_quality:"",srgb_type:"SRGB_SIMPLE",ios_copy_tex_hack:!1,rgba_fallback_shadows:!1,debug_loading:!1,mali_alpha_antialias_hack:!1,mali4_lamps_hack:!1,chrome_csm_blend_hack:!1,reuse_depth_optimization:!0},t.defaults_save=s.O(t.defaults),t.animation={framerate:-1,frames_blending_hack:!1,frame_steps:1},t.controls={mouse_wheel_notch_multiplier:1/120},t.assets={path:"",path_default:"B4W_ASSETS_PATH=__JS__/assets/",proj_path_default:"B4W_PROJ_ASSETS_PATH=__JS__/../projects/__NAME__/assets/",max_requests:15,prevent_caching:!0,min50_available:!1,dds_available:!1,pvr_available:!1},t.assets_save=s.O(t.assets),t.paths={shaders_path:"",shaders_path_default:"../shaders/",shaders_include_dir:"include/",shaders_postp_dir:"postprocessing/",built_in_data_module:"built_in_data",js_src_search_paths:["b4w.js","b4w.min.js","b4w.simple.min.js","b4w.whitespace.min.js","b4w_app_bundle.js","B4W_MAIN_MODULE"],smaa_search_texture_path:"smaa_search_texture.png",smaa_area_texture_path:"smaa_area_texture.png"},t.hmd_params={webvr:{distortion_coefs:[.22,.28],chromatic_aberration_coefs:[-.015,.02,.025,.02]},nonwebvr:{distor_scale:.8,inter_lens_dist:.064,base_line_dist:.035,screen_to_lens_dist:.039,distortion_coefs:[.34,.55],chromatic_aberration_coefs:[0,0,0,0],width_dist:.11,height_dist:.062,bevel_size:.004}},t.physics={enabled:!0,max_fps:60,uranium_path:"",uranium_bin:"",uranium_path_default:"B4W_URANIUM_PATH=/dist/uranium/",asmjs_file:"uranium.js",wasmjs_file:"uranium_wasm.js",mem_file:"uranium.js.mem",wasm_file:"uranium_wasm.wasm",uranium_dir:"/dist/uranium",calc_fps:!1,ping:!1,use_workers:!0,use_wasm:!0},t.physics_save=s.O(t.physics),t.scenes={grass_tex_size:1024,cubemap_tex_size:256,cube_reflect_low:32,cube_reflect_medium:128,cube_reflect_high:256,plane_reflect_low:.25,plane_reflect_medium:.5,plane_reflect_high:1},t.scenes_save=s.O(t.scenes),t.sfx={webaudio:!0,mix_mode:!1,audio_loading_hack:!1,clamp_playback_rate_hack:!1,disable_playback_rate_hack:!1},t.sfx_save=s.O(t.sfx),t.outlining={outlining_overview_mode:!1,outline_color:[1,.4,.05],outline_duration:.2,outline_period:3.8,outline_relapses:1},t.debug_subs={enabled:!1,subs_type:39,subs_number:0,slink_type:"COLOR"},t.debug_subs_save=s.O(t.debug_subs),t.context_limits={max_combined_texture_image_units:8,max_fragment_uniform_vectors:64,max_texture_image_units:8,max_varying_vectors:8,max_vertex_attribs:15,max_vertex_texture_image_units:0,max_vertex_uniform_vectors:128,max_cube_map_texture_size:1024,max_renderbuffer_size:4096,max_texture_size:4096,max_viewport_dims:[4096,4096],depth_bits:24},t.context_limits_save=s.O(t.context_limits),t.apply_quality=function(){var e=t.defaults,_=t.physics,r=t.scenes;switch(e.quality){case t.P_ULTRA:e.shadows=!0,e.shore_smoothing=!0,e.ssao=!0,e.dof=!0,e.god_rays=!0,e.bloom=!0,e.reflections=!0,e.refractions=!0,e.foam=!0,e.parallax=!0,e.dynamic_grass=!0,r.grass_tex_size=2048,r.cubemap_tex_size=512,e.texture_min_filter=3,e.anisotropic_filtering=!0,e.use_min50=!1,e.water_dynamic=!0,e.shore_distance=!0,e.antialiasing=!0,e.smaa=!1,e.compositing=!0,e.motion_blur=!0,e.allow_hidpi=!0,e.enable_outlining=!0,e.glow_materials=!0,e.msaa_samples=16,e.srgb_type="SRGB_PROPER",_.max_fps=120,e.lod_smooth_transitions=!0;break;case t.P_HIGH:e.shadows=!0,e.shore_smoothing=!0,e.ssao=!0,e.dof=!0,e.god_rays=!0,e.bloom=!0,e.reflections=!0,e.refractions=!0,e.foam=!0,e.parallax=!0,e.dynamic_grass=!0,r.grass_tex_size=1024,r.cubemap_tex_size=256,e.texture_min_filter=3,e.anisotropic_filtering=!0,e.use_min50=!1,e.water_dynamic=!0,e.shore_distance=!0,e.antialiasing=!0,e.smaa=!1,e.compositing=!0,e.motion_blur=!0,e.allow_hidpi=!1,e.enable_outlining=!0,e.glow_materials=!0,e.srgb_type="SRGB_SIMPLE",e.msaa_samples=4,_.max_fps=60,e.lod_smooth_transitions=!0;break;case t.P_LOW:e.shadows=!1,e.shore_smoothing=!1,e.ssao=!1,e.dof=!1,e.god_rays=!1,e.bloom=!1,e.reflections=!1,e.refractions=!1,e.foam=!1,e.parallax=!1,e.dynamic_grass=!1,r.grass_tex_size=512,r.cubemap_tex_size=256,e.texture_min_filter=2,e.anisotropic_filtering=!1,e.use_min50=!0,e.water_dynamic=!1,e.shore_distance=!1,e.antialiasing=!1,e.smaa=!1,e.compositing=!1,e.motion_blur=!1,e.allow_hidpi=!1,e.enable_outlining=!1,e.glow_materials=!1,e.srgb_type="SRGB_SIMPLE",e.msaa_samples=1,_.max_fps=60,e.lod_smooth_transitions=!1;break;case t.P_CUSTOM:break;case t.P_AUTO:c.panic("Direct AUTO quality profile setting is forbidden")}},t.set=_,t.get=function(e){switch(e){case"allow_cors":return t.defaults.allow_cors;case"allow_hidpi":return t.defaults.allow_hidpi;case"alpha":return t.context.alpha;case"alpha_sort":return t.defaults.alpha_sort;case"alpha_sort_threshold":return t.defaults.alpha_sort_threshold;case"anaglyph_use":return"ANAGLYPH"==t.defaults.stereo;case"animation_framerate":return t.animation.framerate;case"anisotropic_filtering":return t.defaults.anisotropic_filtering;case"antialiasing":return t.defaults.antialiasing;case"assets_dir":case"assets_path":return t.assets.path;case"assets_dds_available":return t.assets.dds_available;case"assets_pvr_available":return t.assets.pvr_available;case"assets_min50_available":return t.assets.min50_available;case"audio":return t.sfx.webaudio;case"background_color":return t.defaults.background_color;case"bloom":return t.defaults.bloom;case"built_in_module_name":return t.paths.built_in_data_module;case"canvas_resolution_factor":return t.defaults.canvas_resolution_factor;case"console_verbose":return t.defaults.console_verbose;case"compositing":return t.defaults.compositing;case"dof":return t.defaults.dof;case"do_not_load_resources":return t.defaults.do_not_load_resources;case"is_mobile_device":return t.defaults.is_mobile_device;case"god_rays":return t.defaults.god_rays;case"stereo":return t.defaults.stereo;case"lod_leap_smooth_threshold":return t.defaults.lod_leap_smooth_threshold;case"lod_smooth_transitions":return t.defaults.lod_smooth_transitions;case"max_fps":return t.defaults.max_fps;case"max_fps_physics":return t.physics.max_fps;case"media_auto_activation":return t.defaults.media_auto_activation;case"motion_blur":return t.defaults.motion_blur;case"physics_enabled":return t.physics.enabled;case"physics_uranium_path":return t.physics.uranium_dir;case"physics_uranium_bin":return t.physics.uranium_bin;case"physics_use_wasm":return t.physics.use_wasm;case"physics_calc_fps":return t.physics.calc_fps;case"physics_use_workers":return t.physics.use_workers;case"precision":return t.defaults.precision;case"prevent_caching":return t.assets.prevent_caching;case"quality":return t.defaults.quality;case"reflections":return t.defaults.reflections;case"refractions":return t.defaults.refractions;case"sfx_mix_mode":return t.sfx.mix_mode;case"shaders_dir":case"shaders_path":return t.paths.shaders_path;case"shadows":return t.defaults.shadows;case"show_hud_debug_info":return t.defaults.show_hud_debug_info;case"smaa":return t.defaults.smaa;case"smaa_search_texture_path":return t.paths.smaa_search_texture_path;case"smaa_area_texture_path":return t.paths.smaa_area_texture_path;case"ssao":return t.defaults.ssao;case"debug_view":return t.defaults.debug_view;case"enable_selectable":return t.defaults.enable_selectable;case"enable_outlining":return t.defaults.enable_outlining;case"outlining_overview_mode":return t.outlining.outlining_overview_mode;case"glow_materials":return t.defaults.glow_materials;case"url_params":return t.defaults.url_params;case"use_min50":return t.defaults.use_min50;case"enable_texture_cache":return t.defaults.enable_texture_cache;case"gl_debug":return t.defaults.gl_debug;case"srgb_type":return t.defaults.srgb_type;case"shadow_blur_samples":return t.defaults.shadow_blur_samples;case"reflection_quality":return t.defaults.reflection_quality;case"assets_gzip_available":return t.defaults.assets_gzip_available;case"debug_loading":return t.defaults.debug_loading;case"msaa_samples":return t.defaults.msaa_samples;default:l.error("Unknown config property: "+e)}},t.reset=function(){for(var e in t.context_save)t.context[e]=t.context_save[e];for(var e in t.defaults_save)t.defaults[e]=t.defaults_save[e];for(var e in t.assets_save)t.assets[e]=t.assets_save[e];for(var e in t.physics_save)t.physics[e]=t.physics_save[e];for(var e in t.scenes_save)t.scenes[e]=t.scenes_save[e];for(var e in t.sfx_save)t.sfx[e]=t.sfx_save[e];for(var e in t.debug_subs_save)t.debug_subs[e]=t.debug_subs_save[e]},t.reset_limits=function(){var e=t.context_limits.depth_bits;for(var _ in t.context_limits_save)t.context_limits[_]=t.context_limits_save[_];t.context_limits.depth_bits=e},t.is_built_in_data=r,t.set_paths=function(){var e=t.paths,_=t.physics;if(r()||""!=e.shaders_path||(e.shaders_path=E()+"/"+e.shaders_path_default),a())var n=_.uranium_path_default+_.wasmjs_file,o=_.uranium_path_default+_.wasm_file;else var n=_.uranium_path_default+_.asmjs_file,o=_.uranium_path_default+_.mem_file;_.enabled&&""==_.uranium_path&&(_.uranium_path=n.replace("B4W_URANIUM_PATH=",""),_.uranium_bin=o.replace("B4W_URANIUM_PATH=",""))},t.get_assets_path=function(e){var _=t.assets;if(_.path)return _.path;var r=_.path_default,a="B4W_ASSETS_PATH=";return e&&(r=_.proj_path_default,a="B4W_PROJ_ASSETS_PATH=",r=r.replace("__NAME__",e)),r=r.replace(a,""),r=r.replace("__JS__",E())}}var a=_(0),n=_(32),o=_(5),i=_(1),s=_(2),E=Object(a.a)("__config",r);t.a=E},function(e,t,_){"use strict";function r(e,t){function _(e){throw e&&s.error.apply(s,arguments),"engine panic:\nThe engine tried to perform an invalid operation and halted.\nPlease copy the console contents above and submit it to the Blend4Web forum at\nhttps://www.blend4web.com/en/forums/forum/17/"}function r(e,t){if(a(e)||_("Structure assertion failed: invalid first object value"),a(t)||_("Structure assertion failed: invalid second object value"),i(e,t)||_("Structure assertion failed: incompatible types"),!(null==e||null==t||"object"!=typeof e||n._14(e)||e instanceof Array)){for(var r in e)a(e[r])||_("Structure assertion failed: invalid value for key in the first object: "+r),r in t||_("Structure assertion failed: missing key in the first object: "+r);for(var r in t)a(t[r])||_("Structure assertion failed: invalid value for key in the second object: "+r),r in e||_("Structure assertion failed: missing key in the second object: "+r),i(e[r],t[r])||_("Structure assertion failed: incompatible types for key "+r)}}function a(e){return void 0!==e&&("number"!=typeof e||!isNaN(e))}function i(e,t){if(typeof e!=typeof t)return!1;if(null!=e&&null!=t&&"object"==typeof e){var _=e instanceof Array,r=t instanceof Array;if(_&&!r||!_&&r)return!1;var a=n._14(e),o=n._14(t);if(a&&!o||!a&&o)return!1}return!0}var s=Object(o.a)(e),E=null,c=!1;t.panic=_,t.assert=function(e){e||_("Assertion failed")},t.is_constructor=function(e,t){e.constructor!=t&&_("Type assertion failed: value <"+e+"> has type <"+e.constructor+">, required <"+t+">")},t.equal=r,t.equal_seq=function(e){c?r(e,E):c=!0,E=null!=e&&"object"==typeof e?n.N(e):e}}var a=_(0),n=_(2),o=_(1),i=Object(a.a)("assert",r);t.a=i},function(e,t,_){"use strict";function r(){var e=new Float32Array(8);return e[3]=1,e[7]=1,e}function a(e,t,_,a,n,o,i,s){var E=r();return E[0]=e,E[1]=t,E[2]=_,E[3]=a,E[4]=n,E[5]=o,E[6]=i,E[7]=s,E}function n(){var e=new Float32Array(9);return e[3]=1,e[7]=1,e}function o(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function i(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=0,e[7]=1,e}function s(e,t,_,r){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=t,r[4]=_[0],r[5]=_[1],r[6]=_[2],r[7]=_[3],r}function E(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function c(e,t){return t[3]=e,t}function l(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function T(e,t){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t}function d(e){return e.subarray(0,3)}function u(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function f(e){return e[3]}function P(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function A(e){return e.subarray(4,8)}function S(e,t){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t}function p(e,t){var _=1/e[3];if(!_)return null;var r=e[0],a=e[1],n=e[2];K[0]=e[4],K[1]=e[5],K[2]=e[6],K[3]=e[7],D.invert(K,K);var o=K[0],i=K[1],s=K[2],E=K[3],c=r*_,l=a*_,T=n*_,d=E*c+i*T-s*l,u=E*l+s*c-o*T,f=E*T+o*l-i*c,P=-o*c-i*l-s*T;return t[0]=-(d*E+P*-o+u*-s-f*-i),t[1]=-(u*E+P*-i+f*-o-d*-s),t[2]=-(f*E+P*-s+d*-i-u*-o),t[3]=_,t[4]=o,t[5]=i,t[6]=s,t[7]=E,t}function O(e,t){var _=e.subarray(0,3),r=e[3],a=e.subarray(4,8);C.fromRotationTranslation(a,_,t);for(var n=0;n<12;n++)t[n]*=r;return t}function v(e,t){return s(F._25(e,k),F._24(e),F._23(e,K),t),t}function m(e,t,_){N(t,e,_),_[3]=e[3]*t[3];var r=e[4],a=e[5],n=e[6],o=e[7],i=t[4],s=t[5],E=t[6],c=t[7];return _[4]=r*c+o*i+a*E-n*s,_[5]=a*c+o*s+n*i-r*E,_[6]=n*c+o*E+r*s-a*i,_[7]=o*c-r*i-a*s-n*E,_}function N(e,t,_){var r=t[0],a=t[1],n=t[2],o=t[3],i=t[4],s=t[5],E=t[6],c=t[7],l=e[0]*o,T=e[1]*o,d=e[2]*o,u=c*l+s*d-E*T,f=c*T+E*l-i*d,P=c*d+i*T-s*l,A=-i*l-s*T-E*d;return _[0]=u*c+A*-i+f*-E-P*-s,_[1]=f*c+A*-s+P*-i-u*-E,_[2]=P*c+A*-E+u*-s-f*-i,_[0]+=r,_[1]+=a,_[2]+=n,_}function g(e,t,_){var r=t[0],a=t[1],n=t[2],o=t[3],i=e[0]-r,s=e[1]-a,E=e[2]-n,c=t[4],l=t[5],T=t[6],d=t[7],u=c*c+l*l+T*T+d*d,f=u?1/u:0;c=-c*f,l=-l*f,T=-T*f,d*=f;var P=d*i+l*E-T*s,A=d*s+T*i-c*E,S=d*E+c*s-l*i,p=-c*i-l*s-T*E;return _[0]=P*d+p*-c+A*-T-S*-l,_[1]=A*d+p*-l+S*-c-P*-T,_[2]=S*d+p*-T+P*-l-A*-c,_[0]/=o,_[1]/=o,_[2]/=o,_}function R(e,t,_,r){r||(r=0);for(var a=e.length,n=t[0],o=t[1],i=t[2],s=t[3],E=t[4],c=t[5],l=t[6],T=t[7],d=0;d<a;d+=3){var u=e[d]*s,f=e[d+1]*s,P=e[d+2]*s,A=T*u+c*P-l*f,S=T*f+l*u-E*P,p=T*P+E*f-c*u,O=-E*u-c*f-l*P;_[r+d]=A*T+O*-E+S*-l-p*-c,_[r+d+1]=S*T+O*-c+p*-E-A*-l,_[r+d+2]=p*T+O*-l+A*-c-S*-E,_[r+d]+=n,_[r+d+1]+=o,_[r+d+2]+=i}return _}function I(e,t,_,r){r||(r=0);for(var a=e.length,n=t[3],o=t[4],i=t[5],s=t[6],E=t[7],c=0;c<a;c+=3){var l=e[c]*n,T=e[c+1]*n,d=e[c+2]*n,u=E*l+i*d-s*T,f=E*T+s*l-o*d,P=E*d+o*T-i*l,A=-o*l-i*T-s*d;_[r+c]=u*E+A*-o+f*-s-P*-i,_[r+c+1]=f*E+A*-i+P*-o-u*-s,_[r+c+2]=P*E+A*-s+u*-i-f*-o}return _}function b(e,t,_){var r=t[3],a=t[4],n=t[5],o=t[6],i=t[7],s=e[0]*r,E=e[1]*r,c=e[2]*r,l=i*s+n*c-o*E,T=i*E+o*s-a*c,d=i*c+a*E-n*s,u=-a*s-n*E-o*c;return _[0]=l*i+u*-a+T*-o-d*-n,_[1]=T*i+u*-n+d*-a-l*-o,_[2]=d*i+u*-o+l*-n-T*-a,_}function h(e,t,_,r){r||(r=0);for(var a=e.length,n=t[3],o=t[4],i=t[5],s=t[6],E=t[7],c=0;c<a;c+=4){var l=e[c]*n,T=e[c+1]*n,d=e[c+2]*n,u=E*l+i*d-s*T,f=E*T+s*l-o*d,P=E*d+o*T-i*l,A=-o*l-i*T-s*d;_[r+c]=u*E+A*-o+f*-s-P*-i,_[r+c+1]=f*E+A*-i+P*-o-u*-s,_[r+c+2]=P*E+A*-s+u*-i-f*-o,_[r+c+3]=e[c+3]}return _}function Y(e,t,_){var r=S(t,K);return D.multiply(r,e,_),_}function L(e,t,_,r){r=r||0;var a=S(t,K);return F._37(e,a,_,r),_}function M(e,t,_){var r=e[3],a=e[4],n=e[5],o=e[6],i=e[7],s=t[0]*r,E=t[1]*r,c=t[2]*r,l=i*s+n*c-o*E,T=i*E+o*s-a*c,d=i*c+a*E-n*s,u=-a*s-n*E-o*c;return _[0]=e[0]+l*i+u*-a+T*-o-d*-n,_[1]=e[1]+T*i+u*-n+d*-a-l*-o,_[2]=e[2]+d*i+u*-o+l*-n-T*-a,_[3]=e[3],_[4]=e[4],_[5]=e[5],_[6]=e[6],_[7]=e[7],_}function x(e,t,_,r){var a=e.subarray(0,3),n=t.subarray(0,3),o=r.subarray(0,3);G.lerp(a,n,_,o);var i=e[3],s=t[3];r[3]=i+_*(s-i);var E=e.subarray(4,8),c=t.subarray(4,8),l=r.subarray(4,8);return D.slerp(E,c,_,l),r}function y(e,t,_,r,a){a[0]=e[0]+t*_[0],a[1]=e[1]+t*_[1],a[2]=e[2]+t*_[2],a[3]=e[3],U(e,r,a),a[4]=e[4]+a[4]*t,a[5]=e[5]+a[5]*t,a[6]=e[6]+a[6]*t,a[7]=e[7]+a[7]*t,w(a,a)}function U(e,t,_){var r=t[0],a=t[1],n=t[2],o=e[4],i=e[5],s=e[6],E=e[7];_[4]=.5*(r*E+a*s-n*i),_[5]=.5*(a*E+n*o-r*s),_[6]=.5*(n*E+r*i-a*o),_[7]=.5*(-r*o-a*i-n*s)}function w(e,t){var _=e[4],r=e[5],a=e[6],n=e[7],o=_*_+r*r+a*a+n*n;o>0&&(o=1/Math.sqrt(o),t[4]=e[4]*o,t[5]=e[5]*o,t[6]=e[6]*o,t[7]=e[7]*o)}t.b=r,t.e=a,t.c=n,t.a=o,t.l=i,t.s=s,t.t=E,t.r=c,t.u=l,t.q=T,t.j=d,t.i=u,t.h=f,t.k=P,t.g=A,t.f=S,t.o=p,t.v=O,t.d=v,t.p=m,t.B=N,t.C=g,t.D=R,t.x=I,t.w=b,t.A=h,t.y=Y,t.z=L,t.E=M,t.n=x,t.m=y;var C=_(21),D=_(9),F=_(2),G=_(3),k=(Math.sin(-Math.PI/4),new Float32Array(3)),K=new Float32Array(4);new Float32Array(16)},function(e,t,_){"use strict";function r(){var e=new Y(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function a(e){var t=new Y(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function n(e,t,_,r){var a=new Y(4);return a[0]=e,a[1]=t,a[2]=_,a[3]=r,a}function o(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function i(e,t,_,r,a){return a[0]=e,a[1]=t,a[2]=_,a[3]=r,a}function s(e,t,_){return _[0]=e[0]+t[0],_[1]=e[1]+t[1],_[2]=e[2]+t[2],_[3]=e[3]+t[3],_}function E(e,t,_){return _[0]=e[0]-t[0],_[1]=e[1]-t[1],_[2]=e[2]-t[2],_[3]=e[3]-t[3],_}function c(e,t,_){return _[0]=e[0]*t[0],_[1]=e[1]*t[1],_[2]=e[2]*t[2],_[3]=e[3]*t[3],_}function l(e,t,_){return _[0]=e[0]/t[0],_[1]=e[1]/t[1],_[2]=e[2]/t[2],_[3]=e[3]/t[3],_}function T(e,t,_){return _[0]=Math.min(e[0],t[0]),_[1]=Math.min(e[1],t[1]),_[2]=Math.min(e[2],t[2]),_[3]=Math.min(e[3],t[3]),_}function d(e,t,_){return _[0]=Math.max(e[0],t[0]),_[1]=Math.max(e[1],t[1]),_[2]=Math.max(e[2],t[2]),_[3]=Math.max(e[3],t[3]),_}function u(e,t,_){return _[0]=e[0]*t,_[1]=e[1]*t,_[2]=e[2]*t,_[3]=e[3]*t,_}function f(e,t,_,r){return r[0]=e[0]+t[0]*_,r[1]=e[1]+t[1]*_,r[2]=e[2]+t[2]*_,r[3]=e[3]+t[3]*_,r}function P(e,t){var _=t[0]-e[0],r=t[1]-e[1],a=t[2]-e[2],n=t[3]-e[3];return Math.sqrt(_*_+r*r+a*a+n*n)}function A(e,t){var _=t[0]-e[0],r=t[1]-e[1],a=t[2]-e[2],n=t[3]-e[3];return _*_+r*r+a*a+n*n}function S(e){var t=e[0],_=e[1],r=e[2],a=e[3];return Math.sqrt(t*t+_*_+r*r+a*a)}function p(e){var t=e[0],_=e[1],r=e[2],a=e[3];return t*t+_*_+r*r+a*a}function O(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function v(e,t){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function m(e,t){var _=e[0],r=e[1],a=e[2],n=e[3],o=_*_+r*r+a*a+n*n;return o>0&&(o=1/Math.sqrt(o),t[0]=_*o,t[1]=r*o,t[2]=a*o,t[3]=n*o),t}function N(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function g(e,t,_,r){var a=e[0],n=e[1],o=e[2],i=e[3];return r[0]=a+_*(t[0]-a),r[1]=n+_*(t[1]-n),r[2]=o+_*(t[2]-o),r[3]=i+_*(t[3]-i),r}function R(e,t){return t[0]=L(),t[1]=L(),t[2]=L(),t[3]=L(),m(t,t),e(t,e,t),t}function I(e,t,_){var r=e[0],a=e[1],n=e[2],o=e[3];return _[0]=t[0]*r+t[4]*a+t[8]*n+t[12]*o,_[1]=t[1]*r+t[5]*a+t[9]*n+t[13]*o,_[2]=t[2]*r+t[6]*a+t[10]*n+t[14]*o,_[3]=t[3]*r+t[7]*a+t[11]*n+t[15]*o,_}function b(e,t,_){var r=e[0],a=e[1],n=e[2],o=t[0],i=t[1],s=t[2],E=t[3],c=E*r+i*n-s*a,l=E*a+s*r-o*n,T=E*n+o*a-i*r,d=-o*r-i*a-s*n;return _[0]=c*E+d*-o+l*-s-T*-i,_[1]=l*E+d*-i+T*-o-c*-s,_[2]=T*E+d*-s+c*-i-l*-o,_[3]=e[3],_}function h(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}Object.defineProperty(t,"__esModule",{value:!0}),t.create=r,t.clone=a,t.fromValues=n,t.copy=o,t.set=i,t.add=s,t.subtract=E,_.d(t,"sub",function(){return E}),t.multiply=c,_.d(t,"mul",function(){return c}),t.divide=l,_.d(t,"div",function(){return l}),t.min=T,t.max=d,t.scale=u,t.scaleAndAdd=f,t.distance=P,_.d(t,"dist",function(){return P}),t.squaredDistance=A,_.d(t,"sqrDist",function(){return A}),t.length=S,_.d(t,"len",function(){return S}),t.squaredLength=p,_.d(t,"sqrLen",function(){return p}),t.negate=O,t.inverse=v,t.normalize=m,t.dot=N,t.lerp=g,t.random=R,t.transformMat4=I,t.transformQuat=b,_.d(t,"forEach",function(){return M}),t.str=h;var Y="undefined"!=typeof Float32Array?Float32Array:Array,L=Math.random,M=function(){var e=r();return function(t,_,r,a,n,o){var i,s;for(_||(_=4),r||(r=0),s=a?Math.min(a*_+r,t.length):t.length,i=r;i<s;i+=_)e[0]=t[i],e[1]=t[i+1],e[2]=t[i+2],e[3]=t[i+3],n(e,o,e),t[i]=e[0],t[i+1]=e[1],t[i+2]=e[2],t[i+3]=e[3];return t}}()},function(e,t,_){"use strict";function r(e,t){function _(e){var t={type:e,data_id:0,world_tsr:i.c(),world_tsr_inv:i.c(),pivot:new Float32Array(3),hover_pivot:new Float32Array(3),init_dist:0,init_fov:0,is_copied:!1,is_copied_deep:!1,color_id:null,outline_intensity:0,target_cam_upside_down:!1,vertical_axis:E.create(),use_panning:!1,move_style:0,velocity_trans:1,velocity_rot:1,velocity_zoom:1,dof_distance:0,dof_front_start:0,dof_front_end:0,dof_rear_start:0,dof_rear_end:0,dof_power:0,dof_bokeh_intensity:0,dof_bokeh:!1,dof_foreground_blur:!1,dof_object:null,horizontal_limits:null,vertical_limits:null,distance_limits:null,hover_vert_trans_limits:null,hover_horiz_trans_limits:null,pivot_limits:null,enable_hover_hor_rotation:!0,outline_anim_settings_default:{outline_duration:1,outline_period:1,outline_relapses:0},cube_reflection_id:-1,plane_reflection_id:-1,reflection_plane:new Float32Array(4),friction:0,elasticity:0,is_lod:!1,lod_center:new Float32Array(3),main_lod_offset:new Float32Array(3),lod_dist_min:0,lod_dist_max:g,lod_lower_border_range:0,lod_upper_border_range:0,do_not_render:!1,shadow_cast:!1,shadow_receive:!1,shadow_cast_only:!1,reflexible:!1,reflexible_only:!1,reflective:!1,reflection_type:"",wind_bending:!1,dynamic_geometry:!1,dynamic_grass:!1,hide:!1,hide_children:!1,selectable:!1,origin_selectable:!1,outlining:!1,origin_outlining:!1,outline_on_select:!1,is_hair_particles:!1,is_visible:!1,force_zsort:!1,wind_bending_angle:0,wind_bending_amp:0,wind_bending_freq:0,detail_bending_freq:0,detail_bending_amp:0,branch_bending_amp:0,main_bend_col:"",detail_bend_col:{leaves_stiffness:"",leaves_phase:"",overall_stiffness:""},bend_center_only:!1,center_pos:new Float32Array(3),billboard:!1,billboard_pres_glob_orientation:!1,billboard_type:"",billboard_spherical:!1,frame_factor:0,va_frame:0,va_frame_factor:0,max_bones:0,frames_blending:!1,vertex_anim:!1,use_shape_keys:!1,shape_keys_values:[],is_skinning:!1,anim_mixing:!1,anim_mix_factor:1,anim_mix_factor_change_speed:0,anim_destination_mix_factor:1,anim_mix_cb:null,mix_with_current:!1,blend_skel_slots:new Int8Array([-1,-1]),skinned_renders:[],mesh_to_arm_bone_maps:[],skinning_data_cache:[],quats_before:null,quats_after:null,trans_before:null,trans_after:null,trans_curr:null,quats_curr:null,bone_pointers:null,bone_skinning_info:null,pose_data:null,arm_rel_trans:null,arm_rel_quat:null,bb_original:n.w(),bb_local:n.w(),bb_world:n.w(),bs_local:n.A(),bs_world:n.A(),be_local:n.y(),be_world:n.y(),bbr_local:n.C(),bbr_world:n.C(),bcyl_local:n.K(),bcap_local:n.I(),bcon_local:n.J(),pass_index:0};return E.copy(s.f,t.vertical_axis),t}function r(e){var t=_(e.type);return t.data_id=e.data_id,i.a(e.world_tsr,t.world_tsr),i.a(e.world_tsr_inv,t.world_tsr_inv),E.copy(e.pivot,t.pivot),E.copy(e.hover_pivot,t.hover_pivot),t.init_dist=e.init_dist,t.init_fov=e.init_fov,t.is_copied=e.is_copied,t.is_copied_deep=e.is_copied_deep,e.color_id&&(t.color_id=E.clone(e.color_id)),t.outline_intensity=e.outline_intensity,t.target_cam_upside_down=e.target_cam_upside_down,E.copy(e.vertical_axis,t.vertical_axis),t.use_panning=e.use_panning,t.move_style=e.move_style,t.velocity_trans=e.velocity_trans,t.velocity_rot=e.velocity_rot,t.velocity_zoom=e.velocity_zoom,t.dof_distance=e.dof_distance,t.dof_front_start=e.dof_front_start,t.dof_front_end=e.dof_front_end,t.dof_rear_start=e.dof_rear_start,t.dof_rear_end=e.dof_rear_end,t.dof_power=e.dof_power,t.dof_bokeh_intensity=e.dof_bokeh_intensity,t.dof_bokeh=e.dof_bokeh,t.dof_foreground_blur=e.dof_foreground_blur,t.dof_object=e.dof_object,t.horizontal_limits=s.O(e.horizontal_limits),t.vertical_limits=s.O(e.vertical_limits),t.distance_limits=s.O(e.distance_limits),t.hover_vert_trans_limits=s.O(e.hover_vert_trans_limits),t.hover_horiz_trans_limits=s.O(e.hover_horiz_trans_limits),t.pivot_limits=e.pivot_limits,t.enable_hover_hor_rotation=e.enable_hover_hor_rotation,t.outline_anim_settings_default.outline_duration=e.outline_anim_settings_default.outline_duration,t.outline_anim_settings_default.outline_period=e.outline_anim_settings_default.outline_period,t.outline_anim_settings_default.outline_relapses=e.outline_anim_settings_default.outline_relapses,t.cube_reflection_id=e.cube_reflection_id,t.plane_reflection_id=e.plane_reflection_id,t.reflection_plane=e.reflection_plane,t.friction=e.friction,t.elasticity=e.elasticity,t.is_lod=e.is_lod,E.copy(e.lod_center,t.lod_center),E.copy(e.main_lod_offset,t.main_lod_offset),t.lod_dist_min=e.lod_dist_min,t.lod_dist_max=e.lod_dist_max,t.lod_lower_border_range=e.lod_lower_border_range,t.lod_upper_border_range=e.lod_upper_border_range,t.do_not_render=e.do_not_render,t.shadow_cast=e.shadow_cast,t.shadow_receive=e.shadow_receive,t.shadow_cast_only=e.shadow_cast_only,t.reflexible=e.reflexible,t.reflexible_only=e.reflexible_only,t.reflective=e.reflective,t.reflection_type=e.reflection_type,t.wind_bending=e.wind_bending,t.dynamic_geometry=e.dynamic_geometry,t.dynamic_grass=e.dynamic_grass,t.hide=e.hide,t.selectable=e.selectable,t.origin_selectable=e.origin_selectable,t.outlining=e.outlining,t.origin_outlining=e.origin_outlining,t.outline_on_select=e.outline_on_select,t.is_hair_particles=e.is_hair_particles,t.is_visible=e.is_visible,t.force_zsort=e.force_zsort,t.wind_bending_angle=e.wind_bending_angle,t.wind_bending_amp=e.wind_bending_amp,t.wind_bending_freq=e.wind_bending_freq,t.detail_bending_freq=e.detail_bending_freq,t.detail_bending_amp=e.detail_bending_amp,t.branch_bending_amp=e.branch_bending_amp,t.main_bend_col=e.main_bend_col,t.detail_bend_col=e.detail_bend_col,t.bend_center_only=e.bend_center_only,E.copy(e.center_pos,t.center_pos),t.billboard=e.billboard,t.billboard_pres_glob_orientation=e.billboard_pres_glob_orientation,t.billboard_type=e.billboard_type,t.billboard_spherical=e.billboard_spherical,t.frame_factor=e.frame_factor,t.va_frame=e.va_frame,t.va_frame_factor=e.va_frame_factor,t.max_bones=e.max_bones,t.frames_blending=e.frames_blending,t.vertex_anim=e.vertex_anim,t.use_shape_keys=e.use_shape_keys,t.shape_keys_values=s.O(e.shape_keys_values),t.is_skinning=e.is_skinning,t.anim_mixing=e.anim_mixing,t.anim_mix_factor=e.anim_mix_factor,t.anim_mix_factor_change_speed=e.anim_mix_factor_change_speed,t.anim_destination_mix_factor=e.anim_destination_mix_factor,t.blend_skel_slots.set(e.blend_skel_slots),t.skinned_renders=s.O(e.skinned_renders),t.mesh_to_arm_bone_maps=s.O(e.mesh_to_arm_bone_maps),t.skinning_data_cache=s.O(e.skinning_data_cache),t.quats_before=s.O(e.quats_before),t.quats_after=s.O(e.quats_after),t.trans_before=s.O(e.trans_before),t.trans_after=s.O(e.trans_after),t.bone_pointers=s.O(e.bone_pointers),t.bone_skinning_info=s.O(e.bone_skinning_info),t.pose_data=s.O(e.pose_data),t.arm_rel_trans=s.O(e.arm_rel_trans),t.arm_rel_quat=s.O(e.arm_rel_quat),n.o(e.bb_original,t.bb_original),n.o(e.bb_local,t.bb_local),n.o(e.bb_world,t.bb_world),n.u(e.bs_local,t.bs_local),n.u(e.bs_world,t.bs_world),n.s(e.be_local,t.be_local),n.s(e.be_world,t.be_world),n.p(e.bcap_local,t.bcap_local),n.r(e.bcyl_local,t.bcyl_local),n.q(e.bcon_local,t.bcon_local),t.pass_index=e.pass_index,t}function a(e,t,_){return _||(_=e),{name:e,uuid:s._4(),origin_name:_,type:t,materials:[],is_meta:!0,_bpy_obj:null,mat_inheritance_data:{original_mat_names:[],is_disabled:[]},is_dynamic:!1,is_hair_dupli:!1,use_default_animation:!1,is_boundings_overridden:!1,render:null,constraint:null,sfx:null,light:null,armobj:null,anchor:null,field:null,metatags:null,custom_prop:null,scenes_data:[],vertex_anim:[],cons_descends:s.S(),cons_armat_bone_descends:s.S(),anim_slots:[],reflective_objs:[],nla_events:[],action_anim_cache:[],sensor_manifolds:null,sensor_manifolds_arr:[],parent:null,parent_is_dupli:!1,parent_bone:"",viewport_alignment:null,pinverse_tsr:null,use_obj_physics:!1,collision_id:"",correct_bounding_offset:"AUTO",is_vehicle:!1,is_character:!1,is_floating:!1,bob_synchronize_pos:!1,physics:null,vehicle:null,floater:null,vehicle_settings:null,floating_settings:null,character_settings:null,physics_constraints:[],physics_settings:{physics_type:"NO_COLLISION",use_ghost:!1,use_sleep:!1,mass:0,velocity_min:0,velocity_max:0,damping:0,rotation_damping:0,lock_location_x:!1,lock_location_y:!1,lock_location_z:!1,lock_rotation_x:!1,lock_rotation_y:!1,lock_rotation_z:!1,collision_margin:0,collision_group:0,collision_mask:0,use_collision_bounds:!1,collision_bounds_type:"BOX",use_collision_compound:!1},outline_animation:{time_start:0,outline_time:0,period:0,relapses:0},anim_behavior_def:0,def_action_slots:[],need_update_transform:!1,need_inv_zup_tsr:!1,meta_objects:[]}}function l(e){return{scene:e,is_active:!1,batches:[],batch_world_bounds:[],plane_refl_subs:[],cube_refl_subs:null,shadow_subscenes:[],light_index:0,obj_has_nla_on_scene:!1,cameras:[],shadow_cameras:[]}}function T(e){if(!(e instanceof Object))return e;var t=null,_=null,r=null,a=null,n=null,o=null;e.textures&&(t=e.textures,e.textures=null),e.texture_names&&(_=e.texture_names,e.texture_names=null),e.bpy_tex_names&&(r=e.bpy_tex_names,e.bpy_tex_names=null),e.shape_keys&&(a=e.shape_keys,e.shape_keys=null),e.shader&&(n=e.shader,e.shader=null),e.vaos&&(o=e.vaos,e.vaos=null);var i,E=e.constructor;switch(E){case Int8Array:case Uint8Array:case Uint8ClampedArray:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:i=new E(e);break;case Array:i=new E(e.length);for(var c=0;c<e.length;c++)i[c]=T(e[c]);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:i=e;break;case WebGLFramebuffer:case WebGLRenderbuffer:case WebGLTexture:case WebGLBuffer:i=null;break;case Function:i=e;break;default:i=new E;for(var l in e)i[l]=T(e[l])}return t&&(i.textures=t,e.textures=t),_&&(i.texture_names=_,e.texture_names=_),r&&(i.bpy_tex_names=r,e.bpy_tex_names=r),a&&(i.shape_keys=a,e.shape_keys=a),n&&(i.shader=n,e.shader=n),o&&(i.vaos=s.S(),e.vaos=o),i}function d(e){return e.is_dynamic}function u(e,t){n.o(t,e.bb_local),n.h(e.bb_local,e.world_tsr,e.bb_world)}function f(e,t,_){e.bs_local=n.l(t,_),n.k(e.bs_local,e.world_tsr,e.bs_world)}function P(e,t,_,r,a,o){e.be_local=n.e(t,_,r,o),E.scale(e.be_local.axis_x,a[0],e.be_local.axis_x),E.scale(e.be_local.axis_y,a[1],e.be_local.axis_y),E.scale(e.be_local.axis_z,a[2],e.be_local.axis_z),n.i(e.be_local,e.world_tsr,e.be_world)}function A(e,t,_,r){e.bcyl_local=n.d(t,r),e.bcap_local=n.b(_,r),e.bcon_local=n.c(t,r)}function S(e,t,_,r,a,o){e.bbr_local=n.O(o,t,_,r,a),n.j(e.bbr_local,e.world_tsr,e.bbr_world)}function p(e,t,_){n.h(e.bounds_local.bb,t,_.bb),e.use_be&&n.i(e.bounds_local.be,t,_.be),n.k(e.bounds_local.bs,t,_.bs)}function O(e,t){for(var _=e.scenes_data,r=0;r<_.length;r++){var a=_[r];if(a.scene==t)return a}return null}function v(e){return e.parent_is_dupli?e.parent:e.parent?v(e.parent):null}var m=Object(o.a)(e),N=m.defaults,g=1/0;t.LOD_DIST_MAX_INFINITY=g,t.create_render=_,t.clone_render=r,t.create_object=a,t.init_scene_data=l,t.copy_bpy_object_props_by_link=function(e){return e instanceof Array?e.slice():e},t.copy_object_props_by_value=T,t.is_dynamic=d,t.is_dynamic_mesh=function(e){return"MESH"==e.type&&e.is_dynamic},t.append_scene_data=function(e,t){var _=l(t);e.scenes_data.push(_)},t.append_batch=function(e,t,_){var r=e.render,a=O(e,t);a.batches.push(_);var o=n.L();p(_,r.world_tsr,o),a.batch_world_bounds.push(o)},t.update_render_bounds_billboard=function(e,t){var _=e.render,r=Math.max(Math.abs(t.max_x),Math.abs(t.min_x)),a=Math.max(Math.abs(t.max_y),Math.abs(t.min_y)),o=Math.max(Math.abs(t.max_z),Math.abs(t.min_z)),i=Math.sqrt(r*r+a*a+o*o),s=Math.sqrt(r*r+a*a),E=n.w();E.max_x=E.max_y=E.max_z=i,E.min_x=E.min_y=E.min_z=-i,u(_,E),f(_,i,[0,0,0]),P(_,[1,0,0],[0,1,0],[0,0,1],[i,i,i],[0,0,0]),d(e)?A(_,s,s,E):S(_,[1,0,0],[0,1,0],[0,0,1],[i,i,i],[0,0,0])},t.update_render_bounds_from_bpy=function(e,t,_){var r=e.render,a=_.bs_rad,n=_.bc_rad,o=_.bs_cen,i=_.be_cen,s=_.caxis_x,E=_.caxis_y,c=_.caxis_z,l=_.be_ax,T=_.rbb.rbb_c,p=_.rbb.rbb_s;u(r,t),f(r,a,o);var O=d(e);P(r,O?s:[1,0,0],O?E:[0,1,0],O?c:[0,0,1],l,i),d(e)?A(r,n,n,r.bb_local):S(r,s,E,c,p,T)},t.update_render_bounds_from_pos_arrays=function(e,t,_){for(var r=e.render,a=t.max_x-t.min_x,n=t.max_y-t.min_y,o=t.max_z-t.min_z,i=(t.max_x+t.min_x)/2,s=(t.max_y+t.min_y)/2,E=(t.max_z+t.min_z)/2,c=i,l=s,T=Math.max(a,Math.max(n,o))/2,p=Math.max(a,n)/2,O=[i/(a||1),s/(n||1),E/(o||1)],v=.5,m=0;m<_.length;m++)for(var N=_[m],g=0;g<N.length;g+=3){var R=N[g],I=N[g+1],b=N[g+2],h=Math.sqrt((i-R)*(i-R)+(s-I)*(s-I)+(E-b)*(E-b));if(h>T){var Y=i-T*(R-i)/h,L=s-T*(I-s)/h,M=E-T*(b-E)/h;i=(Y+R)/2,s=(L+I)/2,E=(M+b)/2,T=Math.sqrt((i-R)*(i-R)+(s-I)*(s-I)+(E-b)*(E-b))}var x=Math.sqrt((c-R)*(c-R)+(l-I)*(l-I));if(x>p){var Y=c-p*(R-c)/x,L=l-p*(I-l)/x;c=(Y+R)/2,l=(L+I)/2,p=Math.sqrt((c-R)*(c-R)+(l-I)*(l-I))}R/=a||1,I/=n||1,b/=o||1;var y=Math.sqrt((O[0]-R)*(O[0]-R)+(O[1]-I)*(O[1]-I)+(O[2]-b)*(O[2]-b));if(y>v){var Y=O[0]-v*(R-O[0])/y,L=O[1]-v*(I-O[1])/y,M=O[2]-v*(b-O[2])/y;O[0]=(Y+R)/2,O[1]=(L+I)/2,O[2]=(M+b)/2,v=Math.sqrt((O[0]-R)*(O[0]-R)+(O[1]-I)*(O[1]-I)+(O[2]-b)*(O[2]-b))}}var U=a?a*O[0]:t.max_x,w=n?n*O[1]:t.max_y,C=o?o*O[2]:t.max_z,D=v*a,F=v*n,G=v*o;if(u(r,t),f(r,T,[i,s,E]),P(r,[1,0,0],[0,1,0],[0,0,1],[D,F,G],[U,w,C]),d(e))A(r,p,p,r.bb_local);else{S(r,[(r.bb_local.max_x-r.bb_local.min_x)/2,0,0],[0,(r.bb_local.max_y-r.bb_local.min_y)/2,0],[0,0,(r.bb_local.max_z-r.bb_local.min_z)/2],[1,1,1],[(r.bb_local.max_x+r.bb_local.min_x)/2,(r.bb_local.max_y+r.bb_local.min_y)/2,(r.bb_local.max_z+r.bb_local.min_z)/2])}},t.update_world_bounds_from_batch_tsr=p,t.remove_scene_data=function(e,t){for(var _=e.scenes_data,r=0;r<_.length;r++){if(_[r].scene==t){_.splice(r,1);break}}},t.get_scene_data=O,t.update_refl_objects=function(e,t){for(var _=0;_<e.length;_++)c.copy(t,e[_].render.reflection_plane)},t.scene_data_set_active=function(e,t,_){for(var r=0;r<e.scenes_data.length;r++){var a=e.scenes_data[r];_&&a.scene!=_||(a.is_active=t)}},t.scene_data_remove_batch=function(e,t){e.batches.splice(t,1),e.batch_world_bounds.splice(t,1)},t.get_shadow_lamps=function(e,t){for(var _=[],r=t?N.max_cast_lamps-1:N.max_cast_lamps,a=0;a<e.length;a++){var n=e[a];n.light.generate_shadows&&_.length<r&&_.push(n)}return _.length?_:e[0]?[e[0]]:[]},t.meta_obj_append_render=function(e,t){i.l(t.world_tsr),t.color_id=null,e.render=t},t.check_obj_soft_particles_accessibility=function(e,t){if(t.b4w_enable_soft_particles&&t.b4w_particles_softness>0){var _=t.material-1,r=e.materials;if(_>=0&&_<r.length&&("ADD"==r[_].blend_mode||"ALPHA"==r[_].blend_mode||"ALPHA_SORT"==r[_].blend_mode))return!0}return!1},t.check_inv_zup_tsr_is_needed=function(e){for(var t=e.scenes_data,_=0;_<t.length;_++)for(var r=t[_].batches,a=0;a<r.length;a++)for(var n=r[a].shaders_info.directives,o=0;o<n.length;o++){var i=n[o];if("USE_MODEL_TSR_INVERSE"==i[0]&&"1"==i[1])return!0}return!1},t.gen_dupli_name=function(e,t){return e+"*"+t},t.get_parent=function(e){return e.parent_is_dupli?null:e.parent},t.get_dg_parent=v,t.get_dg_objects=function(e,t){for(var _=[],r=0;r<t.length;r++){var a=t[r];v(a)==e&&_.push(a)}return _},t.get_object_data_id=function(e){return e.render.data_id},t.is_mesh=function(e){return"MESH"===e.type},t.is_armature=function(e){return"ARMATURE"===e.type},t.is_speaker=function(e){return"SPEAKER"===e.type},t.is_camera=function(e){return"CAMERA"===e.type},t.is_lamp=function(e){return"LAMP"===e.type},t.is_empty=function(e){return"EMPTY"===e.type},t.is_line=function(e){return"LINE"===e.type},t.is_world=function(e){return"WORLD"===e.type}}var a=_(0),n=_(25),o=_(4),i=_(6),s=_(2),E=_(3),c=_(7),l=Object(a.a)("__obj_util",r);t.a=l},function(e,t,_){"use strict";function r(){var e=new p(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function a(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function n(e,t,_){t*=.5;var r=Math.sin(t);return _[0]=r*e[0],_[1]=r*e[1],_[2]=r*e[2],_[3]=Math.cos(t),_}function o(e,t,_){var r=e[0],a=e[1],n=e[2],o=e[3],i=t[0],s=t[1],E=t[2],c=t[3];return _[0]=r*c+o*i+a*E-n*s,_[1]=a*c+o*s+n*i-r*E,_[2]=n*c+o*E+r*s-a*i,_[3]=o*c-r*i-a*s-n*E,_}function i(e,t,_){t*=.5;var r=e[0],a=e[1],n=e[2],o=e[3],i=Math.sin(t),s=Math.cos(t);return _[0]=r*s+o*i,_[1]=a*s+n*i,_[2]=n*s-a*i,_[3]=o*s-r*i,_}function s(e,t,_){t*=.5;var r=e[0],a=e[1],n=e[2],o=e[3],i=Math.sin(t),s=Math.cos(t);return _[0]=r*s-n*i,_[1]=a*s+o*i,_[2]=n*s+r*i,_[3]=o*s-a*i,_}function E(e,t,_){t*=.5;var r=e[0],a=e[1],n=e[2],o=e[3],i=Math.sin(t),s=Math.cos(t);return _[0]=r*s+a*i,_[1]=a*s-r*i,_[2]=n*s+o*i,_[3]=o*s-n*i,_}function c(e,t){var _=e[0],r=e[1],a=e[2];return t[0]=_,t[1]=r,t[2]=a,t[3]=Math.sqrt(Math.abs(1-_*_-r*r-a*a)),t}function l(e,t,_,r){var a,n,o,i,s,E=e[0],c=e[1],l=e[2],T=e[3],d=t[0],u=t[1],f=t[2],P=t[3];return n=E*d+c*u+l*f+T*P,n<0&&(n=-n,d=-d,u=-u,f=-f,P=-P),1-n>1e-6?(a=Math.acos(n),o=Math.sin(a),i=Math.sin((1-_)*a)/o,s=Math.sin(_*a)/o):(i=1-_,s=_),r[0]=i*E+s*d,r[1]=i*c+s*u,r[2]=i*l+s*f,r[3]=i*T+s*P,r}function T(e,t){var _=e[0],r=e[1],a=e[2],n=e[3],o=_*_+r*r+a*a+n*n,i=o?1/o:0;return t[0]=-_*i,t[1]=-r*i,t[2]=-a*i,t[3]=n*i,t}function d(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function u(e,t){var _,r=e[0]+e[4]+e[8];if(r>0)_=Math.sqrt(r+1),t[3]=.5*_,_=.5/_,t[0]=(e[5]-e[7])*_,t[1]=(e[6]-e[2])*_,t[2]=(e[1]-e[3])*_;else{var a=0;e[4]>e[0]&&(a=1),e[8]>e[3*a+a]&&(a=2);var n=(a+1)%3,o=(a+2)%3;_=Math.sqrt(e[3*a+a]-e[3*n+n]-e[3*o+o]+1),t[a]=.5*_,_=.5/_,t[3]=(e[3*n+o]-e[3*o+n])*_,t[n]=(e[3*n+a]+e[3*a+n])*_,t[o]=(e[3*o+a]+e[3*a+o])*_}return t}function f(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}Object.defineProperty(t,"__esModule",{value:!0}),t.create=r,_.d(t,"rotationTo",function(){return O}),_.d(t,"setAxes",function(){return v}),t.identity=a,t.setAxisAngle=n,t.multiply=o,_.d(t,"mul",function(){return o}),t.rotateX=i,t.rotateY=s,t.rotateZ=E,t.calculateW=c,t.slerp=l,_.d(t,"sqlerp",function(){return m}),t.invert=T,t.conjugate=d,t.fromMat3=u,t.str=f;var P=_(3),A=_(7),S=_(27);_.d(t,"clone",function(){return A.clone}),_.d(t,"fromValues",function(){return A.fromValues}),_.d(t,"copy",function(){return A.copy}),_.d(t,"set",function(){return A.set}),_.d(t,"add",function(){return A.add}),_.d(t,"scale",function(){return A.scale}),_.d(t,"dot",function(){return A.dot}),_.d(t,"lerp",function(){return A.lerp}),_.d(t,"length",function(){return A.length}),_.d(t,"len",function(){return A.length}),_.d(t,"squaredLength",function(){return A.squaredLength}),_.d(t,"sqrLen",function(){return A.squaredLength}),_.d(t,"normalize",function(){return A.normalize});var p="undefined"!=typeof Float32Array?Float32Array:Array,O=(Math.random,function(){var e=P.create(),t=P.fromValues(1,0,0),_=P.fromValues(0,1,0);return function(r,a,o){var i=P.dot(r,a);return i<-.9999999?(P.cross(t,r,e),P.length(e)<1e-6&&P.cross(_,r,e),P.normalize(e,e),n(e,Math.PI,o),o):i>.9999999?(o[0]=0,o[1]=0,o[2]=0,o[3]=1,o):(P.cross(r,a,e),o[0]=e[0],o[1]=e[1],o[2]=e[2],o[3]=1+i,A.normalize(o,o))}}()),v=function(){var e=S.create();return function(t,_,r,a){return e[0]=_[0],e[3]=_[1],e[6]=_[2],e[1]=r[0],e[4]=r[1],e[7]=r[2],e[2]=-t[0],e[5]=-t[1],e[8]=-t[2],A.normalize(u(e,a),a)}}(),m=function(){var e=r(),t=r();return function(_,r,a,n,o,i){return l(_,n,o,e),l(r,a,o,t),l(e,t,2*o*(1-o),i),i}}()},function(e,t,_){"use strict";function r(e,t){function _(){return __||(__=r(a_)),__}function r(e){for(var t=0;t<e.length;t++){var _=e[t];if(!_._render_to_textures||!_._render_to_textures.length)return _}return null}function a(){return r_||Nt.panic("No active scene available"),r_}function U(){return!!r_}function w(){return a_}function C(e,t,_,r,a){e._render_to_textures=e._render_to_textures||[],e._nla=null;var n=e._render,o=wt.get_scene_data(e._camera,e),i=e._camera.render;n.video_textures=[];var s=e.world;n.lamps_number=_.length,n.sun_exist=G(_),n.sky_params=q(s,n.sun_exist),n.world_light_set=re(s,n.sky_params),n.world_fog_set=ae(s),n.hmd_stereo_use=!e._render_to_textures.length&&Q(o),n.anaglyph_use=!e._render_to_textures.length&&H(o),n.sidebyside_use=!e._render_to_textures.length&&j(o),n.anchor_visibility=!n.anaglyph_use&&!n.sidebyside_use&&le(e,a),n.reflection_params=z(e,t,r),n.bloom_params=J(e),n.mb_params=Z(e),n.cc_params=$(e),n.god_rays_params=ee(e),n.outline_params=te(e),n.glow_params=_e(e),n.dof=Qt.dof&&(i.dof_distance>0||i.dof_object),n.motion_blur=Qt.motion_blur&&e.b4w_enable_motion_blur,n.compositing=Qt.compositing&&e.b4w_enable_color_correction,n.antialiasing=Qt.antialiasing&&1==Qt.msaa_samples&&"NONE"!=e.b4w_antialiasing_quality,n.ssao=Qt.ssao&&e.b4w_enable_ssao,n.god_rays=Qt.god_rays&&e.b4w_enable_god_rays&&n.sun_exist,n.depth_tex=Qt.depth_tex_available,n.glow_over_blend=e.b4w_glow_settings.render_glow_over_blend,n.ssao_params=W(e);var E=X(r);switch(n.materials_params=E,n.refractions=Ee(e,E),n.shadow_params=D(e,_,r),n.water_params=B(r),n.xray=ce(r),n.soft_particles=K(r),n.shore_smoothing=k(r),n.dynamic_grass=ne(e,r),n.color_picking=oe(e,r),n.outline=ie(e,r),n.glow_materials=se(e,r),n.lod_smooth_type=e.b4w_lod_smooth_type,n.lod_hyst_interval=e.b4w_lod_hyst_interval,Qt.reflection_quality?Qt.reflection_quality:e.b4w_reflection_quality){case"LOW":n.cubemap_refl_size=qt.cube_reflect_low,n.plane_refl_size=qt.plane_reflect_low;break;case"MEDIUM":n.cubemap_refl_size=qt.cube_reflect_medium,n.plane_refl_size=qt.plane_reflect_medium;break;case"HIGH":n.cubemap_refl_size=qt.cube_reflect_high,n.plane_refl_size=qt.plane_reflect_high;break;default:n.cubemap_refl_size=qt.cube_reflect_low,n.plane_refl_size=qt.plane_reflect_low}bt.is_hidpi()?(Ft.log("%cENABLE HIDPI MODE","color: #00a"),n.aa_quality="AA_QUALITY_LOW",n.resolution_factor=1,Qt.msaa_samples=1):Qt.msaa_samples>1?(Ft.log("%cENABLE MSAA RENDERING: "+Qt.msaa_samples+"x","color: #00a"),n.resolution_factor=1):(n.aa_quality="AA_QUALITY_"+e.b4w_antialiasing_quality,Qt.quality===It.P_ULTRA?n.resolution_factor=1.33:n.resolution_factor=1);var c=function(e,t){return t.source_size-e.source_size},l=e._render_to_textures.sort(c);n.graph=kt.create_rendering_graph(n,o,i,l),n.queue=[],n.need_shadow_update=!1,n.need_grass_map_update=!1,n.need_outline=!1,n.wind=new Float32Array(3),a_.push(e),n_||(n_=Yt.create()),Yt.append_node_attr(n_,e);for(var T=0;T<t.length;T++)wt.scene_data_set_active(t[T],!0,e);var d=bt.get_container();bt.resize(d.clientWidth,d.clientHeight,!0)}function D(e,t,_){if(!F(e,t,_))return null;var r=e.b4w_shadow_settings,a={};r.csm_resolution>zt.max_texture_size?(a.csm_resolution=zt.max_texture_size,Ft.error("Shadow map texture has unsupported size. Changed to "+zt.max_texture_size+".")):a.csm_resolution=r.csm_resolution,Qt.shadow_blur_samples=Qt.shadow_blur_samples?Qt.shadow_blur_samples:r.blur_samples,a.soft_shadows=r.soft_shadows;var n=Qt.ssao&&e.b4w_enable_ssao,o=wt.get_shadow_lamps(t,n);a.self_shadow_polygon_offset=r.self_shadow_polygon_offset,a.self_shadow_normal_offset=r.self_shadow_normal_offset,a.enable_csm=r.b4w_enable_csm&&1==o.length,r.b4w_enable_csm&&r.csm_num>1&&o.length>1&&Ft.warn("Disabling Cascaded Shadow Maps because of multiple shadow casting lamps."),a.lamp_types=[],a.spot_sizes=[],a.clip_start=[],a.clip_end=[];for(var i=0;i<o.length;i++)a.lamp_types.push(o[i].light.type),a.spot_sizes.push(o[i].light.spot_size),a.clip_start.push(o[i].light.clip_start),a.clip_end.push(o[i].light.clip_end),"SPOT"!=a.lamp_types[i]&&"POINT"!=a.lamp_types[i]||!a.enable_csm||(Ft.warn("Generating shadows for SPOT or POINT light. Disabling Cascaded Shadow Maps"),a.enable_csm=!1);return a.enable_csm?(a.csm_num=r.csm_num,a.csm_first_cascade_border=r.csm_first_cascade_border,a.first_cascade_blur_radius=r.first_cascade_blur_radius,a.csm_last_cascade_border=r.csm_last_cascade_border,a.last_cascade_blur_radius=r.last_cascade_blur_radius,a.fade_last_cascade=r.fade_last_cascade,a.blend_between_cascades=r.blend_between_cascades):(a.csm_num=1,a.csm_first_cascade_border=r.csm_first_cascade_border,a.first_cascade_blur_radius=r.first_cascade_blur_radius,a.csm_last_cascade_border=r.csm_last_cascade_border,a.last_cascade_blur_radius=r.last_cascade_blur_radius,a.fade_last_cascade=!1,a.blend_between_cascades=!1),a}function F(e,t,_){if(0==t.length)return!1;if(!Qt.shadows)return!1;switch(e.b4w_render_shadows){case"OFF":return!1;case"ON":return!0}var r=!1,a=!1,n=Qt.ssao&&e.b4w_enable_ssao;if(0==t.length&&!n)return!1;for(var o=0;o<_.length;o++){var i=_[o];if(i.b4w_shadow_cast&&(r=!0),i.b4w_shadow_receive&&(a=!0),(n||r)&&a)return!0}return!1}function G(e){for(var t=0;t<e.length;t++)if("SUN"==e[t].light.type)return!0;return!1}function k(e){if(!Qt.shore_smoothing)return!1;for(var t=We(e),_=0;_<t.length;_++){var r=t[_];if(r.water_settings.is_water&&r.water_settings.shore_smoothing)return!0}return!1}function K(e){for(var t=0;t<e.length;t++)for(var _=e[t],r=_.particle_systems,a=0;a<r.length;a++){var n=r[a].settings;if(wt.check_obj_soft_particles_accessibility(e[t]._object,n))return!0}return!1}function B(e){for(var t=We(e),_=[],r=0;r<t.length;r++){var a=t[r];if(a.water_settings.is_water){for(var n={},o=0;o<e.length;o++)for(var i=e[o],s=i._object.materials,E=0;E<s.length;E++){var c=s[E];c==a&&(n.water_level=i.location[2])}n.fog_color_density=new Float32Array(4),n.fog_color_density.set(a.water_settings.fog_color),n.fog_color_density[3]=a.water_settings.fog_density,a.water_settings.is_dynamic?(n.dynamic=!0,n.waves_height=a.water_settings.waves_height,n.waves_length=a.water_settings.waves_length,n.dst_noise_scale0=a.water_settings.dst_noise_scale0,n.dst_noise_scale1=a.water_settings.dst_noise_scale1,n.dst_noise_freq0=a.water_settings.dst_noise_freq0,n.dst_noise_freq1=a.water_settings.dst_noise_freq1,n.dir_min_shore_fac=a.water_settings.dir_min_shore_fac,n.dir_freq=a.water_settings.dir_freq,n.dir_noise_scale=a.water_settings.dir_noise_scale,n.dir_noise_freq=a.water_settings.dir_noise_freq,n.dir_min_noise_fac=a.water_settings.dir_min_noise_fac,n.dst_min_fac=a.water_settings.dst_min_fac,n.waves_hor_fac=a.water_settings.waves_hor_fac):(n.dynamic=!1,n.waves_height=0,n.waves_length=0),n.caustics=a.water_settings.enable_caust,n.caustic_scale=a.water_settings.caust_scale,n.caustic_brightness=a.water_settings.caust_brightness,n.caustic_speed=new Float32Array([.3,.7]),n.shoremap_image=null;for(var l=a.texture_slots,o=0;o<l.length;o++){var T=l[o].texture;if(!0===T.b4w_shore_dist_map&&"FILE"==T.image.source){n.shoremap_image=T.image,n.shoremap_tex_size=T.image.size[0],n.max_shore_dist=T.b4w_max_shore_dist;var d=T.b4w_shore_boundings;n.shoremap_center=[(d[0]+d[1])/2,(d[2]+d[3])/2],n.shoremap_size=[d[0]-d[1],d[2]-d[3]]}}_.push(n)}}if(_.length>0){var n=_[0];if(!n.dynamic)for(var r=0;r<_.length;r++)_[r].dynamic&&(n=_[r]);return n}return null}function X(e){for(var t={refractions:!1},_=We(e),r=function(e,_){if(e)for(var a=e.nodes,n=0;n<a.length;n++){var o=a[n];"GROUP"==o.type&&o.node_group&&r(o.node_group.node_tree,_),"GROUP"==o.type&&"B4W_REFRACTION"==o.node_tree_name&&(t.refractions=!0),"BSDF_TRANSPARENT"==o.type&&(o.b4w_use_alpha?_.blend_mode="ALPHA_SORT":t.refractions=!0)}},a=0;a<_.length;a++){var n=_[a];n.is_refractive&&(t.refractions=!0),n.node_tree&&r(n.node_tree,n)}return t}function H(e){return e.cameras[0].type!=Rt.TYPE_PERSP&&"ANAGLYPH"==Qt.stereo?(Ft.warn("Anaglyph stereo is disabled for the non-perspective camera"),Qt.stereo="NONE",!1):"ANAGLYPH"==Qt.stereo}function j(e){return e.cameras[0].type!=Rt.TYPE_PERSP&&"SIDEBYSIDE"==Qt.stereo?(Ft.warn("Side-by-side stereo is disabled for the non-perspective camera"),Qt.stereo="NONE",!1):"SIDEBYSIDE"==Qt.stereo}function Q(e){if("HMD"==Qt.stereo){if(e.cameras[0].type!=Rt.TYPE_PERSP)return Ft.warn("Head-mounted display stereo is disabled for the non-perspective camera"),Qt.stereo="NONE",!1;if(!Mt.can_use_device(Mt.DEVICE_HMD))return Ft.warn("Head-mounted display stereo is disabled for the non-WebVR and non-mobile devices"),Qt.stereo="NONE",!1}return"HMD"==Qt.stereo}function z(e,t,_){if(!Qt.reflections)return!1;switch(e.b4w_render_reflections){case"OFF":return!1}for(var r=[],a=0,n=!1,o=!1,i=!1,s=0;s<t.length;s++){var E=t[s];if(E.render.reflective&&"CUBE"==E.render.reflection_type&&a++,E.render.reflective&&"PBR"==E.render.reflection_type&&(o=!0),E.reflective_objs.length){for(var c=null,l=0;l<r.length;l++){if(r[l]==E){c=l;break}}null==c&&r.push(E)}}for(var s=0;s<_.length;s++){var T=_[s];T.b4w_reflexible&&(n=!0),V(T)&&(i=!0)}return{refl_plane_objs:r,num_cube_refl:a,cube_refl_subs:[],cube_refl_subs_blend:[],plane_refl_subs:[],plane_refl_subs_blend:[],has_reflexible:n,has_pbr_reflexible:o,has_blend_reflexible:i}}function V(e){if(e.b4w_reflexible){for(var t=e._object.materials,_=0;_<t.length;_++){var r=t[_].blend_mode;if("OPAQUE"!=r&&"CLIP"!=r&&"ALPHA_ANTIALIASING"!=r)return!0}return!1}}function q(e,t){var _=e.b4w_sky_settings,r={};return r.render_sky=_.render_sky||_.procedural_skydome,r.procedural_skydome=_.procedural_skydome,r.use_as_environment_lighting=_.use_as_environment_lighting,r.sky_color=_.color,r.rayleigh_brightness=_.rayleigh_brightness,r.mie_brightness=_.mie_brightness,r.spot_brightness=_.spot_brightness,r.scatter_strength=_.scatter_strength,r.rayleigh_strength=_.rayleigh_strength,r.mie_strength=_.mie_strength,r.rayleigh_collection_power=_.rayleigh_collection_power,r.mie_collection_power=_.mie_collection_power,r.mie_distribution=_.mie_distribution,r.reflexible=_.reflexible,r.reflexible_only=_.reflexible_only,!t&&_.procedural_skydome&&Ft.warn("There is no sun on the scene. Procedural sky will use a default sun position."),r}function W(e){var t={},_=e.b4w_ssao_settings;return t.radius_increase=_.radius_increase,t.hemisphere=_.hemisphere,t.blur_depth=_.blur_depth,t.blur_discard_value=_.blur_discard_value,t.influence=_.influence,t.dist_factor=_.dist_factor,t.samples=_.samples,t}function J(e){if(!Qt.bloom||!e.b4w_enable_bloom)return null;var t={},_=e.b4w_bloom_settings;return t.blur=_.blur,t.edge_lum=_.edge_lum,t.key=_.key,t.adaptive=_.adaptive,t.average_luminance=_.average_luminance,t}function Z(e){var t={},_=e.b4w_motion_blur_settings;return t.mb_decay_threshold=_.motion_blur_decay_threshold,t.mb_factor=_.motion_blur_factor,t}function $(e){var t={},_=e.b4w_color_correction_settings;return t.brightness=_.brightness,t.contrast=_.contrast,t.exposure=_.exposure,t.saturation=_.saturation,t}function ee(e){var t={},_=e.b4w_god_rays_settings;return t.intensity=_.intensity,t.max_ray_length=_.max_ray_length,t.steps_per_pass=_.steps_per_pass,t}function te(e){var t={};return t.outline_color=e.b4w_outline_color,t.outline_factor=e.b4w_outline_factor,t}function _e(e){var t={},_=e.b4w_glow_settings;return t.small_glow_mask_coeff=_.small_glow_mask_coeff,t.large_glow_mask_coeff=_.large_glow_mask_coeff,t.small_glow_mask_width=_.small_glow_mask_width,t.large_glow_mask_width=_.large_glow_mask_width,t}function re(e,t){var _=e.light_settings,r={};if(r.environment_energy=_.environment_energy,r.use_environment_light=_.use_environment_light,r.environment_color=_.environment_color,r.horizon_color=e.horizon_color.slice(0),r.zenith_color=e.zenith_color.slice(0),r.use_sky_paper=e.use_sky_paper,r.use_sky_blend=e.use_sky_blend,r.use_sky_real=e.use_sky_real,r.sky_texture_slot=null,r.sky_texture_param=null,r.environment_texture_slot=null,r.ngraph_proxy_id="",t.render_sky&&e.use_nodes&&e.node_tree){var a=e.node_tree,n=e.uuid,o=e.name,i=xt.compose_ngraph_proxy(a,n,!1,e.name+"(World)",o,"MAIN",null,[]);r.ngraph_proxy_id=i.id}var s=!0;if(r.use_environment_light&&"SKY_TEXTURE"==r.environment_color&&(!t.procedural_skydome||!t.use_as_environment_lighting)){for(var E=null,c=0;c<e.texture_slots.length;c++)if(e.texture_slots[c].texture.b4w_use_as_environment_lighting&&!e.texture_slots[c].texture.b4w_use_as_skydome){E=e.texture_slots[c];break}E?r.environment_texture_slot=E:s=!1}for(var c=0;c<e.texture_slots.length;c++)if(e.texture_slots[c].texture.b4w_use_as_skydome){var l=e.texture_slots[c];if(l.texture.image){s=!0,r.sky_texture_slot=l;var T=Math.min(zt.max_cube_map_texture_size,Ht.calc_pot_size(l.texture.image.size[0]/3));r.sky_texture_param={tex_size:T,blend_factor:l.blend_factor,horizon_factor:l.horizon_factor,zenith_up_factor:l.zenith_up_factor,zenith_down_factor:l.zenith_down_factor,color:l.color,default_value:l.default_value,invert:l.invert,use_rgb_to_intensity:l.use_rgb_to_intensity,blend_type:l.blend_type,use_map_blend:l.use_map_blend,use_map_horizon:l.use_map_horizon,use_map_zenith_up:l.use_map_zenith_up,use_map_zenith_down:l.use_map_zenith_down}}break}return r.use_environment_light=!!r.use_environment_light&&s,r}function ae(e){var t=e.fog_settings,_={};_.use_fog=t.use_fog,_.intensity=t.intensity,_.depth=t.depth,_.start=t.start,_.height=t.height,_.falloff=t.falloff,t.use_custom_color?_.color=t.color.slice(0):_.color=e.horizon_color.slice(0);var r=_.color,a=1/_.depth;return _.fog_color_density=new Float32Array([r[0],r[1],r[2],a]),_.fog_params=new Float32Array([_.intensity,_.depth,_.start,_.height]),_}function ne(e,t){if(!Qt.dynamic_grass)return!1;switch(e.b4w_render_dynamic_grass){case"OFF":return!1;case"ON":return!0}for(var _=!1,r=!1,a=0;a<t.length;a++){for(var n=t[a],o=n._object.materials,i=0;i<o.length;i++){o[i].terrain_settings.is_terrain&&(_=!0)}for(var s=n.particle_systems,i=0;i<s.length;i++){var E=s[i].settings;"HAIR"==E.type&&E.b4w_dynamic_grass&&(r=!0)}if(_&&r)return!0}return!1}function oe(e,t){if(Vt.outlining_overview_mode)return!0;if(!Qt.enable_selectable)return!1;switch(e.b4w_enable_object_selection){case"OFF":return!1;case"ON":return!0;case"AUTO":for(var _=0;_<t.length;_++)if(t[_]._object.render.selectable)return!0;return!1}}function ie(e,t){if(Vt.outlining_overview_mode)return!0;if(!Qt.enable_outlining)return!1;switch(e.b4w_enable_outlining){case"OFF":return!1;case"ON":return!0;case"AUTO":for(var _=0;_<t.length;_++)if(t[_]._object.render.outlining)return!0;return!1}}function se(e,t){if(!Qt.glow_materials)return!1;switch(e.b4w_enable_glow_materials){case"OFF":return!1;case"ON":return!0;case"AUTO":for(var _=0;_<t.length;_++)for(var r=t[_]._object.materials,a=0;a<r.length;a++)if(xt.check_material_glow_output(r[a]))return!0;return!1}}function Ee(e,t){if(!Qt.refractions)return!1;switch(e.b4w_render_refractions){case"OFF":return!1;case"ON":return!0;case"AUTO":return t.refractions}}function ce(e){for(var t=0;t<e.length;t++)for(var _=e[t]._object.materials,r=0;r<_.length;r++){var a=_[r];if(a.render_above_all&&"OPAQUE"!=a.blend_mode&&"CLIP"!=a.blend_mode&&"ALPHA_ANTIALIASING"!=a.blend_mode)return!0}return!1}function le(e,t){switch(e.b4w_enable_anchors_visibility){case"OFF":return!1;case"ON":return!0;case"AUTO":for(var _=0;_<t.length;_++){var r=t[_]._object;if(r.anchor&&r.anchor.detect_visibility)return!0}return!1}}function Te(e,t){if(e&&e._render&&e._render.graph){var _=e._render.graph,r=kt.find_subs(e._render.graph,Xt.SKY);if(r){var a=null;if(kt.traverse_slinks(_,function(e,t,_,r){if("CUBEMAP"==e.from&&_.type==Xt.SKY&&r.type==Xt.SINK)return a=e.texture,!0}),a){var n=qt.cubemap_tex_size,o=gt.get_batch_by_type(t,"SKY",e);if(o&&o.has_nodes){var i=xt.get_ngraph_proxy_cached(o.ngraph_proxy_id),s=i.graph,E=xt.get_max_env_texture_height(s);-1!=E&&(n=Ut.calc_pot_size(E/2))}else{var c=e._render,l=c.world_light_set,T=l.sky_texture_param;T&&(n=T.tex_size)}n=Math.min(n,zt.max_cube_map_texture_size),r.camera.width=n,r.camera.height=n,Ht.set_cubemap_tex_size(a,n),de(e,n);var d=kt.find_subs(e._render.graph,Xt.IRRADIANCE);if(d){d.camera.width=32,d.camera.height=32;var u=null;kt.traverse_slinks(_,function(e,t,_,r){if("CUBEMAP"==e.from&&_.type==Xt.IRRADIANCE&&r.type==Xt.MAIN_OPAQUE)return u=e.texture,!0}),u&&Ht.set_cubemap_tex_size(u,32)}var f=kt.find_subs(e._render.graph,Xt.ROUGHNESS_CONVOLUTION);if(f){f.camera.width=128,f.camera.height=128;var P=null;kt.traverse_slinks(_,function(e,t,_,r){if("CUBEMAP"==e.from&&_.type==Xt.ROUGHNESS_CONVOLUTION&&r.type==Xt.MAIN_OPAQUE)return P=e.texture,!0}),P&&Ht.set_cubemap_tex_size(P,128)}}}}}function de(e,t){for(var _=_t(e,[Xt.MAIN_OPAQUE,Xt.MAIN_BLEND,Xt.MAIN_GLOW]),r=0;r<_.length;r++)_[r].bsdf_cube_sky_dim=t}function ue(e,t){for(var _=e.scenes_data,r=0;r<_.length;r++){var a=_[r].scene,n=a._render.graph,o=kt.find_subs(a._render.graph,Xt.SKY);if(o){var i=null;if(kt.traverse_slinks(n,function(e,t,_,r){if("CUBEMAP"==e.from&&_.type==Xt.SKY&&r.type==Xt.IRRADIANCE)return i=e.texture,!0}),i){var s=Ut.calc_pot_size(t.height/2);s=Math.min(s,zt.max_cube_map_texture_size),o.camera.width=s,o.camera.height=s,Ht.set_cubemap_tex_size(i,s),de(a,s)}}}}function fe(e,t,_,r,a){switch(e.type){case Xt.MAIN_OPAQUE:Pe(e,t,_,"OPAQUE",r,a);break;case Xt.MAIN_BLEND:Pe(e,t,_,"BLEND",r,a);break;case Xt.MAIN_XRAY:Pe(e,t,_,"XRAY",r,a);break;case Xt.MAIN_GLOW:Pe(e,t,_,"GLOW",r,a);break;case Xt.MAIN_PLANE_REFLECT:case Xt.MAIN_CUBE_REFLECT:ge(e,t,_,!1,r,a);break;case Xt.MAIN_PLANE_REFLECT_BLEND:case Xt.MAIN_CUBE_REFLECT_BLEND:ge(e,t,_,!0,r,a);break;case Xt.SHADOW_RECEIVE:me(e,t,_,r,a);break;case Xt.SHADOW_CAST:Ne(e,t,_,r,a);break;case Xt.COLOR_PICKING:case Xt.COLOR_PICKING_XRAY:Ue(e,t,_,r,a);break;case Xt.OUTLINE_MASK:Fe(e,t,_,r,a);break;case Xt.GRASS_MAP:De(e,t,r,a);break;case Xt.DEBUG_VIEW:we(e,t,_,r,a)}}function Pe(e,t,_,r,a,n){for(var o=t.render,i=wt.get_scene_data(t,a),s=i.batches,E=0;E<s.length;E++){var c=s[E];if(!c.shadow_cast_only&&!c.reflexible_only&&(("MAIN"==c.type||"NODES_GLOW"==c.type||"PARTICLES"==c.type||"LINE"==c.type)&&("OPAQUE"==c.subtype&&"OPAQUE"==r||"BLEND"==c.subtype&&"BLEND"==r||"XRAY"==c.subtype&&"XRAY"==r||"NODES_GLOW"==c.type&&"GLOW"==r))){if(!n&&(Se(c,e,t,_,r,a),!gt.update_shader(c))){if("DEBUG"!==Object(y.d)())continue;gt.apply_shader(c,"error.glslv","error.glslf"),gt.update_shader(c)}var l=Xt.init_bundle(c,o,i.batch_world_bounds[E]);Xt.append_draw_data(e,l),Ce(_,e,c,!1),Oe(c)}}}function Ae(e){e.lod_settings.use_smoothing&&gt.set_batch_directive(e,"USE_LOD_SMOOTHING",1)}function Se(e,t,_,r,a,n){var o=_.render,i=n._render,s=wt.get_scene_data(_,n),E="NO_SHADOWS",c=_t(n,[Xt.SHADOW_CAST]);if(c.length&&e.shadow_receive){switch(a){case"OPAQUE":E="SHADOW_MAPPING_OPAQUE";break;case"BLEND":case"XRAY":E="SHADOW_MAPPING_BLEND";break;case"COLOR_ID":case"REFLECT":case"GLOW":E="NO_SHADOWS";break;case"SHADOW":E="SHADOW_MASK_GENERATION";break;default:Nt.panic("Wrong subscene type")}for(var l=0;l<c.length;l++)gt.assign_shadow_receive_dirs(e,n._render.shadow_params,c[l])}var T="NO_SOFT_SHADOWS";if(i.shadow_params&&i.shadow_params.soft_shadows)switch(Qt.shadow_blur_samples){case"16x":T="POISSON_X_16";break;case"8x":T="POISSON_X_8";break;case"4x":T="POISSON_X_4"}var d=e.shaders_info;if(Bt.set_directive(d,"SHADOW_USAGE",E),Bt.set_directive(d,"POISSON_DISK_NUM",T),Ae(e),e.dynamic_grass){var u=kt.find_subs(r,Xt.GRASS_MAP);u&&ve(e,u,o)}if(pe(d,t.camera),"SHADOW"!=e.type&&"COLOR_ID"!=a||e.has_nodes){var f=t.num_lights;Bt.set_directive(d,"NUM_LIGHTS",f);var P=f%2==0?f/2:Math.floor(f/2)+1;Bt.set_directive(d,"NUM_LFACTORS",P),Bt.set_directive(d,"REFLECTION_PASS","REFL_PASS_NONE"),Bt.set_directive(d,"SSAO_ONLY",0);var A=i.water_params;if(A&&(Bt.set_directive(d,"WATER_EFFECTS",1),Bt.set_directive(d,"WAVES_HEIGHT",Bt.glsl_value(A.waves_height)),Bt.set_directive(d,"WAVES_LENGTH",Bt.glsl_value(A.waves_length)),Bt.set_directive(d,"WATER_LEVEL",Bt.glsl_value(A.water_level))),t.caustics&&e.caustics){Bt.set_directive(d,"CAUSTICS",1);var S=i.shadow_params;if(S){for(var p=S.lamp_types,O=0,l=0;l<p.length;l++)"SUN"==p[l]&&(O=l);Bt.set_directive(d,"SUN_NUM",O)}Bt.set_directive(d,"CAUST_SCALE",Bt.glsl_value(t.caust_scale)),Bt.set_directive(d,"CAUST_SPEED",Bt.glsl_value(t.caust_speed,2)),Bt.set_directive(d,"CAUST_BRIGHT",Bt.glsl_value(t.caust_brightness))}var v=s.cube_refl_subs,m=s.plane_refl_subs,N=kt.find_subs(r,Xt.SKY),g=kt.find_subs(r,Xt.IRRADIANCE),R=kt.find_subs(r,Xt.ROUGHNESS_CONVOLUTION);if(-1!==e.texture_names.indexOf("u_mirrormap"))Bt.set_directive(d,"REFLECTION_TYPE","REFL_MIRRORMAP");else if(e.reflective&&g&&R&&!v&&!m.length){var I=g.camera.color_attachment;gt.append_texture(e,I,"u_cube_irradiance");var b=R.camera.color_attachment;gt.append_texture(e,b,"u_cube_r_convolution"),Bt.set_directive(d,"REFLECTION_TYPE","REFL_PBR_STANDARD")}else if(!e.reflective||v||m.length||Qt.quality==It.P_LOW)if(e.reflective&&v){var h=v.camera.color_attachment;i.reflection_params.has_reflexible||(v.force_do_not_render=!0,N&&(h=N.camera.color_attachment)),gt.append_texture(e,h,"u_cube_reflection"),Bt.set_directive(d,"REFLECTION_TYPE","REFL_CUBE")}else if(e.reflective&&m)for(var l=0;l<m.length;l++){var h=m[l].camera.color_attachment;gt.append_texture(e,h,"u_plane_reflection"),Bt.set_directive(d,"REFLECTION_TYPE","REFL_PLANE")}else Bt.set_directive(d,"REFLECTION_TYPE","REFL_NONE");else if(N){var Y=N.camera.color_attachment;gt.append_texture(e,Y,"u_sky_reflection"),Bt.set_directive(d,"REFLECTION_TYPE","REFL_PBR_SIMPLE")}else Bt.set_directive(d,"REFLECTION_TYPE","REFL_NONE");if(N)if(e.draw_proc_sky){var h=N.camera.color_attachment;gt.append_texture(e,h,"u_sky")}else N.procedural_skydome&&(e.cube_fog=N.cube_fog,Bt.set_directive(d,"PROCEDURAL_FOG",1));else Bt.set_directive(d,"PROCEDURAL_FOG",0);var L=i.world_light_set;if(L.use_environment_light)if(Bt.set_directive(d,"USE_ENVIRONMENT_LIGHT",1),"SKY_TEXTURE"==L.environment_color){if(L.environment_texture_slot){var M=L.environment_texture_slot.texture,h=Ht.get_batch_texture(L.environment_texture_slot);gt.append_texture(e,h,"u_sky_texture",M.name)}else if(N){var h=N.camera.color_attachment;gt.append_texture(e,h,"u_sky_texture")}Bt.set_directive(d,"SKY_TEXTURE",1)}else"SKY_COLOR"==L.environment_color&&Bt.set_directive(d,"SKY_COLOR",1);var x=i.world_fog_set;if(x.use_fog&&(Bt.set_directive(d,"USE_FOG",1),Bt.set_directive(d,"FOG_TYPE",x.falloff)),e.refractive&&e.blend?(Qt.depth_tex_available&&Bt.set_directive(d,"USE_REFRACTION_CORRECTION",1),"MAIN"==e.type&&e.has_nodes||"NODES_GLOW"==e.type?(Bt.set_directive(d,"REFRACTIVE",1),i.refractions?Bt.set_directive(d,"USE_REFRACTION",1):Bt.set_directive(d,"USE_REFRACTION",0)):i.refractions?Bt.set_directive(d,"REFRACTIVE",1):Bt.set_directive(d,"REFRACTIVE",0),(i.materials_params.refractions||i.refractions)&&Bt.set_directive(d,"HAS_REFRACT_TEXTURE",1)):(Bt.set_directive(d,"REFRACTIVE",0),Bt.set_directive(d,"USE_REFRACTION",0),Bt.set_directive(d,"USE_REFRACTION_CORRECTION",0)),e.water&&(Qt.shore_smoothing&&e.water_shore_smoothing&&kt.find_subs(r,Xt.DEPTH_PACK)?Bt.set_directive(d,"SHORE_SMOOTHING",1):Bt.set_directive(d,"SHORE_SMOOTHING",0),e.water_dynamic&&A&&A.waves_height?Bt.set_directive(d,"DYNAMIC",1):Bt.set_directive(d,"DYNAMIC",0)),"PARTICLES"==e.type&&Bt.set_directive(d,"COLOR_RAMP_LENGTH",e.particles_data.color_ramp_length),!e.forked_batch)for(var y=e.textures,U=0;U<y.length;U++){var h=y[U];if("SCENE"==h.source)for(var w=0;w<a_.length;w++)for(var C=a_[w],D=a_[w]._render_to_textures,F=0;F<D.length;F++)D[F]==h&&Yt.append_edge_attr(n_,C,n,null)}}}function pe(e,t){t.type==Rt.TYPE_ORTHO||t.type==Rt.TYPE_ORTHO_ASPECT||t.type==Rt.TYPE_ORTHO_ASYMMETRIC?Bt.set_directive(e,"CAMERA_TYPE","CAM_TYPE_ORTHO"):Bt.set_directive(e,"CAMERA_TYPE","CAM_TYPE_PERSP")}function Oe(e){e.textures.length>t_&&Ft.warn(e.type,"too many textures used - "+e.textures.length+" (max "+t_+'), materials "'+e.material_names.join(", ")+'"')}function ve(e,t,_){e.grass_map_dim=t.grass_map_dim;var r=t.grass_map_dim[0],a=t.grass_map_dim[1],n=t.grass_map_dim[2],o=_.bb_local,i=Math.max(o.max_x-o.min_x,o.max_y-o.min_y);n=0==n?i:Math.max(n,i),t.grass_map_dim[2]=n;var s=t.camera;Rt.set_frustum2(s,n/2,n/2,-a,-r),Rt.set_projection(s,!1);var E=e.grass_size||0;E=0==E?i:Math.max(E,i),e.grass_size=E}function me(e,t,_,r,a){for(var n=wt.get_scene_data(t,r),o=n.batches,i=0;i<o.length;i++){var s=o[i];if("SHADOW"==s.type&&"RECEIVE"==s.subtype&&s.shadow_receive&&(a||(Se(s,e,t,_,"SHADOW",r),gt.update_shader(s)))){var E=Xt.init_bundle(s,t.render,n.batch_world_bounds[i]);Xt.append_draw_data(e,E),Ce(_,e,s,!1),Oe(s)}}}function Ne(e,t,_,r,a){for(var n=!1,o=t.render,i=wt.get_scene_data(t,r),s=i.batches,E=kt.find_subs(_,Xt.GRASS_MAP),c=0;c<s.length;c++){var l=s[c];if("SHADOW"==l.type&&"CAST"==l.subtype){if(n=!0,!a){Ae(l);var T=e.num_lights;gt.set_batch_directive(l,"NUM_LIGHTS",T);var d=T%2==0?T/2:Math.floor(T/2)+1;if(gt.set_batch_directive(l,"NUM_LFACTORS",d),pe(l.shaders_info,e.camera),Bt.set_directive(l.shaders_info,"SHADOW_USAGE","SHADOW_CASTING"),l.dynamic_grass&&E&&ve(l,E,o),gt.set_batch_directive(l,"SHADOW_TEX_RES",Bt.glsl_value(r._render.shadow_params.csm_resolution)),!gt.update_shader(l))continue}l.dynamic_grass&&(r._render.shadow_params.dynamic_grass_cast=!0);var u=Xt.init_bundle(l,o,i.batch_world_bounds[c]);Xt.append_draw_data(e,u),Ce(_,e,l,!1),Oe(l)}}if(n){var f=r._render.shadow_params;he(e,r,kt.find_subs(_,Xt.MAIN_OPAQUE).camera,f,!0)}}function ge(e,t,_,r,a,n){for(var o=t.render,i=wt.get_scene_data(t,a),s=i.batches,E=0;E<s.length;E++){var c=s[E];if(("MAIN"==c.type||"PARTICLES"==c.type||"LINE"==c.type)&&("REFLECT"==c.subtype&&c.blend==r)){if(e.type==Xt.MAIN_PLANE_REFLECT||e.type==Xt.MAIN_PLANE_REFLECT_BLEND){var l=vt(a,e);if(l==o.plane_reflection_id)continue}else{var l=mt(a,e);if(l==o.cube_reflection_id)continue}if(!n){Se(c,e,t,_,"REFLECT",a);var T=c.shaders_info;if(Bt.set_directive(T,"WATER_EFFECTS",0),e.type==Xt.MAIN_PLANE_REFLECT||e.type==Xt.MAIN_PLANE_REFLECT_BLEND?Bt.set_directive(T,"REFLECTION_PASS","REFL_PASS_PLANE"):Bt.set_directive(T,"REFLECTION_PASS","REFL_PASS_CUBE"),Bt.set_directive(T,"TEXTURE_NORM",0),!gt.update_shader(c)){if("DEBUG"!==Object(y.d)())continue;gt.apply_shader(c,"error.glslv","error.glslf"),gt.update_shader(c)}}var d=Xt.init_bundle(c,o,i.batch_world_bounds[E]);Xt.append_draw_data(e,d),Ce(_,e,c,!1),Oe(c)}}}function Re(e){e._render.need_shadow_update=!0}function Ie(e){je(e);var t=rt(e,Xt.MAIN_OPAQUE),_=e._render.graph,r=!0,a=e._render.shadow_params;Yt.traverse(_,function(_,n){var o=n;o.type===Xt.SHADOW_CAST&&(he(o,e,t.camera,a,r),r=!1)})}function be(e){var t=e._render.graph;Yt.traverse(t,function(e,t){t.type===Xt.OUTLINE&&(t.draw_outline_flag=1)})}function he(e,t,_,r,a){if(0!=e.draw_data.length){var n=e.camera;if(Y.a(_.world_tsr,n.world_tsr),Y.a(_.view_tsr,n.shadow_cast_billboard_view_tsr),"SUN"===r.lamp_types[e.shadow_lamp_index]||"HEMI"===r.lamp_types[e.shadow_lamp_index]){var o=xe(e,_.world_tsr,v_),s=i.F(o,p_);if(L._27(s,n.view_matrix,s),r.enable_csm){var E=M.copy(_.csm_centers[e.csm_index],u_),c=f.invert(_.view_matrix,S_);L._27(E,c,E),L._27(E,n.view_matrix,E);var l=_.csm_radii[e.csm_index];if(a){N_=0,g_=-1/0;for(var T=2;T<s.length;T+=3)N_=Math.min(N_,s[T]),g_=Math.max(g_,s[T])}var d=v_;d.max_x=E[0]+l,d.max_y=E[1]+l,d.max_z=g_,d.min_x=E[0]-l,d.min_y=E[1]-l,d.min_z=N_}else{var d=v_,u=Le(s,d);if(u>0){var P=f.identity(S_);f.rotate(P,u,L.c,P),f.multiply(P,n.view_matrix,n.view_matrix),Y.d(n.view_matrix,n.view_tsr)}d=Me(d),Ye(e,t._render.graph)}Rt.set_frustum_asymmetric(n,d.min_x,d.max_x,d.min_y,d.max_y,-d.max_z,-d.min_z),Rt.set_projection(n,!1)}else"SPOT"!==r.lamp_types[e.shadow_lamp_index]&&"POINT"!==r.lamp_types[e.shadow_lamp_index]||Rt.set_projection(n,!1)}}function Ye(e,t){for(var _=e.camera,r=kt.get_outputs(t,e),a=0;a<r.length;a++){var n=r[a];if(n.type==Xt.MAIN_OPAQUE||n.type==Xt.SHADOW_RECEIVE||n.type==Xt.MAIN_BLEND||n.type==Xt.MAIN_XRAY)if(Qt.mac_os_shadow_hack)n.v_light_tsr.set(_.view_tsr,9*e.shadow_lamp_index);else{var o=Y.j(_.view_tsr),i=Y.h(_.view_tsr),s=Y.g(_.view_tsr);x.set(o[0],o[1],o[2],i,A_),n.v_light_ts.set(A_,4*e.shadow_lamp_index),n.v_light_r.set(s,4*e.shadow_lamp_index)}}}function Le(e,t){var _=O_;_.set(e);var r=s_/(E_-1),a=f.identity(S_);f.rotate(a,r,L.c,a);for(var n=-1,o=-1,s=0;s<E_;s++){var E=i.a(_,0,_.length,m_),c=(E.max_x-E.min_x)*(E.max_y-E.min_y);(-1==n||n-c>c_)&&(n=c,o=s,i.o(E,t)),L._27(_,a,_)}return o*r}function Me(e){var t=e.max_x-e.min_x,_=e.max_y-e.min_y;if(t&&_){var r=Math.abs(t-_)/2;t/_>i_?(e.max_y+=r,e.min_y-=r):_/t>i_&&(e.max_x+=r,e.min_x-=r)}return e.max_x+=l_,e.max_y+=l_,e.max_z+=T_,e.min_x-=l_,e.min_y-=l_,e.min_z-=T_,e}function xe(e,t,_){i.P(_);for(var r=0;r<e.draw_data.length;r++)for(var a=e.draw_data[r].bundles,n=0;n<a.length;n++){var o=a[n].batch,s=a[n].obj_render;if(o.dynamic_grass){var E=Y.f(t,P_),c=M.transformQuat(L.c,E,f_),l=-c[0],T=c[1],d=Y.i(t,f_),u=d[0]-o.grass_size*(1+l)/2,f=d[1]-o.grass_size*(1-T)/2,P=i.h(o.bounds_local.bb,s.world_tsr,m_),A=P.max_z-P.min_z,S=m_;S.min_x=u,S.min_y=f,S.min_z=o.grass_map_dim[0]-A,S.max_x=u+o.grass_size,S.max_y=f+o.grass_size,S.max_z=o.grass_map_dim[1]+A}else var S=s.bb_world;0==r&&0==n?i.o(S,_):i.D(_,S)}return _}function ye(e,t){for(var _=e._render.shadow_params,r=new Float32Array(_.csm_num),a=0;a<_.csm_num;a++)r[a]=Rt.csm_far_plane(_,t,a);return r}function Ue(e,t,_,r,a){for(var n=t.render,o=wt.get_scene_data(t,r),i=o.batches,s=0;s<i.length;s++){var E=i[s];if("COLOR_ID"==E.type&&((e.type==Xt.COLOR_PICKING&&"COLOR_ID"==E.subtype||e.type==Xt.COLOR_PICKING_XRAY&&"COLOR_ID_XRAY"==E.subtype)&&(a||(Se(E,e,t,_,"COLOR_ID",r),gt.set_batch_directive(E,"USE_OUTLINE",0),gt.update_shader(E))))){var c=Xt.init_bundle(E,n,o.batch_world_bounds[s]);Xt.append_draw_data(e,c)}}}function we(e,t,_,r,a){for(var n=t.render,o=wt.get_scene_data(t,r),i=o.batches,s=0;s<i.length;s++){var E=i[s];if("DEBUG_VIEW"==E.type){if(!a){if(E.dynamic_grass){var c=kt.find_subs(_,Xt.GRASS_MAP);c&&ve(E,c,n)}if(!gt.update_shader(E)){if("DEBUG"!==Object(y.d)())return;gt.apply_shader(E,"error.glslv","error.glslf"),gt.update_shader(E)}}var l=Xt.init_bundle(E,n,o.batch_world_bounds[s]);Xt.append_draw_data(e,l),Ce(_,e,E,!1),Oe(E)}}}function Ce(e,t,_,r){var a=Yt.node_by_attr(e,t);Yt.traverse_inputs(e,a,function(e,t,a){var n=a,o=t;if(n.active){switch(n.from){case"COLOR":case"CUBEMAP":var i=o.camera.color_attachment;break;case"DEPTH":var i=o.camera.depth_attachment;break;case"SCREEN":var i=null;break;case Xt.MAIN_CUBE_REFLECT:return;default:Nt.panic("Wrong slink")}switch(n.to){case"COLOR":case"CUBEMAP":case"DEPTH":case"NONE":case"SCREEN":case"OFFSCREEN":case"RESOLVE":case"COPY":case"u_cube_reflection":case"u_plane_reflection":break;default:if(!i){if(r)return;Nt.panic("Connection of SCREEN is forbidden")}i.w_renderbuffer&&Nt.panic("Batch texture can't use renderbuffer"),Bt.check_uniform(_.shader,n.to)&&(r?gt.replace_texture(_,i,n.to):gt.append_texture(_,i,n.to))}}});for(var n=0;n<t.slinks_internal.length;n++){var o=t.slinks_internal[n],i=t.textures_internal[n];switch(o.to){case"COLOR":case"CUBEMAP":case"DEPTH":case"NONE":case"SCREEN":case"OFFSCREEN":case"RESOLVE":case"COPY":break;default:i.w_renderbuffer&&Nt.panic("Batch texture can't use renderbuffer"),Bt.check_uniform(_.shader,o.to)&&(r?gt.replace_texture(_,i,o.to):gt.append_texture(_,i,o.to))}}}function De(e,t,_,r){for(var a=t.render,n=wt.get_scene_data(t,_),o=n.batches,i=0;i<o.length;i++){var s=o[i];if("GRASS_MAP"==s.type){if(!r&&!gt.update_shader(s)){if("DEBUG"!==Object(y.d)())continue;gt.apply_shader(s,"error.glslv","error.glslf"),gt.update_shader(s)}var E=Xt.init_bundle(s,a,n.batch_world_bounds[i]);Xt.append_draw_data(e,E);var c=e.camera,l=a.bb_world,T=e.grass_map_dim[0],d=e.grass_map_dim[1],u=e.grass_map_dim[2];0==T&&0==d?(T=l.min_z,d=l.max_z):(T=Math.min(T,l.min_z),d=Math.max(d,l.max_z));var f=(d-T)*o_;T-=f,d+=f,e.grass_map_dim[0]=T,e.grass_map_dim[1]=d,Rt.set_frustum2(c,u/2,u/2,-d,-T),Rt.set_projection(c,!1)}}}function Fe(e,t,_,r,a){for(var n=t.render,o=wt.get_scene_data(t,r),i=o.batches,s=0;s<i.length;s++){var E=i[s];if("COLOR_ID"==E.type&&("OUTLINE"==E.subtype&&(a||(Se(E,e,t,_,"COLOR_ID",r),gt.set_batch_directive(E,"USE_OUTLINE",1),gt.update_shader(E))))){var c=Xt.init_bundle(E,n,o.batch_world_bounds[s]);Xt.append_draw_data(e,c)}}}function Ge(e,t){ke(e,t);for(var _=0;_<e.cons_descends.length;_++)e.cons_descends[_].parent==e&&Ge(e.cons_descends[_],t)}function ke(e,t){if(e.render.hide=t,wt.is_lamp(e))for(var _=0;_<e.scenes_data.length;_++)for(var r=e.scenes_data[_],a=r.scene,n=_t(a,Jt),o=0;o<n.length;o++)He(e,r,n[o])}function Ke(e,t){for(var _=e.light,r=wt.get_scene_data(e,t),a=r.light_index,n=_t(t,Jt),o=0;o<n.length;o++){var i=n[o];i.light_color_intensities.set(_.color_intensity,4*a),i.need_perm_uniforms_update=!0}}function Be(e,t){for(var _=_t(t,Jt),r=e.light,a=e.render,n=wt.get_scene_data(e,t),o=Y.j(a.world_tsr),i=Y.g(a.world_tsr),s=0;s<_.length;s++){var E=_[s];switch(Xe(e,n,E),r.type){case"SUN":E.sun_quaternion.set(i),E.sun_intensity=r.color_intensity,M.copy(r.direction,E.sun_direction),E.type==Xt.SKY&&E.procedural_skydome&&(E.need_fog_update=r.need_sun_fog_update,ze(t,E));break;case"HEMI":case"POINT":case"SPOT":break;default:Ft.error("Unknown light type: "+r.type+'".')}for(var c=E.draw_data,l=0;l<c.length;l++)for(var T=c[l].bundles,d=0;d<T.length;d++){var u=T[d].batch;u.lamp_uuid_indexes&&gt.set_lamp_data(u,e)}}for(var f=rt(t,Xt.MAIN_OPAQUE),P=f.camera,A=n.shadow_subscenes,S=t._render.shadow_params,s=0;s<A.length;s++){var E=A[s],p=E.camera;Rt.set_view_trans_quat(p,o,i),he(E,t,P,S,!0),Ye(E,t._render.graph)}}function Xe(e,t,_){var r=e.render,a=e.light,n=t.light_index,o=Y.j(e.render.world_tsr),i=a.color_intensity;_.light_directions.set(a.direction,3*n),A_[0]=o[0],A_[1]=o[1],A_[2]=o[2],A_[3]=a.use_diffuse&&!r.hide?1:0,_.light_positions.set(A_,4*n),A_[0]=i[0],A_[1]=i[1],A_[2]=i[2],A_[3]=a.use_specular&&!r.hide?1:0,_.light_color_intensities.set(A_,4*n),_.need_perm_uniforms_update=!0}function He(e,t,_){var r=e.render,a=e.light,n=t.light_index,o=a.use_diffuse&&!r.hide?1:0;_.light_positions[4*n+3]=o,o=a.use_specular&&!r.hide?1:0,_.light_color_intensities[4*n+3]=o,_.need_perm_uniforms_update=!0}function je(e){var t=yt.get_scene_objs(e,"LAMP",yt.DATA_ID_ALL),_=Qt.ssao&&e.b4w_enable_ssao,r=wt.get_shadow_lamps(t,_);if(r.length)for(var a=0;a<r.length;a++)for(var n=r[a],o=n.render,i=Y.i(o.world_tsr,u_),s=Y.f(o.world_tsr,P_),E=0;E<n.scenes_data.length;E++){var c=n.scenes_data[E],l=c.shadow_subscenes;if(c.scene==e)for(var T=0;T<l.length;T++){var d=l[T],u=d.camera;Rt.set_view_trans_quat(u,i,s)}}}function Qe(e){var t=rt(e,Xt.SKY);t&&ze(e,t)}function ze(e,t){if(Ct.prerender_subs(t),Gt.draw(t),t.need_fog_update)for(var _=_t(e,Zt),r=0;r<_.length;r++)for(var a=_[r].draw_data,n=0;n<a.length;n++)for(var o=a[n].bundles,i=0;i<o.length;i++){var s=o[i];if(s.do_render){var E=s.batch;gt.check_batch_perm_uniform(E,"u_cube_fog")&&Gt.update_batch_permanent_uniform(E,"u_cube_fog")}}Ve(e)}function Ve(e){var t=rt(e,Xt.IRRADIANCE);t&&(Ct.prerender_subs(t),Gt.draw(t));var _=rt(e,Xt.ROUGHNESS_CONVOLUTION);_&&(Ct.prerender_subs(_),Gt.draw(_));var r=rt(e,Xt.BRDF);r&&(Ct.prerender_subs(r),Gt.draw(r))}function qe(e){var t=e.camera;Gt.render_target_cleanup(t.framebuffer,t.color_attachment,t.depth_attachment,t.width,t.height);for(var _=e.draw_data,r=0;r<_.length;r++)for(var a=_[r].bundles,n=0;n<a.length;n++){var o=a[n].batch;o&&gt.clear_batch(o)}}function We(e){for(var t=[],_=0;_<e.length;_++)for(var r=e[_]._object.materials,a=0;a<r.length;a++){var n=r[a];-1==t.indexOf(n)&&t.push(n)}return t}function Je(e,t,_){bt.setup_viewport_dim(e,t,_),r_&&et(r_,e,t)}function Ze(e,t,r,a){var n=t,o=r;bt.is_hidpi()&&(n*=window.devicePixelRatio,o*=window.devicePixelRatio);var i=_();if(i){var s=i._render;n*=s.resolution_factor,o*=s.resolution_factor}return n*=e.size_mult_x,o*=e.size_mult_y,a[0]=Math.floor(n),a[1]=Math.floor(o),a}function $e(e,t,_){var r=Ze(e,t,_,d_);return r[0]>zt.max_texture_size||r[1]>zt.max_texture_size?(Ft.warn("Texture size exceeds platform limits, downscaling"),Math.min(zt.max_texture_size/r[0],zt.max_texture_size/r[0])):1}function et(e,t,_){var r=e._render,a=wt.get_scene_data(e._camera,e),n=a.cameras;if(0!=_)var o=t/_;else var o=1;for(var i=0;i<n.length;i++){var s=n[i];Rt.set_aspect(s,o),Rt.set_projection(s,!1),r.shadow_params&&Rt.update_camera_shadows(s,r.shadow_params)}if(r.shadow_params){r.need_shadow_update=!0;for(var E=_t(e,[Xt.SHADOW_RECEIVE]),i=0;i<E.length;i++)E[i].need_perm_uniforms_update=!0;for(var c=_t(e,[Xt.MAIN_BLEND]),i=0;i<c.length;i++)c[i].need_perm_uniforms_update=!0}tt(e,t,_)}function tt(e,t,_){var r=e._render,a=r.graph,n=1/0;kt.traverse_slinks(a,function(e,r,a,o){e.update_dim&&(n=Math.min(n,$e(e,t,_)))}),kt.traverse_slinks(a,function(r,o,i,s){if(r.update_dim){var E,c,l;if(s&&s.type==Xt.SINK||i.is_pp&&!r.apply_resolution_factors?(E=t*r.size_mult_x,c=_*r.size_mult_y):(l=Ze(r,t,_,d_),E=l[0]*n,c=l[1]*n),o)for(var T=0;T<i.slinks_internal.length;T++){var d=i.slinks_internal[T];d==r&&Ht.resize(r.texture,E,c)}else{Ht.is_texture(r.texture)&&(Ht.resize(r.texture,E,c),r.texture.use_mipmap&&(s.last_mip_map_ind=r.texture.mipmap_count));var u=i.camera;switch(u.width=E,u.height=c,i.type){case Xt.DOF:ot(e,{dof_power:i.camera.dof_power});break;case Xt.GLOW_COMBINE:Et(e,{small_glow_mask_width:i.small_glow_mask_width,large_glow_mask_width:i.large_glow_mask_width});break;case Xt.BLOOM:st(e,{blur:i.bloom_blur});break;case Xt.RESIZE:u.width=u.color_attachment.width,u.height=u.color_attachment.height;break;case Xt.OUTLINE:var f=kt.find_input(a,i,Xt.POSTPROCESSING),P=kt.find_input(a,f,Xt.POSTPROCESSING),A=kt.find_input(a,P,Xt.POSTPROCESSING),S=kt.find_input(a,A,Xt.POSTPROCESSING);kt.set_texel_size(f,1/E,1/E),kt.set_texel_size(P,1/E,1/E),kt.set_texel_size(A,1/E,1/E),kt.set_texel_size(S,1/E,1/E);break;default:kt.set_texel_size(i,1/E,1/c)}}}})}function _t(e,t){for(var _=[],r=0;r<t.length;r++){var a=t[r];e._render.graph&&Yt.traverse(e._render.graph,function(e,t){var r=t;r.type==a&&_.push(r)})}return _}function rt(e,t){var _=e._render.graph;return kt.find_subs(_,t)}function at(e){var t=_();if(t){var r=t._render.graph;Yt.traverse(r,function(t,_){var r=_,a=r.camera;a&&a.type==Rt.TYPE_HMD_RIGHT&&(r.force_do_not_render=e)})}}function nt(e,t,_,r){for(var a=_t(e,Jt),n=0;n<a.length;n++){var o=a[n];o.horizon_color.set(_),o.zenith_color.set(r),o.environment_energy=t,o.need_perm_uniforms_update=!0}var i=kt.find_subs(e._render.graph,Xt.SKY);i&&ze(e,i)}function ot(e,t){var _=_t(e,[Xt.DOF]);if(!_.length)return Ft.error("DOF is not enabled on the scene. Check camera settings"),0;for(var r=0;r<_.length;r++)it(_[r],t,e)}function it(e,t,_){var r=e.dof_bokeh,a=r?_t(_,[Xt.COC]):[],n=_._render.graph;if("boolean"==typeof t.dof_on&&(e.camera.dof_on=t.dof_on,r))for(var o=0;o<a.length;o++)a[o].camera.dof_on=t.dof_on;if("number"==typeof t.dof_distance&&(e.camera.dof_distance=t.dof_distance,r))for(var o=0;o<a.length;o++)a[o].camera.dof_distance=t.dof_distance;if("number"==typeof t.dof_front_start&&(e.camera.dof_front_start=t.dof_front_start,r))for(var o=0;o<a.length;o++)a[o].camera.dof_front_start=t.dof_front_start;if("number"==typeof t.dof_front_end&&(e.camera.dof_front_end=t.dof_front_end,r))for(var o=0;o<a.length;o++)a[o].camera.dof_front_end=t.dof_front_end;if("number"==typeof t.dof_rear_start&&(e.camera.dof_rear_start=t.dof_rear_start,r))for(var o=0;o<a.length;o++)a[o].camera.dof_rear_start=t.dof_rear_start;if("number"==typeof t.dof_rear_end&&(e.camera.dof_rear_end=t.dof_rear_end,r))for(var o=0;o<a.length;o++)a[o].camera.dof_rear_end=t.dof_rear_end;if("number"==typeof t.dof_bokeh_intensity&&(e.camera.dof_bokeh_intensity=t.dof_bokeh_intensity,r)){var i=kt.get_inputs_by_type(n,e,Xt.POSTPROCESSING);i[0].camera.dof_bokeh_intensity=t.dof_bokeh_intensity,i[1].camera.dof_bokeh_intensity=t.dof_bokeh_intensity,i[0]=kt.find_input(n,i[0],Xt.POSTPROCESSING),i[0].camera.dof_bokeh_intensity=t.dof_bokeh_intensity}if("number"==typeof t.dof_power)if(r){var s=t.dof_power;e.camera.dof_power=s,s/=2;var E=e.camera.width,c=e.camera.height,l=[1/E,0],T=[1/E*.5,1/c*.866],d=[-1/E*.5,1/c*.866],i=kt.get_inputs_by_type(n,e,Xt.POSTPROCESSING);kt.set_texel_size_mult(i[0],s),kt.set_texel_size(i[0],d[0],d[1]),kt.set_texel_size_mult(i[1],s),kt.set_texel_size(i[1],T[0],T[1]),i[0]=kt.find_input(n,i[0],Xt.POSTPROCESSING),kt.set_texel_size_mult(i[0],s),kt.set_texel_size(i[0],l[0],l[1]),e.camera.dof_foreground_blur&&(i[0]=kt.find_input(n,i[0],Xt.COC),i[0]=kt.find_input(n,i[0],Xt.POSTPROCESSING),kt.set_texel_size(i[0],1/E,1/c),i[0]=kt.find_input(n,i[0],Xt.POSTPROCESSING),kt.set_texel_size(i[0],1/E,1/c))}else{e.camera.dof_power=t.dof_power;var u=kt.find_input(n,e,Xt.POSTPROCESSING),f=kt.find_input(n,u,Xt.POSTPROCESSING);kt.set_texel_size_mult(u,e.camera.dof_power),kt.set_texel_size(u,1/e.camera.width,1/e.camera.height),kt.set_texel_size_mult(f,e.camera.dof_power),kt.set_texel_size(f,1/e.camera.width,1/e.camera.height)}}function st(e,t){var _=_t(e,[Xt.LUMINANCE_TRUNCED]),r=_t(e,[Xt.BLOOM]);if(!_.length||!r.length)return Ft.error("Bloom is not enabled on the scene"),0;if("number"==typeof t.key)for(var a=0;a<_.length;a++)_[a].bloom_key=t.key,_[a].need_perm_uniforms_update=!0;if("number"==typeof t.edge_lum)for(var a=0;a<_.length;a++)_[a].bloom_edge_lum=t.edge_lum,_[a].need_perm_uniforms_update=!0;if("number"==typeof t.blur)for(var a=0;a<r.length;a++){r[a].bloom_blur=t.blur;for(var n=e._render.graph,o=r[a].camera.width/.5,i=r[a].camera.height/.5,s=kt.get_inputs_by_type(n,r[a],Xt.POSTPROCESSING),E=0;E<s.length;++E){var c=s[E],l=kt.find_input(n,c,Xt.POSTPROCESSING),T=o*c.bloom_blur_scale,d=i*c.bloom_blur_scale;kt.set_texel_size_mult(c,t.blur),kt.set_texel_size(c,1/T,1/d),kt.set_texel_size_mult(l,t.blur),kt.set_texel_size(l,1/T,1/d)}}if("number"==typeof t.average_luminance)for(var a=0;a<_.length;a++)_[a].adaptive_bloom||(_[a].average_luminance=t.average_luminance,_[a].need_perm_uniforms_update=!0)}function Et(e,t){var _=_t(e,[Xt.GLOW_COMBINE]);if(!_.length)return Ft.error("Glow is not enabled on the scene"),null;for(var r=0;r<_.length;r++)ct(_[r],t,e)}function ct(e,t,_){for(var r=_._render.graph,a=kt.get_inputs(r,e),n=0;n<a.length;++n){var o=a[n];if(o.type==Xt.POSTPROCESSING&&"GLOW_MASK_LARGE"==o.subtype)var i=o;if(o.type==Xt.POSTPROCESSING&&"GLOW_MASK_SMALL"==o.subtype)var s=o}var E=kt.find_input(r,i,Xt.POSTPROCESSING),c=kt.find_input(r,s,Xt.POSTPROCESSING);"number"==typeof t.small_glow_mask_coeff&&(e.small_glow_mask_coeff=t.small_glow_mask_coeff,e.need_perm_uniforms_update=!0),"number"==typeof t.large_glow_mask_coeff&&(e.large_glow_mask_coeff=t.large_glow_mask_coeff,e.need_perm_uniforms_update=!0),"number"==typeof t.small_glow_mask_width&&(e.small_glow_mask_width=t.small_glow_mask_width,kt.set_texel_size_mult(s,t.small_glow_mask_width),kt.set_texel_size(s,1/e.camera.width,1/e.camera.height),s.need_perm_uniforms_update=!0,kt.set_texel_size_mult(c,t.small_glow_mask_width),kt.set_texel_size(c,1/e.camera.width,1/e.camera.height),c.need_perm_uniforms_update=!0),"number"==typeof t.large_glow_mask_width&&(e.large_glow_mask_width=t.large_glow_mask_width,kt.set_texel_size_mult(i,t.large_glow_mask_width),kt.set_texel_size(i,1/e.camera.width,1/e.camera.height),i.need_perm_uniforms_update=!0,kt.set_texel_size_mult(E,t.large_glow_mask_width),kt.set_texel_size(E,1/e.camera.width,1/e.camera.height),E.need_perm_uniforms_update=!0)}function lt(e){e._render.need_grass_map_update=!0}function Tt(e,t,_){var r=e._render,a=r.water_params;if(!a.dynamic)return a.water_level;var n=a.waves_height,o=a.waves_length,i=a.water_level,s=M.length(r.wind)||1,E=rt(e,Xt.MAIN_OPAQUE),c=E.time;c*=s;var l=d_;l[0]=20/o*(t-.25*c),l[1]=20/o*(_-.25*c);var T=L.J(l);l[0]=17/o*(_+.1*c),l[1]=17/o*(t+.1*c);var d=L.J(l),u=T+d-1,f=a.dst_noise_scale0,P=a.dst_noise_scale1,A=a.dst_noise_freq0,S=a.dst_noise_freq1,p=d_;p[0]=f*(t+A*c),p[1]=f*(_+A*c);var O=L._54(p);p[0]=P*(_-S*c),p[1]=P*(t-S*c);var v=L._54(p),m=n*O*v;if(a.shoremap_image){var N=a.shoremap_size[0],g=a.shoremap_size[1],R=a.shoremap_center[0],I=a.shoremap_center[1],b=(t-R)/N,h=(I+_)/g;if(b+=.5,h+=.5,b>1||b<0||h>1||h<0)var Y=m;else{var x=a.shoremap_tex_size,y=r.shore_distances,U=L._7(y,x,b,h),w=a.dir_min_shore_fac,C=a.dir_freq,D=a.dir_noise_scale,F=a.dir_noise_freq,G=a.dir_min_noise_fac,k=a.dst_min_fac,K=a.max_shore_dist,B=o/K/Math.PI,X=[D/o*(t+F*c),D/o*(_+F*c)],H=Math.sqrt(U),j=n*Math.max(U,w)*Math.sin(H/B+C*c)*Math.max(L._54(X),G),Q=Math.max(H,k),Y=j*(1-Q)+m*Q;u*=U}}else var Y=m;return Y+=.05*u,i+Y}function dt(e,t,_){t.is_for_outline&&t.type==Xt.POSTPROCESSING&&_.do_render!=t.do_render&&(t.do_render=_.do_render),_.do_render||t.type!=Xt.OUTLINE||(t.draw_outline_flag=0)}function ut(e,t,_,r){var a=Yt.get_node_attr(e,t);Rt.set_attachment(a.camera,_,r),a.assign_texture=!0,Yt.traverse_outputs(e,t,function(t,a,n){var o=n;o.active&&o.from==_&&kt.check_slink_tex_conn(o)&&ft(e,t,o.to,r)}),Yt.traverse_inputs(e,t,function(t,a,n){var o=n;o.active&&o.from==_&&o.from==o.to&&ut(e,t,_,r)})}function ft(e,t,_,r){for(var a=Yt.get_node_attr(e,t),n=a.draw_data,o=0;o<n.length;o++)for(var i=n[o].bundles,s=0;s<i.length;s++){var E=i[s].batch;gt.replace_texture(E,r,_)}}function Pt(e){for(var t=_t(e,[Xt.GRASS_MAP]),_=0;_<t.length;_++){var r=t[_],a=r.camera,n=e._camera.render,o=Y.i(n.world_tsr,u_),i=f_;i[0]=0,i[1]=0,i[2]=-r.grass_map_dim[2]/2;var s=Y.f(n.world_tsr,P_);M.transformQuat(i,s,i),i[0]+=o[0],i[1]+=o[1],i[2]=0,N.identity(s),Rt.set_view_trans_quat(a,i,s)}}function At(e,t){Yt.traverse(e,function(_,r){var a=r;if(a.type==Xt.MOTION_BLUR){a.slinks_internal[0]&&a.textures_internal[0]||Nt.panic("Wrong MOTION_BLUR subscene");var n=a.slinks_internal[0],o=a.textures_internal[0];a.textures_internal[0]=a.camera.color_attachment,Yt.traverse_outputs(e,_,function(t,_,r){var a=r;a.active&&ft(e,t,a.to,o)}),ut(e,_,n.from,o),ft(e,_,n.to,a.textures_internal[0]),a.motion_blur_exp=Math.exp(-t/a.mb_factor)}})}function St(e){var t=e._render.graph;Yt.traverse(t,function(e,t){t.need_perm_uniforms_update=!0})}function pt(e){for(var t=a(),_=_t(t,[Xt.OUTLINE]),r=0;r<_.length;r++){var n=_[r];n.outline_color.set(e),n.need_perm_uniforms_update=!0}}function Ot(e){return e._render.wind}function vt(e,t){for(var _=e._render.reflection_params.plane_refl_subs,r=0;r<_.length;r++)for(var a=0;a<_[r].length;a++)if(_[r][a]==t)return r;for(var n=e._render.reflection_params.plane_refl_subs_blend,r=0;r<n.length;r++)for(var a=0;a<n[r].length;a++)if(n[r][a]==t)return r;return null}function mt(e,t){if(!e._render.reflection_params)return null;for(var _=e._render.reflection_params.cube_refl_subs,r=0;r<_.length;r++)if(_[r]==t)return r;for(var a=e._render.reflection_params.cube_refl_subs_blend,r=0;r<a.length;r++)if(a[r]==t)return r;return null}var Nt=Object(n.a)(e),gt=Object(o.a)(e),Rt=Object(s.a)(e),It=Object(E.a)(e),bt=Object(c.a)(e),ht=Object(l.a)(e),Yt=Object(T.a)(e),Lt=Object(d.a)(e),Mt=Object(u.a)(e),xt=Object(P.a)(e),yt=Object(A.a)(e),Ut=Object(S.a)(e),wt=Object(p.a)(e),Ct=Object(O.a)(e),Dt=Object(v.a)(e),Ft=Object(m.a)(e),Gt=Object(g.a)(e),kt=Object(R.a)(e),Kt=Object(I.a)(e),Bt=Object(b.a)(e),Xt=Object(h.a)(e),Ht=Object(S.a)(e),jt=It.debug_subs,Qt=It.defaults,zt=It.context_limits,Vt=It.outlining,qt=It.scenes,Wt=[Xt.GRASS_MAP,Xt.SHADOW_CAST,Xt.MAIN_OPAQUE,Xt.MAIN_BLEND,Xt.MAIN_XRAY,Xt.MAIN_GLOW,Xt.MAIN_PLANE_REFLECT,Xt.MAIN_CUBE_REFLECT,Xt.MAIN_PLANE_REFLECT_BLEND,Xt.MAIN_CUBE_REFLECT_BLEND,Xt.COLOR_PICKING,Xt.COLOR_PICKING_XRAY,Xt.SHADOW_RECEIVE,Xt.OUTLINE_MASK,Xt.DEBUG_VIEW];t.OBJECT_SUBSCENE_TYPES=Wt;var Jt=[Xt.MAIN_OPAQUE,Xt.MAIN_BLEND,Xt.MAIN_XRAY,Xt.MAIN_GLOW,Xt.MAIN_PLANE_REFLECT,Xt.MAIN_CUBE_REFLECT,Xt.GOD_RAYS,Xt.GOD_RAYS_COMBINE,Xt.SKY,Xt.MAIN_PLANE_REFLECT_BLEND,Xt.MAIN_CUBE_REFLECT_BLEND,Xt.LUMINANCE_TRUNCED,Xt.SHADOW_RECEIVE,Xt.SHADOW_CAST,Xt.COLOR_PICKING,Xt.COLOR_PICKING_XRAY,Xt.OUTLINE_MASK],Zt=[Xt.MAIN_OPAQUE,Xt.SSAO,Xt.MAIN_BLEND,Xt.MAIN_XRAY,Xt.MAIN_GLOW,Xt.MAIN_PLANE_REFLECT,Xt.MAIN_CUBE_REFLECT,Xt.MAIN_PLANE_REFLECT_BLEND,Xt.MAIN_CUBE_REFLECT_BLEND],$t=[Xt.SHADOW_CAST,Xt.MAIN_OPAQUE,Xt.MAIN_BLEND,Xt.MAIN_XRAY,Xt.MAIN_GLOW,Xt.MAIN_PLANE_REFLECT,Xt.MAIN_CUBE_REFLECT,Xt.MAIN_PLANE_REFLECT_BLEND,Xt.MAIN_CUBE_REFLECT_BLEND,Xt.COLOR_PICKING,Xt.COLOR_PICKING_XRAY,Xt.SHADOW_RECEIVE,Xt.GOD_RAYS,Xt.OUTLINE_MASK,Xt.DEBUG_VIEW],e_=[Xt.MAIN_OPAQUE,Xt.MAIN_BLEND,Xt.MAIN_XRAY,Xt.MAIN_GLOW,Xt.MAIN_PLANE_REFLECT,Xt.MAIN_CUBE_REFLECT,Xt.MAIN_PLANE_REFLECT_BLEND,Xt.MAIN_CUBE_REFLECT_BLEND],t_=8,__=null,r_=null,a_=[],n_=null,o_=1e-4,i_=2,s_=Math.PI/2,E_=10,c_=.1,l_=.005,T_=.005,d_=new Float32Array(2),u_=new Float32Array(3),f_=new Float32Array(3),P_=new Float32Array(4),A_=new Float32Array(4),S_=new Float32Array(16),p_=new Float32Array(24),O_=new Float32Array(24),v_=i.w(),m_=i.w(),N_=0,g_=-1/0,R_=new Uint8Array(4);t.create_scene_render=function(){return{}},t.set_active=function(e){r_=e,Kt.set_active_scene(e)},t.prepare_rendering=function(e,t){var _=e._render,r=kt.create_rendering_queue(_.graph);if(e==t){et(e,bt.get_viewport_width(),bt.get_viewport_height());for(var a=0;a<r.length;a++)e._render.queue.push(r[a])}else{var n=e._render_to_textures[0];et(e,n.source_size,n.source_size);for(var a=0;a<r.length;a++)t._render.queue.push(r[a])}for(var o=_t(e,$t),i=0;i<o.length;i++)o[i].wind.set(_.wind);for(var a=0;a<_.queue.length;a++)_.queue[a].type==Xt.SHADOW_CAST&&Gt.draw(_.queue[a])},t.get_main=_,t.find_main_scene=r,t.get_active=a,t.check_active=U,t.get_camera=function(e){return e._camera},t.get_all_scenes=w,t.get_rendered_scenes=function(){if(1==a_.length)return a_;for(var e=0;e<a_.length;e++){var t=a_[e]._render.graph;Yt.traverse(t,function(t,_){for(var r=_,a=r.draw_data,n=0;n<a.length;n++)for(var o=a[n].bundles,i=0;i<o.length;i++){for(var s=o[i],E=s.batch.textures,c=s.batch.bpy_tex_names,l=null,T=0;T<E.length;T++)if("SCENE"==E[T].source&&E[T].source_id==a_[e].name&&r.type!=Xt.COPY){Ft.error('Texture-scene loop detected. A scene is rendered to texture "'+c[T]+'" yet this texture belongs to the same scene.'),l=s.batch;break}if(l){var d=l.textures;l.textures=[],l.texture_names=[],gt.update_batch_material_error(l,null),gt.update_shader(l),Xt.append_draw_data(r,s);for(var T=0;T<d.length;T++){var u=d[T];Ut.cleanup_unused(u)}}}})}for(var _=[],e=0;e<a_.length;e++){var r=a_[e];if(!r._render_to_textures.length){var a=Yt.node_by_attr(n_,r);Yt.enforce_acyclic(n_,a);var t=Yt.subgraph_node_conn(n_,a,Yt.BACKWARD_DIR);t=Yt.topsort(t),Yt.traverse(t,function(e,t){_.push(t)});break}}return _},t.append_scene=C,t.append_scene_vtex=function(e,t,_){for(var r=0;r<t.length;r++){var a=t[r]._render;a&&a.is_movie&&(a.vtex_data_id=_,e._render.video_textures.push(t[r]))}},t.get_graph=function(e){return e._render.graph},t.generate_auxiliary_batches=function(e,t){Yt.traverse(t,function(_,r){var a=r,n=null;switch(a.type){case Xt.POSTPROCESSING:n=gt.create_postprocessing_batch(a.pp_effect);break;case Xt.SSAO:n=gt.create_ssao_batch(a);break;case Xt.SSAO_BLUR:n=gt.create_ssao_blur_batch(a);break;case Xt.DEPTH_PACK:n=gt.create_depth_pack_batch();break;case Xt.GOD_RAYS:var o=a.water,i=a.steps_per_pass;n=gt.create_god_rays_batch(a.pack,o,i);break;case Xt.GOD_RAYS_COMBINE:n=gt.create_god_rays_combine_batch();break;case Xt.MOTION_BLUR:n=gt.create_motion_blur_batch(a.mb_decay_threshold);break;case Xt.COC:n=gt.create_coc_batch(a.coc_type);break;case Xt.DOF:n=gt.create_dof_batch(a);var s=a.camera.dof_power;if(a.dof_bokeh){s/=2;var E=kt.get_inputs_by_type(t,a,Xt.POSTPROCESSING);kt.set_texel_size_mult(E[0],s),kt.set_texel_size_mult(E[1],s),E[0]=kt.find_input(t,E[0],Xt.POSTPROCESSING),kt.set_texel_size_mult(E[0],s)}else{var c=kt.find_input(t,a,Xt.POSTPROCESSING),l=kt.find_input(t,c,Xt.POSTPROCESSING);kt.set_texel_size_mult(c,s),kt.set_texel_size_mult(l,s)}break;case Xt.OUTLINE:n=gt.create_outline_batch();var T=kt.find_input(t,a,Xt.POSTPROCESSING),d=kt.find_input(t,T,Xt.POSTPROCESSING),u=kt.find_input(t,d,Xt.POSTPROCESSING),f=kt.find_input(t,u,Xt.POSTPROCESSING);kt.set_texel_size_mult(d,a.blur_texel_size_mult),kt.set_texel_size_mult(T,a.blur_texel_size_mult),kt.set_texel_size_mult(f,a.ext_texel_size_mult*a.outline_factor),kt.set_texel_size_mult(u,a.ext_texel_size_mult*a.outline_factor);break;case Xt.GLOW_COMBINE:n=gt.create_glow_combine_batch();break;case Xt.COMPOSITING:n=gt.create_compositing_batch();break;case Xt.ANTIALIASING:n=gt.create_antialiasing_batch(a);break;case Xt.SMAA_RESOLVE:case Xt.SMAA_EDGE_DETECTION:case Xt.SMAA_BLENDING_WEIGHT_CALCULATION:case Xt.SMAA_NEIGHBORHOOD_BLENDING:n=gt.create_smaa_batch(a.type);break;case Xt.STEREO:n=gt.create_stereo_batch(a.subtype);break;case Xt.SKY:n=gt.create_cube_sky_batch(e,a);break;case Xt.IRRADIANCE:n=gt.create_cube_irradiance_batch(e,a);break;case Xt.ROUGHNESS_CONVOLUTION:n=gt.create_cube_roughness_convolution_batch(e,a);break;case Xt.BRDF:n=gt.create_brdf_batch(e,a);break;case Xt.LUMINANCE:n=gt.create_luminance_batch();break;case Xt.AVERAGE_LUMINANCE:n=gt.create_average_luminance_batch();break;case Xt.LUMINANCE_TRUNCED:n=gt.create_luminance_truncated_batch(a.adaptive_bloom);break;case Xt.BLOOM:n=gt.create_bloom_combine_batch(a.bloom_blur_num);break;case Xt.RESIZE:n=gt.create_postprocessing_batch("NONE");break;case Xt.VELOCITY:n=gt.create_velocity_batch();break;case Xt.ANCHOR_VISIBILITY:n=gt.create_anchor_visibility_batch();break;case Xt.PERFORMANCE:n=gt.create_performance_batch()}if(n){var P=Xt.init_bundle(n,wt.create_render("NONE"));Xt.append_draw_data(a,P),Ce(t,a,n,!1),Oe(n)}})},t.append_object=function(e,t,_){switch(t.type){case"MESH":case"LINE":case"WORLD":var r=e._render.graph,a=t.render;!kt.find_subs(r,Xt.SHADOW_CAST)&&a.shadow_receive&&(a.shadow_receive=!1);for(var n=_t(e,Wt),o=0;o<n.length;o++)fe(n[o],t,r,e,_);break;case"LAMP":Be(t,e)}for(var i=wt.get_scene_data(t,e),s=i.batches,E=0;E<s.length;E++)null==s[E].shader&&"PHYSICS"!=s[E].type&&(wt.scene_data_remove_batch(i,E),E--);wt.scene_data_set_active(t,!0,e)},t.init_cube_sky_dim=Te,t.update_cube_sky_dim=ue,t.schedule_shadow_update=Re,t.update_shadow_billboard_view=function(e,t){Yt.traverse(t,function(t,_){var r=_;r.type===Xt.SHADOW_CAST&&(Y.a(e.world_tsr,r.camera.world_tsr),Y.a(e.view_tsr,r.camera.shadow_cast_billboard_view_tsr))})},t.update_shadow_receive_subs=Ye,t.get_csm_borders=ye,t.connect_render_targets_batch=Ce,t.change_visibility_rec=Ge,t.change_visibility=ke,t.is_hidden=function(e){return e.render.hide},t.remove_object_bundles=function(e,t){for(var _=0;_<e.scenes_data.length;_++)for(var r=e.scenes_data[_].scene,a=_t(r,Wt),n=0;n<a.length;n++)for(var o=a[n].draw_data,i=0;i<o.length;i++)for(var s=o[i].bundles,E=s.length-1;E>=0;E--){var c=s[E];c.obj_render==e.render&&(c.batch?void 0!==t&&-1==c.batch.material_names.indexOf(t)&&0!=c.batch.material_names.length||(gt.clear_batch(c.batch),s.splice(E,1)):s.splice(E,1))}},t.update_lamp_scene_color_intensity=Ke,t.update_lamp_scene=Be,t.update_sky_texture=function(e){for(var t=e.scenes_data,_=0;_<t.length;_++)Qe(t[_].scene)},t.update_world_texture=Qe,t.update_sky=ze,t.cleanup=function(){for(var e=0;e<a_.length;e++){var t=a_[e],_=t._render.graph;Yt.traverse(_,function(e,t){t.type!=Xt.SINK&&qe(t)}),t._render.graph=null,t._render.queue=[]}__=null,r_=null,a_.length=0,n_=null},t.make_frustum_shot=function(e,t,_){var r=Rt.extract_frustum_corners(e,e.near,e.far,null,!0),a=Dt.generate_frustum(r),n=wt.create_render("DYNAMIC");n.bb_world=n.bb_local=i.f(),n.bs_world=n.bs_local=i.g();var o=n.bs_world.radius;n.be_world=n.be_local=i.e([o,0,0],[0,o,0],[0,0,o],n.bs_world.center);var s=gt.create_shadeless_batch(a,_,.5);s.do_not_cull=!0;var E=Xt.init_bundle(s,n);Xt.append_draw_data(t,E)},t.get_scene_timeline=function(e){return[e.frame_start,e.frame_end]},t.setup_dim=Je,t.subs_array=_t,t.get_subs=rt,t.render_both_eyes=function(){at(!1)},t.render_one_eye=function(){at(!0)},t.get_environment_colors=function(e){var t=rt(e,Xt.MAIN_OPAQUE),_=t.horizon_color,r=t.zenith_color,a=[],n=[];return a[0]=_[0],a[1]=_[1],a[2]=_[2],n[0]=r[0],n[1]=r[1],n[2]=r[2],[t.environment_energy,a,n]},t.set_environment_colors=nt,t.get_sky_params=function(e){var t=rt(e,Xt.SKY);if(t&&t.procedural_skydome){var _={};return _.color=new Array(3),M.copy(t.sky_color,_.color),_.procedural_skydome=t.procedural_skydome,_.use_as_environment_lighting=t.use_as_environment_lighting,_.rayleigh_brightness=t.rayleigh_brightness,_.mie_brightness=t.mie_brightness,_.spot_brightness=t.spot_brightness,_.scatter_strength=t.scatter_strength,_.rayleigh_strength=t.rayleigh_strength,_.mie_strength=t.mie_strength,_.rayleigh_collection_power=t.rayleigh_collection_power,_.mie_collection_power=t.mie_collection_power,_.mie_distribution=t.mie_distribution,_}return null},t.get_fog_intensity=function(e){return _t(e,Zt)[0].fog_params[0]},t.get_fog_depth=function(e){return _t(e,Zt)[0].fog_params[1]},t.get_fog_start=function(e){return _t(e,Zt)[0].fog_params[2]},t.get_fog_height=function(e){return _t(e,Zt)[0].fog_params[3]},t.set_fog_intensity=function(e,t){for(var _=_t(e,Zt),r=0;r<_.length;r++){var a=_[r];a.fog_params[0]=t,a.need_perm_uniforms_update=!0}},t.set_fog_depth=function(e,t){for(var _=_t(e,Zt),r=0;r<_.length;r++){var a=_[r];a.fog_params[1]=t,a.need_perm_uniforms_update=!0}},t.set_fog_start=function(e,t){for(var _=_t(e,Zt),r=0;r<_.length;r++){var a=_[r];a.fog_params[2]=t,a.need_perm_uniforms_update=!0}},t.set_fog_height=function(e,t){for(var _=_t(e,Zt),r=0;r<_.length;r++){var a=_[r];a.fog_params[3]=t,a.need_perm_uniforms_update=!0}},t.get_fog_color_density=function(e,t){var _=t||[],r=_t(e,Zt)[0],a=r.fog_color_density;return _[0]=a[0],_[1]=a[1],_[2]=a[2],_[3]=a[3],_},t.set_fog_color_density=function(e,t){for(var _=_t(e,Zt),r=0;r<_.length;r++){var a=_[r];a.fog_color_density.set(t),a.need_perm_uniforms_update=!0}},t.get_ssao_params=function(e){var t=rt(e,Xt.SSAO),_=rt(e,Xt.SSAO_BLUR),r=rt(e,Xt.MAIN_OPAQUE);if(!t)return null;var a={};return a.quality=t.ssao_samples,a.use_hemisphere=t.ssao_hemisphere,a.use_blur_depth=_.ssao_blur_depth,a.blur_discard_value=_.ssao_blur_discard_value,a.radius_increase=t.ssao_radius_increase,a.influence=t.ssao_influence,a.dist_factor=t.ssao_dist_factor,a.ssao_only=r.ssao_only,a.ssao_white=t.ssao_white,a},t.get_dof_params=function(e){var t=rt(e,Xt.DOF);if(!t)return null;var _={};return _.dof_on=t.camera.dof_on,_.dof_bokeh=t.dof_bokeh,_.dof_distance=t.camera.dof_distance,_.dof_front_start=t.camera.dof_front_start,_.dof_front_end=t.camera.dof_front_end,_.dof_rear_start=t.camera.dof_rear_start,_.dof_rear_end=t.camera.dof_rear_end,_.dof_power=t.camera.dof_power,_.dof_bokeh_intensity=t.camera.dof_bokeh_intensity,_.dof_object=t.camera.dof_object,_},t.set_dof_params=ot,t.get_god_rays_params=function(e){var t=_t(e,[Xt.GOD_RAYS]),_=rt(e,Xt.GOD_RAYS_COMBINE);if(!t||!_)return null;var r={};r.god_rays_max_ray_length=t[0].max_ray_length,r.god_rays_intensity=_.god_rays_intensity;var a=t[0].draw_data[0].bundles[0].batch;return r.god_rays_steps=gt.get_batch_directive(a,"STEPS_PER_PASS")[1],r},t.set_god_rays_params=function(e,t){var _=_t(e,[Xt.GOD_RAYS]),r=_t(e,[Xt.GOD_RAYS_COMBINE]);if(!_.length||!r.length)return Ft.error("God Rays are not enabled on the scene"),0;if("number"==typeof t.god_rays_intensity)for(var a=0;a<r.length;a++)r[a].god_rays_intensity=t.god_rays_intensity;if("number"==typeof t.god_rays_max_ray_length)for(var n=t.god_rays_max_ray_length,a=0;a<_.length;a++)_[a].max_ray_length=n,_[a].radial_blur_step=n/_[a].steps_per_pass/(a+1),_[a].need_perm_uniforms_update=!0;if("number"==typeof t.god_rays_steps)for(var o=Bt.glsl_value(t.god_rays_steps,1),n=_[0].max_ray_length,a=0;a<_.length;a++){_[a].steps_per_pass=o,_[a].radial_blur_step=n/o/(a+1),_[a].need_perm_uniforms_update=!0;var i=_[a].draw_data[0].bundles[0],s=i.batch;gt.set_batch_directive(s,"STEPS_PER_PASS",o),gt.update_shader(s),Xt.append_draw_data(_[a],i)}for(var a=0;a<r.length;a++)r.need_perm_uniforms_update=!0},t.get_bloom_params=function(e){var t=rt(e,Xt.LUMINANCE_TRUNCED),_=rt(e,Xt.BLOOM);if(!t||!_)return null;var r={};return r.key=t.bloom_key,r.edge_lum=t.bloom_edge_lum,r.blur=_.bloom_blur,r.adaptive=t.adaptive_bloom,r.average_luminance=t.average_luminance,r},t.set_bloom_params=st,t.get_glow_material_params=function(e){var t=rt(e,Xt.GLOW_COMBINE);if(!t)return null;var _={};return _.small_glow_mask_coeff=t.small_glow_mask_coeff,_.large_glow_mask_coeff=t.large_glow_mask_coeff,_.small_glow_mask_width=t.small_glow_mask_width,_.large_glow_mask_width=t.large_glow_mask_width,_},t.set_glow_material_params=Et,t.get_wind_params=function(e){var t=Ot(e),_=M.length(t);if(0==_)return null;var r=L._38(Math.atan2(t[0],-t[1])),a={};return a.wind_dir=r,a.wind_strength=_,a},t.schedule_grass_map_update=lt,t.get_water_surface_level=Tt,t.get_water_mat_params=function(e,t){var _=e._render.water_params,r=rt(e,Xt.MAIN_OPAQUE);if(r&&_){t.waves_height=_.waves_height,t.waves_length=_.waves_length,t.water_fog_density=r.water_fog_color_density[3];var a=t.water_fog_color=[];a[0]=r.water_fog_color_density[0],a[1]=r.water_fog_color_density[1],a[2]=r.water_fog_color_density[2]}},t.set_water_params=function(e,t){var _=e._render.water_params;if(!_)return Ft.error("set_water_params() - no water parameters on the scene"),null;"number"==typeof t.dst_noise_scale0&&(_.dst_noise_scale0=t.dst_noise_scale0),"number"==typeof t.dst_noise_scale1&&(_.dst_noise_scale1=t.dst_noise_scale1),"number"==typeof t.dst_noise_freq0&&(_.dst_noise_freq0=t.dst_noise_freq0),"number"==typeof t.dst_noise_freq1&&(_.dst_noise_freq1=t.dst_noise_freq1),"number"==typeof t.dir_min_shore_fac&&(_.dir_min_shore_fac=t.dir_min_shore_fac),"number"==typeof t.dir_freq&&(_.dir_freq=t.dir_freq),"number"==typeof t.dir_noise_scale&&(_.dir_noise_scale=t.dir_noise_scale),"number"==typeof t.dir_noise_freq&&(_.dir_noise_freq=t.dir_noise_freq),"number"==typeof t.dir_min_noise_fac&&(_.dir_min_noise_fac=t.dir_min_noise_fac),"number"==typeof t.dst_min_fac&&(_.dst_min_fac=t.dst_min_fac),"number"==typeof t.waves_hor_fac&&(_.waves_hor_fac=t.waves_hor_fac),"number"==typeof t.water_dynamic&&(_.dynamic=t.water_dynamic);for(var r=_t(e,e_),a=0;a<r.length;a++){var n=r[a];"number"==typeof t.water_fog_density&&_.fog_color_density&&(n.water_fog_color_density[3]=t.water_fog_density),"object"==typeof t.water_fog_color&&_.fog_color_density&&n.water_fog_color_density.set(t.water_fog_color),n.need_perm_uniforms_update=!0}},t.get_shore_dist=function(e,t,_){var r=e._render.water_params;if(!r.shoremap_image)return 100;var a=r.shoremap_size[0],n=r.shoremap_size[1],o=r.shoremap_center[0],i=r.shoremap_center[1],s=r.max_shore_dist,E=r.water_level,c=(t[0]-o)/a,l=(i+t[1])/n;if(c+=.5,l+=.5,!(c>1||c<0||l>1||l<0)){var T=r.shoremap_tex_size,d=r_._render.shore_distances,u=s*L._7(d,T,c,l),f=(E-t[2])*_;return Math.sqrt(u*u+f*f)}},t.update=function(e,t){Gt.clear();for(var _=a()._camera.render,r=0;r<a_.length;r++){var n=a_[r],o=n._render.graph,i=n._render;if(i.water_params)var s=Y.j(_.world_tsr),E=s[2]-Tt(n,s[0],s[1]);for(var c=0;c<i.video_textures.length;c++){var l=i.video_textures[c]._render,T=l.video_file,d=l.seq_video;if((!n.b4w_use_nla||!l.use_nla)&&((T||d)&&Ht.video_is_played(l))){var u=Ht.video_get_current_frame(l),f=Ht.video_get_start_frame(l);T&&Qt.is_mobile_device&&(f-=5);var P=Ht.video_get_end_frame(l);if(u>=P&&l.use_cyclic||u<f)Ht.reset_video(l),d&&(l.seq_last_discrete_mark=Ht.seq_video_get_discrete_timemark(l,e));else if(u>=P&&!l.use_cyclic)Ht.pause_video(l);else if(Ht.video_update_is_available(l))if(T)Ht.update_video_texture(l);else{var A=Ht.seq_video_get_discrete_timemark(l,e);A!=l.seq_last_discrete_mark&&(Ht.update_seq_video_texture(l),l.seq_cur_frame++),l.seq_last_discrete_mark=A}}}Yt.traverse(o,function(t,_){var r=_;$t.indexOf(r.type)>-1&&(r.time=e),i.water_params&&(r.cam_water_depth=E)})}for(var r=0;r<a_.length;r++){var n=a_[r],i=n._render,o=i.graph,S=i.queue;if(S.length){i.need_shadow_update&&(Ie(n),i.need_shadow_update=!1),i.need_grass_map_update&&(Pt(n),i.need_grass_map_update=!1),i.need_outline&&(be(n),i.need_outline=!1),i.motion_blur&&At(o,t);for(var p=kt.find_subs(o,Xt.OUTLINE_MASK),c=0;c<S.length;c++){var O=S[c];Ct.prerender_subs(O),p&&dt(o,O,p),Gt.draw(O)}}}Qt.show_hud_debug_info&&Lt.show_debug_info(a_,t)},t.request_outline=function(e){e._render.need_outline=!0},t.get_all_subscenes=function(e){var t=e._render.graph,_=[];return Yt.traverse(t,function(e,t){_.push(t)}),_},t.get_cam_water_depth=function(){var e=rt(r_,Xt.MAIN_BLEND),t=r_;return e||t._render.water_params?e.cam_water_depth:null},t.update_scene_permanent_uniforms=St,t.set_debug_view_mode=function(e,t){e.debug_view_mode=t,e.do_render=t!=ht.DV_NONE,e.blend=t==ht.DV_TRANSPARENT_WIREFRAME,e.need_perm_uniforms_update=!0;for(var _=a(),r=0;r<e_.length;r++)for(var n=_t(_,[e_[r]]),o=0;o<n.length;o++)n[o].do_not_debug=t==ht.DV_RENDER_TIME},t.set_debug_colors_seed=function(e,t){e.debug_colors_seed=t,e.need_perm_uniforms_update=!0},t.set_render_time_threshold=function(e,t){e.debug_render_time_threshold=t,e.need_perm_uniforms_update=!0},t.set_wireframe_edge_color=function(e,t){for(var _=e.draw_data,r=0;r<_.length;r++)for(var a=_[r].bundles,n=0;n<a.length;n++){var o=a[n].batch;M.copy(t,o.wireframe_edge_color),o.shader.need_uniforms_update=!0}},t.update_force_scene=function(e,t){var _=t.field,r=e._render.wind;if(_&&"WIND"==_.type&&r){var a=t.render,n=Y.g(a.world_tsr);M.transformQuat(L.f,n,r),M.normalize(r,r),M.scale(r,_.strength,r);for(var o=_t(e,$t),i=0;i<o.length;i++)o[i].wind.set(r);return!0}return!1},t.pick_color=function(e,t,_){var r=rt(e,Xt.COLOR_PICKING);if(r){var a=jt.enabled&&(jt.subs_type===Xt.COLOR_PICKING||jt.subs_type===Xt.COLOR_PICKING_XRAY);if(a)var n=bt.canvas_to_viewport_coords(t,_,d_,r.camera);else{var o=bt.get_canvas(),i=o.clientHeight,s=o.clientWidth;Rt.set_color_pick_proj(r.camera,t,_,s,i)}Ct.prerender_subs(r),r.do_render&&Gt.draw(r);var E=rt(e,Xt.COLOR_PICKING_XRAY);if(E){f.copy(r.camera.proj_matrix,E.camera.proj_matrix),f.copy(r.camera.view_proj_matrix,E.camera.view_proj_matrix),L._0(E.camera.view_proj_matrix,E.camera.frustum_planes),Ct.prerender_subs(E),E.do_render&&Gt.draw(E);var c=E.camera}else var c=r.camera;return r.do_render||E&&E.do_render?a?(n[1]=c.height-n[1],Gt.read_pixels(c.framebuffer,n[0],n[1],1,1,R_)):Gt.read_pixels(E?E.camera.framebuffer:r.camera.framebuffer,0,0,1,1,R_):null}return Ft.error("Object Selection is not available on the scene"),null},t.set_outline_color=pt,t.get_wind=Ot,t.get_meta_tags=function(e){var t={title:"",description:""};return e.b4w_tags&&(t.title=e.b4w_tags.title,t.description=e.b4w_tags.description),t},t.get_custom_prop=function(e){return e.b4w_custom_prop},t.update_cube_reflect_subs=function(e,t){var _=u_;M.negate(t,_);for(var r=0;r<6;r++){var a=e.cube_view_matrices[r],n=e.cube_cam_frustums[r],o=e.camera;f.translate(L.j[r],_,a),f.multiply(o.proj_matrix,a,o.view_proj_matrix),L._0(o.view_proj_matrix,n)}},t.update_plane_reflect_subs=function(e,t,_){var r=e.camera;L._60(t,_,L.f,r.reflection_plane)},t.assign_scene_data_subs=function(e,t,_){var r=e._render.reflection_params;if(r&&t)for(var a=0;a<t.length;a++){var n=t[a],o=wt.get_scene_data(n,e);if(-1!=n.render.plane_reflection_id){var i=r.plane_refl_subs,s=r.plane_refl_subs_blend,E=n.render.plane_reflection_id;s.length&&E<s.length?o.plane_refl_subs=s[E]:i.length&&E<i.length&&(o.plane_refl_subs=i[E])}else if(-1!=n.render.cube_reflection_id){var c=r.cube_refl_subs,l=r.cube_refl_subs_blend,E=n.render.cube_reflection_id;l.length?o.cube_refl_subs=l[E]:c.length&&(o.cube_refl_subs=c[E])}}if(_)for(var T=Qt.ssao&&e.b4w_enable_ssao,d=wt.get_shadow_lamps(_,T),u=e._render.shadow_params,a=0;a<d.length;a++){var o=wt.get_scene_data(d[a],e);if(u)for(var f=_t(e,[Xt.SHADOW_CAST]),P=0;P<f.length;P++)a==f[P].shadow_lamp_index&&o.shadow_subscenes.push(f[P])}},t.marker_frame=function(e,t){return e.timeline_markers[t]},t.set_hmd_params=function(e){var t=a(),_=rt(t,Xt.STEREO);_&&(e.distortion_coefs&&(_.distortion_params[0]=e.distortion_coefs[0],_.distortion_params[1]=e.distortion_coefs[1],_.need_perm_uniforms_update=!0),e.chromatic_aberration_coefs&&(_.chromatic_aberration_coefs[0]=e.chromatic_aberration_coefs[0],_.chromatic_aberration_coefs[1]=e.chromatic_aberration_coefs[1],_.chromatic_aberration_coefs[2]=e.chromatic_aberration_coefs[2],_.chromatic_aberration_coefs[3]=e.chromatic_aberration_coefs[3],_.need_perm_uniforms_update=!0),e.base_line_factor&&(_.distortion_params[2]=e.base_line_factor,_.need_perm_uniforms_update=!0),e.inter_lens_factor&&(_.distortion_params[3]=e.inter_lens_factor,_.need_perm_uniforms_update=!0),null!=e.enable_hmd_stereo&&(_.enable_hmd_stereo=e.enable_hmd_stereo,_.need_perm_uniforms_update=!0))},t.multiply_size_mult=function(e,_){for(var r=w(),a=0;a<r.length;a++){var n=r[a],o=t.get_graph(n);kt.multiply_size_mult_by_graph(o,e,_)}},t.update_all_mesh_shaders=function(e){for(var t=yt.get_scene_objs(e,"LAMP",yt.DATA_ID_ALL),_=_t(e,Wt),r=0;r<_.length;r++)for(var a=_[r],n=a.draw_data,o=0;o<n.length;o++)for(var i=n[o].bundles,s=0;s<i.length;s++){var E=i[s],c=E.batch;"MAIN"==c.type&&(gt.update_batch_lights(c,t,e),gt.update_shader(c),Xt.append_draw_data(a,E))}},t.recalculate_draw_data=function(e){for(var t=0;t<a_.length;t++){var _=a_[t]._render.graph;Yt.traverse(_,function(t,_){for(var r=_,a=r.draw_data,n=0;n<a.length;n++)for(var o=a[n].bundles,i=0;i<o.length;i++){var s=o[i];s.batch==e&&Xt.append_draw_data(r,s)}})}}}var a=_(0),n=_(5),o=_(16),i=_(25),s=_(14),E=_(4),c=_(15),l=_(45),T=_(31),d=_(51),u=_(38),f=_(21),P=_(61),A=_(12),S=_(17),p=_(8),O=_(89),v=_(63),m=_(1),N=_(9),g=_(22),R=_(64),I=_(23),b=_(34),h=_(11),Y=_(6),L=_(2),M=_(3),x=_(7),y=_(46),U=Object(a.a)("__scenes",r);t.a=U},function(e,t,_){"use strict";function r(e,t){function _(e,t){e.num_lights=t,e.light_directions=new Float32Array(3*t),e.light_positions=new Float32Array(4*t),e.light_color_intensities=new Float32Array(4*t)}function r(e){var t={type:e,subtype:"",force_do_not_render:!1,do_render:!1,enqueue:!1,clear_color:!1,clear_depth:!1,depth_test:!1,blend:!1,pack:!1,assign_texture:!1,need_fog_update:!1,need_perm_uniforms_update:!1,debug_render_calls:0,debug_render_time:0,debug_render_time_queries:[],debug_view_mode:0,debug_colors_seed:0,debug_render_time_threshold:1,do_not_debug:!1,time:0,camera:null,cube_view_matrices:null,cube_cam_frustums:[],draw_data:[],slinks_internal:[],textures_internal:[],wind:new Float32Array(3),grass_map_dim:new Float32Array(3),fog_color_density:new Float32Array(4),fog_params:new Float32Array(4),cube_fog:new Float32Array(16),sky_tex_default_value:0,environment_energy:0,num_lights:0,light_directions:null,light_positions:null,light_color_intensities:null,light_factors:null,horizon_color:new Float32Array(3),zenith_color:new Float32Array(3),sky_tex_fac:new Float32Array(4),sun_intensity:new Float32Array(3),sun_direction:new Float32Array([0,0,1]),sun_quaternion:new Float32Array(4),sky_tex_color:new Float32Array(3),sky_ngraph_proxy_id:"",bsdf_cube_sky_dim:0,outline_factor:0,draw_outline_flag:0,is_for_outline:!1,outline_color:new Float32Array(3),water:!1,cam_water_depth:0,water_fog_color_density:new Float32Array(4),water_level:0,caustics:!1,caust_scale:0,caust_speed:new Float32Array(2),caust_brightness:0,procedural_skydome:!1,use_as_environment_lighting:!1,mie_brightness:0,rayleigh_brightness:0,spot_brightness:0,mie_strength:0,rayleigh_strength:0,scatter_strength:0,mie_collection_power:0,rayleigh_collection_power:0,mie_distribution:0,sky_color:new Float32Array(3),ssao_hemisphere:!1,ssao_blur_depth:!1,ssao_blur_discard_value:0,ssao_radius_increase:0,ssao_influence:0,ssao_dist_factor:0,ssao_samples:0,ssao_only:!1,ssao_white:!1,brightness:0,contrast:0,exposure:0,saturation:0,god_rays_intensity:0,max_ray_length:0,radial_blur_step:0,steps_per_pass:0,csm_index:0,self_shadow_polygon_offset:0,self_shadow_normal_offset:0,v_light_ts:null,v_light_r:null,v_light_tsr:null,p_light_matrix:null,is_pp:!1,fxaa_quality:"",bloom_key:0,bloom_blur:0,bloom_edge_lum:0,adaptive_bloom:!0,average_luminance:0,blur_texel_size_mult:0,ext_texel_size_mult:0,mb_decay_threshold:0,mb_factor:0,motion_blur_exp:0,pp_effect:"",dof_bokeh:!1,coc_type:"",jitter_projection_space:new Float32Array(2),last_mip_map_ind:0,bloom_blur_num:2,bloom_blur_scale:.5,small_glow_mask_width:0,large_glow_mask_width:0,small_glow_mask_coeff:0,large_glow_mask_coeff:0,texel_size_multiplier:0,texel_size:new Float32Array(2),texel_mask:new Float32Array(2),distortion_params:new Float32Array(4),chromatic_aberration_coefs:new Float32Array(4),enable_hmd_stereo:!1,shadow_lamp_index:0,need_draw_data_sort:!0,sky_invert:!1,sky_use_rgb_to_intensity:!1,sky_use_map_blend:!1,sky_use_map_horizon:!1,sky_use_map_zenith_up:!1,sky_use_map_zenith_down:!1,sky_blend_type:"",use_sky_blend:!1,use_sky_paper:!1,use_sky_real:!1};return t.do_render=!0,t.enqueue=!0,t.clear_color=!0,t.clear_depth=!0,t.depth_test=!0,t.need_perm_uniforms_update=!0,t.texel_size_multiplier=1,t.texel_mask[0]=1,t.texel_mask[1]=1,t.distortion_params[2]=.5,t.distortion_params[3]=.5,t.ssao_samples=8,t}function a(e,t,_){var r=t;r.fog_color_density&&e.water_fog_color_density.set(r.fog_color_density),e.water_level=r.water_level,r.caustics&&_&&(e.caustics=!0,e.caust_scale=r.caustic_scale,e.caust_brightness=r.caustic_brightness,e.caust_speed.set(r.caustic_speed))}function c(e,t,_,r,a){return{shader:e,bundles:[t],alpha_antialiasing:_,offset_z:r,is_sky:a,do_render:!0,z_index:1/0}}function l(e,t,_,r,a){for(var n=0;n<e.length;n++){var o=e[n];if(o.shader==t&&o.alpha_antialiasing==_&&o.offset_z==r&&o.is_sky==a)return o}return null}function T(e,t){return e==t?0:e>t?1:-1}function d(e,t){return T(e.alpha_antialiasing,t.alpha_antialiasing)||T(e.is_sky,t.is_sky)||T(e.offset_z,t.offset_z)||T(e.shader.has_discard,t.shader.has_discard)||T(e.z_index,t.z_index)}var u=Object(n.a)(e),f=Object(o.a)(e),P=Object(i.a)(e),A=P.outlining;t.MAIN_OPAQUE=0,t.MAIN_BLEND=1,t.MAIN_XRAY=2,t.MAIN_PLANE_REFLECT=3,t.MAIN_CUBE_REFLECT=4,t.MAIN_PLANE_REFLECT_BLEND=5,t.MAIN_CUBE_REFLECT_BLEND=6,t.MAIN_GLOW=7,t.SHADOW_CAST=8,t.SHADOW_RECEIVE=9,t.GRASS_MAP=10,t.POSTPROCESSING=11,t.GLOW_COMBINE=13,t.RESOLVE=14,t.COLOR_PICKING=15,t.COLOR_PICKING_XRAY=16,t.DEBUG_VIEW=17,t.ANCHOR_VISIBILITY=18,t.DEPTH_PACK=19,t.SSAO=20,t.SSAO_BLUR=21,t.ANTIALIASING=22,t.SMAA_BLENDING_WEIGHT_CALCULATION=23,t.SMAA_EDGE_DETECTION=24,t.SMAA_RESOLVE=25,t.SMAA_NEIGHBORHOOD_BLENDING=26,t.COMPOSITING=27,t.MOTION_BLUR=28,t.COC=29,t.DOF=30,t.OUTLINE_MASK=31,t.OUTLINE=32,t.GOD_RAYS=33,t.GOD_RAYS_COMBINE=34,t.SKY=35,t.COPY=36,t.STEREO=37,t.LUMINANCE=38,t.AVERAGE_LUMINANCE=39,t.LUMINANCE_TRUNCED=40,t.BLOOM=41,t.VELOCITY=42,t.SINK=43,t.PERFORMANCE=44,t.RESIZE=45,t.IRRADIANCE=46,t.ROUGHNESS_CONVOLUTION=47,t.BRDF=48,t.create_subs_shadow_cast=function(e,t,a,n){var o=r(8);switch(o.csm_index=e,o.self_shadow_polygon_offset=a.self_shadow_polygon_offset,o.shadow_lamp_index=t,a.lamp_types[t]){case"SPOT":case"POINT":o.camera=f.create_camera(f.TYPE_PERSP);var i=a.spot_sizes[t],s=a.clip_start[t],E=a.clip_end[t];f.set_frustum(o.camera,i,s,E);break;default:o.camera=f.create_camera(f.TYPE_ORTHO_ASYMMETRIC)}return _(o,n),o},t.clone_subs=function(e){var t=r(e.type);return t.subtype=e.subtype,t.force_do_not_render=e.force_do_not_render,t.do_render=e.do_render,t.enqueue=e.enqueue,t.clear_color=e.clear_color,t.clear_depth=e.clear_depth,t.depth_test=e.depth_test,t.blend=e.blend,t.pack=e.pack,t.assign_texture=e.assign_texture,t.need_fog_update=e.need_fog_update,t.need_perm_uniforms_update=e.need_perm_uniforms_update,t.debug_render_calls=0,t.debug_render_time=0,t.debug_render_time_queries=[],t.debug_view_mode=e.debug_view_mode,t.debug_colors_seed=e.debug_colors_seed,t.debug_render_time_threshold=e.debug_render_time_threshold,t.do_not_debug=e.do_not_debug,t.time=e.time,t.camera=f.clone_camera(e.camera,!0),t.cube_view_matrices=s.O(e.cube_view_matrices),t.cube_cam_frustums=s.O(e.cube_cam_frustums),t.draw_data=s.O(e.draw_data),t.slinks_internal=s.O(e.slinks_internal),t.textures_internal=s.O(e.textures_internal),t.wind.set(e.wind),t.grass_map_dim.set(e.grass_map_dim),t.fog_color_density.set(e.fog_color_density),t.fog_params.set(e.fog_params),t.cube_fog.set(e.cube_fog),t.sky_tex_default_value=e.sky_tex_default_value,t.environment_energy=e.environment_energy,t.num_lights=e.num_lights,t.light_directions=s.O(e.light_directions),t.light_positions=s.O(e.light_positions),t.light_color_intensities=s.O(e.light_color_intensities),t.light_factors=s.O(e.light_factors),t.horizon_color.set(e.horizon_color),t.zenith_color.set(e.zenith_color),t.sky_tex_fac.set(e.sky_tex_fac),t.sun_intensity.set(e.sun_intensity),t.sun_direction.set(e.sun_direction),t.sun_quaternion.set(e.sun_quaternion),t.sky_tex_color.set(e.sky_tex_color),t.sky_ngraph_proxy_id=e.sky_ngraph_proxy_id,t.bsdf_cube_sky_dim=e.bsdf_cube_sky_dim,t.outline_factor=e.outline_factor,t.draw_outline_flag=e.draw_outline_flag,t.is_for_outline=e.is_for_outline,t.outline_color.set(e.outline_color),t.water=e.water,t.cam_water_depth=e.cam_water_depth,t.water_fog_color_density.set(e.water_fog_color_density),t.water_level=e.water_level,t.caustics=e.caustics,t.caust_scale=e.caust_scale,t.caust_speed.set(e.caust_speed),t.caust_brightness=e.caust_brightness,t.procedural_skydome=e.procedural_skydome,t.use_as_environment_lighting=e.use_as_environment_lighting,t.mie_brightness=e.mie_brightness,t.rayleigh_brightness=e.rayleigh_brightness,t.spot_brightness=e.spot_brightness,t.mie_strength=e.mie_strength,t.rayleigh_strength=e.rayleigh_strength,t.scatter_strength=e.scatter_strength,t.mie_collection_power=e.mie_collection_power,t.rayleigh_collection_power=e.rayleigh_collection_power,t.mie_distribution=e.mie_distribution,t.sky_color.set(e.sky_color),t.ssao_hemisphere=e.ssao_hemisphere,t.ssao_blur_depth=e.ssao_blur_depth,t.ssao_blur_discard_value=e.ssao_blur_discard_value,t.ssao_radius_increase=e.ssao_radius_increase,t.ssao_influence=e.ssao_influence,t.ssao_dist_factor=e.ssao_dist_factor,t.ssao_samples=e.ssao_samples,t.ssao_only=e.ssao_only,t.ssao_white=e.ssao_white,t.brightness=e.brightness,t.contrast=e.contrast,t.exposure=e.exposure,t.saturation=e.saturation,t.god_rays_intensity=e.god_rays_intensity,t.max_ray_length=e.max_ray_length,t.radial_blur_step=e.radial_blur_step,t.steps_per_pass=e.steps_per_pass,t.csm_index=e.csm_index,t.self_shadow_polygon_offset=e.self_shadow_polygon_offset,t.self_shadow_normal_offset=e.self_shadow_normal_offset,t.v_light_ts=s.O(e.v_light_ts),t.v_light_r=s.O(e.v_light_r),t.v_light_tsr=s.O(e.v_light_tsr),t.p_light_matrix=s.O(e.p_light_matrix),t.is_pp=e.is_pp,t.fxaa_quality=e.fxaa_quality,t.bloom_key=e.bloom_key,t.bloom_blur=e.bloom_blur,t.bloom_edge_lum=e.bloom_edge_lum,t.adaptive_bloom=e.adaptive_bloom,t.average_luminance=e.average_luminance,t.blur_texel_size_mult=e.blur_texel_size_mult,t.ext_texel_size_mult=e.ext_texel_size_mult,t.mb_decay_threshold=e.mb_decay_threshold,t.mb_factor=e.mb_factor,t.motion_blur_exp=e.motion_blur_exp,t.pp_effect=e.pp_effect,t.coc_type=e.coc_type,t.dof_bokeh=e.dof_bokeh,t.jitter_projection_space.set(e.jitter_projection_space),t.last_mip_map_ind=e.last_mip_map_ind,t.bloom_blur_num=e.bloom_blur_num,t.bloom_blur_scale=e.bloom_blur_scale,t.small_glow_mask_width=e.small_glow_mask_width,t.large_glow_mask_width=e.large_glow_mask_width,t.small_glow_mask_coeff=e.small_glow_mask_coeff,t.large_glow_mask_coeff=e.large_glow_mask_coeff,t.texel_size_multiplier=e.texel_size_multiplier,t.texel_size.set(e.texel_size),t.texel_mask.set(e.texel_mask),t.distortion_params.set(e.distortion_params),t.chromatic_aberration_coefs.set(e.chromatic_aberration_coefs),t.enable_hmd_stereo=e.enable_hmd_stereo,t.shadow_lamp_index=e.shadow_lamp_index,t.need_draw_data_sort=e.need_draw_data_sort,t.sky_invert=e.sky_invert,t.sky_use_rgb_to_intensity=e.sky_use_rgb_to_intensity,t.sky_use_map_blend=e.sky_use_map_blend,t.sky_use_map_horizon=e.sky_use_map_horizon,t.sky_use_map_zenith_up=e.sky_use_map_zenith_up,t.sky_use_map_zenith_down=e.sky_use_map_zenith_down,t.sky_blend_type=e.sky_blend_type,t.use_sky_blend=e.use_sky_blend,t.use_sky_paper=e.use_sky_paper,t.use_sky_real=e.use_sky_real,t},t.create_subs_grass_map=function(){var e=r(10);return e.camera=f.create_camera(f.TYPE_ORTHO_ASPECT),e},t.create_subs_postprocessing=function(e){var t=r(11);switch(t.clear_color=!1,t.clear_depth=!1,t.depth_test=!1,t.is_pp=!0,t.camera=f.create_camera(f.TYPE_NONE),t.pp_effect=e,e){case"NONE":case"GRAYSCALE":t.texel_mask[0]=1,t.texel_mask[1]=1;break;case"X_BLUR":t.texel_mask[0]=1,t.texel_mask[1]=0;break;case"Y_BLUR":t.texel_mask[0]=0,t.texel_mask[1]=1;break;case"X_GLOW_BLUR":t.texel_mask[0]=1,t.texel_mask[1]=0;break;case"Y_GLOW_BLUR":t.texel_mask[0]=0,t.texel_mask[1]=1;break;case"X_BLOOM_BLUR":t.texel_mask[0]=1,t.texel_mask[1]=0;break;case"Y_BLOOM_BLUR":t.texel_mask[0]=0,t.texel_mask[1]=1;break;case"X_DOF_BLUR":case"Y_DOF_BLUR":t.texel_mask[0]=1,t.texel_mask[1]=1;break;case"X_ALPHA_BLUR":t.texel_mask[0]=1,t.texel_mask[1]=0,t.texel_size_multiplier=3;break;case"Y_ALPHA_BLUR":t.texel_mask[0]=0,t.texel_mask[1]=1,t.texel_size_multiplier=3;break;case"X_EXTEND":t.texel_mask[0]=1,t.texel_mask[1]=0;break;case"Y_EXTEND":t.texel_mask[0]=0,t.texel_mask[1]=1;break;default:u.panic("Wrong postprocessing effect: "+e)}return t},t.create_subs_glow_combine=function(e,t){var _=r(13);return _.clear_color=!1,_.clear_depth=!1,_.depth_test=!1,_.small_glow_mask_coeff=t.glow_params.small_glow_mask_coeff,_.large_glow_mask_coeff=t.glow_params.large_glow_mask_coeff,_.small_glow_mask_width=t.glow_params.small_glow_mask_width,_.large_glow_mask_width=t.glow_params.large_glow_mask_width,_.camera=e,_.is_pp=!0,_},t.create_subs_main=function(e,t,n,o,i,s,E,c,l){var T=r(e);0==e?(T.clear_color=!0,T.clear_depth=n,T.blend=!1):1==e?(T.clear_color=!1,T.clear_depth=!1,T.blend=!0):2==e?(T.clear_color=!1,T.clear_depth=!0,T.blend=!0):3==e||4==e?(T.clear_color=!0,T.clear_depth=!0,T.blend=!1):5==e||6==e?(T.clear_color=!1,T.clear_depth=!1,T.blend=!0):7==e?(T.clear_color=!0,T.clear_depth=!1,T.blend=!0):u.panic("wrong main subscene type"),T.blend&&c&&(T.self_shadow_normal_offset=c.self_shadow_normal_offset),T.camera=t;var d=E.sky_texture_param;return d&&(T.sky_tex_fac.set([d.blend_factor,d.horizon_factor,d.zenith_up_factor,d.zenith_down_factor]),T.sky_tex_color.set(d.color),T.sky_tex_default_value=d.default_value),T.horizon_color.set(E.horizon_color),T.zenith_color.set(E.zenith_color),T.environment_energy=E.environment_energy,T.fog_color_density=s.fog_color_density,T.fog_params=s.fog_params,o&&a(T,o,l),_(T,i),T},t.create_subs_resolve=function(){var e=r(14);return e.is_pp=!0,e.camera=f.create_camera(f.TYPE_NONE),e},t.create_subs_color_picking=function(e,t,a){var n=r(15);return t&&(n.type=16,n.clear_color=!1,n.clear_depth=!0),n.enqueue=!1,n.camera=e,_(n,a),n},t.create_subs_debug_view=function(e){var t=r(17);return t.do_render=!1,t.clear_color=!1,t.clear_depth=!1,t.camera=e,t},t.create_subs_anchor_visibility=function(e){var t=r(18);return t.clear_color=!0,t.clear_depth=!1,t.camera=e,t},t.create_subs_shadow_receive=function(e,t,a){var n=r(9);return n.camera=t,_(n,a),n},t.create_subs_depth_pack=function(e){var t=r(19);return t.clear_color=!1,t.clear_depth=!1,t.camera=e,t.is_pp=!0,t},t.create_subs_ssao=function(e,t,_){var a=r(20);return a.clear_color=!1,a.clear_depth=!1,a.depth_test=!1,a.camera=e,a.fog_color_density=t.fog_color_density,a.water_fog_color_density.set(t.fog_color_density),a.ssao_radius_increase=_.radius_increase,a.ssao_hemisphere=_.hemisphere,a.ssao_influence=_.influence,a.ssao_dist_factor=_.dist_factor,a.ssao_samples=_.samples,a.is_pp=!0,a},t.create_subs_ssao_blur=function(e,t){var _=r(21);return _.clear_color=!1,_.clear_depth=!1,_.depth_test=!1,_.camera=e,_.ssao_blur_depth=t.blur_depth,_.ssao_blur_discard_value=t.blur_discard_value,_.is_pp=!0,_},t.create_subs_aa=function(e){var t=r(22);return t.clear_color=!1,t.clear_depth=!1,t.depth_test=!1,t.texel_size_multiplier=1/e.resolution_factor,t.fxaa_quality=e.aa_quality,t.camera=f.create_camera(f.TYPE_NONE),t.is_pp=!0,t},t.create_subs_smaa=function(e,t){var _=r(e);return _.clear_color=23==e||24==e,_.clear_depth=!1,_.depth_test=!1,_.texel_size_multiplier=1/t.resolution_factor,_.camera=f.create_camera(f.TYPE_NONE),23==e&&(_.jitter_subsample_ind=new Float32Array(4)),_.is_pp=!0,_},t.create_subs_compositing=function(e,t,_,a){var n=r(27);return n.clear_color=!1,n.clear_depth=!1,n.depth_test=!1,n.camera=f.create_camera(f.TYPE_NONE),n.brightness=e,n.contrast=t,n.exposure=_,n.saturation=a,n.is_pp=!0,n},t.create_subs_motion_blur=function(e,t){var _=r(28);return _.clear_color=!1,_.clear_depth=!1,_.depth_test=!1,_.camera=f.create_camera(f.TYPE_NONE),_.assign_texture=!0,_.mb_decay_threshold=e,_.mb_factor=t,_.is_pp=!0,_},t.create_subs_coc=function(e,t){var _=r(29);return _.clear_color=!1,_.clear_depth=!1,_.depth_test=!1,_.camera=e,_.texel_size_multiplier=_.camera.dof_power,_.coc_type=t,_.is_pp=!0,_},t.create_subs_dof=function(e,t){var _=r(30);return _.clear_color=!1,_.clear_depth=!1,_.depth_test=!1,_.camera=e,_.texel_size_multiplier=e.dof_power,_.dof_bokeh=t,_.is_pp=!0,_},t.create_subs_outline_mask=function(e,t){var a=r(31);return a.depth_test=!1,a.camera=e,_(a,t),a},t.create_subs_outline=function(e){var t=r(32);return A.outlining_overview_mode?t.outline_color.set(A.outline_color):t.outline_color.set(e.outline_color),t.outline_factor=e.outline_factor,t.ext_texel_size_mult=5,t.blur_texel_size_mult=3,t.depth_test=!1,t.camera=f.create_camera(f.TYPE_NONE),t.is_pp=!0,t},t.create_subs_god_rays=function(e,t,a,n,o,i,s){var E=r(33);return E.clear_color=!1,E.clear_depth=!1,E.depth_test=!1,E.horizon_color=new Float32Array([1,1,1]),E.zenith_color=new Float32Array([1,1,1]),E.environment_energy=1,E.pack=n,E.water=t,E.radial_blur_step=o,E.max_ray_length=a,E.steps_per_pass=s,E.camera=e,_(E,i),E},t.create_subs_god_rays_comb=function(e,t){var a=r(34);return a.clear_color=!1,a.clear_depth=!1,a.depth_test=!1,a.camera=f.create_camera(f.TYPE_NONE),a.god_rays_intensity=e,_(a,t),a.is_pp=!0,a},t.create_subs_sky=function(e,t,a,n){var o=r(35);o.enqueue=!1,o.clear_color=!1,o.clear_depth=!1,o.depth_test=!1;var i=f.create_camera(f.TYPE_NONE);if(i.width=n,i.height=n,o.camera=i,o.cube_view_matrices=s._5(),_(o,t),o.horizon_color=new Float32Array([1,1,1]),o.zenith_color=new Float32Array([1,1,1]),o.environment_energy=1,o.sky_color.set(a.sky_color),o.procedural_skydome=a.procedural_skydome,o.use_as_environment_lighting=a.use_as_environment_lighting,o.rayleigh_brightness=a.rayleigh_brightness,o.mie_brightness=a.mie_brightness,o.spot_brightness=a.spot_brightness,o.scatter_strength=a.scatter_strength,o.rayleigh_strength=a.rayleigh_strength,o.mie_strength=a.mie_strength,o.rayleigh_collection_power=a.rayleigh_collection_power,o.mie_collection_power=a.mie_collection_power,o.mie_distribution=a.mie_distribution,e){o.horizon_color.set(e.horizon_color),o.zenith_color.set(e.zenith_color),o.environment_energy=e.environment_energy;var E=e.sky_texture_param;E&&(o.sky_tex_fac.set([E.blend_factor,E.horizon_factor,E.zenith_up_factor,E.zenith_down_factor]),o.sky_tex_color.set(E.color),o.sky_tex_default_value=E.default_value,o.sky_invert=E.invert,o.sky_use_rgb_to_intensity=E.use_rgb_to_intensity,o.sky_use_map_blend=E.use_map_blend,o.sky_use_map_horizon=E.use_map_horizon,o.sky_use_map_zenith_up=E.use_map_zenith_up,o.sky_use_map_zenith_down=E.use_map_zenith_down,o.sky_blend_type=E.blend_type),o.use_sky_blend=e.use_sky_blend,o.use_sky_paper=e.use_sky_paper,o.use_sky_real=e.use_sky_real,o.sky_ngraph_proxy_id=e.ngraph_proxy_id}return o},t.create_subs_irradiance=function(e,t){var a=r(46);a.enqueue=!1,a.clear_color=!1,a.clear_depth=!1,a.depth_test=!1;var n=f.create_camera(f.TYPE_NONE);return n.width=t,n.height=t,a.camera=n,a.cube_view_matrices=s._5(),_(a,e),a},t.create_subs_rougness_convolution=function(e){var t=r(47);t.enqueue=!1,t.clear_color=!1,t.clear_depth=!1,t.depth_test=!1;var a=f.create_camera(f.TYPE_NONE);return a.width=128,a.height=128,t.camera=a,t.cube_view_matrices=s._5(),_(t,e),t},t.create_subs_brdf=function(){var e=r(48);e.enqueue=!1,e.clear_color=!1,e.clear_depth=!1,e.depth_test=!1;var t=f.create_camera(f.TYPE_NONE);return t.width=512,t.height=512,e.camera=t,e},t.create_subs_copy=function(){var e=r(36);return e.clear_color=!1,e.clear_depth=!1,e.camera=f.create_camera(f.TYPE_NONE),e.is_pp=!0,e},t.create_subs_stereo=function(e,t){var _=r(37);return _.clear_color=!1,_.clear_depth=!1,_.subtype=e?"HMD":t?"ANAGLYPH":"SIDEBYSIDE",_.camera=f.create_camera(f.TYPE_NONE),_.is_pp=!0,_},t.create_subs_luminance=function(){var e=r(38);return e.clear_color=!1,e.clear_depth=!1,e.camera=f.create_camera(f.TYPE_NONE),e.is_pp=!0,e},t.create_subs_av_luminance=function(){var e=r(39);return e.clear_color=!1,e.clear_depth=!1,e.camera=f.create_camera(f.TYPE_NONE),e.is_pp=!0,e},t.create_resize_subs=function(){var e=r(45);return e.clear_color=!1,e.clear_depth=!1,e.camera=f.create_camera(f.TYPE_NONE),e.is_pp=!0,e},t.create_subs_luminance_truncated=function(e,t,a,n){var o=r(40);return o.clear_color=!1,o.clear_depth=!1,o.bloom_key=e,o.bloom_edge_lum=t,o.camera=n,_(o,a),o.is_pp=!0,o},t.create_subs_bloom_combine=function(e,t){var _=r(41);return _.clear_color=!1,_.clear_depth=!1,_.camera=f.create_camera(f.TYPE_NONE),_.bloom_blur=e,_.bloom_blur_num=t,_.is_pp=!0,_},t.create_subs_veloctity=function(e){var t=r(42);return t.clear_color=!1,t.clear_depth=!1,t.camera=e,t.is_pp=!0,t},t.create_subs_sink=function(){var e=r(43);return e.enqueue=!1,e},t.create_subs_perf=function(){var e=r(44);return e.is_pp=!0,e},t.subs_label=function(e){switch(e.type){case 0:return"MAIN OPAQUE";case 1:return"MAIN BLEND";case 2:return"MAIN XRAY";case 3:return"MAIN PLANE REFLECT";case 4:return"MAIN CUBE REFLECT";case 5:return"MAIN PLANE REFLECT BLEND";case 6:return"MAIN CUBE REFLECT BLEND";case 7:return"MAIN GLOW";case 8:return"SHADOW CAST";case 9:return"SHADOW RECEIVE";case 10:return"GRASS MAP";case 11:return"POSTPROCESSING ("+e.pp_effect.replace(/_/g," ")+")";case 13:return"GLOW COMBINE";case 14:return"RESOLVE";case 15:return"COLOR PICKING";case 16:return"COLOR PICKING XRAY";case 17:return"DEBUG VIEW";case 18:return"ANCHOR VISIBILITY";case 19:return"DEPTH PACK";case 20:return"SSAO";case 21:return"SSAO BLUR";case 22:return"ANTIALIASING";case 23:return"SMAA BLENDING WEIGHT CALCULATION";case 24:return"SMAA EDGE DETECTION";case 25:return"SMAA RESOLVE";case 26:return"SMAA NEIGHBORHOOD BLENDING";case 27:return"COMPOSITING";case 28:return"MOTION BLUR";case 29:return"COC";case 30:return"DOF";case 31:return"OUTLINE MASK";case 32:return"OUTLINE";case 33:return"GOD RAYS";case 34:return"GOD RAYS COMBINE";case 35:return"SKY";case 46:return"IRRADIANCE";case 47:return"ROUGHNESS_CONVOLUTION";case 48:return"PRE-COMPUTE_BRDF";case 36:return"COPY";case 37:return"STEREO";case 38:return"LUMINANCE";case 39:return"AVERAGE LUMINANCE";case 40:return"LUMINANCE TRUNCED";case 41:return"BLOOM";case 42:return"VELOCITY";case 44:return"PERFORMANCE";case 43:return"SINK";case 45:return"RESIZE";default:return"UNKNOWN"}},t.append_draw_data=function(e,t){for(var _=t.batch,r=_.shader,a=_.alpha_antialiasing,n=0;n<e.draw_data.length;n++){var o=e.draw_data[n],i=o.bundles,s=i.indexOf(t);if(-1!=s&&(i.splice(s,1),!i.length)){e.draw_data.splice(n,1);break}}if(e.blend)var E=_.offset_z;else var E=0;var T=l(e.draw_data,r,a,E,_.is_sky);if(T)T.bundles.push(t);else{var d=c(r,t,a,E,_.is_sky);e.draw_data.push(d),e.need_draw_data_sort=!0}},t.init_bundle=function(e,t,_){var r={do_render:!0,do_render_cube:[!0,!0,!0,!0,!0,!0],obj_render:t,batch:e,world_bounds:_||null,info_for_z_sort_updates:null,z_index:1/0};if(e.z_sort&&e.bufs_data.ibo_array){var a=e.bufs_data.ibo_array;r.info_for_z_sort_updates={median_cache:new Float32Array(a.length),median_world_cache:new Float32Array(a.length),dist_cache:new Float32Array(a.length/3),zsort_eye_last:new Float32Array(3),bb_min_side:E.m(e.bounds_local.bb)}}return r},t.sort_draw_data=function(e){e.draw_data.sort(d),e.need_draw_data_sort=!1}}var a=_(0),n=_(5),o=_(14),i=_(4),s=_(2),E=_(25),c=Object(a.a)("__subscene",r);t.a=c},function(e,t,_){"use strict";function r(e,t){function _(e,t){e.render.outline_intensity=t,r(e)}function r(e){for(var t=e.scenes_data,_=e.render,r=0;r<t.length;r++){var a=t[r],n=a.scene;n._render.outline&&_.outline_intensity&&Ce.request_outline(n)}}function a(e){e.render.outline_intensity=0;var t=Je.indexOf(e);-1!=t&&Je.splice(t,1)}function C(e,t){if(t.uuid=e.uuid,t.is_meta=!1,t.def_action_slots=e._def_action_slots,t.is_dynamic=e._is_dynamic,t.is_hair_dupli=e._is_hair_dupli||!1,_e(e,t),"MESH"===t.type)var _=t.is_dynamic?"DYNAMIC":"STATIC";else var _=t.type;var r=t.render=Me.create_render(_);ae(e,t);var a=e.location,n=e.scale[0],o=$e;switch(M._28(e.rotation_quaternion,o),Ke.set_translation(t,a),Ke.set_rotation(t,o),Ke.set_scale(t,n),t.use_default_animation=e.b4w_use_default_animation,t.anim_behavior_def=ve.anim_behavior_bpy_b4w(e.b4w_anim_behavior),e.b4w_object_tags&&(t.metatags={title:e.b4w_object_tags.title,description:e.b4w_object_tags.description,category:e.b4w_object_tags.category}),t.custom_prop=e.b4w_custom_prop,e.b4w_viewport_alignment&&(t.viewport_alignment={alignment:e.b4w_viewport_alignment.alignment,distance:e.b4w_viewport_alignment.distance}),r.hide=e.b4w_hidden_on_load,r.hide_children=e.b4w_hide_chldr_on_load,e.type){case"ARMATURE":y.e(e,t);var i=r.bone_pointers,E=ve.calc_pose_data(i);e.b4w_animation_mixing?(r.quats_before=new Float32Array(E.quats),r.quats_after=new Float32Array(E.quats),r.trans_before=new Float32Array(E.trans),r.trans_after=new Float32Array(E.trans)):(r.quats_before=E.quats,r.quats_after=E.quats,r.trans_before=E.trans,r.trans_after=E.trans);for(var c in i){var l=i[c];1==l.chain.length&&y.d(l,!0,E.trans,E.quats)}r.pose_data=E,r.frame_factor=0,r.anim_mixing=e.b4w_animation_mixing;break;case"MESH":r.bb_original=Ne.bb_bpy_to_b4w(e.data.b4w_boundings.bb),t.is_boundings_overridden=e.data.is_boundings_overridden,r.do_not_render=e.b4w_do_not_render,r.selectable=je.outlining_overview_mode||e.b4w_selectable,r.origin_selectable=e.b4w_selectable,r.outlining=je.outlining_overview_mode||e.b4w_outlining,r.origin_outlining=e.b4w_outlining,r.outline_on_select=je.outlining_overview_mode||e.b4w_outline_on_select,r.billboard=e.b4w_billboard,r.billboard_pres_glob_orientation=e.b4w_pres_glob_orientation,r.billboard_type="BASIC",r.billboard_spherical="SPHERICAL"==e.b4w_billboard_geometry;var T=r.outline_anim_settings_default;if(T.outline_duration=e.b4w_outline_settings.outline_duration,T.outline_period=e.b4w_outline_settings.outline_period,T.outline_relapses=e.b4w_outline_settings.outline_relapses,r.selectable&&(r.color_id=he.gen_color_id(Ve),Ve++),re(e,t),Z(e,t),r.shadow_cast=e.b4w_shadow_cast,r.shadow_receive=e.b4w_shadow_receive,r.shadow_cast_only=e.b4w_shadow_cast_only&&r.shadow_cast,r.reflexible=e.b4w_reflexible,r.reflexible_only=e.b4w_reflexible_only&&r.reflexible,r.reflective=e.b4w_reflective,r.reflection_type=e.b4w_reflection_type,r.reflective||F(t),r.caustics=e.b4w_caustics,r.wind_bending=e.b4w_wind_bending,e.b4w_wind_bending){r.wind_bending_angle=e.b4w_wind_bending_angle;var d=Ne.wb_angle_to_amp(M.T(e.b4w_wind_bending_angle),r.bb_original,e.scale[0]);r.wind_bending_amp=d,r.wind_bending_freq=e.b4w_wind_bending_freq,r.detail_bending_freq=e.b4w_detail_bending_freq,r.detail_bending_amp=e.b4w_detail_bending_amp,r.branch_bending_amp=e.b4w_branch_bending_amp,r.main_bend_col=e.b4w_main_bend_stiffness_col;var u=e.b4w_detail_bend_colors;r.detail_bend_col.leaves_stiffness=u.leaves_stiffness_col,r.detail_bend_col.leaves_phase=u.leaves_phase_col,r.detail_bend_col.overall_stiffness=u.overall_stiffness_col}if(r.dynamic_geometry=e.b4w_dynamic_geometry,r.dynamic_geometry){t._bpy_obj=e;for(var P=0;P<t.materials.length;P++){var A=t.materials[P];t.mat_inheritance_data.original_mat_names.push(A.name),t.mat_inheritance_data.is_disabled.push(!1)}}var S=t.materials[0];r.friction=S.physics_settings.friction,r.elasticity=S.physics_settings.elasticity,r.lod_dist_min=0,r.lod_dist_max=Me.LOD_DIST_MAX_INFINITY,r.pass_index=e.pass_index;break;case"LINE":r.bb_local=s.w(),r.be_local=s.y(),r.bb_world=s.w(),r.be_world=s.y();break;case"CAMERA":ge.camera_object_to_camera(e,t),ge.assign_boundings(t);break;case"LAMP":f.a(e,t);break;case"SPEAKER":t.sfx=Fe.create_sfx();for(var p=!1,P=0;P<t.scenes_data.length;P++)if(t.scenes_data[P].scene._sfx){p=!0;break}p&&Fe.update_object(e,t);break;case"EMPTY":var O=s.w();r.bb_local=O;var v=s.A();r.bs_local=v,e.field&&(t.field={type:e.field.type,strength:e.field.strength}),e.b4w_anchor&&(t.anchor={type:e.b4w_anchor.type,detect_visibility:e.b4w_anchor.detect_visibility,element_id:e.b4w_anchor.element_id,max_width:e.b4w_anchor.max_width})}Te(t)}function D(e,t){t.uuid=e.uuid,t.is_meta=!1,t.def_action_slots=e._def_action_slots,t.is_dynamic=e._is_dynamic;var _=t.type;t.render=Me.create_render(_),t.use_default_animation=e.b4w_use_default_animation,t.anim_behavior_def=ve.anim_behavior_bpy_b4w(e.b4w_anim_behavior),Te(t)}function F(e){for(var t=e.materials,_=0;_<t.length;_++){var r=t[_];r.use_nodes&&(G(r.node_tree,"BSDF_GLOSSY")||G(r.node_tree,"BSDF_DIFFUSE")||G(r.node_tree,"BSDF_PRINCIPLED"))&&(e.render.reflective=!0,e.render.reflection_type="PBR")}}function G(e,t){return-1!=e._bsdf_types.indexOf(t)}function k(e){if(e.field)for(var t=e.scenes_data,_=0;_<t.length;_++){var r=t[_].scene;Ce.update_force_scene(r,e)}}function K(e,t){var _=t.render;if("CUBE"==_.reflection_type)_.cube_reflection_id=qe++;else if("PLANE"==_.reflection_type){var r=X(e,t);r||(r=B(t));for(var a=null,n=0;n<We.length;n++){var o=We[n];if(o==r){a=n;break}}null==a&&(a=We.length,We.push(r)),r.render.plane_reflection_id=a,_.plane_reflection_id=a,r.reflective_objs.push(t)}}function B(e){var t=he.unique_name("%reflection%"),_=Me.create_object(t,"EMPTY"),r=Me.create_render("EMPTY");return _.render=r,H(e,_),Ie.append_stiff_obj(_,e,[0,0,0],null,1),Te(_),_}function X(e,t){for(var _=e.constraints,r=0;r<_.length;r++){var a=_[r];if("LOCKED_TRACK"==a.type&&"REFLECTION PLANE"==a.name){if(a.target&&a.target._object)return a.target._object;Ue.warn('Reflection plane target for object: "'+t.name+"\" is not present on the scene. Using object's Z-axis.")}}return null}function H(e,t){for(var _=e.scenes_data,r=t.scenes_data,a=0;a<_.length;a++){for(var n=!1,o=0;o<r.length;o++)if(_[a].scene==r[o].scene){n=!0;break}n||j(t,_[a].scene)&&Me.append_scene_data(t,_[a].scene)}}function j(e,t){return!(!t._is_main&&"SPEAKER"==e.type)&&!(!t._is_primary_thread&&"LAMP"==e.type)}function Q(e){var t=ve.bpy_mesh_empty_is_animatable(e),_=e.b4w_do_not_batch,r=e.b4w_collision,a=e.b4w_vehicle,n=e.b4w_floating,o=e.b4w_character,i=xe.has_dynamic_grass_particles(e),s=Le.bpy_obj_has_nla(e),E=e.data.b4w_shape_keys.length>0,c=e.b4w_dynamic_geometry,l=z(e);return Qe||t||_||r||a||E||n||i||o||s||c||q(e)||l}function z(e){var t=!1,_=e.constraints.length;if(_){for(var r=null,a=_-1;a>=0;a--){var n=e.constraints[a];if("LOCKED_TRACK"!=n.type||"REFLECTION PLANE"!=n.name){r=n;break}}if(!r)return!1;if(!r.target)return!1;var o=r.target,i=o.type;if(o.parent){var s=o.parent.type;return t="MESH"==s?t||Q(o.parent):"EMPTY"!=s||(t||V(o.parent))}t="MESH"==i?t||Q(o):"EMPTY"!=i||(t||V(o))}return t}function V(e){var t=ve.bpy_mesh_empty_is_animatable(e),_=Le.bpy_obj_has_nla(e),r=e.b4w_do_not_batch,a=Boolean(e.b4w_anchor),n=z(e);return t||_||r||a||n}function q(e){for(var t=e.data,_=0;_<t.materials.length;_++){var r=t.materials[_];if(r.water_settings.is_water)return!0;if(r.is_lens_flares)return!0;if(W(r.node_tree))return!0}return!1}function W(e){if(!e)return!1;for(var t=e.nodes,_=0;_<t.length;_++){var r=t[_];if("VECT_TRANSFORM"==r.type){var a=r.convert_from,n=r.convert_to,o=r.outputs[0];if(o.is_linked&&("WORLD"!=a||"CAMERA"!=n)&&("CAMERA"!=a||"WORLD"!=n)&&("OBJECT"!=a||"OBJECT"!=n))return!0}if("NORMAL_MAP"==r.type){var i=r.space,o=r.outputs[0];if(o.is_linked&&("OBJECT"==i||"BLENDER_OBJECT"==i))return!0}if("TEX_COORD"==r.type){if(r.outputs[3].is_linked)return!0}if("OBJECT_INFO"==r.type){var s=r.outputs[0],E=r.outputs[1],c=r.outputs[3];if(s.is_linked||E.is_linked||c.is_linked)return!0}}return!1}function J(e,t,_){var r=t.render,a=e.data;t.armobj=_;var n=a.vertex_groups;if(n.length){var o=_.render.bone_pointers,i=0,s={};for(var E in o){var c=M._18("name",E,n);if(c){var l=o[E];s[E]={vgroup_index:c.index,bone_index:l.bone_index,deform_bone_index:i++}}}r.bone_skinning_info=s;var T=i,d=ve.get_max_bones();r.max_bones=T,T>2*d?(r.is_skinning=!1,Ue.error('too many bones for "'+e.name+'" / '+r.max_bones+" bones (max "+d+" with blending, "+2*d+" without blending). Skinning will be disabled.")):r.is_skinning=!0}}function Z(e,t){"MESH"!=e.type&&me.panic("Wrong object type: "+e.name);var _=t.render;if(e.data.b4w_shape_keys.length){_.use_shape_keys=!0;for(var r=0;r<e.data.b4w_shape_keys.length;r++){var a={};a.value=e.data.b4w_shape_keys[r].value,a.name=e.data.b4w_shape_keys[r].name,_.shape_keys_values.push(a)}}else _.use_shape_keys=!1}function $(e){if(se(e,ze.ALL,!1,et)){for(var t,_=1;;){if(t="."+(String(_).length<3?("000"+String(_)).slice(-3):String(_)),!se(e+t,ze.ALL,!1,et))break;_++}return Ue.error('Object "'+e+'" already exists. Name was replaced by "'+e+t+'".'),t}return""}function ee(e,t,_){var r=t,a=Me.get_dg_parent(e),n=a?Me.gen_dupli_name(a.name,t):t,o=$(n);n+=o,r+=o;var i=Me.create_object(n,e.type,r);i.is_meta=e.is_meta,i._bpy_obj=e._bpy_obj,i.mat_inheritance_data.original_mat_names=Me.copy_bpy_object_props_by_link(e.mat_inheritance_data.original_mat_names),i.mat_inheritance_data.is_disabled=Me.copy_bpy_object_props_by_link(e.mat_inheritance_data.is_disabled),i.is_dynamic=e.is_dynamic,i.is_hair_dupli=e.is_hair_dupli,i.use_default_animation=e.use_default_animation,i.def_action_slots=e.def_action_slots,i.render=Me.clone_render(e.render),i.render.is_lod=!1,i.metatags=Me.copy_object_props_by_value(e.metatags),i.custom_prop=Me.copy_object_props_by_value(e.custom_prop),H(e,i),i.action_anim_cache=Me.copy_bpy_object_props_by_link(e.action_anim_cache),i.parent=Me.copy_bpy_object_props_by_link(e.parent),i.parent_is_dupli=e.parent_is_dupli,i.parent_bone=e.parent_bone,i.vertex_anim=Me.copy_bpy_object_props_by_link(e.vertex_anim),i.anim_behavior_def=e.anim_behavior_def,e.physics&&!(e.is_vehicle||e.is_character||e.is_floating)&&(i.use_obj_physics=e.use_obj_physics,i.physics=null),i.collision_id=e.collision_id,i.correct_bounding_offset=e.correct_bounding_offset,i.physics_settings=Me.copy_object_props_by_value(e.physics_settings),te(e,i,_);for(var s=0;s<e.materials.length;s++)i.materials.push(P.a(e.materials[s]));return Me.scene_data_set_active(i,!1),Te(i),i}function te(e,t,_){for(var r=[],a=0;a<e.scenes_data.length;a++){var n=e.scenes_data[a],o=t.scenes_data[a],i=n.batches;if(_){for(var s=o.batches,E=0;E<i.length;E++)if(!i[E].forked_batch){var c=Me.copy_object_props_by_value(i[E]);c.bufs_data=Ye.clone_bufs_data(i[E].bufs_data),Me.append_batch(t,o.scene,c),r.push(i[E].bufs_data)}for(var E=0;E<i.length;E++)if(i[E].forked_batch){var l=Me.copy_object_props_by_value(i[E]);Me.append_batch(t,o.scene,l);for(var T=0;T<r.length;T++)r[T]==i[E].bufs_data&&(l.bufs_data=s[T].bufs_data)}for(var E=0;E<s.length;E++)s[E].bufs_data&&Ye.update_gl_buffers(s[E].bufs_data),He.allow_vao_ext&&s[E].bufs_data&&Xe.assign_vao(s[E]),s[E].odd_id_prop=Ne.generate_odd_id(s[E],t.render,t.uuid),Ne.update_batch_id(s[E]);Ge.share_batch_canvas_textures(s)}else for(var E=0;E<i.length;E++)Me.append_batch(t,o.scene,i[E])}}function _e(e,t){t.is_vehicle=e.b4w_vehicle,t.is_character=e.b4w_character,t.is_floating=e.b4w_floating,t.use_obj_physics=e.b4w_collision,t.collision_id=e.b4w_collision_id,t.correct_bounding_offset=e.b4w_correct_bounding_offset;var _=e.game;t.physics_settings={physics_type:_.physics_type,use_ghost:_.use_ghost,use_sleep:_.use_sleep,mass:_.mass,velocity_min:_.velocity_min,velocity_max:_.velocity_max,damping:_.damping,rotation_damping:_.rotation_damping,lock_location_x:_.lock_location_x,lock_location_y:_.lock_location_y,lock_location_z:_.lock_location_z,lock_rotation_x:_.lock_rotation_x,lock_rotation_y:_.lock_rotation_y,lock_rotation_z:_.lock_rotation_z,collision_margin:_.collision_margin,collision_group:_.collision_group,collision_mask:_.collision_mask,use_collision_bounds:_.use_collision_bounds,collision_bounds_type:_.collision_bounds_type,use_collision_compound:_.use_collision_compound};var r=e.b4w_vehicle_settings;r&&(t.vehicle_settings={name:r.name,part:r.part,suspension_rest_length:r.suspension_rest_length,suspension_compression:r.suspension_compression,suspension_stiffness:r.suspension_stiffness,suspension_damping:r.suspension_damping,wheel_friction:r.wheel_friction,roll_influence:r.roll_influence,max_suspension_travel_cm:r.max_suspension_travel_cm,force_max:r.force_max,brake_max:r.brake_max,steering_max:r.steering_max,max_speed_angle:r.max_speed_angle,delta_tach_angle:r.delta_tach_angle,speed_ratio:r.speed_ratio,steering_ratio:r.steering_ratio,inverse_control:r.inverse_control,floating_factor:r.floating_factor,water_lin_damp:r.water_lin_damp,water_rot_damp:r.water_rot_damp,synchronize_position:r.synchronize_position});var a=e.b4w_floating_settings;a&&(t.floating_settings={name:a.name,part:a.part,floating_factor:a.floating_factor,water_lin_damp:a.water_lin_damp,water_rot_damp:a.water_rot_damp,synchronize_position:a.synchronize_position});var n=e.b4w_character_settings;n&&(t.character_settings={walk_speed:n.walk_speed,run_speed:n.run_speed,step_height:n.step_height,jump_strength:n.jump_strength,waterline:n.waterline});for(var o=0;o<e.constraints.length;o++){var i=e.constraints[o];"RIGID_BODY_JOINT"==i.type&&t.physics_constraints.push({target:i.target._object,pivot_type:i.pivot_type,pivot_x:i.pivot_x,pivot_y:i.pivot_y,pivot_z:i.pivot_z,axis_x:i.axis_x,axis_y:i.axis_y,axis_z:i.axis_z,use_limit_x:i.use_limit_x,use_limit_y:i.use_limit_y,use_limit_z:i.use_limit_z,use_angular_limit_x:i.use_angular_limit_x,use_angular_limit_y:i.use_angular_limit_y,use_angular_limit_z:i.use_angular_limit_z,limit_max_x:i.limit_max_x,limit_max_y:i.limit_max_y,limit_max_z:i.limit_max_z,limit_min_x:i.limit_min_x,limit_min_y:i.limit_min_y,limit_min_z:i.limit_min_z,limit_angle_max_x:i.limit_angle_max_x,limit_angle_max_y:i.limit_angle_max_y,limit_angle_max_z:i.limit_angle_max_z,limit_angle_min_x:i.limit_angle_min_x,limit_angle_min_y:i.limit_angle_min_y,limit_angle_min_z:i.limit_angle_min_z})}}function re(e,t){for(var _=0;_<e.data.b4w_vertex_anim.length;_++){var r=e.data.b4w_vertex_anim[_];t.vertex_anim.push({name:r.name,frame_start:r.frame_start,frame_end:r.frame_end,averaging:r.averaging,averaging_interval:r.averaging_interval,allow_nla:r.allow_nla})}t.render.vertex_anim=!!t.vertex_anim.length}function ae(e,t){e.parent?(t.parent=e.parent._object,"BONE"==e.parent_type&&"ARMATURE"==e.parent.type&&(t.parent_bone=e.parent_bone),e.pinverse_tsr&&(t.pinverse_tsr=L.b(),L.a(e.pinverse_tsr,t.pinverse_tsr))):e.dg_parent&&(t.parent=e.dg_parent._object,t.parent_is_dupli=!0)}function ne(e,t,_){for(var r=ze[t]||[],a=[],n=0;n<r.length;n++){var o=r[n];if(o.render.data_id==_||_==et)for(var i=o.scenes_data,s=0;s<i.length;s++){var E=i[s];E.scene==e&&a.push(o)}}return a}function oe(e,t){var _=ze[e]||[];if(t==et)return _;for(var r=[],a=0;a<_.length;a++){var n=_[a];n.render.data_id==t&&r.push(n)}return r}function ie(e,t,_,r){for(var a=0;a<e.scenes_data.length;a++)for(var n=e.scenes_data[a].batches,o=0;o<n.length;o++){var i=n[o];i.bufs_data&&(i.bufs_data.cleanup_gl_data_on_unload=t),i.cleanup_gl_data_on_unload=t,i.shader&&(i.shader.cleanup_gl_data_on_unload=_),Ne.set_cleanup_nodemat(r)}}function se(e,t,_,r,a){for(var n=null,o=0;o<t.length;o++){var i=t[o];if(!((_?i.origin_name:i.name)!=e||i.render.data_id!=r&&r!=et||a&&i.is_meta||(n=i,Me.get_dg_parent(n))))break}return n}function Ee(e,t,_,r){for(var a=0;a<_.length;a++){var n=_[a];if(n.origin_name==t&&(n.render.data_id==r||r==et)){var o=Me.get_dg_parent(n);if(o&&o.origin_name==e)return n}}return null}function ce(e,t,_){for(var r=0;r<t.length;r++){for(var a=t[r],n=e.length-1,o=a,i=!0;n>=0&&i;)i=o&&o.origin_name==e[n]&&(o.render.data_id==_||_==et),o&&(o=Me.get_dg_parent(o)),n--;if(i&&!o)return a}return null}function le(e,t){var _=0,r=e.outline_animation;0==r.time_start&&(r.time_start=t);var n=t-r.time_start;if(r.relapses&&n/r.period>=r.relapses)return void a(e);var o=n%r.period;if(o<r.outline_time){var i=o/(r.outline_time/5),s=Math.floor(i);switch(s){case 0:_=(i-s)/2;break;case 1:_=(i-s)/2+.5;break;case 2:_=1;break;case 3:_=1-(i-s)/2;break;case 4:_=.5-(i-s)/2}}e.render.outline_intensity=_}function Te(e){ze.ALL.push(e),ze[e.type]||(ze[e.type]=[]),ze[e.type].push(e);var t=e.render.plane_reflection_id;if(null!=t)for(var _=0;_<We.length;_++){var r=We[_];r.render.plane_reflection_id==t&&r.reflective_objs.push(e)}}function de(e){var t=ze.ALL,_=ze[e.type],r=t.indexOf(e),a=_.indexOf(e);-1!=r&&t.splice(r,1),-1!=a&&_.splice(a,1)}function ue(e,t,_){if(!t.is_lod)return!0;var r=e.lod_settings;if(r.dest_coverage!=r.coverage)if(r.use_smoothing){var a=M._49(r.dest_coverage-r.coverage);r.coverage+=a*ke.get_delta()/tt,r.coverage=M.M(r.coverage,0,1)}else r.coverage=r.dest_coverage;if("STATIC"==t.type)var n=t.lod_center;else var n=x.add(t.bs_world.center,t.main_lod_offset,Ze);var o=x.dist(n,_);if(0==r.hyst_prev_state)var i=Math.max(t.lod_dist_min-r.hyst_interval_min/2,0),s=t.lod_dist_max+r.hyst_interval_max/2;else if(-1==r.hyst_prev_state)var i=t.lod_dist_min+r.hyst_interval_min/2,s=t.lod_dist_max+r.hyst_interval_max/2;else var i=Math.max(t.lod_dist_min-r.hyst_interval_min/2,0),s=Math.max(t.lod_dist_max-r.hyst_interval_max/2,0);return r.hyst_prev_state=o<i?-1:o<s?0:1,r.dest_coverage=o<i||o>s?0:1,r.cmp_logic=0==r.dest_coverage?-1:1,Math.abs(o-r.prev_dist)>He.lod_leap_smooth_threshold&&(0==r.coverage||1==r.coverage)&&(r.coverage=r.dest_coverage),r.prev_dist=o,0!=r.dest_coverage||0!=r.coverage}function fe(e,t){var _=e.render,r=t._render;if(_.is_lod)for(var a=Ke.get_translation(t._camera,Ze),n=0;n<e.scenes_data.length;n++)if(e.scenes_data[n].scene==t)for(var o=0;o<e.scenes_data[n].batches.length;o++){var i=e.scenes_data[n].batches[o],s=i.lod_settings,E="SHADOW"==i.type&&"RECEIVE"==i.subtype&&!He.reuse_depth_optimization;if(He.lod_smooth_transitions&&!E){var c=r.lod_smooth_type;("ALL"==c||"NON-OPAQUE"==c&&(i.blend||i.alpha_clip))&&(s.use_smoothing=!0)}ue(i,_,a),s.coverage=s.dest_coverage,s.hyst_interval_min=Math.min(r.lod_hyst_interval,2*_t*_.lod_lower_border_range),s.hyst_interval_max=Math.min(r.lod_hyst_interval,2*_t*_.lod_upper_border_range)}}function Pe(e,t){ie(e,!0,!1,!0);for(var _=oe("ALL",et),r=0;r<_.length;r++){var a=_[r];a!=e&&ie(a,!1,!1,!1)}Ce.remove_object_bundles(e,t);for(var r=0;r<e.scenes_data.length;r++)for(var n=e.scenes_data[r].batches.length-1;n>=0;n--){var o=e.scenes_data[r].batches[n];0!=o.material_names.length&&-1==o.material_names.indexOf(t)||Me.scene_data_remove_batch(e.scenes_data[r],n)}ye.obj_has_physics(e)&&ye.remove_object(e);for(var r=0;r<_.length;r++)_[r]!=e&&ie(_[r],!0,!0,!0);ve.delete_cached_anim_data_by_mat(e,t);var i=e._bpy_obj._object;return e._bpy_obj._object=e,i}function Ae(e,t){e._bpy_obj._object=t,ie(e,!0,!0,!0)}function Se(e,t,_,r){var a=e.mat_inheritance_data.original_mat_names.indexOf(t),n=_.mat_inheritance_data.original_mat_names.indexOf(r),o=e.materials[a];_.materials[n]=o;var i=o.name;o.name=r;for(var s=0;s<_.materials.length;s++)_.mat_inheritance_data.is_disabled[s]=!(s==n);return i}function pe(e,t,_,r){for(var a=0;a<_.materials.length;a++)_.mat_inheritance_data.is_disabled[a]=!1;var n=e.mat_inheritance_data.original_mat_names.indexOf(t);e.materials[n].name=r}function Oe(e,t,_,r,a){for(var n=1;n<e.render.shape_keys_values.length;n++){var o=e.render.shape_keys_values[n].name,i=e.render.shape_keys_values[n].value;Ye.apply_shape_key(e,o,i)}if(ve.is_animated(e))for(var n=0;n<e.anim_slots.length;n++){var s=e.anim_slots[n];if(s)switch(s.type){case ve.OBJ_ANIM_TYPE_PARTICLES:var E=ve.get_current_frame_float(e,n);ve.set_frame(e,E,n);break;case ve.OBJ_ANIM_TYPE_MATERIAL:if(s.node_batches)for(var c=s.node_batches.length-1;c>=0;c--){var l=s.node_batches[c];-1!=l.material_names.indexOf(t)&&s.node_batches.splice(c,1)}}}if(r){var T=function(t){if(t.particles_data){var _=t.particles_data.name;if(r[_]){var a=t.particles_data.count_factor!=r[_].count_factor;t.particles_data=xe.clone_particles_data(r[_]),a&&xe.set_factor(e,_,t.particles_data.count_factor)}}};Ne.iterate_batches_by_mat(e,t,T,"PARTICLES")}if(a){var d=Ne.find_batch_material(e,t,"MAIN");d&&(d.diffuse_color.set(a.diffuse_color),d.diffuse_intensity=a.diffuse_intensity,d.diffuse_color_factor=a.diffuse_color_factor,d.diffuse_params.set(a.diffuse_params),d.specular_color.set(a.specular_color),d.specular_color_factor=a.specular_color_factor,d.specular_params.set(a.specular_params),d.specular_alpha=a.specular_alpha,d.emit=a.emit,d.ambient=a.ambient,d.alpha_factor=a.alpha_factor,d.mirror_factor=a.mirror_factor,d.normal_factor=a.normal_factor,d.reflect_factor=a.reflect_factor,d.refr_bump=a.refr_bump,d.fresnel_params.set(a.fresnel_params),d.parallax_scale=a.parallax_scale,d.texture_scale.set(a.texture_scale),d.shallow_water_col.set(a.shallow_water_col),d.shallow_water_col_fac=a.shallow_water_col_fac,d.shore_water_col.set(a.shore_water_col),d.shore_water_col_fac=a.shore_water_col_fac,d.foam_factor=a.foam_factor,d.water_norm_uv_velocity=a.water_norm_uv_velocity,d.node_values=a.node_values.slice(),d.node_rgbs=a.node_rgbs.slice())}var u=function(t){for(var r=0;r<t.bpy_tex_names.length;r++){var a=t.bpy_tex_names[r],n=t.textures[r];if("IMAGE"==n.source||"ENVIRONMENT"==n.source){var o=Ge.get_texture_by_name(_,a);o&&n.img_full_filepath!=o.img_full_filepath&&Ge.set_texture_by_name(e,a,o)}}};Ne.iterate_batches_by_mat(e,t,u)}var ve=Object(n.a)(e),me=Object(o.a)(e),Ne=Object(i.a)(e),ge=Object(E.a)(e),Re=Object(c.a)(e),Ie=Object(l.a)(e),be=Object(T.a)(e),he=Object(d.a)(e),Ye=Object(u.a)(e),Le=Object(A.a)(e),Me=Object(S.a)(e),xe=Object(p.a)(e),ye=Object(O.a)(e),Ue=Object(v.a)(e),we=Object(m.a)(e),Ce=Object(g.a)(e),De=Object(R.a)(e),Fe=Object(I.a)(e),Ge=Object(b.a)(e),ke=Object(h.a)(e),Ke=Object(Y.a)(e),Be=Object(U.a)(e),Xe=Object(w.a)(e),He=Re.defaults,je=Re.outlining,Qe=!1,ze={ALL:[]},Ve=0,qe=0,We=[],Je=[],Ze=new Float32Array(3),$e=new Float32Array(4),et=-1,tt=.4,_t=.3;t.GET_OBJECT_BY_NAME=0,t.GET_OBJECT_BY_DUPLI_NAME=1,t.GET_OBJECT_BY_DUPLI_NAME_LIST=2,t.DATA_ID_ALL=et,t.update=function(e,t){for(var _=0;_<Je.length;_++){var a=Je[_];le(a,e),a.render.outline_intensity&&r(a)}var n=ze.ARMATURE;if(n)for(var _=0;_<n.length;_++){var o=n[_];o.need_update_transform&&(Ke.update_transform(o),o.need_update_transform=!1)}},t.set_outline_intensity=_,t.apply_outline_anim=function(e,t,_,r){var a=e.outline_animation;a.time_start=0,a.outline_time=t,a.period=_,a.relapses=r,-1==Je.indexOf(e)&&Je.push(e)},t.clear_outline_anim=a,t.create_object_from_bpy=function(e,t){var _=t?"%meta_world%"+e.name:e.name,r=t?"%meta_world%"+e.name:e.origin_name,a=t?"WORLD":e.type,n=Me.create_object(_,a,r);if("MESH"==n.type)for(var o=0;o<e.data.materials.length;o++)n.materials.push(e.data.materials[o]);for(var o=0;o<e._scenes.length;o++)Me.append_scene_data(n,e._scenes[o]);return e._object=n,t?D(e,n):C(e,n),n},t.update_object_relations=function(e,t){var _=t.render;if("MESH"==t.type){var r=ve.get_bpy_armobj(e);if(r){var a=r._object,n=a.render.pose_data;J(e,t,a);var o=ve.extract_skinned_pose_data(n.trans,n.quats,_.bone_skinning_info);r.b4w_animation_mixing?(_.quats_before=new Float32Array(o.quats),_.quats_after=new Float32Array(o.quats),_.trans_before=new Float32Array(o.trans),_.trans_after=new Float32Array(o.trans)):(_.quats_before=o.quats,_.quats_after=o.quats,_.trans_before=o.trans,_.trans_after=o.trans),_.arm_rel_trans=new Float32Array(4),_.arm_rel_quat=N.create(),_.pose_data=o,_.frame_factor=0}_.reflective&&K(e,t)}},t.update_force=k,t.copy_scene_data=H,t.check_bpy_obj_scene_compatibility=j,t.update_objects_dynamics=function(e){for(var t=0;t<e.length;t++){var _=e[t];!_.render||"DYNAMIC"!=_.render.type&&"CAMERA"!=_.render.type||Ke.update_transform(_),_.use_default_animation&&ve.obj_is_animatable(_)&&(ve.apply_def(_),_.anim_slots.length&&ve.play(_,null,ve.SLOT_ALL))}},t.bpy_obj_is_dynamic=function(e){if(e.b4w_hidden_on_load)return!0;if(e.dg_parent&&e.dg_parent._is_dynamic)return!0;if(e.parent&&e.parent._is_dynamic)return!0;switch(e.type){case"MESH":return Q(e);case"EMPTY":return V(e);default:return!0}},t.get_meta_tags=function(e){return M.O(e.metatags)},t.get_custom_prop=function(e){return e.custom_prop},t.cleanup=function(){Ve=0,qe=0,We.length=0,Je.length=0,ze={ALL:[]}},t.copy=function(e,t,_){var r=ee(e,t,_);return r.render.is_copied=!0,r.render.is_copied_deep=_,r.render.color_id=he.gen_color_id(Ve),Ve++,r},t.get_bpy_def_action_slots=function(e,t){var _=[],r=e.animation_data,a=e.data?e.data.animation_data:null;if(r&&r.action){var n=r.action;(n._render.type==ve.OBJ_ANIM_TYPE_OBJECT||n._render.type==ve.OBJ_ANIM_TYPE_ARMATURE&&"ARMATURE"==e.type||n._render.type==ve.OBJ_ANIM_TYPE_LIGHT&&"LAMP"==e.type||n._render.type==ve.OBJ_ANIM_TYPE_ENVIRONMENT&&t)&&_.push(ve.init_action_slot(null,n))}return a&&a.action&&("SPEAKER"==e.type||"LAMP"==e.type)&&_.push(ve.init_action_slot(null,a.action)),"MESH"==e.type&&_.push.apply(_,ve.get_bpy_material_actions(e)),t&&_.push.apply(_,ve.get_bpy_world_material_actions(e)),_},t.update_boundings=function(e){for(var t=e.render,_=null,r=e.scenes_data[0].batches,a=0;a<r.length;a++){var n=r[a],o=e.scenes_data[0].batch_world_bounds[a];if(n.bufs_data&&o.be&&o.bb){var i=Ye.get_vbo_type_by_attr_name("a_position"),E=Ye.get_vbo_source_by_type(n.bufs_data.vbo_source_data,i);if(E){var c=n.bufs_data.pointers.a_position.offset,l=n.bufs_data.pointers.a_position.length+c;Ne.update_local_bounds_from_pos(n,E.subarray(c,l)),Me.update_world_bounds_from_batch_tsr(n,t.world_tsr,o),"MAIN"==n.type&&(_?s.D(_,n.bounds_local.bb):_=s.n(n.bounds_local.bb))}}}if(_=_||s.w(),t.billboard)Me.update_render_bounds_billboard(e,_);else{for(var T=[],a=0;a<r.length;a++){var n=r[a];if("MAIN"==n.type){var i=Ye.get_vbo_type_by_attr_name("a_position"),E=Ye.get_vbo_source_by_type(n.bufs_data.vbo_source_data,i);if(E){var d=r[a].bufs_data.pointers,c=d.a_position.offset,l=d.a_position.length+c;T.push(E.subarray(c,l))}}}Me.update_render_bounds_from_pos_arrays(e,_,T)}if(He.debug_view)for(var a=0;a<r.length;a++)if("DEBUG_VIEW"===r[a].type&&r[a].debug_sphere){var u=t.be_local,f=we.generate_uv_sphere(16,8,1,u.center,!1,!1),P=[u.axis_x[0],u.axis_y[1],u.axis_z[2]];Ye.scale_submesh_xyz(f,P,u.center),Ye.submesh_drop_indices(f,1,!0),f.va_common.a_polyindex=Ye.extract_polyindices(f),Ne.update_batch_geometry(r[a],f);break}},t.get_scene_objs=ne,t.get_scene_objs_derived=function(e,t,_){for(var r=ze[t]||[],a=[],n=0;n<r.length;n++){var o=r[n];if(!(o.render.data_id!=_&&_!=et||o.is_meta))for(var i=o.scenes_data,s=0;s<i.length;s++){var E=i[s];E.scene==e&&a.push(o)}}return a},t.get_all_objects=oe,t.get_first_character=function(e){var t=ze.MESH;if(t)for(var _=0;_<t.length;_++){var r=t[_];if(ye.has_character_physics(r))for(var a=r.scenes_data,n=0;n<a.length;n++){var o=a[n];if(o.scene==e)return r}}return null},t.obj_switch_cleanup_flags=ie,t.get_selectable_objects=function(){var e=[],t=ze.MESH;if(t)for(var _=0;_<t.length;_++){var r=t[_];r.render.selectable&&!r.is_meta&&e.push(r)}return e},t.get_outlining_objects=function(){var e=[],t=ze.MESH;if(t)for(var _=0;_<t.length;_++){var r=t[_];r.render.outlining&&!r.is_meta&&e.push(r)}return e},t.get_object=function(){var e=null,_=ze.ALL;switch(arguments[0]){case t.GET_OBJECT_BY_NAME:e=se(arguments[1],_,!0,arguments[2],arguments[3]);break;case t.GET_OBJECT_BY_DUPLI_NAME:e=Ee(arguments[1],arguments[2],_,arguments[3]);break;case t.GET_OBJECT_BY_DUPLI_NAME_LIST:e=ce(arguments[1],_,arguments[2])}return e},t.get_world_by_name=function(e,t){return se("%meta_world%"+e,ze.WORLD,!0,t)},t.get_world_name=function(e){return e.origin_name.replace("%meta_world%","")},t.pick_object=function(e,_){var r=Ce.get_main();if(!r)return Ue.error("No active scene"),null;var a=Ce.get_subs(r,De.STEREO);if(a&&a.enable_hmd_stereo){var n=be.get_canvas();e=n.clientHeight/2,_=n.clientWidth/2}var o=Be.pick_anchor(e,_);if(o)return o;var i=Ce.pick_color(r,e,_);if(!i)return null;for(var s=ne(r,"MESH",et),E=0;E<s.length;E++){var c=s[E].render,l=c.color_id;if(l&&Math.abs(255*l[0]-i[0])<3&&Math.abs(255*l[1]-i[1])<3&&Math.abs(255*l[2]-i[2])<3){if(c.outlining&&c.outline_on_select)if(je.outlining_overview_mode)t.apply_outline_anim(s[E],je.outline_duration,je.outline_period,je.outline_relapses);else{var T=c.outline_anim_settings_default;t.apply_outline_anim(s[E],T.outline_duration,T.outline_period,T.outline_relapses)}return s[E]}}return null},t.set_wind_params=function(e,t){for(var _=ne(e,"EMPTY",et),r=0;r<_.length;r++){var a=_[r];if(a.field&&"WIND"===a.field.type){var n=a;break}}if(!n)return Ue.error("There is no wind on the scene"),0;if("number"==typeof t.wind_dir){var o=M.T(t.wind_dir);x.set(Math.sin(o),-Math.cos(o),0,Ze),M.U(Ze,M.f,$e),Ke.set_rotation(n,$e)}"number"==typeof t.wind_strength&&(n.field.strength=t.wind_strength),k(n)},t.remove_object=function(e){Ie.check_constraint(e)&&Ie.remove(e),de(e)},t.objects_storage_add=Te,t.objects_storage_check=function(e){return ze[e.type]&&ze[e.type].indexOf(e)>-1},t.update_lod_scene=function(e,t){e.render.is_lod&&fe(e,t)},t.update_lod_visibility=ue,t.set_hair_particles_wind_bend_params=function(e){for(var t=e.render,_=t.wind_bending_amp,r=t.wind_bending_freq,a=t.detail_bending_freq,n=t.detail_bending_amp,o=t.branch_bending_amp,i=e.scenes_data,s=0;s<i.length;s++)for(var E=i[s].batches,c=0;c<E.length;c++){var l=E[c],T=l.bufs_data,d=T.pointers,u=d.au_wind_bending_amp,f=d.au_wind_bending_freq,P=d.au_detail_bending_amp,A=d.au_detail_bending_freq,S=d.au_branch_bending_amp;if(f){var p=Array.apply(null,Array(f.length)).map(function(){return r});Ye.update_gl_buffer_sub_data(T,Ye.VBO_FLOAT,new Float32Array(p),f.offset)}if(u){var p=Array.apply(null,Array(u.length)).map(function(){return _});Ye.update_gl_buffer_sub_data(T,Ye.VBO_FLOAT,new Float32Array(p),u.offset)}if(P){var p=Array.apply(null,Array(P.length)).map(function(){return n});Ye.update_gl_buffer_sub_data(T,Ye.VBO_FLOAT,new Float32Array(p),P.offset)}if(A){var p=Array.apply(null,Array(A.length)).map(function(){return a});Ye.update_gl_buffer_sub_data(T,Ye.VBO_FLOAT,new Float32Array(p),A.offset)}if(S){var p=Array.apply(null,Array(S.length)).map(function(){return o});Ye.update_gl_buffer_sub_data(T,Ye.VBO_FLOAT,new Float32Array(p),S.offset)}}},t.inherit_material=function(e,t,_,r){if(e.render.dynamic_geometry&&_.render.dynamic_geometry){var a=Ne.find_batch_material(e,t,"MAIN"),n=null,o=function(e){n||(n={}),e.particles_data&&(n[e.particles_data.name]=e.particles_data)};Ne.iterate_batches_by_mat(_,r,o,"PARTICLES");for(var i=Pe(_,r),s=Se(e,t,_,r),E=Ce.get_active(),c=0;c<_.scenes_data.length;c++){var l=_.scenes_data[c].scene;Ce.set_active(l);var T=ne(l,"LAMP",0),d=_.scenes_data[c].batches;_.scenes_data[c].batches=[],_.scenes_data[c].batch_world_bounds=[],Ne.generate_main_batches(l,[_._bpy_obj],T,[]),Ne.create_forked_batches(_,Ce.get_graph(l),l),Ce.assign_scene_data_subs(l,[_]),Ce.append_object(l,_,!1),ye.append_object(_,l);for(var u=0;u<d.length;u++)Me.append_batch(_,l,d[u])}pe(e,t,_,s),Ae(_,i),Oe(_,r,e,n,a),Ce.set_active(E)}},t.create_line=function(e){e=e||"",e+=$(e);var t=Me.create_object(e,"LINE");return t.render=Me.create_render("EMPTY"),t.is_dynamic=!0,Ne.generate_line_batches(Ce.get_main(),[t]),Ce.append_object(Ce.get_main(),t),Te(t),t},t.generate_mesh_render_boundings=function(e,t){var _=t.render,r=s.n(_.bb_original);_.billboard?Me.update_render_bounds_billboard(t,r):Me.update_render_bounds_from_bpy(t,r,e.data.b4w_boundings)},t.set_nodemat_value=function(e,t,_,r){for(var a=Me.is_world(e),n=!1,o=0;o<e.scenes_data.length;o++)for(var i=e.scenes_data[o].batches,s=0;s<i.length;s++){var E=i[s];(a||-1!=E.material_names.indexOf(t))&&(n|=Ne.set_nodemat_value(E,_,r))}return n&&a&&Ce.update_sky_texture(e),n},t.set_nodemat_rgb=function(e,t,_,r,a,n){for(var o=Me.is_world(e),i=!1,s=0;s<e.scenes_data.length;s++)for(var E=e.scenes_data[s].batches,c=0;c<E.length;c++){var l=E[c];(o||-1!=l.material_names.indexOf(t))&&(i|=Ne.set_nodemat_rgb(l,_,r,a,n))}return i&&o&&Ce.update_sky_texture(e),i},t.get_nodemat_value=function(e,t,_){var r=Ne.find_batch_material_any(e,t,"MAIN")||Ne.find_batch_material_any(e,t,"PARTICLES");return Ne.get_nodemat_value(r,_)},t.get_nodemat_rgb=function(e,t,_,r){var a=Ne.find_batch_material_any(e,t,"MAIN")||Ne.find_batch_material_any(e,t,"PARTICLES");return Ne.get_nodemat_rgb(a,_,r)}}var a=_(0),n=_(37),o=_(5),i=_(16),s=_(25),E=_(14),c=_(4),l=_(58),T=_(15),d=_(30),u=_(20),f=_(57),P=_(74),A=_(52),S=_(8),p=_(47),O=_(19),v=_(1),m=_(63),N=_(9),g=_(10),R=_(11),I=_(23),b=_(17),h=_(18),Y=_(13),L=_(6),M=_(2),x=_(3),y=_(56),U=_(55),w=_(22),C=Object(a.a)("__objects",r);t.a=C},function(e,t,_){"use strict";function r(e,t){function _(e,t){if(m.has_child_of(e)){var _=m.get_child_of_offset(e);d.t(t,_)}else{var r=e.render;d.t(t,r.world_tsr)}}function r(e,t){var _=e.render;if(m.has_child_of(e)){d.q(t,_.world_tsr);var r=m.get_child_of_parent_tsr(e),a=d.o(r,L),n=m.get_child_of_offset(e);d.p(a,_.world_tsr,n)}else d.q(t,_.world_tsr)}function a(e,t){if(m.has_child_of(e)){var _=m.get_child_of_offset(e);d.q(t,_)}else d.q(t,e.render.world_tsr)}function P(e,t){return d.f(e.render.world_tsr,t),t}function A(e,t){if(m.has_child_of(e)){var _=m.get_child_of_offset(e);d.f(_,t)}else d.f(e.render.world_tsr,t);return t}function S(e,t){if(m.has_child_of(e)){var _=m.get_child_of_offset(e);d.a(t,_)}else d.a(t,e.render.world_tsr)}function p(e,t){if(m.has_child_of(e)){var _=m.get_child_of_offset(e);d.a(_,t)}else d.a(e.render.world_tsr,t);return t}function O(e){var t=e.render,_=e.scenes_data,r=e.type;m.update_constraint(e,x),"CAMERA"==r&&v.update_camera(e),n.h(t.bb_local,t.world_tsr,t.bb_world),n.k(t.bs_local,t.world_tsr,t.bs_world);for(var a=0;a<_.length;a++)for(var o=_[a].batches,i=0;i<o.length;i++){var E=o[i],c=_[a].batch_world_bounds[i];g.update_world_bounds_from_batch_tsr(E,t.world_tsr,c)}switch(r){case"MESH":e.need_inv_zup_tsr&&d.o(e.render.world_tsr,e.render.world_tsr_inv);var l=e.armobj;if(l){var T=l.render.world_tsr;d.o(T,L),d.p(L,t.world_tsr,L),d.k(L,t.arm_rel_trans),d.f(L,t.arm_rel_quat)}t.force_zsort=!0;break;case"CAMERA":for(var a=0;a<_.length;a++)v.update_camera_transform(e,_[a]);break;case"SPEAKER":I.speaker_update_transform(e,x,y);break;case"LAMP":s.g(e)}for(var u=d.i(t.world_tsr,b),f=d.f(t.world_tsr,Y),a=0;a<_.length;a++){var P=_[a];if(P.is_active){var A=P.scene,S=A._render,o=P.batches;switch(r){case"MESH":t.shadow_cast&&R.schedule_shadow_update(A);var p=P.cube_refl_subs;null!=t.cube_reflection_id&&p&&R.update_cube_reflect_subs(p,u);break;case"EMPTY":N.update_force(e);break;case"CAMERA":if(R.get_active()==A&&R.get_camera(A)==e){if(R.schedule_grass_map_update(A),S.shadow_params){(S.shadow_params.enable_csm||S.shadow_params.dynamic_grass_cast)&&R.schedule_shadow_update(A);var h=g.get_scene_data(e,A),M=h.cameras[0];R.update_shadow_billboard_view(M,S.graph)}I.listener_update_transform(A,u,f,x,y)}break;case"LAMP":R.update_lamp_scene(e,A)}var U=P.plane_refl_subs,w=e.reflective_objs;if(w.length)for(var i=0;i<U.length;i++){var C=U[i].camera;R.update_plane_reflect_subs(U[i],u,f),g.update_refl_objects(w,C.reflection_plane),v.set_view(C,R.get_camera(A))}}}for(var D=e.cons_descends,a=0;a<D.length;a++)O(D[a]);for(var F=e.cons_armat_bone_descends,a=0;a<F.length;a++){var G=F[a],l=G[0],k=G[1];m.update_bone_constraint(l,k)}}var v=Object(o.a)(e),m=Object(i.a)(e),N=Object(E.a)(e),g=Object(c.a)(e),R=Object(l.a)(e),I=Object(T.a)(e),b=new Float32Array(3),h=new Float32Array(3),Y=new Float32Array(4),L=d.b(),M=d.b(),x=0,y=0;t.update=function(e){x=e,y++},t.set_translation=function(e,t){var _=e.render;if(m.has_child_of(e)){d.t(t,_.world_tsr);var r=m.get_child_of_parent_tsr(e),a=d.o(r,L),n=m.get_child_of_offset(e);d.p(a,_.world_tsr,n)}else d.t(t,_.world_tsr)},t.set_translation_rel=_,t.get_translation=function(e,t){return d.i(e.render.world_tsr,t),t},t.get_translation_rel=function(e,t){if(m.has_child_of(e)){var _=m.get_child_of_offset(e);d.i(_,t)}else d.i(e.render.world_tsr,t);return t},t.set_rotation=r,t.set_rotation_rel=a,t.get_rotation=P,t.get_rotation_rel=A,t.set_rotation_euler=function(e,t){r(e,u.Y(t,Y))},t.set_rotation_euler_rel=function(e,t){a(e,u.Y(t,Y))},t.get_rotation_euler=function(e,t){var _=P(e,Y);return t=u._35(_,t)},t.get_rotation_euler_rel=function(e,t){var _=A(e,Y);return t=u._35(_,t)},t.set_scale=function(e,t){var _=e.render;if(m.has_child_of(e)){var r=m.get_child_of_offset(e),a=d.h(m.get_child_of_parent_tsr(e));d.r(t/a,r)}else d.r(t,_.world_tsr)},t.set_scale_rel=function(e,t){var _=e.render;if(m.has_child_of(e)){var r=m.get_child_of_offset(e);d.r(t,r)}else d.r(t,_.world_tsr)},t.get_scale=function(e){return d.h(e.render.world_tsr)},t.get_scale_rel=function(e){if(m.has_child_of(e)){var t=m.get_child_of_offset(e);return d.h(t)}return d.h(e.render.world_tsr)},t.set_tsr=function(e,t){if(d.a(t,e.render.world_tsr),m.has_child_of(e)){var _=m.get_child_of_parent_tsr(e),r=d.o(_,L),a=m.get_child_of_offset(e);d.p(r,e.render.world_tsr,a)}},t.set_tsr_rel=S,t.get_tsr=function(e,t){return d.a(e.render.world_tsr,t)},t.get_tsr_rel=p,t.get_object_size=function(e){var t=e.render,_=t.bb_original,r=d.h(t.world_tsr),a=r*(_.max_x-_.min_x),n=r*(_.max_y-_.min_y),o=r*(_.max_z-_.min_z);return.5*Math.sqrt(a*a+n*n+o*o)},t.get_object_center=function(e,t,_){if(t){var r=e.render;f.copy(r.bs_world.center,_)}else{var r=e.render,a=r.bb_original;_[0]=(a.max_x+a.min_x)/2,_[1]=(a.max_y+a.min_y)/2,_[2]=(a.max_z+a.min_z)/2,d.B(_,r.world_tsr,_)}return _},t.move_local=function(e,t,r,a){var n=p(e,L),o=b;o[0]=t,o[1]=r,o[2]=a,d.B(o,n,o),_(e,o)},t.rotate_local=function(e,t){var _=p(e,L),r=d.q(t,d.l(M));d.p(_,r,r),S(e,r)},t.update_transform=O,t.distance=function(e,t){var _=d.i(e.render.world_tsr,b),r=d.i(t.render.world_tsr,h);return f.dist(_,r)},t.obj_point_distance=function(e,t){var _=d.i(e.render.world_tsr,b);return f.dist(_,t)}}var a=_(0),n=_(25),o=_(14),i=_(58),s=_(57),E=_(12),c=_(8),l=_(10),T=_(23),d=_(6),u=_(2),f=_(3),P=Object(a.a)("__transform",r);t.a=P},function(e,t,_){"use strict";function r(e,t){function _(e,_){var r=_.render.move_style,a=e.data,n=null;return r!=t.MS_TARGET_CONTROLS&&r!=t.MS_EYE_CONTROLS||!a.b4w_use_horizontal_clamping||(n={left:a.b4w_rotation_left_limit,right:a.b4w_rotation_right_limit,camera_space:"LOCAL"==a.b4w_horizontal_clamping_type},r==t.MS_EYE_CONTROLS&&(n.left*=-1,n.right*=-1)),n}function r(e,_){var r=_.render.move_style,a=e.data,n=null;return r!=t.MS_TARGET_CONTROLS&&r!=t.MS_EYE_CONTROLS||!a.b4w_use_vertical_clamping?r==t.MS_HOVER_CONTROLS&&a.b4w_use_zooming&&(a.b4w_hover_angle_min<=a.b4w_hover_angle_max?(n={down:a.b4w_hover_angle_min,up:a.b4w_hover_angle_max},n.down*=-1,n.up*=-1):qe.error("Wrong angle limits for the HOVER camera. Disabling angle limits.")):(n={down:a.b4w_rotation_down_limit,up:a.b4w_rotation_up_limit,camera_space:"LOCAL"==a.b4w_vertical_clamping_type},r==t.MS_TARGET_CONTROLS&&(n.down*=-1,n.up*=-1)),n}function a(e,_){var r=_.render.move_style,a=e.data,n=null;return r==t.MS_TARGET_CONTROLS&&a.b4w_use_target_distance_limits&&a.b4w_distance_min<=a.b4w_distance_max?n={min:a.b4w_distance_min,max:a.b4w_distance_max}:r===t.MS_HOVER_CONTROLS&&a.b4w_use_zooming&&(a.b4w_distance_min<=a.b4w_distance_max?n={min:a.b4w_distance_min,max:a.b4w_distance_max}:qe.error("Wrong distance limits for the HOVER camera. Disabling distance limits.")),n}function O(e,_){var r=_.render.move_style,a=e.data,n=null;return r==t.MS_HOVER_CONTROLS&&a.b4w_use_horizontal_clamping&&a.b4w_horizontal_translation_min<=a.b4w_horizontal_translation_max&&(n={min:a.b4w_horizontal_translation_min,max:a.b4w_horizontal_translation_max}),n}function v(e,_){var r=_.render.move_style,a=e.data,n=null;return r==t.MS_HOVER_CONTROLS&&a.b4w_use_vertical_clamping&&a.b4w_vertical_translation_min<=a.b4w_vertical_translation_max&&(n={min:a.b4w_vertical_translation_min,max:a.b4w_vertical_translation_max}),n}function m(e,_){var r=_.render.move_style,a=e.data,n=null;return r==t.MS_TARGET_CONTROLS&&a.b4w_use_pivot_limits&&(n={min_z:a.b4w_pivot_z_min,max_z:a.b4w_pivot_z_max}),n}function N(e,t,_,r,a){Ze.set_translation(e,t),_&&V(e,t,_),Z(e,r),ee(e,a)}function g(e,t,_,r,a,n,o,i){var s=e.render;Ze.set_translation(e,t),s.pivot.set(_),V(e,t,_),Z(e,r),ee(e,a),ae(e,n),ne(e,o),s.use_panning=i}function R(e,t,_,r,a,n,o,i){var s=e.render;Ze.set_translation(e,t),s.hover_pivot.set(_),V(e,t,_),re(e,r),te(e,a),oe(e,n),ie(e,o),s.enable_hover_hor_rotation=i}function I(e,t,_){var r=e.render,a=P.j(r.world_tsr),n=P.g(r.world_tsr),o=St;o.set(A.f),o[3]=0;var i=w(e,it)[1],s=A._33(n,A.c,ct);return E.R(mt,a),E.Q(mt,s),(!A._21(o,-t,mt,_)||Math.abs(i)<rt)&&(qe.warn("Active hover camera view vector and the supporting plane are parallel to each other. Hover pivot will be set based on the camera position."),_[0]=a[0],_[1]=a[1],_[2]=0),_}function b(e){for(var _=e.render,r=0;r<e.scenes_data.length;r++){var a=e.scenes_data[r].cameras[0];if(a.type==t.TYPE_ORTHO)switch(_.move_style){case t.MS_TARGET_CONTROLS:var n=P.j(_.world_tsr);_.init_dist=S.dist(n,_.pivot),_.init_fov=a.fov;break;case t.MS_HOVER_CONTROLS:var n=P.j(_.world_tsr);_.init_dist=S.dist(n,_.hover_pivot),_.init_fov=a.fov}}}function h(e){var t={type:e,name:"",size_mult:1,width:0,height:0,framebuffer:null,framebuffer_prev:null,color_attachment:null,depth_attachment:null,aspect:0,fov:0,fit:"VERTICAL",near:0,far:0,left:0,right:0,top:0,bottom:0,hmd_fov:p.create(),world_tsr:new Float32Array(9),view_matrix:new Float32Array(16),view_refl_matrix:new Float32Array(16),view_transform_params:{trans:S.create(),angle:0},proj_matrix:new Float32Array(16),view_proj_matrix:new Float32Array(16),view_proj_inv_matrix:new Float32Array(16),prev_view_proj_matrix:new Float32Array(16),sky_vp_inv_matrix:new Float32Array(16),direction:new Float32Array(3),view_tsr:P.c(),view_tsr_inv:P.c(),real_view_tsr:P.c(),real_view_tsr_inv:P.c(),shadow_cast_billboard_view_tsr:P.c(),dof_distance:0,dof_front_start:0,dof_front_end:0,dof_rear_start:0,dof_rear_end:0,dof_power:0,dof_bokeh_intensity:0,dof_object:null,dof_bokeh:!1,dof_foreground_blur:!1,dof_on:!1,lod_eye:new Float32Array(3),frustum_planes:L(),stereo_conv_dist:0,stereo_eye_dist:0,reflection_plane:null,csm_centers:null,csm_radii:null,csm_center_dists:new Float32Array(4),pcf_blur_radii:new Float32Array(4)};return t.hmd_fov[0]=t.hmd_fov[2]=0,t.hmd_fov[1]=t.hmd_fov[3]=0,t}function Y(e,t){var _=h(e.type);return _.name=e.name,_.size_mult=e.size_mult,_.width=e.width,_.height=e.height,t||(_.framebuffer=e.framebuffer,_.framebuffer_prev=e.framebuffer_prev,_.color_attachment=e.color_attachment,_.depth_attachment=e.depth_attachment),_.aspect=e.aspect,_.fit=e.fit,_.fov=e.fov,_.near=e.near,_.far=e.far,_.left=e.left,_.right=e.right,_.top=e.top,_.bottom=e.bottom,p.copy(e.hmd_fov,_.hmd_fov),P.a(e.world_tsr,_.world_tsr),s.copy(e.view_matrix,_.view_matrix),s.copy(e.view_refl_matrix,_.view_refl_matrix),_.view_transform_params=A.O(e.view_transform_params),s.copy(e.proj_matrix,_.proj_matrix),s.copy(e.view_proj_matrix,_.view_proj_matrix),s.copy(e.view_proj_inv_matrix,_.view_proj_inv_matrix),s.copy(e.prev_view_proj_matrix,_.prev_view_proj_matrix),s.copy(e.sky_vp_inv_matrix,_.sky_vp_inv_matrix),_.direction.set(e.direction),P.a(e.view_tsr,_.view_tsr),P.a(e.view_tsr_inv,_.view_tsr_inv),P.a(e.real_view_tsr,_.real_view_tsr),P.a(e.real_view_tsr_inv,_.real_view_tsr_inv),P.a(e.shadow_cast_billboard_view_tsr,_.shadow_cast_billboard_view_tsr),_.dof_distance=e.dof_distance,_.dof_front_start=e.dof_front_start,_.dof_front_end=e.dof_front_end,_.dof_rear_start=e.dof_rear_start,_.dof_rear_end=e.dof_rear_end,_.dof_power=e.dof_power,_.dof_bokeh_intensity=e.dof_bokeh_intensity,_.dof_object=e.dof_object,_.dof_bokeh=e.dof_bokeh,_.dof_foreground_blur=e.dof_foreground_blur,_.dof_on=e.dof_on,S.copy(e.lod_eye,_.lod_eye),M(e.frustum_planes,_.frustum_planes),_.stereo_conv_dist=e.stereo_conv_dist,_.stereo_eye_dist=e.stereo_eye_dist,e.reflection_plane&&(_.reflection_plane=p.clone(e.reflection_plane)),Ke(e,_),p.copy(e.csm_center_dists,_.csm_center_dists),p.copy(e.pcf_blur_radii,_.pcf_blur_radii),_}function L(){return{left:new Float32Array([0,0,0,0]),right:new Float32Array([0,0,0,0]),top:new Float32Array([0,0,0,0]),bottom:new Float32Array([0,0,0,0]),near:new Float32Array([0,0,0,0]),far:new Float32Array([0,0,0,0])}}function M(e,t){return p.copy(e.left,t.left),p.copy(e.right,t.right),p.copy(e.top,t.top),p.copy(e.bottom,t.bottom),p.copy(e.near,t.near),p.copy(e.far,t.far),t}function x(e){switch(e){case"STATIC":return t.MS_STATIC;case"TARGET":return t.MS_TARGET_CONTROLS;case"EYE":return t.MS_EYE_CONTROLS;case"HOVER":return t.MS_HOVER_CONTROLS;default:Qe.panic("Unknown move style")}}function y(e){var _=h(e);if(e==t.TYPE_NONE)return _;switch(e){case t.TYPE_PERSP:G(_,et,tt,_t);break;case t.TYPE_ORTHO:G(_,$e,tt,_t);break;case t.TYPE_PERSP_ASPECT:case t.TYPE_ORTHO_ASPECT:case t.TYPE_ORTHO_ASYMMETRIC:break;case t.TYPE_STEREO_LEFT:case t.TYPE_STEREO_RIGHT:case t.TYPE_HMD_LEFT:case t.TYPE_HMD_RIGHT:Qe.panic("Stereo camera may only be created from perspective one");break;default:Qe.panic("Unknown camera type")}return _}function U(e,_,r){if(e.type!=t.TYPE_STEREO_LEFT&&e.type!=t.TYPE_STEREO_RIGHT&&e.type!=t.TYPE_HMD_LEFT&&e.type!=t.TYPE_HMD_RIGHT&&Qe.panic("set_stereo_params(): wrong camera type"),e.type!=t.TYPE_STEREO_LEFT&&e.type!=t.TYPE_STEREO_RIGHT||(e.stereo_conv_dist=_),e.stereo_eye_dist=r,be(e,!1),We.check_active()){var a=We.get_active(),n=a._render.shadow_params;if(n)for(var o=Ve.get_scene_data(We.get_camera(a),a),i=o.cameras,s=0;s<i.length;s++)Fe(i[s],n)}}function w(e,t){return C(P.g(e.render.world_tsr),e.render.vertical_axis,t)}function C(e,t,_){var r=ct,a=lt;S.dot(t,A.f)>0?(S.cross(A.d,t,r),S.normalize(r,r)):S.copy(A.f,r),S.cross(t,r,a);var n=A._33(e,A.f,Tt),o=A._33(e,A.b,dt),i=-Math.asin(S.dot(n,t)),s=S.dot(o,t);if(Math.abs(i)>Math.PI/4)var E=S.scale(o,-A._49(i),ut);else var E=S.scale(n,-A._49(Math.asin(s)),ft);var c=Math.atan(Math.abs(S.dot(a,E)/S.dot(r,E))),l=i;s>0&&(l=A._49(l)*Math.PI-l);var T=c;return S.dot(r,E)<0&&(T=Math.PI-T),S.dot(a,E)<0&&(T=2*Math.PI-T),_[0]=T,_[1]=l,_}function D(e){switch(e.fit){case"AUTO":return e.aspect>1?He(e)?e.fov/e.aspect:2*Math.atan(Math.tan(e.fov/2)/e.aspect):e.fov;case"HORIZONTAL":return He(e)?e.fov/e.aspect:2*Math.atan(Math.tan(e.fov/2)/e.aspect);case"VERTICAL":return e.fov}}function F(e){switch(e.fit){case"AUTO":return e.aspect>1?e.fov:He(e)?e.fov*e.aspect:2*Math.atan(Math.tan(e.fov/2)*e.aspect);case"HORIZONTAL":return e.fov;case"VERTICAL":return He(e)?e.fov*e.aspect:2*Math.atan(Math.tan(e.fov/2)*e.aspect)}}function G(e,_,r,a){switch(e.type){case t.TYPE_PERSP:case t.TYPE_STEREO_LEFT:case t.TYPE_STEREO_RIGHT:case t.TYPE_ORTHO:e.fov=_,e.aspect=1;break;case t.TYPE_HMD_LEFT:case t.TYPE_HMD_RIGHT:break;default:Qe.panic("set_frustum(): Unsupported camera type: "+e.type)}e.near=r,e.far=a}function k(e,_,r,a,n,o,i){switch(e.type){case t.TYPE_ORTHO_ASYMMETRIC:e.left=_,e.right=r,e.bottom=a,e.top=n,e.near=o,e.far=i;break;default:Qe.panic("set_frustum_asymmetric(): Unsupported camera type: "+e.type)}}function K(e){return e.render.move_style}function B(e,_){var r=P.i(_.render.world_tsr,ct),a=P.f(_.render.world_tsr,Pt),n=s.fromRotationTranslation(a,r,Ot);if(s.invert(n,e.view_matrix),We.check_active())var o=We.get_active(),i=We.get_subs(o,Je.STEREO);e.type==t.TYPE_STEREO_LEFT||i&&i.enable_hmd_stereo&&e.type==t.TYPE_HMD_LEFT?e.view_matrix[12]+=e.stereo_eye_dist/2:(e.type==t.TYPE_STEREO_RIGHT||i&&i.enable_hmd_stereo&&e.type==t.TYPE_HMD_RIGHT)&&(e.view_matrix[12]-=e.stereo_eye_dist/2),e.reflection_plane&&(P.d(e.view_matrix,e.real_view_tsr),P.o(e.real_view_tsr,e.real_view_tsr_inv),X(e),H(e),j(e,!0),S.transformMat4(r,e.view_refl_matrix,r)),P.d(e.view_matrix,e.view_tsr),P.o(e.view_tsr,e.view_tsr_inv),P.s(r,1,a,e.world_tsr),Me(e)}function X(e){var t=e.reflection_plane[0],_=e.reflection_plane[1],r=e.reflection_plane[2],a=e.reflection_plane[3],n=e.view_refl_matrix;n[0]=1-2*t*t,n[1]=-2*t*_,n[2]=-2*t*r,n[3]=0,n[4]=-2*t*_,n[5]=1-2*_*_,n[6]=-2*_*r,n[7]=0,n[8]=-2*t*r,n[9]=-2*_*r,n[10]=1-2*r*r,n[11]=0,n[12]=-2*t*a,n[13]=-2*_*a,n[14]=-2*r*a,n[15]=1}function H(e){s.multiply(e.view_matrix,e.view_refl_matrix,e.view_matrix)}function j(e,t){be(e,!0);var _=St,r=Ot;s.invert(e.view_matrix,r),s.transpose(r,r),p.transformMat4(e.reflection_plane,r,_);var a=pt;a[0]=(A._49(_[0])+e.proj_matrix[8])/e.proj_matrix[0],a[1]=(A._49(_[1])+e.proj_matrix[9])/e.proj_matrix[5],a[2]=-1,a[3]=(1+e.proj_matrix[10])/e.proj_matrix[14];var n=_[0]*a[0]+_[1]*a[1]+_[2]*a[2]+_[3]*a[3];p.scale(_,2/n,_),e.proj_matrix[2]=_[0],e.proj_matrix[6]=_[1],e.proj_matrix[10]=_[2]+1,e.proj_matrix[14]=_[3],Le(e),t||Me(e)}function Q(e,_,r,a){s.lookAt(_,r,a,e.view_matrix);var n=We.get_active(),o=We.get_subs(n,Je.STEREO);e.type==t.TYPE_STEREO_LEFT||o&&o.enable_hmd_stereo&&e.type==t.TYPE_HMD_LEFT?e.view_matrix[12]+=e.stereo_eye_dist/2:(e.type==t.TYPE_STEREO_RIGHT||o&&o.enable_hmd_stereo&&e.type==t.TYPE_HMD_RIGHT)&&(e.view_matrix[12]-=e.stereo_eye_dist/2),P.d(e.view_matrix,e.view_tsr),xe(e),ye(e),P.t(_,e.world_tsr)}function z(e,t,_){var r=S.subtract(_,t,ct);if(S.length(r)){S.normalize(r,r);var a=A._47(A.c,r,Pt);Ze.set_rotation(e,a)}Ze.set_translation(e,t)}function V(e,t,_){var r=e.render,a=J(e);if(z(e,t,_),a){var n=S.copy(r.vertical_axis,ct);S.negate(n,n),W(e,n,!0)}else W(e,r.vertical_axis,!0)}function q(e,t){for(var _=e.render,r=t.cameras,a=P.f(_.world_tsr,Pt),n=A._33(a,A.c,ct),o=P.i(_.world_tsr,lt),i=t.shadow_cameras,s=0;s<i.length;s++){var E=i[s];S.copy(n,E.direction),P.i(_.world_tsr,E.lod_eye)}for(var s=0;s<r.length;s++){var E=r[s];if(B(E,e),S.copy(n,E.direction),E.dof_object&&E.dof_on){var c=Ze.get_translation(E.dof_object,Tt),l=S.dist(o,c);E.dof_distance=l}}}function W(e,t,_){var r=e.render,a=P.g(r.world_tsr),n=A._33(a,A.f,ct);if(S.normalize(n,n),Math.abs(S.dot(t,n))>.999999)var o=T.identity(Pt);else{var i=S.cross(t,n,lt);S.normalize(i,i);var s=A._33(a,A.b,Tt);S.dot(s,t)>0&&S.negate(i,i);var E=A._33(a,A.d,Tt);S.normalize(E,E);var c=A.M(S.dot(E,i),-1,1);if(c<=-.999999)var l=Math.acos(c),o=T.setAxisAngle(n,l,Pt);else var o=T.rotationTo(E,i,Pt);T.normalize(o,o)}if(T.multiply(o,a,a),_){var d=A._33(a,A.e,ct);S.dot(t,d)<0&&T.rotateZ(a,Math.PI,a)}}function J(e){var t=P.g(e.render.world_tsr),_=e.render.vertical_axis,r=A._33(t,A.e,ct);return S.dot(r,_)<0}function Z(e,t){var _=e.render;t?(_.horizontal_limits=_.horizontal_limits||{},_.horizontal_limits.left=t.left,_.horizontal_limits.right=t.right,_.horizontal_limits.left_local=t.left,_.horizontal_limits.right_local=t.right,_.horizontal_limits.camera_space=Boolean(t.camera_space),$(e)):_.horizontal_limits=null}function $(e){var _=e.render,r=_.horizontal_limits;if(r&&(_.move_style==t.MS_EYE_CONTROLS||_.move_style==t.MS_TARGET_CONTROLS)){var a=w(e,it);r.camera_space?(r.left+=a[0],r.right+=a[0]):(r.left_local-=a[0],r.right_local-=a[0]),r.left=A.A(r.left),r.right=A.A(r.right),r.left_local=A.A(r.left_local),r.right_local=A.A(r.right_local)}}function ee(e,t){var _=e.render;t?(_.vertical_limits=_.vertical_limits||{},_.vertical_limits.down=t.down,_.vertical_limits.up=t.up,_.vertical_limits.down_local=t.down,_.vertical_limits.up_local=t.up,_.vertical_limits.camera_space=Boolean(t.camera_space),_e(e)):_.vertical_limits=null}function te(e,t){var _=e.render;if(!t){var r=w(e,it);t={down:r[1],up:r[1]}}_.vertical_limits=_.vertical_limits||{},_.vertical_limits.down=t.down,_.vertical_limits.up=t.up,_e(e),_.distance_limits&&_.vertical_limits&&Oe(e)}function _e(e){var _=e.render,r=_.vertical_limits;if(r)switch(_.move_style){case t.MS_EYE_CONTROLS:case t.MS_TARGET_CONTROLS:var a=w(e,it);r.camera_space?(r.up+=a[1],r.down+=a[1]):(r.up_local-=a[1],r.down_local-=a[1]),r.up=A.B(r.up,-Math.PI,Math.PI),r.down=A.B(r.down,-Math.PI,Math.PI),r.up_local=A.B(r.up_local,-Math.PI,Math.PI),r.down_local=A.B(r.down_local,-Math.PI,Math.PI);break;case t.MS_HOVER_CONTROLS:r.up=A.B(r.up,-Math.PI,Math.PI),r.down=A.B(r.down,-Math.PI,Math.PI),r.up=A.M(r.up,-Math.PI/2,0),r.down=A.M(r.down,-Math.PI/2,0)}}function re(e,t){var _=e.render;if(!t){var r=Ze.obj_point_distance(e,_.hover_pivot);t={min:r,max:r}}_.distance_limits=_.distance_limits||{},_.distance_limits.min=t.min,_.distance_limits.max=t.max,_.distance_limits&&_.vertical_limits&&Oe(e)}function ae(e,t){var _=e.render;t?(_.distance_limits=_.distance_limits||{},_.distance_limits.min=t.min,_.distance_limits.max=t.max):_.distance_limits=null}function ne(e,t){var _=e.render;t?(_.pivot_limits=_.pivot_limits||{},_.pivot_limits.min_z=t.min_z,_.pivot_limits.max_z=t.max_z):_.pivot_limits=null}function oe(e,t){var _=e.render;t?(_.hover_horiz_trans_limits=_.hover_horiz_trans_limits||{},_.hover_horiz_trans_limits.min=t.min,_.hover_horiz_trans_limits.max=t.max):_.hover_horiz_trans_limits=null}function ie(e,t){var _=e.render;t?(_.hover_vert_trans_limits=_.hover_vert_trans_limits||{},_.hover_vert_trans_limits.min=t.min,_.hover_vert_trans_limits.max=t.max):_.hover_vert_trans_limits=null}function se(e){var _=e.render;if(Ve.is_camera(e))for(var r=e.scenes_data,a=0;a<r.length;a++){var n=r[a].cameras;if(n[0].type===t.TYPE_ORTHO){switch(_.move_style){case t.MS_TARGET_CONTROLS:var o=P.j(_.world_tsr),i=S.dist(o,_.pivot),s=i/_.init_dist*_.init_fov;break;case t.MS_HOVER_CONTROLS:var o=P.j(_.world_tsr),i=S.distance(o,_.hover_pivot),s=i/_.init_dist*_.init_fov;break;default:var s=n[0].fov}for(var E=0;E<n.length;E++){var c=n[E];c.fov=s,be(c,!0)}q(e,r[a])}}}function Ee(e){var _=e.render,r=_.move_style;if(r===t.MS_TARGET_CONTROLS||r===t.MS_EYE_CONTROLS){if(_.horizontal_limits){var a=_.horizontal_limits.left,n=_.horizontal_limits.right,o=w(e,it);if(r==t.MS_TARGET_CONTROLS)var i=A.H(o[0],a,n);else var i=A.H(o[0],n,a);i&&(r==t.MS_TARGET_CONTROLS?le(e,i,0):de(e,i,0))}if(_.vertical_limits){var s=_.vertical_limits.down,E=_.vertical_limits.up,o=w(e,it);if(r==t.MS_TARGET_CONTROLS)var i=A.H(o[1],E,s);else var i=A.H(o[1],s,E);i&&(r==t.MS_TARGET_CONTROLS?le(e,0,i):de(e,0,i))}r===t.MS_TARGET_CONTROLS&&_.distance_limits&&me(e)}r===t.MS_TARGET_CONTROLS&&_.pivot_limits&&Ne(e),r===t.MS_HOVER_CONTROLS&&(ge(e),Re(e))}function ce(e,t,_,r){var a=w(e,Et);return r[0]=t-a[0],r[1]=_-a[1],r}function le(e,t,_){pe(e,e.render.pivot,t,_)}function Te(e,t,_){var r=ce(e,t,_,st);le(e,r[0],r[1])}function de(e,t,_){fe(e,t,_)}function ue(e,t,_){Pe(e,t,_)}function fe(e,t,_){var r=e.render;if(t||_){var a=T.identity(Pt);if(t){var n=T.setAxisAngle(r.vertical_axis,t,At);T.multiply(a,n,a)}var o=P.g(r.world_tsr);if(_){var i=A._33(o,A.d,ct),s=T.setAxisAngle(i,_,At);T.normalize(s,s),T.multiply(a,s,a)}T.multiply(a,o,o),T.normalize(o,o)}}function Pe(e,t,_){var r=t,a=_,n=e.render,o=P.f(n.world_tsr,Pt),i=C(o,n.vertical_axis,it);r=t-i[0],a=_-i[1],fe(e,r,a)}function Ae(e,t,_){var r=e.render;r.enable_hover_hor_rotation||(t=0),pe(e,r.hover_pivot,t,_),_&&Oe(e)}function Se(e,t,_){var r=ce(e,t,_,st);Ae(e,r[0],r[1])}function pe(e,t,_,r){var a=e.render;if(_||r){var n=T.identity(Pt);_&&T.setAxisAngle(e.render.vertical_axis,_,Pt);var o=P.g(a.world_tsr);if(r){var i=A._33(o,A.d,ct),s=T.setAxisAngle(i,r,At);T.normalize(s,s),T.multiply(n,s,n)}var E=P.j(a.world_tsr);A._45(E,t,n,E),T.multiply(n,o,o),T.normalize(o,o)}}function Oe(e){var t=e.render,_=w(e,it)[1],r=ve(e,_),a=P.j(t.world_tsr),n=P.g(t.world_tsr),o=A._33(n,A.c,ct);S.normalize(o,o),S.scale(o,r,o),S.subtract(t.hover_pivot,o,a)}function ve(e,t){var _=e.render,r=_.vertical_limits,a=_.distance_limits;if(r.down-r.up){var n=(r.down-t)/(r.down-r.up);n=Math.max(n,0)}else var n=0;return n*(a.max-a.min)+a.min}function me(e){var t=e.render,_=P.j(t.world_tsr),r=S.subtract(_,t.pivot,ct),a=S.length(r);if(a>t.distance_limits.max){var n=t.distance_limits.max/a;S.scale(r,n,r),S.add(t.pivot,r,_)}else if(a<t.distance_limits.min){var o=P.g(t.world_tsr),i=A._33(o,A.c,lt);S.scale(i,100*t.distance_limits.min,i),S.add(r,i,r),S.scale(r,-t.distance_limits.min/S.length(r),r),S.add(t.pivot,r,_)}}function Ne(e){var t=e.render,_=t.pivot[2],r=A.M(t.pivot[2],t.pivot_limits.min_z,t.pivot_limits.max_z);if(r!=_){var a=S.set(0,0,r-_,ct);S.add(t.pivot,a,t.pivot);var n=P.j(t.world_tsr);S.add(n,a,n)}}function ge(e){var t=e.render;if(t.hover_horiz_trans_limits){var _=A.M(t.hover_pivot[0],t.hover_horiz_trans_limits.min,t.hover_horiz_trans_limits.max)-t.hover_pivot[0];t.hover_pivot[0]+=_;var r=P.j(t.world_tsr);r[0]+=_}if(t.hover_vert_trans_limits){var a=A.M(t.hover_pivot[1],t.hover_vert_trans_limits.min,t.hover_vert_trans_limits.max)-t.hover_pivot[1];t.hover_pivot[1]+=a;var r=P.j(t.world_tsr);r[1]+=a}}function Re(e){var t=e.render,_=w(e,it)[1],r=A.H(_,t.vertical_limits.up,t.vertical_limits.down);r&&Ae(e,0,r)}function Ie(e,_){switch(e.type){case t.TYPE_PERSP_ASPECT:case t.TYPE_ORTHO_ASPECT:qe.error("set_aspect(): Unsupported camera type: "+e.type);break;default:e.aspect=_}}function be(e,_){switch(e.type){case t.TYPE_PERSP:case t.TYPE_PERSP_ASPECT:s.perspective(D(e),e.aspect,e.near,e.far,e.proj_matrix);break;case t.TYPE_ORTHO:case t.TYPE_ORTHO_ASPECT:var r=D(e),a=r*e.aspect;s.ortho(-a,a,-r,r,e.near,e.far,e.proj_matrix);break;case t.TYPE_ORTHO_ASYMMETRIC:s.ortho(e.left,e.right,e.bottom,e.top,e.near,e.far,e.proj_matrix);break;case t.TYPE_STEREO_LEFT:case t.TYPE_STEREO_RIGHT:he(e);break;case t.TYPE_HMD_LEFT:case t.TYPE_HMD_RIGHT:Ye(e);break;case t.TYPE_NONE:return;default:Qe.panic("Wrong camera type: "+e.type)}Le(e),_||Me(e)}function he(e){var _=Math.tan(D(e)/2),r=e.near*_,a=-r,n=e.aspect*e.stereo_conv_dist*_;if(e.type==t.TYPE_STEREO_LEFT)var o=n-e.stereo_eye_dist/2,i=n+e.stereo_eye_dist/2;else var o=n+e.stereo_eye_dist/2,i=n-e.stereo_eye_dist/2;var E=-e.near/e.stereo_conv_dist*o,c=e.near/e.stereo_conv_dist*i;s.frustum(E,c,a,r,e.near,e.far,e.proj_matrix),e.left=E,e.right=c}function Ye(e){if(We.check_active()){var t=We.get_active(),_=We.get_subs(t,Je.STEREO);if(_&&_.enable_hmd_stereo){var r=Math.tan(e.hmd_fov[0]),a=Math.tan(e.hmd_fov[1]),n=Math.tan(e.hmd_fov[2]),o=Math.tan(e.hmd_fov[3]);e.top=e.near*r,e.right=e.near*a,e.bottom=-e.near*n,e.left=-e.near*o,s.frustum(e.left,e.right,e.bottom,e.top,e.near,e.far,e.proj_matrix)}else e.top=e.near*Math.tan(D(e)/2),e.bottom=-e.top,e.right=e.top*e.aspect,e.left=-e.right,s.perspective(D(e),e.aspect,e.near,e.far,e.proj_matrix)}}function Le(e){s.translate(e.proj_matrix,e.view_transform_params.trans,e.proj_matrix),s.rotateZ(e.proj_matrix,e.view_transform_params.angle,e.proj_matrix)}function Me(e){xe(e),ye(e),A._0(e.view_proj_matrix,e.frustum_planes)}function xe(e){s.copy(e.view_matrix,e.view_proj_matrix),s.multiply(e.proj_matrix,e.view_proj_matrix,e.view_proj_matrix),s.invert(e.view_proj_matrix,e.view_proj_inv_matrix)}function ye(e){s.copy(e.view_matrix,e.sky_vp_inv_matrix),e.sky_vp_inv_matrix[12]=0,e.sky_vp_inv_matrix[13]=0,e.sky_vp_inv_matrix[14]=0,e.sky_vp_inv_matrix[15]=1,s.multiply(e.proj_matrix,e.sky_vp_inv_matrix,e.sky_vp_inv_matrix),s.invert(e.sky_vp_inv_matrix,e.sky_vp_inv_matrix)}function Ue(e,_,r,a,n){a||(a=new Float32Array(24)),_||(_=e.near),r||(r=e.far);var o,i,E,c,l,T,d,u;switch(e.type){case t.TYPE_NONE:Qe.panic("Extraction from NONE camera is not possible");break;case t.TYPE_PERSP:case t.TYPE_PERSP_ASPECT:o=_*Math.tan(D(e)/2),c=-o,i=o*e.aspect,E=-i;l=o*(r/_),u=-l,T=l*e.aspect,d=-T;break;case t.TYPE_ORTHO:case t.TYPE_ORTHO_ASPECT:var f=D(e),P=f*e.aspect;o=l=f,i=T=P,c=u=-f,E=d=-P;break;case t.TYPE_ORTHO_ASYMMETRIC:o=l=e.top,i=T=e.right,c=u=e.bottom,E=d=e.left;break;case t.TYPE_STEREO_LEFT:case t.TYPE_STEREO_RIGHT:var S=_/e.near;o=_*Math.tan(D(e)/2),c=-o,i=e.right*S,E=e.left*S;var p=r/_;l=o*p,u=-l,T=i*p,d=E*p;break;case t.TYPE_HMD_LEFT:case t.TYPE_HMD_RIGHT:var S=_/e.near;o=e.top*S,c=e.bottom*S,i=e.right*S,E=e.left*S;var p=r/_;l=o*p,u=c*p,T=i*p,d=E*p;break;default:Qe.panic("Wrong camera type: "+e.type)}if(a[0]=E,a[1]=c,a[2]=-_,a[3]=i,a[4]=c,a[5]=-_,a[6]=i,a[7]=o,a[8]=-_,a[9]=E,a[10]=o,a[11]=-_,a[12]=d,a[13]=u,a[14]=-r,a[15]=d,a[16]=l,a[17]=-r,a[18]=T,a[19]=l,a[20]=-r,a[21]=T,a[22]=u,a[23]=-r,n){var O=Ot;s.invert(e.view_matrix,O),A._27(a,O,a,0)}return a}function we(e){return Ve.is_camera(e)&&e.render&&e.render.move_style==t.MS_STATIC}function Ce(e){return Ve.is_camera(e)&&e.render&&e.render.move_style==t.MS_TARGET_CONTROLS}function De(e){return Ve.is_camera(e)&&e.render&&e.render.move_style==t.MS_HOVER_CONTROLS}function Fe(e,t){t.enable_csm?Ge(e,t):e.pcf_blur_radii[0]=t.first_cascade_blur_radius}function Ge(e,t){var _=t.csm_num;e.csm_centers||ke(e,t);for(var r=0;r<_;r++){var a=0==r?e.near:Be(t,e,r-1),n=Be(t,e,r),i=Ue(e,a,n,vt),s=o.H(i);e.csm_centers[r].set(s.center),e.csm_radii[r]=s.radius,e.csm_center_dists[r]=S.length(s.center);var E=t.first_cascade_blur_radius,c=t.last_cascade_blur_radius;e.pcf_blur_radii[r]=Xe(E,c,_,r)}}function ke(e,t){var _=t.csm_num;e.csm_centers=new Array(_);for(var r=0;r<_;r++)e.csm_centers[r]=new Float32Array(3);e.csm_radii=new Float32Array(_)}function Ke(e,t){if(e.csm_centers){var _=e.csm_centers.length;t.csm_centers=new Array(_);for(var r=0;r<_;r++)t.csm_centers[r]=S.clone(e.csm_centers[r]);t.csm_radii=new Float32Array(e.csm_radii)}}function Be(e,t,_){var r=e.csm_num,a=A.M(e.csm_first_cascade_border,t.near,t.far),n=A.M(e.csm_last_cascade_border,t.near,t.far),o=Xe(a,n,r,_);return A.M(o,t.near,t.far)}function Xe(e,t,_,r){switch(r){case 0:var a=e;break;case _-1:var a=t;break;default:var a=0==e?0:e*Math.pow(t/e,r/(_-1))}return a}function He(e){switch(e.type){case t.TYPE_ORTHO:case t.TYPE_ORTHO_ASPECT:case t.TYPE_ORTHO_ASYMMETRIC:return!0;default:return!1}}function je(e,t){t||(t=new Float32Array(3));var _=P.j(e.render.world_tsr);return S.copy(_,t),t}var Qe=Object(n.a)(e),ze=Object(i.a)(e),Ve=Object(c.a)(e),qe=Object(l.a)(e),We=Object(d.a)(e),Je=Object(u.a)(e),Ze=Object(f.a)(e);t.TYPE_NONE=10,t.TYPE_PERSP=20,t.TYPE_ORTHO=30,t.TYPE_PERSP_ASPECT=40,t.TYPE_ORTHO_ASPECT=50,t.TYPE_ORTHO_ASYMMETRIC=60,t.TYPE_STEREO_LEFT=70,t.TYPE_STEREO_RIGHT=80,t.TYPE_HMD_LEFT=90,t.TYPE_HMD_RIGHT=100,t.MS_STATIC=0,t.MS_TARGET_CONTROLS=2,t.MS_EYE_CONTROLS=3,t.MS_HOVER_CONTROLS=4;var $e=2.5,et=A.T(40),tt=.1,_t=1e3,rt=A.T(.5),at=new Float32Array([1,1,1,1]),nt=new Float32Array([-1,-1,1,1]),ot=new Float32Array([0,0,-1,1]),it=new Float32Array(2),st=new Float32Array(2),Et=new Float32Array(2),ct=new Float32Array(3),lt=new Float32Array(3),Tt=new Float32Array(3),dt=new Float32Array(3),ut=new Float32Array(3),ft=new Float32Array(3),Pt=new Float32Array(4),At=new Float32Array(4),St=new Float32Array(4),pt=new Float32Array(4),Ot=new Float32Array(16),vt=new Float32Array(24),mt=new Float32Array(6);t.camera_object_to_camera=function(e,n){var o=n.render,i=e.data;switch(i.type){case"PERSP":var s=y(t.TYPE_PERSP);s.fit=i.sensor_fit;G(s,i.angle,i.clip_start,i.clip_end);break;case"ORTHO":var s=y(t.TYPE_ORTHO);s.fit=i.sensor_fit;G(s,i.ortho_scale/2,i.clip_start,i.clip_end)}s.name=n.name;var E=n.scenes_data;E[0].cameras.push(s);for(var c=1;c<E.length;c++){var l=Y(s,!1);E[c].cameras.push(l)}o.move_style=x(i.b4w_move_style),o.dof_distance=i.dof_distance;var T=i.dof_object;o.dof_object=T?T._object:null,o.dof_front_start=i.b4w_dof_front_start,o.dof_front_end=i.b4w_dof_front_end,o.dof_rear_start=i.b4w_dof_rear_start,o.dof_rear_end=i.b4w_dof_rear_end,o.dof_power=i.b4w_dof_power,o.dof_bokeh=i.b4w_dof_bokeh,o.dof_bokeh_intensity=i.b4w_dof_bokeh_intensity,o.dof_foreground_blur=i.b4w_dof_foreground_blur,o.velocity_trans=i.b4w_trans_velocity,o.velocity_rot=i.b4w_rot_velocity,o.velocity_zoom=i.b4w_zoom_velocity;var d=_(e,n),u=r(e,n),f=a(e,n),A=O(e,n),S=v(e,n),p=m(e,n);switch(o.move_style){case t.MS_STATIC:break;case t.MS_EYE_CONTROLS:var h=P.j(n.render.world_tsr);N(n,h,null,d,u);break;case t.MS_TARGET_CONTROLS:var h=P.j(n.render.world_tsr);g(n,h,i.b4w_target,d,u,f,p,i.b4w_use_panning);break;case t.MS_HOVER_CONTROLS:var h=P.j(n.render.world_tsr);R(n,h,I(n,e.data.b4w_hover_zero_level,lt),f,u,A,S,i.b4w_enable_hover_hor_rotation)}Ee(n),b(n)},t.setup_eye_model=N,t.setup_target_model=g,t.setup_hover_model=R,t.init_ortho_props=b,t.clone_camera=Y,t.create_frustum_planes=L,t.move_style_bpy_to_b4w=x,t.create_camera=y,t.check_attachment=function(e,t){switch(t){case"COLOR":case"CUBEMAP":return Boolean(e.color_attachment);case"DEPTH":return Boolean(e.depth_attachment);case"SCREEN":return!Boolean(e.color_attachment)&&!Boolean(e.depth_attachment);default:Qe.panic("Wrong attachment type: "+t)}},t.set_attachment=function(e,t,_){switch(t){case"COLOR":case"CUBEMAP":e.color_attachment=_;break;case"DEPTH":e.depth_attachment=_;break;case"SCREEN":e.color_attachment=null,e.depth_attachment=null;break;default:Qe.panic("Wrong attachment type: "+t)}},t.get_attachment=function(e,t){switch(t){case"COLOR":case"CUBEMAP":return e.color_attachment;case"DEPTH":return e.depth_attachment;case"SCREEN":return null;default:Qe.panic("Wrong attachment type: "+t)}},t.make_stereo=function(e,_){(e.type!=t.TYPE_PERSP||_!=t.TYPE_STEREO_LEFT&&_!=t.TYPE_STEREO_RIGHT&&_!=t.TYPE_HMD_LEFT&&_!=t.TYPE_HMD_RIGHT)&&Qe.panic("make_stereo(): wrong camera type"),e.type=_,U(e,6,.065)},t.set_stereo_params=U,t.get_camera_angles=w,t.get_camera_angles_from_quat=C,t.get_camera_angles_char=function(e,t){return w(e,t),t[0]=A.A(t[0]+Math.PI),t[1]*=-1,t},t.set_fov=function(e,_){switch(e.type){case t.TYPE_PERSP:case t.TYPE_PERSP_ASPECT:case t.TYPE_STEREO_LEFT:case t.TYPE_STEREO_RIGHT:e.fov=_}},t.get_fov=function(e){switch(e.type){case t.TYPE_PERSP:case t.TYPE_PERSP_ASPECT:case t.TYPE_STEREO_LEFT:case t.TYPE_STEREO_RIGHT:return e.fov;default:return 0}},t.get_vfov=D,t.set_frustum=G,t.set_frustum2=function(e,_,r,a,n){switch(e.type){case t.TYPE_PERSP:case t.TYPE_STEREO_LEFT:case t.TYPE_STEREO_RIGHT:case t.TYPE_ORTHO:e.fov=r,e.aspect=1;break;case t.TYPE_PERSP_ASPECT:case t.TYPE_ORTHO_ASPECT:e.fov=r,e.aspect=_/r;break;case t.TYPE_HMD_LEFT:case t.TYPE_HMD_RIGHT:break;default:Qe.panic("set_frustum2(): Unsupported camera type: "+e.type)}e.near=a,e.far=n},t.set_frustum_asymmetric=k,t.get_move_style=K,t.set_view=B,t.set_projection_reflect=j,t.set_view_trans_quat=function(e,t,_){var r=ct;r[0]=0,r[1]=0,r[2]=-1,S.transformQuat(r,_,r),r[0]+=t[0],r[1]+=t[1],r[2]+=t[2];var a=lt;a[0]=0,a[1]=1,a[2]=0,S.transformQuat(a,_,a),Q(e,t,r,a)},t.set_look_at=z,t.set_look_at_corrected=V,t.update_camera_transform=q,t.update_camera=function(e){var _=e.render;switch(Ee(e),se(e),_.move_style){case t.MS_TARGET_CONTROLS:var r=P.j(_.world_tsr),a=P.g(_.world_tsr);A._30(r,a,_.pivot,A.c);for(var n=0;n<e.scenes_data.length;n++)for(var o=e.scenes_data[n].cameras,i=0;i<o.length;i++){var s=o[i];s.type!=t.TYPE_STEREO_LEFT&&s.type!=t.TYPE_STEREO_RIGHT||U(s,S.dist(r,_.pivot),s.stereo_eye_dist)}W(e,_.vertical_axis);break;case t.MS_EYE_CONTROLS:e.constraint||W(e,_.vertical_axis)}},t.correct_up=W,t.set_horizontal_rot_limits=Z,t.set_vertical_rot_limits=ee,t.hover_set_vertical_limits=te,t.hover_set_distance_limits=re,t.set_distance_limits=ae,t.set_pivot_limits=ne,t.set_hor_trans_limits=oe,t.set_vert_trans_limits=ie,t.update_ortho_scale=se,t.rotate_target_angles=le,t.set_rotation_target_angles=Te,t.rotate_eye_angles=de,t.set_rotation_eye_angles=ue,t.rotate_static_angles=fe,t.set_rotation_static_angles=Pe,t.rotate_hover_angles=Ae,t.set_rotation_hover_angles=Se,t.rotate_angles=function(e,_,r){var a=e.render,n=a.move_style;n===t.MS_TARGET_CONTROLS?le(e,_,r):n===t.MS_EYE_CONTROLS?de(e,_,r):n===t.MS_HOVER_CONTROLS?Ae(e,_,r):n===t.MS_STATIC&&fe(e,_,r)},t.set_rotation_angles=function(e,_,r){var a=e.render,n=a.move_style;n===t.MS_TARGET_CONTROLS?Te(e,_,r):n===t.MS_EYE_CONTROLS?ue(e,_,r):n===t.MS_HOVER_CONTROLS?Se(e,_,r):n===t.MS_STATIC&&Pe(e,_,r)},t.is_float_aspect=function(e){switch(e.type){case t.TYPE_PERSP:case t.TYPE_ORTHO:case t.TYPE_STEREO_LEFT:case t.TYPE_STEREO_RIGHT:return!0;default:return!1}},t.get_angular_diameter=function(e){switch(e.type){case t.TYPE_PERSP:case t.TYPE_PERSP_ASPECT:case t.TYPE_STEREO_LEFT:case t.TYPE_STEREO_RIGHT:var _=D(e),r=F(e);return Math.min(_,r);default:return qe.error("get_angular_diameter(): Unsupported camera type: "+e.type),0}},t.set_aspect=Ie,t.get_aspect=function(e){return e.aspect},t.set_projection=be,t.set_color_pick_proj=function(e,_,r,a,n){var o=1/Math.max(n,a);switch(e.type){case t.TYPE_NONE:case t.TYPE_PERSP:case t.TYPE_PERSP_ASPECT:var i=n/2,E=a/2;r=-(r-i)/i*Math.tan(D(e)/2),_=(_-E)/E*Math.tan(D(e)/2)*e.aspect;var c=e.near*(r+o),l=e.near*(_+o),T=e.near*(r-o),d=e.near*(_-o);s.frustum(d,l,T,c,e.near,e.far,e.proj_matrix);break;case t.TYPE_ORTHO:case t.TYPE_ORTHO_ASPECT:r=-r/n,_/=a;var c=D(e),l=c*e.aspect,d=(_-o)*(l+l)-l;l=(_+o)*(l+l)-l;var T=c+(r-o)*(c+c);c+=(r+o)*(c+c),s.ortho(d,l,T,c,e.near,e.far,e.proj_matrix);break;case t.TYPE_ORTHO_ASYMMETRIC:r=-r/n,_/=a;var c=e.top+(r+o)*(e.top-e.bottom),l=e.left+(_+o)*(e.right-e.left),T=e.top+(r-o)*(e.top-e.bottom),d=e.left+(_-o)*(e.right-e.left);s.ortho(d,l,T,c,e.near,e.far,e.proj_matrix)}Le(e),Me(e)},t.calc_sky_vp_inverse=ye,t.extract_frustum_corners=Ue,t.assign_boundings=function(e){var t=e.render,_=o.w();_.min_x=-1,_.max_x=1,_.min_y=-1,_.max_y=1,_.min_z=-1,_.max_z=1,t.bb_local=_;var r=o.l(1,A._1([0,0,0]));t.bs_local=r,t.bcap_local=o.b(1,_),t.bcyl_local=o.d(1,_),t.bcon_local=o.c(1,_)},t.is_static_camera=we,t.is_target_camera=Ce,t.is_eye_camera=function(e){return Ve.is_camera(e)&&e.render&&e.render.move_style==t.MS_EYE_CONTROLS},t.is_hover_camera=De,t.is_ortho_camera=function(e){return Ve.is_camera(e)&&e.render&&e.scenes_data[0].cameras[0].type==t.TYPE_ORTHO},t.update_camera_shadows=Fe,t.csm_far_plane=Be,t.project_point=function(e,_,r){var a=e.scenes_data[0].cameras[0];switch(a.type){case t.TYPE_PERSP:case t.TYPE_PERSP_ASPECT:case t.TYPE_ORTHO:case t.TYPE_ORTHO_ASPECT:case t.TYPE_STEREO_LEFT:case t.TYPE_STEREO_RIGHT:case t.TYPE_HMD_LEFT:case t.TYPE_HMD_RIGHT:case t.TYPE_NONE:var n=St;n.set(_),n[3]=1;var o=a.view_proj_matrix;p.transformMat4(n,o,n);var i=n[0]/n[3],s=-n[1]/n[3];return r[0]=(i+1)/2*a.width,r[1]=(s+1)/2*a.height,ze.viewport_to_canvas_coords(r[0],r[1],r,a),r.length>2&&(r[2]=(n[2]/Math.abs(n[3])+1)/2),r;default:return qe.error("Non-compatible camera"),r}},t.get_first_cam=function(e){return e.scenes_data[0].cameras[0]},t.get_edge=function(e,_){switch(e.type){case t.TYPE_PERSP:case t.TYPE_PERSP_ASPECT:case t.TYPE_STEREO_LEFT:case t.TYPE_STEREO_RIGHT:var r=Math.tan(D(e)/2);switch(_){case"LEFT":return-r*e.aspect;case"RIGHT":return r*e.aspect;case"TOP":return r;case"BOTTOM":return-r}break;case t.TYPE_ORTHO:case t.TYPE_ORTHO_ASPECT:switch(_){case"LEFT":return-D(e)*e.aspect;case"RIGHT":return D(e)*e.aspect;case"TOP":return D(e);case"BOTTOM":return-D(e)}break;case t.TYPE_ORTHO_ASYMMETRIC:switch(_){case"LEFT":return e.left;case"RIGHT":return e.right;case"TOP":return e.top;case"BOTTOM":return e.bottom}break;case t.TYPE_HMD_LEFT:case t.TYPE_HMD_RIGHT:var a=We.get_active(),n=We.get_subs(a,Je.STEREO);if(n&&n.enable_hmd_stereo)switch(_){case"LEFT":return-Math.tan(Math.min(e.hmd_fov[1],e.hmd_fov[3]));case"RIGHT":return Math.tan(Math.min(e.hmd_fov[1],e.hmd_fov[3]));case"TOP":return Math.tan(Math.min(e.hmd_fov[0],e.hmd_fov[2]));case"BOTTOM":return-Math.tan(Math.min(e.hmd_fov[0],e.hmd_fov[2]))}else{var r=Math.tan(D(e)/2);switch(_){case"LEFT":return-r*e.aspect;case"RIGHT":return r*e.aspect;case"TOP":return r;case"BOTTOM":return-r}}break;default:Qe.panic("Unknown camera type")}},t.is_ortho=He,t.set_trans_pivot=function(e,t,_){var r=e.render;P.t(t,r.world_tsr),S.copy(_,r.pivot)},t.set_hover_pivot=function(e,t){var _=e.render,r=S.subtract(t,_.hover_pivot,ct),a=P.j(_.world_tsr),n=S.add(r,a,r);Ze.set_translation(e,n),S.copy(t,_.hover_pivot)},t.set_target_pivot=function(e,t){var _=e.render,r=S.subtract(t,_.pivot,ct),a=P.j(_.world_tsr),n=S.add(r,a,r);Ze.set_translation(e,n),S.copy(t,_.pivot)},t.get_eye=je,t.set_move_style=function(e,_){switch(e.render.move_style=_,e.render.horizontal_limits=null,e.render.vertical_limits=null,e.render.distance_limits=null,e.render.hover_horiz_trans_limits=null,e.render.hover_vert_trans_limits=null,b(e),_){case t.MS_STATIC:case t.MS_EYE_CONTROLS:break;case t.MS_HOVER_CONTROLS:var r=P.j(e.render.world_tsr),a=I(e,0,lt);R(e,r,a,null,null,null,null,e.render.enable_hover_hor_rotation);break;case t.MS_TARGET_CONTROLS:var n=je(e,ct),o=P.g(e.render.world_tsr),i=A._33(o,A.c,lt),a=S.scaleAndAdd(n,i,10,i);S.copy(a,e.render.pivot)}},t.wipe_move_style=function(e){var t=e.render;t.move_style=0,S.set(0,0,0,t.pivot),S.set(0,0,0,t.hover_pivot),t.use_panning=!1,t.horizontal_limits=null,t.vertical_limits=null,t.distance_limits=null,t.hover_horiz_trans_limits=null,t.hover_vert_trans_limits=null,t.pivot_limits=null,t.enable_hover_hor_rotation=!0},t.set_eye_distance=function(e,t){for(var _=0;_<e.length;_++){var r=e[_];70!=r.type&&80!=r.type&&90!=r.type&&100!=r.type||U(r,r.stereo_conv_dist,t)}},t.set_hmd_fov=function(e,t,_){for(var r=We.get_active(),a=Ve.get_scene_data(e,r),n=a.cameras,o=0;o<n.length;o++){var i=n[o];90!=i.type&&100!=i.type||(90==i.type&&p.copy(t,i.hmd_fov),100==i.type&&p.copy(_,i.hmd_fov),i.reflection_plane?j(i,!1):be(i,!1))}},t.set_hmd_proj_mat=function(e,t,_){for(var r=We.get_active(),a=Ve.get_scene_data(e,r),n=a.cameras,o=0;o<n.length;o++){var i=n[o];90!=i.type&&100!=i.type||(90==i.type&&t&&s.copy(t,i.proj_matrix),100==i.type&&_&&s.copy(_,i.proj_matrix),Le(i),Me(i))}},t.set_proj_mat=function(e,_){for(var r,a,n,o,i,E,c,l,T=We.get_active(),d=Ve.get_scene_data(e,T),u=d.cameras,f=0;f<u.length;f++){var P=u[f];if(P.type==t.TYPE_NONE&&P.near||P.type==t.TYPE_PERSP||P.type==t.TYPE_PERSP_ASPECT){r=P.near,a=P.far;var A=s.invert(_,Ot),S=p.transformMat4(at,A,St);n=S[0]*r,o=S[1]*r;var O=p.transformMat4(nt,A,St);i=O[0]*r,E=O[1]*r;var v=p.transformMat4(ot,A,St);a=-v[2]*v[3],c=s.frustum(i,n,E,o,r,a,Ot),l=(n-i)/(o-E);break}}for(var f=0;f<u.length;f++){var P=u[f];P.type!=t.TYPE_NONE&&P.type!=t.TYPE_PERSP&&P.type!=t.TYPE_PERSP_ASPECT||(P.far=a,P.near=r,P.right=n,P.top=o,P.left=i,P.bottom=E,P.aspect=l,P.fov=Math.atan(o/r)-Math.atan(E/r),s.copy(c,P.proj_matrix),Le(P),Me(P))}}}var a=_(0),n=_(5),o=_(25),i=_(15),s=_(21),E=_(41),c=_(8),l=_(1),T=_(9),d=_(10),u=_(11),f=_(13),P=_(6),A=_(2),S=_(3),p=_(7),O=Object(a.a)("__camera",r);t.a=O},function(e,t,_){"use strict";function r(e,t){function _(){return x}function r(){return y}function a(){return U}function d(e,t){D.offset_left=e,D.offset_top=t}function u(){var e=x.getBoundingClientRect();d(e.left,e.top)}function f(e,t,_){D.width=e,D.height=t,D.scale=_,u()}function P(e,t,_){if(e.constructor==MouseEvent)_[0]=e.offsetX,_[1]=e.offsetY;else if(e.constructor==TouchEvent){if("touchend"==e.type)var r=e.changedTouches;else var r=t?e.targetTouches:e.touches;A(r[0].clientX,r[0].clientY,e.target,_)}else _[0]=-1,_[1]=-1;return _}function A(e,t,_,r){if(Y.ie11_edge_mouseoffset_hack){var a=_.getBoundingClientRect();r[0]=e-a.left,r[1]=t-a.top}else{w.clientX=e,w.clientY=t,w.view=window;var n=new MouseEvent("b4w_convert",w);_.dispatchEvent(n),r[0]=n.offsetX,r[1]=n.offsetY}return r}function S(){return!!(Y.allow_hidpi&&window.devicePixelRatio>=2)}function p(e,t,_,r){e.style.width=_+"px",e.style.height=r+"px",t&&(t.style.width=_+"px",t.style.height=r+"px")}function O(e,t,a){var n=_(),o=r();a&&p(n,o,e,t),o&&(o.width=e,o.height=t,g.update_dim());var i=Math.floor(e*Y.canvas_resolution_factor),s=Math.floor(t*Y.canvas_resolution_factor);n.width=i,n.height=s;var E=Math.min(M.drawingBufferWidth,L.max_renderbuffer_size,L.max_viewport_dims[0]),c=Math.min(M.drawingBufferHeight,L.max_renderbuffer_size,L.max_viewport_dims[1]);if(i>E||s>c){R.warn("Canvas size exceeds platform limits, downscaling");var l=Math.min(E/i,E/s);i*=l,s*=l}if(e)var T=i/e;else var T=1;n.width=Math.floor(i),n.height=Math.floor(s),I.setup_dim(n.width,n.height,T),I.check_active()&&h.update_transform(I.get_active()._camera),N.update_media_controls(n.width,n.height)}var v=Object(n.a)(e),m=Object(o.a)(e),N=Object(i.a)(e),g=Object(s.a)(e),R=Object(E.a)(e),I=Object(c.a)(e),b=Object(l.a)(e),h=Object(T.a)(e),Y=m.defaults,L=m.context_limits,M=null,x=null,y=null,U=null,w={clientX:0,clientY:0},C=!1,D={width:0,height:0,scale:1,offset_top:0,offset_left:0};t.setup_context=function(e){M=e},t.get_canvas=_,t.get_canvas_hud=r,t.get_container=a,t.init=function(e,t){e&&e.parentNode?(x=e,y=t,U=e.parentNode):v.panic("canvas container is not available")},t.insert_to_container=function(e,t){switch(t=t||"LAST"){case"FIRST":var _=U.firstElementChild;U.insertBefore(e,_);break;case"JUST_BEFORE_CANVAS":U.insertBefore(e,x);break;case"JUST_AFTER_CANVAS":x.nextElementSibling?U.insertBefore(e,x.nextElementSibling):U.appendChild(e,x);break;case"LAST":U.appendChild(e,x);break;default:R.error(t+" invalid stack order")}},t.get_viewport_width=function(){return D.width},t.get_viewport_height=function(){return D.height},t.set_canvas_offsets=d,t.update_canvas_offsets=u,t.setup_viewport_dim=f,t.force_offsets_updating=function(){C=!0},t.client_to_canvas_coords=function(e,t,_){return A(e,t,x,_)},t.get_coords_target_space=P,t.client_to_element_coords=A,t.canvas_to_viewport_coords=function(e,t,_,r){if(_||(_=new Float32Array(2)),_[0]=e*D.scale,_[1]=t*D.scale,r){var a=r.width/D.width;_[0]*=a,_[1]*=a}return _},t.viewport_to_canvas_coords=function(e,t,_,r){if(_||(_=new Float32Array(2)),_[0]=e/D.scale,_[1]=t/D.scale,r){var a=r.width/D.width;_[0]/=a,_[1]/=a}return _},t.is_child=function(e){return!(!e||!e.parentNode)&&(e.parentNode==U||t.is_child(e.parentNode))},t.is_hidpi=S,t.resize=O,t.resize_to_container=function(e){var t=a(),n=_(),o=t.clientWidth,i=t.clientHeight;if(e||o!=n.clientWidth||i!=n.clientHeight){var s=n.width,E=n.height;if(p(_(),r(),o,i),I.check_active()){var c=I.get_active(),l=I.get_subs(c,b.STEREO);if(l&&l.enable_hmd_stereo)return void O(s,E,!1)}O(o,i,!1)}},t.reset=function(){M=null,x=null,y=null,U=null}}var a=_(0),n=_(5),o=_(4),i=_(42),s=_(51),E=_(1),c=_(10),l=_(11),T=_(13),d=(_(2),Object(a.a)("__container",r));t.a=d},function(e,t,_){"use strict";function r(e,t){function _(e){return wt[e]||null}function r(e,t){wt[e]=t}function a(e){var t={type:e,subtype:"",id:0,data_id:0,cluster_id:-1,odd_id_prop:"",debug_id_color:-1,debug_main_batch_id:-1,debug_main_batch_render_time:0,debug_render_time:0,debug_render_time_queries:[],textures:[],texture_names:[],bpy_tex_names:[],material_names:[],common_attributes:[],uv_maps_usage:null,vertex_colors_usage:{},shader:null,shaders_info:dt.init_shaders_info(),ngraph_proxy_id:"",attribute_setters:[],bufs_data:null,vaos:I.S(),use_shape_keys:!1,debug_sphere:!1,debug_sphere_dynamic:!1,num_vertices:0,num_triangles:0,jitter_amp:0,jitter_freq:0,dynamic_grass:!1,grass_scale_threshold:0,grass_size:0,grass_map_dim:new Float32Array(3),cube_fog:new Float32Array(16),alpha_clip:!1,alpha_antialiasing:!1,blend:!1,depth_mask:!1,xray:!1,use_backface_culling:!1,use_shadeless:!1,dynamic_geometry:!1,shadow_cast:!1,shadow_cast_only:!1,shadow_receive:!1,reflexible:!1,reflexible_only:!1,reflective:!1,draw_mode:Pt.DM_DEFAULT,z_sort:!1,forked_batch:!1,do_not_cull:!1,caustics:!1,lod_dist_max:it.LOD_DIST_MAX_INFINITY,lod_dist_min:0,lod_lower_border_range:0,lod_upper_border_range:0,lod_settings:L(),cube_reflection_id:-1,plane_reflection_id:-1,halo:!1,halo_size:0,halo_hardness:0,halo_stars_blend:0,halo_stars_height:0,halo_rings_color:new Float32Array(3),halo_lines_color:new Float32Array(3),halo_particles:!1,ambient:0,emit:0,diffuse_intensity:1,reflect_factor:0,specular_color_factor:0,specular_alpha:1,parallax_scale:0,diffuse_color_factor:0,alpha_factor:1,normal_factor:0,mirror_factor:0,offset_z:0,refr_bump:0,diffuse_params:new Float32Array(2),specular_params:new Float32Array(3),texture_scale:new Float32Array(3),specular_color:new Float32Array(3),diffuse_color:new Float32Array(4),fresnel_params:new Float32Array(2),lamp_uuid_indexes:null,lamp_light_positions:null,lamp_light_directions:null,lamp_light_color_intensities:null,has_nodes:!1,wireframe_edge_color:b.create(),water:!1,water_dynamic:!1,water_shore_smoothing:!1,water_generated_mesh:!1,water_num_cascads:0,water_subdivs:0,water_detailed_dist:0,water_norm_uv_velocity:.1,shallow_water_col_fac:0,shore_water_col_fac:0,foam_factor:0,foam_uv_freq:new Float32Array(2),foam_mag:new Float32Array(2),foam_scale:new Float32Array(2),shallow_water_col:new Float32Array(3),shore_water_col:new Float32Array(3),normalmap_scales:null,refractive:!1,is_sky:!1,draw_proc_sky:!1,particles_data:null,line_width:0,anchor_positions:null,part_node_data:null,node_values:[],node_value_inds:[],node_rgbs:[],node_rgb_inds:[],bounds_local:o.L(),use_be:!1,submesh:null,cleanup_gl_data_on_unload:!0,inst_array_state:0,obj_info_params:new Float32Array(3),lights:[]};return t.diffuse_color[3]=1,t.depth_mask=!0,t.line_width=1,t.lod_settings.hyst_prev_state=-1,t}function Y(e){var t=a(e.type);return t.subtype=e.subtype,t.id=e.id,t.cluster_id=e.cluster_id,t.odd_id_prop=e.odd_id_prop,t.debug_id_color=e.debug_id_color,t.debug_main_batch_id=e.debug_main_batch_id,t.debug_main_batch_render_time=e.debug_main_batch_render_time,t.debug_render_time=e.debug_render_time,t.debug_render_time_queries=[],t.textures=e.textures.slice(),t.texture_names=e.texture_names.slice(),t.bpy_tex_names=e.bpy_tex_names.slice(),t.material_names=e.material_names.slice(),t.common_attributes=e.common_attributes.slice(),t.uv_maps_usage=I.O(e.uv_maps_usage),t.vertex_colors_usage=I.O(e.vertex_colors_usage),t.shader=e.shader,t.shaders_info=dt.clone_shaders_info(e.shaders_info),t.ngraph_proxy_id=e.ngraph_proxy_id,t.attribute_setters=ct.clone_attribute_setters(e.attribute_setters),t.bufs_data=e.bufs_data,t.use_shape_keys=e.use_shape_keys,t.debug_sphere=e.debug_sphere,t.debug_sphere_dynamic=e.debug_sphere_dynamic,t.num_vertices=e.num_vertices,t.num_triangles=e.num_triangles,t.jitter_amp=e.jitter_amp,t.jitter_freq=e.jitter_freq,t.grass_scale_threshold=e.grass_scale_threshold,t.grass_size=e.grass_size,t.grass_map_dim=e.grass_map_dim,t.cube_fog=e.cube_fog,t.alpha_clip=e.alpha_clip,t.alpha_antialiasing=e.alpha_antialiasing,t.blend=e.blend,t.depth_mask=e.depth_mask,t.xray=e.xray,t.use_backface_culling=e.use_backface_culling,t.use_shadeless=e.use_shadeless,t.dynamic_geometry=e.dynamic_geometry,t.shadow_cast=e.shadow_cast,t.shadow_cast_only=e.shadow_cast_only,t.shadow_receive=e.shadow_receive,t.reflexible=e.reflexible,t.reflexible_only=e.reflexible_only,t.reflective=e.reflective,t.dynamic_grass=e.dynamic_grass,t.draw_mode=e.draw_mode,t.z_sort=e.z_sort,t.forked_batch=e.forked_batch,t.do_not_cull=e.do_not_cull,t.caustics=e.caustics,t.lod_dist_max=e.lod_dist_max,t.lod_dist_min=e.lod_dist_min,t.lod_lower_border_range=e.lod_lower_border_range,t.lod_upper_border_range=e.lod_upper_border_range,t.lod_settings=M(e.lod_settings),t.cube_reflection_id=e.cube_reflection_id,t.plane_reflection_id=e.plane_reflection_id,t.halo=e.halo,t.halo_size=e.halo_size,t.halo_hardness=e.halo_hardness,t.halo_stars_blend=e.halo_stars_blend,t.halo_stars_height=e.halo_stars_height,b.copy(e.halo_rings_color,t.halo_rings_color),b.copy(e.halo_lines_color,t.halo_lines_color),t.halo_particles=e.halo_particles,t.ambient=e.ambient,t.emit=e.emit,t.diffuse_intensity=e.diffuse_intensity,t.reflect_factor=e.reflect_factor,t.specular_color_factor=e.specular_color_factor,t.specular_alpha=e.specular_alpha,t.parallax_scale=e.parallax_scale,t.diffuse_color_factor=e.diffuse_color_factor,t.alpha_factor=e.alpha_factor,t.normal_factor=e.normal_factor,t.mirror_factor=e.mirror_factor,t.offset_z=e.offset_z,t.refr_bump=e.refr_bump,t.diffuse_params[0]=e.diffuse_params[0],t.diffuse_params[1]=e.diffuse_params[1],b.copy(e.specular_params,t.specular_params),b.copy(e.texture_scale,t.texture_scale),b.copy(e.specular_color,t.specular_color),h.copy(e.diffuse_color,t.diffuse_color),t.fresnel_params.set(e.fresnel_params),t.lamp_uuid_indexes=I.O(e.lamp_uuid_indexes),e.lamp_light_positions&&(t.lamp_light_positions=new Float32Array(e.lamp_light_positions),t.lamp_light_directions=new Float32Array(e.lamp_light_directions),t.lamp_light_color_intensities=new Float32Array(e.lamp_light_color_intensities)),t.has_nodes=e.has_nodes,b.copy(e.wireframe_edge_color,t.wireframe_edge_color),t.water=e.water,t.water_dynamic=e.water_dynamic,t.water_shore_smoothing=e.water_shore_smoothing,t.water_generated_mesh=e.water_generated_mesh,t.water_num_cascads=e.water_num_cascads,t.water_subdivs=e.water_subdivs,t.water_detailed_dist=e.water_detailed_dist,t.water_norm_uv_velocity=e.water_norm_uv_velocity,t.shallow_water_col_fac=e.shallow_water_col_fac,t.shore_water_col_fac=e.shore_water_col_fac,t.foam_factor=e.foam_factor,t.foam_uv_freq.set(e.foam_uv_freq),t.foam_mag.set(e.foam_mag),t.foam_scale.set(e.foam_scale),b.copy(e.shallow_water_col,t.shallow_water_col),b.copy(e.shore_water_col,t.shore_water_col),t.normalmap_scales=I.O(e.normalmap_scales),t.refractive=e.refractive,t.is_sky=e.is_sky,t.draw_proc_sky=e.draw_proc_sky,e.particles_data&&(t.particles_data=st.clone_particles_data(e.particles_data)),t.line_width=e.line_width,e.anchor_positions&&(t.anchor_positions=new Float32Array(e.anchor_positions)),t.part_node_data=I.O(e.part_node_data),t.node_values=e.node_values.slice(),t.node_value_inds=e.node_value_inds.slice(),t.node_rgbs=e.node_rgbs.slice(),t.node_rgb_inds=e.node_rgb_inds.slice(),o.t(e.bounds_local,t.bounds_local),t.use_be=e.use_be,t.cleanup_gl_data_on_unload=e.cleanup_gl_data_on_unload,t.obj_info_params=e.obj_info_params,t.lights=e.lights,t}function L(){var e={use_smoothing:!1,coverage:0,cmp_logic:0,dest_coverage:0,hyst_prev_state:0,hyst_interval_min:0,hyst_interval_max:0,prev_dist:0};return e.cmp_logic=1,e}function M(e){var t=L();return t.use_smoothing=e.use_smoothing,t.coverage=e.coverage,t.cmp_logic=e.cmp_logic,t.dest_coverage=e.dest_coverage,t.hyst_prev_state=e.hyst_prev_state,t.hyst_interval_min=e.hyst_interval_min,t.hyst_interval_max=e.hyst_interval_max,t.prev_dist=e.prev_dist,t}function x(e){switch(e.type){case"MAIN":case"PARTICLES":case"LINE":e.blend?e.xray?e.subtype="XRAY":e.subtype="BLEND":e.subtype="OPAQUE";break;case"SHADOW":e.shadow_cast_only?e.subtype="CAST":e.subtype="RECEIVE";break;case"COLOR_ID":e.xray?e.subtype="COLOR_ID_XRAY":e.subtype="COLOR_ID"}}function y(e,t,_){for(var r=[],a=0;a<e.length;a++){var n=e[a],o=n._object,i=o.render;o.is_hair_dupli||r.push.apply(r,U(n,i,t,_))}return r}function U(e,t,_,r){var n=[],o=e._object,i=Q(_,t,!t.do_not_render,!1),s=e.data,E=o.materials,c=new Array(E.length),l=new Array(E.length),T=[],d=lt.find_subs(_,ut.MAIN_OPAQUE),u=!1;d&&(u=!!d.light_positions.length);for(var f=0;f<i.length;f++)for(var P=i[f],A=0;A<E.length;A++){var S=E[A];if(!$e(o,A)&&!Pt.has_empty_submesh(s,A))if("PHYSICS"==P&&e.b4w_collision&&"NAVMESH"==e.game.physics_type)T.push(Pt.extract_submesh(s,A,[],t.bone_skinning_info,{},null));else if(!S.is_lens_flares||u){var p=a(P);p.lights=I.O(r),"MAIN"==P?c[A]=p:"DEBUG_VIEW"==P&&(l[A]=p),p.cluster_id=e.b4w_cluster_data.cluster_id;var O=he(p,S);if(O){var v=z(p,S,s);if(v){"SHADOW"==P&&c[A]&&(p.use_shadeless=c[A].use_shadeless),p.draw_mode=t.use_shape_keys||t.dynamic_geometry?Pt.DM_DYNAMIC_TRIANGLES:Pt.DM_DEFAULT,Ae(p,t),Oe(p,e.particle_systems),"DYNAMIC"!=t.type&&"COLOR_ID"!=p.type||(p.odd_id_prop=Ze(p,t,e.uuid)),p.do_not_cull=e.b4w_do_not_cull,"MAIN"==p.type&&(p.caustics=e.b4w_caustics);var m="COLOR_ID"!=P&&"SHADOW"!=P&&e.b4w_disable_fogging;me(p,"DISABLE_FOG",0|m);var N=Pt.extract_submesh(s,A,p.common_attributes,t.bone_skinning_info,p.vertex_colors_usage,p.uv_maps_usage);!S.use_tangent_shading||"a_shade_tangs"in N.va_frames[0]||(me(p,"CALC_TBN",1),ve(p,"a_tbn")),S.is_lens_flares&&(N=w(N)),Ge(p),n.push({batch:p,obj_render:t,batch_render:t,submesh:N,mat_names:[S.name],rel_bpy_objects:[e]})}}}}if(T.length){var p=a("PHYSICS");p.subtype="NAVMESH",p.odd_id_prop=Ze(p,t,e.uuid);for(var N=Pt.submesh_list_join(T),g=[],f=0;f<E.length;f++)g.push(E[f].name);Ge(p),n.push({batch:p,obj_render:t,batch_render:t,submesh:N,mat_names:g,rel_bpy_objects:[e]})}for(var f=0;f<l.length;f++)l[f]&&(l[f].debug_main_batch_id=c[f].id,Ge(l[f]));var R=e.particle_systems;if(R.length>0){for(var b=!1,h=!1,f=0;f<R.length;f++){var Y=R[f],L=Y.settings;if(L.use_render_emitter&&n.length&&(b=!0),"HAIR"!=L.type||"OBJECT"!=L.render_type&&"GROUP"!=L.render_type&&Y.transforms.length||(h=!0),b&&h)break}if(n.length)var M=n[0];else var M=C(s,t,R);var x=M.batch.vertex_colors_usage;if(h)if(E.length>1)var y=D(s,R,x,e._object.render);else var y=M.submesh;else var y=null;var U=F(e,t,_,x,y,r);b?n.push.apply(n,U):n=U}return n}function w(e){for(var t=e.base_length,_=e.va_frames[0].a_position,r=[],a=[],n=0;n<t;n++)a.push(_[3*n]),r.push(_[3*n+1]),a.push(_[3*n+2]);return r=new Float32Array(r),a=new Float32Array(a),e.va_common.a_lf_dist=r,e.va_common.a_lf_bb_vertex=a,e}function C(e,t,_){var r=a("TMP");return Oe(r,_),{batch:r,submesh:Pt.extract_submesh(e,0,r.common_attributes,t.bone_skinning_info,r.vertex_colors_usage,r.uv_maps_usage)}}function D(e,t,_,r){for(var a={},n=0;n<t.length;n++){var o=t[n].settings;if("HAIR"==o.type&&("OBJECT"==o.render_type||"GROUP"==o.render_type)){var i=o.b4w_vcol_from_name,s=o.b4w_vcol_to_name;""!==i&&""!==s&&(a[i]=I.O(_[i]))}}return"a_bending_col_main"in _&&(a.a_bending_col_main=I.O(_.a_bending_col_main)),"a_bending_col_detail"in _&&(a.a_bending_col_detail=I.O(_.a_bending_col_detail)),Pt.extract_submesh_all_mats(e,[],a)}function F(e,t,_,r,n,o){for(var i=e._object,s=[],E=e.particle_systems,c=e.data,l=0;l<E.length;l++){var T=E[l],d=T.settings;if(d.count)if("EMITTER"==d.type){if("DYNAMIC"==t.type){var u=a("PARTICLES");u.bounds_local.bb=t.bb_local,u.bounds_local.be=t.be_local,u.bounds_local.bs=t.bs_local,u.lights=I.O(o);var f=G(T,i.materials),P=i.materials[f];if($e(i,f))continue;"HALO"===T.settings.render_type&&"HALO"==P.type&&(u.halo_particles=!0);var A=z(u,P,c);if(!A)continue;Ie(u,T,i),u.dynamic_geometry=!0,u.do_not_cull=e.b4w_do_not_cull,u.odd_id_prop=Ze(u,t,i.name+"_"+d.uuid),st.create_particles_data(u,T,P);var S=st.generate_emitter_particles_submesh(u,c,T,i.render);st.update_particles_submesh(S,u,d.count),st.update_particles_objs_cache(i),Ae(u,i.render),Ge(u),s.push({batch:u,obj_render:t,batch_render:t,submesh:S,mat_names:[P.name],rel_bpy_objects:[e]})}}else if("HAIR"==d.type){var p=I._13(T.seed),O=-1!=I._69(At.loaded_data_version,Dt)&&!d.b4w_initial_rand_rotation&&!d.b4w_hair_billboard,v=4;if(O&&(v=8),T.transforms.length)var m=T.transforms;else for(var N=Pt.geometry_random_points(n,d.count,!1,p),m=new Float32Array(N.length*v),g=0;g<N.length;g++){var R=.75+.5*I._39(p);m[g*v]=N[g][0],m[g*v+1]=N[g][1],m[g*v+2]=N[g][2],m[g*v+3]=R,O&&(m[g*v+4]=1,m[g*v+5]=0,m[g*v+6]=0,m[g*v+7]=0)}var b=!!lt.find_subs(_,ut.GRASS_MAP);if("OBJECT"==d.render_type){var h=[Q(_,d.dupli_object._object.render,!t.do_not_render,!0)],Y=be(e,t,r,n,[d.dupli_object],h,[m],d,T,b,p,!1,o);s.push.apply(s,Y)}else if("GROUP"==d.render_type){for(var L=d.dupli_group.objects,h=[],g=0;g<L.length;g++){var M=Q(_,L[g]._object.render,!t.do_not_render,!0);h.push(M)}for(var x=!1,y=[],g=0;g<L.length;g++)y.push(L[g]._object);if(d.use_whole_group){var U=De(m,y,O,v);x=!0}else if(d.use_group_count)var U=Fe(m,y,d.dupli_weights,p,O,v);else var U=Ce(m,y,p,O,v);var Y=be(e,t,r,n,L,h,U,d,T,b,p,x,o);s.push.apply(s,Y)}"INSTANCE"==d.b4w_wind_bend_inheritance&&i.render.wind_bending&&rt.warn('Emitter object "'+i.name+"\" has a particle system with wind bending inheritance from the particle instance. Wind bending on the emitter isn't disabled. Expect unforeseen behavior.")}else et.panic("Unknown particle settings type")}return s}function G(e,t){var _=e.settings.material-1;return _>=t.length&&(rt.warn('Wrong material used for rendering particle system "'+e.name+'"'),_=0),_}function k(e){for(var t=[],_=[],r={},a=0;a<e.length;a++){var n=e[a].batch,i=null;if(n.id in r){var s=r[n.id],E=_[s].batch;if(ke(n,function(e){ke(E,function(t){I._58(e,t)&&e.inst_array_state!=bt&&(i=_[s])})}),!i)do{n.id++}while(r[n.id])}if(i&&!Nt||(i={batch:n,obj_renders_ordered:[],batch_renders_ordered:[],submeshes_ordered:[],rel_bpy_objects:[],rel_bpy_objects_uuids:[],mat_names:[]},r[n.id]=_.length,_.push(i)),e[a].submesh&&e[a].submesh.base_length){i.obj_renders_ordered.push(e[a].obj_render),i.batch_renders_ordered.push(e[a].batch_render),i.submeshes_ordered.push(e[a].submesh);for(var c=0;c<e[a].rel_bpy_objects.length;c++){var l=e[a].rel_bpy_objects[c];-1==i.rel_bpy_objects_uuids.indexOf(l.uuid)&&(i.rel_bpy_objects.push(l),i.rel_bpy_objects_uuids.push(l.uuid))}for(var c=0;c<e[a].mat_names.length;c++){var T=e[a].mat_names[c];-1==i.mat_names.indexOf(T)&&i.mat_names.push(T)}}i.mat_names.sort()}for(var a=0;a<_.length;a++){var n=_[a].batch,d=_[a].obj_renders_ordered,u=_[a].batch_renders_ordered,f=_[a].submeshes_ordered,P=K(u,n);if("STATIC"==P.type&&"COLOR_ID"!=n.type)for(var c=0;c<d.length;c++){var A=d[c],S=u[c],p=f[c],O=g.l(yt);if(A.billboard&&!A.billboard_pres_glob_orientation){var v=g.k(A.world_tsr,xt);g.u(v,O)}else g.a(A.world_tsr,O);if(S.is_hair_particles?p.instanced_array_data||(S.billboard?Pt.submesh_apply_particle_transform(p,O):Pt.submesh_apply_transform(p,O)):Pt.submesh_apply_transform(p,O),S.is_hair_particles)me(n,"AU_QUALIFIER","GLSL_IN");else if(_[a].rel_bpy_objects.length>1){var m={};(S.wind_bending||S.billboard)&&(m.au_center_pos=[O[0],O[1],O[2]]),S.wind_bending&&(m.au_wind_bending_amp=[S.wind_bending_amp],m.au_wind_bending_freq=[S.wind_bending_freq],m.au_detail_bending_amp=[S.detail_bending_amp],m.au_detail_bending_freq=[S.detail_bending_freq],m.au_branch_bending_amp=[S.branch_bending_amp]),Pt.submesh_apply_params(p,m),me(n,"AU_QUALIFIER","GLSL_IN")}else P.center_pos.set(O.subarray(0,3)),me(n,"AU_QUALIFIER","uniform")}if(0==f.length)var p=Pt.init_submesh(_t.unique_name("%empty"));else if(1==f.length)var p=f[0];else{for(var N=[],c=0;c<f.length;c++)Pt.is_long_submesh(f[c])||N.push(c);if(N.length<f.length)for(var c=0;c<N.length;c++)Pt.submesh_drop_indices(f[N[c]]);var p=Pt.submesh_list_join(f)}if("STATIC"==P.type){if("COLOR_ID"!=n.type){for(var R=[],c=0;c<_[a].rel_bpy_objects.length;c++){var b=_[a].rel_bpy_objects[c]._object;o.G(b.render.bbr_world,R)}o.a(R,0,R.length,P.bb_world),o.o(P.bb_world,P.bb_local),P.be_world=o.z(I._1(R),!0),o.s(P.be_world,P.be_local),P.bs_world=o.B(P.be_world),o.u(P.bs_world,P.bs_local)}if(P.is_lod){var h=_[a].rel_bpy_objects[0].b4w_cluster_data;h.cluster_center?P.lod_center.set(h.cluster_center):P.lod_center.set(P.bs_world.center)}}if("PARTICLES"!=n.type){var Y=p.submesh_bd;P.billboard?(o.o(P.bb_local,n.bounds_local.bb),o.s(P.be_local,n.bounds_local.be),o.u(P.bs_local,n.bounds_local.bs),n.use_be=!1):(o.o(Y.bb_local,n.bounds_local.bb),o.s(Y.be_local,n.bounds_local.be),P.bs_local.radius<Y.bs_local.radius?"STATIC"==P.type&&"COLOR_ID"!=n.type?o.u(P.bs_world,n.bounds_local.bs):o.u(P.bs_local,n.bounds_local.bs):o.u(Y.bs_local,n.bounds_local.bs),n.use_be=o.M(n.bounds_local.be,n.bounds_local.bs))}var L={batch:n,render:P,submesh:p,mat_names:_[a].mat_names,rel_bpy_objects:_[a].rel_bpy_objects};t.push(L)}return t}function K(e,t){return"DYNAMIC"==e[0].type||"COLOR_ID"==t.type?e[0]:it.clone_render(e[0])}function B(e,t,_){var r=_*(t.max_z-t.min_z);if(0==r)return 0;var a=r*Math.tan(e);return.5*(Math.sqrt(2*Math.sqrt(4*a+1)+2)/2-1)/r}function X(e,t,_){var r=_*(t.max_z-t.min_z);if(0==r)return 0;e*=2*r;var a=Math.pow(e+1,4)-Math.pow(e+1,2);return Math.atan(a/r)}function H(e){var t=o.w();return t.max_x=e.max_x,t.min_x=e.min_x,t.max_y=e.max_y,t.min_y=e.min_y,t.max_z=e.max_z,t.min_z=e.min_z,t}function j(e,t){for(var _=0;_<t.length;_++){var r=e.indexOf(t[_]);-1!==r&&e.splice(r,1)}return e}function Q(e,t,_,r){var a=[];if(r||(t.selectable&&lt.find_subs(e,ut.COLOR_PICKING)||t.outlining&&lt.find_subs(e,ut.OUTLINE_MASK))&&a.push("COLOR_ID"),_&&(a.push("MAIN"),a.push("NODES_GLOW"),lt.find_subs(e,ut.DEBUG_VIEW)&&a.push("DEBUG_VIEW"),lt.find_subs(e,ut.SHADOW_RECEIVE)&&a.push("SHADOW"),lt.find_subs(e,ut.GRASS_MAP)&&a.push("GRASS_MAP")),a.push("PHYSICS"),t.shadow_cast_only||t.reflexible_only){var n=null;if(t.shadow_cast_only&&(n=["MAIN","NODES_GLOW","COLOR_ID","PHYSICS","DEBUG_VIEW"]),t.reflexible_only){var o=["COLOR_ID","PHYSICS","SHADOW","DEBUG_VIEW"];n=null!==n?I.D(n,o):o}a=j(a,n)}return a}function z(e,t,_){var r;switch(e.type){case"MAIN":r=q(e,t,_);break;case"NODES_GLOW":r=ae(e,t,_,"GLOW");break;case"SHADOW":r=le(e,t,_);break;case"PHYSICS":r=Te(e,t);break;case"COLOR_ID":r=de(e,t,_);break;case"GRASS_MAP":r=fe(e,t);break;case"DEBUG_VIEW":r=ue(e,t);break;case"PARTICLES":r=Pe(e,t,_);break;default:et.panic("Wrong batch type: "+e.type)}return r}function V(e,t,_){var r="";if(Tt.check_active()){r=Tt.get_active().uuid}return ot.generate_graph_id(e,t,r,_)}function q(e,t,_){if(t.do_not_render)return!1;if(t.use_nodes&&"HALO"!=t.type)return ae(e,t,_,"MAIN"),!0;Z(e,t),e.use_backface_culling=t.use_backface_culling,e.xray=t.render_above_all&&"OPAQUE"!=t.blend_mode&&"CLIP"!=t.blend_mode&&"ALPHA_ANTIALIASING"!=t.blend_mode,e.offset_z=t.offset_z,e.texture_scale.set([1,1,1]);var r=t.texture_slots;if(e.diffuse_color.set(t.diffuse_color),e.diffuse_color[3]=t.alpha,t.is_lens_flares){Be(e,"lens_flares.glslv","lens_flares.glslf"),ve(e,"a_position"),ve(e,"a_texcoord");var a=ft.get_batch_texture(r[0]),n=r[0].texture;Xe(e,a,"u_sampler",n.name)}else{if(Be(e,"main.glslv","main_stack.glslf"),!t.use_shadeless){var o={use_shadeless:t.use_shadeless,diffuse_shader:t.diffuse_shader,specular_shader:t.specular_shader,use_tangent_shading:t.use_tangent_shading},i=V(t.uuid,"MAIN"),s=ot.create_lighting_graph(i,o,e.lights);e.shaders_info.node_elements=ot.compose_node_elements(s)}var E=$("use_map_color_diffuse",!0,r),c=$("use_map_color_spec",!0,r),l=$("use_map_normal",!0,r),T=$("use_map_mirror",!0,r),d=$("use_stencil",!0,r),u=E[0],f=c[0],P=l[0],A=T[0],S=E[1],p=d[0]&&$("use_rgb_to_intensity",!0,r)[0];if(u){var n=u.texture;switch(u.blend_type){case"MIX":me(e,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case"MULTIPLY":me(e,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}var a=ft.get_batch_texture(u);Xe(e,a,"u_colormap0",n.name),e.diffuse_color_factor=u.diffuse_color_factor,u.use_map_alpha?e.alpha_factor=u.alpha_factor:e.alpha_factor=0,e.texture_scale.set(u.scale)}var O=u&&u==f;if(f){if(!O){var n=f.texture,a=ft.get_batch_texture(f);Xe(e,a,"u_specmap0",n.name)}e.specular_color_factor=f.specular_color_factor}if(P){var n=P.texture;ve(e,"a_tbn");var a=ft.get_batch_texture(P);if(Xe(e,a,"u_normalmap0",n.name),e.normal_factor=P.normal_factor,n.b4w_use_map_parallax&&At.parallax){var v=dt.glsl_value(n.b4w_parallax_steps),m=dt.glsl_value(n.b4w_parallax_lod_dist);me(e,"PARALLAX",1),me(e,"PARALLAX_STEPS",v),me(e,"PARALLAX_LOD_DIST",m),e.parallax_scale=n.b4w_parallax_scale}}if(A){var n=A.texture,a=ft.get_batch_texture(A);Xe(e,a,"u_mirrormap",n.name),e.mirror_factor=A.mirror_factor}var N=u&&S&&p?1:0;if(N){var a=ft.get_batch_texture(S),n=S.texture;Xe(e,a,"u_colormap1",n.name),a=ft.get_batch_texture(p),n=p.texture,Xe(e,a,"u_stencil0",n.name)}var g=u||f||P;g&&e.texture_scale.set(g.scale),me(e,"TEXTURE_SPEC",void 0==f?0:1),me(e,"ALPHA_AS_SPEC",O?1:0),me(e,"TEXTURE_STENCIL_ALPHA_MASK",N),ve(e,"a_position"),ve(e,"a_tbn"),(u||f||P)&&ve(e,"a_texcoord"),t.water_settings.is_water&&ee(t,e),"HALO"===t.type&&(Be(e,"halo.glslv","halo.glslf"),W(e,t),e.common_attributes=["a_position"]),t.use_tangent_shading&&(me(e,"USE_TBN_SHADING",1),ve(e,"a_shade_tangs")),me(e,"TEXCOORD",0),me(e,"NORMAL_TEXCOORD",0),u&&J(e,u,"TEXTURE_COLOR0_CO"),S&&J(e,S,"TEXTURE_COLOR1_CO"),p&&J(e,p,"TEXTURE_STENCIL_ALPHA_MASK_CO"),f&&J(e,f,"TEXTURE_SPEC_CO"),P&&J(e,P,"TEXTURE_NORM_CO"),me(e,"SHADELESS",t.use_shadeless?1:0),e.use_shadeless=t.use_shadeless}return me(e,"ALPHA","OPAQUE"===t.blend_mode?0:1),me(e,"ALPHA_CLIP","CLIP"===t.blend_mode?1:0),me(e,"DOUBLE_SIDED_LIGHTING",t.use_double_sided_lighting?1:0),t.use_vertex_color_paint?(me(e,"VERTEX_COLOR",1),ve(e,"a_color")):me(e,"VERTEX_COLOR",0),e.ambient=t.ambient,e.diffuse_intensity=t.diffuse_intensity,e.emit=t.emit,e.specular_color.set(t.specular_color),e.specular_alpha=t.specular_alpha,_e(e,t),re(e,t),t.is_wettable?me(e,"WETTABLE",1):me(e,"WETTABLE",0),te(e,t),t.is_refractive&&!e.blend?(rt.warn('Material "'+t.name+'" is not blend. Disabling refractions.'),e.refractive=!1):e.refractive=t.is_refractive,e.refr_bump=t.refr_bump,!0}function W(e,t){var _=t.halo_settings;me(e,"NUM_RINGS",_.ring_count),me(e,"NUM_LINES",_.line_count),me(e,"NUM_STARS",_.star_tip_count),me(e,"SKY_STARS",_.is_sky_stars?1:0),e.halo_size=_.size,e.halo_hardness=_.hardness/20,e.halo_rings_color.set(_.rings_color),e.halo_lines_color.set(_.lines_color),e.halo_stars_blend=1/_.stars_blend_height,e.halo_stars_height=_.stars_min_height,e.halo=!0}function J(e,t,_){switch(t.texture_coords){case"UV":case"ORCO":me(e,_,"TEXTURE_COORDS_UV_ORCO"),me(e,"TEXCOORD",1);break;case"NORMAL":me(e,_,"TEXTURE_COORDS_NORMAL"),me(e,"NORMAL_TEXCOORD",1);break;default:me(e,_,"TEXTURE_COORDS_NONE")}}function Z(e,t){switch(t.blend_mode){case"ALPHA_ANTIALIASING":e.blend=!1,e.z_sort=!1,e.depth_mask=!0,e.alpha_clip=!1,e.alpha_antialiasing=!0;break;case"ALPHA_SORT":e.blend=!0,e.z_sort=!0,e.depth_mask=!0,e.alpha_clip=!1,e.alpha_antialiasing=!1;break;case"ALPHA":e.blend=!0,e.z_sort=!1,e.depth_mask=!0,e.alpha_clip=!1,e.alpha_antialiasing=!1;break;case"CLIP":e.blend=!1,e.z_sort=!1,e.depth_mask=!0,e.alpha_clip=!0,e.alpha_antialiasing=!1;break;case"ADD":e.blend=!0,e.z_sort=!1,e.depth_mask=!1,e.alpha_clip=!1,e.alpha_antialiasing=!1;break;case"OPAQUE":e.blend=!1,e.z_sort=!1,e.depth_mask=!0,e.alpha_clip=!1,e.alpha_antialiasing=!1;break;default:et.panic("Unknown alpha blend mode: "+t.blend_mode)}}function $(e,t,_){for(var r=[],a=_.length,n=0;n<a;n++){var o=_[n];o[e]==t&&o.texture&&o.texture._render&&r.push(o)}return r}function ee(e,t){t.water=!0,t.water_dynamic=e.water_settings.is_dynamic,e.water_settings.shore_smoothing&&!t.blend?(rt.warn('Material: "'+e.name+'" is opaque.',"Disabling water shore smoothing."),t.water_shore_smoothing=!1):t.water_shore_smoothing="REFLECT"!=t.subtype&&e.water_settings.shore_smoothing,Be(t,"water.glslv","water.glslf");var _={use_shadeless:!1,diffuse_shader:e.diffuse_shader,specular_shader:e.specular_shader,use_tangent_shading:e.use_tangent_shading},r=V(e.uuid),a=ot.create_lighting_graph(r,_,t.lights);t.shaders_info.node_elements=ot.compose_node_elements(a),ve(t,"a_position"),At.water_wireframe_debug?(ve(t,"a_polyindex"),t.depth_mask=!0,b.set(0,0,0,t.wireframe_edge_color),at.get_standard_derivatives()?me(t,"DEBUG_WIREFRAME",1):me(t,"DEBUG_WIREFRAME",2)):me(t,"DEBUG_WIREFRAME",0);var n=e.texture_slots,o=$("use_map_normal",!0,n),i=$("use_map_mirror",!0,n)[0];if(o.length){var s=ft.get_batch_texture(o[0]),E=o[0].texture;Xe(t,s,"u_normalmap0",E.name),t.water_norm_uv_velocity=e.water_settings.norm_uv_velocity}me(t,"NUM_NORMALMAPS",o.length),t.normalmap_scales=new Array(o.length);for(var c=0;c<o.length;c++)t.normalmap_scales[c]=new Float32Array(2),t.normalmap_scales[c].set([o[c].scale[0],o[c].scale[1]]);if(i){var l=ft.get_batch_texture(i),E=i.texture;Xe(t,l,"u_mirrormap",E.name),t.mirror_factor=i.mirror_factor}var T=null;if(At.foam)for(var c=0;c<n.length;c++){var d=n[c];if(!0===d.texture.b4w_water_foam){T=d;break}}if(T){me(t,"FOAM",1);var u=ft.get_batch_texture(T),E=T.texture;Xe(t,u,"u_foam",E.name),t.foam_factor=e.water_settings.foam_factor,t.foam_uv_freq.set(E.b4w_foam_uv_freq),t.foam_mag.set(E.b4w_foam_uv_magnitude),t.foam_scale[0]=T.scale[0],t.foam_scale[1]=T.scale[1]}for(var c=0;c<n.length;c++){var d=n[c];if(!0===d.texture.b4w_shore_dist_map){var f=d;break}}if(f&&At.allow_vertex_textures){var P=ft.get_batch_texture(f),E=f.texture;Xe(t,P,"u_shore_dist_map",E.name),me(t,"SHORE_PARAMS",1);var A=d.texture.b4w_shore_boundings;me(t,"MAX_SHORE_DIST",dt.glsl_value(d.texture.b4w_max_shore_dist)),me(t,"SHORE_MAP_SIZE_X",dt.glsl_value(A[0]-A[1])),me(t,"SHORE_MAP_SIZE_Y",dt.glsl_value(A[2]-A[3])),me(t,"SHORE_MAP_CENTER_X",dt.glsl_value((A[0]+A[1])/2)),me(t,"SHORE_MAP_CENTER_Y",dt.glsl_value((A[2]+A[3])/2))}if(e.water_settings.is_generated_mesh?(me(t,"GENERATED_MESH",1),t.water_generated_mesh=!0,t.water_num_cascads=e.water_settings.num_cascads,t.water_subdivs=e.water_settings.num_subdivs,t.water_detailed_dist=e.water_settings.detailed_dist):(ve(t,"a_tbn"),(T||o.length)&&ve(t,"a_texcoord"),me(t,"GENERATED_MESH",0)),e.water_settings.is_dynamic){var S=dt.glsl_value(e.water_settings.dst_noise_scale0),p=dt.glsl_value(e.water_settings.dst_noise_scale1),O=dt.glsl_value(e.water_settings.dst_noise_freq0),v=dt.glsl_value(e.water_settings.dst_noise_freq1),m=dt.glsl_value(e.water_settings.dir_min_shore_fac),N=dt.glsl_value(e.water_settings.dir_freq),g=dt.glsl_value(e.water_settings.dir_noise_scale),R=dt.glsl_value(e.water_settings.dir_noise_freq),I=dt.glsl_value(e.water_settings.dir_min_noise_fac),h=dt.glsl_value(e.water_settings.dst_min_fac),Y=dt.glsl_value(e.water_settings.waves_hor_fac);me(t,"DST_NOISE_SCALE_0",S),me(t,"DST_NOISE_SCALE_1",p),me(t,"DST_NOISE_FREQ_0",O),me(t,"DST_NOISE_FREQ_1",v),me(t,"DIR_MIN_SHR_FAC",m),me(t,"DIR_FREQ",N),me(t,"DIR_NOISE_SCALE",g),me(t,"DIR_NOISE_FREQ",R),me(t,"DIR_MIN_NOISE_FAC",I),me(t,"DST_MIN_FAC",h),me(t,"WAVES_HOR_FAC",Y)}_e(t,e),re(t,e),t.shallow_water_col.set(e.water_settings.shallow_col),t.shore_water_col.set(e.water_settings.shore_col),t.shallow_water_col_fac=e.water_settings.shallow_col_fac,t.shore_water_col_fac=e.water_settings.shore_col_fac,me(t,"ABSORB",dt.glsl_value(e.water_settings.absorb_factor)),me(t,"SSS_STRENGTH",dt.glsl_value(e.water_settings.sss_strength)),me(t,"SSS_WIDTH",dt.glsl_value(e.water_settings.sss_width))}function te(e,t){var _=t.raytrace_mirror;e.reflect_factor=_.reflect_factor,e.fresnel_params[0]=_.fresnel,e.fresnel_params[1]=1-_.fresnel_factor/5}function _e(e,t){var _,r=0;switch(t.specular_shader){case"PHONG":case"COOKTORR":_=t.specular_hardness;break;case"WARDISO":_=t.specular_slope;break;case"TOON":_=t.specular_toon_size,r=t.specular_toon_smooth;break;case"BLINN":_=t.specular_ior,r=t.specular_hardness;break;default:rt.error("unsupported specular shader: "+t.specular_shader+' (material "'+t.name+'")'),_=t.specular_hardness}e.specular_params[0]=t.specular_intensity,e.specular_params[1]=_,e.specular_params[2]=r}function re(e,t){switch(t.diffuse_shader){case"LAMBERT":e.diffuse_params[0]=0,e.diffuse_params[1]=0;break;case"OREN_NAYAR":e.diffuse_params[0]=t.roughness,e.diffuse_params[1]=0;break;case"FRESNEL":e.diffuse_params[0]=t.diffuse_fresnel,e.diffuse_params[1]=t.diffuse_fresnel_factor;break;case"MINNAERT":e.diffuse_params[0]=t.darkness,e.diffuse_params[1]=0;break;case"TOON":e.diffuse_params[0]=t.diffuse_toon_size,e.diffuse_params[1]=t.diffuse_toon_smooth;break;default:rt.error("unsupported diffuse shader: "+t.diffuse_shader+' (material "'+t.name+'")'),e.diffuse_params[0]=0,e.diffuse_params[1]=0}}function ae(e,t,_,r){if(!t.use_nodes||t.do_not_render)return!1;var a;switch(r){case"MAIN":Be(e,"main.glslv","main.glslf"),a=!1;break;case"GLOW":Be(e,"main.glslv","main.glslf"),a=!0;break;case"SHADOW":Be(e,"shadow.glslv","shadow.glslf"),a=!1;break;case"COLOR_ID":Be(e,"color_id.glslv","color_id.glslf"),a=!1}var n=t.node_tree,o={vc_name:_.active_vcol_name,uv_name:_.active_uv_name},i=V(t.uuid,r,o),s=ot.compose_ngraph_proxy(n,i,!1,_.name,t.name,r,o,e.lights);if(!s.graph)return rt.error('Failed to create node graph for material "'+t.name+'", disable nodes'),ce(e,t),!0;e.ngraph_proxy_id=s.id,e.has_nodes=!0,me(e,"NODES",1),me(e,"DOUBLE_SIDED_LIGHTING",t.use_double_sided_lighting?1:0),ve(e,"a_position"),t.use_orco_tex_coord&&ve(e,"a_orco_tex_coord"),Z(e,t),e.use_backface_culling=t.use_backface_culling,e.offset_z=t.offset_z,a?(me(e,"ALPHA",1),me(e,"ALPHA_CLIP",0)):(me(e,"ALPHA","OPAQUE"===t.blend_mode?0:1),me(e,"ALPHA_CLIP","CLIP"===t.blend_mode?1:0)),e.xray=t.render_above_all&&"OPAQUE"!=t.blend_mode&&"CLIP"!=t.blend_mode&&"ALPHA_ANTIALIASING"!=t.blend_mode,e.emit=t.emit,e.ambient=t.ambient,te(e,t),t.is_wettable?me(e,"WETTABLE",1):me(e,"WETTABLE",0);var E=null,c=!1;nt.traverse(s.graph,function(_,r){switch(r.type){case"UVMAP":case"TEX_COORD_UV":case"GEOMETRY_UV":case"UV_MERGED":var a=r.data.name,n=r.data.value;e.uv_maps_usage||(e.uv_maps_usage={}),e.uv_maps_usage[n]=a;break;case"GEOMETRY_VC":case"GEOMETRY_VC1":case"GEOMETRY_VC2":case"GEOMETRY_VC3":var a=r.data.name,o=r.data.value;e.vertex_colors_usage[a]={generate_buffer:!0,src:[{name:o}]};var i=0;if("GEOMETRY_VC"==r.type)i=7;else for(var s=0;s<r.outputs.length;s++){var l="RGB".indexOf(r.outputs[s].identifier);l>-1&&(i|=1<<2-l)}e.vertex_colors_usage[a].src[0].mask=i;break;case"TEX_COORD_NO":case"TEX_COORD_RE":case"GEOMETRY_NO":case"FRESNEL":case"LAYER_WEIGHT":ve(e,"a_tbn");break;case"TEX_COORD_OB":me(e,"USE_MODEL_TSR_INVERSE",1);break;case"TEX_COORD_WI":me(e,"USE_POSITION_CLIP",1);break;case"MATERIAL_BEGIN":r.data.value.use_tangent_shading&&(me(e,"USE_TBN_SHADING",1),"PARTICLES"!=e.type&&ve(e,"a_shade_tangs")),ve(e,"a_tbn"),c=!0;break;case"BSDF_BEGIN":c=!0,ve(e,"a_tbn");break;case"TEXTURE_COLOR":case"TEXTURE_ENVIRONMENT_CUBE":case"TEXTURE_ENVIRONMENT_EQUIRECTANGULAR":case"TEXTURE_ENVIRONMENT_MIRROR_BALL":var a=r.data.name,T=r.data.bpy_name,d=r.data.value;Xe(e,d,a,T);break;case"TEXTURE_NORMAL":case"B4W_PARALLAX":if(me(e,"CALC_TBN_SPACE",1),ve(e,"a_tbn"),r.data){var a=r.data.name,T=r.data.bpy_name,d=r.data.value;Xe(e,d,a,T)}break;case"NORMAL_MAP":ve(e,"a_tbn");switch(Number(r.dirs[0][1])){case ot.NM_TANGENT:me(e,"CALC_TBN_SPACE",1);break;case ot.NM_OBJECT:case ot.NM_BLENDER_OBJECT:me(e,"USE_MODEL_TSR",1)}break;case"LAMP":r.data&&(e.lamp_uuid_indexes=r.data);break;case"B4W_REFRACTION":e.blend?e.refractive=!0:(e.refractive=!1,rt.warn('Material "'+t.name+'" is not blend. Disabling refractions.')),me(e,"USE_POSITION_CLIP",1);break;case"VALTORGB":case"CURVE_VEC":case"CURVE_RGB":E||(E=r.data.texture);break;case"PARTICLE_INFO":"PARTICLES"==e.type&&r.data&&(e.part_node_data=r.data);break;case"VECT_TRANSFORM":switch(Number(r.dirs[1][1])){case ot.VT_WORLD_TO_OBJECT:me(e,"USE_MODEL_TSR_INVERSE",1);break;case ot.VT_WORLD_TO_CAMERA:me(e,"USE_VIEW_TSR",1);break;case ot.VT_OBJECT_TO_WORLD:me(e,"USE_MODEL_TSR",1);break;case ot.VT_OBJECT_TO_CAMERA:me(e,"USE_MODEL_TSR",1),me(e,"USE_VIEW_TSR",1);break;case ot.VT_CAMERA_TO_WORLD:me(e,"USE_VIEW_TSR_INVERSE",1);break;case ot.VT_CAMERA_TO_OBJECT:me(e,"USE_MODEL_TSR_INVERSE",1),me(e,"USE_VIEW_TSR_INVERSE",1)}break;case"OBJECT_INFO":me(e,"USE_MODEL_TSR",1),e.obj_info_params[1]=t.pass_index,e.obj_info_params[2]=Math.random();break;case"B4W_VECTOR_VIEW":case"GEOMETRY_VW":me(e,"USE_VIEW_TSR",1);break;case"B4W_REFLECT":me(e,"USE_VIEW_TSR_INVERSE",1);break;case"BUMP":case"DISPLACEMENT_BUMP":ve(e,"a_tbn"),at.get_standard_derivatives()?me(e,"USE_DERIVATIVES_EXT",1):rt.warn('"OES_standard_derivatives" extension is not available. Disabling the BUMP node in the "'+t.name+'" material.');break;case"BSDF_TRANSPARENT":r.data.value.use_alpha?me(e,"USE_BSDF_TRANSPARENT_ALPHA",1):(e.blend=!0,e.refractive=!0,me(e,"USE_BSDF_TRANSPARENT_REFRACT",1));break;case"BSDF_GLOSSY":case"BSDF_DIFFUSE":case"BSDF_PRINCIPLED":me(e,"USE_BSDF_SKY_DIM",1),at.get_texture_lod()&&me(e,"USE_TEXTURE_LOD_EXT",1)}}),E&&Xe(e,E,"u_nodes_texture"),c||(e.use_shadeless=!0);var l=e.shaders_info.node_elements=ot.compose_node_elements(s.graph);oe(s.graph,e,t.name);for(var T=e.node_value_inds,d=e.node_rgb_inds,u=0;u<l.length;u++){var f=l[u];switch(f.id){case"VALUE":var P=f.param_values[0];if(P)for(var A=0;A<T.length;A+=3)if(T[A]==P){f.dirs.push(["VALUE_ROW_IND",T[A+1]]),f.dirs.push(["VALUE_COL_IND",T[A+2]]);break}break;case"RGB":var P=f.param_values[0];if(P)for(var A=0;A<d.length;A+=2)if(d[A]==P){f.dirs.push(["RGB_IND",d[A+1]]);break}}}return me(e,"NUM_VALUES",e.node_values.length/4),me(e,"NUM_RGBS",e.node_rgbs.length),!0}function ne(e,t){var _=t._render.world_light_set;if(""!=_.ngraph_proxy_id){e.has_nodes=!0,e.ngraph_proxy_id=_.ngraph_proxy_id;var r=ot.get_ngraph_proxy_cached(_.ngraph_proxy_id),a=r.graph;if(!a)return rt.error('Failed to create node graph for world "'+t.world.name+'", disable nodes'),ce(e,t.world.name),!0;var n=null;nt.traverse(a,function(t,_){switch(_.type){case"TEXTURE_COLOR":case"TEXTURE_ENVIRONMENT_EQUIRECTANGULAR":case"TEXTURE_ENVIRONMENT_MIRROR_BALL":var r=_.data.name,a=_.data.bpy_name,o=_.data.value;Xe(e,o,r,a);break;case"VALTORGB":case"CURVE_VEC":case"CURVE_RGB":n||(n=_.data.texture);break;case"VECT_TRANSFORM":switch(Number(_.dirs[1][1])){case ot.VT_WORLD_TO_OBJECT:me(e,"USE_MODEL_TSR_INVERSE",1);break;case ot.VT_WORLD_TO_CAMERA:me(e,"USE_VIEW_TSR",1);break;case ot.VT_OBJECT_TO_WORLD:me(e,"USE_MODEL_TSR",1);break;case ot.VT_OBJECT_TO_CAMERA:me(e,"USE_MODEL_TSR",1),me(e,"USE_VIEW_TSR",1);break;case ot.VT_CAMERA_TO_WORLD:me(e,"USE_VIEW_TSR_INVERSE",1);break;case ot.VT_CAMERA_TO_OBJECT:me(e,"USE_MODEL_TSR_INVERSE",1),me(e,"USE_VIEW_TSR_INVERSE",1)}break;case"B4W_VECTOR_VIEW":me(e,"USE_VIEW_TSR",1);break;case"B4W_REFLECT":me(e,"USE_VIEW_TSR_INVERSE",1)}}),n&&Xe(e,n,"u_nodes_texture");var o=e.shaders_info.node_elements=ot.compose_node_elements(a);oe(a,e,t.world.name);for(var i=e.node_value_inds,s=e.node_rgb_inds,E=0;E<o.length;E++){var c=o[E];switch(c.id){case"VALUE":var l=c.param_values[0];if(l)for(var T=0;T<i.length;T+=3)if(i[T]==l){c.dirs.push(["VALUE_ROW_IND",i[T+1]]),c.dirs.push(["VALUE_COL_IND",i[T+2]]);break}break;case"RGB":var l=c.param_values[0];if(l)for(var T=0;T<s.length;T+=2)if(s[T]==l){c.dirs.push(["RGB_IND",s[T+1]]);break}}}return me(e,"NUM_VALUES",e.node_values.length/4),me(e,"NUM_RGBS",e.node_rgbs.length),!0}return!1}function oe(e,t,_){var r=[],a=[],n=[],o=[];ie(e,"",r,a,n,o),t.node_values=r,t.node_value_inds=a,t.node_rgbs=n,t.node_rgb_inds=o}function ie(e,t,_,r,a,n){nt.traverse(e,function(e,o){if("VALUE"==o.type){var i=se(t,o.name);_.push(o.outputs[0].default_value);var s=r.length/3,E=parseInt(s/4),c=parseInt(s%4);r.push(i,E,c)}else if("RGB"==o.type){var i=se(t,o.name),l=o.outputs[0].default_value.slice(0,3);a.push(l[0],l[1],l[2]),n.push(i,n.length/2)}});for(var o=_.length+4-_.length%4,i=_.length;i<o;i++)_.push(0)}function se(e,t){var _=e?e+"%join%":"";return _+=t}function Ee(e,t){for(var _=e[t],r=t+1;r<e.length;r++)_=se(_,e[r]);return _}function ce(e,t){switch(e.type){case"SHADOW":Be(e,"shadow.glslv","shadow.glslf");break;case"COLOR_ID":Be(e,"color_id.glslv","color_id.glslf");break;default:Be(e,"main.glslv","main_stack.glslf")}return me(e,"SHADELESS",1),ve(e,"a_position"),ve(e,"a_tbn"),h.set(1,0,1,1,e.diffuse_color),t&&(me(e,"ALPHA","OPAQUE"===t.blend_mode?0:1),me(e,"ALPHA_CLIP","CLIP"===t.blend_mode?1:0),me(e,"VERTEX_COLOR",0),e.offset_z=t.offset_z,Z(e,t),e.use_backface_culling=t.use_backface_culling),!0}function le(e,t,_){if(t.is_lens_flares||t.water_settings.is_water||t.do_not_render||"HALO"==t.type)return!1;if(Z(e,t),e.use_backface_culling=t.use_backface_culling,e.blend)return!1;!t.use_nodes||"CLIP"!=t.blend_mode&&"ALPHA_ANTIALIASING"!=t.blend_mode?Be(e,"shadow.glslv","shadow.glslf"):ae(e,t,_,"SHADOW"),e.depth_mask=e.depth_mask&&!(At.reuse_depth_optimization&&"ALPHA_ANTIALIASING"==t.blend_mode),h.set(0,0,0,t.alpha,e.diffuse_color),ve(e,"a_position"),ve(e,"a_tbn"),me(e,"ALPHA","OPAQUE"===t.blend_mode?0:1),e.texture_scale.set([1,1,1]);var r=t.texture_slots,a=$("use_map_color_diffuse",!0,r)[0];if(!a||"CLIP"!=t.blend_mode&&"ALPHA_ANTIALIASING"!=t.blend_mode)me(e,"TEXTURE_COLOR",0);else{switch(a.blend_type){case"MIX":me(e,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case"MULTIPLY":me(e,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}e.texture_scale.set(a.scale),me(e,"TEXTURE_COLOR",1),ve(e,"a_texcoord");var n=ft.get_batch_texture(a),o=a.texture;"IMAGE"!=n.source&&"ENVIRONMENT_MAP"!=n.source&&"CANVAS"!=n.source&&"NONE"!=n.source||Xe(e,n,"u_colormap0",o.name)}return!0}function Te(e,t){var _=t.physics_settings,r=t.water_settings;return _.use_coll_physics?(e.use_ghost=_.use_ghost,e.collision_id=_.collision_id,e.collision_margin=_.collision_margin,e.collision_group=_.collision_group,e.collision_mask=_.collision_mask,e.friction=_.friction,e.elasticity=_.elasticity,!0):!!r.is_water&&(e.water=!0,e.water_dynamics=r.is_dynamic,e.dst_noise_scale0=r.dst_noise_scale0,e.dst_noise_scale1=r.dst_noise_scale1,e.dst_noise_freq0=r.dst_noise_freq0,e.dst_noise_freq1=r.dst_noise_freq1,e.dir_min_shore_fac=r.dir_min_shore_fac,e.dir_freq=r.dir_freq,e.dir_noise_scale=r.dir_noise_scale,e.dir_noise_freq=r.dir_noise_freq,e.dir_min_noise_fac=r.dir_min_noise_fac,e.dst_min_fac=r.dst_min_fac,e.waves_hor_fac=r.waves_hor_fac,!0)}function de(e,t,_){if(t.is_lens_flares||"HALO"==t.type)return!1;var r=t.blend_mode,a=r;"ALPHA_ANTIALIASING"==a&&(a="CLIP",t.blend_mode="CLIP"),Z(e,t),e.use_backface_culling=t.use_backface_culling,e.z_sort=!1,e.depth_mask=!0,e.blend=!1,e.xray=t.render_above_all&&"OPAQUE"!=a&&"CLIP"!=a,t.use_nodes&&"CLIP"==a?ae(e,t,_,"COLOR_ID"):Be(e,"color_id.glslv","color_id.glslf"),h.set(0,0,0,t.alpha,e.diffuse_color),ve(e,"a_position"),me(e,"ALPHA","OPAQUE"===a?0:1),e.texture_scale.set([1,1,1]);var n=t.texture_slots,o=$("use_map_color_diffuse",!0,n)[0];if(me(e,"ALPHA_CLIP","CLIP"===a?1:0),o&&"CLIP"==a){switch(o.blend_type){case"MIX":me(e,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case"MULTIPLY":me(e,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}e.texture_scale.set(o.scale),me(e,"TEXTURE_COLOR",1),ve(e,"a_texcoord");var i=ft.get_batch_texture(o),s=o.texture;"IMAGE"!=i.source&&"ENVIRONMENT_MAP"!=i.source&&"CANVAS"!=i.source&&"NONE"!=i.source||Xe(e,i,"u_colormap0",s.name)}else me(e,"TEXTURE_COLOR",0);return t.blend_mode=r,!0}function ue(e,t){return(!t||!t.is_lens_flares&&!t.do_not_render)&&(Be(e,"debug_view.glslv","debug_view.glslf"),ve(e,"a_position"),ve(e,"a_tbn"),ve(e,"a_polyindex"),e.depth_mask=!0,b.set(0,0,0,e.wireframe_edge_color),!0)}function fe(e,t){if(!t.terrain_settings.is_terrain||t.do_not_render)return!1;if(Z(e,t),e.use_backface_culling=t.use_backface_culling,e.blend=!1,e.z_sort=!1,e.depth_mask=!0,Be(e,"grass_map.glslv","grass_map.glslf"),ve(e,"a_position"),t.terrain_settings.dynamic_grass_size)var _=t.terrain_settings.dynamic_grass_size;else var _=null;if(t.terrain_settings.dynamic_grass_color)var r=t.terrain_settings.dynamic_grass_color;else var r=null;e.vertex_colors_usage.a_grass_size={generate_buffer:!0,src:[]},_?(e.vertex_colors_usage.a_grass_size.src.push({name:_,mask:4}),me(e,"DYNAMIC_GRASS_SIZE",1)):me(e,"DYNAMIC_GRASS_SIZE",0),e.vertex_colors_usage.a_grass_color={generate_buffer:!0,src:[]},r?(e.vertex_colors_usage.a_grass_color.src.push({name:r,mask:7}),me(e,"DYNAMIC_GRASS_COLOR",1)):me(e,"DYNAMIC_GRASS_COLOR",0);var a=pt.grass_tex_size;return me(e,"GRASS_TEXTURE_SIZE",dt.glsl_value(a)),!0}function Pe(e,t,_){if(t.do_not_render)return!1;var r=t.texture_slots;if(e.halo_particles)Be(e,"particle_system.glslv","particle_system_stack.glslf"),me(e,"HALO_PARTICLES",1),W(e,t);else{var a={use_shadeless:!1,diffuse_shader:t.diffuse_shader,specular_shader:t.specular_shader,use_tangent_shading:t.use_tangent_shading};if(t.use_nodes)return Be(e,"particle_system.glslv","particle_system.glslf"),ae(e,t,_,"PARTICLES"),!0;Be(e,"particle_system.glslv","particle_system_stack.glslf");var n=V(t.uuid),o=ot.create_lighting_graph(n,a,e.lights);e.shaders_info.node_elements=ot.compose_node_elements(o);var i=$("use_map_color_diffuse",!0,r)[0];if(i){switch(me(e,"TEXTURE_COLOR",1),i.blend_type){case"MIX":me(e,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case"MULTIPLY":me(e,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}e.diffuse_color_factor=i.diffuse_color_factor,i.use_map_alpha?e.alpha_factor=i.alpha_factor:e.alpha_factor=0;Xe(e,ft.get_batch_texture(i),"default"+String(e.textures.length),i.texture.name)}}return e.diffuse_color.set(t.diffuse_color),e.diffuse_color[3]=t.alpha,e.ambient=t.ambient,e.diffuse_intensity=t.diffuse_intensity,e.emit=t.emit,e.specular_color.set(t.specular_color),e.specular_alpha=t.specular_alpha,ve(e,"a_position"),ve(e,"a_tbn"),me(e,"ALPHA","OPAQUE"===t.blend_mode?0:1),me(e,"ALPHA_CLIP","CLIP"===t.blend_mode?1:0),me(e,"PARTICLES_SHADELESS",t.use_shadeless?1:0),_e(e,t),re(e,t),Z(e,t),e.use_backface_culling=t.use_backface_culling,e.xray=t.render_above_all&&"OPAQUE"!=t.blend_mode&&"CLIP"!=t.blend_mode&&"ALPHA_ANTIALIASING"!=t.blend_mode,e.offset_z=t.offset_z,!0}function Ae(e,t){if(e.data_id=t.data_id,"PHYSICS"!==e.type){switch("DYNAMIC"==t.type||"COLOR_ID"==e.type?(t.is_hair_particles?me(e,"AU_QUALIFIER","GLSL_IN"):me(e,"AU_QUALIFIER","uniform"),me(e,"STATIC_BATCH",0)):(me(e,"AU_QUALIFIER","GLSL_IN"),me(e,"STATIC_BATCH",1)),"DEBUG_VIEW"==e.type&&(at.get_standard_derivatives()?me(e,"WIREFRAME_QUALITY",1):me(e,"WIREFRAME_QUALITY",0),e.debug_sphere?(me(e,"DEBUG_SPHERE",1),e.debug_sphere_dynamic?me(e,"DEBUG_SPHERE_DYNAMIC",1):me(e,"DEBUG_SPHERE_DYNAMIC",0)):me(e,"DEBUG_SPHERE",0),me(e,"ALPHA",1)),t.use_shape_keys&&"PARTICLES"!=e.type&&!t.is_hair_particles&&(e.use_shape_keys=t.use_shape_keys),t.wind_bending?(""!==t.main_bend_col?(e.vertex_colors_usage.a_bending_col_main={generate_buffer:!0,src:[{name:t.main_bend_col,mask:4}]},ve(e,"a_bending_col_main"),""!==t.detail_bend_col.leaves_stiffness&&""!==t.detail_bend_col.leaves_phase&&""!==t.detail_bend_col.overall_stiffness?(e.vertex_colors_usage.a_bending_col_detail={generate_buffer:!0,src:[{name:t.detail_bend_col.leaves_stiffness,mask:4},{name:t.detail_bend_col.leaves_phase,mask:2},{name:t.detail_bend_col.overall_stiffness,mask:1}]},ve(e,"a_bending_col_detail"),ve(e,"a_tbn"),me(e,"DETAIL_BEND",1)):me(e,"DETAIL_BEND",0),me(e,"MAIN_BEND_COL",1)):me(e,"MAIN_BEND_COL",0),t.bend_center_only?me(e,"BEND_CENTER_ONLY",1):me(e,"BEND_CENTER_ONLY",0),me(e,"WIND_BEND",1)):me(e,"WIND_BEND",0),me(e,"BILLBOARD_PRES_GLOB_ORIENTATION",0|t.billboard_pres_glob_orientation),t.billboard?me(e,"BILLBOARD",1):me(e,"BILLBOARD",0),t.billboard&&t.is_hair_particles?me(e,"HAIR_BILLBOARD",1):me(e,"HAIR_BILLBOARD",0),t.billboard_spherical?me(e,"BILLBOARD_SPHERICAL",1):me(e,"BILLBOARD_SPHERICAL",0),t.billboard_type){case"RANDOM":me(e,"BILLBOARD_RANDOM",1),me(e,"BILLBOARD_JITTERED",0);break;case"JITTERED":me(e,"BILLBOARD_RANDOM",0),me(e,"BILLBOARD_JITTERED",1);break;default:me(e,"BILLBOARD_RANDOM",0),me(e,"BILLBOARD_JITTERED",0)}t.dynamic_grass&&At.allow_vertex_textures?me(e,"DYNAMIC_GRASS",1):me(e,"DYNAMIC_GRASS",0),e.dynamic_grass=t.dynamic_grass,"PARTICLES"!=e.type&&(e.dynamic_geometry=t.dynamic_geometry),e.shadow_cast=t.shadow_cast,e.shadow_cast_only=t.shadow_cast_only,e.shadow_receive=t.shadow_receive&&!e.use_shadeless&&!(e.blend&&At.disable_blend_shadows_hack),At.rgba_fallback_shadows?("MAIN"==e.type&&e.shadow_receive||"SHADOW"==e.type)&&me(e,"RGBA_SHADOWS",1):me(e,"RGBA_SHADOWS",0),e.reflexible=t.reflexible,e.reflexible_only=t.reflexible_only,e.reflective=t.reflective,e.obj_info_params[0]=t.pass_index,e.lod_dist_max=t.lod_dist_max,e.lod_dist_min=t.lod_dist_min,e.lod_lower_border_range=t.lod_lower_border_range,e.lod_upper_border_range=t.lod_upper_border_range,e.cube_reflection_id=t.cube_reflection_id,e.plane_reflection_id=t.plane_reflection_id,t.is_skinning?(ve(e,"a_influence"),me(e,"SKINNED",1),At.skinning_hack?(me(e,"DISABLE_TANGENT_SKINNING",1),me(e,"FRAMES_BLENDING",0)):(me(e,"DISABLE_TANGENT_SKINNING",0),t.frames_blending?me(e,"FRAMES_BLENDING",1):me(e,"FRAMES_BLENDING",0)),me(e,"MAX_BONES",t.max_bones)):(me(e,"SKINNED",0),me(e,"FRAMES_BLENDING",0),me(e,"DISABLE_TANGENT_SKINNING",0)),t.vertex_anim?(me(e,"VERTEX_ANIM",1),At.vert_anim_mix_normals_hack?me(e,"VERTEX_ANIM_MIX_NORMALS_FACTOR",.5):me(e,"VERTEX_ANIM_MIX_NORMALS_FACTOR","u_va_frame_factor")):me(e,"VERTEX_ANIM",0),t.is_skinning&&t.vertex_anim&&et.panic("Skinning and vertex animation are mutually exlusive")}}function Se(e,t,_){if(t.length){for(var r=At.ssao&&_.b4w_enable_ssao,a=it.get_shadow_lamps(t,r),n=e.shaders_info,o=e.lamp_uuid_indexes,i=0,s=0;s<e.shaders_info.node_elements.length;s++){var E=e.shaders_info.node_elements[s];if("LIGHTING_LAMP"==E.id){var c=t[i++%t.length],l=c.light,T=it.get_scene_data(c,_);if("SPOT"==l.type||"POINT"==l.type)var d=Math.cos(l.spot_size/2);if("SPOT"==l.type)var u=l.spot_blend*(1-d);var f=T.light_index,P=a.indexOf(c);E.dirs=[["LAMP_TYPE",l.type],["LAMP_IND",f],["LAMP_SPOT_SIZE",dt.glsl_value(d||.01)],["LAMP_SPOT_BLEND",dt.glsl_value(u||.01)],["LAMP_LIGHT_DIST",dt.glsl_value(l.distance)],["LAMP_USE_SPHERE",l.use_sphere?1:0],["LAMP_SHADOW_MAP_IND",P]]}else if("LAMP"==E.id&&o)for(var A=E.dirs[0][1],S=0;S<t.length;S++){var c=t[S];if(o[c.uuid]==A){var l=c.light;if("SPOT"==l.type||"POINT"==l.type)var d=Math.cos(l.spot_size/2);if("SPOT"==l.type)var u=l.spot_blend*(1-d);E.dirs.push(["LAMP_TYPE",l.type],["LAMP_SPOT_SIZE",dt.glsl_value(d||.01)],["LAMP_SPOT_BLEND",dt.glsl_value(u||.01)],["LAMP_LIGHT_DIST",dt.glsl_value(l.distance)],["LAMP_USE_SPHERE",l.use_sphere?1:0])}}}if(o){var p=0;for(var O in o)p++;e.lamp_light_positions=new Float32Array(3*p),e.lamp_light_directions=new Float32Array(3*p),e.lamp_light_color_intensities=new Float32Array(3*p),dt.set_directive(n,"NUM_LAMP_LIGHTS",p);for(var s=0;s<t.length;s++)pe(e,t[s])}}}function pe(e,t){if(t.uuid in e.lamp_uuid_indexes){var _=e.lamp_uuid_indexes[t.uuid],r=g.j(t.render.world_tsr);e.lamp_light_positions.set(r,3*_),e.lamp_light_directions.set(t.light.direction,3*_),e.lamp_light_color_intensities.set(t.light.color_intensity,3*_)}}function Oe(e,t){for(var _=0;_<t.length;_++){var r=t[_].settings.b4w_vcol_from_name,a=t[_].settings.b4w_vcol_to_name;""!==r&&""!==a&&(e.vertex_colors_usage[r]={generate_buffer:!1,src:[{name:r,mask:7}]})}}function ve(e,t){var _=e.common_attributes;-1==_.indexOf(t)&&_.push(t),e.common_attributes=_.sort()}function me(e,t,_){dt.set_directive(e.shaders_info,t,_)}function Ne(e,t){return dt.get_directive(e.shaders_info,t)}function ge(e,t,_){if("PHYSICS"==e.type)return void("NAVMESH"==e.subtype?e.bufs_data=Pt.submesh_to_bufs_data(t,Pt.DM_DEFAULT,[]):(t.shape_keys.length>0&&Pt.submesh_init_shape_keys(t,t.va_frames[0],_),e.submesh=t));var r=e.draw_mode;if(e.halo&&"PARTICLES"!=e.type&&(t=Pt.extract_halo_submesh(t)),e.water_generated_mesh){var a=e.water_num_cascads,n=e.water_subdivs,o=e.water_detailed_dist;t=Et.generate_cascaded_grid(a,n,o)}var i=Pt.submesh_to_bufs_data(t,r,e.vertex_colors_usage);e.bufs_data=i,mt||e.dynamic_geometry||e.z_sort||e.use_shape_keys||(i.ibo_array=null,i.vbo_source_data.length=0);var s=t.va_frames.length;e.num_vertices=t.base_length*s,Re(e)?Pt.is_indexed(t)?e.num_triangles=t.indices.length/3*s:e.num_triangles=t.base_length/3*s:e.num_triangles=0,vt&&(e.submesh=t)}function Re(e){switch(e.draw_mode){case Pt.DM_DEFAULT:case Pt.DM_TRIANGLES:case Pt.DM_DYNAMIC_TRIANGLES:return!0;default:return!1}}function Ie(e,t,_){var r=t.settings;switch(r.b4w_billboard_align){case"VIEW":me(e,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW");break;case"XY":me(e,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_XY");break;case"YZ":me(e,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_YZ");break;case"ZX":me(e,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_ZX");break;default:et.panic("Wrong billboard align value")}me(e,"BILLBOARD",0);var a=r.b4w_enable_soft_particles&&it.check_obj_soft_particles_accessibility(_,r);me(e,"SOFT_PARTICLES",r.b4w_particles_softness>0&&a&&At.depth_tex_available?1:0),me(e,"SOFT_STRENGTH",dt.glsl_value(r.b4w_particles_softness));var n="WORLD"==r.b4w_coordinate_system?1:0;dt.set_directive(e.shaders_info,"WORLD_SPACE",n)}function be(e,t,_,r,n,o,i,s,E,c,l,T,d){var u=e._object,f=[],P=s.b4w_dynamic_grass;if(!c&&P)return f;for(var S="INSTANCE"==s.b4w_wind_bend_inheritance,p="INSTANCE"==s.b4w_shadow_inheritance,O="INSTANCE"==s.b4w_reflection_inheritance,v=[],m=[],N=0;N<n.length;N++){var R=n[N]._object.render,h=it.clone_render(t);h.billboard=s.b4w_hair_billboard,h.billboard_type=s.b4w_hair_billboard_type,h.billboard_spherical="SPHERICAL"==s.b4w_hair_billboard_geometry,h.dynamic_grass=P,h.is_hair_particles=!0,S?(h.wind_bending=R.wind_bending,h.wind_bending_angle=R.wind_bending_angle,h.wind_bending_freq=R.wind_bending_freq,h.detail_bending_freq=R.detail_bending_freq,h.main_bend_col=R.main_bend_col,h.detail_bending_amp=R.detail_bending_amp,h.branch_bending_amp=R.branch_bending_amp,h.wind_bending_amp=R.wind_bending_amp,h.detail_bend_col=R.detail_bend_col,h.bend_center_only=!1):(h.wind_bending=u.render.wind_bending,h.wind_bending_angle=u.render.wind_bending_angle,h.wind_bending_freq=u.render.wind_bending_freq,h.detail_bending_freq=u.render.detail_bending_freq,h.main_bend_col=u.render.main_bend_col,h.detail_bending_amp=u.render.detail_bending_amp,h.branch_bending_amp=u.render.branch_bending_amp,h.wind_bending_amp=u.render.wind_bending_amp,h.detail_bend_col=u.render.detail_bend_col,h.bend_center_only=!0),p?(h.shadow_cast=R.shadow_cast,h.shadow_cast_only=R.shadow_cast_only,h.shadow_receive=R.shadow_receive):(h.shadow_cast=u.render.shadow_cast,h.shadow_cast_only=u.render.shadow_cast_only,h.shadow_receive=u.render.shadow_receive),O?(h.reflexible=R.reflexible,h.reflexible_only=R.reflexible_only,h.reflective=R.reflective,h.cube_reflection_id=R.cube_reflection_id,h.plane_reflection_id=R.plane_reflection_id,h.reflection_type=R.reflection_type):(h.reflexible=u.render.reflexible,h.reflexible_only=u.render.reflexible_only,h.reflective=u.render.reflective,h.cube_reflection_id=u.render.cube_reflection_id,h.plane_reflection_id=u.render.plane_reflection_id,h.reflection_type=u.render.reflection_type),v.push(h);var Y=i[N];Y||(Y=new Float32Array),T&&I._13(E.seed,l);var L=new Float32Array(3),M=new Float32Array([0,0,0,1]),x=[],y=-1!=I._69(At.loaded_data_version,Dt)&&!s.b4w_initial_rand_rotation&&!s.b4w_hair_billboard,U=4;y&&(U=8);for(var w=0;w<Y.length;w+=U){L[0]=Y[w],L[1]=Y[w+1],L[2]=Y[w+2];var C=Y[w+3]*g.h(R.world_tsr);if(s.b4w_initial_rand_rotation){switch(s.b4w_rotation_type){case"XYZ":var D=new Float32Array([I._39(l),I._39(l),I._39(l)]);b.normalize(D,D);break;case"Z":var D=new Float32Array([0,0,1]);break;default:et.panic("Unsupported random rotation type: "+s.b4w_rotation_type)}var F=s.b4w_rand_rotation_strength;A.setAxisAngle(D,F*(2*Math.PI*I._39(l)-Math.PI),M)}else if(y&&(M.set(Y.subarray(w+4,w+8)),I._28(M,M),!s.use_whole_group))if(s.use_rotation_dupli){var G=g.g(R.world_tsr);A.multiply(M,G,M)}else A.multiply(M,Rt,M);var k=g.s(L,C,M,g.b());x.push(k)}m.push(x)}for(var K={},B=0,N=0;N<n.length;N++)for(var X=n[N]._object.materials,w=0;w<X.length;w++)X[w].name in K?K[X[w].name]++:(K[X[w].name]=1,B++);B=B||1;for(var H={},N=0;N<n.length;N++){var j=n[N],Q=o[N],h=v[N],V={};h.wind_bending&&(V.au_wind_bending_amp=[h.wind_bending_amp],V.au_wind_bending_freq=[h.wind_bending_freq],V.au_detail_bending_freq=[h.detail_bending_freq],V.au_detail_bending_amp=[h.detail_bending_amp],V.au_branch_bending_amp=[h.branch_bending_amp],h.wind_bending_amp=0,h.wind_bending_freq=0,h.detail_bending_freq=0,h.detail_bending_amp=0,h.branch_bending_amp=0);var x=m[N];if(x.length){for(var q=j.data,X=j._object.materials,W=new Array(X.length),J=new Array(X.length),w=0;w<X.length;w++)if(!$e(u,w)&&!Pt.has_empty_submesh(q,w))for(var Z=0;Z<Q.length;Z++){var $=Q[Z],ee=a($),te=X[w];"MAIN"==$?W[w]=ee:"DEBUG_VIEW"==$&&(J[w]=ee),ee.cluster_id=e.b4w_cluster_data.cluster_id;var _e=he(ee,te);if(_e){ee.lights=I.O(d);var re=z(ee,te,q);if(re){"SHADOW"==$&&W[w]&&(ee.use_shadeless=W[w].use_shadeless),ee.draw_mode=Pt.DM_DEFAULT,Ae(ee,h),ee.odd_id_prop=Ze(ee,h,s.uuid),ee.do_not_cull=e.b4w_do_not_cull||s.b4w_dynamic_grass,"MAIN"==ee.type&&(ee.caustics=e.b4w_caustics);var ae="COLOR_ID"!=$&&"SHADOW"!=$&&e.b4w_disable_fogging;me(ee,"DISABLE_FOG",0|ae),"JITTERED"==s.b4w_hair_billboard_type&&(ee.jitter_amp=s.b4w_hair_billboard_jitter_amp,ee.jitter_freq=s.b4w_hair_billboard_jitter_freq),P&&(ee.grass_scale_threshold=s.b4w_dynamic_grass_scale_threshold),S||(delete ee.vertex_colors_usage.a_bending_col_main,delete ee.vertex_colors_usage.a_bending_col_detail);var ne=Pt.extract_submesh(q,w,ee.common_attributes,t.bone_skinning_info,ee.vertex_colors_usage,ee.uv_maps_usage),oe=u.render.world_tsr,ie=!0;if(K[te.name]>1){var se=0;for(var Ee in ne.va_frames)se++;ie=ne.indices.length*x.length*se*K[te.name]>It*B}var ce=At.allow_instanced_arrays_ext&&ie&&"PHYSICS"!=ee.type;if(ce){ee.inst_array_state=s.use_whole_group?ht:bt;var le=Pt.clone_submesh(ne);if(Pt.calc_unit_boundings(ne,le,x),le.instanced_array_data={tsr_array:x,stat_part_em_tsr:oe,static_hair:"STATIC"==t.type,submesh_params:V,part_inh_attrs:{},dyn_grass:P},h.wind_bending&&h.bend_center_only){var Te=b.fromValues(0,0,0);g.B(Te,u.render.world_tsr,Te);for(var de=[],ue=0;ue<x.length;ue++)de.push(Te[0],Te[1],Te[2]);le.instanced_array_data.part_inh_attrs.a_emitter_center={num_comp:3,data:de}}Pt.calc_unit_boundings(ne,ne,x),"STATIC"==t.type&&Pt.bounding_data_apply_transform(le.submesh_bd,oe)}else{var le=Pt.make_propagated_submesh(ne,V,x);le=xe(le,x),h.wind_bending&&h.bend_center_only&&(le=ye(le,u.render.world_tsr))}var fe=Le(s.b4w_vcol_from_name,s.b4w_vcol_to_name,ee,_,!S,q);le=Ue(le,x,u.render.bb_local,r,fe,ee.vertex_colors_usage,H,ce),me(ee,"USE_INSTANCED_PARTCLS",le.instanced_array_data?1:0),Ge(ee),f.push({batch:ee,obj_render:t,batch_render:h,submesh:le,mat_names:[te.name],rel_bpy_objects:[e]})}}}for(var w=0;w<J.length;w++)J[w]&&(J[w].debug_main_batch_id=W[w].id,Ge(J[w]))}}return f}function he(e,t){var _=!0;return"NODES_GLOW"==e.type&&(_=ot.check_material_glow_output(t)),_}function Ye(e,t,_){e.cell_size=new Float32Array(3),e.base_point=new Float32Array(3),e.verts_indices=new Uint32Array(_.length/3),e.octs_indices=new Uint32Array(_.length/3),e.cell_size[0]=(t.max_x-t.min_x)/gt,e.cell_size[1]=(t.max_y-t.min_y)/gt,e.cell_size[2]=(t.max_z-t.min_z)/gt,e.base_point[0]=t.min_x,e.base_point[1]=t.min_y,e.base_point[2]=t.min_z;for(var r=0;r<_.length/3;r++){var a=_[3*r],n=_[3*r+1],o=_[3*r+2],i=I._63((a-e.base_point[0])/e.cell_size[0]),s=I._63((n-e.base_point[1])/e.cell_size[1]),E=I._63((o-e.base_point[2])/e.cell_size[2]);i=I.M(i,0,gt-1),s=I.M(s,0,gt-1),E=I.M(E,0,gt-1),e.verts_indices[r]=r,e.octs_indices[r]=E*Math.pow(gt,2)+s*gt+i}Pt.sort_two_arrays(e.octs_indices,e.verts_indices,Pt.SORT_NUMERIC,!0),e.verts_offsets=new Uint32Array(Math.pow(gt,3));for(var r=0;r<e.octs_indices.length;r++){var c=e.octs_indices[r];e.verts_offsets[c]++}delete e.octs_indices;for(var r=1;r<e.verts_offsets.length;r++)e.verts_offsets[r]+=e.verts_offsets[r-1];return e}function Le(e,t,_,r,a,n){var o=[];if(""!==e&&""!==t){var i=Me(t,_.vertex_colors_usage);if(i.length>0)for(var s=0;s<i.length;s+=3)o.push({emitter_attr:e,emitter_mask:7,particle_attr:i[s],particle_mask:i[s+1],dst_channel_offset:i[s+2]});else Pt.has_attr(_.common_attributes,"a_color")&&t==n.active_vcol_name&&o.push({emitter_attr:e,emitter_mask:7,particle_attr:"a_color",particle_mask:7,dst_channel_offset:0})}return a&&("a_bending_col_main"in r&&o.push({emitter_attr:"a_bending_col_main",emitter_mask:4,particle_attr:"a_bending_col_main",particle_mask:4,dst_channel_offset:0}),"a_bending_col_detail"in r&&o.push({emitter_attr:"a_bending_col_detail",emitter_mask:7,particle_attr:"a_bending_col_detail",particle_mask:7,dst_channel_offset:0})),o}function Me(e,t){var _=[];for(var r in t)for(var a=t[r].src,n=0,o=0;o<a.length;o++){var i=a[o].mask;e==a[o].name&&_.push(r,i,n),n+=I._42(i)}return _}function xe(e,t){e.va_common.au_center_pos=new Float32Array(3*e.base_length);for(var _=t.length,r=e.base_length/_,a=0;a<_;a++)for(var n=t[a],o=3*r*a,i=0;i<r;i++)e.va_common.au_center_pos[o+3*i]=n[0],e.va_common.au_center_pos[o+3*i+1]=n[1],e.va_common.au_center_pos[o+3*i+2]=n[2];return e}function ye(e,t){e.va_common.a_emitter_center=new Float32Array(3*e.base_length);var _=b.fromValues(0,0,0);g.B(_,t,_);for(var r=0;r<e.base_length;r++)e.va_common.a_emitter_center[3*r]=_[0],e.va_common.a_emitter_center[3*r+1]=_[1],e.va_common.a_emitter_center[3*r+2]=_[2];return e}function Ue(e,t,_,r,a,n,o,i){for(var s=!1,E=0;E<a.length;E++){var c=a[E].emitter_attr,l=r.va_common[c];if(l&&l.length>0){s=!0;break}}if(i)var T=e.instanced_array_data.part_inh_attrs;if(s)for(var d=we(_,r.va_frames[0].a_position,t,o),u=e.base_length/t.length,E=0;E<a.length;E++){var f=a[E].particle_attr,P=a[E].particle_mask,c=a[E].emitter_attr,A=a[E].emitter_mask,l=r.va_common[c];switch(f){case"a_bending_col_main":var S=1;break;case"a_bending_col_detail":case"a_color":var S=3;break;default:for(var S=0,p=0;p<n[f].src.length;p++)S+=I._42(n[f].src[p].mask)}if(l&&l.length>0){var O=I._42(A),v=I._42(P),m=A&P,N=I._43(m);if(m!=P&&rt.error("Wrong color extraction from "+c+" to "+f+"."),i){T[f]={num_comp:S,data:[]};for(var p=0;p<t.length;p++)for(var g=d[p],R=g*O,b=0;b<N.length;b++)if(N[b]){var h=I._41(A,b);T[f].data.push(l[R+h])}}else{"a_bending_col_main"!=f&&"a_bending_col_detail"!=f||(e.va_common[f]=new Float32Array(e.base_length*v));for(var p=0;p<t.length;p++){var g=d[p],R=g*O,Y=p*u*S;if(-1!=g)for(var L=0;L<u;L++)for(var M=L*S,b=0;b<N.length;b++)if(N[b]){var h=I._41(A,b),x=a[E].dst_channel_offset+I._41(P,b);e.va_common[f][Y+M+x]=l[R+h]}}}}else e.va_common[f]=new Float32Array(0)}return e}function we(e,t,_,r){var a=new Float32Array(3),n=new Float32Array(3),o=new Uint32Array(_.length);"verts_indices"in r||Ye(r,e,t);for(var i=0;i<_.length;i++){a[0]=_[i][0],a[1]=_[i][1],a[2]=_[i][2];var s=1e10,E=-1,c=I._63((a[0]-r.base_point[0])/r.cell_size[0]),l=I._63((a[1]-r.base_point[1])/r.cell_size[1]),T=I._63((a[2]-r.base_point[2])/r.cell_size[2]);c=I.M(c,0,gt-1),l=I.M(l,0,gt-1),T=I.M(T,0,gt-1);for(var d=T*Math.pow(gt,2)+l*gt+c,u=0==d?0:r.verts_offsets[d-1],f=r.verts_offsets[d],P=u;P<f;P++){var A=r.verts_indices[P];n[0]=t[3*A],n[1]=t[3*A+1],n[2]=t[3*A+2],b.sub(n,a,n);var S=b.sqrLen(n);S<=s&&(s=S,E=A)}if(-1==E)for(var P=0;P<t.length/3;P++){n[0]=t[3*P],n[1]=t[3*P+1],n[2]=t[3*P+2],b.sub(n,a,n);var S=b.sqrLen(n);S<=s&&(s=S,E=P)}o[i]=E}return o}function Ce(e,t,_,r,a){for(var n=t.length,o={},i=0;i<e.length;i+=a){var s=Math.floor(n*I._39(_));o[s]=o[s]||[],o[s].push(e[i],e[i+1],e[i+2],e[i+3]),r&&o[s].push(e[i+4],e[i+5],e[i+6],e[i+7])}for(var s in o)o[s]=new Float32Array(o[s]);return o}function De(e,t,_,r){for(var a={},n=new Float32Array([0,0,0,1]),o=0;o<e.length;o+=r)for(var i=0;i<t.length;i++){var s=b.create(),E=g.h(t[i].render.world_tsr),c=g.j(t[i].render.world_tsr);b.scale(c,E,s);var l=b.clone([e[o],e[o+1],e[o+2]]);a[i]||(a[i]=new Float32Array(e.length)),_&&(a[i][o+4]=n[0]=e[o+4],a[i][o+5]=n[1]=e[o+5],a[i][o+6]=n[2]=e[o+6],a[i][o+7]=n[3]=e[o+7],I._28(n,n),I._61(s,n,s)),b.add(l,s,l),a[i][o]=l[0],a[i][o+1]=l[1],a[i][o+2]=l[2],a[i][o+3]=e[o+3]}return a}function Fe(e,t,_,r,a,n){for(var o={},i=[],s=0;s<t.length;s++)for(var E=t[s],c=E.origin_name||E.name,l=0;l<_.length;l++){var T=_[l];c==T.name&&i.push(T)}_.length!=i.length&&rt.error("dupli weights match failed");for(var s=0;s<e.length;s+=n){var d=function(e){for(var t=[0],_=0;_<e.length;_++){var a=e[_];t[_+1]=t[_]+a.count}for(var n=t[t.length-1],o=n*I._39(r),i=0,_=0;_<t.length;_++)if(o>=t[_]&&o<t[_+1]){i=_;break}return i}(i);o[d]=o[d]||[],o[d].push(e[s],e[s+1],e[s+2],e[s+3]),a&&o[d].push(e[s+4],e[s+5],e[s+6],e[s+7])}for(var d in o)o[d]=new Float32Array(o[d]);return o}function Ge(e){ke(e,function(e){e.id=0,e.id=_t.calc_variable_id(e,0)})}function ke(e,t){for(var _=null,r=null,a=[],n=0;n<e.textures.length;n++){var o=e.textures[n],i=o.canvas_context;i&&(_||(_={}),_[n]=i,o.canvas_context=null);var s=o.video_file;s&&(r||(r={}),r[n]=s,o.video_file=null),a.push(o.num_users),o.num_users=0}var E=e.bounds_local;e.bounds_local=null;var c=e.vaos;e.vaos=null;var l=e.bufs_data;e.bufs_data=null;var T=e.submesh;if(e.submesh=null,t(e),e.bufs_data=l,e.submesh=T,e.vaos=c,e.bounds_local=E,_)for(var n in _)e.textures[n].canvas_context=_[n];if(r)for(var n in r)e.textures[n].video_file=r[n];for(var n=0;n<e.textures.length;n++)e.textures[n].num_users=a[n]}function Ke(e,t,_,r){var n=a("DEBUG_VIEW");if(Be(n,"debug_view.glslv","debug_view.glslf"),n.debug_sphere=!0,n.depth_mask=!0,n.odd_id_prop=Ze(n,e,t),n.debug_sphere_dynamic=_,Ae(n,e),Ge(n),r.use_be){var i=r.bounds_local.be,s=b.create(),E=Et.generate_uv_sphere(16,8,1,s,!1,!1),c=b.fromValues(b.length(i.axis_x),b.length(i.axis_y),b.length(i.axis_z));Pt.scale_submesh_xyz(E,c,s);var l=b.normalize(i.axis_x,Yt),d=b.normalize(i.axis_y,Lt),u=b.normalize(i.axis_z,Mt);!c[0]&&c[1]&&c[2]?b.cross(d,u,l):!c[1]&&c[0]&&c[2]?b.cross(u,l,d):!c[2]&&c[0]&&c[1]&&b.cross(l,d,u);var f=I.W(l,d,u,Ut);T.invert(f,f);var P=A.fromMat3(f,xt);g.q(P,yt),g.r(1,yt),g.t(i.center,yt),Pt.submesh_apply_transform(E,yt)}else var S=r.bounds_local.bs,E=Et.generate_uv_sphere(16,8,S.radius,S.center,!1,!1);return o.t(r.bounds_local,n.bounds_local),Pt.submesh_drop_indices(E,1,!0),E.va_common.a_polyindex=Pt.extract_polyindices(E),ge(n,E),n}function Be(e,t,_){e.shaders_info.vert=t,e.shaders_info.frag=_,dt.set_default_directives(e.shaders_info)}function Xe(e,t,_,r){r=r||"",-1==e.texture_names.indexOf(_)&&(e.textures.push(t),e.texture_names.push(_),e.bpy_tex_names.push(r)),e.shader&&ct.assign_texture_uniforms(e)}function He(e){return e.shaders_info||et.panic("No shaders info for batch "+e.name),e.shader=dt.get_compiled_shader(e.shaders_info),je(e),e.shaders_info.status===dt.VALID&&(ct.assign_uniform_setters(e.shader),ct.assign_attribute_setters(e),ct.assign_texture_uniforms(e),!0)}function je(e){var t=e.shaders_info;if(t.status===dt.VALID){var _=e.shader,r=_.attributes,a=e.bufs_data.pointers;for(var n in r){a[n]||et.panic('missing data for "'+n+'" attribute')}}t.status&dt.INVALID_TEX_IMAGE_UNITS&&rt.error("Texture limit exceeded for shader - "+t.frag+', materials: "'+e.material_names.join(", ")+'". Maximum texture count: '+St.max_texture_image_units+", actual texture count: "+t.texture_count),t.status&dt.INVALID_F_UNIFORM_VECTORS&&rt.error("Fragment uniform limit exceeded for shader - "+t.frag+', materials: "'+e.material_names.join(", ")+'". '),t.status&dt.INVALID_V_UNIFORM_VECTORS&&rt.error("Vertex uniform limit exceeded for shader - "+t.vert+', materials: "'+e.material_names.join(", ")+'". '),t.status&dt.INVALID_VERTEX_ATTRIBS&&rt.error("Vertex attribute limit exceeded for shader - "+t.vert+', materials: "'+e.material_names.join(", ")+'". Maximum attribute count: '+St.max_vertex_attribs+", actual attribute count: "+t.attribute_count),t.status&dt.INVALID_VARYING_VECTORS&&Qe(e),t.status&dt.COMPILATION_ERROR&&rt.error("Shader compilation/linking error: "+t.vert+", "+t.frag+', materials: "'+e.material_names.join(", ")+'"')}function Qe(e){if("MAIN"!=e.type||e.has_nodes||rt.error("Varying limit exceeded for shader - "+e.shaders_info.frag+', materials: "'+e.material_names.join(", ")+'"'),"MAIN"==e.type&&e.has_nodes||"NODES_GLOW"==e.type){var t=0,_=0;e.uv_maps_usage&&(t=I._8(e.uv_maps_usage)),e.vertex_colors_usage&&(_=I._8(e.vertex_colors_usage)),rt.error("Varying limit exceeded for node shader - "+e.shaders_info.frag+", uv: "+t+", vc: "+_+', materials: "'+e.material_names.join(", ")+'"')}}function ze(e,t,_){for(var r=e.scenes_data[0],a=r.batches,n=0;n<a.length;n++)if(a[n].type==_&&-1!=a[n].material_names.indexOf(t))return a[n];return null}function Ve(e,t,_){for(var r=e.scenes_data[0],a=r.batches,n=0;n<a.length;n++)if(a[n].type==_&&!a[n].forked_batch&&-1!=a[n].material_names.indexOf(t))return a[n];return null}function qe(e,t,_){for(var r=e.scenes_data[0],a=r.batches,n=0;n<a.length;n++)if(a[n].type==_&&a[n].forked_batch&&-1!=a[n].material_names.indexOf(t))return a[n];return null}function We(e,t,_,r){for(var a=e.scenes_data[0],n=a.batches,o=0;o<n.length;o++){var i=n[o];if(-1!=i.material_names.indexOf(t)&&(!r||i.type==r)&&_(i))return}}function Je(e,t,_){for(var r=_?it.get_scene_data(e,_):e.scenes_data[0],a=r.batches,n=0;n<a.length;n++)if(a[n].type==t)return a[n];return null}function Ze(e,t,_){var r=_;return"NAVMESH"==e.subtype?r:t.dynamic_geometry?"_odd_id_"+_t.unique_id():r}function $e(e,t){return t>=0&&t<e.mat_inheritance_data.is_disabled.length&&e.mat_inheritance_data.is_disabled[t]}var et=Object(n.a)(e),tt=Object(i.a)(e),_t=Object(s.a)(e),rt=Object(E.a)(e),at=Object(c.a)(e),nt=Object(l.a)(e),ot=Object(d.a)(e),it=Object(u.a)(e),st=Object(f.a)(e),Et=Object(P.a)(e),ct=Object(S.a)(e),lt=Object(p.a)(e),Tt=Object(O.a)(e),dt=Object(v.a)(e),ut=Object(m.a)(e),ft=Object(N.a)(e),Pt=Object(R.a)(e),At=tt.defaults,St=tt.context_limits,pt=tt.scenes,Ot=tt.hmd_params,vt=!1,mt=!1,Nt=!1,gt=20,Rt=new Float32Array([0,0,-Math.sqrt(.5),Math.sqrt(.5)]),It=2e5,bt=1,ht=2,Yt=new Float32Array(3),Lt=new Float32Array(3),Mt=new Float32Array(3),xt=new Float32Array(4),yt=g.b(),Ut=T.create(),wt={},Ct=new Float32Array(24),Dt=[5,4];t.batch_get_debug_storage=_,t.batch_set_debug_storage=r,t.clone_batch=Y,t.generate_main_batches=function(e,t,_,r){var a=(_||[]).map(function(e){return e.light}),n=y(t,e._render.graph,a);n=k(n);for(var o=0;o<n.length;o++){var i=n[o].batch;if(i.material_names=n[o].mat_names,ge(i,n[o].submesh),Se(i,_,e),"STATIC"==n[o].render.type&&"COLOR_ID"!=i.type){var s=_t.unique_name("%meta%"+i.type+"%"+i.material_names.join("%")+"%"),E=it.create_object(s,"MESH");if(it.meta_obj_append_render(E,n[o].render),it.append_scene_data(E,e),it.append_batch(E,e,i),r.push(E),"MAIN"==i.type)for(var c=0;c<n[o].rel_bpy_objects.length;c++){var l=n[o].rel_bpy_objects[c]._object;l.meta_objects.push(E)}}else{var l=n[o].rel_bpy_objects[0]._object;it.append_batch(l,e,i)}}if(At.debug_view){for(var o=0;o<n.length;o++){var T=n[o].render;if("DYNAMIC"==T.type){var l=n[o].rel_bpy_objects[0]._object,i=n[o].batch;if("MAIN"==i.type){for(var d=it.get_scene_data(l,e),u=d.batches,f=!1,c=0;c<u.length;c++)if(u[c].debug_sphere){f=!0;continue}if(f)continue;var P=Ke(T,l.name,!0,i);it.append_batch(l,e,P)}}}for(var o=0;o<r.length;o++){var l=r[o],T=l.render,d=it.get_scene_data(l,e),i=d.batches[0];if("MAIN"==i.type){var P=Ke(T,l.name,!1,i);it.append_batch(l,e,P)}}for(var o=0;o<n.length;o++){var i=n[o].batch;"DEBUG_VIEW"==i.type&&(i.debug_id_color=o)}}for(var o=0;o<t.length;o++)for(var d=it.get_scene_data(t[o]._object,e),u=d.batches,c=0;c<u.length;c++)x(u[c]);for(var o=0;o<r.length;o++)for(var d=it.get_scene_data(r[o],e),u=d.batches,c=0;c<u.length;c++)x(u[c])},t.append_sky_batch_to_world=function(e,t,_){var r=e._render.world_light_set,n=a("MAIN");if(Be(n,"sky.glslv","sky.glslf"),n.is_sky=!0,n.depth_mask=!1,t.procedural_skydome)me(n,"PROCEDURAL_SKYDOME",1),n.draw_proc_sky=!0;else{var o=r.sky_texture_param;Xe(n,lt.find_subs(e._render.graph,ut.SKY).camera.color_attachment,"u_sky"),o&&(me(n,"WO_SKYTEX",1),o.invert&&me(n,"MTEX_NEGATIVE",1),o.use_rgb_to_intensity&&me(n,"MTEX_RGBTOINT",1),me(n,"BLENDTYPE",o.blend_type),o.use_map_blend&&me(n,"WOMAP_BLEND",1),o.use_map_horizon&&me(n,"WOMAP_HORIZ",1),o.use_map_zenith_up&&me(n,"WOMAP_ZENUP",1),o.use_map_zenith_down&&me(n,"WOMAP_ZENDOWN",1)),r.use_sky_blend&&me(n,"WO_SKYBLEND",1),r.use_sky_paper&&me(n,"WO_SKYPAPER",1),r.use_sky_real&&me(n,"WO_SKYREAL",1)}t.reflexible&&(n.reflexible=!0,t.reflexible_only&&(n.reflexible_only=!0)),ve(n,"a_position");var i=Et.generate_fullscreen_quad();if(ge(n,i),x(n),n.do_not_cull=!0,Ge(n),it.append_batch(_,e,n),lt.find_subs(e._render.graph,ut.DEBUG_VIEW)){var s=Y(n);s.type="DEBUG_VIEW",s.subtype="",ue(s),me(s,"DEBUG_VIEW_SPECIAL_SKYDOME",1),i.va_common.a_polyindex=Pt.extract_polyindices(i),ge(s,i),s.debug_main_batch_id=n.id,Ge(s),it.append_batch(_,e,s)}},t.create_forked_batches=function(e,t,_){for(var r=it.get_scene_data(e,_),a=r.batches,n=[],o=lt.find_subs(t,ut.MAIN_PLANE_REFLECT),i=lt.find_subs(t,ut.MAIN_CUBE_REFLECT),s=lt.find_subs(t,ut.OUTLINE_MASK),E=lt.find_subs(t,ut.COLOR_PICKING),c=0;c<a.length;c++){var l=a[c],T=null;"SHADOW"==l.type&&"RECEIVE"==l.subtype&&l.shadow_cast&&(T=Y(l),T.subtype="CAST"),"MAIN"!=l.type&&"PARTICLES"!=l.type||!o&&!i||!l.reflexible||(T=Y(l),T.subtype="REFLECT",T.refractive=!1,T.z_sort&&(T.z_sort=!1,T.depth_mask=!1),T.particles_data=l.particles_data),"COLOR_ID"==l.type&&s&&e.render.outlining&&(E&&e.render.selectable?(T=Y(l),T.subtype="OUTLINE"):l.subtype="OUTLINE"),T&&(T.forked_batch=!0,Ge(T),n.push(T))}for(var d=0;d<n.length;d++)it.append_batch(e,_,n[d])},t.wb_angle_to_amp=B,t.wb_amp_to_angle=X,t.bb_bpy_to_b4w=H,t.name_list_to_node_name=Ee,t.update_batch_material_error=ce,t.update_batch_lights=Se,t.set_lamp_data=pe,t.assign_shadow_receive_dirs=function(e,t,_){if(me(e,"CSM_SECTION1",0),me(e,"CSM_SECTION2",0),me(e,"CSM_SECTION3",0),me(e,"NUM_CAST_LAMPS",0),t){me(e,"NUM_CAST_LAMPS",t.lamp_types.length),At.mac_os_shadow_hack&&me(e,"MAC_OS_SHADOW_HACK",1);for(var r=1;r<t.csm_num;r++)me(e,"CSM_SECTION"+String(r),1);me(e,"SHADOW_TEX_RES",dt.glsl_value(t.csm_resolution)),me(e,"CSM_FADE_LAST_CASCADE",t.fade_last_cascade?1:0),me(e,"CSM_BLEND_BETWEEN_CASCADES",t.blend_between_cascades&&!At.chrome_csm_blend_hack?1:0)}else me(e,"SHADOW_TEX_RES",0),me(e,"CSM_FADE_LAST_CASCADE",0),me(e,"CSM_BLEND_BETWEEN_CASCADES",0)},t.set_batch_directive=me,t.get_batch_directive=Ne,t.update_batch_geometry=ge,t.update_batch_id=Ge,t.update_local_bounds_from_pos=function(e,t){e.bounds_local.bb=o.a(t,0,t.length,e.bounds_local.bb);var _=o.F(e.bounds_local.bb,Ct);e.bounds_local.be=o.z(_,!0),e.bounds_local.bs=o.B(e.bounds_local.be),e.use_be=o.M(e.bounds_local.be,e.bounds_local.bs)},t.apply_shader=Be,t.append_texture=Xe,t.replace_texture=function(e,t,_){var r=e.texture_names.indexOf(_);r>-1&&(e.textures[r]=t)},t.create_shadeless_batch=function(e,t,_){var r=a("MAIN");return _<1&&(r.blend=!0),h.set(t[0],t[1],t[2],_,r.diffuse_color),r.draw_mode=Pt.DM_TRIANGLES,ge(r,e),Be(r,"main.glslv","main_stack.glslf"),me(r,"SHADELESS",1),He(r),r},t.update_shader=He,t.generate_line_batches=function(e,t){for(var _=0;_<t.length;_++){var r=t[_],n=a("LINE");Be(n,"line.glslv","line.glslf"),n.blend=!0,n.do_not_cull=!0;ge(n,Et.generate_line()),x(n),it.append_scene_data(r,e),it.append_batch(r,e,n),He(n)}},t.check_batch_perm_uniform=function(e,t){return!!e.shader.permanent_uniform_setters.length&&!!e.shader.permanent_uniform_setters_table[t]},t.create_depth_pack_batch=function(e){var t=a("DEPTH_PACK");return t.use_backface_culling=!0,t.depth_mask=!1,ge(t,Et.generate_fullscreen_tri()),Be(t,"postprocessing/postprocessing.glslv","postprocessing/depth_pack.glslf"),He(t),t},t.create_postprocessing_batch=function(e){var t=a("POSTPROCESSING");switch(Be(t,"postprocessing/postprocessing.glslv","postprocessing/postprocessing.glslf"),e){case"NONE":me(t,"POST_EFFECT","POST_EFFECT_NONE");break;case"GRAYSCALE":me(t,"POST_EFFECT","POST_EFFECT_GRAYSCALE");break;case"X_BLUR":case"Y_BLUR":me(t,"POST_EFFECT","POST_EFFECT_BLUR");break;case"X_GLOW_BLUR":case"Y_GLOW_BLUR":case"X_BLOOM_BLUR":case"Y_BLOOM_BLUR":me(t,"POST_EFFECT","POST_EFFECT_GLOW_BLUR");break;case"X_DOF_BLUR":case"Y_DOF_BLUR":me(t,"POST_EFFECT","POST_EFFECT_DOF_BLUR");break;case"X_ALPHA_BLUR":case"Y_ALPHA_BLUR":me(t,"POST_EFFECT","POST_EFFECT_ALPHA_BLUR");break;case"X_EXTEND":case"Y_EXTEND":me(t,"POST_EFFECT","POST_EFFECT_EXTEND");break;case"FLIP_CUBEMAP_COORDS":me(t,"POST_EFFECT","FLIP_CUBEMAP_COORDS");break;default:et.panic("Wrong postprocessing effect: "+e)}return me(t,"SHADOW_USAGE","NO_SHADOWS"),t.use_backface_culling=!0,t.depth_mask=!1,ge(t,Et.generate_fullscreen_tri()),He(t),t},t.create_ssao_batch=function(e){var t=a("SSAO");t.depth_mask=!1,t.use_backface_culling=!0,ge(t,Et.generate_fullscreen_tri()),Be(t,"postprocessing/postprocessing.glslv","postprocessing/ssao.glslf"),me(t,"SSAO_QUALITY","SSAO_QUALITY_"+e.ssao_samples),me(t,"SSAO_HEMISPHERE",e.ssao_hemisphere?1:0),me(t,"SHADOW_USAGE","NO_SHADOWS");var _={width:4,height:4,data:new Uint8Array([150,123,254,0,127,3,97,0,164,246,99,0,155,177,14,0,54,83,221,0,2,142,143,0,32,57,79,0,49,160,32,0,57,232,115,0,178,216,203,0,70,196,218,0,241,164,82,0,225,58,85,0,233,88,189,0,144,25,203,0,117,73,12,0])},r=ft.create_texture(ft.TT_RGBA_INT,!1);return r.source="NODE_TEX",ft.update_texture(r,_,0),Xe(t,r,"u_ssao_special_tex"),He(t),t},t.create_ssao_blur_batch=function(e){var t=a("SSAO_BLUR");return t.depth_mask=!1,t.use_backface_culling=!0,ge(t,Et.generate_fullscreen_tri()),Be(t,"postprocessing/postprocessing.glslv","postprocessing/ssao_blur.glslf"),me(t,"SSAO_BLUR_DEPTH",e.ssao_blur_depth?1:0),me(t,"SHADOW_USAGE","NO_SHADOWS"),He(t),t},t.create_coc_batch=function(e){var t=a("COC");switch(t.depth_mask=!1,t.use_backface_culling=!0,ge(t,Et.generate_fullscreen_tri()),Be(t,"postprocessing/postprocessing.glslv","postprocessing/coc.glslf"),me(t,"DEPTH_RGBA",1),e){case"COC_ALL":me(t,"COC_TYPE","COC_ALL");break;case"COC_FOREGROUND":me(t,"COC_TYPE","COC_FOREGROUND");break;case"COC_COMBINE":me(t,"COC_TYPE","COC_COMBINE")}return me(t,"SHADOW_USAGE","NO_SHADOWS"),He(t),t},t.create_dof_batch=function(e){var t=a("DOF");return t.depth_mask=!1,t.use_backface_culling=!0,ge(t,Et.generate_fullscreen_tri()),Be(t,"postprocessing/postprocessing.glslv","postprocessing/dof.glslf"),e.dof_bokeh?me(t,"DOF_TYPE","DOF_BOKEH"):(me(t,"DOF_TYPE","DOF_SIMPLE"),me(t,"DEPTH_RGBA",1)),me(t,"SHADOW_USAGE","NO_SHADOWS"),He(t),t},t.create_outline_batch=function(){var e=a("OUTLINE");return e.depth_mask=!1,e.use_backface_culling=!0,ge(e,Et.generate_fullscreen_tri()),Be(e,"postprocessing/postprocessing.glslv","postprocessing/outline.glslf"),He(e),e},t.create_glow_combine_batch=function(){var e=a("GLOW_COMBINE");return e.depth_mask=!1,e.use_backface_culling=!0,ge(e,Et.generate_fullscreen_tri()),Be(e,"postprocessing/postprocessing.glslv","postprocessing/glow.glslf"),He(e),e},t.create_god_rays_batch=function(e,t,_){var r=a("GOD_RAYS");return r.depth_mask=!1,r.use_backface_culling=!0,ge(r,Et.generate_billboard()),Be(r,"postprocessing/god_rays.glslv","postprocessing/god_rays.glslf"),me(r,"DEPTH_RGBA",e?1:0),me(r,"WATER_EFFECTS",t?1:0),me(r,"STEPS_PER_PASS",dt.glsl_value(_,1)),me(r,"SHADOW_USAGE","NO_SHADOWS"),He(r),r},t.create_god_rays_combine_batch=function(){var e=a("GOD_RAYS_COM");return e.depth_mask=!1,e.use_backface_culling=!0,ge(e,Et.generate_fullscreen_tri()),Be(e,"postprocessing/postprocessing.glslv","postprocessing/god_rays_combine.glslf"),me(e,"SAFARI_CANVAS_ALPHA_HACK",At.safari_canvas_alpha_hack?1:0),He(e),e},t.create_cube_sky_batch=function(e,t){var _=a("SKY");if(_.depth_mask=!1,_.use_backface_culling=!1,ge(_,Et.generate_plane(1,1)),""!=t.sky_ngraph_proxy_id)Be(_,"skybox.glslv","node_skybox.glslf"),me(_,"IS_WORLD",1),ne(_,e);else if(t.procedural_skydome)Be(_,"skybox.glslv","proc_skybox.glslf"),me(_,"WATER_EFFECTS",1);else{if(Be(_,"skybox.glslv","tex_skybox.glslf"),e){var r=e._render.world_light_set;if(r.sky_texture_slot){var n=r.sky_texture_slot.texture,o=ft.get_batch_texture(r.sky_texture_slot,null);Xe(_,o,"u_sky_texture",n.name)}r.sky_texture_param&&me(_,"WO_SKYTEX",1)}t.sky_invert&&me(_,"MTEX_NEGATIVE",1),t.sky_use_rgb_to_intensity&&me(_,"MTEX_RGBTOINT",1),me(_,"BLENDTYPE",t.sky_blend_type),t.sky_use_map_blend&&me(_,"WOMAP_BLEND",1),t.sky_use_map_horizon&&me(_,"WOMAP_HORIZ",1),t.sky_use_map_zenith_up&&me(_,"WOMAP_ZENUP",1),t.sky_use_map_zenith_down&&me(_,"WOMAP_ZENDOWN",1),t.use_sky_blend&&me(_,"WO_SKYBLEND",1),t.use_sky_paper&&me(_,"WO_SKYPAPER",1),t.use_sky_real&&me(_,"WO_SKYREAL",1)}return He(_),_},t.append_cube_sky_batch_to_world=function(e,t){var _=lt.find_subs(e._render.graph,ut.SKY);if(_){var r=_.draw_data[0].bundles[0].batch;it.append_batch(t,e,r)}},t.create_cube_irradiance_batch=function(e,t){var _=a("IRRADIANCE");return _.depth_mask=!1,_.use_backface_culling=!1,ge(_,Et.generate_plane(1,1)),Be(_,"skybox.glslv","irradiance_skybox.glslf"),He(_),_},t.create_cube_roughness_convolution_batch=function(e,t){var _=a("R_CONVOLUTION");return _.depth_mask=!1,_.use_backface_culling=!1,ge(_,Et.generate_plane(1,1)),Be(_,"skybox.glslv","r_convolution_skybox.glslf"),He(_),_},t.create_brdf_batch=function(e,t){var _=a("BRDF");return _.depth_mask=!1,_.use_backface_culling=!1,ge(_,Et.generate_plane(1,1)),Be(_,"postprocessing/postprocessing.glslv","postprocessing/precompute_brdf.glslf"),He(_),_},t.create_antialiasing_batch=function(e){var t=a("ANTIALIASING");return t.depth_mask=!1,t.use_backface_culling=!0,ge(t,Et.generate_fullscreen_tri()),Be(t,"postprocessing/postprocessing.glslv","postprocessing/antialiasing.glslf"),At.quality_aa_method?(me(t,"AA_METHOD","AA_METHOD_FXAA_QUALITY"),me(t,"AA_QUALITY",e.fxaa_quality)):me(t,"AA_METHOD","AA_METHOD_FXAA_LIGHT"),He(t),t},t.create_smaa_batch=function(e){var t=a("SMAA");return ge(t,Et.generate_fullscreen_tri()),Be(t,"postprocessing/smaa.glslv","postprocessing/smaa.glslf"),me(t,"AA_METHOD","AA_METHOD_SMAA_HIGH"),me(t,"SMAA_PASS",e),me(t,"SMAA_PREDICATION",0),me(t,"SMAA_REPROJECTION",0),He(t),t.depth_mask=!1,t.use_backface_culling=!0,t},t.create_compositing_batch=function(){var e=a("COMPOSITING");return e.depth_mask=!1,e.use_backface_culling=!0,ge(e,Et.generate_fullscreen_tri()),Be(e,"postprocessing/postprocessing.glslv","postprocessing/compositing.glslf"),He(e),e},t.create_motion_blur_batch=function(e){var t=a("MOTION_BLUR");return t.use_backface_culling=!0,t.depth_mask=!1,ge(t,Et.generate_fullscreen_tri()),Be(t,"postprocessing/postprocessing.glslv","postprocessing/motion_blur.glslf"),He(t),t},t.create_stereo_batch=function(e){var t=a("STEREO");return t.use_backface_culling=!0,t.depth_mask=!1,ge(t,Et.generate_fullscreen_tri()),Be(t,"postprocessing/postprocessing.glslv","postprocessing/stereo.glslf"),me(t,"ANAGLYPH","ANAGLYPH"===e?1:0),me(t,"SIDEBYSIDE","SIDEBYSIDE"===e?1:0),me(t,"DISTOR_SCALE",Ot.nonwebvr.distor_scale),He(t),t},t.create_luminance_batch=function(){var e=a("LUMINANCE");return e.depth_mask=!1,e.use_backface_culling=!0,ge(e,Et.generate_fullscreen_tri()),Be(e,"postprocessing/postprocessing.glslv","postprocessing/luminance.glslf"),He(e),e},t.create_average_luminance_batch=function(){var e=a("LUMINANCE");return e.depth_mask=!1,e.use_backface_culling=!0,ge(e,Et.generate_fullscreen_tri()),Be(e,"postprocessing/postprocessing.glslv","postprocessing/luminance_av.glslf"),He(e),e},t.create_luminance_truncated_batch=function(e){var t=a("LUMINANCE_X_BLUR");return t.depth_mask=!1,t.use_backface_culling=!0,ge(t,Et.generate_fullscreen_tri()),Be(t,"postprocessing/postprocessing.glslv","postprocessing/luminance_truncated.glslf"),e&&dt.set_directive(t.shaders_info,"ADAPTIVE_BLOOM",1),He(t),t},t.create_bloom_combine_batch=function(e){var t=a("BLOOM");if(t.depth_mask=!1,t.use_backface_culling=!0,ge(t,Et.generate_fullscreen_tri()),Be(t,"postprocessing/postprocessing.glslv","postprocessing/bloom_combine.glslf"),1==e)var _="BLUR_PASS_1";else if(2==e)var _="BLUR_PASS_2";else if(3==e)var _="BLUR_PASS_3";else if(4==e)var _="BLUR_PASS_4";else if(5==e)var _="BLUR_PASS_5";return dt.set_directive(t.shaders_info,"BLUR_PASS_NUM",_),He(t),t},t.create_velocity_batch=function(){var e=a("VELOCITY");return e.depth_mask=!1,e.use_backface_culling=!0,ge(e,Et.generate_fullscreen_tri()),Be(e,"postprocessing/postprocessing.glslv","postprocessing/velocity.glslf"),He(e),e},t.create_anchor_visibility_batch=function(){var e=a("ANCHOR_VISIBILITY");return e.depth_mask=!0,e.use_backface_culling=!0,e.draw_mode=Pt.DM_TRIANGLES,Be(e,"anchors.glslv","anchors.glslf"),ge(e,Et.generate_index(1)),me(e,"ANCHOR_NUM",1),He(e),e.anchor_positions=new Float32Array(3),e},t.create_performance_batch=function(){var e=a("PERFORMANCE");return e.depth_mask=!1,e.use_backface_culling=!0,ge(e,Et.generate_fullscreen_tri()),Be(e,"postprocessing/postprocessing.glslv","postprocessing/performance.glslf"),He(e),e},t.update_anchor_visibility_batch=function(e,t){var _=t.length/3;if(_!=e.anchor_positions.length/3){ge(e,Et.generate_index(_)),me(e,"ANCHOR_NUM",_),He(e)}e.anchor_positions=t},t.get_first_batch=function(e){if(!e.scenes_data.length)return null;var t=e.scenes_data[0];return t.batches.length?t.batches[0]:null},t.find_batch_material_any=ze,t.find_batch_material=Ve,t.find_batch_material_forked=qe,t.iterate_batches_by_mat=We,t.check_batch_type=function(e,t){for(var _=e.scenes_data[0],r=_.batches,a=0;a<r.length;a++)if(r[a].type==t)return!0;return!1},t.get_batch_by_type=Je,t.clear_batch=function(e){var t=e.textures;e.textures=[];for(var _=0;_<t.length;_++)ft.cleanup_unused(t[_]);if(e.textures=t,e.bufs_data&&e.bufs_data.cleanup_gl_data_on_unload&&Pt.cleanup_bufs_data(e.bufs_data),e.cleanup_gl_data_on_unload&&e.vaos.length&&ct.cleanup_vao(e),e.shader&&e.shader.cleanup_gl_data_on_unload&&dt.cleanup_shader(e.shader),e.ngraph_proxy_id){var r=ot.get_ngraph_proxy_cached(e.ngraph_proxy_id);r&&r.cleanup_on_unload&&ot.cleanup_ngraph_proxy(e.ngraph_proxy_id)}},t.set_cleanup_nodemat=function(e,t){if(""!==e.ngraph_proxy_id){var _=ot.get_ngraph_proxy_cached(e.ngraph_proxy_id);_&&(_.cleanup_on_unload=t)}},t.generate_odd_id=Ze,t.cleanup=function(){wt={}},t.set_nodemat_value=function(e,t,_){for(var r=e.node_value_inds,a=0;a<r.length;a+=3)if(r[a]==t)return e.node_values[4*r[a+1]+r[a+2]]=_,!0;return!1},t.set_nodemat_rgb=function(e,t,_,r,a){for(var n=e.node_rgb_inds,o=0;o<n.length;o+=2)if(n[o]==t){var i=n[o+1];return e.node_rgbs[3*i]=_,e.node_rgbs[3*i+1]=r,e.node_rgbs[3*i+2]=a,!0}return!1},t.get_nodemat_value=function(e,t){for(var _=e.node_value_inds,r=0;r<_.length;r+=3)if(_[r]==t)return e.node_values[4*_[r+1]+_[r+2]];return null},t.get_nodemat_rgb=function(e,t,_){for(var r=e.node_rgb_inds,a=0;a<r.length;a+=2)if(r[a]==t){var n=r[a+1];return _[0]=e.node_rgbs[3*n],_[1]=e.node_rgbs[3*n+1],_[2]=e.node_rgbs[3*n+2],_}return null}}var a=_(0),n=_(5),o=_(25),i=_(4),s=_(30),E=_(1),c=_(28),l=_(31),T=_(27),d=_(61),u=_(8),f=_(47),P=_(63),A=_(9),S=_(22),p=_(64),O=_(10),v=_(34),m=_(11),N=_(17),g=_(6),R=_(20),I=_(2),b=_(3),h=_(7),Y=Object(a.a)("__batch",r);t.a=Y},function(e,t,_){"use strict";function r(e,t){function _(){return De||(De=Xe.createFramebuffer()),De}function r(){return Ce||(Ce=Xe.createTexture()),Ce}function a(){return{type:0,source:"",source_id:"",width:0,height:0,compress_ratio:1,anisotropic_filtering:0,source_size:1024,enable_canvas_mipmapping:!1,canvas_context:null,w_target:0,w_texture:null,w_renderbuffer:null,is_movie:!1,vtex_data_id:-1,video_file:null,video_tex_name:"",movie_length:0,fps:0,frame_start:0,frame_offset:0,frame_duration:0,need_resize:!1,scale_fac:1,use_mipmap:!1,mipmap_count:0,seq_video:null,seq_movie_length:0,seq_fps:0,seq_cur_frame:-1,seq_video_played:!1,seq_last_discrete_mark:-1,video_was_stopped:!1,use_auto_refresh:!1,use_cyclic:!1,use_nla:!1,repeat:!0,img_full_filepath:"",img_filepath:"",img_uuid:"",img_source:"",img_name:"",img_comp_method:""}}function v(e,t,_){e.img_uuid=t.uuid,e.img_filepath=t.filepath,e.img_source=t.source,e.img_name=t.name,e.img_full_filepath=Object(O.b)(_+t.filepath),e.img_comp_method=t._comp_method,-1==Ge.textures.indexOf(e)&&(Ge.textures.push(e),Ge.loaded_status.push(!1))}function m(e){var t=a();return t.type=e.type,t.anisotropic_filtering=e.anisotropic_filtering,t.source=e.source,t.source_id=e.source_id,t.width=e.width,t.height=e.height,t.compress_ratio=e.compress_ratio,t.source_size=e.source_size,t.enable_canvas_mipmapping=e.enable_canvas_mipmapping,t.canvas_context=e.canvas_context,t.w_target=e.w_target,t.w_texture=e.w_texture,t.w_renderbuffer=e.w_renderbuffer,t.is_movie=e.is_movie,t.vtex_data_id=e.vtex_data_id,t.video_file=e.video_file,t.video_tex_name=e.video_tex_name,t.movie_length=e.movie_length,t.fps=e.fps,t.frame_start=e.frame_start,t.frame_offset=e.frame_offset,t.frame_duration=e.frame_duration,t.need_resize=e.need_resize,t.scale_fac=e.scale_fac,t.seq_video=e.seq_video,t.seq_movie_length=e.seq_movie_length,t.seq_fps=e.seq_fps,t.seq_cur_frame=e.seq_cur_frame,t.seq_video_played=e.seq_video_played,t.seq_last_discrete_mark=e.seq_last_discrete_mark,t.video_was_stopped=e.video_was_stopped,t.use_auto_refresh=e.use_auto_refresh,t.use_cyclic=e.use_cyclic,t.use_nla=e.use_nla,t.repeat=e.repeat,t.img_filepath=e.img_filepath,t.img_full_filepath=e.img_full_filepath,t.img_uuid=e.img_uuid,t.img_source=e.img_source,t.img_name=e.img_name,t.img_comp_method=e.img_comp_method,t}function N(e,t,_){var r=t.indexOf(".dds")>-1,a=t.indexOf(".pvr")>-1;e.img_comp_method=r?"dds":a?"pvr":"",e.img_filepath=t,e.img_full_filepath=_,e.img_uuid=d._4(),Ge.textures.push(e),Ge.loaded_status.push(!0)}function g(e,t){Xe.bindTexture(e.w_target,e.w_texture);var _=Xe.getTexParameter(e.w_target,Xe.TEXTURE_MAG_FILTER),r=Xe.getTexParameter(e.w_target,Xe.TEXTURE_MIN_FILTER),a=Xe.getTexParameter(e.w_target,Xe.TEXTURE_WRAP_S),n=Xe.getTexParameter(e.w_target,Xe.TEXTURE_WRAP_T);t.w_texture=Xe.createTexture(),Xe.bindTexture(t.w_target,t.w_texture),Xe.texParameteri(t.w_target,Xe.TEXTURE_MAG_FILTER,_),Xe.texParameteri(t.w_target,Xe.TEXTURE_MIN_FILTER,r),Xe.texParameteri(t.w_target,Xe.TEXTURE_WRAP_S,a),Xe.texParameteri(t.w_target,Xe.TEXTURE_WRAP_T,n),Xe.bindTexture(t.w_target,null)}function R(e,_,r){var n=a();if(n.type=e,n.source="NONE",n.use_mipmap=r,e==t.TT_RB_RGBA||e==t.TT_RB_DEPTH||e==t.TT_RB_RGBA_MS||e==t.TT_RB_DEPTH_MS)n.w_renderbuffer=Xe.createRenderbuffer();else{var o=Xe.TEXTURE_2D,i=Xe.createTexture();Xe.bindTexture(o,i),Xe.texParameteri(o,Xe.TEXTURE_MAG_FILTER,Xe.LINEAR),r?Xe.texParameteri(o,Xe.TEXTURE_MIN_FILTER,Fe[xe.texture_min_filter]):Xe.texParameteri(o,Xe.TEXTURE_MIN_FILTER,Xe.LINEAR),Xe.texParameteri(o,Xe.TEXTURE_WRAP_S,Xe.CLAMP_TO_EDGE),Xe.texParameteri(o,Xe.TEXTURE_WRAP_T,Xe.CLAMP_TO_EDGE);var s=B(n),E=X(n),c=j(n);if(e==t.TT_DEPTH)var l=null;else if(e==t.TT_RGBA_FLOAT)var l=new Float32Array([204,204,204,255]);else var l=new Uint8Array([204,204,204,255]);Xe.texImage2D(o,0,E,1,1,0,s,c,l),xe.compared_mode_depth&&_&&Xe.texParameterf(o,Xe.TEXTURE_COMPARE_MODE,Xe.COMPARE_REF_TO_TEXTURE),Xe.bindTexture(o,null),n.w_target=o,n.w_texture=i}return n}function I(e,t,_){if(xe.anisotropic_available){var r=t.b4w_anisotropic_filtering;if("DEFAULT"===r&&(r=_),"OFF"!==r&&xe.anisotropic_filtering){var a=parseFloat(r.split("x")[0]);e.anisotropic_filtering=a}}}function b(e,t){("REPEAT"!=t.extension||t.b4w_shore_dist_map)&&(e.repeat=!1)}function h(e,t){e.is_movie=!0,e.video_tex_name=t.name,e.frame_start=t.frame_start,e.frame_offset=t.frame_offset,e.frame_duration=t.frame_duration,e.use_auto_refresh=t.use_auto_refresh,e.use_cyclic=t.use_cyclic,e.movie_length=t.movie_length,e.use_nla=t.b4w_nla_video,0!=e.frame_offset&&Re.warn('Frame offset for texture "'+t.name+'" has a nonzero value. Can lead to undefined behaviour for mobile devices.')}function Y(e,t,_){var r=t.b4w_source_id,a=t.b4w_source_size;e.source_id=r,e.enable_canvas_mipmapping=t.b4w_enable_canvas_mipmapping;var n=document.createElement("canvas");n.width=a,n.height=a,e.canvas_context=n.getContext("2d"),_ in ke||(ke[_]={}),ke[_][r]=e}function L(e){var t=e.w_texture,_=e.w_target;Xe.bindTexture(_,t);var r=B(e),a=X(e),n=j(e),o=e.canvas_context.canvas;Xe.pixelStorei(Xe.UNPACK_FLIP_Y_WEBGL,!0),Xe.texImage2D(_,0,a,r,n,o),Xe.pixelStorei(Xe.UNPACK_FLIP_Y_WEBGL,!1),e.enable_canvas_mipmapping&&Xe.generateMipmap(_),Xe.bindTexture(_,null),e.width=o.width,e.height=o.height}function M(e){var t=e.w_texture,_=e.w_target;Xe.bindTexture(_,t),Xe.pixelStorei(Xe.UNPACK_FLIP_Y_WEBGL,!0),4!=e.video_file.length?e.need_resize?U(e,e.video_file,e.width*e.scale_fac,e.height*e.scale_fac,!1):Xe.texImage2D(_,0,Xe.RGBA,Xe.RGBA,Xe.UNSIGNED_BYTE,e.video_file):Xe.texImage2D(_,0,Xe.RGBA,1,1,0,Xe.RGBA,Xe.UNSIGNED_BYTE,e.video_file),Xe.bindTexture(_,null)}function x(e){var t=e.w_texture,_=e.w_target;Xe.bindTexture(_,t),Xe.pixelStorei(Xe.UNPACK_FLIP_Y_WEBGL,!0),e.need_resize?U(e,e.seq_video[e.seq_cur_frame],e.width*e.scale_fac,e.height*e.scale_fac,!1):Xe.texImage2D(_,0,Xe.RGBA,Xe.RGBA,Xe.UNSIGNED_BYTE,e.seq_video[e.seq_cur_frame]),Xe.bindTexture(_,null)}function y(){return we||(we=document.createElement("canvas")),we}function U(e,t,a,n,o){o||(D(Xe.TEXTURE_2D),Xe.texImage2D(Xe.TEXTURE_2D,0,Xe.RGBA,Xe.RGBA,Xe.UNSIGNED_BYTE,t)),Xe.bindTexture(Xe.TEXTURE_2D,null);var i=_(),s=r();be.draw_resized_texture(e,a,n,i,s,"NONE")}function w(e,t,a,n){D(Xe.TEXTURE_2D),Xe.texImage2D(Xe.TEXTURE_2D,0,Xe.RGBA,Xe.RGBA,Xe.UNSIGNED_BYTE,t),Xe.bindTexture(Xe.TEXTURE_2D,null);for(var o=0;o<6;o++)Xe.texImage2D(Xe.TEXTURE_CUBE_MAP_POSITIVE_X+o,0,Xe.RGBA,a,a,0,Xe.RGBA,Xe.UNSIGNED_BYTE,null);Xe.bindTexture(e.w_target,null);var i=_();Xe.bindFramebuffer(Xe.FRAMEBUFFER,i);for(var s=r(),o=0;o<6;o++)be.draw_resized_cubemap_texture(e,Xe[He[o]],a,n,s,o);Xe.bindFramebuffer(Xe.FRAMEBUFFER,null),Xe.bindTexture(e.w_target,e.w_texture),Xe.texParameteri(e.w_target,Xe.TEXTURE_MIN_FILTER,Fe[xe.texture_min_filter]),Xe.texParameteri(e.w_target,Xe.TEXTURE_MAG_FILTER,Xe.LINEAR)}function C(e,t,_,r){for(var a=0;a<6;a++){var n=He[a],o=je[a],i=y();i.width=r,i.height=r;var s=i.getContext("2d");s.translate(r/2,r/2),"TEXTURE_CUBE_MAP_POSITIVE_X"==n?(s.rotate(Math.PI/2),s.scale(1,-1)):"TEXTURE_CUBE_MAP_NEGATIVE_X"==n?(s.rotate(Math.PI/2),s.scale(-1,1)):"TEXTURE_CUBE_MAP_POSITIVE_Y"==n||"TEXTURE_CUBE_MAP_POSITIVE_Z"==n?s.scale(1,-1):"TEXTURE_CUBE_MAP_NEGATIVE_Y"!=n&&"TEXTURE_CUBE_MAP_NEGATIVE_Z"!=n||s.scale(-1,1),s.drawImage(t,o[0]*_,o[1]*_,_,_,-r/2,-r/2,r,r),xe.d3d9_canvas_resizing_hack?Xe.texImage2D(Xe[n],0,Xe.RGBA,r,r,0,Xe.RGBA,Xe.UNSIGNED_BYTE,new Uint8Array(s.getImageData(0,0,r,r).data.buffer)):Xe.texImage2D(Xe[n],0,Xe.RGBA,Xe.RGBA,Xe.UNSIGNED_BYTE,i)}}function D(e){Xe.bindTexture(e,null);var t=r();Xe.bindTexture(e,t),k(e)}function F(e,t,_){var r=e.source,a=e.w_texture,n=e.w_target,o=e.img_comp_method,i=e.img_filepath,s=1,E=1;if(Xe.bindTexture(n,a),e.repeat?(Xe.texParameteri(n,Xe.TEXTURE_WRAP_S,Xe.REPEAT),Xe.texParameteri(n,Xe.TEXTURE_WRAP_T,Xe.REPEAT)):(Xe.texParameteri(n,Xe.TEXTURE_WRAP_S,Xe.CLAMP_TO_EDGE),Xe.texParameteri(n,Xe.TEXTURE_WRAP_T,Xe.CLAMP_TO_EDGE)),e.is_movie||"NODE_TEX"==r?Xe.texParameteri(n,Xe.TEXTURE_MIN_FILTER,Xe.LINEAR):Xe.texParameteri(n,Xe.TEXTURE_MIN_FILTER,Fe[xe.texture_min_filter]),e.anisotropic_filtering&&Xe.texParameterf(n,ge.get_aniso().TEXTURE_MAX_ANISOTROPY_EXT,e.anisotropic_filtering),4==t.length){var c=!0;t=new Uint8Array([255*t[0],255*t[1],255*t[2],255*t[3]])}if("IMAGE"==r)if(c)Xe.texImage2D(n,0,Xe.RGBA,1,1,0,Xe.RGBA,Xe.UNSIGNED_BYTE,t),e.width=1,e.height=1;else if(o){var l=me.get_width_height(t,o),T=d.L(l.width)||d.L(l.height);if(V(l.width,l.height))return void Re.error('Image "'+i+'" has unsupported size: '+l.width+"x"+l.height+". Max available: "+ye.max_texture_size+"x"+ye.max_texture_size+".");s=l.width,E=l.height,(T||"pvr"==o)&&(e.need_resize=!0,D(n),s=K(s*e.scale_fac),E=K(E*e.scale_fac)),"dds"==o?me.upload_dds_levels(Xe,ge.get_s3tc(),t,!0):"pvr"==o&&me.upload_pvr_levels(Xe,ge.get_pvr(),t,!0),e.need_resize&&(U(e,null,s,E,!0),Xe.bindTexture(n,a),Xe.generateMipmap(n)),e.width=s,e.height=E,e.compress_ratio=me.get_compress_ratio(t,o)}else{if(Xe.pixelStorei(Xe.UNPACK_FLIP_Y_WEBGL,!0),e.is_movie?xe.seq_video_fallback?(s=t[0].width,E=t[0].height):(s=t.videoWidth,E=t.videoHeight):(s=t.width,E=t.height),e.width=s,e.height=E,V(s,E)&&(Re.warn('Image "'+i+'" has unsupported size: '+s+"x"+E+". Max available: "+ye.max_texture_size+"x"+ye.max_texture_size+". Reduced image size will be used."),e.scale_fac=Math.min(ye.max_texture_size/s,ye.max_texture_size/E),e.need_resize=!0),e.is_movie)if(_ in Ke||(Ke[_]={}),Ke[_][e.video_tex_name]=e,xe.seq_video_fallback){e.seq_video=t,e.seq_movie_length=t.length,e.fps=e.seq_fps*e.movie_length/t.length;var u=t[0]}else{e.video_file=t,e.video_file.loop=e.use_cyclic,e.fps=t.duration?e.movie_length/t.duration:Ie.get_framerate(),Ue.disable_playback_rate_hack||(t.playbackRate=Ie.get_framerate()/e.fps,Ue.clamp_playback_rate_hack&&t.playbackRate>Be&&(t.playbackRate=Be));var u=t;G(e)}else var u=t;if(s=K(e.width*e.scale_fac),E=K(e.height*e.scale_fac),e.need_resize||xe.resize_texture_canvas_hack){var f=y(),P=f.getContext("2d");f.width=s,f.height=E,P.drawImage(u,0,0,e.width,e.height,0,0,s,E),xe.d3d9_canvas_resizing_hack?Xe.texImage2D(n,0,Xe.RGBA,s,E,0,Xe.RGBA,Xe.UNSIGNED_BYTE,new Uint8Array(P.getImageData(0,0,s,E).data.buffer)):Xe.texImage2D(n,0,Xe.RGBA,Xe.RGBA,Xe.UNSIGNED_BYTE,f)}else xe.webgl2||!d.L(e.width)&&!d.L(e.height)?Xe.texImage2D(n,0,Xe.RGBA,Xe.RGBA,Xe.UNSIGNED_BYTE,u):(U(e,u,s,E,!1),e.need_resize=!0);e.width=s,e.height=E,e.is_movie||(Xe.bindTexture(n,a),Xe.generateMipmap(n))}else if("ENVIRONMENT_MAP"==r)if(c){for(var A=0;A<6;A++){var S=He[A];Xe.texImage2D(Xe["TEXTURE_CUBE_MAP_"+S],0,Xe.RGBA,1,1,0,Xe.RGBA,Xe.UNSIGNED_BYTE,t)}e.width=3,e.height=2}else{if(Xe.pixelStorei(Xe.UNPACK_FLIP_Y_WEBGL,!1),t.width%3||t.height%2)return void Re.error('Cubemap Image "'+i+'" has unsupported size: '+t.width+"x"+t.height+". The width must be multiple of three and the height - multiple of two.");var p=t.width/3;if(q(p)){Re.warn('Cubemap Image "'+i+'" has unsupported size: '+t.width+"x"+t.height+". Max available: "+3*ye.max_cube_map_texture_size+"x"+2*ye.max_cube_map_texture_size+". Reduced image size will be used.");var O=ye.max_cube_map_texture_size/p,v=K(p*O);e.need_resize=!0}else{var v=K(p);!xe.webgl2&&V(3*v,2*v)&&(e.need_resize=!0)}e.need_resize||xe.resize_cubemap_canvas_hack?C(e,t,p,v):w(e,t,v,p),Ne.ff_cubemap_out_of_memory()&&(Re.warn("Firefox detected, setting max cubemap size to 256, use canvas for resizing."),C(e,t,p,Oe.NVIDIA_OLD_GPU_CUBEMAP_MAX_SIZE)),e.width=3*v,e.height=2*v,Xe.generateMipmap(n)}else"NODE_TEX"==r&&(Xe.pixelStorei(Xe.UNPACK_FLIP_Y_WEBGL,!1),Xe.texImage2D(n,0,Xe.RGBA,t.width,t.height,0,Xe.RGBA,Xe.UNSIGNED_BYTE,t.data),e.width=t.width,e.height=t.height);Xe.bindTexture(n,null)}function G(e){e.video_file.oncanplay=function(){_e(e)&&M(e)}}function k(e){Xe.texParameteri(e,Xe.TEXTURE_WRAP_S,Xe.CLAMP_TO_EDGE),Xe.texParameteri(e,Xe.TEXTURE_WRAP_T,Xe.CLAMP_TO_EDGE),Xe.texParameteri(e,Xe.TEXTURE_MAG_FILTER,Xe.LINEAR),Xe.texParameteri(e,Xe.TEXTURE_MIN_FILTER,Xe.LINEAR)}function K(e){if(d.L(e)){var t=Math.pow(2,(0|e).toString(2).length);return d.M(t,2,ye.max_texture_size)}return e}function B(e){var _;switch(e.type){case t.TT_RGBA_INT:_=Xe.RGBA;break;case t.TT_RGB_INT:_=Xe.RGB;break;case t.TT_RGBA_FLOAT:_=Xe.RGBA;break;case t.TT_RGB_FLOAT:_=Xe.RGB;break;case t.TT_DEPTH:_=Xe.DEPTH_COMPONENT;break;default:pe.panic("Wrong texture type")}return _}function X(e){var _;switch(e.type){case t.TT_RGBA_INT:_=xe.webgl2?Xe.RGBA8:Xe.RGBA;break;case t.TT_RGB_INT:_=xe.webgl2?Xe.RGB8:Xe.RGB;break;case t.TT_RGBA_FLOAT:_=xe.webgl2?Xe.RGBA32F:Xe.RGBA;break;case t.TT_RGB_FLOAT:_=xe.webgl2?Xe.RGB8:Xe.RGB;break;case t.TT_DEPTH:_=xe.webgl2?H(ye.depth_bits):Xe.DEPTH_COMPONENT;break;default:pe.panic("Wrong texture type")}return _}function H(e){var t;switch(e){case 16:t=Xe.DEPTH_COMPONENT16;break;case 24:t=Xe.DEPTH_COMPONENT24;break;case 32:t=Xe.DEPTH_COMPONENT32F;break;default:t=Xe.DEPTH_COMPONENT24}return t}function j(e){var _;switch(e.type){case t.TT_RGBA_INT:case t.TT_RGB_INT:_=Xe.UNSIGNED_BYTE;break;case t.TT_RGBA_FLOAT:case t.TT_RGB_FLOAT:_=Xe.FLOAT;break;case t.TT_DEPTH:_=Xe.UNSIGNED_INT;break;default:pe.panic("Wrong texture type")}return _}function Q(e){e.w_texture&&Xe.deleteTexture(e.w_texture);var t=Ge.textures.indexOf(e);-1!=t&&(Ge.textures.splice(t,1),Ge.loaded_status.splice(t,1))}function z(e){return!(!e||!e.w_renderbuffer)}function V(e,t){return e>ye.max_texture_size||t>ye.max_texture_size}function q(e){return e>ye.max_cube_map_texture_size}function W(e,t){return t in Ke&&e in Ke[t]?Ke[t][e]:null}function J(e){return e.use_nla}function Z(e){e.video_file?e.video_file.play():e.seq_video&&(e.seq_video_played=!0),e.video_was_stopped=!1}function $(e){e.video_file?e.video_file.pause():e.seq_video&&(e.seq_video_played=!1),e.video_was_stopped=!0}function ee(e){e.video_file?e.video_file.currentTime=e.frame_offset/e.fps:e.seq_video&&(e.seq_cur_frame=re(e,e.frame_offset),x(e))}function te(e){return e.video_file?!e.video_file.paused:!!e.seq_video&&e.seq_video_played}function _e(e){return e.video_file||e.seq_video?!e.video_file||e.video_file.readyState>=2:0}function re(e,t){return Math.round(t*e.seq_movie_length/e.movie_length)}function ae(e,t){if(Ye.is_dynamic(e))return oe(e,t);for(var _=e.meta_objects,r=0;r<_.length;r++){var a=oe(_[r],t);if(a)return a}return null}function ne(e,t,_){if(Ye.is_dynamic(e))ie(e,t,_);else for(var r=e.meta_objects,a=0;a<r.length;a++)ie(r[a],t,_)}function oe(e,t){var _=e.scenes_data;if(_.length)for(var r=_[0],a=r.batches,n=0;n<a.length;n++){var o=a[n];if("MAIN"==o.type||"SKY"==o.type)for(var i=0;i<o.textures.length;i++)if(o.bpy_tex_names[i]==t)return o.textures[i]}return null}function ie(e,t,_){var r=e.scenes_data;if(r.length)for(var a=r[0],n=a.batches,o=0;o<n.length;o++){var i=n[o];if("MAIN"==i.type)for(var s=0;s<i.textures.length;s++){var E=i.bpy_tex_names[s];if(E==t){var c=i.textures[s];i.textures[s]=_,fe(c)}}}}function se(e,t){var _=e.scenes_data;if(_.length)for(var r=_[0],a=r.batches,n=0;n<a.length;n++){var o=a[n];if("MAIN"==o.type)for(var i=0;i<o.textures.length;i++){var s=o.textures[i],E=o.bpy_tex_names[i];-1==t.indexOf(E)&&"NODE_TEX"!=s.source&&t.push(E)}}}function Ee(e){var t=a();t.source="CANVAS",t.width=e.width,t.height=e.height,t.enable_canvas_mipmapping=e.enable_canvas_mipmapping,t.type=e.type;var _=document.createElement("canvas");return _.width=t.width,_.height=t.height,t.canvas_context=_.getContext("2d"),t.w_target=Xe.TEXTURE_2D,t.w_texture=Xe.createTexture(),Xe.bindTexture(Xe.TEXTURE_2D,t.w_texture),t.enable_canvas_mipmapping?Xe.texParameteri(Xe.TEXTURE_2D,Xe.TEXTURE_MIN_FILTER,Fe[xe.texture_min_filter]):Xe.texParameteri(Xe.TEXTURE_2D,Xe.TEXTURE_MIN_FILTER,Xe.LINEAR),Xe.texParameteri(Xe.TEXTURE_2D,Xe.TEXTURE_MAG_FILTER,Xe.LINEAR),Xe.bindTexture(Xe.TEXTURE_2D,null),t}function ce(e,t){var _=t.canvas_context;e.canvas_context.drawImage(_.canvas,0,0),L(e)}function le(e,t,_){for(var r=e.elements,a=e.interpolation,n=0;n<t;n++){var o=n/(t-1),i=de(r,o,!0),s=ue(r,o,!0);i&&s&&("CONSTANT"==a?_.push.apply(_,i.color):Te(_,i,s,o)),s&&!i&&_.push.apply(_,s.color),i&&!s&&_.push.apply(_,i.color)}}function Te(e,t,_,r){if(t==_)e.push.apply(e,t.color);else{var a=Le.linear_interpolation(_.color[0],_.position,t.color[0],t.position,r);e.push(a);var n=Le.linear_interpolation(_.color[1],_.position,t.color[1],t.position,r);e.push(n);var o=Le.linear_interpolation(_.color[2],_.position,t.color[2],t.position,r);e.push(o);var i=Le.linear_interpolation(_.color[3],_.position,t.color[3],t.position,r);e.push(i)}}function de(e,t,_){for(var r=null,a=0;a<e.length;a++){if(_)var n=t-e[a].position;else var n=t-e[a][1][0];if(n>=0)if(r){if(_)var o=t-r.position;else var o=t-e[a][1][0];n<=o&&(r=e[a])}else r=e[a]}return r}function ue(e,t,_){for(var r=null,a=0;a<e.length;a++){if(_)var n=e[a].position-t;else var n=e[a][1][0]-t;if(n>=0)if(r){if(_)var o=r.position-t;else var o=r[1][0]-t;n<=o&&(r=e[a])}else r=e[a]}return r}function fe(e){xe.enable_texture_cache||Pe(e)||Q(e)}function Pe(e){for(var t=he.get_all_objects("ALL",he.DATA_ID_ALL),_=0;_<t.length;_++){var r=t[_];if(Ae(r,e))return!0;for(var a=r.meta_objects,n=0;n<a.length;n++)if(Ae(a[n],e))return!0}return!1}function Ae(e,t){for(var _=0;_<e.scenes_data.length;_++)for(var r=e.scenes_data[_].batches,a=0;a<r.length;a++)for(var n=r[a],o=n.textures,i=0;i<o.length;i++)if(o[i]==t)return!0}function Se(e,t){for(var _=0;_<Ge.textures.length;_++){var r=Ge.textures[_];if(r.img_full_filepath==e&&r.type==t.type&&r.source==t.source&&r.repeat==t.repeat&&r.anisotropic_filtering==t.anisotropic_filtering&&r.use_nla==t.use_nla)return r}return null}var pe=Object(n.a)(e),Oe=Object(o.a)(e),ve=Object(i.a)(e),me=Object(s.a)(e),Ne=Object(E.a)(e),ge=Object(c.a)(e),Re=Object(l.a)(e),Ie=Object(T.a)(e),be=Object(u.a)(e),he=Object(f.a)(e),Ye=Object(P.a)(e),Le=Object(A.a)(e),Me=Object(p.a)(e),xe=ve.defaults,ye=ve.context_limits,Ue=ve.sfx,we=null,Ce=null,De=null;t.TF_NEAREST=0,t.TF_LINEAR=0,t.TF_NEAREST_MIPMAP_NEAREST=0,t.TF_LINEAR_MIPMAP_NEAREST=0,t.TF_NEAREST_MIPMAP_LINEAR=0,t.TF_LINEAR_MIPMAP_LINEAR=0,t.TT_RGBA_INT=10,t.TT_RGB_INT=20,t.TT_RGBA_FLOAT=30,t.TT_RGB_FLOAT=40,t.TT_DEPTH=50,t.TT_RB_RGBA=60,t.TT_RB_DEPTH=70,t.TT_RB_RGBA_MS=80,t.TT_RB_DEPTH_MS=90,t.CURVE_NODES_TEXT_SIZE=128,t.COLORRAMP_TEXT_SIZE=128,t.PART_COLORRAMP_TEXT_SIZE=128;var Fe,Ge={textures:[],loaded_status:[]},ke={},Ke={},Be=2,Xe=null,He=["TEXTURE_CUBE_MAP_POSITIVE_X","TEXTURE_CUBE_MAP_NEGATIVE_X","TEXTURE_CUBE_MAP_POSITIVE_Y","TEXTURE_CUBE_MAP_NEGATIVE_Y","TEXTURE_CUBE_MAP_POSITIVE_Z","TEXTURE_CUBE_MAP_NEGATIVE_Z"],je=[[2,0],[0,0],[2,1],[1,0],[1,1],[0,1]];t.setup_context=function(e){Fe=[e.NEAREST_MIPMAP_NEAREST,e.NEAREST_MIPMAP_LINEAR,e.LINEAR_MIPMAP_NEAREST,e.LINEAR_MIPMAP_LINEAR],t.TF_NEAREST=e.NEAREST,t.TF_LINEAR=e.LINEAR,t.TF_NEAREST_MIPMAP_NEAREST=e.NEAREST_MIPMAP_NEAREST,t.TF_LINEAR_MIPMAP_NEAREST=e.LINEAR_MIPMAP_NEAREST,t.TF_NEAREST_MIPMAP_LINEAR=e.NEAREST_MIPMAP_LINEAR,t.TF_LINEAR_MIPMAP_LINEAR=e.LINEAR_MIPMAP_LINEAR,Xe=e},t.get_canvas_context=function(e,t){return t in ke&&e in ke[t]?ke[t][e].canvas_context:null},t.update_canvas_context=function(e,t){return t in ke&&e in ke[t]&&(L(ke[t][e]),!0)},t.append_img_info=v,t.create_texture=R,t.create_cubemap_texture=function(e,_){var r=Xe.createTexture(),n=Xe.TEXTURE_CUBE_MAP;Xe.bindTexture(n,r),Xe.texParameteri(n,Xe.TEXTURE_MAG_FILTER,Xe.LINEAR),_?Xe.texParameteri(n,Xe.TEXTURE_MIN_FILTER,Fe[xe.texture_min_filter]):Xe.texParameteri(n,Xe.TEXTURE_MIN_FILTER,Xe.LINEAR),Xe.texParameteri(n,Xe.TEXTURE_WRAP_S,Xe.CLAMP_TO_EDGE),Xe.texParameteri(n,Xe.TEXTURE_WRAP_T,Xe.CLAMP_TO_EDGE);for(var o=0;o<6;o++){var i=He[o];Xe.texImage2D(Xe[i],0,Xe.RGBA,e,e,0,Xe.RGBA,Xe.UNSIGNED_BYTE,null)}Xe.bindTexture(n,null);var s=a();return s.type=t.TT_RGBA_INT,s.source="NONE",s.width=3*e,s.height=2*e,s.compress_ratio=1,s.use_mipmap=_,s.w_texture=r,s.w_target=Xe.TEXTURE_CUBE_MAP,s},t.set_cubemap_tex_size=function(e,t){var _=e.w_texture,r=e.w_target;Xe.bindTexture(r,_);for(var a=0;a<6;a++){var n=He[a];Xe.texImage2D(Xe[n],0,Xe.RGBA,t,t,0,Xe.RGBA,Xe.UNSIGNED_BYTE,null)}Xe.bindTexture(r,null),e.width=3*t,e.height=2*t},t.set_filters=function(e,t,_){var r=e.w_target,a=e.w_texture;Xe.bindTexture(r,a),t&&Xe.texParameteri(r,Xe.TEXTURE_MIN_FILTER,t),_&&Xe.texParameteri(r,Xe.TEXTURE_MAG_FILTER,_),Xe.bindTexture(r,null)},t.resize=function(e,_,r){if(_=Math.max(_,1),r=Math.max(r,1),e.width!=_||e.height!=r){switch(e.type){case t.TT_RB_RGBA:Xe.bindRenderbuffer(Xe.RENDERBUFFER,e.w_renderbuffer),Xe.renderbufferStorage(Xe.RENDERBUFFER,Xe.RGB565,_,r),Xe.bindRenderbuffer(Xe.RENDERBUFFER,null);break;case t.TT_RB_DEPTH:Xe.bindRenderbuffer(Xe.RENDERBUFFER,e.w_renderbuffer),Xe.renderbufferStorage(Xe.RENDERBUFFER,H(ye.depth_bits),_,r),Xe.bindRenderbuffer(Xe.RENDERBUFFER,null);break;case t.TT_RB_RGBA_MS:Xe.bindRenderbuffer(Xe.RENDERBUFFER,e.w_renderbuffer),Xe.renderbufferStorageMultisample(Xe.RENDERBUFFER,xe.msaa_samples,Xe.RGBA8,_,r),Xe.bindRenderbuffer(Xe.RENDERBUFFER,null);break;case t.TT_RB_DEPTH_MS:Xe.bindRenderbuffer(Xe.RENDERBUFFER,e.w_renderbuffer),Xe.renderbufferStorageMultisample(Xe.RENDERBUFFER,xe.msaa_samples,H(ye.depth_bits),_,r),Xe.bindRenderbuffer(Xe.RENDERBUFFER,null);break;default:var a=e.w_texture,n=e.w_target;Xe.bindTexture(n,a);var o=B(e),i=X(e),s=j(e);if(e.use_mipmap){if(!xe.webgl2){var E=Math.max(_,r);_=K(E),r=K(E)}e.mipmap_count=Math.round(Math.log(Math.max(_,r))/Math.log(2)+.5)}Xe.texImage2D(n,0,i,_,r,0,o,s,null),Xe.bindTexture(n,null)}if(V(_,r))return void pe.panic('Slink texture "'+e.type+'" has unsupported size: '+_+"x"+r+". Max available: "+ye.max_texture_size+"x"+ye.max_texture_size+".");e.width=_,e.height=r}},t.create_texture_bpy=function(e,_,r,n,o){var i=e.type;if("BLEND"==i)return null;var s=e.image,E=a();if(E.type=t.TT_RGBA_INT,E.width=1,E.height=1,I(E,e,_),b(E,e),s){"IMAGE"==i&&"MOVIE"==s.source&&h(E,e),E.source=i;var c=Object(O.b)(o+s.filepath),l=Se(c,E);if(l)return l;v(E,s,o)}var T=new Uint8Array([204,204,204,255]);switch(i){case"IMAGE":var u=Xe.createTexture(),f=Xe.TEXTURE_2D;Xe.bindTexture(f,u),Xe.texImage2D(f,0,Xe.RGBA,1,1,0,Xe.RGBA,Xe.UNSIGNED_BYTE,T);break;case"NONE":if("NONE"==e.b4w_source_type)return null;var u=Xe.createTexture(),f=Xe.TEXTURE_2D;if(E.source=e.b4w_source_type,"SCENE"==E.source){if(!e.b4w_source_id)return null;var P=e.b4w_source_id,A=d._18("name",P,r);if(!A)return null;E.source_id=e.b4w_source_id,E.source_size=e.b4w_source_size,A._render_to_textures=A._render_to_textures||[],A._render_to_textures.push(E),Xe.bindTexture(f,u),Xe.texImage2D(f,0,Xe.RGBA,1,1,0,Xe.RGBA,Xe.UNSIGNED_BYTE,T)}else"CANVAS"==E.source&&(Y(E,e,n),Xe.bindTexture(f,u));break;case"ENVIRONMENT_MAP":var u=Xe.createTexture(),f=Xe.TEXTURE_CUBE_MAP;Xe.bindTexture(f,u);for(var S=["POSITIVE_X","NEGATIVE_X","POSITIVE_Y","NEGATIVE_Y","POSITIVE_Z","NEGATIVE_Z"],p=0;p<6;p++)Xe.texImage2D(Xe["TEXTURE_CUBE_MAP_"+S[p]],0,Xe.RGBA,1,1,0,Xe.RGBA,Xe.UNSIGNED_BYTE,T);break;default:return Re.error('texture "'+e.name+'" has unsupported type "'+i+'"'),null}return E.w_texture=u,E.w_target=f,"NONE"==i?(E.enable_canvas_mipmapping?Xe.texParameteri(f,Xe.TEXTURE_MIN_FILTER,Fe[xe.texture_min_filter]):Xe.texParameteri(f,Xe.TEXTURE_MIN_FILTER,Xe.LINEAR),E.anisotropic_filtering&&Xe.texParameterf(f,ge.get_aniso().TEXTURE_MAX_ANISOTROPY_EXT,E.anisotropic_filtering),"CANVAS"==E.source&&L(E)):(Xe.generateMipmap(f),Xe.bindTexture(f,null)),E},t.update_texture_canvas=L,t.update_video_texture=M,t.update_seq_video_texture=x,t.update_texture=F,t.calc_pot_size=K,t.is_texture=function(e){return!(!e||!e.w_texture&&!e.w_renderbuffer)},t.is_renderbuffer=z,t.is_float=function(e){return e.type==t.TT_RGBA_FLOAT||e.type==t.TT_RGB_FLOAT},t.get_texture_texel_size=function(e){var _=0;switch(e.type){case t.TT_RGBA_INT:case t.TT_RGB_INT:_=4;break;case t.TT_RGBA_FLOAT:case t.TT_RGB_FLOAT:_=32;break;case t.TT_DEPTH:_=3;break;case t.TT_RB_RGBA:case t.TT_RB_DEPTH:_=2;break;case t.TT_RB_RGBA_MS:_=4*xe.msaa_samples;break;case t.TT_RB_DEPTH_MS:_=3*xe.msaa_samples}return _},t.cleanup=function(){if(!xe.seq_video_fallback)for(var e in Ke)for(var t in Ke[e])Ke[e][t].video_file.pause(),Ke[e][t].video_file.src="",Ke[e][t].video_file.load();Ge.textures.length=0,Ge.loaded_status.length=0,ke={},Ke={}},t.pause=function(){for(var e in Ke)for(var t in Ke[e]){var _=Ke[e][t];te(_)&&$(_)}},t.reset=function(){for(var e in Ke)for(var t in Ke[e]){var _=Ke[e][t];ee(_)}},t.play=function(e){for(var t in Ke)for(var _ in Ke[t]){var r=Ke[t][_];e&&!r.video_was_stopped||Z(r)}},t.get_video_texture=W,t.video_allow_nla=J,t.play_video=Z,t.pause_video=$,t.reset_video=ee,t.set_frame_video=function(e,t,_){if(_ in Ke&&e in Ke[_]){var r=Ke[_][e];return r.video_file?r.video_file.currentTime=t/r.fps:r.seq_video&&(r.seq_cur_frame=t,x(r)),!0}return!1},t.video_is_played=te,t.video_update_is_available=_e,t.video_get_current_frame=function(e){return e.video_file||e.seq_video?e.video_file?Math.round(e.video_file.currentTime*e.fps):e.seq_cur_frame:0},t.video_get_start_frame=function(e){return e.video_file||e.seq_video?e.video_file?e.frame_offset:re(e,e.frame_offset):0},t.video_get_end_frame=function(e){if(!e.video_file&&!e.seq_video)return 0;var t=Math.min(e.frame_duration,e.movie_length-e.frame_offset);return e.video_file?e.frame_offset+t:re(e,e.frame_offset+t)},t.seq_video_get_discrete_timemark=function(e,t){return Math.round(t*e.seq_fps*(Ie.get_framerate()/e.fps))},t.video_get_duration=function(e){return Math.min(e.frame_duration,e.movie_length-e.frame_offset)},t.video_frame_to_seq_frame=re,t.get_canvas_context_by_object=function(e,t){var _=ae(e,t);return _&&"CANVAS"==_.source?_.canvas_context:null},t.get_texture_by_name=ae,t.set_texture_by_name=ne,t.get_texture_names=function(e){var t=[];if(Ye.is_dynamic(e))se(e,t);else for(var _=e.meta_objects,r=0;r<_.length;r++)se(_[r],t);return t},t.share_batch_canvas_textures=function(e){for(var t={},_=0;_<e.length;_++){for(var r=e[_].textures,a=e[_].texture_names,n=[],o=[],i=0;i<r.length;i++){var s=r[i],E=a[i];"CANVAS"==s.source&&(E in t?s=t[E]:(s=Ee(r[i]),ce(s,r[i]),t[E]=s)),n.push(s),o.push(E)}e[_].textures=n}},t.extract_col_ramps_data=function(e,t){for(var _=[],r=0;r<e.length;r++){le(e[r].data.value.color_ramp,t,_)}return new Uint8Array(_.map(function(e){return d.M(255*e,0,255)}))},t.calc_color_ramp_data=le,t.extract_vec_curves_data=function(e,t){for(var _=new Float32Array(3),r=new Float32Array(3),a=[],n=0;n<e.length;n++){for(var o=e[n].data.value,i=[],s=o.curve_mapping.curves_data,E=o.curve_mapping.curve_extend,c=o.curve_mapping.curves_handle_types,l=0;l<s.length;l++){for(var T=E[l],u=s[l],f=[],P=c[l],A=0;A<u.length;A++)f.push([new Float32Array(3),new Float32Array(u[A].concat(0)),new Float32Array(3)]);Le.calchandle_curvemap(f[0],null,f[1],P[0],P[0]);for(var A=1;A<f.length-1;A++)Le.calchandle_curvemap(f[A],f[A-1],f[A+1],P[A],P[A]);if(Le.calchandle_curvemap(f[f.length-1],f[f.length-2],null,P[f.length-1],P[f.length-1]),f.length>2){if("AUTO"==P[0]){S.subtract(f[0][2],f[0][1],_);var p=S.length(_);S.copy(f[1][0],r),r[0]<f[0][1][0]&&(r[0]=f[0][1][0]),S.subtract(r,f[0][1],r);var O=S.length(r);O>1e-8&&(S.scale(r,p/O,r),S.add(f[0][1],r,f[0][2]),S.subtract(f[0][1],r,f[0][0]))}var v=f.length-1;if("AUTO"==P[0]){S.subtract(f[v][0],f[v][1],_);var p=S.length(_);S.copy(f[v-1][2],r),r[0]>f[v][1][0]&&(r[0]=f[v][1][0]),S.subtract(r,f[v][1],r);var O=S.length(r);O>1e-8&&(S.scale(r,p/O,r),S.add(f[v][1],r,f[v][0]),S.subtract(f[v][1],r,f[v][2]))}}for(var v=0;v<f.length-1;v++)Le.correct_bezpart(f[v][1],f[v][2],f[v+1][0],f[v+1][1]);var m=[];if(s.length<=3)var N=Math.round(-t/2),g=Math.round(t/2);else var N=0,g=t;for(var A=N;A<g;A++){var R=A/(g-1),I=de(f,R,!1),b=ue(f,R,!1);if(I&&b)m.push(Le.bezier(R,I[1],I[2],b[0],b[1],.001));else if(b&&!I)if("EXTRAPOLATED"==T){var h=b[1][0]==b[2][0]?b[1][1]:Le.linear(R,b[1],b[2]);m.push(h)}else m.push(b[1][1]);else if(I&&!b)if("EXTRAPOLATED"==T){var h=I[0][0]==I[1][0]?I[1][1]:Le.linear(R,I[0],I[1]);m.push(h)}else m.push(I[1][1])}i.push(m)}a.push(i)}for(var Y=[],A=0;A<a.length;A++)for(var i=a[A],l=0;l<i[0].length;l++){if(i.length<=3)var L=d.M(127.5*(i[0][l]+1),0,255),M=d.M(127.5*(i[1][l]+1),0,255),x=d.M(127.5*(i[2][l]+1),0,255),v=255;else var L=d.M(255*i[0][l],0,255),M=d.M(255*i[1][l],0,255),x=d.M(255*i[2][l],0,255),v=d.M(255*i[3][l],0,255);Y.push(L,M,x,v)}return new Uint8Array(Y)},t.create_color_ramp_texture=function(e,_){var r=R(t.TT_RGBA_INT,!1);return r.source="NODE_TEX",r.repeat=!1,F(r,{width:_,height:e.length/(4*_),data:e}),r},t.change_image=function(e,t,_,r,a){var n=Object(O.b)(a);if("WORLD"!=e.type){var o=Se(n,t);if(o)var i=o;else{var i=m(t);g(t,i),N(i,a,n),F(i,r,0)}ne(e,_,i)}else{var i=t;N(i,a,n),F(i,r,0),Me.update_cube_sky_dim(e,i),Me.update_sky_texture(e)}},t.cleanup_unused=fe,t.get_batch_texture=function(e){return e.texture._render},t.reset_mod=function(){Xe=null},t.get_img_textures=function(){return Ge.textures},t.get_cache_loaded_status=function(e){var t=Ge.textures.indexOf(e);return-1!=t&&Ge.loaded_status[t]},t.set_cache_loaded_status=function(e,t){var _=Ge.textures.indexOf(e);-1!=_&&(Ge.loaded_status[_]=t)}}var a=_(0),n=_(5),o=_(35),i=_(4),s=_(70),E=_(44),c=_(28),l=_(1),T=_(18),d=_(2),u=_(22),f=_(12),P=_(8),A=_(75),S=_(3),p=_(10),O=_(48),v=Object(a.a)("__textures",r);t.a=v},function(e,t,_){"use strict";function r(e,t){function _(){return s}function r(){return++l}function a(){return++T}function o(){return-1!==i.animation.framerate?i.animation.framerate:u}var i=Object(n.a)(e),s=0,E=0,c=[],l=0,T=0,d=[],u=-1,f=0;t.set_timeline=function(e){s=e,E=performance.now();for(var t=0;t<c.length;t++){var _=c[t];s>_.expire_time&&(c.splice(t,1),t--,_.callback())}for(var t=0;t<d.length;t++){var r=d[t],a=1-(r.expire_time-s)/r.duration;a=Math.min(a,1);var n=r.from+a*(r.to-r.from);r.callback(n),1==a&&(d.splice(t,1),t--)}},t.get_timeline=_,t.set_delta=function(e){f=e},t.get_delta=function(){return f},t.set_timeout=function(e,t){var _=r(),a={id:_,callback:e,expire_time:s+(performance.now()-E+t)/1e3};return c.push(a),_},t.clear_timeout=function(e){for(var t=0;t<c.length;t++){if(c[t].id==e){c.splice(t,1);break}}},t.clear_animation=function(e){for(var t=d.length;t--;){if(d[t].id==e){d.splice(t,1);break}}},t.animate=function(e,t,_,r){var n=_/1e3,o=a(),i={id:o,callback:r,from:e,to:t,expire_time:s+n,duration:n};return d.push(i),r(e),o},t.reset=function(e){s=0,E=0,c.length=0,d.length=0,l=0,T=0},t.get_framerate=o,t.set_framerate=function(e){u=e},t.get_frame=function(e){return e*o()}}var a=_(0),n=_(4),o=Object(a.a)("__time",r);t.a=o},function(e,t,_){"use strict";function r(e,t){function _(e,t){for(var r=e.cons_descends,a=0;a<r.length;a++)r[a].physics_settings.use_collision_compound&&t.push(r[a]),_(r[a],t);return null}function r(e,t,_){for(var r=e._physics.bundles,a=0;a<r.length;a++)for(var n=r[a].physics,o=0;o<n.collision_tests.length;o++){var i=n.collision_tests[o];"ANY"!=i.collision_id&&_!=i.collision_id||Oe(i,e,t)}}function a(e,t){for(var _=e._physics.bundles,r=0;r<_.length;r++){var a=_[r].batch;if(a&&a.id==t.id)return!0}return!1}function v(e,t,_){if(Be.is_active(e))switch(t){case Be.IN_LOADED:var r=m(e);r._physics.worker_loaded=!0;var a=Date.now()-performance.now();Be.post_msg(e,Be.OUT_INIT,a,We.max_fps,We.calc_fps?Je.fps_measurement_interval:0);break;case Be.IN_LOG:He.log_raw("URANIUM:",_.slice(1));break;case Be.IN_ERROR:He.error(_);break;case Be.IN_FBMSG:Ke.fbmsg.apply(this,_.slice(1));break;case Be.IN_TRANSFORM:var n=g(_.body_id);n&&I(n,_.time,_.trans,_.quat,_.linvel,_.angvel);break;case Be.IN_PROP_OFFSET:var o=g(_.chassis_hull_body_id);o&&b(o,_.prop_ind,_.trans,_.quat);break;case Be.IN_FLOATER_BOB_TRANSFORM:var i=g(_[1]);i&&h(i,_[2],_[3],_[4]);break;case Be.IN_VEHICLE_SPEED:var n=g(_[1]);n&&(n.vehicle.speed=_[2]);break;case Be.IN_COLLISION:var r=m(e);Y(r,_.body_id_a,_.body_id_b,_.result,null,null,0);break;case Be.IN_COLLISION_POS_NORM:var r=m(e);Y(r,_.body_id_a,_.body_id_b,_.result,_.coll_point,_.coll_norm,_.coll_dist);break;case Be.IN_COLLISION_IMPULSE:var n=g(_[1]);if(n){var s=n.physics;s.col_imp_test_cb&&s.col_imp_test_cb(_[2])}break;case Be.IN_RAY_HIT:case Be.IN_RAY_HIT_POS_NORM:var r=m(e),E=r._physics,c=E.ray_tests[_.id];if(c){var l=_.body_id_hit,T=g(l);t==Be.IN_RAY_HIT?x(c,_.hit_fract,T,_.hit_time,null,null):x(c,_.hit_fract,T,_.hit_time,_.hit_pos,_.hit_norm)}break;case Be.IN_REMOVE_RAY_TEST:he(_.id);break;case Be.IN_PING:var d=et.indexOf(e),u=(_[2]-_[1]).toFixed(3),f=(performance.now()-_[2]).toFixed(3),P=(performance.now()-_[1]).toFixed(3);He.log("Physics #"+d+" Ping: OUT "+u+" ms, IN "+f+" ms, ALL "+P+" ms");break;case Be.IN_FPS:$e=_[1];break;case Be.IN_DEBUG_STATS:var d=et.indexOf(e);He.log("Worker: #"+String(d)),He.log(_[1]);break;default:He.error("Wrong message: "+t)}}function m(e){for(var t=0;t<et.length;t++)if(et[t]==e)return tt[t]}function N(e){for(var t=0;t<tt.length;t++)if(tt[t]==e)return et[t]}function g(e){return _t[e]||null}function R(e){for(var t in _t)if(_t[t]===e)return t;return-1}function I(e,t,_,r,a,n){var o=e.physics;o.curr_time=t;var i=f.h(e.render.world_tsr);f.s(_,i,r,o.curr_tsr),A.copy(a,o.linvel),A.copy(n,o.angvel)}function b(e,t,_,r){var a=e.vehicle.prop_offsets[t];f.s(_,1,r,a)}function h(e,t,_,r){var a=e.floater.bobs[t];ze.set_translation(a,_),ze.set_rotation(a,r),ze.update_transform(a)}function Y(e,t,_,r,a,n,o){for(var i=e._physics.bundles,s=0;s<i.length;s++)for(var E=i[s].physics,c=0;c<E.collision_tests.length;c++){for(var l=E.collision_tests[c],T=l.pairs,d=!1,u=0;u<T.length;u++){var f=T[u];if(f[0]===t&&f[1]===_){l.pair_results[u]=r,d=!0;break}}if(d){var P=L(l);if(a&&l.body_id_src!=t&&M(a,n,o),P)if(l.body_id_src==t)var A=g(_);else var A=g(t);else var A=null;l.callback(P,A,a,n,o)}}}function L(e){for(var t=e.pair_results,_=!1,r=0;r<t.length;r++)_=_||t[r];return _}function M(e,t,_){e[0]=e[0]+t[0]*_,e[1]=e[1]+t[1]*_,e[2]=e[2]+t[2]*_,t[0]*=-1,t[1]*=-1,t[2]*=-1}function x(e,t,_,r,a,n){var o=e.callback;a?o(e.id,t,_,r,a,n):o(e.id,t,_,r)}function y(e,t,_){e&&Be.is_fallback(e)&&Be.post_msg(e,Be.OUT_UPDATE_WORLD,t,_);for(var r=0;r<rt.length;r++){var a=rt[r],n=a.physics;if(n.simulated&&n.curr_time){if(Be.is_fallback(e))var o=t-n.curr_time;else var o=performance.now()/1e3-n.curr_time;o=Math.min(o,10/We.max_fps),o-=1/We.max_fps,Je.no_phy_interp_hack&&(o=0);var i=Et;f.m(n.curr_tsr,o,n.linvel,n.angvel,Et),ze.set_tsr(a,i),ze.update_transform(a),Te(a),a.vehicle&&U(a),a.vehicle&&a.vehicle.steering_wheel&&xe(a),a.vehicle&&a.vehicle.speedometer&&ye(a),a.vehicle&&a.vehicle.tachometer&&Ue(a)}}Be.post_msg_arr(e)}function U(e){for(var t=e.vehicle.props,_=e.render.world_tsr,r=Et,a=0;a<t.length;a++){var n=t[a],o=e.vehicle.prop_offsets[a];f.p(_,o,r),ze.set_tsr(n,r),ze.update_transform(n)}}function w(){return++nt.body}function C(e,t,_){var r=t._render.water_params;if(Be.post_msg(_,Be.OUT_APPEND_WATER,r.water_level),e.water_dynamics){var a={};a.dst_noise_scale0=e.dst_noise_scale0,a.dst_noise_scale1=e.dst_noise_scale1,a.dst_noise_freq0=e.dst_noise_freq0,a.dst_noise_freq1=e.dst_noise_freq1,a.dir_min_shore_fac=e.dir_min_shore_fac,a.dir_freq=e.dir_freq,a.dir_noise_scale=e.dir_noise_scale,a.dir_noise_freq=e.dir_noise_freq,a.dir_min_noise_fac=e.dir_min_noise_fac,a.dst_min_fac=e.dst_min_fac,a.waves_hor_fac=e.waves_hor_fac;var n=r.waves_height,o=r.waves_length;if(r.shoremap_image){var i=r.shoremap_size[0],s=r.shoremap_size[1],E=r.shoremap_center[0],c=r.shoremap_center[1],l=r.max_shore_dist,T=r.shoremap_tex_size;Be.post_msg(_,Be.OUT_ADD_WATER_WRAPPER,a,i,s,E,c,l,n,o,T,t._render.shore_distances)}else Be.post_msg(_,Be.OUT_ADD_WATER_WRAPPER,a,0,0,0,0,0,n,o,0,null)}}function D(e,t,_){if(_)var r=e.physics.body_id;else var r=w();var a=t.submesh;return{body_id:r,submesh:a,positions:a.va_frames[0].a_position,indices:a.indices||null,trans:f.j(e.render.world_tsr),friction:t.friction,restitution:t.elasticity,collision_id:t.collision_id,collision_id_num:k(t.collision_id),collision_margin:t.collision_margin,collision_group:t.collision_group,collision_mask:t.collision_mask}}function F(e,t,_){var r=D(e,t);Be.post_msg(_,Be.OUT_APPEND_STATIC_MESH_BODY,r.body_id,r.positions,r.indices,r.trans,r.friction,r.restitution,r.collision_id_num,r.collision_margin,r.collision_group,r.collision_mask);var a=K(r.body_id,"STATIC_MESH");return a.collision_id=r.collision_id,a.collision_id_num=r.collision_id_num,a}function G(e,t,_){var r=D(e,t,!0);Be.post_msg(_,Be.OUT_UPDATE_STATIC_MESH_BODY,r.body_id,r.positions,r.indices,r.trans,r.friction,r.restitution,r.collision_id_num,r.collision_margin,r.collision_group,r.collision_mask)}function k(e){var t=at.indexOf(e);return-1==t?(at.push(e),at.length-1):t}function K(e,t){return{body_id:e,type:t,mass:0,is_ghost:!1,simulated:!0,is_vehicle:!1,is_character:!1,is_floater:!1,cons_id:null,collision_id:"",collision_id_num:0,collision_callbacks:{},collision_tests:[],col_imp_test_cb:null,curr_time:0,curr_tsr:new Float32Array([0,0,0,1,0,0,0,1]),linvel:new Float32Array(3),angvel:new Float32Array(3),cached_trans:new Float32Array(3),cached_quat:new Float32Array(4),navmesh:null}}function B(e,t,_){var r=w(),a=t.submesh,n=a.va_frames[0].a_position,o=a.indices||null,i=t.collision_id,s=k(i),E=t.collision_margin,c=t.collision_group,l=t.collision_mask,T=f.j(e.render.world_tsr);Be.post_msg(_,Be.OUT_APPEND_GHOST_MESH_BODY,r,n,o,T,s,E,c,l);var d=K(r,"STATIC_MESH");return d.is_ghost=!0,d.collision_id=i,d.collision_id_num=s,d}function X(e,t,_){var r=e.render,a=e.physics_settings,n=a.physics_type;if(_)var o=R(e);else var o=w();if(!(o<=0)){if("CAMERA"==e.type)var i=a.use_collision_bounds?a.collision_bounds_type:"BOX",s=V(i,r),E=.5,c=0;else if("EMPTY"==e.type)var i="EMPTY",s=null,E=0,c=0;else{var i=a.use_collision_bounds?a.collision_bounds_type:"BOX",s=V(i,r),l=f.h(r.world_tsr);1!=l&&q(s,i,l);var E=r.friction,c=r.elasticity}var T=W(s);return{body_id:o,trans:f.j(r.world_tsr),quat:f.g(r.world_tsr),is_ghost:a.use_ghost,disable_sleeping:a.use_sleep,mass:a.mass,velocity_min:a.velocity_min,velocity_max:a.velocity_max,damping:a.damping,rotation_damping:a.rotation_damping,collision_id:e.collision_id,collision_id_num:k(e.collision_id),collision_margin:a.collision_margin,collision_group:a.collision_group,collision_mask:a.collision_mask,size:r.bs_local.radius,worker_bounding:T,correct_bound_offset:e.correct_bounding_offset,restitution:c,friction:E,bounding_type:i,physics_type:n,comp_children_params:z(r,t,i,T)}}}function H(e,t,_){var r=X(e,t,!1);Be.post_msg(_,Be.OUT_APPEND_BOUNDING_BODY,r.body_id,r.trans,r.quat,r.physics_type,r.is_ghost,r.disable_sleeping,r.mass,r.velocity_min,r.velocity_max,r.damping,r.rotation_damping,r.collision_id_num,r.collision_margin,r.collision_group,r.collision_mask,r.bounding_type,r.worker_bounding,r.size,r.friction,r.restitution,r.comp_children_params,r.correct_bound_offset),_t[r.body_id]=e,rt.push(e);var a=K(r.body_id,"BOUNDING");return a.type=r.physics_type,a.mass=r.mass,a.is_ghost=r.is_ghost,a.collision_id=r.collision_id,a.collision_id_num=r.collision_id_num,a}function j(e,t,_){var r=X(e,t,!0);Be.post_msg(_,Be.OUT_UPDATE_BOUNDING_BODY,r.body_id,r.trans,r.quat,r.physics_type,r.is_ghost,r.disable_sleeping,r.mass,r.velocity_min,r.velocity_max,r.damping,r.rotation_damping,r.collision_id_num,r.collision_margin,r.collision_group,r.collision_mask,r.bounding_type,r.worker_bounding,r.size,r.friction,r.restitution,r.comp_children_params,r.correct_bound_offset)}function Q(e,t){var _=w(),r=K(_,"NAVMESH"),a=Xe.get_scene_data(e,t),n=a.batches;r.navmesh=null;for(var o=0;o<n.length;o++){var i=n[o];if("PHYSICS"==i.type){r.navmesh=Ve.navmesh_build_from_bufs_data(i.bufs_data);break}}return r}function z(e,t,_,r){if(!t.length)return[];var a=[],n={};n.quat=new Float32Array([0,0,0,1]),n.trans=new Float32Array(3),n.worker_bounding=r,n.bounding_type=_,a.push(n);var o=f.o(e.world_tsr,Et),i=st,s=f.g(e.world_tsr);l.invert(s,i);for(var E=0;E<t.length;E++){var c={},T=t[E],d=T.physics_settings.collision_bounds_type,u=new Float32Array(4),P=new Float32Array(3),A=f.j(T.render.world_tsr),S=f.g(T.render.world_tsr);f.B(A,o,P),l.multiply(i,S,u),c.trans=P,c.quat=u,c.bounding_type=d,c.worker_bounding=W(V(d,T.render)),a.push(c)}return a}function V(e,t){switch(e){case"BOX":var _=t.bb_local;break;case"CYLINDER":var _=t.bcyl_local;break;case"CONE":var _=t.bcon_local;break;case"SPHERE":var _=t.bs_local;break;case"CAPSULE":var _=t.bcap_local}return _}function q(e,t,_){switch(t){case"BOX":e.min_x*=_,e.max_x*=_,e.min_y*=_,e.max_y*=_,e.min_z*=_,e.max_z*=_;break;case"CYLINDER":case"CONE":case"CAPSULE":e.height*=_,e.radius*=_;break;case"SPHERE":e.radius*=_}}function W(e){if(!e)return null;var t=e,_={};return"number"==typeof t.min_x&&(_.min_x=t.min_x),"number"==typeof t.min_y&&(_.min_y=t.min_y),"number"==typeof t.min_z&&(_.min_z=t.min_z),"number"==typeof t.max_x&&(_.max_x=t.max_x),"number"==typeof t.max_y&&(_.max_y=t.max_y),"number"==typeof t.max_z&&(_.max_z=t.max_z),"object"==typeof t.center&&(_.center=t.center),"number"==typeof t.radius&&(_.radius=t.radius),"number"==typeof t.height&&(_.height=t.height),_}function J(e,t){var _=e.physics.body_id;if(we(e)){e.vehicle.type=lt;var r=e.vehicle.suspension_compression,a=e.vehicle.suspension_stiffness,n=e.vehicle.suspension_damping,o=e.vehicle.wheel_friction,i=e.vehicle.max_suspension_travel_cm;Be.post_msg(t,Be.OUT_APPEND_CAR,_,r,a,n,o,i)}else if(Ce(e)){e.vehicle.type=Tt;var s=e.vehicle.floating_factor,E=e.vehicle.water_lin_damp,c=e.vehicle.water_rot_damp;Be.post_msg(t,Be.OUT_APPEND_BOAT,_,s,E,c)}if(e.vehicle.props){var l=e.vehicle.props;switch(e.vehicle.type){case lt:Z(l[0],e,_,!0,t),Z(l[1],e,_,!0,t),Z(l[2],e,_,!1,t),Z(l[3],e,_,!1,t);break;case Tt:for(var T=0;T<l.length;T++)Z(l[T],e,_,!1,t)}}}function Z(e,t,_,r,a){var n=f.j(e.render.world_tsr),o=f.o(t.render.world_tsr,Et),i=new Float32Array(3);switch(f.B(n,o,i),t.vehicle.type){case lt:var s=t.vehicle_settings,E=s.suspension_rest_length,c=s.roll_influence,l=e.render.bb_local,T=(l.max_z-l.min_z)/2;Be.post_msg(a,Be.OUT_ADD_CAR_WHEEL,_,i,E,c,T,r);break;case Tt:Be.post_msg(a,Be.OUT_ADD_BOAT_BOB,_,i,e.bob_synchronize_pos)}}function $(e,t){var _=e.render,r=e.physics,a=_.bb_local.max_z-_.bb_local.min_z,n=r.body_id,o=e.character_settings,i=o.walk_speed,s=o.run_speed,E=o.step_height,c=o.jump_strength,l=o.waterline,T=ee(e);Be.post_msg(t,Be.OUT_APPEND_CHARACTER,n,T,a,i,s,E,c,l),r.is_character=!0}function ee(e){var t=e.render,_=f.g(t.world_tsr),r=ot,a=it;switch(e.type){case"CAMERA":r[0]=0,r[1]=-1,r[2]=0,A.transformQuat(r,_,r),a[0]=0,a[1]=0,a[2]=-1;break;case"MESH":r[0]=0,r[1]=0,r[2]=1,A.transformQuat(r,_,r),a[0]=0,a[1]=0,a[2]=1;break;case"EMPTY":r[0]=0,r[1]=1,r[2]=0,A.transformQuat(r,_,r),a[0]=0,a[1]=1,a[2]=0}r[1]=0,A.normalize(r,r);var n=A.dot(r,a),o=-r[0]*a[2]>0?-1:1;return Math.acos(n)*o}function te(e,t){var _=e.floater.floating_factor,r=e.floater.water_lin_damp,a=e.floater.water_rot_damp,n=e.physics.body_id;if(Be.post_msg(t,Be.OUT_APPEND_FLOATER,n,_,r,a),e.floater.bobs)for(var o=e.floater.bobs,i=0;i<o.length;i++){var s=o[i],E=f.j(s.render.world_tsr),c=f.o(e.render.world_tsr,Et),l=new Float32Array(3);f.B(E,c,l),Be.post_msg(t,Be.OUT_ADD_FLOATER_BOB,n,l,s.bob_synchronize_pos)}e.physics.is_floater=!0}function _e(e){return Boolean(e._physics)}function re(e){return Boolean(e.physics)}function ae(e){if(!ne(e))for(var t=0;t<e.physics_constraints.length;t++){var _=e.physics_constraints[t],r=_.target,a=_.pivot_type;if(r.physics){var n=oe(_),o=ie(_);"HINGE"==a&&l.rotateY(o,Math.PI/2,o);var i=f.l(Et);i=f.t(n,i),i=f.q(o,i);var s=f.p(e.render.world_tsr,i,Et),E=f.o(r.render.world_tsr,ct),c=f.p(E,s,E),T=f.j(c),d=f.g(c),u=se(_);Ee(a,e,n,o,r,T,d,u,null,null)}}}function ne(e){return e.physics&&e.physics.cons_id}function oe(e){return new Float32Array([e.pivot_x,e.pivot_y,e.pivot_z])}function ie(e){var t=new Float32Array([e.axis_x,e.axis_y,e.axis_z]);return P.Y(t,new Float32Array(4))}function se(e){var t={};return t.use_limit_x=e.use_limit_x,t.use_limit_y=e.use_limit_y,t.use_limit_z=e.use_limit_z,t.use_angular_limit_x=e.use_angular_limit_x,t.use_angular_limit_y=e.use_angular_limit_y,t.use_angular_limit_z=e.use_angular_limit_z,t.limit_max_x=e.limit_max_x,t.limit_min_x=e.limit_min_x,t.limit_max_y=e.limit_max_y,t.limit_min_y=e.limit_min_y,t.limit_max_z=e.limit_max_z,t.limit_min_z=e.limit_min_z,t.limit_angle_max_x=e.limit_angle_max_x,t.limit_angle_min_x=e.limit_angle_min_x,t.limit_angle_max_y=e.limit_angle_max_y,t.limit_angle_min_y=e.limit_angle_min_y,t.limit_angle_max_z=e.limit_angle_max_z,t.limit_angle_min_z=e.limit_angle_min_z,t}function Ee(e,t,_,r,a,n,o,i,s,E){var c=le(),l=t.physics.body_id,T=a.physics.body_id,d=ce(l);Be.post_msg(d,Be.OUT_APPEND_CONSTRAINT,c,e,i,l,_,r,T,n,o,s,E),t.physics.cons_id=c}function ce(e){for(var t=0;t<tt.length;t++)for(var _=tt[t],r=_._physics.bundles,a=0;a<r.length;a++){var n=r[a].physics;if(n.body_id==e)return et[t]}return null}function le(){return nt.constraint++,nt.constraint.toString(16)}function Te(e){if(fe(e)&&Pe(e)){var t=e.physics,_=e.render,r=Be.get_msg_cache(Be.OUT_SET_TRANSFORM);r.body_id=t.body_id;var a=f.i(_.world_tsr,r.trans),n=f.f(_.world_tsr,r.quat);A.copy(a,t.cached_trans),l.copy(n,t.cached_quat),"DYNAMIC"==t.type&&l.identity(r.quat);var o=ce(t.body_id);Be.post_msg(o,Be.OUT_SET_TRANSFORM)}for(var i=e.cons_descends,s=0;s<i.length;s++)Te(i[s])}function de(e,t){var r=e.physics_settings,a=N(t),n=[];r.use_collision_compound&&_(e,n),(we(e)||Ce(e)||e.is_character||Fe(e)||e.use_obj_physics)&&(De(e)||j(e,n,a))}function ue(e,t){for(var _=(e.physics_settings,N(t)),a=e.scenes_data[0],n=a.batches,o=0;o<n.length;o++){var i=n[o];"PHYSICS"==i.type&&(qe.update_batch_geometry(n[o],n[o].submesh,e.render.shape_keys_values),i.use_ghost?He.error("The function is not implemented for ghost objects yet"):G(e,i,_),r(t,_,e.physics.collision_id))}}function fe(e){var t=e.physics;return!!t&&(0===t.mass||(!0===t.is_ghost||(!1===t.simulated||"RIGID_BODY"!==t.type&&"DYNAMIC"!==t.type)))}function Pe(e){var t=f.i(e.render.world_tsr,ot),_=f.f(e.render.world_tsr,st);return t[0]!=e.physics.cached_trans[0]||t[1]!=e.physics.cached_trans[1]||t[2]!=e.physics.cached_trans[2]||_[0]!=e.physics.cached_quat[0]||_[1]!=e.physics.cached_quat[1]||_[2]!=e.physics.cached_quat[2]||_[3]!=e.physics.cached_quat[3]}function Ae(e,t,_,r,a){var n=a||new Float32Array(3),o=f.g(e.render.world_tsr);return n[0]=t,n[1]=_,n[2]=r,A.transformQuat(n,o,n)}function Se(e,t,_,r,a){var n=ot;a?(n[0]=t,n[1]=_,n[2]=r):Ae(e,t,_,r,n);var o=e.physics.body_id,i=ce(o);Be.post_msg(i,Be.OUT_APPLY_CENTRAL_FORCE,o,n[0],n[1],n[2])}function pe(e,t,_,r){var a=ot;Ae(e,t,_,r,a);var n=e.physics.body_id,o=ce(n);Be.post_msg(o,Be.OUT_APPLY_TORQUE,n,a[0],a[1],a[2])}function Oe(e,t,_){var r=e.pairs,a=e.pair_results,n=e.body_id_src,o=[];be(e.collision_id,t,o,null);for(var i=0;i<o.length;i++){var s=o[i];n<s&&!ve(r,n,s)?(r.push([n,s]),a.push(!1)):n>s&&!ve(r,s,n)&&(r.push([s,n]),a.push(!1))}Be.post_msg(_,Be.OUT_ACTIVATE,n),Be.post_msg(_,Be.OUT_APPEND_COLLISION_TEST,r,e.calc_pos_norm)}function ve(e,t,_){for(var r=0;r<e.length;r++)if(e[r][0]==t&&e[r][1]==_)return!0;return!1}function me(e,t,_){for(var r=e._physics.bundles,a=_,n=0;n<r.length;n++)for(var o=r[n].physics,i=0;i<o.collision_tests.length;i++)for(var s=o.collision_tests[i],E=0;E<s.pairs.length;E++)for(var c=s.pairs[E],l=0;l<a.length;l++){var T=a[l];c[0]==T[0]&&c[1]==T[1]&&(a.splice(l,1),l--)}a.length&&Be.post_msg(t,Be.OUT_REMOVE_COLLISION_TEST,a)}function Ne(e,t,_){for(var r=e._physics.bundles,a=[],n=0;n<r.length;n++)for(var o=r[n].physics,i=0;i<o.collision_tests.length;i++)for(var s=o.collision_tests[i],E=0;E<s.pairs.length;E++){var c=s.pairs[E],l=s.pair_results[E];if(c[0]==_||c[1]==_){if(s.pairs.splice(E,1),s.pair_results.splice(E,1),E--,l&&!L(s)){var T=A.set(0,0,0,ot);s.callback(!1,null,T,T,0)}a.push(c)}}a.length&&Be.post_msg(t,Be.OUT_REMOVE_COLLISION_TEST,a)}function ge(e){if(Re(e)){var t=e.physics,_=ce(t.body_id);Be.post_msg(_,Be.OUT_CLEAR_COLLISION_IMPULSE_TEST,t.body_id),t.col_imp_test_cb=null}}function Re(e){return!(!e.physics||!e.physics.col_imp_test_cb)}function Ie(){return++nt.ray_test}function be(e,t,_,r){_||r||Ge.panic("At least one destination required");for(var a=0;a<t._physics.bundles.length;a++){var n=t._physics.bundles[a];if("ANY"==e||n.physics.collision_id==e&&"NAVMESH"!=n.physics.type){var o=n.physics.body_id;_&&-1==_.indexOf(o)&&_.push(o),r&&(r[o]=0)}}}function he(e){var t=Ye(e),_=Le(e),r=t._physics;r.ray_tests[e]&&(delete r.ray_tests[e],r.ray_tests_arr.splice(r.ray_tests_arr.indexOf,1),Be.post_msg(_,Be.OUT_REMOVE_RAY_TEST,e))}function Ye(e){for(var t=0;t<tt.length;t++){var _=tt[t];if(_._physics.ray_tests[e])return _}return null}function Le(e){for(var t=0;t<tt.length;t++){if(tt[t]._physics.ray_tests[e])return et[t]}return null}function Me(e,t,_){if(t.steering_wheel){var r=e.physics.body_id,a=t.engine_force*t.force_max,n=t.brake_force*t.brake_max,o=-t.steering*t.steering_max*2*Math.PI/t.steering_ratio;switch(t.inverse_control&&(o*=-1),t.type){case lt:Be.post_msg(_,Be.OUT_UPDATE_CAR_CONTROLS,r,a,n,o);break;case Tt:Be.post_msg(_,Be.OUT_UPDATE_BOAT_CONTROLS,r,a,n,o)}}}function xe(e){var t=e.vehicle,_=t.steering_wheel;if(_){var r=e.vehicle.steering_wheel_tsr,a=e.vehicle.steering_wheel_axis;f.p(e.render.world_tsr,r,_.render.world_tsr);var n=ot;f.w(a,e.render.world_tsr,n);var o=st;l.setAxisAngle(n,-t.steering*t.steering_max*2*Math.PI,o);var i=f.g(_.render.world_tsr);l.multiply(o,i,i),ze.update_transform(_)}}function ye(e){var t=e.vehicle,_=t.speedometer;if(_){var r=e.vehicle.speedometer_tsr,a=e.vehicle.speedometer_axis;f.p(e.render.world_tsr,r,_.render.world_tsr);var n=ot;f.w(a,e.render.world_tsr,n);var o=st,i=Math.abs(t.speed)*t.speed_ratio;i>t.max_speed_angle&&(i=t.max_speed_angle),l.setAxisAngle(n,-i,o);var s=f.g(_.render.world_tsr);l.multiply(o,s,s),l.normalize(s,s),ze.update_transform(_)}}function Ue(e){var t=e.vehicle,_=t.tachometer;if(_){var r=e.vehicle.tachometer_tsr,a=e.vehicle.tachometer_axis;f.p(e.render.world_tsr,r,_.render.world_tsr);var n=ot;f.w(a,e.render.world_tsr,n);var o=st;l.setAxisAngle(n,-Math.abs(t.engine_force)*t.delta_tach_angle,o);var i=f.g(_.render.world_tsr);l.multiply(o,i,i),l.normalize(i,i),ze.update_transform(_)}}function we(e){return e.is_vehicle&&"CHASSIS"==e.vehicle_settings.part}function Ce(e){return e.is_vehicle&&"HULL"==e.vehicle_settings.part}function De(e){return"NAVMESH"==e.physics_settings.physics_type}function Fe(e){return e.is_floating&&"MAIN_BODY"==e.floating_settings.part}var Ge=Object(n.a)(e),ke=Object(o.a)(e),Ke=Object(i.a)(e),Be=Object(s.a)(e),Xe=Object(E.a)(e),He=Object(c.a)(e),je=Object(T.a)(e),Qe=Object(d.a)(e),ze=Object(u.a)(e),Ve=Object(p.a)(e),qe=Object(O.a)(e),We=ke.physics,Je=ke.defaults,Ze=ke.assets,$e=0,et=[],tt=[],_t={},rt=[],at=["ANY"],nt={body:0,constraint:0,ray_test:0},ot=new Float32Array(3),it=new Float32Array(3),st=new Float32Array(4),Et=f.b(),ct=f.b(),lt=10,Tt=20;t.init_scene_physics=function(e){e._physics={worker_loaded:!1,bundles:[],ray_tests:{},ray_tests_arr:[]};var t=We.uranium_path;Ze.prevent_caching&&(t+="?v="+Object(S.c)()),He.log("%cLOAD PHYSICS","color: #0a0",We.use_workers?"Using Separate Worker Thread,":"Using Same Thread,","Max FPS: "+We.max_fps),He.log("%cPHYSICS PATH","color: #0a0",t);var _=Be.create_worker(t,!We.use_workers);Be.attach_handler(_,v),et.push(_),tt.push(e),We.ping&&setInterval(function(){Be.post_msg(_,Be.OUT_PING,performance.now())},1e3)},t.check_worker_loaded=function(e){return!e._physics||e._physics.worker_loaded},t.cleanup=function(){for(var e=0;e<et.length;e++)Be.terminate(et[e]);et.length=0,tt.length=0,_t={},rt.length=0,at=["ANY"];for(var t in nt)nt[t]=0},t.append_object=function(e,t){if(_e(t)){var n=e.physics_settings,o=N(t),i=[];n.use_collision_compound&&_(e,i);var s=t._physics.bundles;if(we(e)||Ce(e)||e.is_character||Fe(e)||e.use_obj_physics){var E=De(e);if(E)var c=Q(e,t);else var c=H(e,i,o);e.physics=c;var l={batch:null,physics:c};E||(s.push(l),r(t,o,c.collision_id))}else for(var T=Xe.get_scene_data(e,t),d=T.batches,u=0;u<d.length;u++){var f=d[u];if("PHYSICS"==f.type&&!a(t,f))if(f.submesh.base_length)if(f.water&&t._render.water_params)C(f,t,o);else{if(f.use_ghost)var c=B(e,f,o);else var c=F(e,f,o);e.physics=c;var l={batch:f,physics:c};s.push(l),r(t,o,c.collision_id)}else He.error("Object "+e.name+" has collision material with no assigned vertices")}we(e)||Ce(e)?(J(e,o),Me(e,e.vehicle,o)):e.is_character?$(e,o):Fe(e)&&te(e,o);for(var u=0;u<rt.length;u++){var P=rt[u];P.physics&&ae(P)}}},t.find_obj_by_body_id=g,t.update=function(e,t){for(var _=0;_<et.length;_++){y(et[_],e,t);var r=tt[_],a=r._render.water_params;if(a&&a.waves_height>0){var n=je.get_subs(r,Qe.MAIN_OPAQUE),o=A.length(n.wind)||1;Be.post_msg(et[_],Be.OUT_SET_WATER_TIME,n.time*o)}}},t.get_active_scene=function(){return tt[0]},t.pause=function(){for(var e=0;e<et.length;e++)Be.post_msg(et[e],Be.OUT_PAUSE)},t.resume=function(){for(var e=0;e<et.length;e++)Be.post_msg(et[e],Be.OUT_RESUME)},t.enable_simulation=function(e){var t=e.physics;if(t||Ge.panic("No object physics"),!t.simulated){var _=t.body_id,r=ce(_);t.simulated=!0,Be.post_msg(r,Be.OUT_ENABLE_SIMULATION,_)}},t.disable_simulation=function(e){var t=e.physics;if(t||Ge.panic("No object physics"),t.simulated){var _=t.body_id,r=ce(_);t.simulated=!1,Be.post_msg(r,Be.OUT_DISABLE_SIMULATION,_)}},t.scene_has_physics=_e,t.obj_has_physics=re,t.has_dynamic_physics=function(e){var t=e.physics;return!!(t&&t.simulated&&("RIGID_BODY"==t.type||"DYNAMIC"==t.type)&&t.mass>0&&0==t.is_ghost)},t.has_simulated_physics=function(e){var t=e.physics;return!(!t||!t.simulated)},t.set_gravity=function(e,t,_,r){var a=e.physics.body_id,n=ce(a);Be.post_msg(n,Be.OUT_SET_GRAVITY,a,t,_,r)},t.has_constraint=ne,t.apply_constraint=Ee,t.clear_constraint=function(e){var t=e.physics,_=t.cons_id,r=ce(t.body_id);Be.post_msg(r,Be.OUT_REMOVE_CONSTRAINT,_),t.cons_id=null},t.pull_to_constraint_pivot=function(e,_,r,a,n,o){var i=f.s(_,1,r,Et),s=f.s(n,1,o,ct);f.o(i,i),f.p(s,i,i),ze.get_tsr(a,s),f.p(s,i,i),ze.set_tsr(e,i),ze.update_transform(e);var E=f.j(e.render.world_tsr),c=f.g(e.render.world_tsr);t.set_transform(e,E,c)},t.set_transform=function(e,t,_){var r=e.physics,a=Be.get_msg_cache(Be.OUT_SET_TRANSFORM),n=f.i(e.render.world_tsr,a.trans),o=f.f(e.render.world_tsr,a.quat);f.s(n,1,o,r.curr_tsr),a.body_id=r.body_id,A.copy(t,a.trans),l.copy(_,a.quat);var i=ce(r.body_id);Be.post_msg(i,Be.OUT_SET_TRANSFORM)},t.sync_transform=Te,t.sync_bounding=de,t.sync_mesh=ue,t.apply_velocity=function(e,t,_,r){var a=ot;Ae(e,t,_,r,a);var n=e.physics.body_id,o=Math.abs(0),i=Math.abs(0),s=Math.abs(0),E=Math.abs(a[0]),c=Math.abs(a[1]),l=Math.abs(a[2]);a[0]=E?a[0]/E*Math.max(E,o):0,a[1]=c?a[1]/c*Math.max(c,i):0,a[2]=l?a[2]/l*Math.max(l,s):0;var T=ce(n);Be.post_msg(T,Be.OUT_SET_LINEAR_VELOCITY,n,a[0],a[1],a[2])},t.apply_velocity_world=function(e,t,_,r){var a=e.physics.body_id,n=ce(a);Be.post_msg(n,Be.OUT_SET_LINEAR_VELOCITY,a,t,_,r)},t.apply_force=Se,t.apply_torque=pe,t.set_angular_velocity=function(e,t,_,r){var a=e.physics.body_id,n=ce(a);Be.post_msg(n,Be.OUT_SET_ANGULAR_VELOCITY,a,t,_,r)},t.set_character_move_dir=function(e,t,_){var r=e.physics.body_id,a=ce(r);Be.post_msg(a,Be.OUT_SET_CHARACTER_MOVE_DIR,r,t,_)},t.set_character_move_type=function(e,t){var _=e.physics.body_id,r=ce(_);Be.post_msg(r,Be.OUT_SET_CHARACTER_MOVE_TYPE,_,t)},t.set_character_walk_velocity=function(e,t){var _=e.physics.body_id,r=ce(_);Be.post_msg(r,Be.OUT_SET_CHARACTER_WALK_VELOCITY,_,t)},t.set_character_run_velocity=function(e,t){var _=e.physics.body_id,r=ce(_);Be.post_msg(r,Be.OUT_SET_CHARACTER_RUN_VELOCITY,_,t)},t.set_character_fly_velocity=function(e,t){var _=e.physics.body_id,r=ce(_);Be.post_msg(r,Be.OUT_SET_CHARACTER_FLY_VELOCITY,_,t)},t.character_jump=function(e){var t=e.physics.body_id,_=ce(t);Be.post_msg(_,Be.OUT_CHARACTER_JUMP,t)},t.character_rotation_inc=function(e,t,_){var r=e.physics.body_id,a=ce(r);Be.post_msg(a,Be.OUT_CHARACTER_ROTATION_INCREMENT,r,t,_)},t.set_character_rotation=function(e,t,_){var r=e.physics.body_id,a=ce(r);Be.post_msg(a,Be.OUT_SET_CHARACTER_ROTATION,r,t,_)},t.set_character_rotation_h=function(e,t){var _=e.physics.body_id,r=ce(_);Be.post_msg(r,Be.OUT_SET_CHARACTER_HOR_ROTATION,_,t)},t.set_character_rotation_v=function(e,t){var _=e.physics.body_id,r=ce(_);Be.post_msg(r,Be.OUT_SET_CHARACTER_VERT_ROTATION,_,t)},t.set_character_vert_move_dir_angle=function(e,t){var _=e.physics.body_id,r=ce(_);Be.post_msg(r,Be.OUT_SET_CHARACTER_VERT_MOVE_DIR_ANGLE,_,t)},t.append_collision_test=function(e,t,_,r){var a=e.physics;if(!a.navmesh){for(var n=a.body_id,o=0;o<a.collision_tests.length;o++){var i=a.collision_tests[o];if(i.collision_id==t&&i.callback==_)return}var i={body_id_src:n,calc_pos_norm:r||!1,collision_id:t,callback:_,pairs:[],pair_results:[]};a.collision_tests.push(i);var s=ce(n);Oe(i,m(s),s)}},t.remove_collision_test=function(e,t,_){for(var r=e.physics,a=r.body_id,n=ce(a),o=m(n),i=0;i<r.collision_tests.length;i++){var s=r.collision_tests[i];if(s.collision_id==t&&s.callback==_){if(L(s)){var E=A.set(0,0,0,ot);s.callback(!1,null,E,E,0)}r.collision_tests.splice(i,1),i--,me(o,n,s.pairs)}}},t.apply_collision_impulse_test=function(e,t){Re(e)&&ge(e);var _=e.physics,r=ce(_.body_id);Be.post_msg(r,Be.OUT_APPLY_COLLISION_IMPULSE_TEST,_.body_id),_.col_imp_test_cb=t},t.clear_collision_impulse_test=ge,t.append_ray_test=function(e,t,_,r,a,n,o,i,s){var E=Ie(),c={id:E,body_id:e?e.physics.body_id:0,from:new Float32Array(t),to:new Float32Array(_),collision_id:r,collision_id_num:k(r),autoremove:n,calc_all_hits:o,calc_pos_norm:i,ign_src_rot:s,callback:a},l=ce(c.body_id)||et[0],T=m(l),d=T._physics;return d.ray_tests[E]=c,d.ray_tests_arr.push(c),Be.post_msg(l,Be.OUT_APPEND_RAY_TEST,c.id,c.body_id,c.from,c.to,c.collision_id_num,c.autoremove,c.calc_all_hits,c.calc_pos_norm,c.ign_src_rot),E},t.remove_ray_test=he,t.change_ray_test_from_to=function(e,t,_){var r=Ye(e),a=Le(e),n=r._physics,o=n.ray_tests[e];o&&!o.autoremove&&(o.from.set(t),o.to.set(_),Be.post_msg(a,Be.OUT_CHANGE_RAY_TEST_FROM_TO,e,t,_))},t.is_ray_test=function(e){return!!Ye(e)._physics.ray_tests[e]},t.vehicle_throttle=function(e,t){var _=e.vehicle;_.engine_force=t,Me(e,_,ce(e.physics.body_id))},t.vehicle_steer=function(e,t){var _=e.vehicle;_.steering=t,Me(e,_,ce(e.physics.body_id))},t.vehicle_brake=function(e,t){var _=e.vehicle;_.brake_force=t,Me(e,_,ce(e.physics.body_id))},t.is_vehicle_chassis=we,t.is_vehicle_hull=Ce,t.is_navigation_mesh=De,t.is_car_wheel=function(e){if(!e.is_vehicle)return!1;var t=e.vehicle_settings.part;return"WHEEL_FRONT_LEFT"==t||"WHEEL_FRONT_RIGHT"==t||"WHEEL_BACK_LEFT"==t||"WHEEL_BACK_RIGHT"==t},t.is_boat_bob=function(e){return!!e.is_vehicle&&"BOB"==e.vehicle_settings.part},t.is_floater_bob=function(e){return!!e.is_floating&&"BOB"==e.floating_settings.part},t.is_vehicle_steering_wheel=function(e){return!(!e.is_vehicle||"STEERING_WHEEL"!=e.vehicle_settings.part)},t.is_vehicle_speedometer=function(e){return!(!e.is_vehicle||"SPEEDOMETER"!=e.vehicle_settings.part)},t.is_vehicle_tachometer=function(e){return!(!e.is_vehicle||"TACHOMETER"!=e.vehicle_settings.part)},t.get_vehicle_speed=function(e){return e.vehicle.speed},t.wheel_index=function(e){switch(e){case"WHEEL_FRONT_RIGHT":return 0;case"WHEEL_FRONT_LEFT":return 1;case"WHEEL_BACK_LEFT":return 2;case"WHEEL_BACK_RIGHT":return 3}},t.has_character_physics=function(e){return e.physics&&e.physics.is_character},t.is_floater_main=Fe,t.get_fps=function(){return $e},t.debug_workers=function(){for(var e=0;e<et.length;e++){var t=et[e];Be.post_msg(t,Be.OUT_DEBUG)}},t.remove_object=function(e){var t=e.physics.body_id;if("BOUNDING"==e.physics.type){var _=rt.indexOf(e);-1==_&&He.error("Object "+e.name+" doesn't have bounding physics"),delete _t[t],rt.splice(_,1)}var r=ce(t),a=m(r);Ne(a,r,t),Re(e)&&ge(e);for(var n=a._physics.bundles,o=0;o<n.length;o++){n[o].physics.body_id==t&&(n.splice(o,1),o--)}Be.post_msg(r,Be.OUT_REMOVE_BODY,t)},t.has_dynamic_settings=function(e){var t=e.physics_settings;return e.is_vehicle||e.is_floating||e.is_character||e.use_obj_physics&&!t.use_ghost&&t.mass>0&&("DYNAMIC"==t.physics_type||"RIGID_BODY"==t.physics_type)}}var a=_(0),n=_(5),o=_(4),i=_(62),s=_(88),E=_(8),c=_(1),l=_(9),T=_(10),d=_(11),u=_(13),f=_(6),P=_(2),A=_(3),S=_(46),p=_(73),O=_(16),v=Object(a.a)("__physics",r);t.a=v},function(e,t,_){"use strict";function r(e,t){function _(){return{length:0,frames:1,num_comp:0,offset:0,divisor:0}}function r(e,t,_){var r=t.a_tbn,a=t.a_position,n=a.length,o=e.shape_keys.length;if(_)for(var i=e.shape_keys[0].geometry.a_position,s=0;s<n;s++)a[s]=i[s];for(var E=1;E<o;E++)for(var c=e.shape_keys[E].geometry,T=_?_[E].value:e.shape_keys[E].init_value,i=c.a_position,s=0;s<n;s++)a[s]+=T*i[s];if(o=l.f(r),_)for(var d=e.shape_keys[0].geometry.a_tbn,E=0;E<o;E++)l.n(r,d,E);for(var E=0;E<o;E++){for(var u=l.i(we),s=1;s<e.shape_keys.length;s++){var d=e.shape_keys[s].geometry.a_tbn,T=_?_[s].value:e.shape_keys[s].init_value;if(T){var f=l.e(d,E,Ce),P=l.p(l.i(De),f,T,Ce);l.k(P,u,u)}}var A=l.e(r,E,Ce),S=l.k(u,A,Ce);l.n(r,S,E)}}function a(e){return e.base_length>Xe&&!xe.get_elem_index_uint()}function f(e){return e.indices.length>0}function P(e,t,_){if(!f(e))return e;t=t||1,_||Ue.log('%cDEBUG max vertices exceeded for indexed submesh "'+e.name+'": '+e.base_length*t+", will use drawArrays","color: #aa0");var r=e.indices,a=e.base_length,n=e.va_common,o=e.va_frames;for(var i in n){var s=n[i],E=z(s,a);n[i]=A(r,s,E)}for(var c=0;c<o.length;c++){var l=o[c];for(var i in l){var s=l[i],E=z(s,a);l[i]=A(r,s,E)}}for(var c=0;c<e.shape_keys.length;c++){var T=e.shape_keys[c].geometry;for(var d in T){var s=T[d],E=z(s,a);T[d]=A(r,s,E)}}return e.base_length=r.length,e.indices=new Uint16Array(0),e}function A(e,t,_){if(0==t.length)return new Float32Array(0);for(var r=e.length*_,a=new Float32Array(r),n=0;n<e.length;n++)for(var o=e[n],i=0;i<_;i++)a[_*n+i]=t[_*o+i];return a}function S(){return{ibo_array:null,vbo_source_data:Pe(),ibo_type:0,count:0,pointers:{},usage:0,debug_ibo_bytes:0,debug_vbo_bytes:0,vbo_data:[],ibo:null,shape_keys:null,instance_count:1,cleanup_gl_data_on_unload:!0}}function p(e,t,r,a){if("a_normal"==t){return p(e,"a_tbn",r,l.d(a))}var n=e.pointers,o=n[t],i=Ne(t);if(o)r&&o.num_comp!=r&&Me.panic('invalid num_comp for "'+t+'"'),Ie(e.vbo_source_data,t,a,o.offset);else{var s=pe(e.vbo_source_data,i);-1==s&&(e.vbo_source_data.push(Ae(i,0)),s=e.vbo_source_data.length-1);var E=e.vbo_source_data[s].vbo_source,c=new E.constructor(E.length+a.length);c.set(E),e.vbo_source_data[s].vbo_source=c,Ie(e.vbo_source_data,t,a,E.length);var T=n[t]=_();T.num_comp=r,T.offset=E.length,T.length=a.length}return R(e),e}function O(e,t){if("a_normal"==t){for(var _=O(e,"a_tbn"),r=l.f(_),a=new Float32Array(3*r),n=0;n<r;n++){var o=l.g(_,n,Fe);a.set(o,3*n)}return a}var i=e.pointers[t];if(i){var s=Ne(t);return Ye(t,ve(e.vbo_source_data,s).subarray(i.offset,i.offset+i.length),new Float32Array(i.length))}Me.panic("extract_array_float() failed; invalid name: "+t)}function v(e,_){var r;switch(_){case t.DM_DEFAULT:case t.DM_TRIANGLES:r=Je.STATIC_DRAW;break;case t.DM_DYNAMIC_TRIANGLES:r=Je.DYNAMIC_DRAW;break;default:Me.panic("Wrong draw_mode")}e.usage=r}function m(e,t,r,a,n,o){if(t.length){var i=t.length;if(n<=Xe)var s=new Uint16Array(t),E=Je.UNSIGNED_SHORT;else var s=new Uint32Array(t),E=Je.UNSIGNED_INT}else var i=n,s=null;for(var c=g(r,a,o),l=Pe(c),T={},d=0;d<l.length;d++)T[l[d].type]=0;var u={};for(var f in a){var P=a[f],A=P.length;if(A){var S=Ne(f),p=u[f]=_();p.length=A,p.num_comp=z(P,n),p.offset=T[S],Ie(l,f,P,T[S]),T[S]+=A}}var O=r.length;for(var f in r[0]){var v=r[0][f],S=Ne(f),A=v.length,m=z(v,n);if(A){var p=u[f]=_();p.length=A,p.frames=O,p.num_comp=m,p.offset=T[S],O>1&&(p=u[f+"_next"]=_(),p.length=A,p.frames=O,p.num_comp=m,p.offset=T[S]+A);for(var d=0;d<O;d++){var R=r[d],P=R[f];S=Ne(f),Ie(l,f,P,T[S]),T[S]+=A}}}o&&(N(o,u,l,T),e.instance_count=o.tsr_array.length),e.count=i,e.ibo_array=s,e.vbo_source_data=l,e.ibo_type=E,e.pointers=u}function N(e,t,r,a){var n=e.tsr_array,o=e.stat_part_em_tsr,i=e.part_inh_attrs,s=e.submesh_params,E=e.static_hair,c={a_part_ts:{data:[],num_comp:4},a_part_r:{data:[],num_comp:4}};for(var l in i)c[l]={data:[],num_comp:i[l].num_comp};for(var l in s)c[l]={data:[],num_comp:1};for(var d=0;d<n.length;d++){var f=n[d];E&&o&&!e.dyn_grass&&(f=T.p(o,n[d],Be)),!E&&e.dyn_grass&&u.subtract(n[d],o,n[d]),c.a_part_ts.data.push(f[0],f[1],f[2],f[3]),c.a_part_r.data.push(f[4],f[5],f[6],f[7]);for(var l in i)for(var P=i[l].num_comp,A=0;A<P;A++)c[l].data.push(i[l].data[d*P+A]);for(var l in s)c[l].data.push(s[l][0])}for(var l in c){var S=Ne(l);Ie(r,l,c[l].data,a[S]);var p=_();p.num_comp=c[l].num_comp,p.offset=a[S],p.divisor=1,p.length=c[l].data.length,t[l]=p,a[S]+=p.length}}function g(e,t,_){var r={},a=function(e,t){r[e]||(r[e]=0),r[e]+=t};for(var n in e[0]){var o=e[0][n],i=Ne(n);a(i,o.length*e.length)}for(var n in t){var o=t[n],i=Ne(n);a(i,o.length)}if(_){var s=_.tsr_array.length,i=Ne("a_part_ts");a(i,4*s),i=Ne("a_part_r"),a(i,4*s);var E=_.part_inh_attrs;for(var n in E)i=Ne(n),a(i,E[n].num_comp*s);var c=_.submesh_params;for(var n in c)i=Ne(n),a(i,s)}return r}function R(e){e.ibo_array?(e.ibo||(e.ibo=Je.createBuffer()),Je.bindBuffer(Je.ELEMENT_ARRAY_BUFFER,e.ibo),Je.bufferData(Je.ELEMENT_ARRAY_BUFFER,e.ibo_array,e.usage),e.debug_ibo_bytes=e.ibo_array.byteLength):e.debug_ibo_bytes=0,e.debug_vbo_bytes=0;for(var t=0;t<e.vbo_source_data.length;t++){var _=e.vbo_source_data[t].type,r=pe(e.vbo_data,_);-1==r&&(e.vbo_data.push({vbo:null,type:_,debug_id:ye.unique_id()}),r=e.vbo_data.length-1);var a=e.vbo_data[r];a.vbo||(a.vbo=Je.createBuffer()),Je.bindBuffer(Je.ARRAY_BUFFER,a.vbo),Je.bufferData(Je.ARRAY_BUFFER,e.vbo_source_data[t].vbo_source,e.usage),e.debug_vbo_bytes+=e.vbo_source_data[t].vbo_source.byteLength}}function I(e,t,_,r){var a=pe(e.vbo_data,t),n=e.vbo_data[a];Je.bindBuffer(Je.ARRAY_BUFFER,n.vbo),Je.bufferSubData(Je.ARRAY_BUFFER,d.h*r,_)}function b(e,t){e.bb_local=o.h(e.bb_local,t),e.be_local=o.i(e.be_local,t),e.bs_local=o.k(e.bs_local,t),e.bbr_local=o.j(e.bbr_local,t)}function h(e,t){var _=e.base_length;for(var r in t){var a=t[r].length;e.va_common[r]=new Float32Array(a*_);for(var n=0;n<_;n++)for(var o=0;o<a;o++)e.va_common[r][n*a+o]=t[r][o]}return e}function Y(e){var t=e[0],_=L(e),r=_.submesh_bd;r.bb_local=o.n(t.submesh_bd.bb_local);for(var a=0,n=0,i=[],s=0;s<e.length;s++){var E=e[s],c=E.indices,l=E.base_length,T=E.va_common,u=E.submesh_bd.bb_local,f=E.submesh_bd.bs_local;o.D(r.bb_local,u),o.E(r.bs_local,f),o.G(E.submesh_bd.bbr_local,i);for(var P=0;P<c.length;P++){var A=c[P];_.indices[a+P]=A+n}a+=c.length;for(var S in T){var p=T[S],O=n*z(p,l);_.va_common[S].set(p,O)}for(var P=0;P<E.va_frames.length;P++){var v=E.va_frames[P],m=_.va_frames[P];for(var S in v){var p=v[S],O=n*z(p,l);m[S].set(p,O)}}n+=l}if(r.be_local=o.z(d._1(i),!0),_.shape_keys.length>0)for(var s=0;s<_.shape_keys.length;s++)for(var N=_.shape_keys[s].geometry,g=0,R=0,P=0;P<e.length;P++){var I=e[P].shape_keys[s].geometry;N.a_position.set(I.a_position,g),N.a_tbn.set(I.a_tbn,R),g+=I.a_position.length,R+=I.a_tbn.length}return e[0].instanced_array_data&&(_.instanced_array_data={tsr_array:t.instanced_array_data.tsr_array,stat_part_em_tsr:t.instanced_array_data.stat_part_em_tsr,static_hair:!0,submesh_params:t.instanced_array_data.submesh_params,part_inh_attrs:t.instanced_array_data.part_inh_attrs,dyn_grass:t.instanced_array_data.dyn_grass}),_}function L(e){for(var t=e[0],_=fe("JOIN_"+e.length+"_SUBMESHES"),r=0,a=0;a<e.length;a++)r+=e[a].indices.length;_.indices=new Uint32Array(r);var n=0,o=0;if(e[0].shape_keys.length>0)for(var i=0;i<e[0].shape_keys.length;i++){for(var a=0;a<e.length;a++)n+=e[a].shape_keys[i].geometry.a_position.length,o+=l.f(e[a].shape_keys[i].geometry.a_tbn);var s={a_position:new Float32Array(n),a_tbn:l.c(o)},E={init_value:e[0].shape_keys[i].init_value,geometry:s};_.shape_keys.push(E)}r=0;for(var a=0;a<e.length;a++)r+=e[a].base_length;_.base_length=r;for(var c in t.va_common){r=0;for(var a=0;a<e.length;a++)r+=e[a].va_common[c].length;_.va_common[c]=new Float32Array(r)}for(var c in t.va_frames[0]){r=0;for(var a=0;a<e.length;a++)r+=e[a].va_frames[0][c].length;for(var a=0;a<t.va_frames.length;a++)_.va_frames[a]=_.va_frames[a]||{},_.va_frames[a][c]=new Float32Array(r)}return _}function M(e,t,_){for(var r=t.submesh_bd,a=o.w(),n=o.C(),i=[],s=0;s<_.length;s++)o.h(e.submesh_bd.bb_local,_[s],a),o.D(r.bb_local,a),o.j(e.submesh_bd.bbr_local,_[s],n),o.G(n,i);r.be_local=o.z(d._1(i),!0),r.bbr_local=o.x(r.be_local),r.bs_local=o.B(r.be_local)}function x(e,t,_,r,a,n){var o=e.submeshes[t],i=o.base_length,s=e.materials[t],E=fe("SUBMESH_"+e.name+"_"+s.name);E.base_length=i;var c=!1;if(X(_,"a_texcoord"))var l=w(e,t);else var l=new Float32Array(0);if(X(_,"a_orco_tex_coord"))var T=D(e,o);else var T=new Float32Array(0);var u=H(_,i,r,o.group);if(a)var f=d.O(a);else var f={};f.a_color={generate_buffer:!0},X(_,"a_color")&&e.active_vcol_name?f.a_color.src=[{name:e.active_vcol_name,mask:7}]:f.a_color.src=[],E.va_common.a_texcoord=l,E.va_common.a_influence=u,E.va_common.a_orco_tex_coord=T,G(E.va_common,f,o.vertex_colors,o.color,i,e.name),B(o,e.name,n,E.va_common),E.indices=new Uint32Array(o.indices);var A=o.position.length/i/je;if(X(_,"a_tbn")&&o.tbn.length)var S=!0;else var S=!1;if(X(_,"a_shade_tangs")&&o.shade_tangs.length)var p=!0;else var p=!1;e.b4w_shape_keys.length>0&&(c=!0);for(var O=0;O<A;O++){var v=U(o,i,S,p,O);if(c){var m={};if(m.name=e.b4w_shape_keys[O].name,E.shape_keys.push(m),0!=O){m.geometry=v,m.init_value=e.b4w_shape_keys[O].value;continue}m.geometry=U(o,i,S,p,O),m.init_value=1}E.va_frames.push(v)}if(A>1&&!c){var N=E.va_frames[0],v={};for(var g in N)v[g]=new Float32Array(N[g]);E.va_frames.push(v)}return X(_,"a_polyindex")&&(P(E,1,!0),E.va_common.a_polyindex=se(E)),y(o.boundings,E.submesh_bd),E}function y(e,t){t.bb_local=o.w(),t.bb_local.max_x=e.bb.max_x,t.bb_local.max_y=e.bb.max_y,t.bb_local.max_z=e.bb.max_z,t.bb_local.min_x=e.bb.min_x,t.bb_local.min_y=e.bb.min_y,t.bb_local.min_z=e.bb.min_z;var _=e.rbb,r=e.caxis_x,a=e.caxis_y,n=e.caxis_z,i=e.be_ax;t.be_local=o.e(r,a,n,e.be_cen),u.scale(t.be_local.axis_x,i[0],t.be_local.axis_x),u.scale(t.be_local.axis_y,i[1],t.be_local.axis_y),u.scale(t.be_local.axis_z,i[2],t.be_local.axis_z),t.bs_local=o.B(t.be_local),u.copy(_.rbb_c,t.bbr_local.center),u.copy(r,t.bbr_local.axis_x),u.copy(a,t.bbr_local.axis_y),u.copy(n,t.bbr_local.axis_z);var s=_.rbb_s;u.scale(t.bbr_local.axis_x,s[0],t.bbr_local.axis_x),u.scale(t.bbr_local.axis_y,s[1],t.bbr_local.axis_y),u.scale(t.bbr_local.axis_z,s[2],t.bbr_local.axis_z)}function U(e,t,_,r,a){var n={},o=new Float32Array(t*je),i=l.c(_?t:0),s=a*t*je,E=s+t*je;if(o.set(e.position.subarray(s,E),0),_&&(s=a*t,l.b(e.tbn,s,t,i)),r){var c=new Float32Array(t*qe);E=t*qe,c.set(e.shade_tangs.subarray(0,E),0),n.a_shade_tangs=c}return n.a_position=o,n.a_tbn=i,n}function w(e,t){var _=null,r=e.materials[t],a=e.submeshes[t];if(r.texture_slots.length){var n=r.texture_slots[0];switch(n.texture_coords){case"UV":_=C(a,n.uv_layer||e.active_uv_name,e.name);break;case"ORCO":_=F(e.b4w_boundings.bb_src,a)}}return null===_&&(_=new Float32Array(a.base_length*Ve)),_}function C(e,t,_){var r=e.base_length*Ve,a=e.uv_layers.indexOf(t);if(-1==a)return Ue.warn('uv layer "'+t+'" for mesh "'+_+'" not found'),new Float32Array(r);var n=a*r,o=n+r;return e.texcoord.subarray(n,o)}function D(e,t){for(var _=e.b4w_boundings.bb_src,r=new Float32Array(3*t.base_length),a=t.position,n=_.max_x-_.min_x,o=_.max_y-_.min_y,i=_.max_z-_.min_z,s=0,E=0;E<a.length;E+=3)r[s++]=0==n?.5:d.M(parseFloat(((a[E]-_.min_x)/n).toFixed(5)),0,1),r[s++]=0==o?.5:d.M(parseFloat(((a[E+1]-_.min_y)/o).toFixed(5)),0,1),r[s++]=0==i?.5:d.M(parseFloat(((a[E+2]-_.min_z)/i).toFixed(5)),0,1);return r}function F(e,t){for(var _=new Float32Array(t.base_length*Ve),r=(e.max_x+e.min_x)/2,a=(e.max_y+e.min_y)/2,n=e.max_x-e.min_x,o=e.max_y-e.min_y,i=0,s=0;s<t.position.length;s+=3)_[i++]=(t.position[s]-r)/n+.5,_[i++]=(t.position[s+1]-a)/o+.5;return _}function G(e,t,_,r,a,n){var o=k(_);for(var i in t){var s=t[i].src;if(s.length){for(var E=0,c=0;c<s.length;c++)E+=d._42(s[c].mask);e[i]=new Float32Array(E*a);for(var l=0,c=0;c<s.length;c++){var T=s[c].name,u=s[c].mask,f=d._43(u),P=o.indexOf(T);if(-1==P){Ue.warn('vertex color "'+T+'" for mesh "'+n+'" not found');var A=7}else var A=_[P].mask,S=K(_,P,a);var p=d._42(A);(u&A)!==u&&Ue.error("Wrong color extraction from "+T+" to "+i+' for the mesh "'+n+'".');for(var O=0;O<a;O++)for(var v=0;v<ze;v++)if(f[v]){var m=l+d._41(u,v),N=d._41(A,v);e[i][O*E+m]=-1==P?0:r[S+O*p+N]}l+=p}}else e[i]=new Float32Array(0)}}function k(e){for(var t=[],_=0;_<e.length;_++)t.push(e[_].name);return t}function K(e,t,_){for(var r=0,a=0;a<t;a++)r+=d._42(e[a].mask);return r*_}function B(e,t,_,r){if(_)for(var a in _)r[_[a]]=C(e,a,t)}function X(e,t){return e.indexOf(t)>-1}function H(e,t,_,r){if(X(e,"a_influence")&&_)for(var a=new Float32Array(t*We),n=r.length/t,o=j(_,n),i=n>3?n:4,s=new Float32Array(i),E=new Uint32Array(i),c=new Float32Array(We),l=new Float32Array(i),T=new Uint32Array(i),d=new Float32Array(We),u=0;u<t;u++)s.set(l),E.set(T),c.set(d),a.set(Q(r,n,u,t,o,s,E,c),u*We);else var a=new Float32Array(0);return a}function j(e,t){for(var _=new Float32Array(t),r=0;r<t;r++){_[r]=-1;for(var a in e){var n=e[a];if(n.vgroup_index===r){_[r]=n.deform_bone_index;break}}}return _}function Q(e,_,r,a,n,o,i,s){for(var E=!0,c=0;c<_;c++){var l=e[c*a+r];if(-1!==l){var T=n[c];-1!==T&&(o[c]=l,i[c]=T,E=!1)}}if(E)return s;J(o,i,t.SORT_NUMERIC,!1);for(var d=0,c=0;c<We;c++)d+=o[c];if(d<.01)return s;for(var c=0;c<We;c++)o[c]/=d;if(Math.abs(o[0]-1)<.01)s[0]=i[0]+1;else for(var c=0;c<We;c++)s[c]=i[c]+o[c];return s}function z(e,t){if(0==t)return 0;var _=e.length,r=_/t;return r!=Math.floor(r)&&Me.panic("Array size mismatch during geometry calculation: array length="+_+", base length="+t),r}function V(e,t,_){for(var r=e.length/3,a=0;a<r;a++){var n=e[3*a],o=e[3*a+1],i=e[3*a+2],s=t[3*n],E=t[3*n+1],c=t[3*n+2],l=t[3*o],T=t[3*o+1],d=t[3*o+2],u=t[3*i],f=t[3*i+1],P=t[3*i+2];_[3*a]=(s+l+u)/3,_[3*a+1]=(E+T+f)/3,_[3*a+2]=(c+d+P)/3}return _}function q(e,t,_){for(var r=e.length/3,a=0;a<r;a++){var n=e[3*a]-t[0],o=e[3*a+1]-t[1],i=e[3*a+2]-t[2];_[a]=n*n+o*o+i*i}return _}function W(e,t){var _=e.length;if(_<2)return t;for(var r,a=_,n=!1;a>1||n;){a>1&&(a=Math.floor(a/He)),n=!1;for(var o=0;a+o<_;o++)e[o]-e[o+a]<0&&(r=e[o],e[o]=e[o+a],e[o+a]=r,Z(t,o,o+a),n=!0)}return t}function J(e,_,r,a){for(var n,o=e.length,i=o,s=!1,E=a?-1:1;i>1||s;){i>1&&(i=Math.floor(i/He)),s=!1;for(var c=0;i+c<o;c++){if(r==t.SORT_NUMERIC)var l=E*(e[c]-e[c+i])<0;else var l=e[c]<e[c+i]&&a;l&&(n=e[c],e[c]=e[c+i],e[c+i]=n,n=_[c],_[c]=_[c+i],_[c+i]=n,s=!0)}}}function Z(e,t,_){var r=e[3*t],a=e[3*t+1],n=e[3*t+2];e[3*t]=e[3*_],e[3*t+1]=e[3*_+1],e[3*t+2]=e[3*_+2],e[3*_]=r,e[3*_+1]=a,e[3*_+2]=n}function $(e,t,_){var r=[],a=[];u.subtract(t,e,r),u.subtract(_,e,a),u.normalize(r,r),u.normalize(a,a);var n=d.M(u.dot(r,a),-1,1);return Math.acos(n)}function ee(e,t,_,r,a,n,o,i,s,E){for(var c=te(r,a,n),l=0;l<Qe;l++){var T=Qe*e+l,d=Qe*t+l,u=Qe*_+l;E[T]=o*c[l],E[d]=i*c[l],E[u]=s*c[l]}}function te(e,t,_){var r=[],a=[],n=[];return u.subtract(t,e,r),u.subtract(_,e,a),u.cross(r,a,n),u.normalize(n,n),n}function _e(e,t){for(var _ in e)for(var r=e[_],a=0;a<Qe;a++){for(var n=Qe*r[0]+a,o=1;o<r.length;o++){var i=Qe*r[o]+a;t[n]+=t[i]}for(var o=1;o<r.length;o++){var i=Qe*r[o]+a;t[i]=t[n]}}}function re(e,t){for(var _=new Float32Array(Qe),r=0;r<Qe;r++){var a=Qe*e+r;_[r]=t[a]}u.normalize(_,_);for(var r=0;r<Qe;r++){var a=Qe*e+r;t[a]=_[r]}}function ae(e,t,_){for(var r={},a=t.length/3,n=0;n<a;n++){var o=String(t[3*n])+String(t[3*n+1])+String(t[3*n+2]);r[o]=[]}for(var i=e.length,n=0;n<i;n++){var s=e[n],o=String(_[3*s])+String(_[3*s+1])+String(_[3*s+2]);o in r&&r[o].push(s)}return r}function ne(e,t){return t||(t=[]),ie(e.va_frames[0].a_position,e,t)}function oe(e,t){t||(t=[]);for(var _=e.va_frames[0].a_tbn,r=l.f(_),a=new Float32Array(3*r),n=0;n<r;n++){var o=l.h(_,n,Ke),i=u.transformQuat(d.e,o,Fe);a[3*n]=i[0],a[3*n+1]=i[1],a[3*n+2]=i[2]}return ie(a,e,t)}function ie(e,t,_){if(f(t))for(var r=t.indices,a=r.length/3,n=0;n<a;n++){var o=new Float32Array(9),i=r[3*n];o[0]=e[3*i],o[1]=e[3*i+1],o[2]=e[3*i+2];var s=r[3*n+1];o[3]=e[3*s],o[4]=e[3*s+1],o[5]=e[3*s+2];var E=r[3*n+2];o[6]=e[3*E],o[7]=e[3*E+1],o[8]=e[3*E+2],_[n]=o}else for(var a=e.length/9,n=0;n<e.length;n++){var o=new Float32Array(9);o[0]=e[9*n],o[1]=e[9*n+1],o[2]=e[9*n+2],o[3]=e[9*n+3],o[4]=e[9*n+4],o[5]=e[9*n+5],o[6]=e[9*n+6],o[7]=e[9*n+7],o[8]=e[9*n+8],_[n]=o}return _}function se(e){for(var t=new Float32Array(e.base_length),_=0;_<e.base_length;_++)t[_]=_%3/2;return t}function Ee(e,t,_){return Math.sqrt(ce(e,t,_))}function ce(e,t,_){var r=u.dist(e,t),a=u.dist(e,_),n=u.dist(t,_),o=(r+a+n)/2;return o*(o-r)*(o-a)*(o-n)}function le(e,t,_){_||(_=new Float32Array(3));var r=e[0],a=e[1],n=e[2],o=e[3],i=e[4],s=e[5],E=e[6],c=e[7],l=e[8],T=d._39(t),u=d._39(t);T+u>1&&(T=1-T,u=1-u);var f=1-T-u,P=f*r+T*o+u*E,A=f*a+T*i+u*c,S=f*n+T*s+u*l;return _[0]=P,_[1]=A,_[2]=S,_}function Te(e){for(var t=new Float32Array([0,0,0,1,1,1,1,0]),_=new Float32Array(8*e),r=0;r<e;r++)_.set(t,8*r);return _}function de(e,t,_,r){if(e){for(var a=e.offset,n=e.length+a,o=t.bufs_data.shape_keys[0].geometry.a_position,i=a;i<n;i++)_[i]=o[i-a];for(var i=1;i<t.bufs_data.shape_keys.length;i++){var s=t.bufs_data.shape_keys[i].geometry.a_position,E=r[i].value;if(E)for(var c=a;c<n;c++)_[c]+=E*s[c-a]}Je.bufferSubData(Je.ARRAY_BUFFER,d.h*a,_.subarray(a))}}function ue(e,t,_,r){if(e){for(var a=e.offset,n=e.length+a,o=t.bufs_data.shape_keys,i=o[0].geometry.a_tbn,s=l.i(we),E=a;E<n;E+=l.a){for(var c=l.i(De),T=(E-a)/l.a,u=1;u<o.length;u++){var f=r[u].value;if(f){var P=o[u].geometry.a_tbn,A=l.e(P,T,Ce),S=l.p(s,A,f,Ce);l.k(S,s,c)}}var p=l.e(i,T,Ce),O=l.k(c,p,Ce);_[E]=d._3(O[0]),_[E+1]=d._3(O[1]),_[E+2]=d._3(O[2]),_[E+3]=d._3(O[3])}Je.bufferSubData(Je.ARRAY_BUFFER,d.h*a,_.subarray(a))}}function fe(e){return{name:e,base_length:0,indices:null,va_frames:[],va_common:{a_influence:new Float32Array(0),a_color:new Float32Array(0),a_texcoord:new Float32Array(0)},shape_keys:[],submesh_bd:{bb_local:o.w(),be_local:o.y(),bs_local:o.A(),bbr_local:o.C()},instanced_array_data:null}}function Pe(e){var t=[];for(var _ in e)t.push(Ae(_,e[_]));return t}function Ae(e,t){var _=me(e);return{vbo_source:new _(t),type:e}}function Se(e){for(var t=[],_=0;_<e.length;_++){var r=e[_].vbo_source,a=e[_].type;t.push({vbo_source:new r.constructor(r),type:a})}return t}function pe(e,t){for(var _=0;_<e.length;_++)if(e[_].type==t)return _;return-1}function Oe(e,t){var _=pe(e,t);return-1==_?null:e[_].vbo}function ve(e,t){var _=pe(e,t);return-1==_?null:e[_].vbo_source}function me(e){switch(e){case Ze:return Float32Array;case $e:return Int16Array;case et:return Uint8Array;default:return Float32Array}}function Ne(e){switch(e=e.replace(/_next$/,""),e=e.replace(/param_GEOMETRY_VC_a_\w+/,"param_GEOMETRY_VC_a")){case"a_tbn":case"a_shade_tangs":return $e;case"a_color":case"a_bending_col_main":case"a_bending_col_detail":case"a_grass_size":case"a_grass_color":case"param_GEOMETRY_VC_a":case"a_polyindex":case"a_p_bb_vertex":case"a_halo_bb_vertex":case"a_bb_vertex":return et;default:return Ze}}function ge(e){switch(Ne(e)){case Ze:return d.h;case $e:return d.l;case et:return d.g;default:return d.h}}function Re(e){switch(Ne(e)){case Ze:return Je.FLOAT;case $e:return Je.SHORT;case et:return Je.UNSIGNED_BYTE;default:return Je.FLOAT}}function Ie(e,t,_,r){Le(t,_,e[pe(e,Ne(t))].vbo_source.subarray(r))}function be(e,t){switch(Ne(e)){case Ze:return t;case $e:return d._48(t);case et:return d._64(t)}return t}function he(e,t){switch(Ne(e)){case Ze:return t;case $e:return d._3(t);case et:return d._65(t)}return t}function Ye(e,t,_){switch(Ne(e)){case Ze:_.set(t);break;case $e:for(var r=0;r<t.length;r++)_[r]=d._48(t[r]);break;case et:for(var r=0;r<t.length;r++)_[r]=d._64(t[r])}return _}function Le(e,t,_){switch(Ne(e)){case Ze:_.set(t);break;case $e:for(var r=0;r<t.length;r++)_[r]=d._3(t[r]);break;case et:for(var r=0;r<t.length;r++)_[r]=d._65(t[r])}return _}var Me=Object(n.a)(e),xe=Object(s.a)(e),ye=Object(i.a)(e),Ue=Object(E.a)(e),we=l.c(),Ce=l.c(),De=l.c(),Fe=new Float32Array(3),Ge=new Float32Array(3),ke=new Float32Array(3),Ke=c.create(),Be=new Float32Array(8),Xe=65536,He=1.247330950103979,je=3,Qe=3,ze=3,Ve=2,qe=3,We=4;t.DM_TRIANGLES=10,t.DM_DYNAMIC_TRIANGLES=20,t.SORT_NUMERIC=0,t.SORT_STRING=1,t.DM_DEFAULT=t.DM_TRIANGLES;var Je=null,Ze="float",$e="short",et="unsigned_byte";t.VBO_FLOAT=Ze,t.VBO_SHORT=$e,t.VBO_UBYTE=et,t.setup_context=function(e){Je=e},t.submesh_to_bufs_data=function(e,t,_){a(e)&&P(e);var n=e.indices,o=e.base_length,i=e.va_frames,s={};for(var E in e.va_common)E in _&&!_[E].generate_buffer||(s[E]=e.va_common[E]);var c=S();return e.shape_keys.length>0&&r(e,i[0]),m(c,n,i,s,o,e.instanced_array_data),v(c,t),R(c),c.shape_keys=e.shape_keys,c},t.submesh_init_shape_keys=r,t.is_long_submesh=a,t.is_indexed=f,t.submesh_drop_indices=P,t.update_bufs_data_index_array=function(e,t,_){return v(e,t),e.count=_.length,e.ibo_array=_,_ instanceof Uint16Array?e.ibo_type=Je.UNSIGNED_SHORT:e.ibo_type=Je.UNSIGNED_INT,e},t.update_bufs_data_array=p,t.extract_array_float=O,t.make_static=function(e){e.usage=Je.STATIC_DRAW},t.make_dynamic=function(e){e.usage=Je.DYNAMIC_DRAW},t.update_gl_buffers=R,t.update_gl_buffer_sub_data=I,t.cleanup_bufs_data=function(e){e.ibo&&Je.deleteBuffer(e.ibo);for(var t=0;t<e.vbo_data.length;t++)e.vbo_data[t].vbo&&Je.deleteBuffer(e.vbo_data[t].vbo);e.vbo_data.length=0},t.has_empty_submesh=function(e,t){return!e.submeshes[t].base_length},t.submesh_apply_transform=function(e,t){for(var _=0;_<e.va_frames.length;_++){var r=e.va_frames[_].a_position;T.D(r,t,r,0);var a=e.va_frames[_].a_tbn;l.m(a,t,a);var n=e.va_frames[_].a_shade_tangs;n&&n.length>0&&T.x(n,t,n,0)}var o=e.va_common.au_center_pos;return o&&o.length&&T.D(o,t,o,0),b(e.submesh_bd,t),e},t.submesh_apply_particle_transform=function(e,t){var _=e.va_common.au_center_pos;if(_&&_.length){var r=new Float32Array(_);T.D(r,t,r,0);for(var a=0;a<e.va_frames.length;a++)for(var n=0;n<r.length;n++)e.va_frames[a].a_position[n]+=r[n]-_[n];_.set(r)}else Me.panic('Attribute "au_center_pos" is missing in particle submesh');return b(e.submesh_bd,t),e},t.bounding_data_apply_transform=b,t.submesh_apply_params=h,t.submesh_list_join=Y,t.make_propagated_submesh=function(e,t,_){if(!e.base_length)return fe("EMPTY");var r=_.length;e.base_length*r>Xe&&!xe.get_elem_index_uint()&&P(e,r);var a=e.indices,n=e.base_length,o=e.va_common,i=e.va_frames;for(var s in t){var E=t[s].length,c=E*n;o[s]=new Float32Array(c);for(var l=0;l<n;l++)for(var d=0;d<E;d++)o[s][l*E+d]=t[s][d]}var u=fe("CLONE_"+r+"_SUBMESHES");u.base_length=n*r,u.indices=new Uint32Array(a.length*r);for(var l=0;l<r;l++)for(var f=a.length*l,A=n*l,d=0;d<a.length;d++){var S=a[d];u.indices[f+d]=S+A}for(var p in o){var O=o[p],c=O.length*r,v=z(O,n);u.va_common[p]=new Float32Array(c);for(var l=0;l<r;l++){var A=n*v*l;u.va_common[p].set(O,A)}}for(var p in i[0])for(var l=0;l<i.length;l++){var O=i[l][p],c=O.length*r,v=z(O,n);u.va_frames[l]=u.va_frames[l]||{},u.va_frames[l][p]=new Float32Array(c);for(var d=0;d<r;d++){var m=_[d],A=n*v*d;switch(p){case"a_position":T.D(O,m,u.va_frames[l][p],A);break;case"a_tbn":T.z(O,m,u.va_frames[l][p],A);break;case"a_shade_tangs":T.A(O,m,u.va_frames[l][p],A);break;default:Me.panic("Wrong attribute name: "+p)}}}return M(e,u,_),u},t.calc_unit_boundings=M,t.extract_submesh=x,t.extract_halo_submesh=function(e){for(var t=e.base_length,_=e.va_frames[0].a_position,r=new Float32Array(12*t),a=new Uint32Array(4*e.indices.length),n=new Float32Array(4*t),o=0;o<t;o++){r[12*o]=_[3*o],r[12*o+1]=_[3*o+1],r[12*o+2]=_[3*o+2],r[12*o+3]=_[3*o],r[12*o+4]=_[3*o+1],r[12*o+5]=_[3*o+2],r[12*o+6]=_[3*o],r[12*o+7]=_[3*o+1],r[12*o+8]=_[3*o+2],r[12*o+9]=_[3*o],r[12*o+10]=_[3*o+1],r[12*o+11]=_[3*o+2],a[6*o]=4*o+2,a[6*o+1]=4*o+1,a[6*o+2]=4*o,a[6*o+3]=4*o+2,a[6*o+4]=4*o,a[6*o+5]=4*o+3;var i=Math.random();n[4*o]=i,n[4*o+1]=i,n[4*o+2]=i,n[4*o+3]=i}var s=fe("HALO");return s.va_frames[0]={},s.base_length=4*t,s.va_frames[0].a_position=r,s.va_common.a_halo_bb_vertex=Te(t),s.va_common.a_random_vals=n,s.indices=a,s},t.has_attr=X,t.extract_submesh_all_mats=function(e,t,_){for(var r=[],a=0;a<e.submeshes.length;a++){var n=x(e,a,t,null,_,null);n.base_length&&r.push(n)}if(0==r.length)var o=fe("EMPTY");else if(1==r.length)var o=r[0];else var o=Y(r);return o},t.update_buffers_movable=function(e,t,_,r){var a=e.ibo_array,n=O(e,"a_position"),o=t.median_cache,i=t.median_world_cache,s=t.dist_cache;V(a,n,o),T.D(o,_,i),q(i,r,s),a=W(s,a),Je.bindBuffer(Je.ELEMENT_ARRAY_BUFFER,e.ibo),Je.bufferData(Je.ELEMENT_ARRAY_BUFFER,a,Je.DYNAMIC_DRAW)},t.sort_two_arrays=J,t.calc_normals=function(e,t,_){for(var r=t.length/je,a=e.length/3,n=[],o=new Array(3),i=new Array(3),s=new Array(3),E=0;E<a;E++){for(var c=e[3*E],l=e[3*E+1],T=e[3*E+2],d=0;d<je;d++)o[d]=t[je*c+d],i[d]=t[je*l+d],s[d]=t[je*T+d];if(_)var u=$(o,i,s),f=$(i,s,o),P=Math.PI-u-f;else var u=1,f=1,P=1;ee(c,l,T,o,i,s,u,f,P,n)}_&&_e(_,n);for(var E=0;E<r;E++)re(E,n);return n},t.calc_shared_indices=ae,t.geometry_random_points=function(e,t,_,r){var a=ne(e,null);if(_)var n=oe(e,null);for(var o=a.length,i=new Float32Array(o),s=Fe,E=Ge,l=ke,T=0;T<o;T++){var f=a[T];s.set(f.subarray(0,3)),E.set(f.subarray(3,6)),l.set(f.subarray(6)),i[T]=Ee(s,E,l)}var P=new Float32Array(o);P[0]=i[0];for(var T=1;T<o;T++)P[T]=P[T-1]+i[T];for(var A=P[i.length-1],S=[],T=0;T<t;T++){var p=A*d._39(r),O=d.F(P,p,0,P.length-1);if(_)var f=n[O];else var f=a[O];var v=le(f,r,Fe);if(_){S[T]=new Float32Array(4),u.normalize(v,v);var m=c.rotationTo(d.e,v,Ke);S[T][0]=m[0],S[T][1]=m[1],S[T][2]=m[2],S[T][3]=m[3]}else S[T]=new Float32Array(3),S[T][0]=v[0],S[T][1]=v[1],S[T][2]=v[2]}return S},t.extract_polyindices=se,t.triangle_area_squared=ce,t.gen_bb_vertices=Te,t.scale_submesh_xyz=function(e,t,_){for(var r=e.va_frames[0].a_position,a=0;a<r.length;a+=3)r[a]=(r[a]-_[0])*t[0]+_[0],r[a+1]=(r[a+1]-_[1])*t[1]+_[1],r[a+2]=(r[a+2]-_[2])*t[2]+_[2]},t.apply_shape_key=function(e,t,_){for(var r=e.scenes_data[0].batches,a=e.render.shape_keys_values,n=1;n<a.length;n++)a[n].name==t&&(a[n].value=_);for(var n=0;n<r.length;n++)if(!r[n].forked_batch&&r[n].use_shape_keys&&!r[n].debug_sphere){var o=r[n].bufs_data,i=Ne("a_position"),s=Oe(o.vbo_data,i),E=ve(o.vbo_source_data,i);Je.bindBuffer(Je.ARRAY_BUFFER,s),de(o.pointers.a_position,r[n],E,a);var c=Ne("a_tbn"),l=Oe(o.vbo_data,c),T=ve(o.vbo_source_data,c);Je.bindBuffer(Je.ARRAY_BUFFER,l),ue(o.pointers.a_tbn,r[n],T,a)}},t.check_shape_keys=function(e){return e.render.use_shape_keys},t.get_shape_keys_names=function(e){var t=[];if(e.render)for(var _=1;_<e.render.shape_keys_values.length;_++)t.push(e.render.shape_keys_values[_].name);return t},t.get_shape_key_value=function(e,t){if(e.render)for(var _=1;_<e.render.shape_keys_values.length;_++)if(t==e.render.shape_keys_values[_].name)return e.render.shape_keys_values[_].value;return 0},t.has_shape_key=function(e,t){var _=e.render.shape_keys_values;if(_)for(var r=1;r<_.length;r++)if(_[r].name==t)return!0;return!1},t.has_dyn_geom=function(e){return!!(e&&e.render&&e.render.dynamic_geometry)},t.draw_line=function(e,_,r){var a=e.bufs_data;if(a){if(r)var n=_.length/3/2;else var n=_.length/3-1;for(var o=new Float32Array(4*n*3),i=new Float32Array(4*n*3),s=new Uint16Array(6*n),E=0;E<n;E++){if(r)var c=6*E,l=6*E+3;else var c=3*E,l=3*(E+1);var T=_[c],d=_[c+1],u=_[c+2],f=_[l],P=_[l+1],A=_[l+2],S=f-T,p=P-d,O=A-u;o[4*E*3]=T,o[4*E*3+1]=d,o[4*E*3+2]=u,i[4*E*3]=S,i[4*E*3+1]=p,i[4*E*3+2]=O,o[4*E*3+3]=f,o[4*E*3+4]=P,o[4*E*3+5]=A,i[4*E*3+3]=-S,i[4*E*3+4]=-p,i[4*E*3+5]=-O,o[4*E*3+6]=T,o[4*E*3+7]=d,o[4*E*3+8]=u,i[4*E*3+6]=-S,i[4*E*3+7]=-p,i[4*E*3+8]=-O,o[4*E*3+9]=f,o[4*E*3+10]=P,o[4*E*3+11]=A,i[4*E*3+9]=S,i[4*E*3+10]=p,i[4*E*3+11]=O,s[6*E]=4*E,s[6*E+1]=4*E+1,s[6*E+2]=4*E+2,s[6*E+3]=4*E,s[6*E+4]=4*E+3,s[6*E+5]=4*E+1}var v=0;for(var m in a.pointers){var N=a.pointers[m];v+=o.length/3*N.num_comp}var g={};g[Ze]=v;var I=a.vbo_source_data=Pe(g);t.update_bufs_data_index_array(a,e.draw_mode,s);var b=0;for(var m in a.pointers){var N=a.pointers[m];switch(m){case"a_position":Ie(I,m,o,b),N.offset=b,N.length=o.length,b+=N.length;break;case"a_direction":Ie(I,m,i,b),N.offset=b,N.length=i.length,b+=N.length;break;default:N.offset=b,N.length=o.length/3*N.num_comp;Ie(I,m,new Float32Array(N.length),b),b+=N.length}}R(a)}},t.clone_bufs_data=function(e){if(e){var t=S();if(e.ibo_array)switch(e.ibo_type){case Je.UNSIGNED_SHORT:t.ibo_array=new Uint16Array(e.ibo_array);break;case Je.UNSIGNED_INT:t.ibo_array=new Uint32Array(e.ibo_array)}else t.ibo_array=null;t.vbo_source_data=Se(e.vbo_source_data),t.ibo_type=e.ibo_type,t.count=e.count,t.pointers=d.O(e.pointers),t.usage=e.usage,t.debug_ibo_bytes=e.debug_ibo_bytes,t.debug_vbo_bytes=e.debug_vbo_bytes,t.ibo=null,t.info_for_z_sort_updates=d.O(e.info_for_z_sort_updates),t.shape_keys=d.O(e.shape_keys),t.instance_count=e.instance_count,t.cleanup_gl_data_on_unload=e.cleanup_gl_data_on_unload}else var t=null;return t},t.init_submesh=fe,t.clone_submesh=function(e){var t=fe(e.name);return t.base_length=e.base_length,t.indices=d.O(e.indices),t.va_frames=d.O(e.va_frames),t.va_common=d.O(e.va_common),t.shape_keys=d.O(e.shape_keys),o.o(e.submesh_bd.bb_local,t.submesh_bd.bb_local),o.s(e.submesh_bd.be_local,t.submesh_bd.be_local),o.u(e.submesh_bd.bs_local,t.submesh_bd.bs_local),o.v(e.submesh_bd.bbr_local,t.submesh_bd.bbr_local),t.instanced_array_data=d.O(e.instanced_array_data),t},t.reset=function(){Je=null},t.init_vbo_source_data=Pe,t.search_vbo_index_by_type=pe,t.get_vbo_by_type=Oe,t.get_vbo_source_by_type=ve,t.get_constructor_by_type=me,t.get_vbo_type_by_attr_name=Ne,t.get_type_size_by_attr_name=ge,t.get_gl_type_by_attr_name=Re,t.vbo_source_data_set_attr=Ie,t.value_vbo_to_float=be,t.value_float_to_vbo=he,t.array_vbo_to_float=Ye,t.array_float_to_vbo=Le,t.create_empty_va_frame=function(){return{a_position:new Float32Array(0),a_tbn:l.c(0)}}}var a=_(0),n=_(5),o=_(25),i=_(30),s=_(28),E=_(1),c=_(9),l=_(36),T=_(6),d=_(2),u=_(3),f=Object(a.a)("__geometry",r);t.a=f},function(e,t,_){"use strict";function r(){var e=new C(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function a(e){var t=new C(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function n(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function o(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function i(e,t){if(t===e){var _=e[1],r=e[2],a=e[3],n=e[6],o=e[7],i=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=_,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=n,t[11]=e[14],t[12]=a,t[13]=o,t[14]=i}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function s(e,t){var _=e[0],r=e[1],a=e[2],n=e[3],o=e[4],i=e[5],s=e[6],E=e[7],c=e[8],l=e[9],T=e[10],d=e[11],u=e[12],f=e[13],P=e[14],A=e[15],S=_*i-r*o,p=_*s-a*o,O=_*E-n*o,v=r*s-a*i,m=r*E-n*i,N=a*E-n*s,g=c*f-l*u,R=c*P-T*u,I=c*A-d*u,b=l*P-T*f,h=l*A-d*f,Y=T*A-d*P,L=S*Y-p*h+O*b+v*I-m*R+N*g;return L?(L=1/L,t[0]=(i*Y-s*h+E*b)*L,t[1]=(a*h-r*Y-n*b)*L,t[2]=(f*N-P*m+A*v)*L,t[3]=(T*m-l*N-d*v)*L,t[4]=(s*I-o*Y-E*R)*L,t[5]=(_*Y-a*I+n*R)*L,t[6]=(P*O-u*N-A*p)*L,t[7]=(c*N-T*O+d*p)*L,t[8]=(o*h-i*I+E*g)*L,t[9]=(r*I-_*h-n*g)*L,t[10]=(u*m-f*O+A*S)*L,t[11]=(l*O-c*m-d*S)*L,t[12]=(i*R-o*b-s*g)*L,t[13]=(_*b-r*R+a*g)*L,t[14]=(f*p-u*v-P*S)*L,t[15]=(c*v-l*p+T*S)*L,t):null}function E(e,t){var _=e[0],r=e[1],a=e[2],n=e[3],o=e[4],i=e[5],s=e[6],E=e[7],c=e[8],l=e[9],T=e[10],d=e[11],u=e[12],f=e[13],P=e[14],A=e[15];return t[0]=i*(T*A-d*P)-l*(s*A-E*P)+f*(s*d-E*T),t[1]=-(r*(T*A-d*P)-l*(a*A-n*P)+f*(a*d-n*T)),t[2]=r*(s*A-E*P)-i*(a*A-n*P)+f*(a*E-n*s),t[3]=-(r*(s*d-E*T)-i*(a*d-n*T)+l*(a*E-n*s)),t[4]=-(o*(T*A-d*P)-c*(s*A-E*P)+u*(s*d-E*T)),t[5]=_*(T*A-d*P)-c*(a*A-n*P)+u*(a*d-n*T),t[6]=-(_*(s*A-E*P)-o*(a*A-n*P)+u*(a*E-n*s)),t[7]=_*(s*d-E*T)-o*(a*d-n*T)+c*(a*E-n*s),t[8]=o*(l*A-d*f)-c*(i*A-E*f)+u*(i*d-E*l),t[9]=-(_*(l*A-d*f)-c*(r*A-n*f)+u*(r*d-n*l)),t[10]=_*(i*A-E*f)-o*(r*A-n*f)+u*(r*E-n*i),t[11]=-(_*(i*d-E*l)-o*(r*d-n*l)+c*(r*E-n*i)),t[12]=-(o*(l*P-T*f)-c*(i*P-s*f)+u*(i*T-s*l)),t[13]=_*(l*P-T*f)-c*(r*P-a*f)+u*(r*T-a*l),t[14]=-(_*(i*P-s*f)-o*(r*P-a*f)+u*(r*s-a*i)),t[15]=_*(i*T-s*l)-o*(r*T-a*l)+c*(r*s-a*i),t}function c(e){var t=e[0],_=e[1],r=e[2],a=e[3],n=e[4],o=e[5],i=e[6],s=e[7],E=e[8],c=e[9],l=e[10],T=e[11],d=e[12],u=e[13],f=e[14],P=e[15];return(t*o-_*n)*(l*P-T*f)-(t*i-r*n)*(c*P-T*u)+(t*s-a*n)*(c*f-l*u)+(_*i-r*o)*(E*P-T*d)-(_*s-a*o)*(E*f-l*d)+(r*s-a*i)*(E*u-c*d)}function l(e,t,_){var r=e[0],a=e[1],n=e[2],o=e[3],i=e[4],s=e[5],E=e[6],c=e[7],l=e[8],T=e[9],d=e[10],u=e[11],f=e[12],P=e[13],A=e[14],S=e[15],p=t[0],O=t[1],v=t[2],m=t[3];return _[0]=p*r+O*i+v*l+m*f,_[1]=p*a+O*s+v*T+m*P,_[2]=p*n+O*E+v*d+m*A,_[3]=p*o+O*c+v*u+m*S,p=t[4],O=t[5],v=t[6],m=t[7],_[4]=p*r+O*i+v*l+m*f,_[5]=p*a+O*s+v*T+m*P,_[6]=p*n+O*E+v*d+m*A,_[7]=p*o+O*c+v*u+m*S,p=t[8],O=t[9],v=t[10],m=t[11],_[8]=p*r+O*i+v*l+m*f,_[9]=p*a+O*s+v*T+m*P,_[10]=p*n+O*E+v*d+m*A,_[11]=p*o+O*c+v*u+m*S,p=t[12],O=t[13],v=t[14],m=t[15],_[12]=p*r+O*i+v*l+m*f,_[13]=p*a+O*s+v*T+m*P,_[14]=p*n+O*E+v*d+m*A,_[15]=p*o+O*c+v*u+m*S,_}function T(e,t,_){var r,a,n,o,i,s,E,c,l,T,d,u,f=t[0],P=t[1],A=t[2];return e===_?(_[12]=e[0]*f+e[4]*P+e[8]*A+e[12],_[13]=e[1]*f+e[5]*P+e[9]*A+e[13],_[14]=e[2]*f+e[6]*P+e[10]*A+e[14],_[15]=e[3]*f+e[7]*P+e[11]*A+e[15]):(r=e[0],a=e[1],n=e[2],o=e[3],i=e[4],s=e[5],E=e[6],c=e[7],l=e[8],T=e[9],d=e[10],u=e[11],_[0]=r,_[1]=a,_[2]=n,_[3]=o,_[4]=i,_[5]=s,_[6]=E,_[7]=c,_[8]=l,_[9]=T,_[10]=d,_[11]=u,_[12]=r*f+i*P+l*A+e[12],_[13]=a*f+s*P+T*A+e[13],_[14]=n*f+E*P+d*A+e[14],_[15]=o*f+c*P+u*A+e[15]),_}function d(e,t,_){var r=t[0],a=t[1],n=t[2];return _[0]=e[0]*r,_[1]=e[1]*r,_[2]=e[2]*r,_[3]=e[3]*r,_[4]=e[4]*a,_[5]=e[5]*a,_[6]=e[6]*a,_[7]=e[7]*a,_[8]=e[8]*n,_[9]=e[9]*n,_[10]=e[10]*n,_[11]=e[11]*n,_[12]=e[12],_[13]=e[13],_[14]=e[14],_[15]=e[15],_}function u(e,t,_,r){var a,n,o,i,s,E,c,l,T,d,u,f,P,A,S,p,O,v,m,N,g,R,I,b,h=_[0],Y=_[1],L=_[2],M=Math.sqrt(h*h+Y*Y+L*L);return Math.abs(M)<w?null:(M=1/M,h*=M,Y*=M,L*=M,a=Math.sin(t),n=Math.cos(t),o=1-n,i=e[0],s=e[1],E=e[2],c=e[3],l=e[4],T=e[5],d=e[6],u=e[7],f=e[8],P=e[9],A=e[10],S=e[11],p=h*h*o+n,O=Y*h*o+L*a,v=L*h*o-Y*a,m=h*Y*o-L*a,N=Y*Y*o+n,g=L*Y*o+h*a,R=h*L*o+Y*a,I=Y*L*o-h*a,b=L*L*o+n,r[0]=i*p+l*O+f*v,r[1]=s*p+T*O+P*v,r[2]=E*p+d*O+A*v,r[3]=c*p+u*O+S*v,r[4]=i*m+l*N+f*g,r[5]=s*m+T*N+P*g,r[6]=E*m+d*N+A*g,r[7]=c*m+u*N+S*g,r[8]=i*R+l*I+f*b,r[9]=s*R+T*I+P*b,r[10]=E*R+d*I+A*b,r[11]=c*R+u*I+S*b,e!==r&&(r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r)}function f(e,t,_){var r=Math.sin(t),a=Math.cos(t),n=e[4],o=e[5],i=e[6],s=e[7],E=e[8],c=e[9],l=e[10],T=e[11];return e!==_&&(_[0]=e[0],_[1]=e[1],_[2]=e[2],_[3]=e[3],_[12]=e[12],_[13]=e[13],_[14]=e[14],_[15]=e[15]),_[4]=n*a+E*r,_[5]=o*a+c*r,_[6]=i*a+l*r,_[7]=s*a+T*r,_[8]=E*a-n*r,_[9]=c*a-o*r,_[10]=l*a-i*r,_[11]=T*a-s*r,_}function P(e,t,_){var r=Math.sin(t),a=Math.cos(t),n=e[0],o=e[1],i=e[2],s=e[3],E=e[8],c=e[9],l=e[10],T=e[11];return e!==_&&(_[4]=e[4],_[5]=e[5],_[6]=e[6],_[7]=e[7],_[12]=e[12],_[13]=e[13],_[14]=e[14],_[15]=e[15]),_[0]=n*a-E*r,_[1]=o*a-c*r,_[2]=i*a-l*r,_[3]=s*a-T*r,_[8]=n*r+E*a,_[9]=o*r+c*a,_[10]=i*r+l*a,_[11]=s*r+T*a,_}function A(e,t,_){var r=Math.sin(t),a=Math.cos(t),n=e[0],o=e[1],i=e[2],s=e[3],E=e[4],c=e[5],l=e[6],T=e[7];return e!==_&&(_[8]=e[8],_[9]=e[9],_[10]=e[10],_[11]=e[11],_[12]=e[12],_[13]=e[13],_[14]=e[14],_[15]=e[15]),_[0]=n*a+E*r,_[1]=o*a+c*r,_[2]=i*a+l*r,_[3]=s*a+T*r,_[4]=E*a-n*r,_[5]=c*a-o*r,_[6]=l*a-i*r,_[7]=T*a-s*r,_}function S(e,t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function p(e,t){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function O(e,t,_){var r,a,n,o=t[0],i=t[1],s=t[2],E=Math.sqrt(o*o+i*i+s*s);return Math.abs(E)<w?null:(E=1/E,o*=E,i*=E,s*=E,r=Math.sin(e),a=Math.cos(e),n=1-a,_[0]=o*o*n+a,_[1]=i*o*n+s*r,_[2]=s*o*n-i*r,_[3]=0,_[4]=o*i*n-s*r,_[5]=i*i*n+a,_[6]=s*i*n+o*r,_[7]=0,_[8]=o*s*n+i*r,_[9]=i*s*n-o*r,_[10]=s*s*n+a,_[11]=0,_[12]=0,_[13]=0,_[14]=0,_[15]=1,_)}function v(e,t){var _=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=_,t[7]=0,t[8]=0,t[9]=-_,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function m(e,t){var _=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-_,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=_,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function N(e,t){var _=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=_,t[2]=0,t[3]=0,t[4]=-_,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function g(e,t,_){var r=e[0],a=e[1],n=e[2],o=e[3],i=r+r,s=a+a,E=n+n,c=r*i,l=r*s,T=r*E,d=a*s,u=a*E,f=n*E,P=o*i,A=o*s,S=o*E;return _[0]=1-(d+f),_[1]=l+S,_[2]=T-A,_[3]=0,_[4]=l-S,_[5]=1-(c+f),_[6]=u+P,_[7]=0,_[8]=T+A,_[9]=u-P,_[10]=1-(c+d),_[11]=0,_[12]=t[0],_[13]=t[1],_[14]=t[2],_[15]=1,_}function R(e,t,_,r){var a=e[0],n=e[1],o=e[2],i=e[3],s=a+a,E=n+n,c=o+o,l=a*s,T=a*E,d=a*c,u=n*E,f=n*c,P=o*c,A=i*s,S=i*E,p=i*c,O=_[0],v=_[1],m=_[2];return r[0]=(1-(u+P))*O,r[1]=(T+p)*O,r[2]=(d-S)*O,r[3]=0,r[4]=(T-p)*v,r[5]=(1-(l+P))*v,r[6]=(f+A)*v,r[7]=0,r[8]=(d+S)*m,r[9]=(f-A)*m,r[10]=(1-(l+u))*m,r[11]=0,r[12]=t[0],r[13]=t[1],r[14]=t[2],r[15]=1,r}function I(e,t,_,r,a){var n=e[0],o=e[1],i=e[2],s=e[3],E=n+n,c=o+o,l=i+i,T=n*E,d=n*c,u=n*l,f=o*c,P=o*l,A=i*l,S=s*E,p=s*c,O=s*l,v=_[0],m=_[1],N=_[2],g=r[0],R=r[1],I=r[2];return a[0]=(1-(f+A))*v,a[1]=(d+O)*v,a[2]=(u-p)*v,a[3]=0,a[4]=(d-O)*m,a[5]=(1-(T+A))*m,a[6]=(P+S)*m,a[7]=0,a[8]=(u+p)*N,a[9]=(P-S)*N,a[10]=(1-(T+f))*N,a[11]=0,a[12]=t[0]+g-(a[0]*g+a[4]*R+a[8]*I),a[13]=t[1]+R-(a[1]*g+a[5]*R+a[9]*I),a[14]=t[2]+I-(a[2]*g+a[6]*R+a[10]*I),a[15]=1,a}function b(e,t){var _=e[0],r=e[1],a=e[2],n=e[3],o=_+_,i=r+r,s=a+a,E=_*o,c=r*o,l=r*i,T=a*o,d=a*i,u=a*s,f=n*o,P=n*i,A=n*s;return t[0]=1-l-u,t[1]=c+A,t[2]=T-P,t[3]=0,t[4]=c-A,t[5]=1-E-u,t[6]=d+f,t[7]=0,t[8]=T+P,t[9]=d-f,t[10]=1-E-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function h(e,t,_,r,a,n,o){var i=1/(t-e),s=1/(r-_),E=1/(a-n);return o[0]=2*a*i,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2*a*s,o[6]=0,o[7]=0,o[8]=(t+e)*i,o[9]=(r+_)*s,o[10]=(n+a)*E,o[11]=-1,o[12]=0,o[13]=0,o[14]=n*a*2*E,o[15]=0,o}function Y(e,t,_,r,a){var n=1/Math.tan(e/2),o=1/(_-r);return a[0]=n/t,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=n,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=(r+_)*o,a[11]=-1,a[12]=0,a[13]=0,a[14]=2*r*_*o,a[15]=0,a}function L(e,t,_,r){var a=Math.tan(e.upDegrees*Math.PI/180),n=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),i=Math.tan(e.rightDegrees*Math.PI/180),s=2/(o+i),E=2/(a+n);return r[0]=s,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=E,r[6]=0,r[7]=0,r[8]=-(o-i)*s*.5,r[9]=(a-n)*E*.5,r[10]=_/(t-_),r[11]=-1,r[12]=0,r[13]=0,r[14]=_*t/(t-_),r[15]=0,r}function M(e,t,_,r,a,n,o){var i=1/(e-t),s=1/(_-r),E=1/(a-n);return o[0]=-2*i,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=-2*s,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=2*E,o[11]=0,o[12]=(e+t)*i,o[13]=(r+_)*s,o[14]=(n+a)*E,o[15]=1,o}function x(e,t,_,r){var a,n,i,s,E,c,l,T,d,u,f=e[0],P=e[1],A=e[2],S=_[0],p=_[1],O=_[2],v=t[0],m=t[1],N=t[2];return Math.abs(f-v)<w&&Math.abs(P-m)<w&&Math.abs(A-N)<w?o(r):(l=f-v,T=P-m,d=A-N,u=1/Math.sqrt(l*l+T*T+d*d),l*=u,T*=u,d*=u,a=p*d-O*T,n=O*l-S*d,i=S*T-p*l,u=Math.sqrt(a*a+n*n+i*i),u?(u=1/u,a*=u,n*=u,i*=u):(a=0,n=0,i=0),s=T*i-d*n,E=d*a-l*i,c=l*n-T*a,u=Math.sqrt(s*s+E*E+c*c),u?(u=1/u,s*=u,E*=u,c*=u):(s=0,E=0,c=0),r[0]=a,r[1]=s,r[2]=l,r[3]=0,r[4]=n,r[5]=E,r[6]=T,r[7]=0,r[8]=i,r[9]=c,r[10]=d,r[11]=0,r[12]=-(a*f+n*P+i*A),r[13]=-(s*f+E*P+c*A),r[14]=-(l*f+T*P+d*A),r[15]=1,r)}function y(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function U(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))}Object.defineProperty(t,"__esModule",{value:!0}),t.create=r,t.clone=a,t.copy=n,t.identity=o,t.transpose=i,t.invert=s,t.adjoint=E,t.determinant=c,t.multiply=l,_.d(t,"mul",function(){return l}),t.translate=T,t.scale=d,t.rotate=u,t.rotateX=f,t.rotateY=P,t.rotateZ=A,t.fromTranslation=S,t.fromScaling=p,t.fromRotation=O,t.fromXRotation=v,t.fromYRotation=m,t.fromZRotation=N,t.fromRotationTranslation=g,t.fromRotationTranslationScale=R,t.fromRotationTranslationScaleOrigin=I,t.fromQuat=b,t.frustum=h,t.perspective=Y,t.perspectiveFromFieldOfView=L,t.ortho=M,t.lookAt=x,t.str=y,t.frob=U;var w=1e-7,C="undefined"!=typeof Float32Array?Float32Array:Array;Math.random},function(e,t,_){"use strict";function r(e,t){function _(e){for(var t=e.camera,_=t.color_attachment,r=_.w_texture,a=0;a<6;a++){var n=Y(a);t.view_matrix=e.cube_view_matrices[a],P.d(t.view_matrix,t.view_tsr),w.calc_sky_vp_inverse(t),$.framebufferTexture2D($.FRAMEBUFFER,$.COLOR_ATTACHMENT0,n,r,0),N(e);for(var o=e.draw_data,i=0;i<o.length;i++)for(var s=0;s<o[i].bundles.length;s++){var E=o[i].bundles[s];E.do_render=E.do_render_cube[a]}O(e)}}function r(e){var t=e.camera;$.bindFramebuffer($.READ_FRAMEBUFFER,t.framebuffer_prev),$.bindFramebuffer($.DRAW_FRAMEBUFFER,t.framebuffer);var _=0;t.color_attachment&&(_|=$.COLOR_BUFFER_BIT),t.depth_attachment&&(_|=$.DEPTH_BUFFER_BIT),$.blitFramebuffer(0,0,t.width,t.height,0,0,t.width,t.height,_,$.NEAREST)}function a(e){var t=e.camera;$.bindFramebuffer($.FRAMEBUFFER,t.framebuffer_prev);var _=t.color_attachment,r=_.w_texture;$.bindTexture($.TEXTURE_2D,r),$.copyTexSubImage2D($.TEXTURE_2D,0,0,0,0,0,t.width,t.height,0)}function O(e){for(var t=e.camera,_=e.draw_data,r=null,a=P.i(t.world_tsr,oe),n=0;n<_.length;n++){var o=_[n];if(o.do_render){var i=o.shader,s=o.bundles;i.program!=r&&($.useProgram(i.program),v(e,t,i),r=i.program),o.alpha_antialiasing?($.enable($.SAMPLE_ALPHA_TO_COVERAGE),e.blend||$.enable($.BLEND)):($.disable($.SAMPLE_ALPHA_TO_COVERAGE),e.blend||$.disable($.BLEND));for(var E=0;E<s.length;E++){var c=s[E];if(c.do_render){var l=c.obj_render,T=c.batch;G.start_batch(T),G.is_debug_view_render_time_mode()&&"DEBUG_VIEW"==T.type&&(T.debug_main_batch_render_time=A._50(U.batch_get_debug_storage(T.debug_main_batch_id),T.debug_main_batch_render_time,1,Z)),Ee.alpha_sort&&T.z_sort&&R(T,l,c.info_for_z_sort_updates,a),g(e,l,T,i),G.stop_batch(T),G.is_debug_view_render_time_mode()&&"MAIN"==T.type&&U.batch_set_debug_storage(T.id,T.debug_render_time)}}}}}function v(e,t,_){for(var r=_.transient_sc_uniform_setters,a=r.length;a--;){var n=r[a];n.fun($,n.loc,e,t)}if(_.need_uniforms_update&&!_.no_permanent_uniforms){_.permanent_sc_uniform_setters.length||M(_);for(var o=_.permanent_sc_uniform_setters,i=o.length;i--;){var n=o[i];n.fun($,n.loc,e,t)}}}function m(e){var t=e.camera;if($.bindFramebuffer($.FRAMEBUFFER,t.framebuffer),e.assign_texture){var _=t.color_attachment;$.framebufferTexture2D($.FRAMEBUFFER,$.COLOR_ATTACHMENT0,_.w_target,_.w_texture,0)}switch($.viewport(0,0,t.width,t.height),e.type!=B.MAIN_CUBE_REFLECT&&e.type!=B.MAIN_CUBE_REFLECT_BLEND&&N(e),e.blend?$.enable($.BLEND):$.disable($.BLEND),e.depth_test?$.enable($.DEPTH_TEST):$.disable($.DEPTH_TEST),e.type){case B.SHADOW_CAST:$.enable($.POLYGON_OFFSET_FILL),$.polygonOffset(e.self_shadow_polygon_offset,e.self_shadow_polygon_offset),$.cullFace($.BACK);break;case B.MAIN_PLANE_REFLECT:case B.MAIN_PLANE_REFLECT_BLEND:$.disable($.POLYGON_OFFSET_FILL),$.cullFace($.FRONT);break;case B.DEBUG_VIEW:$.enable($.POLYGON_OFFSET_FILL),$.polygonOffset(-4,-4),$.cullFace($.BACK);break;case B.MAIN_GLOW:if(Ee.msaa_samples>1||Ee.safari_glow_hack){$.enable($.POLYGON_OFFSET_FILL),$.polygonOffset(-2,-2);break}default:$.disable($.POLYGON_OFFSET_FILL),$.cullFace($.BACK)}}function N(e){if(e){var t=(e.clear_color?$.COLOR_BUFFER_BIT:0)|(e.clear_depth?$.DEPTH_BUFFER_BIT:0);if(!t)return;switch(e.type){case B.MAIN_GLOW:var _=V;break;case B.SHADOW_CAST:var _=j;break;case B.SHADOW_RECEIVE:var _=Q;break;case B.COLOR_PICKING:case B.COLOR_PICKING_XRAY:case B.ANCHOR_VISIBILITY:var _=z;break;case B.MAIN_OPAQUE:case B.OUTLINE_MASK:case B.SMAA_BLENDING_WEIGHT_CALCULATION:case B.SMAA_EDGE_DETECTION:var _=V;break;default:var _=Ee.background_color}}else var t=$.COLOR_BUFFER_BIT|$.DEPTH_BUFFER_BIT,_=Ee.background_color;$.colorMask(!0,!0,!0,!0),$.depthMask(!0),$.clearColor(_[0],_[1],_[2],_[3]),$.clear(t)}function g(e,t,_,r){for(var a=r.transient_uniform_setters,n=a.length;n--;){var o=a[n];o.fun($,o.loc,t,_)}if(r.need_uniforms_update&&!r.no_permanent_uniforms){r.permanent_uniform_setters.length||M(r);for(var i=r.permanent_uniform_setters,s=i.length;s--;){var o=i[s];o.fun($,o.loc,t,_)}r.need_uniforms_update=!1}$.depthMask(_.depth_mask),H&&(_.use_backface_culling?$.enable($.CULL_FACE):$.disable($.CULL_FACE)),x(_.textures),e.type==B.SKY||e.type==B.IRRADIANCE?(I(e,_,r),e.debug_render_calls+=6):e.type==B.ROUGHNESS_CONVOLUTION?(b(e,_,r),e.debug_render_calls+=30):(ne(_,t.va_frame),e.debug_render_calls++)}function R(e,t,_,r){var a=e.bufs_data;(p.dist(r,_.zsort_eye_last)>Ee.alpha_sort_threshold*Math.min(_.bb_min_side,1)||t.force_zsort)&&(K.update_buffers_movable(a,_,t.world_tsr,r),p.copy(r,_.zsort_eye_last),t.force_zsort=!1)}function I(e,t,_){for(var r=e.camera,a=_.uniforms,n=r.color_attachment,o=n.w_texture,i=n.w_target,s=e.cube_view_matrices,E=0;E<6;E++){var c=Y(E);if(Ee.clear_procedural_sky_hack){var l=$.TEXTURE_CUBE_MAP;$.bindTexture(l,o),$.texImage2D(c,0,$.RGBA,1,1,0,$.RGBA,$.UNSIGNED_BYTE,q)}else $.uniformMatrix4fv(a.u_cube_view_matrix,!1,s[E]),$.uniform4fv(a.u_sky_tex_fac,e.sky_tex_fac),$.uniform3fv(a.u_sky_tex_color,e.sky_tex_color),$.uniform1f(a.u_sky_tex_dvar,e.sky_tex_default_value),$.uniform3fv(a.u_horizon_color,e.horizon_color),$.uniform3fv(a.u_zenith_color,e.zenith_color),$.framebufferTexture2D($.FRAMEBUFFER,$.COLOR_ATTACHMENT0,c,o,0),ne(t,0);e.need_fog_update&&E!=J&&h(e,E)}Ee.texture_lod_available&&($.bindTexture(i,o),$.generateMipmap(i),$.texParameteri(i,$.TEXTURE_MIN_FILTER,X.TF_LINEAR_MIPMAP_LINEAR)),$.bindFramebuffer($.FRAMEBUFFER,null)}function b(e,t,_){var r=e.camera,a=_.uniforms,n=r.color_attachment,o=n.w_texture,i=n.w_target,s=e.cube_view_matrices;Ee.texture_lod_available&&($.activeTexture($.TEXTURE7),$.bindTexture(i,o),$.generateMipmap(i),$.texParameteri(i,$.TEXTURE_MIN_FILTER,X.TF_LINEAR_MIPMAP_LINEAR));for(var E=0;E<5;++E){var c=128*Math.pow(.5,E),l=128*Math.pow(.5,E);$.viewport(0,0,c,l);for(var T=E/4,d=0;d<6;d++){var u=Y(d);$.uniformMatrix4fv(a.u_cube_view_matrix,!1,s[d]),$.uniform1f(a.u_roughness,T),$.framebufferTexture2D($.FRAMEBUFFER,$.COLOR_ATTACHMENT0,u,o,E),ne(t,0)}}}function h(e,t){var _=se;Ee.clear_procedural_sky_hack?_.set(q):($.readPixels(191,191,1,1,$.RGBA,$.UNSIGNED_BYTE,_),255!=_[0]&&255!=_[1]&&255!=_[2]||$.readPixels(191,220,1,1,$.RGBA,$.UNSIGNED_BYTE,_));var r=_[0],a=_[1],n=_[2];r/=255,a/=255,n/=255,t===W?(e.cube_fog[3]=r,e.cube_fog[7]=a,e.cube_fog[11]=n):(e.cube_fog[4*t]=r,e.cube_fog[4*t+1]=a,e.cube_fog[4*t+2]=n)}function Y(e){switch(e){case 0:return $.TEXTURE_CUBE_MAP_POSITIVE_X;case 1:return $.TEXTURE_CUBE_MAP_NEGATIVE_X;case 2:return $.TEXTURE_CUBE_MAP_POSITIVE_Y;case 3:return $.TEXTURE_CUBE_MAP_NEGATIVE_Y;case 4:return $.TEXTURE_CUBE_MAP_POSITIVE_Z;case 5:return $.TEXTURE_CUBE_MAP_NEGATIVE_Z}}function L(e){var t=k.get_vertex_array_object(),_=e.attribute_setters,r=e.bufs_data,a=r.pointers;e.vaos.length=0;var n=1;for(var o in a)n=Math.max(n,a[o].frames);for(var i=0;i<n;i++){var s=t.createVertexArray();ae(s),r.ibo&&$.bindBuffer($.ELEMENT_ARRAY_BUFFER,r.ibo);for(var E=0;E<r.vbo_data.length;E++){$.bindBuffer($.ARRAY_BUFFER,r.vbo_data[E].vbo);for(var c=0;c<_.length;c++){var l=_[c];if(l.vbo_type==r.vbo_data[E].type){$.enableVertexAttribArray(l.loc);var T=l.base_offset+l.frame_length*i,d=l.gl_type!=$.FLOAT;$.vertexAttribPointer(l.loc,l.num_comp,l.gl_type,d,0,T),_e(l.loc,l.divisor)}}}ae(null),e.vaos.push(s)}}function M(e){var t=e.uniforms,_=e.transient_uniform_setters,r=e.permanent_uniform_setters,a=e.transient_sc_uniform_setters,n=e.permanent_sc_uniform_setters;_.length=0,r.length=0,a.length=0,n.length=0;for(var o in t){var i=!1,s=null,E=null;switch(o){case"u_proj_matrix":s=function(e,t,_,r){e.uniformMatrix4fv(t,!1,r.proj_matrix)},i=!0;break;case"u_view_refl_matrix":s=function(e,t,_,r){e.uniformMatrix4fv(t,!1,r.view_refl_matrix)},i=!0;break;case"u_view_tsr":case"u_view_tsr_frag":s=function(e,t,_,r){r.reflection_plane?e.uniformMatrix3fv(t,!1,r.real_view_tsr):e.uniformMatrix3fv(t,!1,r.view_tsr)},i=!0;break;case"u_view_tsr_inverse":s=function(e,t,_,r){r.reflection_plane?e.uniformMatrix3fv(t,!1,r.real_view_tsr_inv):e.uniformMatrix3fv(t,!1,r.view_tsr_inv)},i=!0;break;case"u_shadow_cast_billboard_view_tsr":s=function(e,t,_,r){e.uniformMatrix3fv(t,!1,r.shadow_cast_billboard_view_tsr)},i=!0;break;case"u_view_proj_prev":s=function(e,t,_,r){e.uniformMatrix4fv(t,!1,r.prev_view_proj_matrix)},i=!0;break;case"u_view_proj_matrix":s=function(e,t,_,r){e.uniformMatrix4fv(t,!1,r.view_proj_matrix)},i=!0;break;case"u_view_proj_inverse":s=function(e,t,_,r){e.uniformMatrix4fv(t,!1,r.view_proj_inv_matrix)},i=!0;break;case"u_sky_vp_inverse":s=function(e,t,_,r){e.uniformMatrix4fv(t,!1,r.sky_vp_inv_matrix)},i=!0;break;case"u_camera_eye":case"u_camera_eye_frag":s=function(e,t,_,r){e.uniform3fv(t,P.i(r.world_tsr,oe))},i=!0;break;case"u_camera_quat":s=function(e,t,_,r){e.uniform4fv(t,P.f(r.world_tsr,ie))},i=!0;break;case"u_view_max_depth":s=function(e,t,_,r){e.uniform1f(t,r.far)},i=!0;break;case"u_camera_range":s=function(e,t,_,r){e.uniform2f(t,r.near,r.far)},i=!0;break;case"u_csm_center_dists":s=function(e,t,_,r){e.uniform4fv(t,r.csm_center_dists)};break;case"u_height":s=function(e,t,_,r){e.uniform1f(t,r.height)},i=!0;break;case"u_pcf_blur_radii":s=function(e,t,_,r){e.uniform4fv(t,r.pcf_blur_radii)};break;case"u_dof_dist":s=function(e,t,_,r){r.dof_on?e.uniform1f(t,r.dof_distance):e.uniform1f(t,0)},i=!0;break;case"u_dof_front_start":s=function(e,t,_,r){e.uniform1f(t,r.dof_front_start)},i=!0;break;case"u_dof_front_end":s=function(e,t,_,r){e.uniform1f(t,r.dof_front_end)},i=!0;break;case"u_dof_rear_start":s=function(e,t,_,r){e.uniform1f(t,r.dof_rear_start)},i=!0;break;case"u_dof_rear_end":s=function(e,t,_,r){e.uniform1f(t,r.dof_rear_end)},i=!0;break;case"u_dof_bokeh_intensity":s=function(e,t,_,r){e.uniform1f(t,r.dof_bokeh_intensity)},i=!0;break;case"u_camera_direction":s=function(e,t,_,r){e.uniform3fv(t,r.direction)},i=!0;break;case"u_cam_water_depth":s=function(e,t,_,r){e.uniform1f(t,_.cam_water_depth)},i=!0;break;case"u_fog_color_density":s=function(e,t,_,r){e.uniform4fv(t,_.fog_color_density)};break;case"u_fog_params":s=function(e,t,_,r){e.uniform4fv(t,_.fog_params)};break;case"u_underwater_fog_color_density":s=function(e,t,_,r){e.uniform4fv(t,_.water_fog_color_density)};break;case"u_bloom_key":s=function(e,t,_,r){e.uniform1f(t,_.bloom_key)};break;case"u_average_lum_val":s=function(e,t,_,r){e.uniform1f(t,_.average_luminance)};break;case"u_mipmap_1x1":s=function(e,t,_,r){e.uniform1f(t,_.last_mip_map_ind)};break;case"u_bloom_edge_lum":s=function(e,t,_,r){e.uniform1f(t,_.bloom_edge_lum)};break;case"u_time":s=function(e,t,_,r){e.uniform1f(t,_.time)},i=!0;break;case"u_wind":s=function(e,t,_,r){e.uniform3fv(t,_.wind)},i=!0;break;case"u_sky_tex_dvar":s=function(e,t,_,r){e.uniform1f(t,_.sky_tex_default_value)};break;case"u_sky_tex_fac":s=function(e,t,_,r){e.uniform4fv(t,_.sky_tex_fac)};break;case"u_sky_tex_color":s=function(e,t,_,r){e.uniform3fv(t,_.sky_tex_color)};break;case"u_horizon_color":s=function(e,t,_,r){e.uniform3fv(t,_.horizon_color)};break;case"u_zenith_color":s=function(e,t,_,r){e.uniform3fv(t,_.zenith_color)};break;case"u_environment_energy":s=function(e,t,_,r){e.uniform1f(t,_.environment_energy)};break;case"u_bsdf_cube_sky_dim":s=function(e,t,_,r){e.uniform1f(t,_.bsdf_cube_sky_dim)},i=!0;break;case"u_sky_color":s=function(e,t,_,r){e.uniform3fv(t,_.sky_color)};break;case"u_rayleigh_brightness":s=function(e,t,_,r){e.uniform1f(t,_.rayleigh_brightness)};break;case"u_mie_brightness":s=function(e,t,_,r){e.uniform1f(t,_.mie_brightness)};break;case"u_spot_brightness":s=function(e,t,_,r){e.uniform1f(t,_.spot_brightness)};break;case"u_scatter_strength":s=function(e,t,_,r){e.uniform1f(t,_.scatter_strength)};break;case"u_rayleigh_strength":s=function(e,t,_,r){e.uniform1f(t,_.rayleigh_strength)};break;case"u_mie_strength":s=function(e,t,_,r){e.uniform1f(t,_.mie_strength)};break;case"u_rayleigh_collection_power":s=function(e,t,_,r){e.uniform1f(t,_.rayleigh_collection_power)};break;case"u_mie_collection_power":s=function(e,t,_,r){e.uniform1f(t,_.mie_collection_power)};break;case"u_mie_distribution":s=function(e,t,_,r){e.uniform1f(t,_.mie_distribution)};break;case"u_light_positions":s=function(e,t,_,r){e.uniform4fv(t,_.light_positions)};break;case"u_light_directions":s=function(e,t,_,r){e.uniform3fv(t,_.light_directions)};break;case"u_light_color_intensities":s=function(e,t,_,r){e.uniform4fv(t,_.light_color_intensities)};break;case"u_sun_quaternion":s=function(e,t,_,r){e.uniform4fv(t,_.sun_quaternion)};break;case"u_sun_intensity":s=function(e,t,_,r){e.uniform3fv(t,_.sun_intensity)};break;case"u_sun_direction":s=function(e,t,_,r){e.uniform3fv(t,_.sun_direction)};break;case"u_debug_view_mode":s=function(e,t,_,r){e.uniform1i(t,_.debug_view_mode)};break;case"u_debug_colors_seed":s=function(e,t,_,r){e.uniform1f(t,_.debug_colors_seed)};break;case"u_debug_render_time_threshold":s=function(e,t,_,r){e.uniform1f(t,_.debug_render_time_threshold)};break;case"u_subpixel_jitter":s=function(e,t,_,r){e.uniform2fv(t,_.jitter_projection_space)},i=!0;break;case"u_subsample_indices":s=function(e,t,_,r){e.uniform4fv(t,_.jitter_subsample_ind)},i=!0;break;case"u_radial_blur_step":s=function(e,t,_,r){e.uniform1f(t,_.radial_blur_step)};break;case"u_god_rays_intensity":s=function(e,t,_,r){e.uniform1f(t,_.god_rays_intensity)};break;case"u_ssao_radius_increase":s=function(e,t,_,r){e.uniform1f(t,_.ssao_radius_increase)};break;case"u_ssao_blur_discard_value":s=function(e,t,_,r){e.uniform1f(t,_.ssao_blur_discard_value)},i=!0;break;case"u_ssao_influence":s=function(e,t,_,r){e.uniform1f(t,_.ssao_influence)};break;case"u_ssao_dist_factor":s=function(e,t,_,r){e.uniform1f(t,_.ssao_dist_factor)};break;case"u_texel_size":s=function(e,t,_,r){e.uniform2fv(t,_.texel_size)},i=!0;break;case"u_normal_offset":s=function(e,t,_,r){e.uniform1f(t,_.self_shadow_normal_offset)};break;case"u_v_light_ts":s=function(e,t,_,r){e.uniform4fv(t,_.v_light_ts)},i=!0;break;case"u_v_light_r":s=function(e,t,_,r){e.uniform4fv(t,_.v_light_r)},i=!0;break;case"u_v_light_tsr":s=function(e,t,_,r){e.uniformMatrix3fv(t,!1,_.v_light_tsr)},i=!0;break;case"u_p_light_matrix0":s=function(e,t,_,r){e.uniformMatrix4fv(t,!1,_.p_light_matrix[0])},i=!0;break;case"u_p_light_matrix1":s=function(e,t,_,r){e.uniformMatrix4fv(t,!1,_.p_light_matrix[1])},i=!0;break;case"u_p_light_matrix2":s=function(e,t,_,r){e.uniformMatrix4fv(t,!1,_.p_light_matrix[2])},i=!0;break;case"u_p_light_matrix3":s=function(e,t,_,r){e.uniformMatrix4fv(t,!1,_.p_light_matrix[3])},i=!0;break;case"u_outline_color":s=function(e,t,_,r){e.uniform3fv(t,_.outline_color)};break;case"u_draw_outline":s=function(e,t,_,r){e.uniform1f(t,_.draw_outline_flag)},i=!0;break;case"u_glow_mask_small_coeff":s=function(e,t,_,r){e.uniform1f(t,_.small_glow_mask_coeff)},i=!0;break;case"u_glow_mask_large_coeff":s=function(e,t,_,r){e.uniform1f(t,_.large_glow_mask_coeff)},i=!0;break;case"u_brightness":s=function(e,t,_,r){e.uniform1f(t,_.brightness)};break;case"u_contrast":s=function(e,t,_,r){e.uniform1f(t,_.contrast)};break;case"u_exposure":s=function(e,t,_,r){e.uniform1f(t,_.exposure)};break;case"u_saturation":s=function(e,t,_,r){e.uniform1f(t,_.saturation)};break;case"u_enable_hmd_stereo":s=function(e,t,_,r){e.uniform1i(t,_.enable_hmd_stereo)};break;case"u_distortion_params":s=function(e,t,_,r){e.uniform4fv(t,_.distortion_params)};break;case"u_chromatic_aberration_coefs":s=function(e,t,_,r){e.uniform4fv(t,_.chromatic_aberration_coefs)};break;case"u_motion_blur_exp":s=function(e,t,_,r){e.uniform1f(t,_.motion_blur_exp)},i=!0;break;case"u_motion_blur_decay_threshold":s=function(e,t,_,r){e.uniform1f(t,_.mb_decay_threshold)},i=!0;break;case"u_model_tsr":E=function(e,t,_,r){e.uniformMatrix3fv(t,!1,_.world_tsr)},i=!0;break;case"u_model_tsr_inverse":E=function(e,t,_,r){e.uniformMatrix3fv(t,!1,_.world_tsr_inv)},i=!0;break;case"u_transb":E=function(e,t,_,r){e.uniform4fv(t,_.trans_before)},i=!0;break;case"u_transa":E=function(e,t,_,r){e.uniform4fv(t,_.trans_after)},i=!0;break;case"u_arm_rel_trans":E=function(e,t,_,r){e.uniform4fv(t,_.arm_rel_trans)},i=!0;break;case"u_arm_rel_quat":E=function(e,t,_,r){e.uniform4fv(t,_.arm_rel_quat)},i=!0;break;case"u_quat":E=function(e,t,_,r){e.uniform4fv(t,P.f(_.world_tsr,ie))},i=!0;break;case"u_quatsb":E=function(e,t,_,r){e.uniform4fv(t,_.quats_before)},i=!0;break;case"u_quatsa":E=function(e,t,_,r){e.uniform4fv(t,_.quats_after)},i=!0;break;case"u_frame_factor":E=function(e,t,_,r){e.uniform1f(t,_.frame_factor)},i=!0;break;case"au_center_pos":E=function(e,t,_,r){e.uniform3fv(t,_.center_pos)},i=!0;break;case"au_wind_bending_amp":E=function(e,t,_,r){e.uniform1f(t,_.wind_bending_amp)},i=!0;break;case"au_wind_bending_freq":E=function(e,t,_,r){e.uniform1f(t,_.wind_bending_freq)},i=!0;break;case"au_detail_bending_freq":E=function(e,t,_,r){e.uniform1f(t,_.detail_bending_freq)},i=!0;break;case"au_detail_bending_amp":E=function(e,t,_,r){e.uniform1f(t,_.detail_bending_amp)},i=!0;break;case"au_branch_bending_amp":E=function(e,t,_,r){e.uniform1f(t,_.branch_bending_amp)},i=!0;break;case"u_node_values":E=function(e,t,_,r){e.uniform4fv(t,r.node_values)},i=!0;break;case"u_node_rgbs":E=function(e,t,_,r){e.uniform3fv(t,r.node_rgbs)},i=!0;break;case"u_lod_coverage":E=function(e,t,_,r){e.uniform1f(t,r.lod_settings.coverage)},i=!0;break;case"u_lod_cmp_logic":E=function(e,t,_,r){e.uniform1f(t,r.lod_settings.cmp_logic)},i=!0;break;case"u_diffuse_color":E=function(e,t,_,r){e.uniform4fv(t,r.diffuse_color)},i=!0;break;case"u_diffuse_intensity":E=function(e,t,_,r){e.uniform1f(t,r.diffuse_intensity)},i=!0;break;case"u_diffuse_params":E=function(e,t,_,r){e.uniform2fv(t,r.diffuse_params)},i=!0;break;case"u_emit":E=function(e,t,_,r){e.uniform1f(t,r.emit)},i=!0;break;case"u_ambient":E=function(e,t,_,r){e.uniform1f(t,r.ambient)},i=!0;break;case"u_specular_color":E=function(e,t,_,r){e.uniform3fv(t,r.specular_color)},i=!0;break;case"u_specular_alpha":E=function(e,t,_,r){e.uniform1f(t,r.specular_alpha)},i=!0;break;case"u_specular_params":E=function(e,t,_,r){e.uniform3fv(t,r.specular_params)},i=!0;break;case"u_reflect_factor":E=function(e,t,_,r){e.uniform1f(t,r.reflect_factor)},i=!0;break;case"u_mirror_factor":E=function(e,t,_,r){e.uniform1f(t,r.mirror_factor)},i=!0;break;case"u_grass_map_dim":E=function(e,t,_,r){e.uniform3fv(t,r.grass_map_dim)},i=!0;break;case"u_grass_size":E=function(e,t,_,r){e.uniform1f(t,r.grass_size)},i=!0;break;case"u_scale_threshold":E=function(e,t,_,r){e.uniform1f(t,r.grass_scale_threshold)},i=!0;break;case"u_cube_fog":E=function(e,t,_,r){e.uniformMatrix4fv(t,!1,r.cube_fog)};break;case"u_jitter_amp":E=function(e,t,_,r){e.uniform1f(t,r.jitter_amp)},i=!0;break;case"u_jitter_freq":E=function(e,t,_,r){e.uniform1f(t,r.jitter_freq)},i=!0;break;case"u_wireframe_edge_color":E=function(e,t,_,r){e.uniform3fv(t,r.wireframe_edge_color)};break;case"u_cluster_id":E=function(e,t,_,r){e.uniform1f(t,r.cluster_id)},i=!0;break;case"u_batch_debug_id_color":E=function(e,t,_,r){e.uniform1f(t,r.debug_id_color)},i=!0;break;case"u_batch_debug_main_render_time":E=function(e,t,_,r){e.uniform1f(t,r.debug_main_batch_render_time)},i=!0;break;case"u_refr_bump":E=function(e,t,_,r){e.uniform1f(t,r.refr_bump)},i=!0;break;case"u_line_width":E=function(e,t,_,r){e.uniform1f(t,r.line_width)},i=!0;break;case"u_lamp_light_positions":E=function(e,t,_,r){e.uniform3fv(t,r.lamp_light_positions)};break;case"u_lamp_light_directions":E=function(e,t,_,r){e.uniform3fv(t,r.lamp_light_directions)};break;case"u_lamp_light_color_intensities":E=function(e,t,_,r){e.uniform3fv(t,r.lamp_light_color_intensities)};break;case"u_halo_size":E=function(e,t,_,r){e.uniform1f(t,r.halo_size)},i=!0;break;case"u_halo_hardness":E=function(e,t,_,r){e.uniform1f(t,r.halo_hardness)},i=!0;break;case"u_halo_rings_color":E=function(e,t,_,r){e.uniform3fv(t,r.halo_rings_color)},i=!0;break;case"u_halo_lines_color":E=function(e,t,_,r){e.uniform3fv(t,r.halo_lines_color)},i=!0;break;case"u_halo_stars_blend":E=function(e,t,_,r){e.uniform1f(t,r.halo_stars_blend)},i=!0;break;case"u_halo_stars_height":E=function(e,t,_,r){e.uniform1f(t,r.halo_stars_height)},i=!0;break;case"u_fresnel_params":E=function(e,t,_,r){e.uniform2fv(t,r.fresnel_params)},i=!0;break;case"u_texture_scale":E=function(e,t,_,r){e.uniform3fv(t,r.texture_scale)},i=!0;break;case"u_parallax_scale":E=function(e,t,_,r){e.uniform1f(t,r.parallax_scale)},i=!0;break;case"u_color_id":E=function(e,t,_,r){e.uniform3fv(t,_.color_id)},i=!0;break;case"u_diffuse_color_factor":E=function(e,t,_,r){e.uniform1f(t,r.diffuse_color_factor)},i=!0;break;case"u_alpha_factor":E=function(e,t,_,r){e.uniform1f(t,r.alpha_factor)},i=!0;break;case"u_specular_color_factor":E=function(e,t,_,r){e.uniform1f(t,r.specular_color_factor)},i=!0;break;case"u_normal_factor":E=function(e,t,_,r){e.uniform1f(t,r.normal_factor)},i=!0;break;case"u_normalmap0_scale":E=function(e,t,_,r){e.uniform2fv(t,r.normalmap_scales[0])},i=!0;break;case"u_normalmap1_scale":E=function(e,t,_,r){e.uniform2fv(t,r.normalmap_scales[1])},i=!0;break;case"u_normalmap2_scale":E=function(e,t,_,r){e.uniform2fv(t,r.normalmap_scales[2])},i=!0;break;case"u_normalmap3_scale":E=function(e,t,_,r){e.uniform2fv(t,r.normalmap_scales[3])},i=!0;break;case"u_foam_factor":E=function(e,t,_,r){e.uniform1f(t,r.foam_factor)},i=!0;break;case"u_foam_uv_freq":E=function(e,t,_,r){e.uniform2fv(t,r.foam_uv_freq)},i=!0;break;case"u_foam_mag":E=function(e,t,_,r){e.uniform2fv(t,r.foam_mag)},i=!0;break;case"u_foam_scale":E=function(e,t,_,r){e.uniform2fv(t,r.foam_scale)},i=!0;break;case"u_water_norm_uv_velocity":E=function(e,t,_,r){e.uniform1f(t,r.water_norm_uv_velocity)},i=!0;break;case"u_shallow_water_col":E=function(e,t,_,r){e.uniform3fv(t,r.shallow_water_col)},i=!0;break;case"u_shore_water_col":E=function(e,t,_,r){e.uniform3fv(t,r.shore_water_col)},i=!0;break;case"u_water_shallow_col_fac":E=function(e,t,_,r){e.uniform1f(t,r.shallow_water_col_fac)},i=!0;break;case"u_water_shore_col_fac":E=function(e,t,_,r){e.uniform1f(t,r.shore_water_col_fac)},i=!0;break;case"u_p_length":E=function(e,t,_,r){e.uniform1f(t,r.particles_data.time_length)},i=!0;break;case"u_p_cyclic":E=function(e,t,_,r){e.uniform1i(t,r.particles_data.cyclic)},i=!0;break;case"u_p_max_lifetime":E=function(e,t,_,r){e.uniform1f(t,r.particles_data.lifetime)},i=!0;break;case"u_p_fade_in":E=function(e,t,_,r){e.uniform1f(t,r.particles_data.fade_in)},i=!0;break;case"u_p_fade_out":E=function(e,t,_,r){e.uniform1f(t,r.particles_data.fade_out)},i=!0;break;case"u_p_size":E=function(e,t,_,r){e.uniform1f(t,r.particles_data.size)},i=!0;break;case"u_p_alpha_start":E=function(e,t,_,r){e.uniform1f(t,r.particles_data.alpha_start)},i=!0;break;case"u_p_alpha_end":E=function(e,t,_,r){e.uniform1f(t,r.particles_data.alpha_end)},i=!0;break;case"u_p_nfactor":E=function(e,t,_,r){e.uniform1f(t,r.particles_data.nfactor)},i=!0;break;case"u_p_gravity":E=function(e,t,_,r){e.uniform1f(t,r.particles_data.gravity)},i=!0;break;case"u_p_mass":E=function(e,t,_,r){e.uniform1f(t,r.particles_data.mass)},i=!0;break;case"u_p_color_ramp":E=function(e,t,_,r){e.uniform4fv(t,r.particles_data.color_ramp)},i=!0;break;case"u_p_wind_fac":E=function(e,t,_,r){e.uniform1f(t,r.particles_data.wind_factor)},i=!0;break;case"u_p_time":E=function(e,t,_,r){e.uniform1f(t,r.particles_data.time)},i=!0;break;case"u_p_tilt":E=function(e,t,_,r){e.uniform1f(t,r.particles_data.tilt)},i=!0;break;case"u_p_tilt_rand":E=function(e,t,_,r){e.uniform1f(t,r.particles_data.tilt_rand)},i=!0;break;case"u_position":E=function(e,t,_,r){e.uniform3fv(t,r.anchor_positions)},i=!0;break;case"u_va_frame_factor":E=function(e,t,_,r){e.uniform1f(t,_.va_frame_factor)},i=!0;break;case"u_refl_plane":E=function(e,t,_,r){e.uniform4fv(t,_.reflection_plane)},i=!0;break;case"u_outline_intensity":E=function(e,t,_,r){e.uniform1f(t,_.outline_intensity)},i=!0;break;case"u_obj_info":E=function(e,t,_,r){e.uniform3fv(t,r.obj_info_params)},i=!0}if(E){var c={name:o,fun:E,loc:t[o]};i?_.push(c):r.push(c)}if(s){var c={name:o,fun:s,loc:t[o]};i?a.push(c):n.push(c)}}if(r.length||n.length){var l=e.permanent_uniform_setters_table;for(var T in l)delete l[T];for(var T=0;T<r.length;T++){var c=r[T];l[c.name]=c}for(var T=0;T<n.length;T++){var c=n[T];l[c.name]=c}}else e.no_permanent_uniforms=!0}function x(e){for(var t=$,_=0;_<e.length;_++){var r=e[_];t.activeTexture(t.TEXTURE0+_),t.bindTexture(r.w_target,r.w_texture),r.use_mipmap&&t.generateMipmap(r.w_target)}}function y(e,t,_,r,a,n){return $.bindFramebuffer($.FRAMEBUFFER,e),$.readPixels(t,_,r,a,$.RGBA,$.UNSIGNED_BYTE,n),$.bindFramebuffer($.FRAMEBUFFER,null),n}var U=Object(n.a)(e),w=Object(o.a)(e),C=Object(i.a)(e),D=Object(s.a)(e),F=Object(E.a)(e),G=Object(c.a)(e),k=Object(l.a)(e),K=Object(T.a)(e),B=Object(u.a)(e),X=Object(f.a)(e),H=!0,j=[1,0,0,1],Q=[1,1,1,1],z=[0,0,0,1],V=[0,0,0,0],q=new Uint8Array([91.8,142.8,.96*255,255]),W=4,J=5,Z=(new Float32Array([.25,-.25]),new Float32Array([-.25,.25]),new Float32Array([1,1,1,0]),new Float32Array([2,2,2,0]),15),$=null,ee=0,te=null,_e=null,re=null,ae=null,ne=null,oe=new Float32Array(3),ie=d.create(),se=new Uint8Array(4),Ee=C.defaults;t.setup_context=function(e){var t=Ee.background_color;e.clearColor(t[0],t[1],t[2],t[3]),e.clearDepth(1),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),H?(e.enable(e.CULL_FACE),e.frontFace(e.CCW),e.cullFace(e.BACK)):e.disable(e.CULL_FACE),e.enable(e.BLEND),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),$=e},t.draw=function(e){e.do_render&&!e.force_do_not_render&&(e.type==B.RESOLVE?(G.start_subs(e),r(e),G.stop_subs(e),F.gl("draw resolve")):e.type==B.COPY?(G.start_subs(e),a(e),G.stop_subs(e),F.gl("draw copy")):(G.start_subs(e),m(e),e.type==B.MAIN_CUBE_REFLECT||e.type==B.MAIN_CUBE_REFLECT_BLEND?_(e):O(e),G.stop_subs(e),F.gl("draw subscene: "+B.subs_label(e)),e.type==B.BRDF&&$.bindFramebuffer($.FRAMEBUFFER,null)))},t.clear=function(e){if(e){var t=e.camera;$.bindFramebuffer($.FRAMEBUFFER,t.framebuffer)}else{var _=Ee.background_color;if(_[0]===V[0]&&_[1]===V[1]&&_[2]===V[2]&&_[3]===V[3])return}N(e)},t.assign_attribute_setters=function(e){var t=e.attribute_setters;t.length=0;var _=e.bufs_data,r=e.shader,a=_.pointers,n=r.attributes;for(var o in n){var i=a[o],s=K.get_vbo_type_by_attr_name(o),E=K.get_gl_type_by_attr_name(o),c=K.get_type_size_by_attr_name(o),l={vbo_type:s,gl_type:E,loc:n[o],base_offset:i.offset*c,frame_length:i.frames>1?i.length*c:0,num_comp:i.num_comp,divisor:i.divisor};t.push(l)}if("DEBUG"==Object(S.d)())for(var o in a){var s=K.get_vbo_type_by_attr_name(o),T=K.search_vbo_index_by_type(_.vbo_data,s),d=_.vbo_data[T],u=e.shaders_info.vert+" | "+e.shaders_info.frag,f=a[o].length*a[o].frames*K.get_type_size_by_attr_name(o);D.fill_vbo_garbage_info(d.debug_id,u,o,f,o in n)}Ee.allow_vao_ext&&L(e)},t.assign_vao=L,t.cleanup_vao=function(e){for(var t=k.get_vertex_array_object(),_=0;_<e.vaos.length;_++)t.deleteVertexArray(e.vaos[_]);e.vaos.length=0},t.clone_attribute_setters=function(e){for(var t=[],_=0;_<e.length;_++){var r=e[_],a={vbo_type:r.vbo_type,gl_type:r.gl_type,loc:r.loc,base_offset:r.base_offset,frame_length:r.frame_length,num_comp:r.num_comp,divisor:r.divisor};t.push(a)}return t},t.assign_uniform_setters=M,t.assign_texture_uniforms=function(e){var t=e.shader,_=e.textures,r=e.texture_names;$.useProgram(t.program);for(var a=0;a<_.length;a++){var n=r[a];$.uniform1i(t.uniforms[n],a)}},t.read_pixels=y,t.update_batch_permanent_uniform=function(e,t){var _=e.shader;if(!_.no_permanent_uniforms){$.useProgram(_.program),_.permanent_uniform_setters.length||M(_);var r=_.permanent_uniform_setters_table[t];r.fun($,r.loc,null,e)}},t.render_target_create=function(e,t){var _=$.createFramebuffer();if($.bindFramebuffer($.FRAMEBUFFER,_),X.is_renderbuffer(e)){var r=e.w_renderbuffer;$.framebufferRenderbuffer($.FRAMEBUFFER,$.COLOR_ATTACHMENT0,$.RENDERBUFFER,r)}else if(X.is_texture(e)){var a=e,n=a.w_texture,o=a.w_target==$.TEXTURE_CUBE_MAP?$.TEXTURE_CUBE_MAP_NEGATIVE_Z:a.w_target;$.framebufferTexture2D($.FRAMEBUFFER,$.COLOR_ATTACHMENT0,o,n,0)}if(X.is_renderbuffer(t)){var r=t.w_renderbuffer;$.framebufferRenderbuffer($.FRAMEBUFFER,$.DEPTH_ATTACHMENT,$.RENDERBUFFER,r)}else if(X.is_texture(t)){var a=t,n=a.w_texture,o=a.w_target;$.framebufferTexture2D($.FRAMEBUFFER,$.DEPTH_ATTACHMENT,o,n,0)}return F.bound_fb(),$.bindFramebuffer($.FRAMEBUFFER,null),_},t.render_target_cleanup=function(e,t,_,r,a){if(null==e)return $.bindFramebuffer($.FRAMEBUFFER,e),$.viewport(0,0,r,a),void $.clear($.COLOR_BUFFER_BIT|$.DEPTH_BUFFER_BIT);X.is_renderbuffer(t)?$.deleteRenderbuffer(t.w_renderbuffer):X.is_texture(t)&&$.deleteTexture(t.w_texture),X.is_renderbuffer(_)?$.deleteRenderbuffer(_.w_renderbuffer):X.is_texture(_)&&$.deleteTexture(_.w_texture),$.deleteFramebuffer(e)},t.increment_subpixel_index=function(){ee=(ee+1)%2},t.draw_resized_cubemap_texture=function(e,t,_,r,a,n){var o=e.w_texture;$.viewport(0,0,_,_),$.framebufferTexture2D($.FRAMEBUFFER,$.COLOR_ATTACHMENT0,t,o,0);var i=U.create_postprocessing_batch("FLIP_CUBEMAP_COORDS"),s=i.shader;$.activeTexture($.TEXTURE0),$.bindTexture($.TEXTURE_2D,a);var E=0,c=0;_!=r&&(E=1/(6*r),c=1/(4*r)),$.uniform1i(s.uniforms.u_tex_number,n),$.uniform2fv(s.uniforms.u_delta,[E,c]),$.useProgram(s.program),ne(i,0),$.bindTexture($.TEXTURE_2D,null)},t.draw_resized_texture=function(e,t,_,r,a,n){$.bindFramebuffer($.FRAMEBUFFER,r);var o=e.w_texture,i=e.w_target;$.bindTexture(i,o),$.viewport(0,0,t,_),$.texImage2D(i,0,$.RGBA,t,_,0,$.RGBA,$.UNSIGNED_BYTE,null),$.framebufferTexture2D($.FRAMEBUFFER,$.COLOR_ATTACHMENT0,i,o,0);var s=U.create_postprocessing_batch(n),E=s.shader;$.activeTexture($.TEXTURE0),$.bindTexture(i,a),$.useProgram(E.program),ne(s,0),$.bindFramebuffer($.FRAMEBUFFER,null),$.bindTexture(i,null)},t.cleanup=function(){ee=0},t.set_draw_methods=function(){var e=k.get_instanced_arrays(),t=k.get_vertex_array_object();Ee.allow_instanced_arrays_ext=!!e,Ee.allow_vao_ext=!!t,e?(te=function(t,_,r,a){e.drawElementsInstanced($.TRIANGLES,t,_,r,a)},_e=function(t,_){e.vertexAttribDivisor(t,_)},re=function(t,_,r){e.drawArraysInstanced($.TRIANGLES,t,_,r)}):(te=function(e,t,_){$.drawElements($.TRIANGLES,e,t,_)},_e=function(e,t){},re=function(e,t,_){$.drawArrays($.TRIANGLES,e,t)}),t?(ae=function(e){t.bindVertexArray(e)},ne=function(e,t){var _=e.bufs_data;ae(e.vaos[t]),_.ibo?te(_.count,_.ibo_type,0,_.instance_count):re(0,_.count,_.instance_count),ae(null)}):ne=function(e,t){for(var _=e.bufs_data,r=e.attribute_setters,a=0;a<_.vbo_data.length;a++){$.bindBuffer($.ARRAY_BUFFER,_.vbo_data[a].vbo);for(var n=0;n<r.length;n++){var o=r[n];if(o.vbo_type==_.vbo_data[a].type){$.enableVertexAttribArray(o.loc);var i=o.base_offset+o.frame_length*t,s=o.gl_type!=$.FLOAT;$.vertexAttribPointer(o.loc,o.num_comp,o.gl_type,s,0,i),_e(o.loc,o.divisor)}}}_.ibo?($.bindBuffer($.ELEMENT_ARRAY_BUFFER,_.ibo),te(_.count,_.ibo_type,0,_.instance_count)):re(0,_.count,_.instance_count);for(var a=0;a<r.length;a++){var o=r[a];$.disableVertexAttribArray(o.loc)}}},t.reset=function(){$=null,te=null,_e=null,re=null,ae=null}}var a=_(0),n=_(16),o=_(14),i=_(4),s=_(71),E=_(44),c=_(72),l=_(28),T=_(20),d=_(9),u=_(11),f=_(17),P=_(6),A=_(2),S=_(46),p=_(3),O=Object(a.a)("__renderer",r);t.a=O},function(e,t,_){"use strict";function r(e,t){function _(){var e=window.AudioContext||window.webkitAudioContext;if(e){try{var t=new e}catch(e){return U.error('Unable to initialize AudioContext: "'+e+'". The audio is disabled.'),null}return t.createGain?t:(U.warn("deprecated WebAudio implementation"),null)}return U.warn("WebAudio is not supported"),null}function r(){return!!window.MediaElementAudioSourceNode||(U.warn("MediaElementAudioSourceNode not found"),!1)}function a(e,t){if(e.active>-1&&m(e.speakers[e.active]),-1==e.active&&e.random)var _=Math.round(Math.random()*(e.speakers.length-1));else if(e.random)var r=1+Math.round(Math.random()*(e.speakers.length-2)),_=(e.active+r)%e.speakers.length;else var _=(e.active+1)%e.speakers.length;f(e.speakers[_]),e.active=_,e.active_start_time=t}function d(e,t,_){var r=e.sfx;if("NONE"!=r.behavior){var a=r.loop,n=r.pitch;if(r.src&&(a||_>=0)){r.base_seed=Math.floor(5e4*Math.random());var o=W.currentTime+t;o=Math.max(0,o),r.start_time=o,r.state=G;var i=J._sfx;if("POSITIONAL"==r.behavior&&"none"==i.distance_model&&(r.behavior="BACKGROUND_SOUND"),u(e,J._sfx),"POSITIONAL"==r.behavior||"BACKGROUND_SOUND"==r.behavior){var s=W.createBufferSource();if(s.buffer=r.src,s.playbackRate.value=n,a){if(r.source_node&&r.source_node.disconnect(),r.source_node2&&r.source_node2.disconnect(),s.loop=!0,s.loopStart=r.loop_start,s.loopEnd=r.loop_end,r.loop_end){var E=W.createBufferSource();E.buffer=r.src,E.playbackRate.value=n,r.source_node2=E,E.connect(r.proc_chain_in)}s.start(o),r.duration=0}else{var c=s.buffer?s.buffer.duration:0;if(_>c){var l=o+_+r.fade_out;s.loop=!0,s.start(o),s.stop(l),r.duration=_}else s.loop=!1,s.start(o),r.duration=c}s.connect(r.proc_chain_in),r.source_node=s,P(r),A(r),S(r)}else if("BACKGROUND_MUSIC"==r.behavior){w.clear_timeout(r.bgm_start_timeout),w.clear_timeout(r.bgm_stop_timeout);var T=function(){O(e)};if(0==t?T():r.bgm_start_timeout=w.set_timeout(T,1e3*t),a)r.duration=0;else{var d=M(e);r.duration=d}}p(r,o)}}}function u(e,t){var _=e.sfx;if(!_.proc_chain_in){var r=c.j(e.render.world_tsr),a=c.g(e.render.world_tsr);if(D.mix_mode){var n=W.createBiquadFilter();n.type="peaking"}else var n=null;var o=W.createGain();switch(_.behavior){case"POSITIONAL":var i=W.createPanner();"string"!=typeof i.panningModel?(i.panningModel=i.EQUALPOWER,i.distanceModel=i.INVERSE_DISTANCE):(i.panningModel="equalpower",i.distanceModel=t.distance_model),i.setPosition(r[0],r[1],r[2]),T.copy(r,_.last_position);var s=j;l._33(a,l.c,s),i.setOrientation(s[0],s[1],s[2]),i.refDistance=_.dist_ref,i.maxDistance=_.dist_max,i.rolloffFactor=_.attenuation,i.coneInnerAngle=_.cone_angle_inner,i.coneOuterAngle=_.cone_angle_outer,i.coneOuterGain=_.cone_volume_outer;var E=W.createGain();if(E.gain.value=L(_),n?(i.connect(n),n.connect(E)):i.connect(E),E.connect(o),_.proc_chain_in=i,_.volume_random){var d=W.createGain();o.connect(d),d.connect(t.proc_chain_in)}else{var d=null;o.connect(t.proc_chain_in)}break;case"BACKGROUND_SOUND":var i=null,E=W.createGain();if(E.gain.value=L(_),n?(_.proc_chain_in=n,n.connect(E)):_.proc_chain_in=E,E.connect(o),_.volume_random){var d=W.createGain();o.connect(d),d.connect(t.proc_chain_in)}else{var d=null;o.connect(t.proc_chain_in)}break;case"BACKGROUND_MUSIC":var i=null,d=null,E=W.createGain();E.gain.value=L(_),n?(_.proc_chain_in=n,n.connect(E)):_.proc_chain_in=E,E.connect(o),o.connect(t.proc_chain_in)}_.panner_node=i,_.filter_node=n,_.gain_node=E,_.fade_gain_node=o,_.rand_gain_node=d}}function f(e){var t=e.sfx,_=t.duration;d(e,t.delay+t.delay_random*Math.random(),_)}function P(e){var t=e.source_node2||e.source_node;l._16(t.onended)&&(t.onended=function(){e.state=B})}function A(e){e.volume_random&&e.rand_gain_node.gain.cancelScheduledValues(e.start_time),e.pitch_random&&(e.source_node.playbackRate.cancelScheduledValues(e.start_time),e.source_node2&&e.source_node2.playbackRate.cancelScheduledValues(e.start_time)),e.vp_rand_end_time=e.start_time}function S(e){if(e.volume_random||e.pitch_random){var t=e.rand_gain_node,_=e.source_node,r=_.buffer?_.buffer.duration:0;if(r){var a=e.start_time;$[0]=e.base_seed;for(var n=0;n<H;){var o=e.pitch+e.pitch_random*l._39($);if(a>=e.vp_rand_end_time){if(e.volume_random){var i=1-l.M(e.volume_random,0,1)*Math.random();t.gain.setTargetAtTime(i,a,X)}e.pitch_random&&(_.playbackRate.setTargetAtTime(o,a,X),e.source_node2&&e.source_node2.playbackRate.setTargetAtTime(o,a,X)),n++}a+=r/o}e.vp_rand_end_time=a-.001}}}function p(e,t){if(e.fade_in||e.fade_out){var _=e.fade_gain_node;_.gain.cancelScheduledValues(t),e.fade_in?(_.gain.setTargetAtTime(0,t,X),_.gain.linearRampToValueAtTime(1,t+e.fade_in)):_.gain.setTargetAtTime(1,t,X),e.fade_out&&!e.loop&&(_.gain.setTargetAtTime(1,t+e.duration,X),_.gain.linearRampToValueAtTime(0,t+e.duration+e.fade_out))}}function O(e){var t=e.sfx,_=t.src;_&&(_.volume=1,_.loop=t.loop,t.source_node=t.source_node||W.createMediaElementSource(_),t.source_node.connect(t.proc_chain_in),t.state==G&&(_.currentTime&&(_.currentTime=0),_.play()))}function v(e){var t=e.sfx,_=t.src;_&&(_.currentTime&&(_.currentTime=0),_.pause())}function m(e){"SPEAKER"!=e.type&&x.panic("Wrong object type");var t=e.sfx;if(t.state==B)return void(t.state=k);if(t.state==G||t.state==K){var _=t.fade_gain_node,r=W.currentTime;if(t.fade_out&&(_.gain.setTargetAtTime(_.gain.value,r,X),_.gain.linearRampToValueAtTime(0,r+t.fade_out,X)),"BACKGROUND_MUSIC"==t.behavior){if(t.src){var a=function(){v(e)};w.clear_timeout(t.bgm_start_timeout),w.clear_timeout(t.bgm_stop_timeout),t.bgm_stop_timeout=w.set_timeout(a,1e3*t.fade_out)}}else{var n=t.source_node;n.onended=function(){},t.duration<n.buffer.duration?t.fade_out&&t.state==G?n.stop(r+t.fade_out):t.state==G&&(n.stop(0),n.disconnect()):n.disconnect(),t.start_time=0,t.pause_time=0,t.buf_offset=0}t.state=k}}function N(e){return e.sfx.state==G}function g(e){var t=e.sfx;if(t.state==G){var _=W.currentTime;if(t.pause_time=_,"BACKGROUND_MUSIC"==t.behavior){var r=t.src;r&&r.pause()}else _>t.start_time?t.buf_offset=R(t,_):t.buf_offset=0,t.source_node.onended=function(){},t.source_node.stop(0),t.source_node.disconnect(),A(t);t.state=K}}function R(e,t){$[0]=e.base_seed;for(var _,r=e.source_node.buffer.duration,a=e.start_time;a<t;)_=e.pitch+e.pitch_random*l._39($),a+=r/_;return(r/_-(a-t))*_}function I(e){var t=e.sfx;if(t.state==K){var _=W.currentTime;if(t.start_time+=_-t.pause_time,"BACKGROUND_MUSIC"==t.behavior){t.src.play()}else{b(e),t.vp_rand_end_time=_;var r=t.source_node;P(t),r.start(t.start_time,t.buf_offset),S(t)}p(t,t.start_time),t.state=G}}function b(e){var t=e.sfx,_=W.createBufferSource();if(_.loop=t.source_node.loop,_.loopStart=t.source_node.loopStart,_.loopEnd=t.source_node.loopEnd,_.buffer=t.source_node.buffer,_.playbackRate.value=t.source_node.playbackRate.value,_.connect(t.proc_chain_in),t.source_node=_,t.source_node2){var r=W.createBufferSource();r.loop=t.source_node2.loop,r.buffer=t.source_node2.buffer,r.playbackRate.value=t.source_node2.playbackRate.value,r.connect(t.proc_chain_in),t.source_node2=r}}function h(e,t,_){var r=1,a=t.doppler_factor;if(a>0){var n=t.speed_of_sound;if(0!=T.dot(e.velocity,e.velocity)||0!=T.dot(t.listener_velocity,t.listener_velocity)){var o=T.subtract(e.last_position,t.listener_last_eye,j),i=T.length(o),s=T.dot(o,t.listener_velocity)/i,E=T.dot(o,e.velocity)/i;s=-s,E=-E;var c=n/a;s=Math.min(s,c),E=Math.min(E,c),r=(n-a*s)/(n-a*E),isFinite(r)||(r=0),r=Math.min(r,16),r=Math.max(r,.125),r=l._50(r,e.last_doppler_shift,_,F),e.source_node.playbackRate.value=r,e.last_doppler_shift=r}}}function Y(e){var t=e.sfx;return!(!t||t.state!=G&&t.state!=K&&t.state!=k&&t.state!=B)}function L(e){return e.muted?0:e.volume}function M(e){var t=e.sfx;if("POSITIONAL"==t.behavior||"BACKGROUND_SOUND"==t.behavior){var _=t.src;return _?_.duration:0}var r=t.src;return r?r.duration:0}var x=Object(n.a)(e),y=Object(o.a)(e),U=Object(i.a)(e),w=Object(E.a)(e),C=y.defaults,D=y.sfx,F=.3,G=20,k=30,K=40,B=50,X=.015,H=5,j=new Float32Array(3),Q=new Float32Array(3),z=s.create(),V=[],q=[],W=null,J=null,Z=[],$=[1],ee=null;t.AST_NONE=10,t.AST_ARRAY_BUFFER=20,t.AST_HTML_ELEMENT=30,t.create_sfx=function(){return{uuid:-1,filepath:"",behavior:"NONE",muted:!1,volume:1,pitch:1,attenuation:1,dist_ref:1,dist_max:1e4,cone_angle_inner:360,cone_angle_outer:360,cone_volume_outer:1,autoplay:!1,cyclic:!1,loop:!1,loop_start:0,loop_end:0,delay:0,delay_random:0,volume_random:0,pitch_random:0,fade_in:0,fade_out:0,start_time:0,pause_time:0,buf_offset:0,duration:0,vp_rand_end_time:0,base_seed:1,src:null,state:10,last_position:new Float32Array(3),velocity:new Float32Array(3),enable_doppler:!1,last_doppler_shift:1,bgm_start_timeout:-1,bgm_stop_timeout:-1,duck_time:0,proc_chain_in:null,source_node:null,source_node2:null,panner_node:null,filter_node:null,gain_node:null,fade_gain_node:null,rand_gain_node:null,update_counter:0}},t.init=function(){var e=document.createElement("audio"),t=document.createElement("video");e.canPlayType&&(""!=e.canPlayType("audio/ogg")&&(V.push("ogg"),V.push("ogv"),V.push("oga")),""!=e.canPlayType("audio/mpeg")&&V.push("mp3"),""!=e.canPlayType("audio/mp4")&&(V.push("mp4"),V.push("m4v"),V.push("m4a")),""!=e.canPlayType("audio/webm")&&V.push("webm")),t.canPlayType&&(""!=t.canPlayType("video/ogg")&&(q.push("ogv"),q.push("ogg"),q.push("oga")),""!=t.canPlayType("video/mp4")&&(q.push("m4v"),q.push("mp4")),""!=t.canPlayType("video/webm")&&q.push("webm"),""!=t.canPlayType("video/mpeg")&&q.push("mp3"))},t.attach_scene_sfx=function(e){if(D.webaudio&&!W&&(W=_())&&U.log("%cINIT WEBAUDIO: "+W.sampleRate+"Hz","color: #00a"),W){var t={listener_last_eye:new Float32Array(3),listener_velocity:new Float32Array(3),update_counter:0},r=W.createGain(),a=W.createGain();if(t.gain_node=r,t.fade_gain_node=a,r.connect(a),a.connect(W.destination),e.b4w_enable_dynamic_compressor){var n=W.createDynamicsCompressor(),o=e.b4w_dynamic_compressor_settings;n.threshold.value=o.threshold,n.knee.value=o.knee,n.ratio.value=o.ratio,n.attack.value=o.attack,n.release.value=o.release,n.connect(r),t.compressor_node=n,t.proc_chain_in=n}else t.compressor_node=null,t.proc_chain_in=r;switch(e.audio_distance_model){case"INVERSE":case"INVERSE_CLAMPED":t.distance_model="inverse";break;case"LINEAR":case"LINEAR_CLAMPED":t.distance_model="linear";break;case"EXPONENT":case"EXPONENT_CLAMPED":t.distance_model="exponential";break;case"NONE":t.distance_model="none";break;default:x.panic("Wrong audio distance model")}t.doppler_factor=e.audio_doppler_factor,t.speed_of_sound=e.audio_doppler_speed,t.muted=!1,t.volume=e.audio_volume,r.gain.value=L(t),t.duck_time=0}else var t=null;e._sfx=t},t.set_active_scene=function(e){J=e},t.detect_audio_container=function(e){return e||(e="ogg"),V.indexOf(e)>-1?e:V.indexOf("m4a")>-1?"m4a":V.indexOf("oga")>-1?"oga":""},t.detect_video_container=function(e){return e||(e="webm"),q.indexOf(e)>-1?e:q.indexOf("m4v")>-1?"m4v":q.indexOf("webm")>-1?"webm":""},t.update_object=function(e,t){var _=e.data,a=t.sfx;if(e.data.sound){switch(a.uuid=e.data.sound.uuid,a.filepath=e.data.sound.filepath,_.b4w_behavior){case"POSITIONAL":case"BACKGROUND_SOUND":a.behavior=W?_.b4w_behavior:"NONE";break;case"BACKGROUND_MUSIC":a.behavior=W?r()&&!C.chrome_html_bkg_music_hack?"BACKGROUND_MUSIC":"BACKGROUND_SOUND":"NONE";break;default:x.panic("Wrong speaker behavior")}_.sound||(a.behavior="NONE"),a.enable_doppler=_.b4w_enable_doppler,a.muted=_.muted,a.volume=_.volume,a.pitch=_.pitch,a.attenuation=_.attenuation,a.dist_ref=_.distance_reference,a.dist_max=_.distance_max||1e4,a.cone_angle_inner=_.cone_angle_inner,a.cone_angle_outer=_.cone_angle_outer,a.cone_volume_outer=_.cone_volume_outer,a.autoplay=_.b4w_auto_play,a.cyclic=_.b4w_cyclic_play,a.loop=_.b4w_loop,a.loop_start=_.b4w_loop_start,a.loop_end=_.b4w_loop_end,a.delay=_.b4w_delay,a.delay_random=_.b4w_delay_random,a.volume_random=_.b4w_volume_random,a.pitch_random=_.b4w_pitch_random,a.fade_in=_.b4w_fade_in,a.fade_out=_.b4w_fade_out,Z.push(t)}},t.source_type=function(e){switch("SPEAKER"!=e.type&&x.panic("Wrong object type"),e.sfx.behavior){case"POSITIONAL":case"BACKGROUND_SOUND":return t.AST_ARRAY_BUFFER;case"BACKGROUND_MUSIC":return t.AST_HTML_ELEMENT;case"NONE":return t.AST_NONE;default:x.panic("Wrong speaker behavior")}},t.update_spkobj=function(e,t){var _=e.sfx;switch(_.behavior){case"POSITIONAL":case"BACKGROUND_SOUND":case"BACKGROUND_MUSIC":_.src=t;break;case"NONE":break;default:x.panic("Wrong speaker behavior")}},t.play_empty_sound=function(){var e=W.createBufferSource();e.buffer=W.createBuffer(1,22050,22050),e.connect(W.destination),e.start(0)},t.decode_audio_data=function(e,t,_){W?W.decodeAudioData(e,t,_):_()},t.speaker_remove=function(e){m(e),e.sfx=null,Z.splice(Z.indexOf(e),1)},t.cleanup=function(){for(var e=0;e<Z.length;e++){var t=Z[e],_=t.sfx;if("BACKGROUND_MUSIC"==_.behavior){var r=_.src;r&&r.pause()}else _.source_node&&_.source_node.disconnect(),_.source_node2&&_.source_node2.disconnect()}if(J&&J._sfx){var a=J._sfx;a.listener_last_eye[0]=0,a.listener_last_eye[1]=0,a.listener_last_eye[2]=0,a.listener_velocity[0]=0,a.listener_velocity[1]=0,a.listener_velocity[2]=0}J=null,Z.splice(0),ee=null},t.update=function(e,t){if(W&&0!=Z.length){for(var _=0;_<Z.length;_++){var r=Z[_],n=r.sfx,o=n.source_node,i=W.currentTime;!n.loop&&n.state==G&&n.duration&&n.start_time+n.duration<i&&("BACKGROUND_MUSIC"==n.behavior||o&&!l._16(o.onended))&&(n.state=B),n.cyclic&&n.state==B&&f(r),n.state==G&&n.vp_rand_end_time-i<3&&S(n)}ee&&ee.speakers.length&&(-1==ee.active||e>ee.active_start_time+ee.durations[ee.active])&&a(ee,e)}},t.play=d,t.play_def=f,t.stop=m,t.is_playing=N,t.speaker_pause=g,t.speaker_resume=I,t.loop_stop=function(e,t,_){var r=e.sfx,a=r.source_node2;if(Y(e)&&("POSITIONAL"==r.behavior||"BACKGROUND_SOUND"==r.behavior)&&a){var n=W.currentTime+t;r.source_node.stop(n),a.start(n,r.loop_end)}},t.playrate=function(e,t){var _=e.sfx;_.pitch=t,!Y(e)||"POSITIONAL"!=_.behavior&&"BACKGROUND_SOUND"!=_.behavior||(_.source_node.playbackRate.value=t,_.source_node2&&(_.source_node2.playbackRate.value=t),A(_),S(_))},t.get_playrate=function(e){return e.sfx.pitch},t.cyclic=function(e,t){e.sfx.cyclic=Boolean(t)},t.is_autoplay=function(e){return e.sfx.autoplay},t.is_cyclic=function(e){return e.sfx.cyclic},t.listener_update_transform=function(e,t,_,r,a){var n=e._sfx;if(n){var o=j;o[0]=0,o[1]=0,o[2]=-1,T.transformQuat(o,_,o);var i=Q;i[0]=0,i[1]=1,i[2]=0,T.transformQuat(i,_,i);var s=W.listener;if(s.setPosition(t[0],t[1],t[2]),s.setOrientation(o[0],o[1],o[2],i[0],i[1],i[2]),r&&n.update_counter!=a){if(n.listener_stride)n.listener_stride=!1,T.copy(t,n.listener_last_eye);else{var E=n.listener_velocity;E[0]=(t[0]-n.listener_last_eye[0])/r,E[1]=(t[1]-n.listener_last_eye[1])/r,E[2]=(t[2]-n.listener_last_eye[2])/r,T.copy(t,n.listener_last_eye);for(var c=0;c<Z.length;c++){var l=Z[c],d=l.sfx;Y(l)&&"POSITIONAL"==d.behavior&&d.enable_doppler&&h(d,n,r)}}n.update_counter=a}else T.copy(t,n.listener_last_eye)}},t.listener_stride=function(){var e=J._sfx;e&&(e.listener_stride=!0)},t.speaker_update_transform=function(e,t,_){var r=e.sfx;if(Y(e)&&"POSITIONAL"==r.behavior){var a=c.i(e.render.world_tsr,j),n=c.f(e.render.world_tsr,z),o=r.panner_node;o.setPosition(a[0],a[1],a[2]);var i=Q;if(l._33(n,l.c,i),o.setOrientation(i[0],i[1],i[2]),r.enable_doppler){var s=r.last_position;if(t&&r.update_counter!=_){if(r.stride)T.copy(a,s),r.stride=!1;else{var E=r.velocity;E[0]=(a[0]-s[0])/t,E[1]=(a[1]-s[1])/t,E[2]=(a[2]-s[2])/t,T.copy(a,s),h(r,J._sfx,t)}r.update_counter=_}else T.copy(a,s)}}},t.speaker_stride=function(e){var t=e.sfx;Y(e)&&"POSITIONAL"==t.behavior&&t.enable_doppler&&(t.stride=!0)},t.get_spk_behavior=function(e){return e.sfx.behavior},t.check_active_speakers=function(){for(var e=0;e<Z.length;e++)if(Y(Z[e]))return!0;return!1},t.set_master_volume=function(e){var t=J._sfx;t&&(t.volume=e,W&&(t.gain_node.gain.value=L(t)))},t.get_master_volume=function(){var e=J._sfx;return e?e.volume:0},t.set_volume=function(e,t){var _=e.sfx;_.volume=t,Y(e)&&(_.gain_node.gain.value=L(_))},t.get_volume=function(e){return e.sfx.volume},t.mute=function(e,t){e.sfx.muted=Boolean(t),Y(e)&&(e.sfx.gain_node.gain.value=L(e.sfx))},t.is_muted=function(e){return e.sfx.muted},t.mute_master=function(e){var t=J._sfx;t&&(t.muted=Boolean(e),W&&(t.gain_node.gain.value=L(t)))},t.is_master_muted=function(){var e=J._sfx;return!!e&&e.muted},t.get_speaker_objects=function(){return Z},t.pause=function(){for(var e=0;e<Z.length;e++)g(Z[e])},t.resume=function(){for(var e=0;e<Z.length;e++)I(Z[e])},t.set_compressor_params=function(e,t){if(e._sfx&&e._sfx.compressor_node){var _=e._sfx.compressor_node;_.threshold.value=t.threshold,_.knee.value=t.knee,_.ratio.value=t.ratio,_.attack.value=t.attack,_.release.value=t.release}},t.get_compressor_params=function(e){if(!e._sfx||!e._sfx.compressor_node)return null;var t=e._sfx.compressor_node;return{threshold:t.threshold.value,knee:t.knee.value,ratio:t.ratio.value,attack:t.attack.value,release:t.release.value}},t.duck=function(e,t,_){if(Y(e)){var r=e.sfx,a=r.fade_gain_node,n=W.currentTime;a.gain.setTargetAtTime(a.gain.value,n,X),a.gain.linearRampToValueAtTime(t,n+_),r.duck_time=_}},t.unduck=function(e){if(Y(e)){var t=e.sfx,_=t.fade_gain_node,r=W.currentTime;_.gain.setTargetAtTime(_.gain.value,r,X),_.gain.linearRampToValueAtTime(1,r+t.duck_time),t.duck_time=0}},t.duck_master=function(e,t){if(W){var _=J._sfx,r=_.fade_gain_node,a=W.currentTime;r.gain.setTargetAtTime(r.gain.value,a,X),r.gain.linearRampToValueAtTime(e,a+t),_.duck_time=t}},t.unduck_master=function(){if(W){var e=J._sfx,t=e.fade_gain_node,_=W.currentTime;t.gain.setTargetAtTime(t.gain.value,_,X),t.gain.linearRampToValueAtTime(1,_+e.duck_time),e.duck_time=0}},t.apply_playlist=function(e,t,_){ee={active:-1,active_start_time:0,random:_,speakers:[],durations:[]};for(var r=0;r<e.length;r++){var a=e[r],n=M(a);if(0!=n){m(a);a.sfx.cyclic=!1,ee.speakers.push(a),ee.durations.push(n+t)}else U.warn("Ignoring speaker with zero duration: "+a.name)}},t.get_duration=M,t.clear_playlist=function(){if(ee)for(var e=ee.speakers,t=0;t<e.length;t++)m(e[t]);ee=null},t.get_positional_params=function(e){var t=e.sfx;return t&&"POSITIONAL"==t.behavior?{dist_ref:t.dist_ref,dist_max:t.dist_max,attenuation:t.attenuation}:null},t.set_positional_params=function(e,t){var _=e.sfx;if(_&&"POSITIONAL"==_.behavior){_.dist_ref=t.dist_ref,_.dist_max=t.dist_max,_.attenuation=t.attenuation;var r=_.panner_node;r&&(r.refDistance=_.dist_ref,r.maxDistance=_.dist_max,r.rolloffFactor=_.attenuation)}},t.set_filter_params=function(e,t){var _=e.sfx;_&&_.filter_node&&(_.filter_node.frequency.value=t.freq,_.filter_node.Q.value=t.Q,_.filter_node.gain.value=t.gain)},t.get_filter_params=function(e){var t=e.sfx;return t&&t.filter_node?{freq:t.filter_node.frequency.value,Q:t.filter_node.Q.value,gain:t.filter_node.gain.value}:null},t.get_filter_freq_response=function(e,t,_,r){var a=e.sfx;if(!a||!a.filter_node)return null;a.filter_node.getFrequencyResponse(t,_,r)},t.reset=function(){V.length=0,q.length=0,W=null}}var a=_(0),n=_(5),o=_(4),i=_(1),s=_(9),E=_(18),c=_(6),l=_(2),T=_(3),d=Object(a.a)("__sfx",r);t.a=d},function(e,t,_){"use strict";function r(e,t){var _=Object(n.a)(e),r=Object(o.a)(e),a=Object(i.a)(e);t.CT_POSITIVE=_.CT_POSITIVE,t.CT_CONTINUOUS=_.CT_CONTINUOUS,t.CT_TRIGGER=_.CT_TRIGGER,t.CT_SHOT=_.CT_SHOT,t.CT_LEVEL=_.CT_LEVEL,t.CT_CHANGE=_.CT_CHANGE,t.KEY_BACKSPACE=8,t.KEY_TAB=9,t.KEY_ENTER=13,t.KEY_SHIFT=16,t.KEY_CTRL=17,t.KEY_ALT=18,t.KEY_PAUSE=19,t.KEY_CAPSLOCK=20,t.KEY_ESC=27,t.KEY_SPACE=32,t.KEY_LEFT=37,t.KEY_UP=38,t.KEY_RIGHT=39,t.KEY_DOWN=40,t.KEY_1=49,t.KEY_2=50,t.KEY_3=51,t.KEY_4=52,t.KEY_5=53,t.KEY_6=54,t.KEY_7=55,t.KEY_8=56,t.KEY_9=57,t.KEY_A=65,t.KEY_B=66,t.KEY_C=67,t.KEY_D=68,t.KEY_E=69,t.KEY_F=70,t.KEY_G=71,t.KEY_H=72,t.KEY_I=73,t.KEY_J=74,t.KEY_K=75,t.KEY_L=76,t.KEY_M=77,t.KEY_N=78,t.KEY_O=79,t.KEY_P=80,t.KEY_Q=81,t.KEY_R=82,t.KEY_S=83,t.KEY_T=84,t.KEY_U=85,t.KEY_V=86,t.KEY_W=87,t.KEY_X=88,t.KEY_Y=89,t.KEY_Z=90,t.KEY_NUM0=96,t.KEY_NUM1=97,t.KEY_NUM2=98,t.KEY_NUM3=99,t.KEY_NUM4=100,t.KEY_NUM5=101,t.KEY_NUM6=102,t.KEY_NUM7=103,t.KEY_NUM8=104,t.KEY_NUM9=105,t.KEY_MULT=106,t.KEY_ADD=107,t.KEY_SUB=109,t.KEY_DEC_POINT=110,t.KEY_DIV=111,t.KEY_SEMI_COLON=186,t.KEY_EQUAL_SIGN=187,t.KEY_COMMA=188,t.KEY_DASH=189,t.KEY_PERIOD=190,t.KEY_FORWARD_SLASH=191,t.KEY_GRAVE_ACCENT=192,t.KEY_LEFT_SQ_BRACKET=219,t.KEY_BACK_SLASH=220,t.KEY_RIGHT_SQ_BRACKET=221,t.KEY_SINGLE_QUOTE=222,t.PL_SINGLE_TOUCH_MOVE=_.PL_SINGLE_TOUCH_MOVE,t.PL_MULTITOUCH_MOVE_ZOOM=_.PL_MULTITOUCH_MOVE_ZOOM,t.PL_MULTITOUCH_MOVE_PAN=_.PL_MULTITOUCH_MOVE_PAN,t.PL_MULTITOUCH_MOVE_ROTATE=_.PL_MULTITOUCH_MOVE_ROTATE,t.default_AND_logic_fun=_.default_AND_logic_fun,t.default_OR_logic_fun=_.default_OR_logic_fun,t.create_gamepad_btn_sensor=_.create_gamepad_btn_sensor,t.create_gamepad_axis_sensor=_.create_gamepad_axis_sensor,t.create_gamepad_position_sensor=_.create_gamepad_position_sensor,t.create_gamepad_orientation_sensor=_.create_gamepad_orientation_sensor,t.create_custom_sensor=_.create_custom_sensor,t.create_keyboard_sensor=_.create_keyboard_sensor,t.create_collision_sensor=function(e,t,r){return t=t||"ANY",r=r||!1,_.create_collision_sensor(e,t,r)},t.create_collision_impulse_sensor=_.create_collision_impulse_sensor,t.create_ray_sensor=function(e,t,n,o,i,s,E){return e&&!r.obj_has_physics(e)?void a.error_once("No physics for object "+e.name):(o=o||"ANY",i=i||!1,s=s||!1,E=E||!1,_.create_ray_sensor(e,t,n,o,i,s,E))},t.create_mouse_click_sensor=_.create_mouse_click_sensor,t.create_mouse_wheel_sensor=_.create_mouse_wheel_sensor,t.create_mouse_move_sensor=_.create_mouse_move_sensor,t.create_plock_mouse_sensor=_.create_plock_mouse_sensor,t.create_plock_sensor=_.create_plock_sensor,t.create_touch_move_sensor=_.create_touch_move_sensor,t.create_touch_zoom_sensor=_.create_touch_zoom_sensor,t.create_touch_rotate_sensor=_.create_touch_rotate_sensor,t.create_touch_click_sensor=_.create_touch_click_sensor,t.create_motion_sensor=_.create_motion_sensor,t.create_vertical_velocity_sensor=_.create_vertical_velocity_sensor,t.create_gyro_angles_sensor=_.create_gyro_angles_sensor,t.create_gyro_quat_sensor=_.create_gyro_quat_sensor,t.create_gyro_delta_sensor=_.create_gyro_delta_sensor,t.create_hmd_quat_sensor=_.create_hmd_quat_sensor,t.create_hmd_position_sensor=_.create_hmd_position_sensor,t.create_timer_sensor=function(e,t){return _.create_timer_sensor(e,t||!1)},t.reset_timer_sensor=_.reset_timer_sensor,t.create_elapsed_sensor=_.create_elapsed_sensor,t.create_timeline_sensor=_.create_timeline_sensor,t.create_selection_sensor=function(e,t){return _.create_selection_sensor(e,t||!1)},t.create_callback_sensor=function(e,t){return _.create_callback_sensor(e,t||0)},t.set_custom_sensor=function(e,t){_.sensor_set_value(e,t)},t.get_custom_sensor=function(e){return e.value},t.get_sensor_value=_.get_sensor_value,t.get_sensor_payload=_.get_sensor_payload,t.create_sensor_manifold=function(e,t,r,a,n,o,i){i=void 0===i?null:i,n=n||_.default_AND_logic_fun,_.create_sensor_manifold(e,t,r,a,n,o,i)},t.create_kb_sensor_manifold=function(e,t,r,a,n,o){var i=_.create_keyboard_sensor(a);o=void 0===o?null:o;var s=_.default_AND_logic_fun;_.create_sensor_manifold(e,t,r,[i],s,n,o)},t.check_sensor_manifolds=function(e){return _.check_sensor_manifold(e,null)},t.check_sensor_manifold=_.check_sensor_manifold,t.remove_sensor_manifold=_.remove_sensor_manifold,t.reset=_.reset,t.set_plock_smooth_factor=_.set_plock_smooth_factor}var a=_(0),n=_(53),o=_(19),i=_(1),s=Object(a.a)("controls",r);t.a=s},function(e,t,_){"use strict";function r(){return{bb:n(),be:g(),bs:m()}}function a(e,t){return o(e.bb,t.bb),R(e.be,t.be),N(e.bs,t.bs),t}function n(){return{max_x:0,min_x:0,max_y:0,min_y:0,max_z:0,min_z:0}}function o(e,t){return t.min_x=e.min_x,t.max_x=e.max_x,t.min_y=e.min_y,t.max_y=e.max_y,t.min_z=e.min_z,t.max_z=e.max_z,t}function i(){return{center:new Float32Array(3),axis_x:new Float32Array(3),axis_y:new Float32Array(3),axis_z:new Float32Array(3)}}function s(e,t){return q.copy(e.center,t.center),q.copy(e.axis_x,t.axis_x),q.copy(e.axis_y,t.axis_y),q.copy(e.axis_z,t.axis_z),t}function E(){return{max_x:1e12,min_x:-1e12,max_y:1e12,min_y:-1e12,max_z:1e12,min_z:-1e12}}function c(e){return e.max_x=0,e.min_x=0,e.max_y=0,e.min_y=0,e.max_z=0,e.min_z=0,e}function l(e){var t=n();return o(e,t),t}function T(e){var t=e.max_x-e.min_x,_=e.max_y-e.min_y;_<t&&(t=_);var r=e.max_z-e.min_z;return r<t&&(t=r),t}function d(e,t){var _=e.max_x,r=e.max_y,a=e.max_z,n=e.min_x,o=e.min_y,i=e.min_z;return e.max_x=Math.max(t.max_x,_),e.max_y=Math.max(t.max_y,r),e.max_z=Math.max(t.max_z,a),e.min_x=Math.min(t.min_x,n),e.min_y=Math.min(t.min_y,o),e.min_z=Math.min(t.min_z,i),e}function u(e,t,_,r){for(var a=e[t],n=e[t+1],o=e[t+2],i=e[t],s=e[t+1],E=e[t+2],c=t+3;c<_;c+=3){var l=e[c],T=e[c+1],d=e[c+2];a=Math.max(a,l),n=Math.max(n,T),o=Math.max(o,d),i=Math.min(i,l),s=Math.min(s,T),E=Math.min(E,d)}return r.max_x=a,r.max_y=n,r.max_z=o,r.min_x=i,r.min_y=s,r.min_z=E,r}function f(e,t,_){_||(_=n());var r=P(e,Z);return z.D(r,t,r),u(r,0,r.length,_)}function P(e,t){t||(t=new Float32Array(24));var _=e.max_x,r=e.max_y,a=e.max_z,n=e.min_x,o=e.min_y,i=e.min_z;return t[0]=n,t[1]=o,t[2]=i,t[3]=_,t[4]=o,t[5]=i,t[6]=_,t[7]=r,t[8]=i,t[9]=n,t[10]=r,t[11]=i,t[12]=n,t[13]=o,t[14]=a,t[15]=_,t[16]=o,t[17]=a,t[18]=_,t[19]=r,t[20]=a,t[21]=n,t[22]=r,t[23]=a,t}function A(e,t,_){_||(_=m()),z.B(e.center,t,_.center);var r=z.h(t);return _.radius=e.radius*(r<0?-r:r),_}function S(e,t,_){return _||(_=g()),z.B(e.center,t,_.center),q.copy(e.axis_x,_.axis_x),q.copy(e.axis_y,_.axis_y),q.copy(e.axis_z,_.axis_z),z.w(_.axis_x,t,_.axis_x),z.w(_.axis_y,t,_.axis_y),z.w(_.axis_z,t,_.axis_z),_}function p(e,t,_){return _||(_=i()),z.B(e.center,t,_.center),q.copy(e.axis_x,_.axis_x),q.copy(e.axis_y,_.axis_y),q.copy(e.axis_z,_.axis_z),z.w(_.axis_x,t,_.axis_x),z.w(_.axis_y,t,_.axis_y),z.w(_.axis_z,t,_.axis_z),_}function O(e,t){var _=m();return q.copy(t,_.center),_.radius=e,_}function v(e,t,_,r,a){var n=i();return q.copy(e,n.center),q.copy(t,n.axis_x),q.copy(_,n.axis_y),q.copy(r,n.axis_z),q.scale(n.axis_x,a[0],n.axis_x),q.scale(n.axis_y,a[1],n.axis_y),q.scale(n.axis_z,a[2],n.axis_z),n}function m(){return{center:new Float32Array(3),radius:0}}function N(e,t){return t.center[0]=e.center[0],t.center[1]=e.center[1],t.center[2]=e.center[2],t.radius=e.radius,t}function g(){return{axis_x:new Float32Array(3),axis_y:new Float32Array(3),axis_z:new Float32Array(3),center:new Float32Array(3)}}function R(e,t){return q.copy(e.axis_x,t.axis_x),q.copy(e.axis_y,t.axis_y),q.copy(e.axis_z,t.axis_z),q.copy(e.center,t.center),t}function I(e,t,_,r){return{axis_x:new Float32Array(e),axis_y:new Float32Array(t),axis_z:new Float32Array(_),center:new Float32Array([r[0],r[1],r[2]])}}function b(e){return e||(e=m()),q.set(0,0,0,e.center),e.radius=1e12,e}function h(e,t){var _=q.subtract(t.center,e.center,q.create());0==q.length(_)&&q.set(1,0,0,_);var r=q.normalize(_,q.create()),a=q.scale(r,e.radius,q.create());q.add(a,e.center,a);var n=q.scale(r,-e.radius,q.create());q.add(n,e.center,n);var o=q.scale(r,t.radius,q.create());q.add(o,t.center,o);var i=q.scale(r,-t.radius,q.create());q.add(i,t.center,i);var s=U([a,n,o,i],r),E=s[0],c=s[1];e.center=q.scale(q.add(E,c,q.create()),.5,q.create()),e.radius=q.length(q.subtract(c,E,q.create()))/2}function Y(e,t){q.add(e.center,e.axis_y,$),q.add($,e.axis_x,$),q.add($,e.axis_z,$),t.push($[0],$[1],$[2]),q.add(e.center,e.axis_y,$),q.add($,e.axis_x,$),q.subtract($,e.axis_z,$),t.push($[0],$[1],$[2]),q.add(e.center,e.axis_y,$),q.subtract($,e.axis_x,$),q.add($,e.axis_z,$),t.push($[0],$[1],$[2]),q.add(e.center,e.axis_y,$),q.subtract($,e.axis_x,$),q.subtract($,e.axis_z,$),t.push($[0],$[1],$[2]),q.subtract(e.center,e.axis_y,$),q.add($,e.axis_x,$),q.add($,e.axis_z,$),t.push($[0],$[1],$[2]),q.subtract(e.center,e.axis_y,$),q.add($,e.axis_x,$),q.subtract($,e.axis_z,$),t.push($[0],$[1],$[2]),q.subtract(e.center,e.axis_y,$),q.subtract($,e.axis_x,$),q.add($,e.axis_z,$),t.push($[0],$[1],$[2]),q.subtract(e.center,e.axis_y,$),q.subtract($,e.axis_x,$),q.subtract($,e.axis_z,$),t.push($[0],$[1],$[2])}function L(e,t){var _=W.g(e,_e);if(t)var r=W.e(e,_,ae);else var r=J.identity(ae);var a=W.L(r,ie,re);q.copy(e,$),q.transformMat3($,a,$);for(var n=$[0],o=n,i=$[1],s=i,E=$[2],c=E,l=0,T=0,d=0,u=0,f=0,P=0,A=3;A<e.length;A+=3){$[0]=e[A],$[1]=e[A+1],$[2]=e[A+2],q.transformMat3($,a,$);var S=$[0],p=$[1],O=$[2];S>n&&(n=S),S<o&&(o=S),p>i&&(i=p),p<s&&(s=p),O>E&&(E=O),O<c&&(c=O)}var v=n-o,m=i-s,N=E-c;v=Math.max(v,oe),m=Math.max(m,oe),N=Math.max(N,oe);var g=J.identity(ae);g[0]=0!=v?1/v:1/se,g[4]=0!=m?1/m:1/se,g[8]=0!=N?1/N:1/se,J.transpose(a,ne),$[0]=e[0],$[1]=e[1],$[2]=e[2],q.transformMat3($,a,$),q.transformMat3($,g,$),q.transformMat3($,ne,$),l=$[0],T=$[0],d=$[1],u=$[1],f=$[2],P=$[2];for(var A=3;A<e.length;A+=3)$[0]=e[A],$[1]=e[A+1],$[2]=e[A+2],q.transformMat3($,a,$),q.transformMat3($,g,$),q.transformMat3($,ne,$),l=Math.max(l,$[0]),T=Math.min(T,$[0]),d=Math.max(d,$[1]),u=Math.min(u,$[1]),f=Math.max(f,$[2]),P=Math.min(P,$[2]);var R=Math.sqrt((l-T)*(l-T)+(d-u)*(d-u)+(f-P)*(f-P))/2;R=Math.min(R,1),te[0]=(l+T)/2,te[1]=(d+u)/2,te[2]=(f+P)/2;var b=te;g=J.identity(ae),g[0]=v,g[4]=m,g[8]=N,q.transformMat3(b,a,b),q.transformMat3(b,g,b),q.transformMat3(b,ne,b);var h=[a[0],a[3],a[6]],Y=[a[1],a[4],a[7]],L=[a[2],a[5],a[8]];return q.scale(h,v*R,h),q.scale(Y,m*R,Y),q.scale(L,N*R,L),I(h,Y,L,b)}function M(e){var t=i();return q.copy(e.axis_x,t.axis_x),q.copy(e.axis_y,t.axis_y),q.copy(e.axis_z,t.axis_z),q.copy(e.center,t.center),t}function x(e){var t=m(),_=0,r=q.length(e.axis_x),a=q.length(e.axis_y),n=q.length(e.axis_z);return _=r>a?r:a,_=n>_?n:_,t.center=e.center,t.radius=_,t}function y(e,t){var _=q.length(e.axis_x),r=q.length(e.axis_y),a=q.length(e.axis_z),n=_*r*a;return t.radius*t.radius*t.radius*.75>n}function U(e,t){for(var _=q.normalize(t,q.create()),r=e[0],a=e[0],n=1;n<e.length;n++){var o=q.dot(e[n],_);o<q.dot(r,_)&&(r=e[n]),o>q.dot(a,_)&&(a=e[n])}return[r,a]}function w(){return{radius:0,height:0,center:new Float32Array(3)}}function C(e,t){var _=t.max_z,r=t.min_z,a=Math.max(0,_-r-2*e),n=w();return n.radius=e,n.height=a,n.center[0]=0,n.center[1]=0,n.center[2]=(_+r)/2,n}function D(e,t){var _=t.max_z,r=t.min_z,a=Math.max(0,_-r),n=w();return n.radius=e,n.height=a,n.center[0]=0,n.center[1]=0,n.center[2]=(_+r)/2,n}function F(e,t){var _=t.max_z,r=t.min_z,a=Math.max(0,_-r),n=w();return n.radius=e,n.height=a,n.center[0]=0,n.center[1]=0,n.center[2]=(_+r)/2,n}function G(e,t){return t.radius=e.radius,t.height=e.height,t.center.set(e.center),t}function k(e){for(var t=0,_=0,r=n(),a=0;a<e.submeshes.length;a++){for(var i=e.submeshes[a],s=i.position,E=0;E<s.length/3;E++){var c=s[3*E],l=s[3*E+1],T=s[3*E+2];t=Math.max(Math.sqrt(c*c+l*l+T*T),t),_=Math.max(Math.sqrt(c*c+l*l),_)}var f=i.boundings.bb,A=u(s,0,s.length,n());f.max_x=A.max_x,f.min_x=A.min_x,f.max_y=A.max_y,f.min_y=A.min_y,f.max_z=A.max_z,f.min_z=A.min_z;var S=P(A,Z),p=L(S,!1);i.boundings.be_cen=p.center,i.boundings.be_ax=[p.axis_x[0],p.axis_y[1],p.axis_z[2]],0==a?o(A,r):d(r,A)}var O=e.b4w_boundings.bb;O.max_x=r.max_x,O.min_x=r.min_x,O.max_y=r.max_y,O.min_y=r.min_y,O.max_z=r.max_z,O.min_z=r.min_z;var v=e.b4w_boundings.bb_src;v.max_x=r.max_x,v.min_x=r.min_x,v.max_y=r.max_y,v.min_y=r.min_y,v.max_z=r.max_z,v.min_z=r.min_z,e.b4w_boundings.bs_rad=t,e.b4w_boundings.bc_rad=_;var S=P(r,Z),p=L(S,!1);e.b4w_boundings.be_cen=p.center,e.b4w_boundings.be_ax=[p.axis_x[0],p.axis_y[1],p.axis_z[2]]}function K(e){var t=e.subarray(0,3),_=e.subarray(6,9),r=e.subarray(12,15),a=e.subarray(18,21),n=q.subtract(_,t,$);q.normalize(n,n);var o=V._10(t,_,r,ee),i=q.cross(o,n,o);q.normalize(i,i);var s=q.create(),E=q.create();q.subtract(_,t,te),E[0]=q.dot(te,n),E[1]=q.dot(te,i);var c=q.create();q.subtract(r,t,te),c[0]=q.dot(te,n),c[1]=q.dot(te,i);var l=q.create();q.subtract(a,t,te),l[0]=q.dot(te,n),l[1]=q.dot(te,i);var T=m();T=B([s,E,c,l],T);var d=q.scale(n,T.center[0],te);return q.scaleAndAdd(d,i,T.center[1],d),q.add(d,t,T.center),T}function B(e,t){t=j(t,e[0],e[1]);for(var _=2;_<e.length;_++)q.distance(t.center,e[_])>t.radius&&(t=X(t,e,e[_],_-1));return t}function X(e,t,_,r){e=j(e,_,t[0]);for(var a=1;a<=r;a++)q.distance(e.center,t[a])>e.radius&&(e=H(e,t,_,t[a],a-1));return e}function H(e,t,_,r,a){e=j(e,_,r);for(var n=0;n<=a;n++)q.distance(e.center,t[n])>e.radius&&(e=Q(e,_,r,t[n]));return e}function j(e,t,_){return q.add(t,_,e.center),q.scale(e.center,.5,e.center),e.radius=q.distance(e.center,t),e}function Q(e,t,_,r){var a=q.subtract(_,r,te),n=q.squaredLength(a),o=q.subtract(t,r,te),i=q.squaredLength(o),s=q.subtract(t,_,te),E=q.squaredLength(s),c=n*(i+E-n),l=i*(E+n-i),T=E*(n+i-E),d=c+l+T;return q.copy(t,e.center),q.scale(e.center,c/d,e.center),q.scaleAndAdd(e.center,_,l/d,e.center),q.scaleAndAdd(e.center,r,T/d,e.center),e.radius=q.distance(e.center,t),e}t.L=r,t.t=a,t.w=n,t.o=o,t.C=i,t.v=s,t.f=E,t.P=c,t.n=l,t.m=T,t.D=d,t.a=u,t.h=f,t.F=P,t.k=A,t.i=S,t.j=p,t.l=O,t.O=v,t.A=m,t.u=N,t.y=g,t.s=R,t.e=I,t.g=b,t.E=h,t.G=Y,t.z=L,t.x=M,t.B=x,t.M=y,_.d(t,"I",function(){return w}),_.d(t,"K",function(){return w}),_.d(t,"J",function(){return w}),t.b=C,t.d=D,t.c=F,_.d(t,"p",function(){return G}),_.d(t,"r",function(){return G}),_.d(t,"q",function(){return G}),t.N=k,t.H=K;var z=_(6),V=_(2),q=_(3),W=_(41),J=_(27),Z=new Float32Array(24),$=new Float32Array(3),ee=new Float32Array(3),te=new Float32Array(3),_e=new Float32Array(3),re=new Float32Array(9),ae=new Float32Array(9),ne=new Float32Array(9),oe=.001,ie=5e-4,se=oe/2},function(e,t,_){"use strict";function r(e,t){var _=Object(n.a)(e),r=Object(o.a)(e),a=Object(i.a)(e),d=Object(s.a)(e);t.AXIS_X=new Float32Array([1,0,0]),t.AXIS_Y=new Float32Array([0,1,0]),t.AXIS_Z=new Float32Array([0,0,1]),t.AXIS_MX=new Float32Array([-1,0,0]),t.AXIS_MY=new Float32Array([0,-1,0]),t.AXIS_MZ=new Float32Array([0,0,-1]),t.XYX=l.o,t.YZY=l.v,t.ZXZ=l.x,t.XZX=l.q,t.YXY=l.s,t.ZYZ=l.z,t.XYZ=l.p,t.YZX=l.u,t.ZXY=l.w,t.XZY=l.r,t.YXZ=l.t,t.ZYX=l.y,t.f32=function(e){return e=e||0,l._1(e)},t.assert=_.assert,t.keyfind=l._17,t.keysearch=l._18,t.matrix_to_quat=function(e){return l._23(e)},t.euler_to_quat=function(e,t){return t||(t=new Float32Array(4)),l.Y(e,t)},t.ordered_angles_to_quat=function(e,t,_){return _||(_=E.create()),l._26(e,t,_)},t.quat_to_ordered_angles=function(e,t,_){return _||(_=T.create()),l._36(e,t,_)},t.quat_to_euler=function(e,t){return t||(t=new Float32Array(3)),l._35(e,t)},t.sign=l._49,t.clamp=l.M,t.quat_to_dir=l._33,t.ground_project_cam_quat=function(e,t){return l._29(e,l.c,l.f,l.e,t)},t.cam_quat_to_mesh_quat=function(e,t){return l.I(e,t)},t.quat_project=function(e,t,_,r,a){return 0!=T.dot(_,r)?(d.error("Wrong in-plane direction"),null):l._29(e,t,_,r,a)},t.hash_code=function(){return a.hash_code.apply(a,arguments)},t.smooth=l._50,t.smooth_v=l._53,t.is_vector=l._15,t.correct_cam_quat_up=l.R,t.quat_to_angle_axis=l._32,t.random_from_array=l._40,t.horizontal_direction=l._12,t.angle_wrap_0_2pi=l.A,t.angle_wrap_periodic=l.B,t.smooth_step=l._52,t.lerp=l._19,t.deg_to_rad=l.T,t.rad_to_deg=l._38,t.dir_to_quat=l.U,t.is_ie11=r.is_ie11,t.gen_tbn_quats=function(e,t){return d.error_once("util.gen_tbn_quats() deprecated. Do not use it anymore."),c.d(e,t)},t.trunc=l._63}var a=_(0),n=_(5),o=_(35),i=_(30),s=_(1),E=_(9),c=_(36),l=_(2),T=_(3),d=Object(a.a)("util",r);t.a=d},function(e,t,_){"use strict";function r(){var e=new g(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function a(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function n(e){var t=new g(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function o(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function i(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function s(e,t){if(t===e){var _=e[1],r=e[2],a=e[5];t[1]=e[3],t[2]=e[6],t[3]=_,t[5]=e[7],t[6]=r,t[7]=a}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function E(e,t){var _=e[0],r=e[1],a=e[2],n=e[3],o=e[4],i=e[5],s=e[6],E=e[7],c=e[8],l=c*o-i*E,T=-c*n+i*s,d=E*n-o*s,u=_*l+r*T+a*d;return u?(u=1/u,t[0]=l*u,t[1]=(-c*r+a*E)*u,t[2]=(i*r-a*o)*u,t[3]=T*u,t[4]=(c*_-a*s)*u,t[5]=(-i*_+a*n)*u,t[6]=d*u,t[7]=(-E*_+r*s)*u,t[8]=(o*_-r*n)*u,t):null}function c(e,t){var _=e[0],r=e[1],a=e[2],n=e[3],o=e[4],i=e[5],s=e[6],E=e[7],c=e[8];return t[0]=o*c-i*E,t[1]=a*E-r*c,t[2]=r*i-a*o,t[3]=i*s-n*c,t[4]=_*c-a*s,t[5]=a*n-_*i,t[6]=n*E-o*s,t[7]=r*s-_*E,t[8]=_*o-r*n,t}function l(e){var t=e[0],_=e[1],r=e[2],a=e[3],n=e[4],o=e[5],i=e[6],s=e[7],E=e[8];return t*(E*n-o*s)+_*(-E*a+o*i)+r*(s*a-n*i)}function T(e,t,_){var r=e[0],a=e[1],n=e[2],o=e[3],i=e[4],s=e[5],E=e[6],c=e[7],l=e[8],T=t[0],d=t[1],u=t[2],f=t[3],P=t[4],A=t[5],S=t[6],p=t[7],O=t[8];return _[0]=T*r+d*o+u*E,_[1]=T*a+d*i+u*c,_[2]=T*n+d*s+u*l,_[3]=f*r+P*o+A*E,_[4]=f*a+P*i+A*c,_[5]=f*n+P*s+A*l,_[6]=S*r+p*o+O*E,_[7]=S*a+p*i+O*c,_[8]=S*n+p*s+O*l,_}function d(e,t,_){var r=e[0],a=e[1],n=e[2],o=e[3],i=e[4],s=e[5],E=e[6],c=e[7],l=e[8],T=t[0],d=t[1];return _[0]=r,_[1]=a,_[2]=n,_[3]=o,_[4]=i,_[5]=s,_[6]=T*r+d*o+E,_[7]=T*a+d*i+c,_[8]=T*n+d*s+l,_}function u(e,t,_){var r=e[0],a=e[1],n=e[2],o=e[3],i=e[4],s=e[5],E=e[6],c=e[7],l=e[8],T=Math.sin(t),d=Math.cos(t);return _[0]=d*r+T*o,_[1]=d*a+T*i,_[2]=d*n+T*s,_[3]=d*o-T*r,_[4]=d*i-T*a,_[5]=d*s-T*n,_[6]=E,_[7]=c,_[8]=l,_}function f(e,t,_){var r=t[0],a=t[1];return _[0]=r*e[0],_[1]=r*e[1],_[2]=r*e[2],_[3]=a*e[3],_[4]=a*e[4],_[5]=a*e[5],_[6]=e[6],_[7]=e[7],_[8]=e[8],_}function P(e,t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function A(e,t){var _=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=_,t[2]=0,t[3]=-_,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function S(e,t){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function p(e,t){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function O(e,t){var _=e[0],r=e[1],a=e[2],n=e[3],o=_+_,i=r+r,s=a+a,E=_*o,c=r*o,l=r*i,T=a*o,d=a*i,u=a*s,f=n*o,P=n*i,A=n*s;return t[0]=1-l-u,t[3]=c-A,t[6]=T+P,t[1]=c+A,t[4]=1-E-u,t[7]=d-f,t[2]=T-P,t[5]=d+f,t[8]=1-E-l,t}function v(e,t){var _=e[0],r=e[1],a=e[2],n=e[3],o=e[4],i=e[5],s=e[6],E=e[7],c=e[8],l=e[9],T=e[10],d=e[11],u=e[12],f=e[13],P=e[14],A=e[15],S=_*i-r*o,p=_*s-a*o,O=_*E-n*o,v=r*s-a*i,m=r*E-n*i,N=a*E-n*s,g=c*f-l*u,R=c*P-T*u,I=c*A-d*u,b=l*P-T*f,h=l*A-d*f,Y=T*A-d*P,L=S*Y-p*h+O*b+v*I-m*R+N*g;return L?(L=1/L,t[0]=(i*Y-s*h+E*b)*L,t[1]=(s*I-o*Y-E*R)*L,t[2]=(o*h-i*I+E*g)*L,t[3]=(a*h-r*Y-n*b)*L,t[4]=(_*Y-a*I+n*R)*L,t[5]=(r*I-_*h-n*g)*L,t[6]=(f*N-P*m+A*v)*L,t[7]=(P*O-u*N-A*p)*L,t[8]=(u*m-f*O+A*S)*L,t):null}function m(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function N(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))}Object.defineProperty(t,"__esModule",{value:!0}),t.create=r,t.fromMat4=a,t.clone=n,t.copy=o,t.identity=i,t.transpose=s,t.invert=E,t.adjoint=c,t.determinant=l,t.multiply=T,_.d(t,"mul",function(){return T}),t.translate=d,t.rotate=u,t.scale=f,t.fromTranslation=P,t.fromRotation=A,t.fromScaling=S,t.fromMat2d=p,t.fromQuat=O,t.normalFromMat4=v,t.str=m,t.frob=N;var g="undefined"!=typeof Float32Array?Float32Array:Array;Math.random},function(e,t,_){"use strict";function r(e,t){function _(){return c.webgl2?i("OES_texture_float_linear"):a("OES_texture_float_linear")}function r(){return c.webgl2?i("EXT_color_buffer_float"):a("WEBGL_color_buffer_float")}function a(e){if(e in T)return T[e];var t=l.getExtension(e)||null;if(T[e]=t,t)var _="0a0";else var _="a00";return E.log("%cGET EXTENSION","color: #"+_,e),t}function i(e){if(e in T)return T[e];switch(e){case"WEBGL_depth_texture":case"OES_element_index_uint":case"OES_standard_derivatives":case"EXT_shader_texture_lod":case"OES_texture_float":case"OES_texture_half_float":var t={};break;case"ANGLE_instanced_arrays":case"OES_vertex_array_object":var t=l;break;default:var t=l.getExtension(e)||null}if(T[e]=t,t)var _="0a0";else var _="a00";return E.log("%cGET EXTENSION (WebGL 2)","color: #"+_,e),t}var s=Object(n.a)(e),E=Object(o.a)(e),c=s.defaults,l=null,T={};t.setup_context=function(e){l=e},t.get_s3tc=function(){return a("WEBGL_compressed_texture_s3tc")||a("WEBKIT_WEBGL_compressed_texture_s3tc")},t.get_pvr=function(){return a("WEBKIT_WEBGL_compressed_texture_pvrtc")||a("WEBGL_compressed_texture_pvrtc")},t.get_depth_texture=function(){return c.webgl2?i("WEBGL_depth_texture"):a("WEBGL_depth_texture")||a("WEBKIT_WEBGL_depth_texture")},t.get_texture_float=function(){return c.webgl2?i("OES_texture_float"):a("OES_texture_float")},t.get_texture_half_float=function(){return c.webgl2?i("OES_texture_half_float"):a("OES_texture_half_float")},t.get_texture_float_linear=_,t.get_texture_half_float_linear=function(){return c.webgl2?_():a("OES_texture_half_float_linear")},t.get_color_buffer_float=r,t.get_color_buffer_half_float=function(){return c.webgl2?r():a("EXT_color_buffer_half_float")},t.get_aniso=function(){return a("EXT_texture_filter_anisotropic")||a("WEBKIT_EXT_texture_filter_anisotropic")},t.get_texture_lod=function(){return c.webgl2?i("EXT_shader_texture_lod"):a("EXT_shader_texture_lod")},t.get_debug_shaders=function(){return a("WEBGL_debug_shaders")},t.get_renderer_info=function(){return a("WEBGL_debug_renderer_info")},t.get_elem_index_uint=function(){return c.webgl2?i("OES_element_index_uint"):a("OES_element_index_uint")},t.get_standard_derivatives=function(){return c.webgl2?i("OES_standard_derivatives"):a("OES_standard_derivatives")},t.get_disjoint_timer_query=function(){if(c.webgl2)var e=i("EXT_disjoint_timer_query_webgl2");else var e=a("EXT_disjoint_timer_query");if(null==e)return e;if(e.createQueryEXT)var t={createQuery:function(){return e.createQueryEXT()},beginQuery:function(t){e.beginQueryEXT(e.TIME_ELAPSED_EXT,t)},endQuery:function(){e.endQueryEXT(e.TIME_ELAPSED_EXT)},getQueryAvailable:function(t){return e.getQueryObjectEXT(t,e.QUERY_RESULT_AVAILABLE_EXT)},getQueryObject:function(t){return e.getQueryObjectEXT(t,e.QUERY_RESULT_EXT)},getDisjoint:function(){return l.getParameter(e.GPU_DISJOINT_EXT)}};else var t={createQuery:function(){return l.createQuery()},beginQuery:function(t){l.beginQuery(e.TIME_ELAPSED_EXT,t)},endQuery:function(){l.endQuery(e.TIME_ELAPSED_EXT)},getQueryAvailable:function(e){return l.getQueryParameter(e,l.QUERY_RESULT_AVAILABLE)},getQueryObject:function(e){return l.getQueryParameter(e,l.QUERY_RESULT)},getDisjoint:function(){return l.getParameter(e.GPU_DISJOINT_EXT)}};return t},t.get_instanced_arrays=function(){if(c.webgl2)return i("ANGLE_instanced_arrays");var e=a("ANGLE_instanced_arrays");return null==e?e:{drawElementsInstanced:function(t,_,r,a,n){e.drawElementsInstancedANGLE(t,_,r,a,n)},vertexAttribDivisor:function(t,_){e.vertexAttribDivisorANGLE(t,_)},drawArraysInstanced:function(t,_,r,a){e.drawArraysInstancedANGLE(t,_,r,a)}}},t.get_vertex_array_object=function(){if(c.webgl2)return i("OES_vertex_array_object");var e=a("OES_vertex_array_object");return null==e?e:{bindVertexArray:function(t){e.bindVertexArrayOES(t)},createVertexArray:function(){return e.createVertexArrayOES()},deleteVertexArray:function(t){e.deleteVertexArrayOES(t)},isVertexArray:function(t){return e.isVertexArrayOES(t)}}},t.cleanup=function(){T={}},t.reset=function(){l=null}}var a=_(0),n=_(4),o=_(1),i=Object(a.a)("__extensions",r);t.a=i},function(e,t,_){"use strict";function r(e,t){function _(){var e=p.get_canvas(),t=e.clientHeight,_=e.clientWidth;return m.pick_object(_/2,t/2)}function r(e,t,_){var r=I.get_active(),a=e.draw_data[0].bundles[0],n=a.batch,o=t.draw_data[0].bundles[0],i=o.batch;if("quality"in _){var s=_.quality;8===s||16===s||24===s||32===s?(e.ssao_samples=s,A.set_batch_directive(n,"SSAO_QUALITY","SSAO_QUALITY_"+s),A.update_shader(n),b.append_draw_data(e,a)):g.error('set_ssao_params(): Wrong "quality" value.')}if("use_hemisphere"in _&&(e.ssao_hemisphere=_.use_hemisphere,A.set_batch_directive(n,"SSAO_HEMISPHERE",0|_.use_hemisphere),A.update_shader(n),b.append_draw_data(e,a)),"use_blur_depth"in _&&(t.ssao_blur_depth=_.use_blur_depth,A.set_batch_directive(i,"SSAO_BLUR_DEPTH",0|_.use_blur_depth),A.update_shader(i),b.append_draw_data(t,o),I.connect_render_targets_batch(r._render.graph,t,i,!1)),"ssao_white"in _&&(e.ssao_white=_.ssao_white,A.set_batch_directive(n,"SSAO_WHITE",0|_.ssao_white),A.update_shader(n),b.append_draw_data(e,a)),"blur_discard_value"in _&&(t.ssao_blur_discard_value=_.blur_discard_value),"radius_increase"in _&&(e.ssao_radius_increase=_.radius_increase),"influence"in _&&(e.ssao_influence=_.influence),"dist_factor"in _&&(e.ssao_dist_factor=_.dist_factor),"boolean"==typeof _.ssao_only){var E=I.get_subs(r,b.MAIN_OPAQUE);E.ssao_only=_.ssao_only;for(var c=E.draw_data,l=[],T=0;T<c.length;T++)for(var d=c[T].bundles,u=0;u<d.length;u++){var f=d[u].batch;A.set_batch_directive(f,"SSAO_ONLY",0|_.ssao_only),A.update_shader(f),l.push(d[u])}for(var T=0;T<l.length;T++)b.append_draw_data(E,l[T])}e.need_perm_uniforms_update=!0,t.need_perm_uniforms_update=!0}function a(e){return N.is_dynamic_mesh(e)||N.is_empty(e)||N.is_line(e)||N.is_lamp(e)}var A=Object(n.a)(e),S=Object(o.a)(e),p=Object(i.a)(e),O=Object(s.a)(e),v=Object(E.a)(e),m=Object(c.a)(e),N=Object(l.a)(e),g=Object(T.a)(e),R=Object(d.a)(e),I=Object(u.a)(e),b=Object(f.a)(e);t.DATA_ID_ALL=m.DATA_ID_ALL,t.set_active=function(e){var t=I.get_all_scenes();I.set_active(P._18("name",e,t))},t.get_active=function(){return I.check_active()?I.get_active().name:""},t.get_scenes=function(){for(var e=I.get_all_scenes(),t=[],_=0;_<e.length;_++)t.push(e[_].name);return t},t.get_active_camera=function(){return I.check_active()?I.get_camera(I.get_active()):(g.error("No active scene"),!1)},t.get_object_by_name=function(e,t){var _=m.get_object(m.GET_OBJECT_BY_NAME,e,0|t,!0);if(_)return _;g.error("get object "+e+": not found")},t.get_object_by_dupli_name=function(e,t,_){var r=m.get_object(m.GET_OBJECT_BY_DUPLI_NAME,e,t,0|_);if(r)return r;g.error("get object "+t+": not found")},t.get_object_by_dupli_name_list=function(e,t){var _=m.get_object(m.GET_OBJECT_BY_DUPLI_NAME_LIST,e,0|t);if(_)return _;g.error("get object "+e+": not found")},t.get_world_by_name=function(e,t){var _=m.get_world_by_name(e,0|t);if(_)return _;g.error("get object "+e+": not found")},t.get_object_data_id=function(e){return N.get_object_data_id(e)},t.pick_object=function(e,t){var r=I.get_main();if(!r)return g.error("No active scene"),null;var a=I.get_subs(r,b.STEREO);return a&&a.enable_hmd_stereo?(g.error_once("pick_object() is not available in the stereo rendering mode. Use scenes.pick_center instead."),_()):m.pick_object(e,t)},t.pick_center=_,t.outlining_is_enabled=function(e){return e&&e.render&&e.render.outlining},t.set_outline_intensity=function(e,t){e&&e.render&&e.render.outlining?m.set_outline_intensity(e,t):g.error("set_outline_intensity(): wrong object")},t.get_outline_intensity=function(e){return e&&e.render&&e.render.outlining?e.render.outline_intensity:(g.error("get_outline_intensity(): wrong object"),0)},t.apply_outline_anim=function(e,t,_,r){e&&e.render&&e.render.outlining?m.apply_outline_anim(e,t,_,r):g.error("apply_outline_anim(): wrong object")},t.apply_outline_anim_def=function(e){if(e&&e.render&&e.render.outlining){var t=e.render.outline_anim_settings_default;m.apply_outline_anim(e,t.outline_duration,t.outline_period,t.outline_relapses)}else g.error("apply_outline_anim_def(): wrong object")},t.clear_outline_anim=function(e){e&&e.render&&e.render.outlining?m.clear_outline_anim(e):g.error("clear_outline_anim(): wrong object")},t.set_outline_color=I.set_outline_color,t.get_outline_color=function(e){var t=I.get_active(),_=I.get_subs(t,b.OUTLINE);if(_)return e=e||new Float32Array(3),e.set(_.outline_color),e},t.set_hmd_params=function(e){if(!I.check_active())return void g.error("No active scene");e&&(!e.distortion_coefs||e.distortion_coefs instanceof Array||(e.distortion_coefs=null),!e.chromatic_aberration_coefs||e.chromatic_aberration_coefs instanceof Array||(e.chromatic_aberration_coefs=null),"number"!=typeof e.base_line_factor&&(e.base_line_factor=null),"number"!=typeof e.inter_lens_factor&&(e.inter_lens_factor=null),"boolean"!=typeof e.enable_hmd_stereo&&(e.enable_hmd_stereo=null),I.set_hmd_params(e))},t.get_shadow_params=function(){if(!I.check_active())return g.error("No active scene"),!1;var e=I.get_active(),t=I.get_subs(e,b.SHADOW_CAST);if(!t)return null;var _=e._render.shadow_params,r=I.get_subs(e,b.MAIN_OPAQUE),a=I.get_subs(e,b.SHADOW_RECEIVE),n={};return n.csm_resolution=_.csm_resolution,n.self_shadow_polygon_offset=t.self_shadow_polygon_offset,a&&(n.self_shadow_normal_offset=a.self_shadow_normal_offset),n.enable_csm=_.enable_csm,n.csm_num=_.csm_num,n.csm_first_cascade_border=_.csm_first_cascade_border,n.first_cascade_blur_radius=_.first_cascade_blur_radius,n.csm_last_cascade_border=_.csm_last_cascade_border,n.last_cascade_blur_radius=_.last_cascade_blur_radius,n.fade_last_cascade=_.fade_last_cascade,n.blend_between_cascades=_.blend_between_cascades,_.enable_csm?(n.csm_borders=I.get_csm_borders(e,r.camera),n.blur_radii=new Float32Array(_.csm_num),n.blur_radii.set(r.camera.pcf_blur_radii.subarray(0,_.csm_num))):(n.csm_borders=null,n.blur_radii=null),n},t.set_shadow_params=function(e){if(!I.check_active())return void g.error("No active scene");var t=I.get_active();"number"==typeof e.self_shadow_polygon_offset&&v.traverse(t._render.graph,function(t,_){_.type==b.SHADOW_CAST&&(_.self_shadow_polygon_offset=e.self_shadow_polygon_offset)});for(var _=I.subs_array(t,[b.SHADOW_RECEIVE]),r=0;r<_.length;r++){var a=_[r];"number"==typeof e.self_shadow_normal_offset&&(a.self_shadow_normal_offset=e.self_shadow_normal_offset),"number"==typeof e.pcf_blur_radius&&(a.pcf_blur_radius=e.pcf_blur_radius)}for(var n=I.subs_array(t,[b.MAIN_BLEND]),r=0;r<n.length;r++){var o=n[r];"number"==typeof e.self_shadow_normal_offset&&(o.self_shadow_normal_offset=e.self_shadow_normal_offset),"number"==typeof e.pcf_blur_radius&&(o.pcf_blur_radius=e.pcf_blur_radius),o.need_perm_uniforms_update=!0}var i=t._render.shadow_params;if("number"==typeof e.csm_first_cascade_border&&(i.csm_first_cascade_border=e.csm_first_cascade_border),"number"==typeof e.first_cascade_blur_radius&&(i.first_cascade_blur_radius=e.first_cascade_blur_radius),"number"==typeof e.csm_last_cascade_border&&(i.csm_last_cascade_border=e.csm_last_cascade_border),"number"==typeof e.last_cascade_blur_radius&&(i.last_cascade_blur_radius=e.last_cascade_blur_radius),a){for(var s=a.draw_data,r=0;r<s.length;r++)for(var E=s[r].bundles,c=0;c<E.length;c++){var l=E[c];if(l.obj_render.shadow_receive){var T=l.batch;A.assign_shadow_receive_dirs(T,i),A.update_shader(T),b.append_draw_data(a,l)}}a.need_perm_uniforms_update=!0}for(var d=N.get_scene_data(t._camera,t),u=d.cameras,r=0;r<u.length;r++)S.update_camera_shadows(u[r],i);I.schedule_shadow_update(t)},t.get_environment_colors=function(){if(!I.check_active())return g.error("No active scene"),[];var e=I.get_active();return I.get_environment_colors(e)},t.set_environment_colors=function(e,t,_){if(!I.check_active())return void g.error("No active scene");var r=I.get_active(),a=I.get_subs(r,b.MAIN_OPAQUE),n=e||0==e?parseFloat(e):a.environment_energy,o=t||0==t?t:a.horizon_color,i=_||0==_?_:a.zenith_color;I.set_environment_colors(r,n,o,i)},t.get_fog_color_density=function(e){if(!I.check_active())return g.error("No active scene"),!1;var t=I.get_active();return I.get_fog_color_density(t,e)},t.set_fog_color_density=function(e){if(!I.check_active())return void g.error("No active scene");var t=I.get_active();I.set_fog_color_density(t,e)},t.get_fog_params=function(){if(!I.check_active())return g.error("No active scene"),!1;var e=I.get_active(),t={};return t.fog_intensity=I.get_fog_intensity(e),t.fog_depth=I.get_fog_depth(e),t.fog_start=I.get_fog_start(e),t.fog_height=I.get_fog_height(e),t},t.set_fog_params=function(e){if(!I.check_active())return void g.error("No active scene");var t=I.get_active();"number"==typeof e.fog_intensity&&I.set_fog_intensity(t,e.fog_intensity),"number"==typeof e.fog_depth&&I.set_fog_depth(t,e.fog_depth),"number"==typeof e.fog_start&&I.set_fog_start(t,e.fog_start),"number"==typeof e.fog_height&&I.set_fog_height(t,e.fog_height)},t.get_ssao_params=function(){if(!I.check_active())return g.error("No active scene"),!1;var e=I.get_active();return I.get_ssao_params(e)},t.set_ssao_params=function(e){if(!I.check_active())return void g.error("No active scene");var t=I.get_active(),_=I.subs_array(t,[b.SSAO]),a=I.subs_array(t,[b.SSAO_BLUR]);if(!_.length)return g.error("SSAO is not enabled on the scene"),0;for(var n=0;n<_.length;n++)r(_[n],a[n],e)},t.get_color_correction_params=function(){if(!I.check_active())return g.error("No active scene"),null;var e=I.get_active(),t=I.get_subs(e,b.COMPOSITING);if(!t)return null;var _={};return _.brightness=t.brightness,_.contrast=t.contrast,_.exposure=t.exposure,_.saturation=t.saturation,_},t.set_color_correction_params=function(e){if(!I.check_active())return void g.error("No active scene");var t=I.get_active(),_=I.get_subs(t,b.COMPOSITING);_&&("brightness"in e&&(_.brightness=e.brightness),"contrast"in e&&(_.contrast=e.contrast),"exposure"in e&&(_.exposure=e.exposure),"saturation"in e&&(_.saturation=e.saturation),_.need_perm_uniforms_update=!0)},t.get_sky_params=function(){if(!I.check_active())return g.error("No active scene"),!1;var e=I.get_active();return I.get_sky_params(e)},t.set_sky_params=function(e){if(!I.check_active())return void g.error("No active scene");var t=I.get_active(),_=I.get_subs(t,b.SKY);_&&("color"in e&&_.sky_color.set(e.color),"rayleigh_brightness"in e&&(_.rayleigh_brightness=e.rayleigh_brightness),"mie_brightness"in e&&(_.mie_brightness=e.mie_brightness),"spot_brightness"in e&&(_.spot_brightness=e.spot_brightness),"scatter_strength"in e&&(_.scatter_strength=e.scatter_strength),"rayleigh_strength"in e&&(_.rayleigh_strength=e.rayleigh_strength),"mie_strength"in e&&(_.mie_strength=e.mie_strength),"rayleigh_collection_power"in e&&(_.rayleigh_collection_power=e.rayleigh_collection_power),"mie_collection_power"in e&&(_.mie_collection_power=e.mie_collection_power),"mie_distribution"in e&&(_.mie_distribution=e.mie_distribution),_.need_perm_uniforms_update=!0,_.need_fog_update=!0,I.update_sky(t,_))},t.get_dof_params=function(){if(!I.check_active())return g.error("No active scene"),!1;var e=I.get_active();return I.get_subs(e,b.DOF)?I.get_dof_params(e):null},t.set_dof_params=function(e){if(!I.check_active())return void g.error("No active scene");var t=I.get_active();I.set_dof_params(t,e)},t.get_god_rays_params=function(){if(!I.check_active())return g.error("No active scene"),!1;var e=I.get_active();return I.get_subs(e,b.GOD_RAYS)?I.get_god_rays_params(e):null},t.set_god_rays_params=function(e){if(!I.check_active())return void g.error("No active scene");var t=I.get_active();I.set_god_rays_params(t,e)},t.get_bloom_params=function(){if(!I.check_active())return g.error("No active scene"),!1;var e=I.get_active();return I.get_subs(e,b.BLOOM)?I.get_bloom_params(e):null},t.set_bloom_params=function(e){if(!I.check_active())return void g.error("No active scene");var t=I.get_active();I.set_bloom_params(t,e)},t.get_glow_material_params=function(){if(!I.check_active())return g.error("No active scene"),!1;var e=I.get_active();return I.get_subs(e,b.GLOW_COMBINE)?I.get_glow_material_params(e):null},t.set_glow_material_params=function(e){if(!I.check_active())return void g.error("No active scene");var t=I.get_active();I.set_glow_material_params(t,e)},t.get_wind_params=function(){if(!I.check_active())return g.error("No active scene"),!1;var e=I.get_active();return I.get_wind_params(e)},t.set_wind_params=function(e){if(!I.check_active())return void g.error("No active scene");var t=I.get_active();m.set_wind_params(t,e)},t.get_water_surface_level=function(e,t){if(!I.check_active())return g.error("No active scene"),0;var _=I.get_active();return _._render.water_params?I.get_water_surface_level(_,e,t):(g.error("No water parameters on the active scene"),0)},t.set_water_params=function(e){if(!I.check_active())return void g.error("No active scene");var t=I.get_active();I.set_water_params(t,e)},t.get_water_mat_params=function(e){if(!I.check_active())return void g.error("No active scene");var t=I.get_active();I.get_water_mat_params(t,e)},t.update_scene_materials_params=function(){if(!I.check_active())return void g.error("No active scene");var e=I.get_active();I.update_scene_permanent_uniforms(e)},t.hide_object=function(e,t){t=t||!1,a(e)?t?I.change_visibility(e,!0):I.change_visibility_rec(e,!0):g.error("show/hide is only supported for dynamic objects.")},t.show_object=function(e,t){t=t||!1,a(e)?t?I.change_visibility(e,!1):I.change_visibility_rec(e,!1):g.error("show/hide is only supported for dynamic objects.")},t.is_hidden=function(e){return a(e)?I.is_hidden(e):(g.error("show/hide is only supported for dynamic meshes/empties and lamps"),!1)},t.is_visible=function(e){return e.render.is_visible},t.check_object_by_name=function(e,t){return!!m.get_object(m.GET_OBJECT_BY_NAME,e,0|t,!0)},t.check_object_by_dupli_name=function(e,t,_){return!!m.get_object(m.GET_OBJECT_BY_DUPLI_NAME,e,t,0|_)},t.check_object_by_dupli_name_list=function(e,t){return!!m.get_object(m.GET_OBJECT_BY_DUPLI_NAME_LIST,e,0|t)},t.get_all_objects=function(e,t){var _=I.get_active();return e||(e="ALL"),t||0===t||(t=m.DATA_ID_ALL),m.get_scene_objs_derived(_,e,t)},t.get_object_name=function(e){return e?e.origin_name:(g.error("Wrong object name"),"")},t.get_object_name_hierarchy=function(e){if(!e)return g.error("Wrong object name"),null;for(var t=[],_=e;_;)t.push(_.origin_name),_=N.get_dg_parent(_);return t.reverse()},t.get_object_type=function(e){return e&&e.type?e.type:(g.error("Wrong object"),"UNDEFINED")},t.get_object_children=function(e){return e.cons_descends.slice(0)},t.get_first_character=function(){return m.get_first_character(I.get_active())},t.get_shore_dist=function(e,t){if(t||0===t||(t=1),!I.check_active())return g.error("No active scene"),0;var _=I.get_active();return I.get_shore_dist(_,e,t)},t.get_cam_water_depth=function(){return I.get_cam_water_depth()},t.get_type_mesh_object=function(e){return N.is_mesh(e)?e.render.type:""},t.get_meta_tags=function(){if(!I.check_active())return g.error("No active scene"),!1;var e=I.get_active();return I.get_meta_tags(e)},t.get_custom_prop=function(){if(!I.check_active())return g.error("No active scene"),!1;var e=I.get_active();return I.get_custom_prop(e)},t.append_object=function(e,t){if(t)var _=I.get_all_scenes(),r=P._18("name",t,_);else var r=I.get_active();I.append_object(r,e,!0),R.append_object(e,r)},t.remove_object=function(e){if(!N.is_dynamic_mesh(e)&&!N.is_empty(e)&&!N.is_line(e))return void g.error("Can't remove object \""+e.name+'". It must be dynamic and type of MESH or EMPTY.');m.obj_switch_cleanup_flags(e,e.render.is_copied_deep,!1,!1),O.prepare_object_unloading(e),m.obj_switch_cleanup_flags(e,!0,!0,!0),m.remove_object(e)},t.marker_frame=function(e){var t=I.get_active();return t.timeline_markers&&e in t.timeline_markers?I.marker_frame(t,e):(g.error('"'+e+'" marker not found.'),0)},t.get_mb_params=function(){var e=I.get_active(),t=I.get_subs(e,b.MOTION_BLUR);if(t){return{mb_factor:t.mb_factor,mb_decay_threshold:t.mb_decay_threshold}}return null},t.set_mb_params=function(e){var t=I.get_active(),_=I.subs_array(t,[b.MOTION_BLUR]);if(!_.length)return void g.error("The motion blur subscene doesn't exist.");for(var r=0;r<_.length;r++){var a=_[r];"number"==typeof e.mb_decay_threshold&&(a.mb_decay_threshold=e.mb_decay_threshold),"number"==typeof e.mb_factor&&(a.mb_factor=e.mb_factor)}},t.can_select_objects=function(){var e=I.get_active();return Boolean(I.get_subs(e,b.COLOR_PICKING))}}var a=_(0),n=_(16),o=_(14),i=_(15),s=_(42),E=_(31),c=_(12),l=_(8),T=_(1),d=_(19),u=_(10),f=_(11),P=_(2),A=Object(a.a)("scenes",r);t.a=A},function(e,t,_){"use strict";function r(e,t){function _(e,t){var n=t;switch(typeof e){case"object":if(e)switch(e.constructor){case Object:for(var o in e)n=_(e[o],n);break;case Int8Array:case Uint8Array:case Uint8ClampedArray:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:for(var s=0;s<e.length;s++)n=r(e[s],n);break;case Array:for(var s=0;s<e.length;s++)n=_(e[s],n);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLRenderbuffer:case WebGLTexture:case WebGLBuffer:n=r(0,n);break;default:i.panic("Wrong object constructor:",e.constructor)}else n=r(0,n);return n;case"number":return r(e,n);case"boolean":return r(0|e,n);case"string":return a(e,n);case"function":case"undefined":return r(0,n)}}function r(e,t){var _=t;return T[0]=e,_=(_<<5)-_+d[0],_&=_,_=(_<<5)-_+d[1],_&=_}function a(e,t){for(var _=t,r=0;r<e.length;r++){_=(_<<5)-_+e.charCodeAt(r),_&=_}return _}var i=Object(n.a)(e),s=Object(o.a)(e),E=1,c=0,l={},T=new Float64Array(1),d=new Uint32Array(T.buffer);t.unique_name=function(e){l[e]||(l[e]=0);var t=e+l[e];return l[e]++,t},t.cleanup=function(){c=0,l={}},t.unique_id=function(){return c++,c.toString(10)},t.gen_color_id=function(e){++e>132651&&s.error("Color ID pool depleted");var t=Math.floor(e/2601);e%=2601;var _=Math.floor(e/51);e%=51;var r=e;return new Float32Array([t/51,_/51,r/51])},t.rand=function(){return E=(69069*E+5)%Math.pow(2,32),Math.round(E/65536)%32768/32767},t.srand=function(e){E=e},t.calc_variable_id=function(e,t){return _(e,t)},t.hash_code=_}var a=_(0),n=_(5),o=_(1),i=Object(a.a)("generator",r);t.a=i},function(e,t,_){"use strict";function r(e,t){function _(e,t,_){_||(_=null),r(e,t)?k.panic("Graph already has node with given ID"):e.nodes.push(t,_)}function r(e,t){for(var _=e.nodes,r=0;r<_.length;r+=2)if(_[r]==t)return!0;return!1}function a(e,t,_,a){a||(a=null),r(e,t)&&r(e,_)?e.edges.push(t,_,a):k.panic("Wrong node IDs")}function i(e,t){r(e,t)||k.panic("Node not found");for(var _=e.nodes,a=0;a<_.length;a+=2)_[a]==t&&(_.splice(a,2),a-=2)}function s(e,t,_,r){y(e,t,_)||k.panic("Edge not found");for(var a=e.edges,n=0,o=0;o<a.length;o+=3)if(a[o]==t&&a[o+1]==_){if(-1==r)a.splice(o,3);else{if(r==n){a.splice(o,3);break}n++}o-=3}}function E(e,t,_,r){y(e,t,_)||k.panic("Edge not found");for(var a=e.edges,n=0;n<a.length;n+=3)if(a[n]==t&&a[n+1]==_&&a[n+2][0]==r[0]&&a[n+2][1]==r[1]){a.splice(n,3);break}}function c(e){for(var t=e.nodes,_=-1,r=0;r<t.length;r+=2)_=Math.max(_,t[r]);return++_}function l(e,t){for(var _=e.nodes,r=0;r<_.length;r+=2)if(_[r+1]==t)return _[r];return K}function T(e){var t=[],_={};d(e,_);for(var r=e.nodes,a=0;a<r.length;a+=2)0==L(e,r[a])&&u(e,r[a],_,t);return{nodes:t,edges:e.edges.slice(0)}}function d(e,t){for(var _=e.nodes,r=0;r<_.length;r+=2)t[_[r]]=!1}function u(e,t,_,r){if(!_[t]){_[t]=!0;for(var a=0;a<Y(e,t);a++){u(e,M(e,t,a),_,r)}r.unshift(t,h(e,t))}}function f(e,t,_,r){if(!_[t]){if(_[t]=!0,r==X||r==j)for(var a=0;a<Y(e,t);a++){var n=M(e,t,a);f(e,n,_,r)}if(r==H||r==j)for(var a=0;a<L(e,t);a++){var n=x(e,t,a);f(e,n,_,r)}}}function P(e){for(var t=e.edges,_=0;_<t.length;_+=3){var a=t[_],n=t[_+1];r(e,a)&&r(e,n)||(t.splice(_,3),_-=3)}}function A(e){for(var t=[],_=e.nodes,r=0;r<_.length;r+=2){var a=_[r];Y(e,a)||t.push(a)}return t}function S(e){return e.nodes.length/2}function p(e){for(var t=e.nodes,_=e.edges,r=[],a=[],n=[],o=0;o<t.length;o++)n[t[2*o]]=o,r.push(o,t[2*o+1]);for(var o=0;o<_.length;o+=3)a.push(n[_[o]],n[_[o+1]],_[o+2]);return{nodes:r,edges:a}}function O(e,t,_){if(v(_))return m(_,e,t),!0;if(N(_))return!1;for(var r=K,a=K,n=!1;!n&&g(_,Q,r,a);)if(r=Q[0],a=Q[1],R(_,r,a)){var o=G(_);D(o,r,a),n=O(e,t,o),F(o)}return n}function v(e){return e.core_len==e.n1}function m(e,t,_){for(var r=0,a=0;r<e.n1;r++)e.core_1[r]!=K&&(t[a]=r,_[a]=e.core_1[r],a++)}function N(e){return e.n1>e.n2||e.t1both_len>e.t2both_len||e.t1out_len>e.t2out_len||e.t1in_len>e.t2in_len}function g(e,t,_,r){_==K&&(_=0),r==K?r=0:r++;var a=e.t1both_len,n=e.t2both_len,o=e.t1out_len,i=e.t2out_len,s=e.t1in_len,E=e.t2in_len,c=e.core_len,l=e.n1,T=e.n2,d=e.core_1,u=e.core_2,f=e.in_1,P=e.in_2,A=e.out_1,S=e.out_2;if(a>c&&n>c)for(;_<l&&(d[_]!=K||0==A[_]||0==f[_]);)_++,r=0;else if(o>c&&i>c)for(;_<l&&(d[_]!=K||0==A[_]);)_++,r=0;else if(s>c&&E>c)for(;_<l&&(d[_]!=K||0==f[_]);)_++,r=0;else if(0==_&&e.order!=B){for(var p=0;p<l&&d[_=e.order[p]]!=K;)p++;p==l&&(_=l)}else for(;_<l&&d[_]!=K;)_++,r=0;if(a>c&&n>c)for(;r<T&&(u[r]!=K||0==S[r]||0==P[r]);)r++;else if(o>c&&i>c)for(;r<T&&(u[r]!=K||0==S[r]);)r++;else if(s>c&&E>c)for(;r<T&&(u[r]!=K||0==P[r]);)r++;else for(;r<T&&u[r]!=K;)r++;return _<l&&r<T&&(t[0]=_,t[1]=r,!0)}function R(e,t,_){var r=e.g1,a=e.g2,n=e.n1,o=e.n2,i=e.core_1,s=e.core_2,E=e.in_1,c=e.in_2,l=e.out_1,T=e.out_2;if(I(t<n),I(_<o),I(i[t]==K),I(s[_]==K),!b(e.node_comp,r,t,a,_))return!1;for(var d=0,u=0,f=0,P=0,A=0,S=0,p=0;p<Y(r,t);p++){var O=M(r,t,p);if(i[O]!=K){var v=i[O];if(!y(a,_,v)||!U(e.edge_comp,r,t,O,a,_,v))return!1}else E[O]&&f++,l[O]&&d++,E[O]||l[O]||A++}for(var p=0;p<L(r,t);p++){var O=x(r,t,p);if(i[O]!=K){var v=i[O];if(!y(a,v,_)||!U(e.edge_comp,r,O,t,a,v,_))return!1}else E[O]&&f++,l[O]&&d++,E[O]||l[O]||A++}for(var p=0;p<Y(a,_);p++){var v=M(a,_,p);if(s[v]!=K){var O=s[v];if(!y(r,t,O))return!1}else c[v]&&P++,T[v]&&u++,c[v]||T[v]||S++}for(var p=0;p<L(a,_);p++){var v=x(a,_,p);if(s[v]!=K){var O=s[v];if(!y(r,O,t))return!1}else c[v]&&P++,T[v]&&u++,c[v]||T[v]||S++}return f<=P&&d<=u&&A<=S}function I(e){e||k.panic("Assertion failed")}function b(e,t,_,r,a){return!!e(h(t,_),h(r,a))}function h(e,t){for(var _=e.nodes,r=0;r<_.length;r+=2)if(_[r]==t)return _[r+1];return null}function Y(e,t){for(var _=e.edges,r=0,a=0;a<_.length;a+=3)_[a]==t&&r++;return r}function L(e,t){for(var _=e.edges,r=0,a=0;a<_.length;a+=3)_[a+1]==t&&r++;return r}function M(e,t,_){for(var r=e.edges,a=0,n=0;n<r.length;n+=3)if(r[n]==t){if(a==_)return r[n+1];a++}return K}function x(e,t,_){for(var r=e.edges,a=0,n=0;n<r.length;n+=3)if(r[n+1]==t){if(a==_)return r[n];a++}return K}function y(e,t,_){for(var r=e.edges,a=0;a<r.length;a+=3)if(r[a]==t&&r[a+1]==_)return!0;return!1}function U(e,t,_,r,a,n,o){for(var i=w(t,_,r),s=w(a,n,o),E=0;E<i;E++){for(var c=!1,l=0;l<s;l++)if(e(C(t,_,r,E),C(a,n,o,l))){c=!0;break}if(!c)return!1}return!0}function w(e,t,_){for(var r=0,a=e.edges,n=0;n<a.length;n+=3)a[n]==t&&a[n+1]==_&&r++;return r}function C(e,t,_,r){for(var a=e.edges,n=0,o=0;o<a.length;o+=3)if(a[o]==t&&a[o+1]==_){if(n==r)return a[o+2];n++}return null}function D(e,t,_){var r=e.g1,a=e.g2,n=e.n1,o=e.n2,i=e.core_1,s=e.core_2,E=e.in_1,c=e.in_2,l=e.out_1,T=e.out_2;I(t<n),I(_<o),I(e.core_len<n),I(e.core_len<o);var d=++e.core_len;e.added_node1=t,E[t]||(E[t]=d,e.t1in_len++,l[t]&&e.t1both_len++),l[t]||(l[t]=d,e.t1out_len++,E[t]&&e.t1both_len++),c[_]||(c[_]=d,e.t2in_len++,T[_]&&e.t2both_len++),T[_]||(T[_]=d,e.t2out_len++,c[_]&&e.t2both_len++),i[t]=_,s[_]=t;for(var u=0;u<L(r,t);u++){var f=x(r,t,u);E[f]||(E[f]=d,e.t1in_len++,l[f]&&e.t1both_len++)}for(var u=0;u<Y(r,t);u++){var f=M(r,t,u);l[f]||(l[f]=d,e.t1out_len++,E[f]&&e.t1both_len++)}for(var u=0;u<L(a,_);u++){var f=x(a,_,u);c[f]||(c[f]=d,e.t2in_len++,T[f]&&e.t2both_len++)}for(var u=0;u<Y(a,_);u++){var f=M(a,_,u);T[f]||(T[f]=d,e.t2out_len++,c[f]&&e.t2both_len++)}}function F(e){I(e.core_len-e.orig_core_len<=1),I(e.added_node1!=K);var t=e.g1,_=e.g2,r=e.core_len,a=e.added_node1,n=e.core_1,o=e.core_2,i=e.in_1,s=e.in_2,E=e.out_1,c=e.out_2;if(e.orig_core_len<r){i[a]==r&&(i[a]=0);for(var l=0;l<L(t,a);l++){var T=x(t,a,l);i[T]==r&&(i[T]=0)}E[a]==r&&(E[a]=0);for(var l=0;l<Y(t,a);l++){var T=M(t,a,l);E[T]==r&&(E[T]=0)}var d=n[a];s[d]==r&&(s[d]=0);for(var l=0;l<L(_,d);l++){var T=x(_,d,l);s[T]==r&&(s[T]=0)}c[d]==r&&(c[d]=0);for(var l=0;l<Y(_,d);l++){var T=M(_,d,l);c[T]==r&&(c[T]=0)}n[a]=K,o[d]=K,e.core_len=e.orig_core_len,e.added_node1=K}}function G(e){var t={};return t.g1=e.g1,t.g2=e.g2,t.node_comp=e.node_comp,t.edge_comp=e.edge_comp,t.n1=e.n1,t.n2=e.n2,t.order=e.order,t.core_len=t.orig_core_len=e.core_len,t.t1in_len=e.t1in_len,t.t1out_len=e.t1out_len,t.t1both_len=e.t1both_len,t.t2in_len=e.t2in_len,t.t2out_len=e.t2out_len,t.t2both_len=e.t2both_len,t.added_node1=K,t.core_1=e.core_1,t.core_2=e.core_2,t.in_1=e.in_1,t.in_2=e.in_2,t.out_1=e.out_1,t.out_2=e.out_2,t.share_count=e.share_count,e.share_count[0]+=1,t}var k=Object(n.a)(e),K=-1,B=0,X=10,H=20,j=30,Q=[K,K];t.NULL_NODE=K,t.FORWARD_DIR=X,t.BACKWARD_DIR=H,t.TWO_WAY=j,t.create=function(){for(var e=arguments,t=[],_=[],r=0;r<e.length;r++){var a=e[r];switch(a.length){case 2:t.push(a[0],a[1]);break;case 3:_.push(a[0],a[1],a[2]);break;default:k.panic("Wrong graph constructor params")}}return{nodes:t,edges:_}},t.clone=function(e,t,_){if(t)for(var r=new Array(e.nodes.length),a=0;a<e.nodes.length;a+=2)r[a]=e.nodes[a],r[a+1]=t(e.nodes[a+1]);else var r=o.O(e.nodes);if(_)for(var n=new Array(e.edges.length),a=0;a<e.edges.length;a+=3)n[a]=e.edges[a],n[a+1]=e.edges[a+1],n[a+2]=_(e.edges[a+2]);else var n=o.O(e.edges);return e={nodes:r,edges:n}},t.create_node_edge_arr=function(e,t){for(var _=[],r=[],a=0;a<e.length;a++)_.push(e[a][0],e[a][1]);for(var a=0;a<t.length;a++)r.push(t[a][0],t[a][1],t[a][2]);return{nodes:_,edges:r}},t.append_node=_,t.has_node=r,t.append_edge=a,t.remove_node=i,t.remove_edge=s,t.remove_edge_by_attr=E,t.append_node_attr=function(e,t){if(l(e,t)==K){var r=c(e);return _(e,r,t),r}k.panic("Non-unique attribute")},t.replace_edge_attr=function(e,t,_,r,a){for(var n=e.edges,o=0;o<n.length;o+=3)n[o]==t&&n[o+1]==_&&n[o+2]==r&&(n[o+2]=a)},t.append_subgraph=function(e,t,r,n){r=r||[],n=n||[];for(var o={},i=0;i<e.nodes.length;i+=2){var s=e.nodes[i],E=e.nodes[i+1],l=c(t);_(t,l,E),o[s]=l}for(var i=0;i<e.edges.length;i+=3){var T=o[e.edges[i]],d=o[e.edges[i+1]],u=e.edges[i+2];a(t,T,d,u)}for(var i=0;i<r.length;i+=3){var T=o[r[i]],f=r[i+1],u=r[i+2];a(t,T,f,u)}for(var i=0;i<n.length;i+=3){var P=n[i],d=o[n[i+1]],u=n[i+2];a(t,P,d,u)}},t.gen_node_id=c,t.node_by_attr=l,t.append_edge_attr=function(e,t,_,r){var n=l(e,t),o=l(e,_);n!=K&&o!=K?a(e,n,o,r):k.panic("Attributes not found")},t.traverse=function(e,t){for(var _=e.nodes,r=0;r<_.length&&!t(_[r],_[r+1]);r+=2);},t.traverse_edges=function(e,t){for(var _=e.edges,r=0;r<_.length&&!t(_[r],_[r+1],_[r+2]);r+=3);},t.traverse_inputs=function(e,t,_){for(var r=e.edges,a=0;a<r.length;a+=3)if(r[a+1]==t){var n=r[a];if(_(n,h(e,n),r[a+2]))return}},t.traverse_outputs=function(e,t,_){for(var r=e.edges,a=0;a<r.length;a+=3)if(r[a]==t){var n=r[a+1];if(_(n,h(e,n),r[a+2]))return}},t.topsort=T,t.topsort_attr=function(e){for(var t=T(e).nodes,_=[],r=0;r<t.length;r+=2)_.push(t[r+1]);return _},t.is_connected=function(e){},t.subgraph_node_conn=function(e,t,_){r(e,t)||k.panic("No such node");var a={};d(e,a),f(e,t,a,_);var n=[];for(var o in a)if(a[o]){var o=Number(o);n.push(o,h(e,o))}var i={nodes:n,edges:e.edges.slice(0)};return P(i),i},t.cleanup_loose_edges=P,t.get_source_nodes=function(e){for(var t=[],_=e.nodes,r=0;r<_.length;r+=2){var a=_[r];L(e,a)||t.push(a)}return t},t.get_sink_nodes=A,t.match=function(e,t,_,r){var a={};a.g1=p(e),a.g2=p(t),a.node_comp=_||function(e,t){return e==t},a.edge_comp=r||function(e,t){return e==t};var n=S(e),o=S(t);a.n1=n,a.n2=o,a.order=B,a.core_len=a.orig_core_len=0,a.t1both_len=a.t1in_len=a.t1out_len=0,a.t2both_len=a.t2in_len=a.t2out_len=0,a.added_node1=K,a.core_1=Array(n),a.core_2=Array(o),a.in_1=new Array(n),a.in_2=new Array(o),a.out_1=new Array(n),a.out_2=new Array(o),a.share_count=[1];for(var i=0;i<n;i++)a.core_1[i]=K,a.in_1[i]=0,a.out_1[i]=0;for(var i=0;i<o;i++)a.core_2[i]=K,a.in_2[i]=0,a.out_2[i]=0;var s=new Array(n),E=new Array(n);if(O(s,E,a)){for(var i=0;i<s.length;i++)s[i]=e.nodes[2*s[i]],E[i]=t.nodes[2*E[i]];return[s,E]}return null},t.get_node_id=function(e,t){for(var _=e.nodes,r=1;r<_.length;r+=2)if(_[r]==t)return _[r-1];return null},t.get_node_attr=h,t.out_edge_count=Y,t.in_edge_count=L,t.get_out_edge=M,t.get_in_edge=x,t.get_edge_count=w,t.get_edge_attr=C,t.replace=function(e,t,r){for(var a=e.edges,n=c(e),o=0;o<t.length;o++){var s=t[o];i(e,s);for(var E=0;E<a.length;E+=3)a[E]==s&&(a[E]=n),a[E+1]==s&&(a[E+1]=n),a[E]==a[E+1]&&(a.splice(E,3),E-=3)}_(e,n,r)},t.reconnect_edges=function(e,t,_,r,a){y(e,t,_)||k.panic("Edge not found");for(var n=e.edges,o=0;o<n.length;o+=3)n[o]==t&&n[o+1]==_&&(n[o]=r,n[o+1]=a)},t.enforce_acyclic=function(e,t){function _(e,t){if(-1!=i.indexOf(e)){var r=i.slice(i.indexOf(e));if(-1!=a[r[r.length-1]].indexOf(r[0]))return void E.push([e,r[r.length-1]])}i.push(e);for(var n=0;n<t.length;n++)t[n]in a&&_(t[n],a[t[n]])}t||(t=A(e)[0]);var r=e.edges;if(!r.length||-1==r.indexOf(t))return e;for(var a={},n=0,o=0;o<r.length;o+=3)r[o+1]in a?a[r[o+1]].push(r[o]):a[r[o+1]]=[r[o]],n++;var i=[],E=[];_(t,a[t]);for(var o=0;o<E.length;o++){n=0;for(var c=0;c<r.length;c+=3)E[o][1]==r[c+1]&&E[o][0]==r[c]&&s(e,r[c],r[c+1],n),n++}return e},t.debug_dot=function(e,t,_){var r=e.nodes,a=e.edges,n="digraph debug {\n";n+="    ",n+="node [shape=box];\n";for(var o=0;o<r.length;o+=2){var i=r[o],s=r[o+1],E=t?t(i,s):String(i);n+="    ",n+=String(i)+' [label="'+E.replace(/\"/g,'\\"')+'"];\n'}for(var o=0;o<a.length;o+=3){var c=a[o],l=a[o+1],s=a[o+2];n+="    ",n+=String(c)+" -> "+String(l),_&&(n+=' [label="'+_(c,l,s)+'"]'),n+=";\n"}return n+="}"}}var a=_(0),n=_(5),o=_(2),i=Object(a.a)("__graph",r);t.a=i},function(e,t,_){"use strict";var r,a=!1;try{r=window.b4w}catch(e){r=self.b4w,a=!0}if(!r){var r={};a?self.b4w=r:window.b4w=r;var n={},o={};r.module=n,r._n_module=o;var i={};r.cleanup=function(e,t){t=t||"__b4w_default";var _=n[e];_&&(_._compiled=null),i[t]=null},r.register=function(e,t){n[e]||(n[e]=t)},r.require=function(e,t){if(!n[e]&&!o[e])throw new Error('Module "'+e+'" not found');return t=t||"__b4w_default",void 0!==o[e]?o[e](t):(i[t]||(i[t]=function(e){return function(t){if(!n[t]&&!o[t])throw new Error('Module "'+t+'" not found');if(void 0!==o[t])return o[t](e);var _=n[t];return _._compiled||(_._compiled={}),_._compiled[e]||(_._compiled[e]={},_(_._compiled[e],i[e])),_._compiled[e]}}(t)),i[t](e))},r.module_check=function(e){return void 0!==n[e]||void 0!==o[e]},r.get_namespace=function(e){for(var t in i)if(i[t]==e)return t;return""},r.worker_listeners=[],r.worker_namespaces=[]}t.a=r},function(e,t,_){"use strict";function r(e,t){function _(e,t){if(!S.is_camera(e))return O.error("get_view_vector(): Wrong camera object"),null;t=t||new Float32Array(3);var _=d.g(e.render.world_tsr);return u._33(_,u.c,t),t}var r=Object(n.a)(e),a=Object(o.a)(e),S=Object(s.a)(e),p=Object(E.a)(e),O=Object(c.a)(e),v=Object(l.a)(e),m=Object(T.a)(e),N=new Float32Array(2),g=new Float32Array(3),R=new Float32Array(3),I=new Float32Array(4),b=A.create(),h={},Y={};t.MS_STATIC=r.MS_STATIC,t.MS_TARGET_CONTROLS=r.MS_TARGET_CONTROLS,t.MS_EYE_CONTROLS=r.MS_EYE_CONTROLS,t.MS_HOVER_CONTROLS=r.MS_HOVER_CONTROLS,t.static_setup=function(e,t){if(!S.is_camera(e))return void O.error("static_setup(): Wrong camera object");if(r.wipe_move_style(e),e.render.move_style=r.MS_STATIC,t){var _=t.pos||d.j(e.render.world_tsr);t.look_at?r.set_look_at(e,_,t.look_at):m.set_translation(e,_)}m.update_transform(e),p.sync_transform(e),r.init_ortho_props(e)},t.static_set_look_at=function(e,t,_){if(!r.is_static_camera(e))return void O.error("static_set_look_at(): Wrong camera object or camera move style");t=t||d.j(e.render.world_tsr),_?r.set_look_at(e,t,_):m.set_translation(e,t),m.update_transform(e),p.sync_transform(e)},t.static_set_rotation=function(e,t){if(!r.is_static_camera(e))return void O.error("static_set_rotation(): Wrong camera object or camera move style");m.set_rotation(e,t),m.update_transform(e),p.sync_transform(e)},t.static_get_rotation=function(e,t){return r.is_static_camera(e)?(t=t||new Float32Array(4),m.get_rotation(e,t)):(O.error("static_get_rotation(): Wrong camera object or camera move style"),null)},t.eye_setup=function(e,t){if(!S.is_camera(e))return void O.error("eye_setup(): Wrong camera object");if(t&&t.horiz_rot_lim&&("number"!=typeof t.horiz_rot_lim.left||"number"!=typeof t.horiz_rot_lim.right))return void O.error("eye_setup(): Wrong horizontal limits object.");if(t&&t.vert_rot_lim&&("number"!=typeof t.vert_rot_lim.down||"number"!=typeof t.vert_rot_lim.up))return void O.error("eye_setup(): Wrong vertical limits object.");if(r.wipe_move_style(e),e.render.move_style=r.MS_EYE_CONTROLS,t){var _=t.pos||d.j(e.render.world_tsr);r.setup_eye_model(e,_,t.look_at,t.horiz_rot_lim,t.vert_rot_lim)}m.update_transform(e),p.sync_transform(e),r.init_ortho_props(e)},t.eye_set_look_at=function(e,t,_){if(!r.is_eye_camera(e))return void O.error("eye_set_look_at(): Wrong camera object or camera move style");t=t||d.j(e.render.world_tsr),_?r.set_look_at_corrected(e,t,_):m.set_translation(e,t),r.correct_up(e,e.render.vertical_axis,!0),m.update_transform(e),p.sync_transform(e)},t.eye_rotate=function(e,_,a,n){if(O.error_deprecated("eye_rotate","rotate_camera"),!r.is_eye_camera(e))return void O.error("eye_rotate(): Wrong camera object or camera move style");n=n||!1,t.rotate_camera(e,_,a,n)},t.eye_set_vertical_limits=function(e,t){return r.is_eye_camera(e)?!t||"number"==typeof t.down&&"number"==typeof t.up?(r.set_vertical_rot_limits(e,t),m.update_transform(e),void p.sync_transform(e)):void O.error("eye_set_vertical_limits(): Incorrect limits object."):void O.error("eye_set_vertical_limits(): Wrong camera object or camera move style")},t.eye_get_vertical_limits=function(e,t,_){if(!r.is_eye_camera(e))return O.error("eye_get_vertical_limits(): Wrong camera object or camera move style"),null;var a=e.render;return a.vertical_limits?(t=t||{},_?(t.down=a.vertical_limits.down_local,t.up=a.vertical_limits.up_local):(t.down=a.vertical_limits.down,t.up=a.vertical_limits.up),t.camera_space=_||!1,t):null},t.eye_set_horizontal_limits=function(e,t){return r.is_eye_camera(e)?!t||"number"==typeof t.left&&"number"==typeof t.right?(r.set_horizontal_rot_limits(e,t),m.update_transform(e),void p.sync_transform(e)):void O.error("eye_set_horizontal_limits(): Incorrect limits object."):void O.error("eye_set_horizontal_limits(): Wrong camera object or camera move style")},t.eye_get_horizontal_limits=function(e,t,_){if(!r.is_eye_camera(e))return O.error("eye_get_horizontal_limits(): Wrong camera object or camera move style"),null;var a=e.render;return a.horizontal_limits?(t=t||{},_?(t.left=a.horizontal_limits.left_local,t.right=a.horizontal_limits.right_local):(t.left=a.horizontal_limits.left,t.right=a.horizontal_limits.right),t.camera_space=_||!1,t):null},t.target_setup=function(e,t){if(!S.is_camera(e))return void O.error("target_setup(): Wrong camera object");if(t.horiz_rot_lim&&("number"!=typeof t.horiz_rot_lim.left||"number"!=typeof t.horiz_rot_lim.right))return void O.error("target_setup(): Wrong horizontal limits object");if(t.vert_rot_lim&&("number"!=typeof t.vert_rot_lim.down||"number"!=typeof t.vert_rot_lim.up))return void O.error("target_setup(): Wrong vertical limits object");if(t.dist_lim){if("number"!=typeof t.dist_lim.min||"number"!=typeof t.dist_lim.max||t.dist_lim.min>t.dist_lim.max)return void O.error("target_setup(): Wrong distance limits object");t.dist_lim.min=Math.max(t.dist_lim.min,0),t.dist_lim.max=Math.max(t.dist_lim.max,0)}if(t.pivot_lim&&("number"!=typeof t.pivot_lim.min_y||"number"!=typeof t.pivot_lim.max_y||t.pivot_lim.min_y>t.pivot_lim.max_y))return void O.error("target_setup(): Wrong pivot limits object");r.wipe_move_style(e),e.render.move_style=r.MS_TARGET_CONTROLS;var a=t.pos||d.j(e.render.world_tsr),n=t.pivot;if(!n){var o=_(e,g);n=f.add(a,o,o)}r.setup_target_model(e,a,n,t.horiz_rot_lim,t.vert_rot_lim,t.dist_lim,t.pivot_lim,t.use_panning||!1),m.update_transform(e),p.sync_transform(e),r.init_ortho_props(e)},t.target_rotate=function(e,_,a,n){if(O.error_deprecated("target_rotate","rotate_camera"),!r.is_target_camera(e))return void O.error("target_rotate(): Wrong camera object or camera move style");n=n||!1,t.rotate_camera(e,_,a,n)},t.target_set_trans_pivot=function(e,t,_){if(!r.is_target_camera(e))return void O.error("target_set_trans_pivot(): Wrong camera object or camera move style");t=t||d.j(e.render.world_tsr),_=_||e.render.pivot,r.set_trans_pivot(e,t,_),m.update_transform(e),p.sync_transform(e)},t.target_set_pivot_translation=function(e,t){if(!r.is_target_camera(e))return void O.error("target_set_pivot_translation(): Wrong camera object or camera move style");r.set_target_pivot(e,t),m.update_transform(e),p.sync_transform(e)},t.target_set_distance=function(e,t){if(!r.is_target_camera(e))return void O.error("target_set_distance(): Wrong camera object or camera move style");var _=m.obj_point_distance(e,e.render.pivot),a=Math.max(0,t);m.move_local(e,0,0,a-_),m.update_transform(e),p.sync_transform(e)},t.target_get_distance=function(e){return r.is_target_camera(e)?m.obj_point_distance(e,e.render.pivot):(O.error("target_get_distance(): Wrong camera object or camera move style"),0)},t.target_zoom_object=function(e,t){if(!r.is_target_camera(e))return void O.error("target_zoom_object(): Wrong camera object or camera move style");var _=m.get_object_center(t,!1,g),a=m.get_object_size(t),n=v.get_active(),o=S.get_scene_data(e,n),i=o.cameras[0],s=r.get_angular_diameter(i)/2,E=a/Math.sin(s),c=m.obj_point_distance(e,_);r.set_trans_pivot(e,d.j(e.render.world_tsr),_),m.update_transform(e),m.move_local(e,0,0,E-c),m.update_transform(e),p.sync_transform(e)},t.target_get_pivot=function(e,t){return r.is_target_camera(e)?(t=t||new Float32Array(3),f.copy(e.render.pivot,t),t):(O.error("target_get_pivot(): Wrong camera object or camera move style"),null)},t.target_set_distance_limits=function(e,t){if(!r.is_target_camera(e))return void O.error("target_set_distance_limits(): Wrong camera object or camera move style");if(t){if("number"!=typeof t.min||"number"!=typeof t.max||t.min>t.max)return void O.error("target_set_distance_limits(): Wrong limits object");t.min=Math.max(t.min,0),t.max=Math.max(t.max,0)}r.set_distance_limits(e,t),m.update_transform(e),p.sync_transform(e)},t.target_get_distance_limits=function(e,t){if(!r.is_target_camera(e))return O.error("target_get_distance_limits(): Wrong camera object or camera move style"),null;var _=e.render;return _.distance_limits?(t=t||{},t.min=_.distance_limits.min,t.max=_.distance_limits.max,t):null},t.target_set_vertical_limits=function(e,t){return r.is_target_camera(e)?!t||"number"==typeof t.down&&"number"==typeof t.up?(r.set_vertical_rot_limits(e,t),m.update_transform(e),void p.sync_transform(e)):void O.error("target_set_vertical_limits(): Wrong limits object"):void O.error("target_set_vertical_limits(): Wrong camera object or camera move style")},t.target_get_vertical_limits=function(e,t,_){if(!r.is_target_camera(e))return O.error("target_get_vertical_limits(): Wrong camera object or camera move style"),null;var a=e.render;return a.vertical_limits?(t=t||{},_?(t.down=a.vertical_limits.down_local,t.up=a.vertical_limits.up_local):(t.down=a.vertical_limits.down,t.up=a.vertical_limits.up),t.camera_space=_||!1,t):null},t.target_set_horizontal_limits=function(e,t){return r.is_target_camera(e)?!t||"number"==typeof t.left&&"number"==typeof t.right?(r.set_horizontal_rot_limits(e,t),m.update_transform(e),void p.sync_transform(e)):void O.error("target_set_horizontal_limits(): Wrong limits object"):void O.error("target_set_horizontal_limits(): Wrong camera object or camera move style")},t.target_get_horizontal_limits=function(e,t,_){if(!r.is_target_camera(e))return O.error("target_get_horizontal_limits(): Wrong camera object or camera move style"),null;var a=e.render;return a.horizontal_limits?(t=t||{},_?(t.left=a.horizontal_limits.left_local,t.right=a.horizontal_limits.right_local):(t.left=a.horizontal_limits.left,t.right=a.horizontal_limits.right),t.camera_space=_||!1,t):null},t.target_set_pivot_limits=function(e,t){return r.is_target_camera(e)?t&&("number"!=typeof t.min_z||"number"!=typeof t.max_z||t.min_z>t.max_z)?void O.error("target_set_pivot_limits(): Wrong limits object"):(r.set_pivot_limits(e,t),m.update_transform(e),void p.sync_transform(e)):void O.error("target_set_pivot_limits(): Wrong camera object or camera move style")},t.target_get_pivot_limits=function(e,t){if(!r.is_target_camera(e))return O.error("target_get_pivot_limits(): Wrong camera object or camera move style"),null;var _=e.render;return _.pivot_limits?(t=t||{},t.min_z=_.pivot_limits.min_z,t.max_z=_.pivot_limits.max_z,t):null},t.target_pan_pivot=function(e,t,_){if(!r.is_target_camera(e))return void O.error("target_pan_pivot(): wrong object");var a=e.render;if(a.use_panning){var n=g;n[0]=t,n[1]=-_,n[2]=0,d.w(n,a.world_tsr,n),f.add(a.pivot,n,a.pivot);var o=d.j(a.world_tsr);f.add(o,n,o),m.update_transform(e),p.sync_transform(e)}},t.target_switch_panning=function(e,t){if(!r.is_target_camera(e))return O.error("target_switch_panning(): Wrong camera object or camera move style"),null;e.render.use_panning=t},t.hover_setup_rel=function(e,_){if(t.hover_setup(e,{pos:_.pos,pivot:_.pivot}),void 0===_.dist_interval)var a=0;else var a=Math.max(_.dist_interval,0);if(void 0===_.angle_interval)var n=0;else var n=Math.max(_.angle_interval,0);if(void 0===_.t)var o=.5;else var o=u.M(_.t,0,1);var i=t.hover_get_distance_limits(e,h);i.min=Math.max(i.min-o*a,0),i.max=i.max+(1-o)*a;var s=t.hover_get_vertical_limits(e,Y);s.down=u.M(s.down+o*n,-Math.PI/2,0),s.up=u.M(s.up-(1-o)*n,-Math.PI/2,0),r.hover_set_distance_limits(e,i),r.hover_set_vertical_limits(e,s),m.update_transform(e),p.sync_transform(e),r.init_ortho_props(e)},t.hover_setup=function(e,t){if(!S.is_camera(e))return void O.error("hover_setup(): Wrong camera object");if(t.dist_lim){if("number"!=typeof t.dist_lim.min||"number"!=typeof t.dist_lim.max||t.dist_lim.min>t.dist_lim.max)return void O.error("hover_setup(): Wrong distance limits object");t.dist_lim.min=Math.max(t.dist_lim.min,0),t.dist_lim.max=Math.max(t.dist_lim.max,0)}if(t.hover_angle_lim&&("number"!=typeof t.hover_angle_lim.down||"number"!=typeof t.hover_angle_lim.up||t.hover_angle_lim.down<t.hover_angle_lim.up))return void O.error("hover_setup(): Wrong hover angle limits object");if(t.horiz_trans_lim&&("number"!=typeof t.horiz_trans_lim.min||"number"!=typeof t.horiz_trans_lim.max||t.horiz_trans_lim.min>t.horiz_trans_lim.max))return void O.error("hover_setup(): Wrong horizontal translation limits object");if(t.vert_trans_lim&&("number"!=typeof t.vert_trans_lim.min||"number"!=typeof t.vert_trans_lim.max||t.vert_trans_lim.min>t.vert_trans_lim.max))return void O.error("hover_setup(): Wrong vertical translation limits object");r.wipe_move_style(e),e.render.move_style=r.MS_HOVER_CONTROLS;var _=t.pos||d.j(e.render.world_tsr);r.setup_hover_model(e,_,t.pivot,t.dist_lim,t.hover_angle_lim,t.horiz_trans_lim,t.vert_trans_lim,t.enable_horiz_rot||!1),m.update_transform(e),p.sync_transform(e),r.init_ortho_props(e)},t.hover_rotate=function(e,_,a,n){if(O.error_deprecated("hover_rotate","rotate_camera"),!r.is_hover_camera(e))return void O.error("hover_rotate(): Wrong camera object or camera move style");n=n||!1,t.rotate_camera(e,_,a,n)},t.hover_set_pivot_translation=function(e,t){if(!r.is_hover_camera(e))return void O.error("hover_set_pivot_translation(): Wrong camera object or camera move style");r.set_hover_pivot(e,t),m.update_transform(e),p.sync_transform(e)},t.hover_get_pivot=function(e,t){return r.is_hover_camera(e)?(t=t||new Float32Array(3),f.copy(e.render.hover_pivot,t),t):(O.error("hover_get_pivot(): Wrong camera object or camera move style"),null)},t.hover_get_distance=function(e){return r.is_hover_camera(e)?m.obj_point_distance(e,e.render.hover_pivot):(O.error("hover_get_distance(): Wrong camera object or camera move style"),0)},t.hover_set_vertical_limits=function(e,t){return r.is_hover_camera(e)?"number"!=typeof t.down||"number"!=typeof t.up||t.down<t.up?void O.error("hover_set_vertical_limits(): Wrong limits object"):(r.hover_set_vertical_limits(e,t),m.update_transform(e),void p.sync_transform(e)):void O.error("hover_set_vertical_limits(): Wrong camera object or camera move style")},t.hover_get_vertical_limits=function(e,t){if(!r.is_hover_camera(e))return O.error("hover_get_vertical_limits(): Wrong camera object or camera move style"),null;var _=e.render;return t=t||{},t.down=_.vertical_limits.down,t.up=_.vertical_limits.up,t},t.hover_set_distance_limits=function(e,t){return r.is_hover_camera(e)?"number"!=typeof t.min||"number"!=typeof t.max||t.min>t.max?void O.error("hover_set_distance_limits(): Wrong limits object"):(t.min=Math.max(t.min,0),t.max=Math.max(t.max,0),r.hover_set_distance_limits(e,t),m.update_transform(e),void p.sync_transform(e)):void O.error("hover_set_distance_limits(): Wrong camera object or camera move style")},t.hover_get_distance_limits=function(e,t){if(!r.is_hover_camera(e))return O.error("hover_get_distance_limits(): Wrong camera object or camera move style"),null;var _=e.render;return t=t||{},t.min=_.distance_limits.min,t.max=_.distance_limits.max,t},t.hover_set_vert_trans_limits=function(e,t){return r.is_hover_camera(e)?t&&("number"!=typeof t.min||"number"!=typeof t.max||t.min>t.max)?void O.error("hover_set_vert_trans_limits(): Wrong limits object"):(r.set_vert_trans_limits(e,t),m.update_transform(e),void p.sync_transform(e)):void O.error("hover_set_vert_trans_limits(): Wrong camera object or camera move style")},t.hover_get_vert_trans_limits=function(e,t){if(!r.is_hover_camera(e))return O.error("hover_get_vert_trans_limits(): Wrong camera object or camera move style"),null;var _=e.render;return _.hover_vert_trans_limits?(t=t||{},t.min=_.hover_vert_trans_limits.min,t.max=_.hover_vert_trans_limits.max,t):null},t.hover_set_horiz_trans_limits=function(e,t){return r.is_hover_camera(e)?t&&("number"!=typeof t.min||"number"!=typeof t.max||t.min>t.max)?void O.error("hover_set_horiz_trans_limits(): Wrong limits object"):(r.set_hor_trans_limits(e,t),m.update_transform(e),void p.sync_transform(e)):void O.error("hover_set_horiz_trans_limits(): Wrong camera object or camera move style")},t.hover_get_horiz_trans_limits=function(e,t){if(!r.is_hover_camera(e))return O.error("hover_get_horiz_trans_limits(): Wrong camera object or camera move style"),null;var _=e.render;return _.hover_horiz_trans_limits?(t=t||{},t.min=_.hover_horiz_trans_limits.min,t.max=_.hover_horiz_trans_limits.max,t):null},t.hover_switch_horiz_rotation=function(e,t){if(!r.is_hover_camera(e))return O.error("hover_switch_horiz_rotation(): Wrong camera object or camera move style"),null;e.render.enable_hover_hor_rotation=t},t.is_static_camera=r.is_static_camera,t.is_target_camera=r.is_target_camera,t.is_eye_camera=r.is_eye_camera,t.is_hover_camera=r.is_hover_camera,t.get_move_style=function(e){return S.is_camera(e)?r.get_move_style(e):(O.error("get_move_style(): Wrong camera object"),null)},t.set_translation=function(e,t){if(!S.is_camera(e))return void O.error("set_translation(): Wrong camera object");var _=e.render;if(r.is_target_camera(e)){var a=d.j(_.world_tsr),n=f.subtract(t,a,g);f.add(n,_.pivot,_.pivot)}else if(r.is_hover_camera(e)){var a=d.j(_.world_tsr),n=f.subtract(t,a,g);f.add(n,_.hover_pivot,_.hover_pivot)}m.set_translation(e,t),m.update_transform(e),p.sync_transform(e)},t.get_translation=function(e,t){return S.is_camera(e)?(t=t||new Float32Array(3),m.get_translation(e,t)):(O.error("get_translation(): Wrong camera object"),null)},t.rotate_camera=function(e,t,_,a){if(!S.is_camera(e))return void O.error("rotate_camera(): Wrong camera object");a=a||!1,a?r.set_rotation_angles(e,t,_):r.rotate_angles(e,t,_),m.update_transform(e),p.sync_transform(e)},t.set_velocities=function(e,t){if(!S.is_camera(e))return void O.error("set_velocities(): Wrong camera object");var _=e.render;"number"==typeof t.trans&&(_.velocity_trans=u.M(t.trans,0,1/0)),"number"==typeof t.rot&&(_.velocity_rot=u.M(t.rot,0,1/0)),"number"==typeof t.zoom&&(_.velocity_zoom=u.M(t.zoom,0,.99))},t.get_velocities=function(e,t){if(!S.is_camera(e))return O.error("get_velocities(): Wrong camera object"),null;var _=e.render;return t=t||{},t.trans=_.velocity_trans,t.rot=_.velocity_rot,t.zoom=_.velocity_zoom,t},t.is_look_up=function(e){if(!S.is_camera(e))return O.error("is_look_up(): Wrong camera object"),!1;var t=d.g(e.render.world_tsr);return u._33(t,u.c,g)[1]>=0},t.get_camera_angles=function(e,t){return S.is_camera(e)?(t=t||new Float32Array(2),r.get_camera_angles(e,t),t):(O.error("get_camera_angles(): Wrong camera object"),null)},t.get_camera_angles_char=function(e,t){return S.is_camera(e)?(t=t||new Float32Array(2),r.get_camera_angles_char(e,t),t):(O.error("get_camera_angles_char(): Wrong camera object"),null)},t.get_camera_angles_dir=function(e,t){t=t||new Float32Array(2);var _=f.normalize(e,g),a=u._47(u.c,_,b);return u.R(a,!0),r.get_camera_angles_from_quat(a,u.f,t),t},t.set_stereo_distance=function(e,t){if(!S.is_camera(e))return void O.error("set_stereo_distance(): Wrong camera object");for(var _=v.get_active(),a=S.get_scene_data(e,_),n=a.cameras,o=0;o<n.length;o++){var i=n[o];i.type!=r.TYPE_STEREO_LEFT&&i.type!=r.TYPE_STEREO_RIGHT&&i.type!=r.TYPE_HMD_LEFT&&i.type!=r.TYPE_HMD_RIGHT||r.set_stereo_params(i,t,i.stereo_eye_dist)}},t.get_stereo_distance=function(e){if(!S.is_camera(e))return O.error("get_stereo_distance(): Wrong camera object"),0;for(var t=v.get_active(),_=S.get_scene_data(e,t),a=_.cameras,n=0;n<a.length;n++){var o=a[n];if(o.type==r.TYPE_STEREO_LEFT||o.type==r.TYPE_STEREO_RIGHT)return o.stereo_conv_dist}return 0},t.set_eye_distance=function(e,t){if(!S.is_camera(e))return void O.error("set_eye_distance(): Wrong camera object");var _=v.get_active(),a=S.get_scene_data(e,_),n=a.cameras;r.set_eye_distance(n,t)},t.get_eye_distance=function(e){if(!S.is_camera(e))return O.error("get_eye_distance(): Wrong camera object"),0;for(var t=v.get_active(),_=S.get_scene_data(e,t),a=_.cameras,n=0;n<a.length;n++){var o=a[n];if(o.type==r.TYPE_STEREO_LEFT||o.type==r.TYPE_STEREO_RIGHT||o.type==r.TYPE_HMD_LEFT||o.type==r.TYPE_HMD_RIGHT)return o.stereo_eye_dist}return 0},t.set_vertical_axis=function(e,t){if(!S.is_camera(e))return void O.error("set_vertical_axis(): Wrong camera object");var _=e.render;f.copy(t,_.vertical_axis),m.update_transform(e),p.sync_transform(e)},t.get_vertical_axis=function(e,t){if(!S.is_camera(e))return void O.error("get_vertical_axis(): Wrong camera object");t||(t=f.create());var _=e.render;return f.copy(_.vertical_axis,t),t},t.translate_view=function(e,t,_,a){if(!S.is_camera(e))return void O.error("translate_view(): Wrong camera object");for(var n=v.get_active(),o=S.get_scene_data(e,n),i=o.cameras,s=0;s<i.length;s++){var E=i[s];f.set(-t,-_,0,E.view_transform_params.trans),E.reflection_plane?r.set_projection_reflect(E,!1):r.set_projection(E,!1)}},t.get_view_vector=_,t.get_fov=function(e){if(!S.is_camera(e))return O.error("get_fov(): Wrong camera object"),0;var t=v.get_active(),_=S.get_scene_data(e,t),a=_.cameras;return r.get_fov(a[0])},t.set_fov=function(e,t){if(!S.is_camera(e))return void O.error("set_fov(): Wrong camera object");for(var _=v.get_active(),a=S.get_scene_data(e,_),n=a.cameras,o=0;o<n.length;o++){var i=n[o];r.set_fov(i,t),i.reflection_plane?r.set_projection_reflect(i,!1):r.set_projection(i,!1)}},t.set_hmd_fov=function(e,t,_){O.error_once("set_hmd_fov() deprecated")},t.correct_up=function(e,t,_){if(!S.is_camera(e))return void O.error("correct_up(): Wrong camera object");t=t||e.render.vertical_axis,r.correct_up(e,t,_||!1),m.update_transform(e),p.sync_transform(e)},t.set_ortho_scale=function(e,t){if(!S.is_camera(e)||!r.is_ortho_camera(e))return void O.error("set_ortho_scale(): Wrong camera object");var _=e.render;if(r.is_target_camera(e)){var a=d.j(_.world_tsr),n=f.dist(a,_.pivot);_.init_fov=t/2*_.init_dist/n}else if(r.is_hover_camera(e)){var a=d.j(_.world_tsr),n=f.distance(a,_.hover_pivot);_.init_fov=t/2*_.init_dist/n}else{var o=v.get_active(),i=S.get_scene_data(e,o);i.cameras[0].fov=t/2}r.update_ortho_scale(e)},t.get_ortho_scale=function(e){if(!S.is_camera(e)||!r.is_ortho_camera(e))return O.error("get_ortho_scale(): Wrong camera object"),0;var t=v.get_active();return 2*S.get_scene_data(e,t).cameras[0].fov},t.is_ortho_camera=function(e){return S.is_camera(e)?r.is_ortho_camera(e):(O.error("is_ortho_camera(): Wrong camera object"),!1)},t.calc_ray=function(e,t,_,n){if(!S.is_camera(e))return O.error("calc_ray(): Wrong camera object"),null;var o=v.get_active(),s=S.get_scene_data(e,o),E=s.cameras[0];switch(n&&3==n.length?O.error_once('dest parameter in the function "calc_ray" should be type of parametric line.'):n=n||new Float32Array(6),E.type){case r.TYPE_PERSP:case r.TYPE_PERSP_ASPECT:case r.TYPE_STEREO_LEFT:case r.TYPE_STEREO_RIGHT:var c=Math.tan(r.get_vfov(E)/2),l=c*E.aspect,T=g,P=a.canvas_to_viewport_coords(t,_,N,E);if(T[0]=(2*P[0]/E.width-1)*l,T[1]=(1-2*P[1]/E.height)*c,T[2]=-1,d.w(T,e.render.world_tsr,T),f.normalize(T,T),3==n.length)f.copy(T,n);else{var A=m.get_translation(e,R);i.R(n,A),i.Q(n,T)}return n;case r.TYPE_ORTHO:var T=g,P=a.canvas_to_viewport_coords(t,_,N,E);T[0]=(2*P[0]/E.width-1)*E.top*E.aspect,T[1]=(1-2*P[1]/E.height)*E.top,T[2]=0,d.B(T,e.render.world_tsr,T),f.copy(T,n);var p=d.g(e.render.world_tsr,I);return f.transformQuat(u.c,p,T),i.Q(n,T),n;default:return O.error("calc_ray(): Non-compatible camera"),n}},t.project_point=function(e,t,_){return S.is_camera(e)?(_=_||new Float32Array(2),r.project_point(e,t,_)):(O.error("project_point(): Wrong camera object"),null)},t.has_distance_limits=function(e){return(r.is_target_camera(e)||r.is_hover_camera(e))&&null!==e.render.distance_limits},t.has_vertical_rot_limits=function(e){return(r.is_eye_camera(e)||r.is_target_camera(e)||r.is_hover_camera(e))&&null!==e.render.vertical_limits},t.has_horizontal_rot_limits=function(e){return(r.is_target_camera(e)||r.is_eye_camera(e))&&null!==e.render.horizontal_limits},t.has_vertical_trans_limits=function(e){return r.is_hover_camera(e)&&null!==e.render.hover_vert_trans_limits},t.has_horizontal_trans_limits=function(e){return r.is_hover_camera(e)&&null!==e.render.hover_horiz_trans_limits},t.get_frustum_planes=function(e,t){if(!S.is_camera(e))return O.error("get_frustum_planes(): Wrong camera object"),null;var _=v.get_active(),r=S.get_scene_data(e,_),a=r.cameras[0].frustum_planes;return P.copy(a.left,t.left),P.copy(a.right,t.right),P.copy(a.top,t.top),P.copy(a.bottom,t.bottom),P.copy(a.near,t.near),P.copy(a.far,t.far),t},t.set_projection=function(e,t){S.is_camera(e)?r.set_proj_mat(e,t):O.error("set_projection(): Wrong camera object")}}var a=_(0),n=_(14),o=_(15),i=_(41),s=_(8),E=_(19),c=_(1),l=_(10),T=_(13),d=_(6),u=_(2),f=_(3),P=_(7),A=_(9),S=Object(a.a)("camera",r);t.a=S},function(e,t,_){"use strict";function r(e,t){function _(){return{vert:"",frag:"",directives:[],node_elements:[],status:oe,attribute_count:0,texture_count:0}}function r(e){var t=_();return t.vert=e.vert,t.frag=e.frag,t.directives=c.O(e.directives),t.node_elements=c.O(e.node_elements),t.status=e.status,t.attribute_count=e.attribute_count,t.texture_count=e.texture_count,t}function a(e,t,_){var r=e.directives;if("string"==typeof _){var a=d(e,_);a&&(_=a[1])}else _=String(_);for(var n=0;n<r.length;n++)if(r[n][0]==t)return void(r[n][1]=_);$&&q.error("Incompatible directive '"+t+"' was set for shaders "+e.vert+"/"+e.frag+".")}function d(e,t){for(var _=e.directives,r=0;r<_.length;r++)if(_[r][0]==t)return _[r];return!1}function u(e,t){var _=e+t;if(!(_ in re)){var r=x(Z.shaders_path,e),a=x(Z.shaders_path,t),n=w(r),o=w(a);for(var i in o)n[i]=o[i];var s=[];for(var i in n)s.push([i,n[i]]);re[_]=s}return re[_]}function f(e){var t=JSON.stringify(e.vert)+JSON.stringify(e.frag)+JSON.stringify(e.directives)+JSON.stringify(e.node_elements),_=ee[t];if(_)return _;var r=e.vert,a=e.frag,n=x(Z.shaders_path,r),o=x(Z.shaders_path,a);if(!n||!o)return null;var i=C("vert",n,e),s=C("frag",o,e);if(p(s,i,e),e.status===oe){ee[t]=_=D(Ie,i,s,t,e);var E=!Ie.getShaderParameter(_.fshader,Ie.COMPILE_STATUS),c=!Ie.getShaderParameter(_.vshader,Ie.COMPILE_STATUS),l=!Ie.getProgramParameter(_.program,Ie.LINK_STATUS);E?P(_.fshader,t,s):c?P(_.vshader,t,i):l&&S(_.program,t,i,s),(E||c||l)&&(e.status|=Te,_=null)}else _=null;return _}function P(e,t,_){W.gl_debug&&(_=A(_),q.error("shader compilation failed:\n"+_+"\n"+Ie.getShaderInfoLog(e)+" ("+t+")"))}function A(e){for(var t=e.split("\n"),_=0;_<t.length;_++)t[_]=_+1+" "+t[_];return e=t.join("\n")}function S(e,t,_,r){W.gl_debug&&(_=A(_),r=A(r),q.error("shader linking failed:\n"+_+"\n\n\n"+r+"\n"+Ie.getProgramInfoLog(e)+" ("+t+")"))}function p(e,t,_){var r=oe,a=m(e,de);_.texture_count=a,a>J.max_texture_image_units&&(r|=ie),O(),I(e,ve,J.max_fragment_uniform_vectors)||(r|=se),I(t,me,J.max_vertex_uniform_vectors)||(r|=Ee);var n=N(t);_.attribute_count=n,n>J.max_vertex_attribs&&(r|=ce),R(e)||(r|=le),_.status=r}function O(){Oe||(Oe=new Uint32Array(J.max_varying_vectors)),ve||(ve=new Uint32Array(J.max_fragment_uniform_vectors)),me||(me=new Uint32Array(J.max_vertex_uniform_vectors))}function v(e,t){return e+t}function m(e,t){return(e.split(";").map(function(e){var _=e.match(t);return _&&(_[3]?parseInt(_[3],10):1)}).filter(function(e){return e})||[]).reduce(v,0)}function N(e){if(W.webgl2){return(e.replace(/(.*?)\([^()]*?\)(.*?)/g,"$1$2").match(/(?:^|[^a-zA-Z_])in(?=\s)/g)||[]).length}return(e.match(/(?:^|[^a-zA-Z_])attribute(?=\s)/g)||[]).length}function g(e,t){var _=M(e.type),r=M(t.type),a=e.array_size,n=t.array_size;return _>r?-1:_<r?1:a>n?-1:a<n?1:0}function R(e){if(W.webgl2){e=e.replace(/(.*?)\([^()]*?\)(.*?)/g,"$1$2");var t=fe}else var t=Pe;return b(e.split(";").map(function(e){var _=e.match(t);return _&&{type:_[2],array_size:_[4]?parseInt(_[4],10):1}}).filter(function(e){return e}),Oe,J.max_varying_vectors)}function I(e,t,_){for(var r=e.split(";"),a=[],n=0;n<r.length;n++){var o=r[n].match(ue);o&&a.push({type:o[2],array_size:o[4]?parseInt(o[4],10):1})}return b(a,t,_)}function b(e,t,_){if(!e.length)return!0;for(var r=0;r<_;r++)t[r]=0;ge=_,e.sort(g);var a=0,n=0,o=0;return function(){for(;o<e.length;){var _=e[o];if(4!=M(_.type))break;n+=L(_.type)*_.array_size,o++}return!(n>ge)&&(Ne=n,Y(t,0,n,0,4),!0)}()&&function(){for(var _=0;o<e.length;){var r=e[o];if(3!=M(r.type))break;_+=L(r.type)*r.array_size,o++}return!((a=n+_)>ge)&&(Y(t,n,_,0,3),!0)}()&&function(){for(var _=ge-a,r=_,n=_;o<e.length;){var i=e[o];if(2!=M(i.type))break;var s=L(i.type)*i.array_size;if(s<=r)r-=s;else{if(!(s<=n))return!1;n-=s}o++}var E=_-r,c=_-n;return Y(t,a,E,0,2),Y(t,ge-c,c,2,2),!0}()&&function(){for(;o<e.length;){for(var r=e[o],a=L(r.type)*r.array_size,n=-1,i=_+1,s=-1,E=0;E<4;E++){var c=pe;c[0]=0,c[1]=1,h(t,E,a,c)&&c[1]<i&&(s=c[0],i=c[1],n=E)}if(n<0)return!1;Y(t,s,a,n,1),o++}return!0}()}function h(e,t,_,r){for(;Ne<e.length&&e[Ne]===Se;)Ne++;for(;ge>0&&e[ge]===Se;)ge--;if(ge-Ne<_)return!1;for(var a=1<<t,n=0,o=-1,i=e.length+1,s=!1,E=Ne;E<=ge;E++){if(E<ge&&!(e[E]&a))s||(n=E,s=!0);else{if(s){var c=E-n;c>=_&&c<i&&(i=c,o=n)}s=!1}}return!(o<0)&&(r[0]=o,r[1]=i,!0)}function Y(e,t,_,r,a){for(var n=0,o=0;o<a;o++)n|=1<<r+o;for(var o=0;o<_;o++)e[t+o]|=n}function L(e){var t=0;switch(e){case"mat4":t=4;break;case"mat3":t=3;break;case"mat2":t=2;break;default:t=1}return t}function M(e){var t=0;switch(e){case"mat4":case"vec4":case"ivec4":case"bvec4":case"mat2":t=4;break;case"mat3":case"vec3":case"ivec3":case"bvec3":t=3;break;case"vec2":case"ivec2":case"bvec2":t=2;break;default:t=1}return t}function x(e,t){var _=e+t;if(te[_])return te[_];if(_e){var r=_e[t];if(!r)return null;var a=T.parser.parse(r)}else{var a=n.a.require("shader_texts")[t];if(!a)return null}return te[_]=a,a}function y(e,t){_e||(_e={}),_e[e]=t}function U(e,t){for(var _={},r=t.directives||[],a=0;a<r.length;a++)_[r[a][0]]=[r[a][1]];for(var a=0;a<t.node_elements.length;a++)_["USE_NODE_"+t.node_elements[a].id]=["1"];W.webgl2?(_.GLSL1=["0"],_.GLSL3=["1"],_.GLSL_VERSION=["300 es"],_.GLSL_IN=["in"],_.GLSL_OUT=["out"],_.GLSL_OUT_FRAG_COLOR=["glsl_out_frag_color"],_.GLSL_TEXTURE=["texture"],_.GLSL_TEXTURE_CUBE=["texture"],_.GLSL_TEXTURE_PROJ=["textureProj"],_.GLSL_TEXTURE_LOD=["textureLod"],_.GLSL_TEXTURE_CUBE_LOD=["textureLod"]):(_.GLSL1=["1"],_.GLSL3=["0"],_.GLSL_VERSION=["100"],_.GLSL_IN="vert"==e?["attribute"]:["varying"],_.GLSL_OUT="vert"==e?["varying"]:[""],_.GLSL_OUT_FRAG_COLOR=["gl_FragColor"],_.GLSL_TEXTURE=["texture2D"],_.GLSL_TEXTURE_CUBE=["textureCube"],_.GLSL_TEXTURE_PROJ=["texture2DProj"],_.GLSL_TEXTURE_LOD=["textureLod"],W.texture_lod_available?(_.GLSL_TEXTURE_LOD=["texture2DLodEXT"],_.GLSL_TEXTURE_CUBE_LOD=["textureCubeLodEXT"]):(_.GLSL_TEXTURE_LOD=["texture2D"],_.GLSL_TEXTURE_CUBE_LOD=["textureCube"])),W.compared_mode_depth&&!W.rgba_fallback_shadows?_.GLSL_SMPLR2D_SHDW=["sampler2DShadow"]:_.GLSL_SMPLR2D_SHDW=["sampler2D"];for(var n in _)_[n][0].constructor!=String&&q.warn("Warning! The value of a directive '"+n+"' is not of type string.");return _}function w(e){function t(e,t,a){e instanceof Array?_(e,t,a):e instanceof Object&&e&&r(e,t,a)}function _(e,_,r){for(var a=0;a<e.length;a++)t(e[a],_,r)}function r(e,_,r){_&&_(e);for(var a in e)t(e[a],_,r);r&&r(e)}var a={},n=function(e){if("var"==e.TYPE)a[e.NAME]=e.TOKENS.join("");else if("include"==e.TYPE){var _=x(Z.shaders_path,Z.shaders_include_dir+e.FILE);t(_,n)}};return t(e,n),a}function C(e,t,_){function r(e){for(var t=e.PARTS,_=0;_<t.length;_++){var r=t[_];switch(r.TYPE){case"cond":a(r);break;case"include":i(r);break;case"var":break;case"define":s(r);break;case"error":E(r);break;case"line":break;case"pragma":c(r);break;case"undef":l(r);break;case"warning":T(r);break;case"extension":d(r);break;case"version":u(r);case"#":break;case"node":f(r);break;case"nodes_global":A(Y);break;case"nodes_main":O(Y);break;case"txt":R(r.TOKENS);break;default:Q.panic("Unknown element type: "+r.TYPE)}}}function a(e){for(var t=e.PARTS,_=0;_<t.length;_++){var a=t[_];switch(a.TYPE){case"if":case"elif":if(n(a.EXPRESSION))return void r(a.GROUP);break;case"else":return void r(a.GROUP);case"ifdef":a.NAME in M&&r(a.GROUP);break;case"ifndef":a.NAME in M||r(a.GROUP)}}}function n(e,t){return o(b(e,M,y,!0,t))}function o(e){for(var t=[],_=0;_<e.length;_++)if(e[_]instanceof Object)switch(e[_].TYPE){case"conditional_expr":var r=t.pop(),a=t.pop(),n=t.pop();n?t.push(a):t.push(r);break;case"logical_or_expr":for(var o=t.pop(),i=0;i<e[_].PLACES-1;i++){var s=t.pop();o=o||s}t.push(o);break;case"logical_and_expr":for(var o=t.pop(),i=0;i<e[_].PLACES-1;i++){var s=t.pop();o=o&&s}t.push(o);break;case"logical_bitor_expr":for(var o=t.pop(),i=0;i<e[_].PLACES-1;i++)o|=t.pop();t.push(o);break;case"logical_bitxor_expr":for(var o=t.pop(),i=0;i<e[_].PLACES-1;i++)o^=t.pop();t.push(o);break;case"logical_bitand_expr":for(var o=t.pop(),i=0;i<e[_].PLACES-1;i++)o&=t.pop();t.push(o);break;case"equal_expr":var E=t.pop(),c=t.pop();t.push(c==E);break;case"non_equal_expr":var E=t.pop(),c=t.pop();t.push(c!=E);break;case"le_expr":var E=t.pop(),c=t.pop();t.push(c<=E);break;case"ge_expr":var E=t.pop(),c=t.pop();t.push(c>=E);break;case"l_expr":var E=t.pop(),c=t.pop();t.push(c<E);break;case"g_expr":var E=t.pop(),c=t.pop();t.push(c>E);break;case"left_shift_expr":var c=t.pop(),E=t.pop();t.push(c<<E);break;case"right_shift_expr":var c=t.pop(),E=t.pop();t.push(c>>E);break;case"add_expr":var c=t.pop(),E=t.pop();t.push(c+E);break;case"sub_expr":var c=t.pop(),E=t.pop();t.push(c-E);break;case"mul_expr":var c=t.pop(),E=t.pop();t.push(c*E);break;case"div_expr":var c=t.pop(),E=t.pop();t.push(c/E);break;case"mod_expr":var c=t.pop(),E=t.pop();t.push(c%E);break;case"pre_inc_expr":case"post_inc_expr":var s=t.pop();t.push(++s);break;case"pre_dec_expr":case"post_dec_expr":var s=t.pop();t.push(--s);break;case"positive_expr":var s=t.pop();t.push(+s);break;case"negative_expr":var s=t.pop();t.push(-s);break;case"one_compl_expr":var s=t.pop();t.push(~s);break;case"logic_negative_expr":var s=t.pop();t.push(!s);break;default:Q.panic("Unknown operation type: "+e[_].TYPE)}else{var s=e[_],l=/^[a-zA-Z_$][a-zA-Z_$0-9]*$/;if(l.test(s)){if(t.push(0),0!=s.indexOf("USE_NODE_")){var T=w[w.length-1];T in C||(C[T]=[]),-1==C[T].indexOf(s)&&(C[T].push(s),q.error("Undefined directive '"+s+"' in shader '"+T+"'. Should it be defined with #var/#node_var or #define?"))}}else t.push(parseFloat(e[_]))}if(1==t.length)return t[0];Q.panic("Incorrect expression: "+e.join(" "))}function i(e){var t=e.FILE,_=x(Z.shaders_path,Z.shaders_include_dir+t);w.push("include/"+t),r(_),w.pop()}function s(e){var t=e.NAME,_=e.TOKENS;M[t]=_}function E(e){var t=e.TOKENS;Q.panic("Shader error: #error "+t.join(" "))}function c(e){var t=e.NAME,_=e.TOKENS;L.push("#pragma "+t+" "+_.join(" "))}function l(e){var t=e.NAME;delete M[t]}function T(e){var t=e.TOKENS;q.warn("Shader warning: #warning "+t.join(" "))}function d(e){var t=e.TOKENS,_=b(t,M,y,!1);L.push("#extension "+_.join(" "))}function u(e){var t=e.TOKENS,_=b(t,M,y,!1);L.push("#version "+_.join(" "))}function f(e){D[e.NAME]=e}function P(e,t,_){if("PARTICLE_INFO"==e.id&&t.IS_OPTIONAL){if(1==M.PARTICLE_BATCH){var r=!1;switch(_){case 0:r=j(e.dirs,"PART_INFO_IND")||j(e.dirs,"PART_INFO_AGE")||j(e.dirs,"PART_INFO_LT")||j(e.dirs,"PART_INFO_SIZE");break;case 1:r=j(e.dirs,"PART_INFO_LOC");break;case 2:r=j(e.dirs,"PART_INFO_VEL");break;case 3:r=j(e.dirs,"PART_INFO_A_VEL");break;case 4:r=j(e.dirs,"PART_INFO_IND")}return r}return!1}return!0}function A(t){for(var _=0;_<t.length;_++){var r=t[_],a=D[r.id];if(a)for(var n=0,o=0;o<a.DECLARATIONS.length;o++){var i=a.DECLARATIONS[o];if("node_param"==i.TYPE){if(P(r,i,n)){var s=i.QUALIFIER.join(" ")+" ";"vert"==e?s+=r.vparams[n]:"frag"==e&&(s+=r.params[n],null!==r.param_values[n]&&(s+="="+r.param_values[n])),s+=";",R(g(s))}n++}}}}function S(e,t){for(var _=w[w.length-1],r=p(e),a=0;a<t.dirs.length;a++){var n=t.dirs[a][0];n in r?r[n]=[t.dirs[a][1]]:$&&q.error("Incompatible node directive '"+n+"' was set for node "+t.id+" in shader "+_+".")}for(var o=0,a=0;a<e.DECLARATIONS.length;a++){var i=e.DECLARATIONS[a];if("node_out"==i.TYPE){var s=t.outputs[o],E=F.indexOf(s)>-1|0;r["USE_OUT_"+i.NAME]=[E],o++}}return r}function p(e){for(var t={},_=0;_<e.NODE_VARS.length;_++){var r=e.NODE_VARS[_];t[r.NAME]=[r.TOKENS.join("")]}return t}function O(e){for(var t=0;t<e.length;t++){var _=e[t],r=D[_.id];if(r){var a={};X=0,H=0,z=0;var n=S(r,_);v(_,r.DECLARATIONS,a,n),L.push("{"),m(_,r.STATEMENTS,a,n),L.push("}")}}}function v(t,_,r,a){for(var n=0;n<_.length;n++){var o=_[n];switch(o.TYPE){case"node_in":var i=t.inputs[X];if(null!==t.input_values[X]){if(("MATERIAL_BEGIN"==t.id&&3===X||!a.MATERIAL_EXT&&("MATERIAL_BEGIN"==t.id&&4===X||"MATERIAL_END"==t.id&&3===X||"MATERIAL_END"==t.id&&4===X||"MATERIAL_END"==t.id&&5===X)||"TEXTURE_COLOR"==t.id||"TEXTURE_NORMAL"==t.id)&&o.IS_OPTIONAL){r[o.NAME]=t.input_values[X],X++;continue}var s=o.QUALIFIER.join(" ")+" ";s+=i+"="+t.input_values[X]+";",R(g(s))}r[o.NAME]=i,X++;break;case"node_out":var i=t.outputs[H];if(!o.IS_OPTIONAL||F.indexOf(i)>-1){var s=o.QUALIFIER.join(" ")+" ";s+=i+";",R(g(s)),r[o.NAME]=i}H++;break;case"node_param":if("vert"==e)var i=t.vparams[z];else if("frag"==e)var i=t.params[z];r[o.NAME]=i,z++}}return r}function m(e,t,_,r){for(var a=0;a<t.length;a++){var n=t[a];switch(n.TYPE){case"node_cond":N(e,n.PARTS,_,r);break;case"txt":for(var o=[],i=0;i<n.TOKENS.length;i++){var s=n.TOKENS[i];s in _?o.push(_[s]):o.push(s)}R(o,r)}}}function N(e,t,_,r){for(var a=0;a<t.length;a++){var o=t[a];switch(o.TYPE){case"node_if":case"node_elif":if(n(o.EXPRESSION,r))return void m(e,o.STATEMENTS,_,r);break;case"node_else":return void m(e,o.STATEMENTS,_,r);case"node_ifdef":(o.NAME in M||o.NAME in r)&&m(e,o.STATEMENTS,_,r);break;case"node_ifndef":o.NAME in M||o.NAME in r||m(e,o.STATEMENTS,_,r)}}}function g(e){return e.match(/([\d]+\.[\d]+|[\w]+|[^\s])/g)}function R(t,_){if(t=I(t,e),t.length){var r=b(t,M,y,!1,_);L.push(r.join(" "))}}function I(e,t){if(!W.webgl2&&"frag"==t){var _=e.join(" ");K&&(_.match(/[^;]*;/)?(_=_.replace(/[^;]*;/,""),K=!1):_=""),_=_.replace(/GLSL_OUT [^;]*;/g,""),_.match(/GLSL_OUT(?:$| [^;]*)/)&&(_=_.replace(/GLSL_OUT(?:$| [^;]*)/,""),K=!0),_=_.replace(/ {2,}/g," "),_=_.trim(),e=_?_.split(" "):[]}return e}function b(e,t,_,r,a){var n=[];return h(e,t,_,r,n,a),n}function h(e,t,_,r,a,n){for(var o=0;o<e.length;o++){var i=e[o];if(n&&i in n)var s=n[i];else{if(!(i in t)){a.push(i);continue}var s=t[i]}0==s.length&&r?a.push(0):h(s,t,_,r,a,n)}}var Y=_.node_elements,L=[],M=U(e,_),y={},w=[_[e]],C={},D={},F=[];for(var G in Y)for(var k in Y[G].inputs)F.push(Y[G].inputs[k]);var K=!1;r(t);var B=L.join("\n"),X=0,H=0,z=0;return B}function D(e,t,_,a,n){var o=k(e,a,t,e.VERTEX_SHADER,n),i=k(e,a,_,e.FRAGMENT_SHADER,n),s=e.createProgram();e.attachShader(s,o),e.attachShader(s,i),e.linkProgram(s);for(var E={vshader:o,fshader:i,program:s,attributes:{},uniforms:{},permanent_uniform_setters:c.S(),permanent_sc_uniform_setters:c.S(),permanent_uniform_setters_table:{},need_uniforms_update:!0,no_permanent_uniforms:!1,transient_uniform_setters:c.S(),transient_sc_uniform_setters:c.S(),shaders_info:r(n),shader_id:a,has_discard:F(_),cleanup_gl_data_on_unload:!0},l=e.getProgramParameter(s,e.ACTIVE_ATTRIBUTES),T=0;T<l;T++){var d=e.getActiveAttrib(s,T),u=d.name,f=e.getAttribLocation(s,u);E.attributes[u]=f}for(var P=e.getProgramParameter(s,e.ACTIVE_UNIFORMS),T=0;T<P;T++){var A=e.getActiveUniform(s,T),S=A.name.split("[0]").join(""),p=e.getUniformLocation(s,S);E.uniforms[S]=p}return E}function F(e){return Boolean(e.match(Ae))}function G(e,t,_,r){if(_==Ie.VERTEX_SHADER)var a=r.vert;else var a=r.frag;var n=c._11(t,0),o=Re[n];o?o.count++:(o={count:1,shader_filename:a,hc:n},Re[n]=o)}function k(e,t,_,r,a){ne&&G(t,_,r,a);var n=e.createShader(r);return e.shaderSource(n,_),e.compileShader(n),n}function K(){for(var e in ee)B(ee[e]);for(var t in te)delete te[t];for(var _ in Re)delete Re[_];Oe=null,ve=null,me=null,re={}}function B(e){Ie.deleteProgram(e.program),Ie.deleteShader(e.vshader),Ie.deleteShader(e.fshader),delete ee[e.shader_id]}function X(e,t){switch(!t&&e.length?t=e.length:t||(t=1),t){case 1:return H(e);case 2:return"vec2("+H(e[0])+","+H(e[1])+")";case 3:return"vec3("+H(e[0])+","+H(e[1])+","+H(e[2])+")";case 4:return"vec4("+H(e[0])+","+H(e[1])+","+H(e[2])+","+H(e[3])+")";case 9:return"mat3("+H(e[0])+","+H(e[1])+","+H(e[2])+","+H(e[3])+","+H(e[4])+","+H(e[5])+","+H(e[6])+","+H(e[7])+","+H(e[8])+")";case 16:return"mat4("+H(e[0])+","+H(e[1])+","+H(e[2])+","+H(e[3])+","+H(e[4])+","+H(e[5])+","+H(e[6])+","+H(e[7])+","+H(e[8])+","+H(e[9])+","+H(e[10])+","+H(e[11])+","+H(e[12])+","+H(e[13])+","+H(e[14])+","+H(e[15])+")";default:Q.panic("Wrong glsl value dimension")}}function H(e){return e%1?String(e):String(e)+".0"}function j(e,t){for(var _=0;_<e.length;_++)if(e[_][0]==t)return!0;return!1}var Q=Object(o.a)(e),z=Object(i.a)(e),V=Object(s.a)(e),q=Object(E.a)(e),W=V.defaults,J=V.context_limits,Z=V.paths,$=!1,ee={},te={},_e=null,re={},ae=["anchors.glslf","anchors.glslv","color_id.glslf","color_id.glslv","shadow.glslf","shadow.glslv","error.glslf","error.glslv","grass_map.glslf","grass_map.glslv","halo.glslf","halo.glslv","line.glslf","line.glslv","main.glslf","main.glslv","main_stack.glslf","particle_system.glslf","particle_system_stack.glslf","particle_system.glslv","proc_skybox.glslf","skybox.glslv","lens_flares.glslf","lens_flares.glslv","sky.glslf","sky.glslv","water.glslf","water.glslv","tex_skybox.glslf","debug_view.glslf","debug_view.glslv","node_skybox.glslf","irradiance_skybox.glslf","r_convolution_skybox.glslf","postprocessing/antialiasing.glslf","postprocessing/bloom_combine.glslf","postprocessing/coc.glslf","postprocessing/compositing.glslf","postprocessing/depth_pack.glslf","postprocessing/dof.glslf","postprocessing/glow.glslf","postprocessing/god_rays.glslf","postprocessing/god_rays.glslv","postprocessing/god_rays_combine.glslf","postprocessing/luminance.glslf","postprocessing/luminance_av.glslf","postprocessing/luminance_truncated.glslf","postprocessing/motion_blur.glslf","postprocessing/outline.glslf","postprocessing/performance.glslf","postprocessing/postprocessing.glslf","postprocessing/postprocessing.glslv","postprocessing/smaa.glslf","postprocessing/smaa.glslv","postprocessing/ssao.glslf","postprocessing/ssao_blur.glslf","postprocessing/stereo.glslf","postprocessing/precompute_brdf.glslf","include/blending.glslf","include/caustics.glslf","include/color_util.glslf","include/coverage.glslf","include/depth_fetch.glslf","include/dynamic_grass.glslv","include/environment.glslf","include/fog.glslf","include/fxaa.glslf","include/halo_color.glslf","include/lighting_nodes.glslf","include/math.glslv","include/mirror.glslf","include/nodes.glslf","include/nodes.glslv","include/pack.glslf","include/particles.glslv","include/particles_nodes.glslf","include/particles_nodes.glslv","include/precision_statement.glslf","include/procedural.glslf","include/refraction.glslf","include/scale_texcoord.glslv","include/shadow.glslf","include/shadow.glslv","include/skin.glslv","include/sky_blending.glslf","include/std.glsl","include/to_world.glslv","include/wind_bending.glslv"],ne=!1,oe=0,ie=1,se=2,Ee=4,ce=8,le=16,Te=32;t.VALID=oe,t.INVALID_TEX_IMAGE_UNITS=ie,t.INVALID_F_UNIFORM_VECTORS=se,t.INVALID_V_UNIFORM_VECTORS=Ee,t.INVALID_VERTEX_ATTRIBS=ce,t.INVALID_VARYING_VECTORS=le,t.COMPILATION_ERROR=Te;var de=/(?:^|[^a-zA-Z_])uniform.*?(sampler2D|samplerCube)(?=\s)(.*?\[\s*([0-9]*)\s*\])?/,ue=/(?:^|[^a-zA-Z_])(uniform)(?=\s)\s*(float|vec2|vec3|vec4|ivec2|ivec3|ivec4|bvec2|bvec3|bvec4|mat2|mat3|mat4|sampler2D|samplerCube)\s*(.*?\[\s*([0-9]*)\s*\])?/,fe=/(?:^|[^a-zA-Z_])(in)(?=\s)\s*(float|vec2|vec3|vec4|mat2|mat3|mat4)\s*(.*?\[\s*([0-9]*)\s*\])?/,Pe=/(?:^|[^a-zA-Z_])(varying)(?=\s)\s*(float|vec2|vec3|vec4|mat2|mat3|mat4)\s*(.*?\[\s*([0-9]*)\s*\])?/,Ae=/(?:\W|^)discard(\W|$)/,Se=15,pe=new Int16Array(2),Oe=null,ve=null,me=null,Ne=0,ge=0,Re=[],Ie=null,be=!1;t.setup_context=function(e){Ie=e},t.init_shaders_info=_,t.clone_shaders_info=r,t.set_directive=a,t.get_directive=d,t.set_default_directives=function(e){e.directives=c.O(u(e.vert,e.frag)),a(e,"PRECISION",V.defaults.precision),"highp"==V.defaults.precision?a(e,"EPSILON",X(1e-6)):a(e,"EPSILON",X(1e-4)),a(e,"CONSTANTS_HACK",0|W.shader_constants_hack),a(e,"SRGB",W.srgb_type),a(e,"COMPARED_MODE",0|W.compared_mode_depth)},t.get_vname=function(e){return e.vert},t.get_fname=function(e){return e.frag},t.get_compiled_shader=f,t.load_shaders=function(){if(be=!1,n.a.module_check("shader_texts"))be=!0;else{for(var e=[],t=z.AT_TEXT,_=0;_<ae.length;_++){var r=Object(l.b)(Z.shaders_path+ae[_]);e.push({id:ae[_],type:t,url:r})}var a=function(e,t,_,r){y(t,e)},o=function(){be=!0};e.length?z.enqueue(e,a,o):q.error("Shaders have not been found.")}},t.check_shaders_loaded=function(){return be},t.debug_get_compilation_stats=function(){return Re},t.get_compiled_shaders=function(){return ee},t.cleanup=K,t.cleanup_shader=B,t.debug_shaders_info=function(e){var t=e.directives;q.log("Shader: "+e.vert+" "+e.frag+", "+String(t.length)+" directives: ");for(var _=0;_<t.length;_++)q.log("  "+t[_][0],t[_][1])},t.glsl_value=X,t.check_uniform=function(e,t){return t in e.uniforms},t.reset=function(){Ie=null}}var a=_(0),n=_(32),o=_(5),i=_(43),s=_(4),E=(_(91),_(1)),c=_(2),l=_(48),T={parser:{parse:function(){}}},d=Object(a.a)("__shaders",r);t.a=d},function(e,t,_){"use strict";function r(e,t){function _(e){return navigator.userAgent.indexOf(e)>-1}function r(){return navigator.userAgent.match(/Windows Phone/i)||navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)}function a(){return!window.ActiveXObject&&"ActiveXObject"in window}var c=Object(n.a)(e),l=Object(o.a)(e),T=Object(i.a)(e),d=Object(s.a)(e),u=Object(E.a)(e),f=["R600","RV610","RV630","RV620","RV635","RV670","RS780","RS880","RV770","RV730","RV710","RV740","CEDAR","REDWOOD","JUNIPER","CYPRESS","PALM (Wrestler/Ontario)","SUMO (Llano)","SUMO2 (Llano)","ARUBA (Trinity/Richland)","BARTS","TURKS","CAICOS","CAYMAN"];t.NVIDIA_OLD_GPU_CUBEMAP_MAX_SIZE=256;var P=c.animation,A=c.defaults,S=c.debug_subs,p=c.context,O=c.context_limits,v=c.sfx,m=c.physics,N=c.assets;t.detect_tegra_invalid_enum_issue=function(e){e.getError()==e.INVALID_ENUM&&d.warn("Possible Tegra invalid enum issue detected, ignoring")},t.set_hardware_defaults=function(e,n){var o=function(e){n&&d.warn(e)};O.max_combined_texture_image_units=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),O.max_fragment_uniform_vectors=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),O.max_texture_image_units=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),O.max_varying_vectors=e.getParameter(e.MAX_VARYING_VECTORS),O.max_vertex_attribs=e.getParameter(e.MAX_VERTEX_ATTRIBS),O.max_vertex_texture_image_units=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),O.max_vertex_uniform_vectors=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),O.max_cube_map_texture_size=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),O.max_renderbuffer_size=e.getParameter(e.MAX_RENDERBUFFER_SIZE),O.max_texture_size=e.getParameter(e.MAX_TEXTURE_SIZE),O.max_viewport_dims=e.getParameter(e.MAX_VIEWPORT_DIMS);var i=T.get_renderer_info();if(i){var s=e.getParameter(i.UNMASKED_VENDOR_WEBGL),E=e.getParameter(i.UNMASKED_RENDERER_WEBGL);s.indexOf("Qualcomm")>-1&&E.indexOf("330")>-1&&(_("Chrome")||_("Firefox"))&&(o("Chrome/Firefox and Qualcomm 330 detected, force enable WebGL 1, disable blending cascaded shadow maps."),A.webgl2=!1,A.chrome_csm_blend_hack=!0)}O.depth_bits=A.webgl2?24:16,A.webgl2&&!S.enabled&&(A.compared_mode_depth=!0),A.webgl2?(A.msaa_samples=Math.min(A.msaa_samples,e.getParameter(e.MAX_SAMPLES)),_("Firefox")&&(o("Firefox and WebGL 2 detected, applying framebuffer hack."),A.check_framebuffer_hack=!0),_("Windows")&&_("Chrome")&&(o("Windows, Chrome and WebGL 2 detected, applying multisample hack, disabling MSAA."),A.msaa_samples=1)):A.msaa_samples=1,_("Firefox")&&"NONE"!==A.stereo&&(o("Firefox and Stereo rendering detected, disable texture reusage"),A.firefox_tex_reuse_hack=!0),(A.webgl2&&l.multisample_issue()||_("Firefox"))&&(o("Firefox detected, disabling multisample"),A.msaa_samples=1),_("Mac OS X")&&_("Chrome/60")&&(o("macOS and Chrome 60 detected, disabling multisample"),A.msaa_samples=1),u.set_draw_methods();var g=Boolean(T.get_depth_texture());if(_("Firefox/28.0")&&(_("Linux")||_("Macintosh"))&&(o("Firefox 28 detected, applying depth hack"),g=!1),_("Windows Phone")||(_("iPad")||_("iPhone")?(o("iOS detected, applying alpha hack, applying vertex animation mix normals hack, disable smaa. Disable ssao for performance. Initialize WebAudio context with empty sound. Applying glow hack."),p.alpha||(A.background_color[3]=1),A.ios_copy_tex_hack=!0,A.vert_anim_mix_normals_hack=!0,A.smaa=!1,A.ssao=!1,A.init_wa_context_hack=!0,Boolean(T.get_pvr())&&N.pvr_available&&(A.compress_format="pvr")):_("Mac OS X")&&_("Safari")&&!_("Chrome")&&(o("OS X / Safari detected, force to wait complete loading. Applying playback rate hack for video textures. Applying canvas alpha hack."),A.safari_canvas_alpha_hack=!0,v.audio_loading_hack=!0,v.clamp_playback_rate_hack=!0)),_("Windows")&&(_("Chrome/40")||_("Firefox/33")||_("Firefox/34")||_("Firefox/35")||_("Firefox/36"))&&(o("Windows/Chrome40 or Firefox33-36 detected. Applying clear procedural skydome hack."),A.clear_procedural_sky_hack=!0),_("Chrome")&&!r()&&c.is_built_in_data()&&(o('Chrome (non-mobile) was detected for a single HTML-exported file. "Background Music" speakers were changed to "Background Sound".'),A.chrome_html_bkg_music_hack=!0),_("Mac OS X")&&(A.mac_os_shadow_hack=!0,o("OS X detected, applying shadows hack")),r()&&(o("Mobile detected, applying various hacks for video textures."),A.is_mobile_device=!0,_("iPad")||_("iPhone")||_("Windows Phone")||(o("Mobile (not iOS) detected, disable playback rate for video textures."),v.disable_playback_rate_hack=!0)),_("iPad")&&(o('iPad detected, use "autoplay" hack for video textures.'),A.ipad_video_hack=!0),(_("Firefox/35.0")||_("Firefox/36.0"))&&_("Windows")&&(o("Windows/Firefox 35/36 detected, applying shadows slink hack"),A.shadows_color_slink_hack=!0),(_("iPhone")||a())&&(o("iPhone or IE11 detected. Enable sequential video fallback for video textures."),A.seq_video_fallback=!0),O.max_varying_vectors<10&&(o("Not enough varyings, disable shadows on blend objects"),A.disable_blend_shadows_hack=!0),_("Windows Phone")&&(o("Windows Phone detected. Disable debug view mode, glow materials, ssao, smaa, shadows, reflections, refractions."),A.debug_view=!1,A.glow_materials=!1,A.ssao=!1,A.smaa=!1,A.shadows=!1,A.reflections=!1,A.refractions=!1,A.quality_aa_method=!1),(_("UCBrowser")||_("Chrome")&&_("Nexus")&&A.is_mobile_device)&&(o("Mobile Nexus Chrome or UCBrowser detected, disable workers."),m.use_workers=!1),_("Firefox")&&(o("Firefox detected, disabling workers"),m.use_workers=!1),(a()||_("Edge"))&&(o("IE11 or Edge detected, disabling workers"),m.use_workers=!1),_("Chrome")&&_("Linux")&&(o("Chrome and Linux detected, disabling wasm physics."),m.use_wasm=!1),i){var s=e.getParameter(i.UNMASKED_VENDOR_WEBGL),E=e.getParameter(i.UNMASKED_RENDERER_WEBGL),R=/\b4\d{2}\b/;s.indexOf("Intel")&&(E.indexOf("3000")>-1||E.indexOf("2000")>-1)&&(A.reuse_depth_optimization=!1,o("Intel HD Graphics 2000/3000 detected, disable depth reuse.")),_("Chrome")&&E.indexOf("Mali-T720")>-1&&(o('Chrome and ARM Mali-T720 detected, changing "Alpha Anti-Aliasing" materials to "Alpha Clip".'),A.mali_alpha_antialias_hack=!0),E.indexOf("AMD")>-1&&_("Windows")&&_("Firefox")&&(o("AMD, Windows and Firefox detected, disabling depth textures."),g=!1),s.indexOf("ARM")>-1&&R.test(E)&&(o("ARM Mali-400 series detected, applying lamps, depth and frames blending hacks"),g=!1,P.frames_blending_hack=!0,A.mali4_lamps_hack=!0),s.indexOf("ARM")>-1&&E.indexOf("Mali-T604")>-1&&(o("ARM Mali-T604 detected, disabling shadows."),A.shadows=!1),s.indexOf("ARM")>-1&&E.indexOf("Mali-T760")>-1&&(o("ARM Mali-T760 detected, disabling SSAO."),A.ssao=!1,A.skinning_hack=!0,A.webgl2&&(A.msaa_samples=1,o("ARM Mali-T760 and WebGL 2 detected, switching MSAA samples to 1."))),s.indexOf("ARM")>-1&&E.indexOf("Mali-T720")>-1&&(o("ARM Mali-T720 detected, disabling depth textures."),g=!1,A.webgl2&&(A.msaa_samples=1,o("ARM Mali-T720 and WebGL 2 detected, switching MSAA samples to 1."))),s.indexOf("Qualcomm")>-1&&E.indexOf("Adreno")>-1&&(o("Qualcomm Adreno detected, applying shader constants hack."),A.shader_constants_hack=!0,E.indexOf("420")>-1&&(o("Qualcomm Adreno420 detected, setting max cubemap size to 12288x8192, setting max texture size to 4096x4096."),O.max_texture_size=Math.min(O.max_texture_size,4096),O.max_cube_map_texture_size=Math.min(O.max_cube_map_texture_size,4096)),_("Chrome")&&(E.match(/4../)||E.match(/5../))&&(o("Qualcomm Adreno 4xx or 5xx detected, switch MSAA samples to 1."),A.msaa_samples=1)),s.indexOf("NVIDIA")>-1&&E.indexOf("Tegra 3")>-1&&(o("NVIDIA Tegra 3 detected, force low quality for B4W_LEVELS_OF_QUALITY nodes."),A.force_low_quality_nodes=!0),_("Windows")&&_("Chrome")&&!_("Edge")&&(E.match(/NVIDIA GeForce 8..0/)||E.match(/NVIDIA GeForce 9..0/)||E.match(/NVIDIA GeForce( (G|GT|GTS|GTX))? 2../))&&(o("Chrome / Windows / NVIDIA GeForce 8/9/200 series detected, setting max cubemap size to 768x512, use canvas for resizing."),O.max_cube_map_texture_size=t.NVIDIA_OLD_GPU_CUBEMAP_MAX_SIZE,A.resize_cubemap_canvas_hack=!0),E.indexOf("PowerVR")>-1&&E.indexOf("SGX")>-1&&(o("PowerVR SGX series detected, use canvas for resizing. Disable shadows. Apply skinning hack, disable skin blending between frames."),A.resize_cubemap_canvas_hack=!0,A.skinning_hack=!0,A.shadows=!1),_("Windows")&&E.indexOf("Direct3D9")>-1&&(o("DirectX 9.0 detected, using canvas for resizing textures/cubemap textures."),A.d3d9_canvas_resizing_hack=!0,A.resize_cubemap_canvas_hack=!0,A.resize_texture_canvas_hack=!0);for(var I="",b=0;b<f.length;b++)if(E.indexOf(f[b])>-1){I=f[b];break}I&&(o("Architecture "+I+" detected. Blending between frames and shadows on blend objects will be disabled."),A.skinning_hack=!0,A.disable_blend_shadows_hack=!0)}if(0==O.max_vertex_texture_image_units&&(o("Vertex textures are not allowed. Disabling vertex textures"),A.allow_vertex_textures=!1),g||(A.foam=!1,A.dynamic_grass=!1,A.water_dynamic=!1,A.shore_smoothing=!1,A.shore_distance=!1,A.smaa=!1,A.ssao=!1,A.rgba_fallback_shadows=!0),A.use_compression=Boolean(T.get_s3tc())||"pvr"==A.compress_format,A.depth_tex_available=g,e.getShaderPrecisionFormat)var h=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT);e.getShaderPrecisionFormat&&0!==h.precision||(A.precision="mediump"),(a()&&_("Touch")||_("Edge"))&&(o("IE11 and touchscreen or Edge detected. Behaviour of the mouse move sensor will be changed."),A.ie11_edge_touchscreen_hack=!0),(a()||_("Edge"))&&(A.ie_edge_anchors_floor_hack=!0,A.ie11_edge_mouseoffset_hack=!0,A.resize_cubemap_canvas_hack=!0),r()&&_("Firefox")&&(d.log("Mobile firefox detected. Applying autoplay media hack.Setting max cubemap size to 12288x8192, setting max texture size to 4096x4096."),A.mobile_firefox_media_hack=!0,O.max_texture_size=Math.min(O.max_texture_size,4096),O.max_cube_map_texture_size=Math.min(O.max_cube_map_texture_size,4096));var Y=Boolean(T.get_aniso());A.anisotropic_available=Y;var L=Boolean(T.get_texture_lod());A.texture_lod_available=L;var M=Boolean(T.get_texture_float());A.tex_float_available=M;var x=Boolean(T.get_texture_half_float());A.tex_hfloat_available=x;var y=Boolean(T.get_texture_float_linear());A.tex_float_lin_available=y;var U=Boolean(T.get_texture_half_float_linear());A.tex_hfloat_lin_available=U;var w=Boolean(T.get_color_buffer_float());A.cbuffer_float_available=w;var C=Boolean(T.get_color_buffer_half_float());A.cbuffer_hfloat_available=C},t.check_user_agent=_,t.detect_mobile=r,t.apply_context_alpha_hack=function(){_("Firefox/35.0")&&_("Windows")&&(d.warn("Windows/Firefox 35 detected, forcing context's alpha"),c.context.alpha=!0)},t.is_ie11=a}var a=_(0),n=_(4),o=_(44),i=_(28),s=_(1),E=_(22),c=Object(a.a)("__compat",r);t.a=c},function(e,t,_){"use strict";function r(e,t,_){var r=!(!t||!t.length),a=e.length/3;_=_||T(a);for(var n=0;n<a;++n){var i=x;if(i[0]=e[3*n],i[1]=e[3*n+1],i[2]=e[3*n+2],g.normalize(i,i),r){var c=C;c[0]=t[h*n],c[1]=t[h*n+1],c[2]=t[h*n+2],c[3]=t[h*n+3],g.normalize(c,c);var l=g.cross(c,i,y);g.normalize(l,l);var d=m.rotationTo(I.f,l,L),u=g.transformQuat(I.e,d,U),f=m.rotationTo(u,i,M),P=m.multiply(f,d,L);m.normalize(P,P);var A=Y,S=g.cross(i,l,U);(Math.abs(S[0]-c[0])>b||Math.abs(S[1]-c[1])>b||Math.abs(S[2]-c[2])>b)&&(A=Math.acos(g.dot(i,c))/Math.PI),o(_,P,n),s(_,I._49(c[3]),n),E(_,A,n)}else{var P=m.rotationTo(I.e,i,L);o(_,P,n)}}return _}function a(e,t,_,r){if(0!==_){t=4*t||0,_=_||e.length;for(var a=0,n=0;a<4*_;a+=4,n+=4)r[n]=e[t+a],r[n+1]=e[t+a+1],r[n+2]=e[t+a+2],r[n+3]=e[t+a+3]}}function n(e,t,_){t=t||0;var r=u(e,t,_);return m.normalize(r,_),_}function o(e,t,_){_=_||0;var r=u(e,_,w),a=m.length(r),n=I._49(r[3])*I._49(t[3])||1;return m.scale(t,n*a,r),Math.abs(r[3])<b&&(r[3]>0?r[3]=b:r[3]=-b),f(e,r,_),e}function i(e,t){return t=t||0,I._49(e[4*t+3])}function s(e,t,_){_=_||0;var r=u(e,_,w);return I._49(r[3])*t<0&&m.scale(r,-1,r),f(e,r,_),e}function E(e,t,_){_=_||0;var r=u(e,_,w);return m.normalize(r,r),m.scale(r,t,r),Math.abs(r[3])<b&&(r[3]>0?r[3]+=b:r[3]-=b),f(e,r,_),e}function c(e,t){t=t||0;var _=u(e,t,w);return m.length(_)}function l(e,t,_){var r=n(e,t,L);return g.transformQuat(I.e,r,_)}function T(e){e=0!==e?e||1:0;for(var t=new Float32Array(4*e),_=0;_<e;_++)t[4*_+3]=Y;return t}function d(e){for(var t=0;t<e.length;t+=4)e[t]=0,e[t+1]=0,e[t+2]=0,e[t+3]=Y;return e}function u(e,t,_){return _[0]=e[4*t],_[1]=e[4*t+1],_[2]=e[4*t+2],_[3]=e[4*t+3],_}function f(e,t,_){return e[4*_]=t[0],e[4*_+1]=t[1],e[4*_+2]=t[2],e[4*_+3]=t[3],e}function P(e){return e.length/4}function A(e,t,_){for(var r=P(e),a=0;a<r;a++){var l=i(e,a),T=c(e,a),d=n(e,a,M);o(_,m.multiply(t,d,M),a),E(_,T,a),s(_,l,a)}}function S(e,t,_){return A(e,N.f(t,L),_)}function p(e,t,_,r){var a=i(t,0),l=n(e,0,L),T=n(t,0,M),d=c(e),u=c(t),f=m.slerp(l,T,_,M);return m.normalize(f,f),o(r,f,0),E(r,_*(d-u)+u),s(r,a,0),r}function O(e,t,_){var r=i(t,0),a=n(e,0,L),l=n(t,0,M),T=c(e,0),d=c(t,0);return o(_,m.multiply(a,l,L),0),E(_,T+d-Y),s(_,r,0),_}function v(e,t,_){var r=i(t,0),a=n(e,0,L),l=n(t,0,M),T=c(e),d=c(t),u=m.invert(l,M);return o(_,m.multiply(a,u,L),0),E(_,T-d+Y),s(_,r,0),_}_.d(t,"a",function(){return h}),t.d=r,t.b=a,t.h=n,t.o=o,t.g=l,t.c=T,t.i=d,t.e=u,t.n=f,t.f=P,t.j=A,t.m=S,t.p=p,t.k=O,t.l=v;var m=_(9),N=_(6),g=_(3),R=_(7),I=_(2),b=31e-6,h=4,Y=.5,L=m.create(),M=m.create(),x=g.create(),y=g.create(),U=g.create(),w=R.create(),C=R.create()},function(e,t,_){"use strict";function r(e,t){function _(){return{type:Je,num_pierced:0,pierce_step:0,params:null,bones:null,bflags:null,channels_mask:new Int8Array(8)}}function r(e,t){var _=e.anim_slots[t];_&&_.finish_callback&&_.exec_finish_callback&&(_.exec_finish_callback=!1,_.finish_callback(e,t))}function a(e,t,_){var r=e.anim_slots[_];r.type=et;var a=t.frame_start,n=t.frame_end-a+1;r.start=a,r.length=n,r.current_frame_float=a,r.animation_name=t.name;for(var o=0,i=0;i<e.vertex_anim.length;i++){var s=e.vertex_anim[i];if(s==t)break;o+=s.frame_end-s.frame_start+1}r.va_frame_offset=o}function m(e,t,_){t.type=_t,t.animation_name=_.name,t.start=_.frame_start,t.length=_.frame_end-t.start,_.cyclic||(t.length+=_.lifetime_frames)}function N(e,t,_){for(var r=e.scenes_data,a=0;a<r.length;a++)for(var n=r[a].batches,o=0;o<n.length;o++){var i=n[o].particles_data;if(i&&i.name==t){var s=e.anim_slots[_];m(n[o],s,i)}}}function g(e,t){var _={type:null,animation_name:null,action_frame_range:null,action_step:0,action_bflags:null,channels_mask:new Int8Array(8),quats:null,trans:null,bone_space_quats:null,bone_space_trans:null,skinning_data:[],play:!1,behavior:ct,current_frame_float:0,start:0,length:0,trans_smooth_period:0,quat_smooth_period:0,exec_finish_callback:!1,va_frame_offset:null,speed:1,volume:null,pitch:null,color:null,energy:null,zenith_color:null,horizon_color:null,fog_intensity:null,fog_depth:null,fog_start:null,fog_height:null,fog_color:null,nodemat_values:[],node_value_inds:[],nodemat_rgbs:[],node_rgb_inds:[],node_batches:null};if(!e.anim_slots.length)for(var r=0;r<8;r++)e.anim_slots.push(null);e.anim_slots[t]=_}function R(e){-1==yt.indexOf(e)&&yt.push(e)}function I(e){return e.replace(/_B4W_BAKED$/,"")}function b(e){for(var t=[],_=0;_<Ut.length;_++){var r=Ut[_],a=r._render;a.type==$e?t.push(r):r._render.type!=rt||"MESH"!=e.type&&"WORLD"!=e.type?a.type==Ze&&"ARMATURE"==e.type?t.push(r):a.type==tt&&"SPEAKER"==e.type?t.push(r):a.type==nt&&"WORLD"==e.type&&t.push(r):t.push(r)}return t}function h(e){return e.def_action_slots.slice()}function Y(e){var t=[],_=e.node_tree;return _&&M(_,t,[e.name]),t}function L(e,t){return{name_list:e,action:t}}function M(e,t,_){if(e.animation_data){var r=e.animation_data,a=r.action;a&&a._render.type==rt&&t.push(L(_,a))}for(var n=e.nodes,o=0;o<n.length;o++){var i=n[o];if(i.node_group){var s=i.node_group.node_tree;if(s){var E=_.slice();E.push(i.name),M(s,t,E)}}}}function x(e){return!(!Ge.is_mesh(e)||!e.render.vertex_anim)}function y(e,t,_){var r=e.anim_slots;if(_==st)for(var a=0;a<8;a++){var n=r[a];n&&(n.current_frame_float=t,C(e,0,a,!0))}else{var n=r[_];n&&(n.current_frame_float=t,C(e,0,_,!0))}}function U(e,t){function _(_){y(e,_.start,t)}t=t||ot,w(e.anim_slots,t,_)}function w(e,t,_){if(t==st)for(var r=0;r<8;r++){var a=e[r];a&&_(a)}else{var a=e[t];a&&_(a)}}function C(e,t,_,a){$(e,t,_,a),r(e,_),e.render.anim_mixing&&(oe(e,t),re(e,t))}function D(e){return Boolean(e.anim_slots.length)}function F(e,t,_,r,a){if(_)var n=O._18("uuid",_,Ut);else var n=O._18("name",r,Ut)||O._18("name",r+"_B4W_BAKED",Ut);if(n){g(e,a),R(e);var o=n.frame_range;if(o[0]>o[1])return Be.warn('Incompatible action "'+n.name+'" has been applied to object "'+e.name+'"'),!1;var i=n._render;switch(i.type){case Ze:if(Ge.is_armature(e)){var s=k(e,t,n);s||(s=ie(n,e.render.bone_pointers),B(e,t,n,s)),X(e,a,n,s)}break;case $e:var E=i.params.tsr;if(!E)return Be.warn('Incompatible action "'+n.name+'" has been applied to object "'+e.name+'"'),!1;var c=k(e,t,n);c||(c=Z(e,n,E),B(e,t,n,c))}}}function G(e,t,_,r){var a=_.frame_range;if(a[0]>a[1])return Be.warn('Incompatible action "'+_.name+'" has been applied to object "'+e.name+'"'),!1;var n=_._render,o=e.anim_slots[r];switch(o.animation_name=_.name,o.action_frame_range=a,o.action_step=n.pierce_step,o.action_bflags=n.bflags,o.channels_mask.set(n.channels_mask),o.start=a[0],o.length=a[1]-a[0],o.current_frame_float=a[0],n.type){case Ze:if(Ge.is_armature(e)){o.type=Ze;var i=k(e,t,_);i||(i=ie(_,e.render.bone_pointers),B(e,t,_,i)),o.trans=i.trans,o.quats=i.quats,o.bone_space_quats=i.bone_space_quats,o.bone_space_trans=i.bone_space_trans,X(e,r,_,i)}break;case tt:Ge.is_speaker(e)&&(o.volume=n.params.volume||null,o.pitch=n.params.pitch||null,o.type=tt);break;case at:Ge.is_lamp(e)&&(o.color=n.params.color||null,o.energy=n.params.energy||null,o.type=at);break;case rt:if("MESH"==e.type||"WORLD"==e.type){o.type=rt;var s=Ge.is_world(e),E=q(e,t,_,s);o.node_value_inds=E.val_inds,o.nodemat_values=E.values,o.node_rgb_inds=E.rgb_inds,o.nodemat_rgbs=E.rgbs,o.node_batches=E.node_batches}break;case $e:var c=n.params.tsr;if(!c)return Be.warn('Incompatible action "'+_.name+'" has been applied to object "'+e.name+'"'),!1;o.type=$e;var l=k(e,t,_);if(l||(l=Z(e,_,c),B(e,t,_,l)),o.trans=l.trans,o.quats=l.quats,ke.obj_has_particles(e)){var T=o.trans[0],d=o.quats[0];ke.update_start_pos(e,T,d)}break;case nt:Ge.is_world(e)&&(o.energy=n.params["light_settings.environment_energy"]||null,o.horizon_color=n.params.horizon_color||null,o.zenith_color=n.params.zenith_color||null,o.fog_intensity=n.params["mist_settings.intensity"]||null,o.fog_depth=n.params["mist_settings.depth"]||null,o.fog_start=n.params["mist_settings.start"]||null,o.fog_height=n.params["mist_settings.height"]||null,o.fog_color=n.params.b4w_fog_color||null,o.type=nt)}return Ge.is_armature(e)&&n.type!=Ze&&z(e,r),!0}function k(e,t,_){var r=e.action_anim_cache;if(t)var a=t.join("%join%");else var a=null;for(var n=0;n<r.length;n+=3)if(_==r[n]&&a==r[n+1])return r[n+2];return null}function K(e,t){for(var _=e.action_anim_cache,r=[],a=0;a<_.length;a+=3)(_[a]._render.type!=rt||null!==_[a+1]&&_[a+1].split("%join%")[0]!=t)&&r.push(_[a],_[a+1],_[a+2]);e.action_anim_cache=r}function B(e,t,_,r){var a=e.action_anim_cache;if(t)var n=t.join("%join%");else var n=null;a.push(_,n,r)}function X(e,t,_,r){var a=e.render,n=a.skinned_renders,o=e.anim_slots[t],i=o.skinning_data,s=H(a,_);if(s)o.skinning_data=s;else{for(var E=0;E<n.length;E++){var c=n[E],l=Ee(r,c.bone_skinning_info);i.push(l)}j(a,_,i)}if(a.anim_mixing){var T=a.blend_skel_slots;if(t>T[1]){var d=T[1];T[1]=t,T[0]=d}else t>T[0]&&t<T[1]&&(T[0]=t);Q(e)}}function H(e,t){for(var _=e.skinning_data_cache,r=0;r<_.length;r+=2)if(t==_[r])return _[r+1];return null}function j(e,t,_){e.skinning_data_cache.push(t,_)}function Q(e){var t=e.render.blend_skel_slots;if(-1!=t[0]&&-1!=t[1]){var _=t[1],r=e.anim_slots,a=r[_],n=a.current_frame_float,o=Math.floor(n),i=n-o,s=t[0],E=r[s];n=E.current_frame_float,o=Math.floor(n),E.current_frame_float=o+i}}function z(e,t){var _=e.render.blend_skel_slots,r=_[1];if(_[0]=-1,_[1]=-1,t!=st)for(var a=e.anim_slots,n=r;n>=ot;n--){var o=a[n];if(o&&o.type==Ze){if(n>_[1]){_[1]=n;continue}n>_[0]&&(_[1]=n);break}}}function V(e,t){var _=e.match(/"(.*?)"/)[1];if(t&&t.length>1){for(var r=t[1],a=2;a<t.length;a++)r=r+"%join%"+t[a];r+="%join%"+_}else var r=_;return r}function q(e,t,_,r){var a=[],n=[],o=[],i=[],s=[],E=_._render,c=t?t[0]:null;for(var l in E.params)for(var T=V(l,t),d=0;d<e.scenes_data.length;d++)for(var u=e.scenes_data[d].batches,f=0;f<u.length;f++){var P=u[f];if(r||!c||-1!=P.material_names.indexOf(c)){var A=P.node_value_inds,S=P.node_rgb_inds,p=J(l,T,E,n,a,A),O=W(l,T,E,i,o,S);(p||O)&&s.push(P)}}return{val_inds:a,values:n,rgb_inds:o,rgbs:i,node_batches:s}}function W(e,t,_,r,a,n){if(!n)return!1;for(var o=!1,i=0;i<n.length;i+=2){if(t==n[i]){var s=n[i+1];a.push(s),r.push(new Float32Array(_.params[e])),o=!0}}return o}function J(e,t,_,r,a,n){if(!n)return!1;for(var o=!1,i=0;i<n.length;i+=3){t==n[i]&&(a.push(4*n[i+1]+n[i+2]),r.push(new Float32Array(_.params[e])),o=!0)}return o}function Z(e,t,_){for(var r=t._render,a=r.num_pierced,n=[],o=[],i=0;i<a;i++)n.push(_.subarray(8*i,8*i+4)),o.push(_.subarray(8*i+4,8*i+8));return{trans:n,quats:o}}function $(e,t,_,r){var a=e.anim_slots[_];if(a&&null!=a.type&&(a.play||r)){var n=e.render,o=a.current_frame_float,i=a.start,E=a.length;o+=a.speed*t*Qe.get_framerate();var c=a.type,l=a.speed;if(l>=0&&o>=i+E||l<0&&o<i)switch(r||(a.exec_finish_callback=!0),a.behavior){case Et:o=l>=0?(o-i)%E+i:i+E-We;break;case ct:o=l>=0?i:i+E-We,a.play=!1;break;case lt:o=l>=0?i+E-We:i,a.play=!1}switch(a.current_frame_float=o,c){case Ze:if(!n.anim_mixing){var T=ee(a),d=T[0],u=T[1],f=T[2];n.quats_before=a.quats[d],n.quats_after=a.quats[u],n.trans_before=a.trans[d],n.trans_after=a.trans[u],n.frame_factor=f,_e(n,a,d,u),ze.update_transform(e)}break;case $e:var T=ee(a),P=Re(a,0,T,vt),A=Ie(a,0,T,bt),S=be(a,0,T);if(e.parent&&e.pinverse_tsr){var m=Mt;p.s(P,S,A,m),p.p(e.pinverse_tsr,m,m),p.i(m,P),p.f(m,A),S=p.h(m)}if(a.trans_smooth_period){var N=mt;ze.get_translation(e,N),O._53(P,N,t,a.trans_smooth_period,P)}if(a.quat_smooth_period){var g=ht;ze.get_rotation(e,g),O._51(A,g,t,a.quat_smooth_period,A)}var R=a.channels_mask;R[0]&&ze.set_translation_rel(e,P),R[1]&&ze.set_rotation_rel(e,A),R[2]&&ze.set_scale_rel(e,S),ze.update_transform(e),Ke.sync_transform(e);break;case et:var T=te(a);n.va_frame=T[0],n.va_frame_factor=T[2];break;case tt:var T=ee(a),I=T[0],b=T[1],h=T[2];if(a.volume){var Y=(1-h)*a.volume[I]+h*a.volume[b];He.set_volume(e,Y)}if(a.pitch){var L=(1-h)*a.pitch[I]+h*a.pitch[b];He.playrate(e,L)}break;case _t:if(a.behavior==Et)var M=(o-i)/Qe.get_framerate();else var M=o/Qe.get_framerate();ke.set_time(e,a.animation_name,M);break;case rt:for(var T=ee(a),I=T[0],b=T[1],h=T[2],x=a.nodemat_values,y=a.node_value_inds,U=a.nodemat_rgbs,w=a.node_rgb_inds,C=a.node_batches,D=0;D<y.length;D++)for(var F=x[D],G=y[D],k=(1-h)*F[I]+h*F[b],K=0;K<C.length;K++)C[K].node_values[G]=k;for(var D=0;D<w.length;D++)for(var B=U[D],G=w[D],X=B.subarray(3*I,3*I+3),H=B.subarray(3*b,3*b+3),j=v.lerp(X,H,h,vt),K=0;K<C.length;K++)C[K].node_rgbs[3*G]=j[0],C[K].node_rgbs[3*G+1]=j[1],C[K].node_rgbs[3*G+2]=j[2];Ge.is_world(e)&&Xe.update_sky_texture(e);break;case at:var T=ee(a),I=T[0],b=T[1],h=T[2],R=a.channels_mask,Q=a.energy;if(Q&&R[0]){var z=(1-h)*Q[I]+h*Q[b];s.d(e.light,z)}var V=a.color;V&&R[1]&&(vt[0]=(1-h)*V[3*I]+h*V[3*b],vt[1]=(1-h)*V[3*I+1]+h*V[3*b+1],vt[2]=(1-h)*V[3*I+2]+h*V[3*b+2],s.b(e.light,vt));for(var q=e.scenes_data,D=0;D<q.length;D++)Xe.update_lamp_scene_color_intensity(e,q[D].scene);break;case nt:var T=ee(a),I=T[0],b=T[1],h=T[2],R=a.channels_mask,q=e.scenes_data,W=Xe.get_subs(q[0].scene,je.MAIN_OPAQUE),Q=a.energy;if(R[Tt])var J=(1-h)*Q[I]+h*Q[b];else var J=W.energy;var Z=a.horizon_color;if(R[dt]){vt[0]=(1-h)*Z[3*I]+h*Z[3*b],vt[1]=(1-h)*Z[3*I+1]+h*Z[3*b+1],vt[2]=(1-h)*Z[3*I+2]+h*Z[3*b+2];var $=vt}else var $=W.horizon_color;var re=a.zenith_color;if(R[ut]){mt[0]=(1-h)*re[3*I]+h*re[3*b],mt[1]=(1-h)*re[3*I+1]+h*re[3*b+1],mt[2]=(1-h)*re[3*I+2]+h*re[3*b+2];var ae=mt}else var ae=W.zenith_color;var ne=a.fog_intensity;if(R[ft])var oe=(1-h)*ne[I]+h*ne[b];var ie=a.fog_depth;if(R[Pt])var se=(1-h)*ie[I]+h*ie[b];var Ee=a.fog_start;if(R[At])var ce=(1-h)*Ee[I]+h*Ee[b];var le=a.fog_height;if(R[St])var Te=(1-h)*le[I]+h*le[b];var de=a.fog_color;if(R[pt]){bt[0]=(1-h)*de[3*I]+h*de[3*b],bt[1]=(1-h)*de[3*I+1]+h*de[3*b+1],bt[2]=(1-h)*de[3*I+2]+h*de[3*b+2];var ue=bt}for(var D=0;D<q.length;D++){var fe=e.scenes_data[D].scene;(R[Tt]||R[dt]||R[ut])&&Xe.set_environment_colors(fe,J,$,ae),R[ft]&&Xe.set_fog_intensity(fe,oe),R[Pt]&&Xe.set_fog_depth(fe,se),R[At]&&Xe.set_fog_start(fe,ce),R[St]&&Xe.set_fog_height(fe,Te),R[pt]&&Xe.set_fog_color_density(fe,ue)}break;default:De.panic("Unknown animation type:"+c)}}}function ee(e){var t=e.current_frame_float,_=e.action_frame_range[0],r=e.action_frame_range[1],a=r-_,n=t-_;n<0&&(n=0),n>=a&&(n=a),n/=e.action_step;var o=Math.floor(n);if(e.action_bflags[o])var i=n-o;else var i=0;var s=Math.ceil(o+i);return Ot[0]=o,Ot[1]=s,Ot[2]=i,Ot}function te(e){var t=e.current_frame_float,_=t-e.start;_<0&&(_=0),_>=e.length&&(_=e.length);var r=Math.floor(_),a=r+1,n=_-r;e.behavior!=Et&&a==e.length&&(r-=1,a=r,n=1);var o=e.va_frame_offset;return Ot[0]=r+o,Ot[1]=a+o,Ot[2]=n,Ot}function _e(e,t,_,r){for(var a=e.skinned_renders,n=t.skinning_data,o=0;o<a.length;o++){var i=a[o],s=n[o];i.quats_before=s.quats[_],i.quats_after=s.quats[r],i.trans_before=s.trans[_],i.trans_after=s.trans[r],i.frame_factor=e.frame_factor}}function re(e,t){var _=e.render,r=_.anim_mix_factor,a=_.blend_skel_slots,o=a[0],i=a[1];if(-1!=i){if(-1!=o){var s=e.anim_slots[o];if(s.play||0==t||_.mix_with_current){var E=ee(s),c=E[0],l=E[1];_.frame_factor=E[2];var T=s.quats[c],d=s.quats[l],u=s.trans[c],f=s.trans[l]}else r=1}else r=1;var P=e.anim_slots[i];if(P.play||0==t||_.mix_with_current){var A=ee(P),S=A[0],p=A[1];_.frame_factor=A[2]}else{if(-1==o||!s.play)return;r=0}var O=P.quats[S],v=P.quats[p],m=P.trans[S],N=P.trans[p];if(1!=r||_.mix_with_current)if(0!=r||_.mix_with_current){var g=_.bone_pointers;if(_.mix_with_current&&!_.trans_curr&&!_.quats_curr){_.trans_curr=new Float32Array(_.trans_before.length),_.quats_curr=new Float32Array(_.quats_before.length);for(var R in g){var I=g[R];I.parent_bone_ptr||ne(_,I)}}for(var R in g){var I=g[R];I.parent_bone_ptr||ae(_,I,s,P,c,l,S,p)}}else _.quats_before.set(T),_.quats_after.set(d),_.trans_before.set(u),_.trans_after.set(f);else _.quats_before.set(O),_.quats_after.set(v),_.trans_before.set(m),_.trans_after.set(N);ze.update_transform(e),n.f(e)}}function ae(e,t,_,r,a,n,o,i){var s=t.parent_bone_ptr,E=e.anim_mix_factor,c=bt,l=ht,T=Nt,u=gt,f=Yt,P=Lt,A=Rt,S=It,v=4*t.bone_index,m=r.bone_space_quats[o],N=r.bone_space_trans[o],g=r.bone_space_quats[i],R=r.bone_space_trans[i];if(!e.mix_with_current)var I=_.bone_space_quats[a],b=_.bone_space_trans[a],h=_.bone_space_quats[n],Y=_.bone_space_trans[n];for(var L=0;L<4;L++)l[L]=m[v+L],u[L]=N[v+L],P[L]=g[v+L],S[L]=R[v+L],e.mix_with_current?(c[L]=e.quats_curr[v+L],T[L]=e.trans_curr[v+L],f[L]=e.quats_curr[v+L],A[L]=e.trans_curr[v+L]):(c[L]=I[v+L],T[L]=b[v+L],f[L]=h[v+L],A[L]=Y[v+L]);d.slerp(c,l,E,c),O.G(T,u,E,T),p.u(T,Mt),p.q(c,Mt),s&&p.p(s.tsr_local_pose_b,Mt,Mt),p.a(Mt,t.tsr_local_pose_b),p.p(Mt,t.tsr_local_rest_i,Mt),p.k(Mt,T),p.f(Mt,c),d.slerp(f,P,E,f),O.G(A,S,E,A),p.u(A,Mt),p.q(f,Mt),s&&p.p(s.tsr_local_pose_a,Mt,Mt),p.a(Mt,t.tsr_local_pose_a),p.p(Mt,t.tsr_local_rest_i,Mt),p.k(Mt,A),p.f(Mt,f);for(var L=0;L<4;L++)e.quats_before[v+L]=c[L],e.trans_before[v+L]=T[L],e.quats_after[v+L]=f[L],e.trans_after[v+L]=A[L];for(var M=t.descend_bones_ptrs,L=0;L<M.length;L++){ae(e,M[L],_,r,a,n,o,i)}}function ne(e,t){for(var _=4*t.bone_index,r=t.parent_bone_ptr,a=e.anim_mix_factor,n=Nt,o=bt,i=gt,s=ht,E=0;E<4;E++)n[E]=e.trans_before[_+E],o[E]=e.quats_before[_+E],i[E]=e.trans_after[_+E],s[E]=e.quats_after[_+E];p.u(n,Mt),p.q(o,Mt),p.p(Mt,t.tsr_local_rest,Mt),p.a(Mt,t.tsr_local_pose_b),r&&(p.o(r.tsr_local_pose_b,xt),p.p(xt,Mt,Mt)),p.k(Mt,n),p.f(Mt,o),p.u(i,Mt),p.q(s,Mt),p.p(Mt,t.tsr_local_rest,Mt),p.a(Mt,t.tsr_local_pose_a),r&&(p.o(r.tsr_local_pose_a,xt),p.p(xt,Mt,Mt)),p.k(Mt,i),p.f(Mt,s),d.slerp(o,s,a,o),O.G(n,i,a,n);for(var E=0;E<4;E++)e.quats_curr[_+E]=o[E],e.trans_curr[_+E]=n[E];for(var c=t.descend_bones_ptrs,E=0;E<c.length;E++){ne(e,c[E])}}function oe(e,t){var _=e.render,r=_.anim_mix_factor,a=_.anim_mix_factor_change_speed;if(0!=a){!_.mix_with_current||_.trans_curr||_.quats_curr||(r=_.anim_mix_factor=0);var n=_.anim_destination_mix_factor,o=n-r,i=a*t;O._49(o)==O._49(a)&&Math.abs(i)<Math.abs(o)?_.anim_mix_factor+=i:(_.anim_mix_factor=_.anim_destination_mix_factor,_.anim_mix_factor_change_speed=0,_.anim_mix_cb&&(_.anim_mix_cb(),_.anim_mix_cb=null),_.mix_with_current&&(_.trans_curr=null,_.quats_curr=null,_.mix_with_current=!1))}}function ie(e,t){for(var _=[],r=[],a=[],n=[],o=e._render.num_pierced,i=0;i<o;i++){for(var s in t){var E=t[s],c=E.tsr_basis,l=e._render.bones[s];l?p.a(l.subarray(8*i,8*i+8),c):p.l(c),E.tsr_channel_cache_valid=!1}var T=se(t);_.push(T.trans),r.push(T.quats),a.push(T.bone_space_trans),n.push(T.bone_space_quats)}return{trans:_,quats:r,bone_space_trans:a,bone_space_quats:n}}function se(e){var t=[],_=[],r=[],a=[],n=new Float32Array(4),o=new Float32Array(4);for(var i in e){var s=e[i];le(s,n,o);var E=s.bone_index;p.p(s.tsr_bone_rest,s.tsr_basis,Mt);for(var c=0;c<4;c++){var l=4*E+c;t[l]=n[c],_[l]=o[c],r[l]=Mt[c],a[l]=Mt[c+4]}}return{trans:t,quats:_,bone_space_trans:r,bone_space_quats:a}}function Ee(e,t){for(var _=[],r=[],a=e.trans,n=e.quats,o=0;o<a.length;o++){var i=ce(a[o],n[o],t);_.push(i.trans),r.push(i.quats)}return{trans:_,quats:r}}function ce(e,t,_){var r=[],a=[];for(var n in _)for(var o=_[n],i=o.bone_index,s=o.deform_bone_index,E=0;E<4;E++){var c=4*s+E,l=4*i+E;r[c]=e[l],a[c]=t[l]}return r=new Float32Array(r),a=new Float32Array(a),{trans:r,quats:a}}function le(e,t,_){var r=e.chain,a=r[r.length-1],n=a.tsr_channel_cache;a.tsr_channel_cache_valid||p.l(n);for(var o=r.length-1;o>=0;o--){var i=r[o],s=i.tsr_channel_cache;if(i.tsr_channel_cache_valid)n=s;else{var E=i.tsr_local_rest,c=i.tsr_basis;p.o(E,Mt),p.p(c,Mt,Mt),p.p(E,Mt,Mt),p.p(n,Mt,s),n=s,i.tsr_channel_cache_valid=!0}}var l=i.tsr_channel_cache;t[0]=l[0],t[1]=l[1],t[2]=l[2],t[3]=l[3],_[0]=l[4],_[1]=l[5],_[2]=l[6],_[3]=l[7],d.normalize(_,_)}function Te(e){var t=e._render;t.bones?t.type=Ze:t.params?"volume"in t.params||"pitch"in t.params?t.type=tt:de(e)?t.type=rt:ue(e)?t.type=at:fe(e)?t.type=nt:Pe(e)?t.type=$e:t.type=Je:t.type=Je}function de(e){var t=e._render.params;if(t)for(var _ in t)if(-1!=_.indexOf("nodes"))return!0;return!1}function ue(e){if(e._render.params){var t=e.fcurves;for(var _ in t)if("color"==_&&!t[_][3])return!0;if("energy"==_)return!0}return!1}function fe(e){var t=e._render.params;return"light_settings.environment_energy"in t||"horizon_color"in t||"zenith_color"in t||"mist_settings.intensity"in t||"mist_settings.depth"in t||"mist_settings.start"in t||"mist_settings.height"in t||"b4w_fog_color"in t}function Pe(e){if(e._render.params){var t=e.fcurves;for(var _ in t)if("location"==_||"rotation_quaternion"==_||"scale"==_)return!0}return!1}function Ae(e,t){t[0]=t[1]=t[2]=0;for(var _ in e)"location"==_?t[0]=1:"rotation_quaternion"==_?t[1]=1:"scale"==_&&(t[2]=1)}function Se(e,t){t[0]=t[1]=0;for(var _ in e)"energy"==_?t[0]=1:"color"==_&&(t[1]=1)}function pe(e,t){t[Tt]=t[dt]=t[ut]=0,t[ft]=t[Pt]=t[At]=0,t[St]=t[pt]=0;for(var _ in e)"light_settings.environment_energy"==_?t[Tt]=1:"horizon_color"==_?t[dt]=1:"zenith_color"==_?t[ut]=1:"mist_settings.intensity"==_?t[ft]=1:"mist_settings.depth"==_?t[Pt]=1:"mist_settings.start"==_?t[At]=1:"mist_settings.height"==_?t[St]=1:"b4w_fog_color"==_&&(t[pt]=1)}function Oe(e,t,_){var r=t[0],a=t[1],n=_[0],o=_[1],i=(o-a)/(n-r);return i*e+(a-i*r)}function ve(e,t,_,r){var a,n,o,i,s=[],E=[];s[0]=e[0]-t[0],s[1]=e[1]-t[1],E[0]=r[0]-_[0],E[1]=r[1]-_[1],o=r[0]-e[0],a=Math.abs(s[0]),n=Math.abs(E[0]),a+n!=0&&a+n>o&&(i=o/(a+n),t[0]=e[0]-i*s[0],t[1]=e[1]-i*s[1],_[0]=r[0]-i*E[0],_[1]=r[1]-i*E[1])}function me(e,t,_,r,a){return ge(Ne(0,1,e,t[0],_[0],r[0],a[0]),t[1],_[1],r[1],a[1])}function Ne(e,t,_,r,a,n,o){var i=e+(t-e)/2,s=ge(i,r,a,n,o),E=s-_;return Math.abs(E)<.02?i:E>0?Ne(e,i,_,r,a,n,o):Ne(i,t,_,r,a,n,o)}function ge(e,t,_,r,a){var n=1-e;return t*n*n*n+3*_*n*n*e+3*r*n*e*e+a*e*e*e}function Re(e,t,_,r){var a=_[0],n=_[1],o=_[2],i=e.trans,s=i[a][4*t],E=i[a][4*t+1],c=i[a][4*t+2],l=i[n][4*t],T=i[n][4*t+1],d=i[n][4*t+2];return r[0]=(1-o)*s+o*l,r[1]=(1-o)*E+o*T,r[2]=(1-o)*c+o*d,r}function Ie(e,t,_,r){var a=_[0],n=_[1],o=_[2],i=e.quats,s=ht;s[0]=i[a][4*t],s[1]=i[a][4*t+1],s[2]=i[a][4*t+2],s[3]=i[a][4*t+3];var E=Yt;return E[0]=i[n][4*t],E[1]=i[n][4*t+1],E[2]=i[n][4*t+2],E[3]=i[n][4*t+3],d.slerp(s,E,o,r),r}function be(e,t,_){var r=_[0],a=_[1],n=_[2],o=e.trans;return(1-n)*o[r][4*t+3]+n*o[a][4*t+3]}function he(e,t){g(e,t),R(e)}function Ye(e,t){ze.update_transform(e),Ke.sync_transform(e),C(e,0,t,!0)}function Le(e,t,_,r){if(r=r||ot,Ge.is_mesh(e)){var n=ye(e,_);if(n)return he(e,r),a(e,n,r),Ye(e,r),!0;var o=Ue(e,_);if(o&&"EMITTER"==o.p_type)return he(e,r),N(e,o.name,r),Ye(e,r),!0}var i=O._18("name",_,Ut)||O._18("name",_+"_B4W_BAKED",Ut);if(i){if(he(e,r),G(e,t,i,r))return Ye(e,r),!0;e.anim_slots[r]=null}return Be.error('Unsupported object: "'+e.name+'" or animation name: "'+_+'"'),!1}function Me(e,t){for(var _=e.anim_slots,r=0;r<_.length;r++){var a=_[r];if(a&&I(a.animation_name)==I(t))return r}return-1}function xe(e,t){return e.anim_slots[t].start}function ye(e,t){for(var _=0;_<e.vertex_anim.length;_++){var r=e.vertex_anim[_];if(r.name===t)return r}return null}function Ue(e,t){for(var _=e.scenes_data,r=0;r<_.length;r++)for(var a=_[r].batches,n=0;n<a.length;n++){var o=a[n].particles_data;if(o&&o.name===t)return o}return null}function we(e){for(var t=e.modifiers,_=0;_<t.length;_++){var r=t[_];if("ARMATURE"==r.type)return r.object}return null}function Ce(e,t){for(var _=it,r=Je,a=0;a<Ut.length;a++){var n=Ut[a];if(n.name==t){r=n._render.type;break}}if(r==Je)if(ye(e,t))r=et;else{var o=Ue(e,t);o&&"EMITTER"==o.p_type&&(r=_t)}for(var a=0;a<8;a++){var i=e.anim_slots[a];if(i){if(i.type==r)return a}else a<_&&(_=a)}return _}var De=Object(o.a)(e),Fe=Object(i.a)(e),Ge=Object(E.a)(e),ke=Object(c.a)(e),Ke=Object(l.a)(e),Be=Object(T.a)(e),Xe=Object(u.a)(e),He=Object(f.a)(e),je=Object(P.a)(e),Qe=Object(A.a)(e),ze=Object(S.a)(e),Ve=Fe.animation,qe=Fe.context_limits,We=1e-6;t.LAST_FRAME_EPSILON=We;var Je=0,Ze=10,$e=20,et=30,tt=40,_t=50,rt=60,at=70,nt=80;t.OBJ_ANIM_TYPE_NONE=Je,t.OBJ_ANIM_TYPE_ARMATURE=Ze,t.OBJ_ANIM_TYPE_OBJECT=$e,t.OBJ_ANIM_TYPE_VERTEX=et,t.OBJ_ANIM_TYPE_SOUND=tt,t.OBJ_ANIM_TYPE_PARTICLES=_t,t.OBJ_ANIM_TYPE_MATERIAL=rt,t.OBJ_ANIM_TYPE_LIGHT=at,t.OBJ_ANIM_TYPE_ENVIRONMENT=nt;var ot=0,it=7,st=-1;t.SLOT_0=ot,t.SLOT_1=1,t.SLOT_2=2,t.SLOT_3=3,t.SLOT_4=4,t.SLOT_5=5,t.SLOT_6=6,t.SLOT_7=it,t.SLOT_ALL=st;var Et=10,ct=20,lt=30;t.AB_CYCLIC=Et,t.AB_FINISH_RESET=ct,t.AB_FINISH_STOP=lt;var Tt=0,dt=1,ut=2,ft=3,Pt=4,At=5,St=6,pt=7,Ot=new Array(3),vt=new Float32Array(3),mt=new Float32Array(3),Nt=new Float32Array(4),gt=new Float32Array(4),Rt=new Float32Array(4),It=new Float32Array(4),bt=new Float32Array(4),ht=new Float32Array(4),Yt=new Float32Array(4),Lt=new Float32Array(4),Mt=p.b(),xt=p.b(),yt=[],Ut=[];t.get_max_bones=function(){return O._63((qe.max_vertex_uniform_vectors-50)/4)},t.frame_to_sec=function(e){return e/Qe.get_framerate()},t.update=function(e){for(var t=0;t<yt.length;t++){for(var _=yt[t],a=0;a<8;a++)$(_,e,a);_.render.anim_mixing&&(oe(_,e),re(_,e))}for(var t=0;t<yt.length;t++)for(var _=yt[t],a=0;a<8&&_.anim_slots.length;a++)r(_,a)},t.get_all_actions=function(){return Ut},t.get_anim_names=function(e){var t=[];if(x(e))for(var _=0;_<e.vertex_anim.length;_++)t.push(e.vertex_anim[_].name);for(var r=b(e),_=0;_<r.length;_++)t.push(I(r[_].name));if(ke.obj_has_particles(e)&&ke.obj_has_anim_particles(e))for(var a=e.scenes_data,_=0;_<a.length;_++)for(var n=a[_].batches,o=0;o<n.length;o++){var i=n[o].particles_data;i&&t.push(i.name)}return t},t.strip_baked_suffix=I,t.get_anim_type=function(e,t){var _=e.anim_slots[t];return _?_.type:Je},t.apply_def=function(e){for(var t=ot,_=e.scenes_data,r=0;r<_.length;r++)for(var n=_[r].batches,o=0;o<n.length;o++){var i=n[o].particles_data;i&&"EMITTER"==i.p_type&&!n[o].forked_batch&&(he(e,t),m(n[o],e.anim_slots[t],i),Ye(e,t),i.cyclic?e.anim_slots[t].behavior=Et:e.anim_slots[t].behavior=e.anim_behavior_def,t++)}for(var s=h(e),r=0;r<s.length;r++){var E=s[r],c=E.name_list,l=E.action;he(e,t),G(e,c,l,t)?(Ye(e,t),e.anim_slots[t].behavior=e.anim_behavior_def,t++):e.anim_slots[t]=null}x(e)&&(he(e,t),a(e,e.vertex_anim[0],t),Ye(e,t),e.anim_slots[t].behavior=e.anim_behavior_def,t++)},t.anim_behavior_bpy_b4w=function(e){switch(e){case"CYCLIC":return Et;case"FINISH_RESET":return ct;case"FINISH_STOP":return lt;default:De.panic("Wrong animation behavior")}},t.get_bpy_material_actions=function(e){for(var t=[],_=e.data.materials,r=0;r<_.length;r++){var a=_[r],n=a.node_tree;n&&M(n,t,[a.name])}return t},t.get_bpy_world_material_actions=Y,t.init_action_slot=L,t.play=function(e,t,_){function r(e){e.play=!0,e.finish_callback=t||null,e.exec_finish_callback=!1}w(e.anim_slots,_,r),e.render.anim_mixing&&Q(e)},t.stop=function(e,t){function _(e){e.play=!1,e.finish_callback=null,e.exec_finish_callback=!1}w(e.anim_slots,t,_)},t.is_play=function(e,t){var _=e.anim_slots;if(t==st){for(var r=0;r<8;r++)if(_[r]&&_[r].play)return!0}else{var a=_[t];if(a)return a.play}return!1},t.set_frame=y,t.set_first_frame=U,t.get_current_frame_float=function(e,t){var _=e.anim_slots[t];return _&&_.current_frame_float?_.current_frame_float:0},t.is_cyclic=function(e,t){var _=e.anim_slots[t];return _&&_.behavior==Et},t.set_behavior=function(e,t,_){function r(e){e.behavior=t}w(e.anim_slots,_,r)},t.get_behavior=function(e,t){var _=e.anim_slots[t];return _&&_.behavior},t.apply_smoothing=function(e,t,_,r){function a(e){e.trans_smooth_period=t||0,e.quat_smooth_period=_||0}w(e.anim_slots,r,a)},t.remove_slot_animation=function(e,t){if(t==st)for(var _=0;_<8;_++)e.anim_slots[_]=null;else e.anim_slots[t]=null;e.render.anim_mixing&&z(e,t)},t.update_object_animation=C,t.obj_is_animatable=function(e){if("ARMATURE"==e.type)return!0;if(e.armobj)return!0;if("WORLD"==e.type)return!0;for(var t=0;t<e.def_action_slots.length;t++){var _=e.def_action_slots[t],r=_.action._render.type;if(r==$e||r==Ze||r==tt&&"SPEAKER"==e.type||r==at&&"LAMP"==e.type||r==rt&&"MESH"==e.type)return!0}return!(!ke.obj_has_particles(e)||!ke.obj_has_anim_particles(e))||!("MESH"!=e.type||!e.vertex_anim.length)},t.bpy_mesh_empty_is_animatable=function(e){if(we(e))return!0;if(e._def_action_slots)for(var t=0;t<e._def_action_slots.length;t++){var _=e._def_action_slots[t],r=_.action,a=r._render.type;if(a==$e||a==rt&&"MESH"==e.type)return!0}return!(!ke.bpy_obj_has_particles(e)||!ke.bpy_obj_has_anim_particles(e))||!("MESH"!=e.type||!e.data.b4w_vertex_anim.length)},t.is_animated=D,t.init_action_cache=F,t.delete_cached_anim_data_by_mat=K,t.calc_pose_data=se,t.extract_skinned_pose_data=ce,t.append_action=function(e){var t=new RegExp(/pose.bones\[\".+\"\]/g),r=p.b(),a=function(e,t){if("object"==typeof t&&t.length)for(var _=t.length,r=new Float32Array(e*_),a=0;a<e;a++)for(var n=0;n<_;n++)r[a*_+n]=t[n];else if("number"==typeof t)for(var r=new Float32Array(e),a=0;a<e;a++)r[a]=t;else De.panic("Wrong storage default value");return r},n=function(e,t){for(var _=0;_<t;_++){var r=e.subarray(8*_+4,8*_+8);d.normalize(r,r)}},o=e._render=_();o.pierce_step=1/Ve.frame_steps;var i=e.fcurves,s={},E={},c=0;for(var l in i){var T=i[l];for(var u in T){var f=T[u],P=f._pierced_points,A=f.num_channels;c||(c=P.length);for(var S=function(e,_,n,o,i){if(n.search(t)>-1)var s=_,E=n.split('"')[1],c=r;else{var s=e;if(8==i)var E="tsr",c=r;else if(i>1)var E=n,c=new Float32Array(i);else var E=n,c=0}return s[E]||(s[E]=a(o,c)),s[E]}(s,E,l,c,A),v=S.length/c,m=function(e,t){if(e.indexOf("location")>-1)var _=0,r=t;else if(e.indexOf("rotation_quaternion")>-1)var _=4,r=0==t?3:t-1;else if(e.indexOf("scale")>-1)var _=3,r=0;else var _=0,r=t;return _+r}(l,0|u),N=0;N<c;N++)S[N*v+m]=P[N]}}if(O._8(s)){for(var g in s)"tsr"==g&&n(s[g],c);o.params=s}if(O._8(E)){for(var R in E)n(E[R],c);o.bones=E}o.num_pierced=c,o.bflags=e._bflags,"tsr"in s&&Ae(i,o.channels_mask),("color"in s||"energy"in s)&&Se(i,o.channels_mask),("light_settings.environment_energy"in s||"horizon_color"in s||"zenith_color"in s||"mist_settings.intensity"in s||"mist_settings.depth"in s||"mist_settings.start"in s||"mist_settings.height"in s||"b4w_fog_color"in s)&&pe(i,o.channels_mask),Te(e),Ut.push(e)},t.get_approx_curve_length=function(e,t){return(t-e)*Ve.frame_steps+1},t.approximate_curve=function(e,t,_,r,a,n){for(var o=new Float32Array(2),i=new Float32Array(2),s=new Float32Array(2),E=new Float32Array(2),c=t[1],l=t[2],T=t[e.last_frame_offset+1],d=t[e.last_frame_offset+2],u=0,f=0,P=null,A=a;A<=n;A++)if(A<c)for(var S=0;S<Ve.frame_steps;S++)_[u++]=l;else if(A>T)for(var S=0;S<Ve.frame_steps;S++)_[u++]=d;else{var p=t[f],O=3;0===p&&(O+=2),0===P&&(O+=2);var v=2===p?0:1;if(t[f+1]==t[f+O+1]){P=p,f+=O;continue}var m=0;if(A==t[f+1]&&(v&&(r[u]=1),_[u]=t[f+2],u++,m++),A==T)for(var S=m;S<Ve.frame_steps;S++)_[u++]=d;else{o[0]=t[f+1],o[1]=t[f+2],0!==p?(i[0]=0,i[1]=0):0===P?(i[0]=t[f+5],i[1]=t[f+6]):(i[0]=t[f+3],i[1]=t[f+4]),0!==p?(s[0]=0,s[1]=0):(s[0]=t[f+O+3],s[1]=t[f+O+4]),E[0]=t[f+O+1],E[1]=t[f+O+2];for(var S=m;S<Ve.frame_steps;S++){var N=A+S/Ve.frame_steps;switch(p){case 0:ve(o,i,s,E),v&&(r[u]=1),_[u]=me(N,o,i,s,E),u++;break;case 1:v&&(r[u]=1),_[u]=Oe(N,o,E),u++;break;case 2:v&&(r[u]=1),_[u]=t[f+2],u++;break;default:De.panic("Unknown keyframe interpolation mode: "+p)}}}A+1==t[f+O+1]&&(P=p,f+=O)}},t.apply=Le,t.apply_by_uuid=function(e,t,_,r){r=r||ot;var a=O._18("uuid",_,Ut);if(a){if(he(e,r),G(e,t,a,r))return Ye(e,r),!0;e.anim_slots[r]=null}return Be.error('Unsupported object: "'+e.name+'" or animation uuid: "'+_+'"'),!1},t.validate_action_by_name=function(e,t){var _=O._18("name",t,Ut)||O._18("name",t+"_B4W_BAKED",Ut);if(_){if(_._render.type==Je)return!1}else{if(!(Ue(e,t)||Ge.is_mesh(e)&&ye(e,t)))return!1}return!0},t.get_slot_num_by_anim=Me,t.get_anim_by_slot_num=function(e,t){var _=e.anim_slots[t];return _&&_.animation_name?I(_.animation_name):null},t.remove=function(e){e.anim_slots.length=0;var t=yt.indexOf(e);-1!=t&&yt.splice(t,1)},t.remove_actions=function(e){for(var t=Ut.length-1;t>=0;t--)Ut[t]._data_id==e&&Ut.splice(t,1)},t.apply_to_first_empty_slot=function(e,t){if(!e.anim_slots.length)return Le(e,null,t,ot)?ot:-1;for(var _=0;_<e.anim_slots.length;_++)if(!e.anim_slots[_])return Le(e,null,t,_)?_:-1},t.set_skel_mix_factor=function(e,t,_,r){var a=e.render,n=a.anim_mix_factor,o=(t-n)/_;a.anim_mix_factor_change_speed=o,a.anim_destination_mix_factor=t,a.anim_mix_cb&&a.anim_mix_cb(),a.anim_mix_cb=r},t.mix_from_cur_pos=function(e,t,_,r){var a=e.render;a.blend_skel_slots[1]=t;var n=1/_;a.anim_mix_factor_change_speed=n,a.anim_destination_mix_factor=1,a.anim_mix_cb&&a.anim_mix_cb(),a.anim_mix_cb=r,a.trans_curr=null,a.quats_curr=null,a.mix_with_current=!0},t.set_speed=function(e,t,_){function r(e){e.speed=t}w(e.anim_slots,_,r)},t.get_speed=function(e,t){return e.anim_slots[t].speed},t.get_anim_start_frame=xe,t.get_anim_length=function(e,t){return e.anim_slots[t].length},t.cleanup=function(){yt.length=0,Ut.length=0},t.fcurve_replace_euler_by_quat=function(e){var t=e[0]||e[1]||e[2],_=t._pierced_points.length,r=bt,a=vt,n=Boolean(e[0]);n||(e[0]={_pierced_points:new Float32Array(_),num_channels:8});var o=Boolean(e[1]);o||(e[1]={_pierced_points:new Float32Array(_),num_channels:8});var i=Boolean(e[2]);i||(e[2]={_pierced_points:new Float32Array(_),num_channels:8}),e[3]={_pierced_points:new Float32Array(_),num_channels:8};for(var s=0;s<_;s++)a[0]=n?e[0]._pierced_points[s]:0,a[1]=o?e[1]._pierced_points[s]:0,a[2]=i?e[2]._pierced_points[s]:0,O.Y(a,r),e[0]._pierced_points[s]=r[3],e[1]._pierced_points[s]=r[0],e[2]._pierced_points[s]=r[1],e[3]._pierced_points[s]=r[2]},t.get_bpy_armobj=we,t.slot_by_anim_type=Ce}var a=_(0),n=_(56),o=_(5),i=_(4),s=_(57),E=_(8),c=_(47),l=_(19),T=_(1),d=_(9),u=_(10),f=_(23),P=_(11),A=_(18),S=_(13),p=_(6),O=_(2),v=_(3),m=Object(a.a)("__animation",r);t.a=m},function(e,t,_){"use strict";function r(e,t){function _(e){var t=ee.detect_mobile();return!(!(e!=ce||navigator.getVRDevices||navigator.getVRDisplays||t&&$())||!(e!=Ee||t&&window.DeviceOrientationEvent))}function r(e,t){if(!_(e))return null;var r={type:e,registered:!1,orientation_quat_cb_list:[],orientation_angles_cb_list:[],mouse_down_which_cb_list:[],mouse_location_cb_list:[],mouse_up_which_cb_list:[],mouse_wheel_cb_list:[],keyboard_down_cb_list:[],keyboard_down_mod_cb_list:[],keyboard_up_cb_list:[],touch_start_cb_list:[],touch_move_cb_list:[],touch_end_cb_list:[],element:t,prevent_default:!0,registered_event_listeners:[],mouse_location:new Float32Array(2),mouse_which:0,distortion_coefs:new Float32Array(2),chromatic_aberration_coefs:new Float32Array(4),registered_cb:null,webvr_hmd_device:null,webvr_sensor_devices:null,webvr_display:null,orientation:l.create(),position:d.create(),frame_data:window.VRFrameData?new VRFrameData:null,standing_tsr:c.b(),fov_left:new Float32Array(4),fov_right:new Float32Array(4),inter_lens_dist:0,base_line_dist:0,screen_to_lens_dist:0,width_dist:0,height_dist:0,bevel_size:0,gamepad_btns:[],gamepad_axes:[0,0,0,0,0,0,0,0,0,0,0,0],gamepad_prev_axes:[0,0,0,0,0,0,0,0,0,0,0,0],gamepad_mapping:[]};return r.fov_left[0]=r.fov_left[1]=r.fov_left[2]=r.fov_left[3]=Math.PI/4,r.fov_right[0]=r.fov_right[1]=r.fov_right[2]=r.fov_right[3]=Math.PI/4,e==le||e==Te||e==de?(r.registered=Boolean(t),e==de?document.addEventListener("touchstart",function(){}):e==Te&&(r.prevent_default=!1)):e==Ee?r.registered=!0:e==ce&&f(r),r}function a(e,t){e==Ee||e==ce?t=window:t||(t=e==Te?document:te.get_container());for(var _=0;_<je.length;_++)if(je[_].type==e&&je[_].element==t)return je[_];var a=r(e,t);return e!=ue&&e!=fe&&e!=Pe&&e!=Ae||P(a),a&&je.push(a),a}function f(e){e.type==ce&&(navigator.getVRDisplays?navigator.getVRDisplays().then(function(t){t.length>0&&(e.webvr_display=t[0],e.registered=!0,e.webvr_display.getFrameData(e.frame_data),e.registered_cb&&e.registered_cb())},function(t){re.error_once("WebVR displays are not found."),e.registered=!1}):navigator.getVRDevices?(navigator.getVRDevices().then(function(t){O(e,t),t.length&&(e.registered=!0),e.registered_cb&&e.registered_cb()},function(t){re.error_once("WebVR devices are not found."),e.registered=!1}),S(e,ne.webvr)):(A(e),e.registered=!0))}function P(e){e.gamepad_mapping.push(t.GMPD_BUTTON_0,t.GMPD_BUTTON_1,t.GMPD_BUTTON_2,t.GMPD_BUTTON_3,t.GMPD_BUTTON_4,t.GMPD_BUTTON_5,t.GMPD_BUTTON_6,t.GMPD_BUTTON_7,t.GMPD_BUTTON_8,t.GMPD_BUTTON_9,t.GMPD_BUTTON_10,t.GMPD_BUTTON_11,t.GMPD_BUTTON_12,t.GMPD_BUTTON_13,t.GMPD_BUTTON_14,t.GMPD_BUTTON_15,t.GMPD_BUTTON_16,t.GMPD_BUTTON_17,t.GMPD_BUTTON_18,t.GMPD_BUTTON_19,t.GMPD_BUTTON_20,t.GMPD_BUTTON_21,t.GMPD_BUTTON_22,t.GMPD_BUTTON_23,t.GMPD_BUTTON_24,t.GMPD_BUTTON_25,t.GMPD_AXIS_0,t.GMPD_AXIS_1,t.GMPD_AXIS_2,t.GMPD_AXIS_3,t.GMPD_AXIS_4,t.GMPD_AXIS_5,t.GMPD_AXIS_6,t.GMPD_AXIS_7,t.GMPD_AXIS_8,t.GMPD_AXIS_9,t.GMPD_AXIS_10,t.GMPD_AXIS_11)}function A(e){var t=ne.nonwebvr;e.width_dist=t.width_dist,e.height_dist=t.height_dist,e.bevel_size=t.bevel_size,S(e,t),e.inter_lens_dist=t.inter_lens_dist,e.base_line_dist=t.base_line_dist,e.screen_to_lens_dist=t.screen_to_lens_dist,p(e)}function S(e,t){e.distortion_coefs[0]=t.distortion_coefs[0],e.distortion_coefs[1]=t.distortion_coefs[1],e.chromatic_aberration_coefs[0]=t.chromatic_aberration_coefs[0],e.chromatic_aberration_coefs[1]=t.chromatic_aberration_coefs[1],e.chromatic_aberration_coefs[2]=t.chromatic_aberration_coefs[2],e.chromatic_aberration_coefs[3]=t.chromatic_aberration_coefs[3]}function p(e){var t=e.inter_lens_dist/2,_=t/e.screen_to_lens_dist,r=Math.atan(_*ne.nonwebvr.distor_scale),a=r,n=r,o=r;o&&(e.fov_left[0]=e.fov_right[0]=Math.min(o,Math.PI/3)),r&&(e.fov_left[1]=e.fov_right[3]=Math.min(r,Math.PI/3)),n&&(e.fov_left[2]=e.fov_right[2]=Math.min(n,Math.PI/3)),a&&(e.fov_left[3]=e.fov_right[1]=Math.min(a,Math.PI/3))}function O(e,t){var _=t.filter(function(e){return e instanceof HMDVRDevice}),r=null;_.length&&(r=_[0]);var a=null;r&&(a=t.filter(function(e){return-1!==e.deviceName.toLowerCase().indexOf("oculus")&&e.hardwareUnitId==r.hardwareUnitId&&e instanceof PositionSensorVRDevice})),e.webvr_hmd_device=r,e.webvr_sensor_devices=a}function v(e){switch(e.type){case ce:if(e.registered)if(e.webvr_display)e.webvr_display.resetPose();else if(e.webvr_sensor_devices)for(var t=0;t<e.webvr_sensor_devices.length;t++){var _=e.webvr_sensor_devices[t];_.resetSensor()}break;default:return void re.error("reset_device() is undefined for device: ",e.type)}}function m(e,t,_){switch(e.type){case ce:var r=g(e,Ne);if(r&Se){if("left"==t)var a=e.fov_left;else var a=e.fov_right;u.copy(a,_)}else{var n=e.webvr_display||e.webvr_hmd_device;if(n){var o=n.getEyeParameters(t),a=o.fieldOfView||o.currentFieldOfView;if(a)_[0]=T.T(a.upDegrees),_[1]=T.T(a.rightDegrees),_[2]=T.T(a.downDegrees),_[3]=T.T(a.leftDegrees);else if(r&me){var i=se;"left"==t?s.copy(e.frame_data.leftProjectionMatrix,i):s.copy(e.frame_data.rightProjectionMatrix,i),_[0]=Math.atan(-ke[1]/ke[2]),_[1]=Math.atan(-ke[0]/ke[2]),_[2]=Math.atan(ke[1]/ke[2]),_[3]=Math.atan(ke[0]/ke[2])}}}break;default:re.error("fov is undefined for device: ",e.type)}return _}function N(e,t,_){switch(e.type){case ce:e.webvr_display&&("left"==t?s.copy(e.frame_data.leftProjectionMatrix,_):"right"==t?s.copy(e.frame_data.rightProjectionMatrix,_):re.error("Unknown type of eye: ",t));break;default:re.error("Projection matrix is undefined for device: ",e.type)}return _}function g(e,t){switch(t){case Ne:var _=0;return navigator.getVRDisplays&&(_|=ve,e.frame_data&&(_|=me)),navigator.getVRDevices&&(ae.is_mobile_device?_|=Oe:_|=pe),_=_||Se;case ge:var r=e.webvr_display||e.webvr_hmd_device;if(r){var a=r.getEyeParameters("left"),n=r.getEyeParameters("right");return e.webvr_display?n.offset[0]-a.offset[0]:n.eyeTranslation.x-a.eyeTranslation.x}return e.inter_lens_dist}}function R(e,t){if(e.webvr_display){var _=e.webvr_display;if(e.frame_data&&_.getFrameData(e.frame_data)){var r=e.frame_data.pose,a=T._25(e.frame_data.leftViewMatrix,ke);e.inter_lens_dist=2*d.length(a)}else var r=_.getPose();if(r){var n=l.setAxisAngle(T.d,Math.PI/2,Fe);if(_.stageParameters&&_.stageParameters.sittingToStandingTransform){var o=c.d(_.stageParameters.sittingToStandingTransform,oe);c.l(ie);var i=c.q(n,ie);o=c.p(i,o,e.standing_tsr)}else{c.l(oe);var o=c.q(n,e.standing_tsr)}r.orientation&&c.y(r.orientation,o,e.orientation),r.position&&c.B(r.position,o,e.position)}}}function I(e,t){if(e){for(var _=0;_<e.buttons.length;_++)t.gamepad_btns[_]=e.buttons[_].value||+e.buttons[_].pressed;if(e.axes)for(var _=0;_<e.axes.length;_++)t.gamepad_axes[_]=e.axes[_];var r=e.pose;if(r){var n=a(ce),o=n.standing_tsr;r.position&&c.B(r.position,o,t.position),r.orientation&&c.y(r.orientation,o,t.orientation)}}}function b(e){for(var t=0;t<e.gamepad_btns;t++)e.gamepad_btns[t]=0;for(var t=0;t<e.gamepad_axes.length;t++)e.gamepad_prev_axes[t]=e.gamepad_axes[t],e.gamepad_axes[t]=0;e.position.set(T.m),e.orientation.set(T.k)}function h(e,t){var _=e.indexOf(t);_>=0&&(e[_]=null)}function Y(e){return null===e}function L(e,t,_,r){switch(t){case we:if(_&&h(e.orientation_quat_cb_list,_),r||e.orientation_angles_cb_list.every(Y)&&e.orientation_quat_cb_list.every(Y)){e.orientation_quat_cb_list.length=0,e.orientation_angles_cb_list.length=0,t=De;var a=e.registered_event_listeners.indexOf(t);a>=0&&(e.registered_event_listeners.splice(a,1),e.element.removeEventListener("deviceorientation",C,!1))}break;case Ce:if(_&&h(e.orientation_angles_cb_list,_),r||e.orientation_angles_cb_list.every(Y)&&e.orientation_quat_cb_list.every(Y)){e.orientation_quat_cb_list.length=0,e.orientation_angles_cb_list.length=0,t=De;var a=e.registered_event_listeners.indexOf(t);a>=0&&(e.registered_event_listeners.splice(a,1),e.element.removeEventListener("deviceorientation",C,!1))}break;case be:if(_&&h(e.mouse_down_which_cb_list,_),r||e.mouse_down_which_cb_list.every(Y)){e.mouse_down_which_cb_list.length=0;var a=e.registered_event_listeners.indexOf(t);a>=0&&(e.registered_event_listeners.splice(a,1),e.element.removeEventListener("mousedown",k,!1))}break;case Re:if(_&&h(e.mouse_location_cb_list,_),r||e.mouse_location_cb_list.every(Y)){e.mouse_location_cb_list.length=0;var a=e.registered_event_listeners.indexOf(t);a>=0&&(e.registered_event_listeners.splice(a,1),e.element.removeEventListener("mousemove",F,!1))}break;case Ie:if(_&&h(e.mouse_location_cb_list,_),r||e.mouse_location_cb_list.every(Y)){e.mouse_location_cb_list.length=0;var a=e.registered_event_listeners.indexOf(t);a>=0&&(e.registered_event_listeners.splice(a,1),e.element.removeEventListener("mousemove",G,!1))}break;case he:if(_&&h(e.mouse_up_which_cb_list,_),r||e.mouse_up_which_cb_list.every(Y)){e.mouse_up_which_cb_list.length=0;var a=e.registered_event_listeners.indexOf(t);a>=0&&(e.registered_event_listeners.splice(a,1),e.element.removeEventListener("mouseout",K,!1),e.element.removeEventListener("mouseup",B,!1));break}break;case Ye:if(_&&h(e.mouse_wheel_cb_list,_),r||e.mouse_wheel_cb_list.every(Y)){e.mouse_wheel_cb_list.length=0;var a=e.registered_event_listeners.indexOf(t);a>=0&&(e.registered_event_listeners.splice(a,1),e.element.removeEventListener("wheel",H,!1))}break;case Me:if(_&&h(e.keyboard_down_cb_list,_),r||e.keyboard_down_cb_list.every(Y)){e.keyboard_down_cb_list.length=0;var a=e.registered_event_listeners.indexOf(t);a>=0&&(e.registered_event_listeners.splice(a,1),e.element.removeEventListener("keydown",j,!1))}break;case Le:if(_&&h(e.keyboard_up_cb_list,_),r||e.keyboard_up_cb_list.every(Y)){e.keyboard_up_cb_list.length=0;var a=e.registered_event_listeners.indexOf(t);a>=0&&(e.registered_event_listeners.splice(a,1),e.element.removeEventListener("keyup",Q,!1))}break;case xe:if(_&&h(e.touch_start_cb_list,_),r||e.touch_start_cb_list.every(Y)){e.touch_start_cb_list.length=0;var a=e.registered_event_listeners.indexOf(t);a>=0&&(e.registered_event_listeners.splice(a,1),e.element.removeEventListener("touchstart",z,!1))}break;case ye:if(_&&h(e.touch_move_cb_list,_),r||e.touch_move_cb_list.every(Y)){e.touch_move_cb_list.length=0;var a=e.registered_event_listeners.indexOf(t);a>=0&&(e.registered_event_listeners.splice(a,1),e.element.removeEventListener("touchmove",V,!1))}break;case Ue:if(_&&h(e.touch_end_cb_list,_),r||e.touch_end_cb_list.every(Y)){e.touch_end_cb_list.length=0;var a=e.registered_event_listeners.indexOf(t);a>=0&&(e.registered_event_listeners.splice(a,1),e.element.removeEventListener("touchend",q,!1))}}}function M(){return/iPad|iPhone|iPod/.test(navigator.platform)}function x(e,t){switch(t){case be:M()||e.element.addEventListener("mousedown",k,!1);break;case Re:e.element.addEventListener("mousemove",F,!1);break;case Ie:e.element.addEventListener("mousemove",G,!1);break;case he:M()||(e.element!=window&&e.element.addEventListener("mouseout",K,!1),e.element.addEventListener("mouseup",B,!1));break;case Ye:e.element.addEventListener("wheel",H,!1);break;case Me:e.element.addEventListener("keydown",j,!1);break;case Le:e.element.addEventListener("keyup",Q,!1);break;case xe:e.element.addEventListener("touchstart",z,!1);break;case ye:e.element.addEventListener("touchmove",V,!1);break;case Ue:e.element.addEventListener("touchend",q,!1);break;case De:e.element.addEventListener("deviceorientation",C,!1)}}function y(e,t){switch(e.type){case ce:if(d.copy(T.k,t),e.webvr_display)t[0]=e.orientation[0],t[1]=e.orientation[1],t[2]=e.orientation[2],t[3]=e.orientation[3];else if(e.webvr_sensor_devices)for(var _=0;_<e.webvr_sensor_devices.length;_++){var r=e.webvr_sensor_devices[_],a=r.getState&&r.getState()||r.getImmediateState&&r.getImmediateState();a.orientation&&(t[0]=a.orientation.x,t[1]=a.orientation.y,t[2]=a.orientation.z,t[3]=a.orientation.w)}return t;default:return re.error("orientation_quat is undefined for device: ",e.type),t}}function U(e,t){switch(e.type){case ce:if(d.copy(T.n,t),e.webvr_display)t[0]=e.position[0],t[1]=e.position[1],t[2]=e.position[2];else if(e.webvr_sensor_devices)for(var _=0;_<e.webvr_sensor_devices.length;_++){var r=e.webvr_sensor_devices[_],a=r.getState&&r.getState()||r.getImmediateState&&r.getImmediateState();a.position&&(t[0]=a.position.x,t[1]=-a.position.z,t[2]=a.position.y)}return t;default:return re.error("position is undefined for device: ",e.type),t}}function w(e,t){if(T._26(e,T.w,t),"orientation"in window)var _=T.T(window.orientation);else if("orientation"in window.screen)var _=T.T(window.screen.orientation.angle);else var _=0;var r=l.setAxisAngle(T.c,_,Ge);return l.multiply(t,r,t),t}function C(e){var t=ke;null===e.alpha||null===e.beta||null===e.gamma?t[0]=t[1]=t[2]=0:(t[0]=T.T(e.alpha),t[1]=T.T(e.beta),t[2]=T.T(e.gamma));for(var _=a(Ee,e.currentTarget),r=0;r<_.orientation_angles_cb_list.length;r++){var n=_.orientation_angles_cb_list[r];n&&(d.copy(t,Be),n(Be))}if(_.orientation_quat_cb_list.length)for(var o=w(t,Fe),r=0;r<_.orientation_quat_cb_list.length;r++){var n=_.orientation_quat_cb_list[r];n&&(l.copy(o,Xe),n(Xe))}for(var r=0;r<_.orientation_quat_cb_list.length;r++)_.orientation_quat_cb_list[r]||_.orientation_quat_cb_list.splice(r,1);for(var r=0;r<_.orientation_angles_cb_list.length;r++)_.orientation_angles_cb_list[r]||_.orientation_angles_cb_list.splice(r,1)}function D(e,t){switch(e.type){case le:e.mouse_location[0]=t.clientX,e.mouse_location[1]=t.clientY,e.mouse_which=t.which}}function F(e){if(He){if(e.sourceCapabilities&&e.sourceCapabilities.firesTouchEvents)return;if(5==e.mozInputSource)return}var t=a(le,e.currentTarget);D(t,e);for(var _=0;_<t.mouse_location_cb_list.length;_++){var r=t.mouse_location_cb_list[_];r&&(Ke[0]=e.clientX,Ke[1]=e.clientY,r(Ke))}t.prevent_default&&e.preventDefault();for(var _=0;_<t.mouse_location_cb_list.length;_++)t.mouse_location_cb_list[_]||t.mouse_location_cb_list.splice(_,1)}function G(e){if(He){if(e.sourceCapabilities&&e.sourceCapabilities.firesTouchEvents)return;if(5==e.mozInputSource)return}var t=a(le,e.currentTarget);D(t,e);for(var _=0;_<t.mouse_location_cb_list.length;_++){var r=t.mouse_location_cb_list[_];if(r){if("number"==typeof e.movementX)var n=e.movementX,o=e.movementY;else if("number"==typeof e.webkitMovementX)var n=e.webkitMovementX,o=e.webkitMovementY;else if("number"==typeof e.mozMovementX)var n=e.mozMovementX,o=e.mozMovementY;else var n=0,o=0;Ke[0]=n,Ke[1]=o,r(Ke)}}t.prevent_default&&e.preventDefault();for(var _=0;_<t.mouse_location_cb_list.length;_++)t.mouse_location_cb_list[_]||t.mouse_location_cb_list.splice(_,1)}function k(e){if(He){if(e.sourceCapabilities&&e.sourceCapabilities.firesTouchEvents)return;if(5==e.mozInputSource)return}var t=a(le,e.currentTarget);D(t,e);for(var _=0;_<t.mouse_down_which_cb_list.length;_++){var r=t.mouse_down_which_cb_list[_];r&&r(e.which)}t.prevent_default&&(window.frameElement&&window.frameElement.focus(),e.preventDefault());for(var _=0;_<t.mouse_down_which_cb_list.length;_++)t.mouse_down_which_cb_list[_]||t.mouse_down_which_cb_list.splice(_,1)}function K(e){!te.is_child(e.relatedTarget)&&e.which&&B(e)}function B(e){if(He){if(e.sourceCapabilities&&e.sourceCapabilities.firesTouchEvents)return;if(5==e.mozInputSource)return}var t=a(le,e.currentTarget);D(t,e);for(var _=0;_<t.mouse_up_which_cb_list.length;_++){var r=t.mouse_up_which_cb_list[_];r&&r(e.which)}t.prevent_default&&e.preventDefault();for(var _=0;_<t.mouse_up_which_cb_list.length;_++)t.mouse_up_which_cb_list[_]||t.mouse_up_which_cb_list.splice(_,1)}function X(e){var t=0;return e.wheelDelta?t=e.wheelDelta%120==0?e.wheelDelta/120:T._49(e.wheelDelta):e.deltaY&&(t=e.deltaY%3==0?-e.deltaY/3:-T._49(e.deltaY)),T.M(Qe*t,-ze,ze)}function H(e){for(var t=a(le,e.currentTarget),_=0;_<t.mouse_wheel_cb_list.length;_++){var r=t.mouse_wheel_cb_list[_];r&&r(X(e))}t.prevent_default&&e.preventDefault();for(var _=0;_<t.mouse_wheel_cb_list.length;_++)t.mouse_wheel_cb_list[_]||t.mouse_wheel_cb_list.splice(_,1)}function j(e){for(var t=a(Te,e.currentTarget),_=e.ctrlKey||e.altKey||e.metaKey?t.keyboard_down_mod_cb_list:t.keyboard_down_cb_list,r=0;r<_.length;r++){var n=_[r];n?n(e.keyCode):_.splice(r--,1)}t.prevent_default&&e.preventDefault()}function Q(e){for(var t=a(Te,e.currentTarget),_=0;_<t.keyboard_up_cb_list.length;_++){var r=t.keyboard_up_cb_list[_];r&&r(e.keyCode)}t.prevent_default&&e.preventDefault();for(var _=0;_<t.keyboard_up_cb_list.length;_++)t.keyboard_up_cb_list[_]||t.keyboard_up_cb_list.splice(_,1)}function z(e){for(var t=a(de,e.currentTarget),_=0;_<t.touch_start_cb_list.length;_++){var r=t.touch_start_cb_list[_];r&&r(e.targetTouches)}for(var _=0;_<t.touch_start_cb_list.length;_++)t.touch_start_cb_list[_]||t.touch_start_cb_list.splice(_,1)}function V(e){for(var t=a(de,e.currentTarget),_=0;_<t.touch_move_cb_list.length;_++){var r=t.touch_move_cb_list[_];r&&r(e.targetTouches)}t.prevent_default&&e.preventDefault();for(var _=0;_<t.touch_move_cb_list.length;_++)t.touch_move_cb_list[_]||t.touch_move_cb_list.splice(_,1)}function q(e){for(var t=a(de,e.currentTarget),_=0;_<t.touch_end_cb_list.length;_++){var r=t.touch_end_cb_list[_];r&&r(e.targetTouches)}for(var _=0;_<t.touch_end_cb_list.length;_++)t.touch_end_cb_list[_]||t.touch_end_cb_list.splice(_,1)}function W(e){switch(e){case 0:var t=ue;break;case 1:var t=fe;break;case 2:var t=Pe;break;case 3:var t=Ae;break;default:var t=ue}return t}function J(e,t){return e.gamepad_mapping[t]}function Z(e){var t=e.element,_=function(){document.pointerLockElement===t||document.webkitPointerLockElement===t||document.mozPointerLockElement===t?e.value=1:(e.value=0,document.removeEventListener("pointerlockchange",_,!1),document.removeEventListener("webkitpointerlockchange",_,!1),document.removeEventListener("mozpointerlockchange",_,!1))};document.addEventListener("pointerlockchange",_,!1),document.addEventListener("webkitpointerlockchange",_,!1),document.addEventListener("mozpointerlockchange",_,!1);var r=t.requestPointerLock||t.webkitRequestPointerLock||t.mozRequestPointerLock;"function"==typeof r&&r.apply(t)}function $(){return!!(window.document.fullscreenEnabled||window.document.mozFullScreenEnabled||window.document.msFullscreenEnabled||window.document.webkitFullscreenEnabled)}var ee=Object(n.a)(e),te=Object(o.a)(e),_e=Object(i.a)(e),re=Object(E.a)(e),ae=_e.defaults,ne=_e.hmd_params,oe=c.b(),ie=c.b(),se=s.create(),Ee=10,ce=20,le=30,Te=40,de=50,ue=60,fe=70,Pe=80,Ae=90;t.DEVICE_GYRO=Ee,t.DEVICE_HMD=ce,t.DEVICE_MOUSE=le,t.DEVICE_KEYBOARD=Te,t.DEVICE_TOUCH=de,t.DEVICE_GAMEPAD0=ue,t.DEVICE_GAMEPAD1=fe,t.DEVICE_GAMEPAD2=Pe,t.DEVICE_GAMEPAD3=Ae;var Se=1,pe=2,Oe=4,ve=8,me=16;t.HMD_WEBVR_DESKTOP=pe,t.HMD_WEBVR_MOBILE=Oe,t.HMD_NON_WEBVR=Se,t.HMD_WEBVR1=ve,t.HMD_WEBVR1_1=me;var Ne=0,ge=23,Re=40,Ie=41,be=50,he=60,Ye=70,Le=80,Me=90,xe=100,ye=110,Ue=120,we=130,Ce=140,De=141;t.HMD_WEBVR_TYPE=Ne,t.HMD_ORIENTATION_QUAT=10,t.HMD_POSITION=20,t.HMD_FOV_LEFT=21,t.HMD_FOV_RIGHT=22,t.HMD_EYE_DISTANCE=ge,t.HMD_DISTORTION=24,t.HMD_BASELINE_DIST=25,t.HMD_SCREEN_LENS_DIST=26,t.HMD_SCREEN_WIDTH=27,t.HMD_SCREEN_HEIGHT=28,t.HMD_BEVEL_SIZE=29,t.HMD_PROJ_LEFT=30,t.HMD_PROJ_RIGHT=31,t.MOUSE_LOCATION=Re,t.MOUSE_LOCATION_PL=Ie,t.MOUSE_DOWN_WHICH=be,t.MOUSE_UP_WHICH=he,t.MOUSE_WHEEL=Ye,t.KEYBOARD_UP=Le,t.KEYBOARD_DOWN=Me,t.KEYBOARD_DOWN_MODIFIED=91,t.TOUCH_START=xe,t.TOUCH_MOVE=ye,t.TOUCH_END=Ue,t.GYRO_ORIENTATION_QUAT=we,t.GYRO_ORIENTATION_ANGLES=Ce,t.GMPD_BUTTON_0=300,t.GMPD_BUTTON_1=301,t.GMPD_BUTTON_2=302,t.GMPD_BUTTON_3=303,t.GMPD_BUTTON_4=304,t.GMPD_BUTTON_5=305,t.GMPD_BUTTON_6=306,t.GMPD_BUTTON_7=307,t.GMPD_BUTTON_8=308,t.GMPD_BUTTON_9=309,t.GMPD_BUTTON_10=310,t.GMPD_BUTTON_11=311,t.GMPD_BUTTON_12=312,t.GMPD_BUTTON_13=313,t.GMPD_BUTTON_14=314,t.GMPD_BUTTON_15=315,t.GMPD_BUTTON_16=316,t.GMPD_BUTTON_17=317,t.GMPD_BUTTON_18=318,t.GMPD_BUTTON_19=319,t.GMPD_BUTTON_20=320,t.GMPD_BUTTON_21=321,t.GMPD_BUTTON_22=322,t.GMPD_BUTTON_23=323,t.GMPD_BUTTON_24=324,t.GMPD_BUTTON_25=325,t.GMPD_TRACKPAD_BUTTON=300,t.GMPD_TRIGGER_BUTTON=301,t.GMPD_GRIPS_BUTTON=302,t.GMPD_MENU_BUTTON=303,t.GMPD_AXIS_0=326,t.GMPD_AXIS_1=327,t.GMPD_AXIS_2=328,t.GMPD_AXIS_3=329,t.GMPD_AXIS_4=330,t.GMPD_AXIS_5=331,t.GMPD_AXIS_6=332,t.GMPD_AXIS_7=333,t.GMPD_AXIS_8=334,t.GMPD_AXIS_9=335,t.GMPD_AXIS_10=336,t.GMPD_AXIS_11=337;var Fe=l.create(),Ge=l.create(),ke=d.create(),Ke=new Float32Array(2),Be=d.create(),Xe=l.create(),He="ontouchstart"in document.documentElement,je=[],Qe=100,ze=2e3;t.can_use_device=_,t.init=function(){if("HMD"==ae.stereo||"NONE"==ae.stereo&&ae.is_mobile_device){var e=a(ce);e&&document.addEventListener("onvrdisplayconnect",function(t){e.webvr_display=t.display,e.registered=!0,e.webvr_display.getFrameData(e.frame_data)})}},t.get_device_by_type_element=a,t.request_register_device=f,t.switch_prevent_default=function(e,t){e.prevent_default=t},t.reset_device=v,t.get_vector_param=function(e,t,_){switch(t){case 10:return y(e,_);case 20:return U(e,_);case 21:return m(e,"left",_);case 22:return m(e,"right",_);case 30:return N(e,"left",_);case 31:return N(e,"right",_);case Re:case Ie:return _[0]=e.mouse_location[0],_[1]=e.mouse_location[1],_}},t.get_value_param=g,t.set_config=function(e,t,_){switch(e.type){case ce:if(g(e,Ne)&ve)break;switch(t){case 24:e.distortion_coefs[0]=_[0],e.distortion_coefs[1]=_[1];break;case ge:e.inter_lens_dist=_,p(e);break;case 25:e.base_line_dist=_,p(e);break;case 26:e.screen_to_lens_dist=_,p(e);break;case 27:e.width_dist=_,p(e);break;case 28:e.height_dist=_,p(e);break;case 29:e.bevel_size=_,p(e)}break;case ue:case fe:case Pe:case Ae:e.gamepad_mapping[t]=_}},t.get_gamepad_btn_value=function(e,t){var _=t-300;return _<e.gamepad_btns.length&&e.gamepad_btns[J(e,_)-300]},t.get_gamepad_axis_value=function(e,t){var _=t-300;return t-326<e.gamepad_axes.length?e.gamepad_axes[J(e,_)-326]:0},t.get_gamepad_position=function(e,t){return t.set(e.position),t},t.get_gamepad_orientation=function(e,t){return t.set(e.orientation),t},t.update=function(e){for(var t=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],_=0;_<je.length;_++){var r=je[_];switch(r.type){case ue:b(r),I(t[0],r);break;case fe:b(r),I(t[1],r);break;case Pe:b(r),I(t[2],r);break;case Ae:b(r),I(t[3],r);break;case ce:R(r,e)}}},t.attach_param_cb=function(e,t,_){switch(t){case we:e.orientation_quat_cb_list.push(_),t=De;break;case Ce:e.orientation_angles_cb_list.push(_),t=De;break;case be:e.mouse_down_which_cb_list.push(_);break;case Re:case Ie:e.mouse_location_cb_list.push(_);break;case he:e.mouse_up_which_cb_list.push(_);break;case Ye:e.mouse_wheel_cb_list.push(_);break;case Me:e.keyboard_down_cb_list.push(_);break;case 91:e.keyboard_down_mod_cb_list.push(_),t=Me;break;case Le:e.keyboard_up_cb_list.push(_);break;case xe:e.touch_start_cb_list.push(_);break;case ye:e.touch_move_cb_list.push(_);break;case Ue:e.touch_end_cb_list.push(_)}-1==e.registered_event_listeners.indexOf(t)&&(e.registered_event_listeners.push(t),e.registered&&x(e,t))},t.detach_param_cb=function(e,t,_){L(e,t,_,!1)},t.gyro_angles_to_quat=w,t.cleanup=function(){for(var e=0;e<je.length;e++)for(var t=je[e],_=0;_<t.registered_event_listeners.length;_++){var r=t.registered_event_listeners[_];L(t,r,null,!0)}je.length=0},t.get_pressed_gmpd_btn=function(e){for(var t=W(e),_=a(t),r=0;r<_.gamepad_btns.length;r++)if(_.gamepad_btns[r])return r+300;return-1},t.get_moved_gmpd_axis=function(e){for(var t=W(e),_=a(t),r=0;r<_.gamepad_axes.length;r++)if(_.gamepad_prev_axes[r]-_.gamepad_axes[r])return r+326;return-1},t.get_first_gmpd_id=function(){for(var e=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],t=0;t<e.length;t++)if(e[t])return t;return 0},t.get_webvr_display=function(){var e=a(ce);return e&&e.webvr_display},t.activate_pointerlock=function(e){var t=e.element,_=function(t){e.value||Z(e)};t.addEventListener("mousedown",_,!1)},t.add_click_listener=function(e,t){ae.is_mobile_device?e.addEventListener("touchend",t):e.addEventListener("mouseup",t)},t.remove_click_listener=function(e,t){ae.is_mobile_device?e.removeEventListener("touchend",t):e.removeEventListener("mouseup",t)},t.check_fullscreen=$}var a=_(0),n=_(35),o=_(15),i=_(4),s=_(21),E=_(1),c=_(6),l=_(9),T=_(2),d=_(3),u=_(7),f=Object(a.a)("__input",r);t.a=f},function(e,t,_){"use strict";function r(e,t){var _=Object(n.a)(e),r=Object(o.a)(e);t.get_canvas=_.get_canvas,t.get_canvas_hud=_.get_canvas_hud,t.get_container=_.get_container,t.insert_to_container=function(e,t){if(2!=arguments.length)return void r.error("insert_to_container(): two arguments required");e&&t&&_.insert_to_container(e,t)},t.set_canvas_offsets=function(e,t){return r.error_once("container.set_canvas_offsets() deprecated. Not needed anymore. Use the container.client_to_canvas_coords method."),_.set_canvas_offsets(e,t)},t.update_canvas_offsets=function(){r.error_once("container.update_canvas_offsets() deprecated. Not needed anymore. Use the container.client_to_canvas_coords method."),_.update_canvas_offsets()},t.client_to_canvas_coords=function(e,t,r){return r||(r=new Float32Array(2)),_.client_to_canvas_coords(e,t,r)},t.client_to_element_coords=function(e,t,r,a){return a||(a=new Float32Array(2)),_.client_to_element_coords(e,t,r,a)},t.get_coords_target_space=function(e,t,r){return r||(r=new Float32Array(2)),_.get_coords_target_space(e,t,r)},t.force_offsets_updating=function(){r.error_once("container.force_offsets_updating() deprecated. Not needed anymore. Use the container.client_to_canvas_coords method."),_.force_offsets_updating()},t.resize=function(e,t,r){_.resize(e,t,r)},t.resize_to_container=function(e){e=e||!1,_.resize_to_container(e)}}var a=_(0),n=_(15),o=_(1),i=Object(a.a)("container",r);t.a=i},function(e,t,_){"use strict";function r(e,t){var _=Object(o.a)(e),r=Object(i.a)(e),a=Object(s.a)(e),d=Object(c.a)(e),u=l.b(),f=new Float32Array(3),P=new Float32Array(4);t.set_translation=function(e,t,n,o){_.is_dynamic(e)?(f[0]=t,f[1]=n,f[2]=o,d.set_translation(e,f),d.update_transform(e),r.sync_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_translation_rel=function(e,t,n,o){_.is_dynamic(e)?(f[0]=t,f[1]=n,f[2]=o,d.set_translation_rel(e,f),d.update_transform(e),r.sync_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_translation_v=function(e,t){_.is_dynamic(e)?(d.set_translation(e,t),d.update_transform(e),r.sync_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_translation_rel_v=function(e,t){_.is_dynamic(e)?(d.set_translation_rel(e,t),d.update_transform(e),r.sync_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_translation_obj_rel=function(e,t,n,o,i){if(_.is_dynamic(e)){f[0]=t,f[1]=n,f[2]=o;var s=l.j(i.render.world_tsr),E=l.g(i.render.world_tsr);T._62(f,1,E,s,f),d.set_translation(e,f),d.update_transform(e),r.sync_transform(e)}else a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.get_translation=function(e,t){return t||(t=new Float32Array(3)),d.get_translation(e,t),t},t.get_translation_rel=function(e,t){return t||(t=new Float32Array(3)),d.get_translation_rel(e,t),t},t.set_rotation=function(e,t,n,o,i){_.is_dynamic(e)?(P[0]=t,P[1]=n,P[2]=o,P[3]=i,d.set_rotation(e,P),d.update_transform(e),r.sync_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_rotation_rel=function(e,t,n,o,i){_.is_dynamic(e)?(P[0]=t,P[1]=n,P[2]=o,P[3]=i,d.set_rotation_rel(e,P),d.update_transform(e),r.sync_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_rotation_v=function(e,t){_.is_dynamic(e)?(d.set_rotation(e,t),d.update_transform(e),r.sync_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_rotation_rel_v=function(e,t){_.is_dynamic(e)?(d.set_rotation_rel(e,t),d.update_transform(e),r.sync_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.get_rotation_rel_v=function(e,t){if(_.is_dynamic(e))return d.get_rotation_rel(e,t),t;a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.get_rotation=function(e,t){return t||(t=new Float32Array(4)),d.get_rotation(e,t),t},t.get_rotation_rel=function(e,t){return t||(t=new Float32Array(4)),d.get_rotation_rel(e,t),t},t.set_rotation_euler=function(e,t,n,o){_.is_dynamic(e)?(f[0]=t,f[1]=n,f[2]=o,d.set_rotation_euler(e,f),d.update_transform(e),r.sync_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.get_rotation_euler=function(e,t){return t||(t=new Float32Array(3)),d.get_rotation_euler(e,t),t},t.get_rotation_euler_rel=function(e,t){return t||(t=new Float32Array(3)),d.get_rotation_euler_rel(e,t),t},t.set_rotation_euler_rel=function(e,t,n,o){_.is_dynamic(e)?(f[0]=t,f[1]=n,f[2]=o,d.set_rotation_euler_rel(e,f),d.update_transform(e),r.sync_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_rotation_euler_v=function(e,t){_.is_dynamic(e)?(d.set_rotation_euler(e,t),d.update_transform(e),r.sync_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_rotation_euler_rel_v=function(e,t){_.is_dynamic(e)?(d.set_rotation_euler_rel(e,t),d.update_transform(e),r.sync_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_scale=function(e,t){_.is_dynamic(e)?(d.set_scale(e,t),d.update_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_scale_rel=function(e,t){_.is_dynamic(e)?(d.set_scale_rel(e,t),d.update_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.get_scale=function(e){return d.get_scale(e)},t.get_scale_rel=function(e){return d.get_scale_rel(e)},t.empty_reset_transform=function(e){if("EMPTY"!=e.type)return void a.error("Wrong object: "+e.name);for(var t=0;t<e.cons_descends.length;t++)if(!_.is_dynamic(e.cons_descends[t]))return void a.error('Wrong object: "'+e.cons_descends[t].name+'" is not dynamic.');d.set_translation(e,[0,0,0]),d.set_rotation(e,[0,0,0,1]),d.set_scale(e,1),d.update_transform(e),r.sync_transform(e)},t.get_object_size=function(e){return _.is_mesh(e)?d.get_object_size(e):(a.error("Wrong object: "+e.name),0)},t.get_object_center=function(e,t,r){return _.is_mesh(e)?(r||(r=new Float32Array(3)),d.get_object_center(e,t,r)):(a.error("Wrong object: "+e.name),null)},t.move_local=function(e,t,n,o){_.is_dynamic(e)?(d.move_local(e,t,n,o),d.update_transform(e),r.sync_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.rotate_x_local=function(e,t){if(_.is_dynamic(e)){var n=E.setAxisAngle(T.d,t,P);d.rotate_local(e,n),d.update_transform(e),r.sync_transform(e)}else a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.rotate_y_local=function(e,t){if(_.is_dynamic(e)){var n=E.setAxisAngle(T.b,t,P);d.rotate_local(e,n),d.update_transform(e),r.sync_transform(e)}else a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.rotate_z_local=function(e,t){if(_.is_dynamic(e)){var n=E.setAxisAngle(T.f,t,P);d.rotate_local(e,n),d.update_transform(e),r.sync_transform(e)}else a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.get_object_bounding_box=function(e){return n.n(e.render.bb_world)},t.set_tsr=function(e,t){_.is_dynamic(e)?(d.set_tsr(e,t),d.update_transform(e),r.sync_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_tsr_rel=function(e,t){_.is_dynamic(e)?(d.set_tsr_rel(e,t),d.update_transform(e),r.sync_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.get_tsr=function(e,t){return t||(t=new Float32Array(8)),d.get_tsr(e,t),t},t.get_tsr_rel=function(e,t){return t||(t=new Float32Array(8)),d.get_tsr_rel(e,t),t},t.distance=function(e,t){return d.distance(e,t)},t.set_matrix=function(e,t){_.is_dynamic(e)?(l.d(t,u),d.set_tsr(e,u),d.update_transform(e),r.sync_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_matrix_rel=function(e,t){_.is_dynamic(e)?(l.d(t,u),d.set_tsr_rel(e,u),d.update_transform(e),r.sync_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.get_matrix=function(e,t){return t||(t=new Float32Array(16)),d.get_tsr(e,u),l.v(u,t),t},t.get_matrix_rel=function(e,t){return t||(t=new Float32Array(16)),d.get_tsr_rel(e,u),l.v(u,t),t}}var a=_(0),n=_(25),o=_(8),i=_(19),s=_(1),E=_(9),c=_(13),l=_(6),T=_(2),d=Object(a.a)("transform",r);t.a=d},function(e,t,_){"use strict";function r(e,t){return t=t||new Float32Array(3),t[0]=e[3],t[1]=e[4],t[2]=e[5],t}function a(e,t){return t=t||new Float32Array(3),Z.copy(e,t)}function n(e,t){Z.copy(t,e)}function o(e,t){Z.normalize(t,$),e[3]=$[0],e[4]=$[1],e[5]=$[2]}function i(e,t,_){return _=_||new Float32Array(3),_[0]=e[0]+e[3]*t,_[1]=e[1]+e[4]*t,_[2]=e[2]+e[5]*t,_}function s(e,t){t[0]=0,t[1]=0,t[2]=0;for(var _=0;_<e.length;_+=3)t[0]+=e[_],t[1]+=e[_+1],t[2]+=e[_+2];return Z.scale(t,3/e.length,t)}function E(e,t,_){for(var r=0;r<_.length;r++)_[r]=0;for(var r=0;r<e.length;r+=3){var a=e[r]-t[0],n=e[r+1]-t[1],o=e[r+2]-t[2];_[0]+=a*a,_[1]+=a*n,_[2]+=a*o,_[4]+=n*n,_[5]+=n*o,_[8]+=o*o}_[3]=_[1],_[6]=_[2],_[7]=_[5];for(var r=0;r<_.length;r++)_[r]*=3/e.length;return _}function c(e,t,_){var r=J.copy(e,ee);if(T(r)<t)return J.identity(_);var a=l(r,te),n=J.transpose(a,_e);J.multiply(r,n,re),J.multiply(a,re,r);for(var o=J.copy(a,_),i=1;t<=T(r)&&i<ae;)a=l(r,te),n=J.transpose(a,_e),J.multiply(r,n,re),J.multiply(a,re,r),J.multiply(a,o,o),i++;return o}function l(e,t){for(var _=e[1],r=1,a=2;a<e.length;a++)4!=a&&8!=a&&Math.abs(e[a])>Math.abs(_)&&(_=e[a],r=a);for(var n=Math.floor(r/3),o=r%3,i=.5*Math.atan(2*_/(e[3*n+n]-e[3*o+o])),a=0;a<t.length;a++)t[a]=0==a||4==a||8==a?1:0;return t[o+3*n]=-Math.sin(i),t[n+3*o]=Math.sin(i),t[n+3*n]=Math.cos(i),t[o+3*o]=Math.cos(i),t}function T(e){return Math.sqrt(e[1]*e[1]+e[2]*e[2]+e[5]*e[5])}function d(e,t){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]}function u(e){return{content:[],score_function:e}}function f(e,t){e.content.push(t),P(e,e.content.length-1)}function P(e,t){for(var _=e.content[t];t>0;){var r=(t+1>>1)-1,a=e.content[r];if(!(e.score_function(_)<e.score_function(a)))break;e.content[r]=_,e.content[t]=a,t=r}}function A(e){var t=e.content[0],_=e.content.pop();return e.content.length>0&&(e.content[0]=_,p(e,0)),t}function S(e,t){P(e,e.content.indexOf(t))}function p(e,t){for(var _=e.content.length,r=e.content[t],a=e.score_function(r);;){var n=t+1<<1,o=n-1,i=null;if(o<_){var s=e.content[o],E=e.score_function(s);E<a&&(i=o)}if(n<_){var c=e.content[n];e.score_function(c)<(null===i?a:E)&&(i=n)}if(null===i)break;e.content[t]=e.content[i],e.content[i]=r,t=i}}function O(e,t,_,r){return _*e/r+t}function v(e,t,_,r){return _*(e/=r)*e+t}function m(e,t,_,r){return-_*(e/=r)*(e-2)+t}function N(e,t,_,r){return(e/=r/2)<1?_/2*e*e+t:-_/2*(--e*(e-2)-1)+t}function g(e,t,_,r){return _*(e/=r)*e*e+t}function R(e,t,_,r){return _*((e=e/r-1)*e*e+1)+t}function I(e,t,_,r){return(e/=r/2)<1?_/2*e*e*e+t:_/2*((e-=2)*e*e+2)+t}function b(e,t,_,r){return _*(e/=r)*e*e*e+t}function h(e,t,_,r){return-_*((e=e/r-1)*e*e*e-1)+t}function Y(e,t,_,r){return(e/=r/2)<1?_/2*e*e*e*e+t:-_/2*((e-=2)*e*e*e-2)+t}function L(e,t,_,r){return _*(e/=r)*e*e*e*e+t}function M(e,t,_,r){return _*((e=e/r-1)*e*e*e*e+1)+t}function x(e,t,_,r){return(e/=r/2)<1?_/2*e*e*e*e*e+t:_/2*((e-=2)*e*e*e*e+2)+t}function y(e,t,_,r){return-_*Math.cos(e/r*(Math.PI/2))+_+t}function U(e,t,_,r){return _*Math.sin(e/r*(Math.PI/2))+t}function w(e,t,_,r){return-_/2*(Math.cos(Math.PI*e/r)-1)+t}function C(e,t,_,r){return 0==e?t:_*Math.pow(2,10*(e/r-1))+t}function D(e,t,_,r){return e==r?t+_:_*(1-Math.pow(2,-10*e/r))+t}function F(e,t,_,r){return 0==e?t:e==r?t+_:(e/=r/2)<1?_/2*Math.pow(2,10*(e-1))+t:_/2*(2-Math.pow(2,-10*--e))+t}function G(e,t,_,r){return-_*(Math.sqrt(1-(e/=r)*e)-1)+t}function k(e,t,_,r){return _*Math.sqrt(1-(e=e/r-1)*e)+t}function K(e,t,_,r){return(e/=r/2)<1?-_/2*(Math.sqrt(1-e*e)-1)+t:_/2*(Math.sqrt(1-(e-=2)*e)+1)+t}function B(e,t,_,r){var a=1.70158,n=0,o=_;return 0==e?t:1==(e/=r)?t+_:(n||(n=.3*r),o<Math.abs(_)?(o=_,a=n/4):a=n/(2*Math.PI)*Math.asin(_/o),-o*Math.pow(2,10*(e-=1))*Math.sin((e*r-a)*(2*Math.PI)/n)+t)}function X(e,t,_,r){var a=1.70158,n=0,o=_;return 0==e?t:1==(e/=r)?t+_:(n||(n=.3*r),o<Math.abs(_)?(o=_,a=n/4):a=n/(2*Math.PI)*Math.asin(_/o),o*Math.pow(2,-10*e)*Math.sin((e*r-a)*(2*Math.PI)/n)+_+t)}function H(e,t,_,r){var a=1.70158,n=0,o=_;return 0==e?t:2==(e/=r/2)?t+_:(n||(n=r*(.3*1.5)),o<Math.abs(_)?(o=_,a=n/4):a=n/(2*Math.PI)*Math.asin(_/o),e<1?o*Math.pow(2,10*(e-=1))*Math.sin((e*r-a)*(2*Math.PI)/n)*-.5+t:o*Math.pow(2,-10*(e-=1))*Math.sin((e*r-a)*(2*Math.PI)/n)*.5+_+t)}function j(e,t,_,r,a){return void 0==a&&(a=1.70158),_*(e/=r)*e*((a+1)*e-a)+t}function Q(e,t,_,r,a){return void 0==a&&(a=1.70158),_*((e=e/r-1)*e*((a+1)*e+a)+1)+t}function z(e,t,_,r,a){return void 0==a&&(a=1.70158),(e/=r/2)<1?_/2*(e*e*((1+(a*=1.525))*e-a))+t:_/2*((e-=2)*e*((1+(a*=1.525))*e+a)+2)+t}function V(e,t,_,r){return _-q(r-e,0,_,r)+t}function q(e,t,_,r){return(e/=r)<1/2.75?_*(7.5625*e*e)+t:e<2/2.75?_*(7.5625*(e-=1.5/2.75)*e+.75)+t:e<2.5/2.75?_*(7.5625*(e-=2.25/2.75)*e+.9375)+t:_*(7.5625*(e-=2.625/2.75)*e+.984375)+t}function W(e,t,_,r){return e<r/2?.5*V(2*e,0,_,r)+t:.5*q(2*e-r,0,_,r)+.5*_+t}t.M=r,t.N=a,t.R=n,t.Q=o,t.f=i,t.g=s,t.e=E,t.L=c,t.P=d,t.a=u,t.c=f,t.b=A,t.d=S,t.O=O,t.x=v,t.H=m,t.t=N,t.k=g,t.E=R,t.q=I,t.y=b,t.I=h,t.u=Y,t.z=L,t.J=M,t.v=x,t.A=y,t.K=U,t.w=w,t.m=C,t.G=D,t.s=F,t.j=G,t.D=k,t.p=K,t.l=B,t.F=X,t.r=H,t.h=j,t.B=Q,t.n=z,t.i=V,t.C=q,t.o=W;var J=_(27),Z=_(3),$=new Float32Array(3),ee=new Float32Array(9),te=new Float32Array(9),_e=new Float32Array(9),re=new Float32Array(9),ae=100},function(e,t,_){"use strict";function r(e,t){function _(e,t){R_[t.id]=null,I_[t.id]=null}function r(e,t,_,r){var a,n;if(e instanceof ArrayBuffer){var o=Vt.get_width_height(e,r);a=o.width,n=o.height}else a=e.width,n=e.height;var i;i=a>2048||n>2048?"a00":a>1024||n>1024?"aa0":"0a0",i_.log("%cLOAD IMAGE "+a+"x"+n,"color: #"+i,t),-1==t.indexOf(b_)&&_&&i_.warn("image",t,"is not from app root.")}function a(e,t,_,r){if(r==Xt.AT_VIDEO_ELEMENT)var a=e.videoWidth,n=e.videoHeight;else var a=e.images[0].width,n=e.images[0].height;var o;o=a>2048||n>2048?"a00":a>1024||n>1024?"aa0":"0a0",i_.log("%cLOAD VIDEO "+a+"x"+n,"color: #"+o,t),-1==t.indexOf(b_)&&_&&i_.warn("video",t,"is not from app root.")}function j(e,t,_,r,a,n){var o=t.filepath;o||kt.panic("Nothing requested");var i=function(r,n,E,c){if(!r)return E==Xt.AT_JSON_ZIP?(i_.warn("Compressed file ",c,"not found or invalid. Trying to load non-compressed",o),void Xt.enqueue([{id:o,type:Xt.AT_JSON,url:o,is_fetch:t.is_preloading}],i,null,s)):void $t.abort_thread(t);i_.log("%cLOAD METADATA","color: #616",c),J(r);for(var l in r)e[l]=r[l];Q(t,e),V(e,t),z(e,t),t.is_preloading&&we(e),a(t,_)},s=function(e){n(t,_,e)};if(S_.assets_gzip_available)var E=o+".gz",c=Xt.AT_JSON_ZIP;else var E=o,c=Xt.AT_JSON;Xt.enqueue([{id:E,type:c,url:E,is_fetch:t.is_preloading}],i,null,s)}function Q(e,t){e.is_primary&&(h_=c_.find_main_scene(t.scenes));var _=t.binaries[0].binfile;_?e.binary_name=_:($t.skip_stage_by_name(e,"load_binaries"),$t.skip_stage_by_name(e,"prepare_bindata")),S_.is_mobile_device||$t.skip_stage_by_name(e,"mobile_media_start"),S_.antialiasing&&S_.smaa||$t.skip_stage_by_name(e,"load_smaa_textures")}function z(e,t){if(e.b4w_export_warnings)for(var _=0;_<e.b4w_export_warnings.length;_++){var r=e.b4w_export_warnings[_];(t.is_primary&&"PRIMARY"==r.type||"ALL"==r.type)&&i_.export_warn(r.text+" See more details in https://www.blend4web.com/doc/en/addon.html#other-messages")}}function V(e,t){if(e.b4w_export_errors)for(var _=0;_<e.b4w_export_errors.length;_++){var r=e.b4w_export_errors[_];(t.is_primary&&"PRIMARY"==r.type||"ALL"==r.type)&&i_.export_error(r.text+" See more details in https://www.blend4web.com/doc/en/addon.html#non-critical-export-errors")}}function q(e,t,_,r,a,n){var o=Ct(t.filepath)+t.binary_name;o||kt.panic("Binary data is missing");var i=function(r,n,E,c){if(!r)return E==Xt.AT_ARRAYBUFFER_ZIP?(i_.warn("Compressed file ",c,"not found or invalid. Trying to load non-compressed",o),void Xt.enqueue([{id:o,type:Xt.AT_ARRAYBUFFER,url:o,is_fetch:t.is_preloading}],i,null,s)):void $t.abort_thread(t);i_.log("%cLOAD BINARY","color: #616",c),e.bin_data=r,$(r,e),a(t,_)},s=function(e){n(t,_,e)};if(S_.assets_gzip_available)var E=o+".gz",c=Xt.AT_ARRAYBUFFER_ZIP;else var E=o,c=Xt.AT_ARRAYBUFFER;Xt.enqueue([{id:E,type:c,url:E,is_fetch:t.is_preloading}],i,null,s)}function W(e,t,_,r,a,n){T_.check_shaders_loaded()&&a(t,_)}function J(e){var t=K._57(e.b4w_format_version);switch(K._69(t,S_.min_format_version)){case-1:t[0]<S_.min_format_version[0]?kt.panic("JSON version is too old relative to B4W engine: "+K._70(t)+", required: "+K._70(S_.min_format_version)+". Reexport scene with the latest B4W addon to fix it."):i_.warn("JSON version is a bit old relative to B4W engine: "+K._70(t)+", required: "+K._70(S_.min_format_version)+". Some compatibility issues can occur. Reexport scene with the latest B4W addon to fix it.");break;case 1:t[0]>S_.min_format_version[0]?kt.panic("B4W engine version is too old relative to JSON. Can't load the scene. Update your engine version to fix it."):i_.error("B4W engine version is a bit old relative to JSON. Some compatibility issues can occur. Update your engine version to fix it.")}S_.loaded_data_version=t}function Z(e,t,_,r,a,n){var o=e.bin_data,i=e.binaries[0],s=e.objects,E=e.meshes,c=e.actions,l=K.K();te(o,i,E,l,B_),re(o,i,s,l,B_),ae(o,i,c,l,B_),a(t,_)}function $(e,t){var _=ee(e),r=K._57(t.b4w_format_version);_[0]!=r[0]&&kt.panic("BIN version does not match to JSON version: "+K._70(_)+", required: "+K._70(S_.min_format_version)+". Couldn't load the scene. Reexport scene to fix it."),_[1]!=r[1]&&i_.warn("BIN version does not match to JSON version: "+ +K._70(_)+", required: "+K._70(S_.min_format_version)+". Some compatibility issues can occur. Reexport scene to fix it.")}function ee(e){return[new Uint32Array(e,4,1)[0],new Uint32Array(e,8,1)[0]]}function te(e,t,_,r,a){for(var n=["indices"],o=["position","texcoord","texcoord2","shade_tangs"],i=["normal","tangent"],s=["group"],E=["color"],c=0;c<_.length;c++)for(var l=_[c].submeshes,T=0;T<l.length;T++){for(var d in l[T]){var u=l[T][d][1];if(-1!=n.indexOf(d)){var f=l[T][d][0]*K.i+t.int+a;l[T][d]=oe(e,f,u,r)}else if(-1!=o.indexOf(d)){var f=l[T][d][0]*K.h+t.float+a;l[T][d]=ne(e,f,u,r)}else if(-1!=i.indexOf(d)){var f=l[T][d][0]*K.l+t.short+a;l[T][d]=ie(e,f,u)}else if(-1!=s.indexOf(d)){var f=l[T][d][0]*K.l+t.ushort+a;l[T][d]=se(e,f,u)}else if(-1!=E.indexOf(d)){var f=l[T][d][0]*K.g+t.uchar+a;l[T][d]=Ee(e,f,u)}}if(_e(_[c],l[T]),delete l[T].normal,delete l[T].tangent,"texcoord2"in l[T]){var P=new Float32Array(l[T].texcoord.length+l[T].texcoord2.length);P.set(l[T].texcoord),P.set(l[T].texcoord2,l[T].texcoord.length),l[T].texcoord=P,delete l[T].texcoord2}}}function _e(e,t){if(e.b4w_shape_keys.length){var _=t.base_length,r=t.normal.length/_/N_,a=t.normal.length/N_;t.tbn=C.d(t.normal.subarray(0,_*N_),t.tangent.subarray(0,_*g_),C.c(a));for(var n=1;n<r;n++)for(var o=n*_,i=0;i<_;i++){var s=t.normal.subarray(i*N_,(i+1)*N_),E=B.add(t.normal.subarray((o+i)*N_,(o+i+1)*N_),s,L_),c=C.i(y_);if(t.tangent.length){var l=t.tangent.subarray(i*g_,(i+1)*g_),T=X.add(t.tangent.subarray((o+i)*g_,(o+i+1)*g_),l,M_),d=C.d(s,l),u=C.d(E,T);C.l(u,d,c)}else{var f=Y.rotationTo(s,E,x_);C.o(c,f,0)}C.n(t.tbn,c,o+i)}}else t.tbn=C.d(t.normal,t.tangent)}function re(e,t,_,r,a){for(var n=0;n<_.length;n++)for(var o=_[n].particle_systems,i=0;i<o.length;i++){var s=o[i],E=s.transforms[0]*K.h+t.float+a,c=s.transforms[1];s.transforms=ne(e,E,c,r)}}function ae(e,t,_,r,a){for(var n=0;n<_.length;n++){var o=_[n],i=o.fcurves,s=o.frame_range,E=s[0],c=s[1],l=Bt.get_approx_curve_length(E,c),T=null;l<0&&(l=0);var d=!1,u=!1;for(var f in i)d|=f.indexOf("rotation_euler")>-1,u|=f.indexOf("rotation_quaternion")>-1;var P=[];for(var f in i)if(d&&u&&f.indexOf("rotation_euler")>-1)delete i[f];else{var A=i[f];for(var S in A){var p=A[S],O=t.float+p.bin_data_pos[0]*K.h+a,v=ne(e,O,p.bin_data_pos[1],r),m=new Float32Array(l);null===T&&(T=new Int8Array(l)),Bt.approximate_curve(p,v,m,T,E,c),p._pierced_points=m}f.indexOf("rotation_euler")>-1&&(Bt.fcurve_replace_euler_by_quat(i[f]),P.push(f))}for(var N=0;N<P.length;N++){var g=P[N];i[g.replace("euler","quaternion")]=i[g],delete i[g]}o._bflags=T}}function ne(e,t,_,r){if(r)var a=new Float32Array(e,t,_);else for(var a=new Float32Array(_),n=new DataView(e),o=0;o<_;o++)a[o]=n.getFloat32(t+o*K.h,!0);return a}function oe(e,t,_,r){if(r)var a=new Uint32Array(e,t,_);else for(var a=new Uint32Array(_),n=new DataView(e),o=0;o<_;o++)a[o]=n.getUint32(t+o*K.i,!0);return a}function ie(e,t,_){for(var r=new Float32Array(_),a=new DataView(e),n=0;n<_;n++)r[n]=a.getInt16(t+n*K.l,!0)/32767;return r}function se(e,t,_){for(var r=new Float32Array(_),a=new DataView(e),n=0;n<_;n++)r[n]=a.getUint16(t+n*K.l,!0)/65535;return r}function Ee(e,t,_){for(var r=new Float32Array(_),a=new DataView(e),n=0;n<_;n++)r[n]=a.getUint8(t+n*K.g)/255;return r}function ce(e){for(var t={},_=e.objects,r=0;r<_.length;r++){var a=_[r];if("MESH"===a.type&&!a.particle_systems.length)for(var n=a.data,o=n.name,i=n.submeshes,s=n.materials,E=0;E<i.length;E++)0!==i[E].base_length||t[o]||(s[E]&&i_.warn('material "'+s[E].name+'" is not assigned to any face (object "'+a.name+'").'),t[o]=!0)}}function le(e,t,_,r,a,n){He(e),s_.check_bpy_data(e),we(e),de(e,t),ce(e),Tt(e),dt(e.actions,t.id),ut(e),ue(e,t),Ne(e),Pe(e,t),Ae(e,t),Se(e),ge(e,t),m_&&i_.log("%cDEBUG BPYDATA:","color: #a0a",e),a(t,_)}function Te(e,t,_,r,a,n){for(var o=Ct(t.filepath),i=[],s=[],E=0;E<e.speakers.length;E++){var c=e.speakers[E],l=c.sound.uuid;if(-1==s.indexOf(l)){switch(s.push(l),c.b4w_behavior){case"POSITIONAL":case"BACKGROUND_SOUND":var T=Xt.AT_AUDIOBUFFER;break;case"BACKGROUND_MUSIC":var T=Xt.AT_AUDIO_ELEMENT}ot(i,l,T,Object(H.b)(o+c.sound.filepath),t.is_preloading)}}var d=function(){a(t,_)};i.length?Xt.enqueue(i,function(){},d):a(t,_)}function de(e,t){for(var _=Ct(t.filepath),r=e.textures,a=Ge(e,t),n=0;n<r.length;n++){var o=r[n];t.is_primary||"SCENE"!=o.b4w_source_type||(o.b4w_source_id="");var i=u_.create_texture_bpy(o,a,e.scenes,t.id,_);o._render=i}}function ue(e,t){if(!t.is_primary&&e.scenes.length>1&&(e.scenes=[c_.find_main_scene(e.scenes)],i_.warn("loading data contains multiple scenes.","Only the first one will be loaded.")),t.is_primary)var _=h_;else var _=c_.find_main_scene(e.scenes);if(f_.set_framerate(h_.fps),e.scenes.length>1){var r=e.scenes.indexOf(h_);e.scenes.splice(r,1),e.scenes.unshift(h_)}for(var a=0;a<e.scenes.length;a++){var n=e.scenes[a];if(n._render=c_.create_scene_render(),n._is_main=n==_,n._is_primary_thread=t.is_primary,O_.enabled){if("OFF"==n.b4w_enable_physics||"AUTO"==n.b4w_enable_physics&&!fe(n))continue;(t.is_primary||!o_.scene_has_physics(h_)&&n==c_.find_main_scene(e))&&o_.init_scene_physics(n)}}}function fe(e){for(var t=Oe(e,"ALL"),_=0;_<t.length;_++){if(t[_].b4w_collision)return!0;var r=t[_].data;if(r.materials)for(var a=0;a<r.materials.length;a++){var n=r.materials[a];if(n.physics_settings.use_coll_physics)return!0}}return!1}function Pe(e,t){for(var _=0;_<e.scenes.length;_++){for(var r=e.scenes[_],a=Oe(r,"ALL"),n=0;n<a.length;n++){var o=a[n];a_.check_bpy_obj_scene_compatibility(o,r,e)&&(o._scenes||(o._scenes=[]),o._scenes.push(t.is_primary?r:h_))}me(a)}Re(e,t);for(var i=be(t.id),_=0;_<i.length;_++){var o=i[_];if(!t.is_primary&&o.parent&&k_.indexOf(o.parent.type)>-1&&(o.parent=""),"MESH"==o.type){var s=s_.apply_mesh_modifiers(o);s&&(e.meshes.push(s),o.data=s)}o._def_action_slots=a_.get_bpy_def_action_slots(o,!1),o._is_dynamic=a_.bpy_obj_is_dynamic(o)}for(var _=0;_<i.length;_++){for(var o=i[_],E=o._is_dynamic,n=0;n<o.lod_levels.length;n++){var c=o.lod_levels[n].object;c&&(E=E||c._is_dynamic)}if(E){o._is_dynamic=!0;for(var n=0;n<o.lod_levels.length;n++){var c=o.lod_levels[n].object;c&&(c._is_dynamic=!0)}}}}function Ae(e,t){for(var _=0;_<e.scenes.length;_++){var r=e.scenes[_],a=r.world;a._scenes||(a._scenes=[]),a._scenes.push(t.is_primary?r:h_)}for(var n=[],_=0;_<e.worlds.length;_++){var a=e.worlds[_];a._scenes?(a._def_action_slots=a_.get_bpy_def_action_slots(a,!0),a._is_dynamic=a_.bpy_obj_is_dynamic(a)):n.push(a)}for(var _=0;_<n.length;_++){var a=n[_],o=e.worlds.indexOf(a);e.worlds.splice(o,1)}}function Se(e){for(var t=e.node_groups,_=e.materials,r=0;r<t.length;r++){var a=t[r],n=a.node_tree;if(n){var o=[];pe(n,o,!0),n._bsdf_types=o}}for(var r=0;r<_.length;r++){var i=_[r],n=i.node_tree;if(n){var o=[];pe(n,o,!1),n._bsdf_types=o}}}function pe(e,t,_){for(var r=e.nodes,a=0;a<r.length;a++){var n=r[a],o=n.type;if("GROUP"==o&&n.node_group){var i=n.node_group.node_tree;if(!i)continue;if(_)pe(i,t,!0);else for(var s=i._bsdf_types,E=0;E<s.length;E++){var c=s[E];-1==t.indexOf(c)&&t.push(c)}}else-1!=X_.indexOf(o)&&-1==t.indexOf(o)&&t.push(o)}}function Oe(e,t){t||(t="ALL");var _=[];return-1==e.objects.indexOf(e.camera)&&e.objects.push(e.camera),ve(e.objects,t,_),_}function ve(e,t,_){for(var r=0;r<e.length;r++){var a=e[r];"ALL"!=t&&t!=a.type||_.push(a);var n=a.dupli_group;if(n){ve(n.objects,t,_)}}}function me(e){for(var t=0;t<e.length;t++){var _=e[t];if(_._scenes&&"WORLD"!=_.type)for(var r=_.particle_systems,a=0;a<r.length;a++){var n=r[a].settings;if("HAIR"==n.type)if("OBJECT"==n.render_type){var o=n.dupli_object;o._scenes||(o._scenes=_._scenes.slice())}else if("GROUP"==n.render_type)for(var i=n.dupli_group,s=0;s<i.objects.length;s++){var o=i.objects[s];o._scenes||(o._scenes=_._scenes.slice())}}}}function Ne(e){for(var t=0;t<e.scenes.length;t++){var _=e.scenes[t];if(_.b4w_use_logic_editor){var r=Oe(_,"ALL"),a=_.world;s_.assign_logic_nodes_object_params(r,a,_)}}}function ge(e,t){for(var _=0;_<e.scenes.length;_++){var r=e.scenes[_],a=t.is_primary?r:h_;Boolean(he(t.id,a,"SPEAKER").length)&&!a._sfx&&l_.attach_scene_sfx(a)}}function Re(e,t){for(var _=e.scenes,r=[],a=0;a<_.length;a++){Ie(_[a].objects,0,t.is_primary,r)}I_[t.id]=[];for(var a=0;a<r.length;a++)for(var n=r[a],o=0;o<n.length;o++)for(var i=n[o],s=0;s<i.length;s++)I_[t.id].push(i[s]);for(var E=e.particles,a=0;a<E.length;a++){var c=E[a].dupli_object;c&&(c._is_hair_dupli=!0,I_[t.id].push(c));var l=E[a].dupli_group;if(l)for(var T=l.objects,o=0;o<T.length;o++)c=T[o],c._is_hair_dupli=!0,I_[t.id].push(c)}for(var d=I_[t.id],a=d.length-1;a>=0;a--)d[a]._scenes||d.splice(a,1)}function Ie(e,t,_,r){r[t]=r[t]||[];for(var a=r[t],n=0;n<e.length;n++){var o=e[n],i=Ft(o);a[i]=a[i]||[],(_||-1==k_.indexOf(o.type))&&-1==a[i].indexOf(o)&&a[i].push(o);var s=o.dupli_group;if(s){Ie(s.objects,t+1,_,r)}}}function be(e){return I_[e]}function he(e,t,_){for(var r=[],a=be(e),n=0;n<a.length;n++){var o=a[n];if(o.type==_||"ALL"==_)for(var i=0;i<o._scenes.length;i++)t==o._scenes[i]&&r.push(o)}return r}function Ye(e,t,_,r,a,n){for(var o=be(t.id),i=0;i<o.length;i++){var s=a_.create_object_from_bpy(o[i]);s.render.data_id=t.id}for(var E=e.worlds,i=0;i<E.length;i++)a_.create_object_from_bpy(E[i],!0);for(var c=a_.get_all_objects("ALL",t.id),i=0;i<o.length;i++){var l=o[i],s=l._object;e_.update_object(l,s)}for(var i=0;i<E.length;i++){var T=E[i],d=T._object;e_.update_object(T,d)}t.is_primary&&Le(e,t.id);for(var i=0;i<o.length;i++){var l=o[i],s=l._object;s.is_hair_dupli||(Qt.prepare_object_relations(l,s),a_.update_object_relations(l,s),P_.update_transform(s)),"MESH"==s.type&&a_.generate_mesh_render_boundings(l,s)}At(o),Ue(c),Pt(c),St(c),pt(c),a(t,_)}function Le(e,t){for(var _=0;_<e.scenes.length;_++){for(var r=e.scenes[_],a=a_.get_scene_objs(r,"LAMP",t),n=new Array(a.length),o=0;o<a.length;o++)n[o]=o;n.sort(function(e,t){var _=a[e].light,r=a[t].light;return!r.use_diffuse||!r.use_specular||_.use_diffuse&&_.use_specular?!_.use_diffuse&&(r.use_diffuse||!_.use_specular&&r.use_specular)?1:0:1});for(var o=0;o<n.length;o++){var i=a[n[o]];n_.get_scene_data(i,r).light_index=o}}}function Me(e,t,_,r,a,n){xe(e);for(var o=0;o<e.scenes.length;o++){var i=t.is_primary?e.scenes[o]:h_,s=t.is_primary?a_.get_scene_objs(i,"LAMP",t.id):a_.get_scene_objs(i,"LAMP",0),E=a_.get_scene_objs(i,"ALL",t.id),c=he(t.id,i,"MESH"),l=he(t.id,i,"EMPTY");t.is_primary&&c_.append_scene(i,E,s,c,l);for(var T=!1,d=0;d<l.length;d++)for(var u=l[d]._object,f=u.scenes_data,P=0;P<f.length;P++){var A=f[P].scene,S=c_.update_force_scene(A,u);i.name==A.name&&(T=T||S)}t.is_primary&&i._render.water_params&&!T&&i_.warn('Scene "'+i.name+'" has water but has no wind. Using default settings.');var p=[];c_.set_active(i),Ht.generate_main_batches(i,c,s,p);var O=a_.get_scene_objs(i,"LINE",t.id);Ht.generate_line_batches(i,O);var v=c_.get_graph(i);if(t.is_primary){var m=i._render.sky_params,N=i.world;if(m.render_sky||m.procedural_skydome){var g=N._object;Ht.append_sky_batch_to_world(i,m,g),Ht.create_forked_batches(g,v,i)}c_.generate_auxiliary_batches(i,v);var R=i._render.world_light_set;R&&(R.use_environment_light||R.ngraph_proxy_id)&&Ht.append_cube_sky_batch_to_world(i,N._object)}for(var d=0;d<c.length;d++)Ht.create_forked_batches(c[d]._object,v,i);for(var d=0;d<p.length;d++)Ht.create_forked_batches(p[d],v,i),a_.objects_storage_add(p[d]);E=a_.get_scene_objs(i,"ALL",t.id),c_.assign_scene_data_subs(i,E,s);for(var d=0;d<E.length;d++){var u=E[d];u.render.use_shape_keys&&!u.is_boundings_overridden&&a_.update_boundings(u),n_.check_inv_zup_tsr_is_needed(u)&&(u.need_inv_zup_tsr=!0),a_.update_lod_scene(u,i)}}c_.append_scene_vtex(h_,e.textures,t.id),t.is_primary&&h_._render.video_textures.length&&(t.has_video_textures=!0),a(t,_)}function xe(e){for(var t=0;t<e.scenes.length;t++){var _=e.scenes[t];_._camera=_.camera._object}}function ye(e,t){for(var _=0;_<e.scenes.length;_++){e.scenes[_].camera=null}}function Ue(e){for(var t=0;t<e.length;t++){var _=e[t];if("MESH"==_.type){var r=_.armobj;if(r){var a=r.render,n=_.render,o=n.bone_skinning_info,i=[];for(var s in o){var E=o[s],c=E.bone_index,l=E.deform_bone_index,T=4*l,d=4*c;i.push(T,d)}a.mesh_to_arm_bone_maps.push(i),a.skinned_renders.push(_.render)}}}}function we(e){var t=e.materials;if(Fe(e.images),(p_.dds_available&&"dds"==S_.compress_format||p_.pvr_available&&"pvr"==S_.compress_format)&&S_.use_compression)for(var _=0;_<t.length;_++){for(var r=t[_],a=r.texture_slots,n=0;n<a.length;n++){var o=a[n],i=o.texture;if("IMAGE"==i.type||"ENVIRONMENT_MAP"==i.type){var s=i.image;if(s&&!s._comp_method){var E=!i.b4w_disable_compression&&!o.use_map_normal&&"ENVIRONMENT_MAP"!=i.type&&!i.b4w_shore_dist_map&&"MOVIE"!=s.source;De(s,E)}}}var c=r.node_tree;if(c)for(var l=c.nodes,n=0;n<l.length;n++){var T=l[n],E=!1;if("TEXTURE"==T.type){var d=T.texture;if(d){var s=d.image;s&&!s._comp_method&&(E=!d.b4w_disable_compression&&"MOVIE"!=d.image.source&&"ENVIRONMENT_MAP"!=d.type&&!Ce(T))}}else if("TEX_IMAGE"==T.type){var s=T.image;s&&!s._comp_method&&(E="MOVIE"!=s.source)}else"TEX_ENVIRONMENT"==T.type&&(E=!1);s&&!s._comp_method&&De(s,E)}}}function Ce(e){for(var t=e.outputs,_=0;_<t.length;_++){var r=t[_];if(r.is_linked&&"Normal"==r.identifier)return!0}return!1}function De(e,t){e.filepath.indexOf(".dds")>-1?e._comp_method="dds":t?(e._comp_method=S_.compress_format,"dds"==S_.compress_format?e.filepath+=".dds":e.filepath+=".pvr"):e._comp_method=""}function Fe(e){for(var t=0;t<e.length;t++){var _=e[t],r=Boolean("FILE"==_.source&&_.filepath.indexOf(".dds")>-1&&"dds"==S_.compress_format);_._comp_method=r?"dds":""}}function Ge(e,t){return t.is_primary?e.scenes[0].b4w_anisotropic_filtering:h_.b4w_anisotropic_filtering}function ke(e,t,_,r,a,n){for(var o=e.groups,i=e.objects,s={},E={},c={},l={},T=0;T<o.length;T++){var d=o[T];s[d.uuid]=d,c[d.uuid]=d}for(var T=0;T<i.length;T++){var u=i[T];E[u.uuid]=u,l[u.uuid]=u}for(var f=e.scenes,T=0;T<f.length;T++){Ke(f[T].objects,null,l,c,null)}for(var P in c)P in s||o.push(c[P]);for(var P in l)P in E||i.push(l[P]);a(t,_)}function Ke(e,t,_,r,a){for(var n=[],o=0;o<e.length;o++){var i=e[o],s=_[i.uuid],E=s.proxy;if(E){t&&-1==n.indexOf(E.uuid)&&n.push(E.uuid);for(var c=_[E.uuid],l=c.constraints,T=0;T<l.length;T++){var d=K.O(l[T]);d.name=d.name+"_CLONE",s.constraints.push(d)}if(!("b4w_proxy_inherit_anim"in s)||s.b4w_proxy_inherit_anim){s.animation_data&&(c.animation_data=K.O(s.animation_data)),c.b4w_use_default_animation=s.b4w_use_default_animation,c.b4w_auto_skel_anim=s.b4w_auto_skel_anim,c.b4w_anim_behavior=s.b4w_anim_behavior,c.b4w_cyclic_animation=s.b4w_cyclic_animation}}}for(var o=0;o<n.length;o++){var u=n[o],f=K._9(e,"uuid",u);f>-1&&e.splice(f,1)}var P={};if(t)for(var o=0;o<e.length;o++){var i=e[o],s=_[i.uuid],A=K.O(s),S="origin_name"in s?s.origin_name:s.name;A.name=n_.gen_dupli_name(t.name,S),A.origin_name=S,A.dg_parent={uuid:t.uuid},Be(A),_[A.uuid]=A,P[i.uuid]=A.uuid,i.uuid=A.uuid,a&&a[s.uuid]&&(A.b4w_cluster_data=a[s.uuid])}for(var o=0;o<e.length;o++){var i=e[o],s=_[i.uuid];if(s.dupli_group){var p=s.dupli_group,O=r[p.uuid],v=K.O(O);v.name=qt.unique_name(O.name+"_CLONE"),Xe(v),r[v.uuid]=v,p.uuid=v.uuid;Ke(v.objects,s,_,r,s.b4w_cluster_data)}}if(t)for(var o=0;o<e.length;o++){var i=e[o],s=_[i.uuid];s.parent&&s.parent.uuid in P?s.parent.uuid=P[s.parent.uuid]:s.parent&&(i_.warn("Object's \""+s.name+'" parent is not in dupli group. Disabling parenting.'),s.parent=null);for(var l=s.constraints,T=0;T<l.length;T++){var m=l[T];m.target&&m.target.uuid in P&&(m.target.uuid=P[m.target.uuid])}var N=s.pose;if(N)for(var g=N.bones,T=0;T<g.length;T++){var R=g[T],I=R.constraints;if(I)for(var b=0;b<I.length;b++){var m=I[b];m.target&&m.target.uuid in P&&(m.target.uuid=P[m.target.uuid])}}for(var h=s.modifiers,T=0;T<h.length;T++){var Y=h[T];Y.object&&Y.object.uuid in P&&(Y.object.uuid=P[Y.object.uuid])}var L=s.lod_levels;if(L&&L.length)for(var T=0;T<L.length;T++){var M=L[T];M.object&&M.object.uuid in P&&(M.object.uuid=P[M.object.uuid])}}for(var x in P)Y_[x]=P[x]}function Be(e){e.uuid=O.a("Object"+e.name)}function Xe(e){e.uuid=O.a("Group"+e.name)}function He(e){var t=e.cameras,_=e.groups,r=e.materials,a=e.meshes,n=e.node_groups,o=e.objects,i=e.particles,s=e.scenes,E=e.speakers,c=e.lamps,l=e.textures,T=e.worlds;n||(i_.warn('"node_groups" datablock undefined. reexport main scene.'),n=e.node_groups=[]);for(var d=ze(e),u=0;u<s.length;u++){for(var f=s[u],P=f.objects,A=0;A<P.length;A++)Ve(P,A,d);f.camera&&Ve(f,"camera",d),f.world&&Ve(f,"world",d)}for(var u=0;u<_.length;u++)for(var S=_[u],p=S.objects,A=0;A<p.length;A++)Ve(p,A,d);for(var u=0;u<o.length;u++){var O=o[u];O.dupli_group&&Ve(O,"dupli_group",d),O.parent&&Ve(O,"parent",d),O.dg_parent&&Ve(O,"dg_parent",d);var v=O.animation_data;switch(v&&je(v,d),O.type){case"MESH":O.data||kt.panic("mesh not found for object "+O.name),Ve(O,"data",d);for(var m=!1,N=O.modifiers,A=0;A<N.length;A++){var g=N[A];"ARMATURE"==g.type?(m&&i_.warn('Object "'+O.name+'" has more than one armature modifiers. Only the first one will be used.'),m=!0,Ve(g,"object",d)):"CURVE"==g.type&&Ve(g,"object",d)}var R=O.particle_systems;if(R)for(var A=0;A<R.length;A++){var I=R[A];Ve(I,"settings",d)}break;case"ARMATURE":Ve(O,"data",d);for(var b=O.pose,h=b.bones,Y=O.data,L=Y.bones,A=0;A<h.length;A++){var M=h[A],x=M.bone,y=L[x];M.bone=y;var U=M.constraints;if(U)for(var w=0;w<U.length;w++){var C=U[w];C.target&&Ve(C,"target",d)}for(var D=M.parent_recursive,w=0;w<D.length;w++){var F=D[w];D[w]=h[F]}}break;case"LAMP":case"CAMERA":case"SPEAKER":case"CURVE":Ve(O,"data",d)}var U=O.constraints;if(U)for(var A=0;A<U.length;A++){var C=U[A];C.target&&Ve(C,"target",d)}var G=O.lod_levels;if(G)for(var A=0;A<G.length;A++){var k=G[A];k.object&&Ve(k,"object",d)}}for(var u=0;u<a.length;u++)for(var K=a[u],B=K.materials,A=0;A<B.length;A++)Ve(B,A,d);for(var u=0;u<r.length;u++){for(var X=r[u],H=X.texture_slots,A=0;A<H.length;A++)Ve(H[A],"texture",d);var j=X.node_tree;j&&Qe(j,d)}for(var u=0;u<n.length;u++){var Q=n[u],j=Q.node_tree;j&&Qe(j,d)}for(var u=0;u<l.length;u++){var z=l[u],V=z.type;"IMAGE"!=V&&"ENVIRONMENT_MAP"!=V||Ve(z,"image",d)}for(var u=0;u<t.length;u++){var q=t[u];q.dof_object&&Ve(q,"dof_object",d)}for(var u=0;u<E.length;u++){var W=E[u];W.sound&&Ve(W,"sound",d);var v=W.animation_data;v&&je(v,d)}for(var u=0;u<i.length;u++){for(var J=i[u],H=J.texture_slots,A=0;A<H.length;A++)Ve(H[A],"texture",d);J.dupli_group&&Ve(J,"dupli_group",d),J.dupli_object&&Ve(J,"dupli_object",d)}for(var u=0;u<c.length;u++){var Z=c[u],v=Z.animation_data;v&&je(v,d)}for(var u=0;u<T.length;u++){var $=T[u],H=$.texture_slots;if(H)for(var A=0;A<H.length;A++)Ve(H[A],"texture",d);var v=$.animation_data;v&&je(v,d);var j=$.node_tree;j&&Qe(j,d)}}function je(e,t){if(e.action&&Ve(e,"action",t),e.nla_tracks)for(var _=0;_<e.nla_tracks.length;_++)for(var r=e.nla_tracks[_],a=0;a<r.strips.length;a++)r.strips[a].action&&Ve(r.strips[a],"action",t)}function Qe(e,t){for(var _=e.nodes,r=0;r<_.length;r++){var a=_[r];"TEXTURE"==a.type&&a.texture&&Ve(a,"texture",t),"LAMP"==a.type&&a.lamp&&(a.lamp.uuid in Y_&&(a.lamp.uuid=Y_[a.lamp.uuid]),t[a.lamp.uuid]||(a.lamp=null)),"GROUP"==a.type&&a.node_group&&Ve(a,"node_group",t),"TEX_IMAGE"!=a.type&&"TEX_ENVIRONMENT"!=a.type||!a.image||Ve(a,"image",t)}for(var n=e.links,r=0;r<n.length;r++){var o=n[r];qe(o,"from_node",_),qe(o,"to_node",_),We(o,"from_socket",o.from_node.outputs),We(o,"to_socket",o.to_node.inputs)}var i=e.animation_data;i&&je(i,t)}function ze(e){for(var t=["actions","armatures","cameras","curves","groups","images","lamps","materials","meshes","node_groups","objects","particles","scenes","sounds","speakers","textures","worlds"],_={},r=0;r<t.length;r++)for(var a=e[t[r]],n=0;n<a.length;n++){var o=a[n];_[o.uuid]=o}return _}function Ve(e,t,_){if(e[t]){var r=_[e[t].uuid];r||i_.error("Dangling link found:",t,e),e[t]=r}}function qe(e,t,_){var r=e[t],a=K._18("name",r.name,_);e[t]=a}function We(e,t,_){var r=e[t],a=K._18("identifier",r.identifier,_);e[t]=a}function Je(e,t,_,n,o,i){for(var s=[],E=[],c={},l=e.images,T=u_.get_img_textures(),d=Ct(t.filepath),u=0;u<l.length;u++){var f=l[u],P=f.uuid;if(P){var A=Object(H.b)(d+f.filepath),S=Xt.split_extension(A),p=S[1].toLowerCase(),O=f.source;if("FILE"===O){if(f._comp_method)var v=Xt.AT_ARRAYBUFFER;else var v=Xt.AT_IMAGE_ELEMENT;if(!Xt.check_image_extension(p)){i_.error('image "'+f.name+'" has unsupported format or broken path.');continue}p_.min50_available&&S_.use_min50&&(A=tt(S))}else{if("MOVIE"!==O){i_.error('Image "'+f.name+'" has unsupported format "'+O+'".');continue}if(S_.seq_video_fallback){A=S[0]+".altconv.seq";var v=Xt.AT_SEQ_VIDEO_ELEMENT}else{var m=l_.detect_video_container(p);if(""==m){i_.error("failed to load video file (unsupported format)",A);continue}A=m!=p?S[0]+".altconv."+m:S[0]+"."+S[1];var v=Xt.AT_VIDEO_ELEMENT}}P in c||(c[P]=[]);for(var N=0;N<T.length;N++){var g=T[N];(!u_.get_cache_loaded_status(g)&&g.img_comp_method==f._comp_method&&g.img_uuid==P||t.is_preloading)&&c[P].push(g)}f._comp_method&&S_.assets_gzip_available&&(v=Xt.AT_ARRAYBUFFER_ZIP,A+=".gz"),c[P].length&&s.push({id:P,type:v,url:A,is_fetch:t.is_preloading})}}if(s.length){var R=0,I=function(n,o,l,T){if(n){if(t.is_preloading)var d=l;else{for(var u=c[o],f=0;f<u.length;f++){var P=u[f];if(l==Xt.AT_SEQ_VIDEO_ELEMENT)P.seq_fps=n.fps,u_.update_texture(P,n.images,t.id);else if(u_.update_texture(P,n,t.id),"ENVIRONMENT_MAP"==P.source&&t.is_primary)for(var A=0;A<e.scenes.length;A++)c_.update_world_texture(e.scenes[A]);u_.set_cache_loaded_status(P,!0)}var d=u[0].img_comp_method}l==Xt.AT_VIDEO_ELEMENT||l==Xt.AT_SEQ_VIDEO_ELEMENT?a(n,T,!0,l):r(n,T,!0,d)}else{var S=Ze(o,T,t.is_preloading,c);S&&(i_.warn("Trying to load fallback image",S.url),E.push(S))}var p=++R/(s.length+E.length);i(t,_,p)},b=function(){E.length?(Xt.enqueue(E,I,b),E.length=0):(i_.log("%cLOADED ALL IMAGES","color: #0a0"),o(t,_))};Xt.enqueue(s,I,b)}else o(t,_)}function Ze(e,t,_,r){var a=$e(t),n=Xt.split_extension(a);if("gz"==n[1])var o=n[0],i=Xt.AT_ARRAYBUFFER;else if("dds"==n[1]||"pvr"==n[1]){var o=n[0],i=Xt.AT_IMAGE_ELEMENT;_t(r[e])}else{if(-1==a.indexOf(".min50"))return null;var o=et(a),i=Xt.AT_IMAGE_ELEMENT}return{id:e,type:i,url:o,is_fetch:_}}function $e(e){return e.split("?v")[0]}function et(e){var t=e.split(".min50");return t[0]+t[1]}function tt(e){if("dds"==e[1]){var t=Xt.split_extension(e[0]);return t[0]+".min50."+t[1]+".dds"}return e[0]+".min50."+e[1]}function _t(e){for(var t=0;t<e.length;t++)e[t].img_comp_method=""}function rt(e,t,_,r,a,n){for(var o=c_.get_rendered_scenes(),i=0;i<o.length;i++){var s=o[i];if(s.b4w_use_nla){var E=s.b4w_nla_cyclic;s.b4w_use_logic_editor&&(E=!1),e_.update_scene(s,E,t.id)}}a(t,_)}function at(e){for(var t=[],_=u_.get_img_textures(),r=0;r<_.length;r++){var a=_[r];a.uri===e&&t.push(a)}return t}function nt(e,t,_,r,a,n){for(var o=Ct(t.filepath),i=[],s={},E=a_.get_all_objects("ALL",t.id),c=0;c<E.length;c++){var l=E[c];if(it(l)){var T=l.sfx.uuid;if("BACKGROUND_MUSIC"==l_.get_spk_behavior(l)?(T=K._4(),t.has_background_music=!0):"NONE"!=l_.get_spk_behavior(l)&&S_.init_wa_context_hack&&(t.init_wa_context=!0),!(T in s)){s[T]=[];var d=Object(H.b)(o+l.sfx.filepath);switch(l_.source_type(l)){case l_.AST_ARRAY_BUFFER:var u=Xt.AT_AUDIOBUFFER;break;case l_.AST_HTML_ELEMENT:var u=Xt.AT_AUDIO_ELEMENT}ot(i,T,u,d,t.is_preloading)}s[T].push(l)}}if(i.length){var f=0,P=function(e,r,a,o){if(e){i_.log("%cLOAD SOUND","color: #0aa",o),-1==o.indexOf(b_)&&i_.warn("sound",o,"is not from app root.");for(var E=s[r],c=0;c<E.length;c++)l_.update_spkobj(E[c],e)}var l=++f/i.length;n(t,_,l)},A=function(){i_.log("%cLOADED ALL SOUNDS","color: #0aa"),a(t,_)};Xt.enqueue(i,P,A)}else a(t,_)}function ot(e,t,_,r,a){var n=Xt.split_extension(r),o=n[1].toLowerCase(),i=l_.detect_audio_container(o);""!=i?(r=i!=o?n[0]+".altconv."+i:n[0]+"."+n[1],e.push({id:t,type:_,url:r,is_fetch:a})):i_.error("failed to load audio file (unsupported format)",r)}function it(e){return n_.is_speaker(e)&&l_.source_type(e)!=l_.AST_NONE}function st(e,t,_){for(var r=a_.get_scene_objs(e,"SPEAKER",t),a=0;a<r.length;a++){var n=r[a];n_.is_speaker(n)&&((l_.is_autoplay(n)||_)&&l_.play_def(n))}}function Et(e,t){for(var _=e._render.video_textures,r=0;r<_.length;r++){var a=_[r]._render;e.b4w_use_nla&&_[r].b4w_nla_video||!_[r].use_auto_refresh||t==a.vtex_data_id&&(u_.reset_video(a),u_.play_video(a))}}function ct(e,t,_,r,a,n){e_.prepare(),a(t,_)}function lt(e,t,_,r,a,n){e_.start(),i_.log("%cSTART NLA","color: #0a0"),a(t,_)}function Tt(e){var t=[];e.materials=[];for(var _=e.meshes,r=0;r<_.length;r++){var a=_[r];if(0==a.materials.length){var n=p.b();a.materials.push(n),-1==t.indexOf(n.uuid)&&(t.push(n.uuid),e.materials.push(n))}else for(var o=0;o<a.materials.length;o++){var i=a.materials[o],s=p.c();p.d(i,s),a.materials[o]=s,-1==t.indexOf(s.uuid)&&(t.push(s.uuid),e.materials.push(s))}}}function dt(e,t){for(var _=0;_<e.length;_++){var r=e[_];r._data_id=t,Bt.append_action(r)}}function ut(e){for(var t={lod_parents:[],lod_levels_data:[]},_=e.scenes,r=0;r<_.length;r++)for(var a=_[r],n=_[r].objects,o=0;o<n.length;o++){var i=n[o];ft(a,n,i,null,t)}for(var r=0;r<t.lod_levels_data.length;r++)for(var s=t.lod_levels_data[r],o=0;o<s.old_lods.length;o++){var E=s.old_lods[o],c=s.new_lods[o],l=s.lod_levels[o],T=s.scene_arrays[o],d=s.objs_container_arrays[o];l.object=c;for(var u=0;u<d.length;u++)K.C(d[u],c);Ot(E,T)}}function ft(e,t,_,r,a){for(var n=_.lod_levels.length,o=0;o<n;o++){var i=_.lod_levels[o],s=i.object;if(s){var E=a.lod_parents.indexOf(_);if(-1==E){a.lod_parents.push(_);var c={old_lods:[],new_lods:[],lod_levels:[],scene_arrays:[],objs_container_arrays:[]};a.lod_levels_data.push(c)}else var c=a.lod_levels_data[E];var l=c.old_lods.indexOf(s);if(-1!=E&&-1!=l)c.scene_arrays[l].push(e),c.objs_container_arrays[l].push(t);else{var T=K.N(s);T.name=_.name+"_LOD_"+String(o+1),T.b4w_cluster_data=_.b4w_cluster_data,Be(T),T.lod_levels=[],r&&(T.dg_parent=r),c.old_lods.push(s),c.new_lods.push(T),c.lod_levels.push(i),c.scene_arrays.push([e]),c.objs_container_arrays.push([t])}}}var d=_.dupli_group;if(d)for(var u=d.objects,f=0;f<u.length;f++){var P=u[f];ft(e,u,P,_,a)}}function Pt(e){for(var t=-1,_=-1,r=Bt.get_max_bones(),a=0;a<e.length;a++){var n=e[a],o=n.render;if(n_.is_mesh(n)&&o.is_skinning){var i=o.max_bones;i>t&&(t=i),r>=i&&i>_&&(_=i)}}for(var a=0;a<e.length;a++){var n=e[a],o=n.render;n_.is_mesh(n)&&o.is_skinning&&(o.frames_blending=!0,t<r?o.max_bones=t:o.max_bones<=r?o.max_bones=_:(i_.warn('too many bones for "'+n.name+'" / '+o.max_bones+" bones (max "+r+" with blending, "+2*r+" without blending). Blending between frames will be disabled."),o.max_bones=t,o.frames_blending=!1),o.frames_blending=o.frames_blending&&!A_.frames_blending_hack)}}function At(e){for(var t=0;t<e.length;t++){var _=e[t],r=_._object,a=r.render;if(n_.is_mesh(r)||n_.is_empty(r)){var n=_.lod_levels.length;if(n){for(var o=[_],i=[0],s=1/0,E=0;E<n;E++){var c=_.lod_levels[E].object,l=_.lod_levels[E].distance;if(!c){s=l;break}o.push(c),i.push(l)}i.push(s);for(var E=0;E<o.length;E++){var c=o[E],T=c._object,d=T.render;d.is_lod=!0,"DYNAMIC"==a.type&&E>0&&B.subtract(a.bs_world.center,d.bs_world.center,d.main_lod_offset),d.lod_dist_min=i[E],d.lod_dist_max=i[E+1];var u=0==E?0:i[E]-i[E-1],f=i[E+1]-i[E],P=E==o.length-1?1/0:i[E+2]-i[E+1];d.lod_lower_border_range=Math.min(u,f),d.lod_upper_border_range=Math.min(f,P)}}}}}function St(e){for(var t=0;t<e.length;t++){var _=e[t];if(_.is_vehicle){var r=_.vehicle_settings;if("CHASSIS"==r.part){_.vehicle={},_.vehicle.force_max=r.force_max,_.vehicle.brake_max=r.brake_max,_.vehicle.suspension_compression=r.suspension_compression,_.vehicle.suspension_stiffness=r.suspension_stiffness,_.vehicle.suspension_damping=r.suspension_damping,_.vehicle.wheel_friction=r.wheel_friction,_.vehicle.roll_influence=r.roll_influence,_.vehicle.max_suspension_travel_cm=r.max_suspension_travel_cm,_.vehicle.engine_force=0,_.vehicle.brake_force=1,_.vehicle.steering=0,_.vehicle.speed=0,_.vehicle.props=[],_.vehicle.prop_offsets=[],_.vehicle.steering_wheel=null;var a=n_.get_dg_parent(_);if(a)var n=n_.get_dg_objects(a,e);else var n=e;for(var o=0;o<n.length;o++){var i=n[o];if(i.is_vehicle){var s=i.vehicle_settings;if(o_.is_car_wheel(i)&&r.name==s.name){var E=o_.wheel_index(i.vehicle_settings.part);_.vehicle.props[E]=i,_.vehicle.prop_offsets[E]=new Float32Array(8)}else if(o_.is_vehicle_steering_wheel(i)&&r.name==s.name){_.vehicle.steering_wheel=i,_.vehicle.steering_max=s.steering_max,_.vehicle.steering_ratio=s.steering_ratio,_.vehicle.inverse_control=s.inverse_control;var c=k.o(_.render.world_tsr,k.b()),l=k.p(c,i.render.world_tsr,c);_.vehicle.steering_wheel_tsr=l;var T=new Float32Array([1,0,0]);k.w(T,l,T),_.vehicle.steering_wheel_axis=T}else if(o_.is_vehicle_speedometer(i)&&r.name==s.name){_.vehicle.speedometer=i,_.vehicle.speed_ratio=s.speed_ratio,_.vehicle.max_speed_angle=s.max_speed_angle;var c=k.o(_.render.world_tsr,k.b()),d=k.p(c,i.render.world_tsr,c);_.vehicle.speedometer_tsr=d;var u=new Float32Array([1,0,0]);k.w(u,d,u),_.vehicle.speedometer_axis=u}else if(o_.is_vehicle_tachometer(i)&&r.name==s.name){_.vehicle.tachometer=i,_.vehicle.delta_tach_angle=s.delta_tach_angle;var c=k.o(_.render.world_tsr,k.b()),f=k.p(c,i.render.world_tsr,c);_.vehicle.tachometer_tsr=f;var P=new Float32Array([1,0,0]);k.w(P,f,P),_.vehicle.tachometer_axis=P}}}4!=_.vehicle.props.length&&kt.panic("Not enough wheels for chassis "+_.name)}else if("HULL"==r.part){_.vehicle={},_.vehicle.props=[],_.vehicle.prop_offsets=[],_.vehicle.force_max=r.force_max,_.vehicle.brake_max=r.brake_max,_.vehicle.floating_factor=r.floating_factor,_.vehicle.water_lin_damp=r.water_lin_damp,_.vehicle.water_rot_damp=r.water_rot_damp,_.vehicle.engine_force=0,_.vehicle.brake_force=1,_.vehicle.steering=0,_.vehicle.speed=0,_.vehicle.steering_wheel=null;var a=n_.get_dg_parent(_);if(a)var A=n_.get_dg_objects(a,e);else var A=e;for(var o=0;o<A.length;o++){var i=A[o];if(i.is_vehicle){var s=i.vehicle_settings;if(o_.is_boat_bob(i)&&r.name==s.name)_.vehicle.props.push(i),_.vehicle.prop_offsets.push(new Float32Array(8));else if(o_.is_vehicle_steering_wheel(i)&&r.name==s.name){_.vehicle.steering_wheel=i,_.vehicle.steering_max=s.steering_max,_.vehicle.steering_ratio=s.steering_ratio,_.vehicle.inverse_control=s.inverse_control;var c=k.o(_.render.world_tsr,k.b()),l=k.p(c,i.render.world_tsr,c);_.vehicle.steering_wheel_tsr=l;var T=new Float32Array([1,0,0]);k.w(T,l,T),_.vehicle.steering_wheel_axis=T}else if(o_.is_vehicle_speedometer(i)&&r.name==s.name){_.vehicle.speedometer=i,_.vehicle.speed_ratio=s.speed_ratio,_.vehicle.max_speed_angle=s.max_speed_angle;var c=k.o(_.render.world_tsr,k.b()),d=k.p(c,i.render.world_tsr,c);_.vehicle.speedometer_tsr=d;var u=new Float32Array([1,0,0]);k.w(u,d,u),_.vehicle.speedometer_axis=u}else if(o_.is_vehicle_tachometer(i)&&r.name==s.name){_.vehicle.tachometer=i,_.vehicle.delta_tach_angle=s.delta_tach_angle;var c=k.o(_.render.world_tsr,k.b()),f=k.p(c,i.render.world_tsr,c);_.vehicle.tachometer_tsr=f;var P=new Float32Array([1,0,0]);k.w(P,f,P),_.vehicle.tachometer_axis=P}}}}}}}function pt(e){for(var t=0;t<e.length;t++){var _=e[t];if(_.is_floating){var r=_.floating_settings;if("MAIN_BODY"==r.part){_.floater={},_.floater.floating_factor=r.floating_factor,_.floater.water_lin_damp=r.water_lin_damp,_.floater.water_rot_damp=r.water_rot_damp,_.floater.bobs=[];var a=n_.get_dg_parent(_);if(a)var n=n_.get_dg_objects(a,e);else var n=e;for(var o=0;o<n.length;o++){var i=n[o];if(i.is_floating){var s=i.floating_settings;o_.is_floater_bob(i)&&r.name==s.name&&(_.floater.bobs.push(i),i.bob_synchronize_pos=i.floating_settings.synchronize_position)}}}}}}function Ot(e,t){for(var _=0;_<t.length;_++){for(var r=t[_].objects,a=0;a<r.length;a++){var n=r[a],o=n.dupli_group;o&&vt(e,o)}var i=r.indexOf(e);i>-1&&r.splice(i,1)}}function vt(e,t){var _=t.objects,r=_.indexOf(e);r>-1&&_.splice(r,1);for(var a=0;a<_.length;a++){t=_[a].dupli_group,t&&vt(e,t)}}function mt(e,t,_,r,a,n){for(var o=!0,i=0;i<e.scenes.length;i++){var s=e.scenes[i];if(!o_.check_worker_loaded(s)){o=!1;break}}o&&(a(t,_),i_.log("%cPHYSICS READY","color: #0a0"))}function Nt(e,t,_,r,a,n){for(var o=0;o<e.scenes.length;o++){var i=e.scenes[o];if(t.is_primary)var s=o_.scene_has_physics(i);else{var s=o_.scene_has_physics(h_)||o_.scene_has_physics(i);i=h_}if(O_.enabled&&s)for(var E=0;E<K_.length;E++)for(var c=K_[E],l=a_.get_scene_objs(i,c,t.id),T=0;T<l.length;T++){var d=l[T];d.render.data_id==t.id&&(o_.append_object(d,i),t.load_hidden&&o_.obj_has_physics(d)&&o_.disable_simulation(d))}}a(t,_)}function gt(e,t,_,a,n,o){for(var i={},s=[],E=e.scenes,c=0;c<e.scenes.length;c++){var l=E[c];if(l._render.water_params){var T=l._render.water_params.shoremap_image;if(T&&"FILE"===T.source){var d=T.uuid,u=Ct(t.filepath),f=Object(H.b)(u+T.filepath);if(T._comp_method)var P=Xt.AT_ARRAYBUFFER;else var P=Xt.AT_IMAGE_ELEMENT;s.push({id:d,type:P,url:f}),i[d]=T}}}if(s.length){var A=function(e,_,a,n){if(e){r(e,n,!0);for(var o=at(_),s=0;s<o.length;s++){var c=o[s];u_.update_texture(c,e,t.id)}for(var s=0;s<E.length;s++){var l=E[s];if(l._render.water_params){var d=l._render.water_params.shoremap_image;d===T&&Rt(e,T,l)}}}else for(var u=i[_],s=0;s<E.length;s++){var l=E[s],d=l._render.water_params.shoremap_image;d===u&&(l._render.water_params.shoremap_image=null,i_.warn("image",d.filepath," was not found. Disabling water shore effects."))}},S=function(){n(t,_)};Xt.enqueue(s,A,S)}else n(t,_)}function Rt(e,t,_){var r=document.createElement("canvas"),a=t.size[0],n=t.size[1];r.width=a,r.height=n;var o=r.getContext("2d");o.drawImage(e,0,0);var i=o.getImageData(0,0,a,n),s=i.data,E=new Float32Array(4);E[0]=1/16581375,E[1]=1/65025,E[2]=1/255,E[3]=1;for(var c=a*n,l=new Float32Array(c),T=0;T<c;T++)l[T]=E[1]*s[4*T+2]+E[2]*s[4*T+3];_._render.shore_distances=l}function It(e,t,_,a,n,o){for(var i=e.scenes[0],s=[],E=[d_.SMAA_EDGE_DETECTION,d_.SMAA_BLENDING_WEIGHT_CALCULATION,d_.SMAA_NEIGHBORHOOD_BLENDING,d_.SMAA_RESOLVE],c=0;c<E.length;c++){var l=c_.get_subs(i,E[c]);l&&s.push(l)}if(!s.length)return void n(t,_);var T=[],d=Xt.AT_IMAGE_ELEMENT,u=jt.paths.smaa_search_texture_path;T.push({id:"SEARCH_TEXTURE",type:d,url:u,is_fetch:t.is_preloading});var f=jt.paths.smaa_area_texture_path;T.push({id:"AREA_TEXTURE",type:d,url:f,is_fetch:t.is_preloading});for(var c=0;c<s.length;c++){var P=s[c];if(P.type==d_.SMAA_BLENDING_WEIGHT_CALCULATION){for(var A=P.slinks_internal,S=0;S<A.length;S++){var p=A[S];if("u_search_tex"==p.to)var O=p.texture;else if("u_area_tex"==p.to)var v=p.texture}break}}if(T.length){var m=function(e,_,a,n){if(e){if(r(e,n,!1),"SEARCH_TEXTURE"==_)var o=O;else var o=v;o.source="IMAGE",u_.update_texture(o,e,t.id),u_.set_filters(o,u_.TF_LINEAR,u_.TF_LINEAR)}},N=function(){n(t,_)};Xt.enqueue(T,m,N)}else n(t,_)}function bt(e,t,_,r,a,n){for(var o=0;o<e.scenes.length;o++){var i=e.scenes[o];t.is_primary||(i=h_);for(var s=a_.get_scene_objs(i,"LAMP",t.id),E=0;E<s.length;E++){var c=s[E];c.render.data_id==t.id&&r.added_objects.push({scene:i,obj:c})}for(var l=a_.get_scene_objs(i,"ALL",t.id),E=0;E<l.length;E++){var T=l[E];"LAMP"!=T.type&&(T.render.data_id==t.id&&(t.load_hidden&&n_.is_mesh(T)&&c_.change_visibility(T,!0),r.added_objects.push({scene:i,obj:T})))}}}function ht(e,t,_,r,a,n){var o=r.added_objects,i=r.obj_counter;if(o.length){var s=o[i].obj,E=o[i].scene,c=n_.get_scene_data(s,E);c_.append_object(E,s),!s.anchor||E._render.anaglyph_use||E._render.sidebyside_use||Kt.append(s);var l=++r.obj_counter/o.length;s.render.hide_children&&c_.change_visibility_rec(s,!0);var T=c.cube_refl_subs;if(-1!=s.render.cube_reflection_id&&T){var d=B.copy(s.render.bs_world.center,L_);c_.update_cube_reflect_subs(T,d)}var u=s.reflective_objs;if(u.length&&E._render.reflection_params)for(var f=k.j(s.render.world_tsr),P=k.g(s.render.world_tsr),A=c.plane_refl_subs,S=0;S<A.length;S++)c_.update_plane_reflect_subs(A[S],f,P),n_.update_refl_objects(u,A[S].camera.reflection_plane)}else var l=1;n(t,_,l)}function Yt(e,t,_,r,a,n){if(t.is_primary){var o=c_.get_main();c_.update_world_texture(o);for(var i=c_.get_rendered_scenes(),s=0;s<i.length;s++){var E=i[s];c_.update_world_texture(E),c_.prepare_rendering(E,o)}c_.set_active(o)}else c_.update_scene_permanent_uniforms(h_);var c=a_.get_all_objects("ALL",t.id);a_.update_objects_dynamics(c),a(t,_)}function Lt(e,t,_,r,a,n){if(t.is_primary)for(var o=c_.get_rendered_scenes(),i=0;i<o.length;i++)for(var s=o[i],E=a_.get_scene_objs(s,"WORLD",0),c=0;c<E.length;c++){var l=E[c];c_.init_cube_sky_dim(s,l),c_.update_world_texture(s)}a(t,_)}function Mt(e,t,_,r,a,n){if(t.is_primary)for(var o=c_.get_rendered_scenes(),i=0;i<o.length;i++){var s=o[i];s.b4w_use_logic_editor&&t_.init_logic(s,t.id)}a(t,_)}function xt(e,t,_,r,a,n){if(t.is_primary)for(var o=0;o<e.scenes.length;o++)Et(e.scenes[o],t.id),st(e.scenes[o],t.id,!1);else Et(h_,t.id),st(h_,t.id,!1);a(t,_)}function yt(e,t,_,r,a,n){ye(e,t),S_.media_auto_activation&&(t.has_video_textures||t.has_background_music||t.init_wa_context)?w_||Ut(e,a,t,_):a(t,_)}function Ut(e,t,_,r){var a=H_.parentElement;D_=a.style.zIndex,a.style.zIndex="999",w_=document.createElement("div"),w_.style.position="relative",w_.style.height="88px",w_.style.width="88px";var n=Math.round(H_.offsetHeight/2-44),o=Math.round(H_.offsetWidth/2-44);w_.style.top=n.toString()+"px",w_.style.left=o.toString()+"px",w_.style.backgroundImage="url('"+U_+"')",w_.style.backgroundSize="88px",C_=document.createElement("div"),C_.style.position="relative",C_.style.height=H_.offsetHeight.toString()+"px",C_.style.width=H_.offsetWidth.toString()+"px",C_.style.background="rgba(0, 0, 0, 0.5)",C_.style.zIndex="999",a.appendChild(C_),C_.appendChild(w_),G_=function(){if(_.has_video_textures&&(u_.play(),u_.pause(),u_.reset()),_.has_background_music){if(_.is_primary)for(var a=0;a<e.scenes.length;a++)st(e.scenes[a],_.id,!0);else st(h_,_.id,!0);l_.pause()}_.init_wa_context&&l_.play_empty_sound(),wt(),t(_,r)},Zt.add_click_listener(w_,G_)}function wt(){if(w_){var e=H_.parentElement;e.style.zIndex=D_,Zt.remove_click_listener(w_,G_),C_.removeChild(w_),e.removeChild(C_),C_=null,w_=null,D_=0}}function Ct(e){var t=e.split("/").slice(0,-1).join("/");return t&&(t+="/"),t}function Dt(e){Bt.is_animated(e)&&Bt.remove(e),__.remove_obj_from_cache(e),a_.clear_outline_anim(e),zt.check_sensor_manifold(e)&&zt.remove_sensor_manifold(e),o_.obj_has_physics(e)&&o_.remove_object(e),c_.remove_object_bundles(e),n_.is_speaker(e)&&l_.speaker_remove(e),Kt.is_anchor(e)&&Kt.remove(e)}function Ft(e){var t=Gt(e);return t?1+Ft(t):0}function Gt(e){var t=Bt.get_bpy_armobj(e);return t&&t.parent==e?null:e.parent||t}var kt=Object(i.a)(e),Kt=Object(n.a)(e),Bt=Object(o.a)(e),Xt=Object(s.a)(e),Ht=Object(E.a)(e),jt=Object(c.a)(e),Qt=Object(l.a)(e),zt=Object(T.a)(e),Vt=Object(d.a)(e),qt=Object(P.a)(e),Wt=Object(u.a)(e),Jt=Object(f.a)(e),Zt=Object(A.a)(e),$t=Object(S.a)(e),e_=Object(v.a)(e),t_=Object(m.a)(e),__=Object(N.a)(e),r_=Object(g.a)(e),a_=Object(R.a)(e),n_=Object(I.a)(e),o_=Object(b.a)(e),i_=Object(h.a)(e),s_=Object(L.a)(e),E_=Object(M.a)(e),c_=Object(x.a)(e),l_=Object(y.a)(e),T_=Object(U.a)(e),d_=Object(w.a)(e),u_=Object(D.a)(e),f_=Object(F.a)(e),P_=Object(G.a)(e),A_=jt.animation,S_=jt.defaults,p_=jt.assets,O_=jt.physics,v_=jt.sfx,m_=!1,N_=3,g_=4,R_=null,I_=null,b_="",h_=null,Y_={},L_=new Float32Array(3),M_=new Float32Array(4),x_=new Float32Array(4),y_=C.c(),U_="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALAAAACwCAYAAACvt+ReAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAbrwAAG68BXhqRHAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAABVDSURBVHic7Z15kF1Vncc/v05Ys7JIQJZ0GLaAgCzCQARGFMIwZKTiqCPBAbTEEodBhYKALJKSVWYsCpTBcgCLAdQBHWZACCCyhCElIRiWEMOSBZAkCglJOoTQyW/++J3Xfe95971+273v3fvOp6qr+5573+vT3d8+93vP+Z3fTwjUhKoKsC0wLvKxDTA68rEVMNK9ZDiwpft6PdDvvl4LvA+sBt5zn1cCy4EVwDJgpYhouj9RMZB2d6ATUdWtgD2BXvcxARgPbJ5RFzYAS4BFwGL38YqIvJ/R988NQcCAqm4LHADsA+yLibannX1KYBMm6JeBBcA8EVnZ3i61n64UsKoOAyYCh7iPCeTvd6HA68BcYA6wQEQ2trdL2ZO3P1rDqGoPsD9wNHAkMKqBt1nNoFctfV7j2ldj/rbPXdsvIuvd994S88QAIzCfHPXOHyHurRvt21PALOAFEdnUwHvkjsILWFV7gcnAUcDYWl8GvAEsZNCDLhKR91rfw4RvrjoWuyv0us97ALtS+99rFfAEMFNElqTRx06hkAJ2I94ngRMwXzsUmzCxzsP85csisja9HtaPqo7CbM9EzK/vRW1/vwXATODJ0h2hSBRKwO5hbAom3KFuw2uAZzD/+JyIrEm5ey1FVUcDB2Ee/hPU9vM+ANwnIu+m3L3MKISAVXU3YCrwNwx6zSTWArOBJ7Gn+P4q1+YGVR0OfByzSX+N+exKfAg8DtwtIm9m0L1UybWAVfWjwJcw4Vb6WRT4A3YbnV0U0VZCVTfDRDwZOJDKv5dNwGPAXSLydja9az25FLCqbg9MA44FhlW4bDXwIPYgszyrvnUSqrojJuRqlqof+C1wp4i8k1XfWkWuBKyqmwN/D3wRW7ZN4m3gfzHhfpBV3zoZNyofBXwem81I4gPgHsxabMiqb82SGwGr6lHAV7A50yQWA3cCT4c4gmRcPMeRwCnY0ngSK4BbRGRWZh1rgo4XsJtZOAvzdUm8CfwSeKxbJu+bxQl5EnAqsEuFy+YAPxKRP2fWsQboWAG7X/JJwGkMRnVFWQXcDjwchNsYbnVyMibkMQmXvA/8DLi/U+9qHSlg95B2HvCxhNP9wG+AO0SkL+F8oE7cws9UzCNvlnDJAuA6EVmWacdqoOMErKpHA98keS7zReAGEXkr2151B6q6C3A2sF/C6bWYpXgy215Vp2MErKpbYMI9NuF0H3ArNrPQkbeyouCs2wnA6SQPIo8AN3XKDE9HCFhVdwK+iwWv+DwLXF+k5c88oKrbAecAByecfh24shMsRdsFrKqHYn53pHdqAzYtdk8YdduDG40nA18DtvBOrwP+TURmZ96xCG0VsKp+DrtV+f1YDFwrIkuz7lOgHBeSej6wm38KmzP+deadcrRFwG765kxsmszncexBrXChf3nGzVScg63o+cwEftyOHSGZC9htmLwAONQ71Y/9N/9P1n0K1I6qngycQXkMyjPANVkPPJkKWFVHApcDe3un1mIPBc9n2Z9AY6jqgcBFlM9SLAAuy3J+PjMBu20yM4DdvVPLge+JyBtZ9SXQPC4G+zJsD1+U14BLs9p+lYmAXTzDFZRHQi0EZojIqiz6EWgtqroNcCmWQyPKUuDiLKY+Uxewqo4BrqL8CfZF4PKQrCPfuIe7S7Dg+ShvARekPTilKmBVHYGNvHt4p54FrshT3GmgMm4V9SJsf16URcBFae43TE3Abrbh+5Q/sM0Gri761p5uwwXNTwcO904twOxEKrMTqaRPcvO851Eu3uewqZYg3oIhIh9iVnGOd2ofYLrLhtRy0sr/dSbl/4nzMdvwYUrfM9Bm3MB0JfCCd+pQbFNCy2m5gN3ysL/CthCbWgmrawXHPdfMAF7xTk12iyAtpaUCVtXDsNiGKMuxqbIg3i7BzSzNwPbXRfmqC95qGS0TsKqOA75N/MGwjzDP25W41K+XYausA83AeS58tiW0RMCRucBo7oF+zPMWOrlcoDJudfUqIBrkMxK40KVIaJpWjcBnUR6MfkuIbQiIyDzgNq95d+AbrXj/pgWsqpMo3wb0eIgqC5Rw8cL+Xrrj3P7HpmhKwKr6EeBfvOYlwA3NvG+gkFyPxUhEOcvtQG+YhgXstpucSzykbgO2kyLMOARiOE1ci2XHLDES+I7TUkM0MwJPoTxvw63hoS1QCRFZjCVKiXIAcGKj79mQgJ11+LLX/BxwX6MdCXQN92K7N6Kc1qiVaHQE/ibx7JB9wA/D7uHAUDiN3MhgMRyArWlwqbluAbsskf5qyq0hb0OgVlwe4tu85sPcjFZd1CVgN/l8htf8IrYrNRCohwexAK8oX3OxxTVT7wg8FdghctyPbYEP1iFQF04zNzBYQxpge+Cz9bxPzQJ2qYb+wWu+NyTaCzSKW2q+32v+gttDWRP1jMDTiOfpXYUllg4EmuFOrJ5JiS2xDPI1UZOAXTWgT3vNt4f8vIFmcRq63Wv+jCtQMyS1jsCnEM/E8haWZjO3qOrDqrp/u/sRAGwSIFqzbjjwj7W8cEgBuwQWftDFfxagMvpngLmqerNbmAm0CVci4ude87GquvNQr61lBP6cd90SrCJ6ERiO7d/7o6pe0KoY1UBDPI5lJS3Rg2mvKlUF7J4Gj/Ga7yjgtNk2wNXAC6r6+XZ3phtxmvqF1/wpl/2nIkONwFOI1x7+E/B0/d3LDXsBvwz+uG08hRWqLLEZySl4B6goYLdN6ASv+b8LOPomEfxxG3Be+F6v+cRqq3PVRuCjie9xWwM82nj3ckfwx+3hYeLzwqNITqoNVBfw8d7xg10aqB78cYa46kd+bM3kStcnCtjVRNgn2gQ81Gznck7wx9kxE9NciYluOreMSiOwr/g/iMjbiVd2H8Efp4wr3+XvaPcdAZAgYJeYz/ccIVwyTvDH6ePf8Y9x2oyRNALvD4yNHPdhKVED5QR/nB5PY7XoSmwD7OtflCRgf9n4/0I61CEJ/rjFuCSB/sBZNhsRE7DL4XqEd01Rlo2zIPjj1uJrb5JvI/wReCIwOnK8GpiXQseKTPDHrWMutv5QYix2txvAF7Bf42BOsA8NE/xxkzjtzfWaYxr1BezvNvbTxQfqJ/jj5njWO45pdEDALuqnN3JuE5asJNAagj9ujGeJL2rs4YpmAvER+EDiyakXplkeqUsJ/rhOXMXP16JNRFKaRQU80XtteHhLj+CP68PX4sB8cE9So+Pl1LoTKBH8cW34WowL2BUlHB+5QIE/pt+vgCP44+rMJ+6DJ7h49YEReE/io/Ebwf9mTvDHFRCR1dhO+BLDcOWLS6Lt9V7j1/gKZEfwx8ks9I4nwKCAd/dOLkq9O4GhCP44jp84vRcqj8BBwJ1D8MeGr8legB5Xn8CPdg9lAjqL4I/jOSMAxquq9ADbAtFfyJpQWbNj6Vp/7BKoR3PxbQmM7QHGedcuy6xXgUbpVn+83DselyRg/6JA59Jt/tjX5g5BwPmnm/xx4gjs5576S0adCbSWbvDHK7zj7XqI78AAy7weyC9F9serveNRSQIOS8jFoIj+2Bfw6CDgYlM0f+xrc3QPVnC52kWB/FMUf+yPwCN7sBysUT7IqDOB7Mm7P97gHW+eJOCwC7n45NUff+gdb5YkYP+iQDHJoz9OFPBwrzGMwN1FnvxxooADgRLvt7sD9dJD+Yjrj8iBYrMSmA7sLyL3tbszQ1Bmd4djw/Lm3kX+016gePQDtwAXi8if292ZGqko4ChhBC4+jwDfFpEX292ROqlJwBVLGgVyz0Lg3BxYhUr4MyUbeihfeRtFoGjkyedWoyzsYTgJ68sZdSaQPnn0udVIFHBZhE9GnQmkS159bjV8bb4XBFw88u5zq+Hb27XDMX8UZfuMOhNoLSuBa4AfugIpRWQH7/id4ZTvM9oxo84EWkPRfG41fG0uTxKwr/JA51JEn1sNX5uJAg4jcOdTZJ9bjbId9D3Au8SD2EdFaxAEOoqizOfWjapuC4yINL0PvNcjIgos9a7vzapjgZroB34C7C0i1xT4Ia0aE7zjJSIyUPUwMfNfoCN4BDhIRL7eBQ9p1ej1jhfBYODOYu+kr/ZA9nSrz63EeO94CQwK2B+B90y9O4FKdMN8biPs5R0vhkEBvwJsxGoPAOyqqqNCnYxM6ab53LpQ1dHAzpGmjcCr4DK0i8h64jZCgH0y6l8g+Nyh2Jd4Ec7XnWZjlYkq1uIKpMZCYIqIHNdFixGN4GvxpdIX1QScx8QXeaFr53Mb5EDveECr0e1Dz2PF5EpD9d6qOsbVqg20huBz60RVxxCvoqUkjcAishJ4PXKhAB9Pu4NdRPC5jXEIcf/7SrSGi58XYm7CiwPNEXxuc/ganBM98AU8xzs+TFXDLuXGCD63SZz2fAHHBllfwAuI79AYSbAR9RLiFlrHwcTT/67CKzkbE7CIbASe8t7kk6l0rZgEn9tajvaOZ4nIpmhDUm60Wd7xEarqJ5QIxAk+t8W4bJmHec2+NhMF/DwWI1xiBHB467pWKILPTY8jga0jx+8SmT4rUSZgFx/sK/2ElnYt/wSfmz7HecdPOG3GqJRedaZ3fKCq7tSSbuWf4HNTRlV3BA7wmh9KujZRwCKyBJuRGGgCjm9J7/JL8LnZMZn44sV8EfF3DQGVR2AoH4VPUNUtm+1ZDgk+N0NUdQvKLauvxQGqCfgJ4nnTRgHHNt613BF8bns4jngGnjUkzD6UqChgEfkA+I3XPFVVu6EsQfC5bcBp67Ne831Oi4kMJcb7iecP3hE4orHu5YLgc9vLJCA6WbAB02BFqgpYRN4FHveap6mqJF2fY4LPbTNu9D3Fa340GnmWRC124G4guny3G+VLfHkl+NzO4Rhg18jxRuBXQ71oSAGLyJvAY17zNFUdlnB5nngAOCD43PbjRt8ves2/E5E/DfXaWh/I7iJejuuj5HxeWEROFBF/G1WgPZwI7BI57gd+XssLaxKwiLwN/NZrPlVVRyRdHwjUiqqOBKZ5zQ+LyLJaXl/PlNidwPrI8RjgS3W8PhBIYhrxed/12B2/JmoWsIi8gz3QRTlJVXdJuj4QGApV3Q34W6/5F272qybqXZT4FfF8wsOBbxVwWi2QMk4z/0x8Z/wy4N563qcuAbtpplu95n0I4ZaB+jmR8oQlP613KrPuZWERmQX83ms+XVW3q/e9At2Jqm4PnOY1zxaR2fW+V6NxDTcCfZHjEQQrEaiBiHWI7rZYB/x7I+/XkICdyb7daz4ImNLI+wW6ipOBQ72220TkL428WTORZfcDL3htp6tqbxPvGSgwqro78E9e8zxsVbQhGhaw25/0r8DaSPPmwPldGvgeqIKqbgWcD0R3uK/BEnmX7XWrlaZie92wf4PXvBtwbvDDgRJOC+cQXy4G+HGj1qFE08HpIvIUFgAe5QjKA5MD3ctUyhPkzBSRJ5t941btrriJeGZLgDNU1c/rGugyVPUgyn3vq8DNrXj/lgjYbfn4PvG8asOA74aHuu7FLRVPZ7D2CpjvvapVsdct298mIiuAHxAPft8auERVt2nV9wnkA1dZ83vEq2sqcJ2I+OWNG6alGzRF5DnKl5rHAZe6p9BAF6CqWwOXUV6c+6ci8mwrv1fLdxiLyK8Bf1/ZnsCMML1WfFxeh0uBv/JOPSgidQXq1EJaW+R/Avjr2hOBi13WwUABcQmpLwQ+5p2agz3ot5xUBOxyuF5HPD0VWLLsC0K61uLh/qYXUb5MPB+42uWebjmpLja4LUdXAHt4p54HZpSK1QXyjbMNF2PxMFEWAReKyNryV7WG1FfLXJnQq7EVuigvAZeLyLq0+xBID/dccwnltdzeBKYPldehWVJPEyUiq7H/Tj+74H7AFWGKLb+4qbJrKBfvUuCitMULGYzAJdzu0xmUVx1/BxuJ/ZW8QAfjFim+R/lU2WvApVkVyMw04MZ54sspLyTeB1wpIvOy7E+gMdzy8HTiixRgD2yXi0hf+avSIfOIMeeZLgA+4Z3aiC2C3NtMeF0gPVxU2VQstsHPzPR74NqsH8zbEvLoUgmdCZyUcHo2FiOa2X9xYGjcwPMtksuuPQjclNZUWTXaGrOrqicDX03ox1Lsv3lx5p0KlOF2UpxPeTzvJuA/0lhhq5W2B52r6gHYL2esd+pD4A7gnmAp2oOzDFOAM4jvpACLKvuBiPj1tTOl7QIGUNVx2CqOv34OVhv3epcZKJARbuv7OZQvToDNNFzZyqiyRukIAcNAZcZvUF4fDGyW4mfAA2E0Thc36v4d9qC2dcIlM4GbOyWXcscIuISqTgLOJl7kucR84AYReSPbXnUHbm73bCzwymcNcKPbQtYxdJyAYeD29R3Ki92B5Y69D7grzFS0BrfIdAqW7ml4wiXzsJmhpjZgpkFHChhqupWtxpKrPNSO6Zsi4LLsnwCcSjzFaYl1wG10sHXrWAGXcOvtX8cq2CSxHPgvTMibKlwTiOAGh0nAl4GdK1z2DPCjThx1o3S8gEs4b/wVbItSEkuxxMizOnW0aDduAWkSZhd2rXDZMmxu9+nMOtYEuREwDET8n4jd8pJsBdiIfC82Iod4YwaCzY8CvkD5YkSJ9Vj+57s7ZYahFnIl4BLOVkwDPk3yQwfYU/ODmJDfzqpvnYSq7oQVzp5MsscFeyh+GHsorjkzeqeQSwGXUNUdsTodn6JybLNiO0BmYjloczO6NIKbTz8SqyK1P5X/xhuB32HCbfuCRKPkWsAlXJ2OqZiQq+23W4cFC80C5opIf5Vrc4OzCAdhNuFwKtsrsCX6R7El+iHrsHU6hRBwCbe74yTMJ1e6ZZbow56052JiTn33QCtR1bHAwcAh2EbKoUqercFS4t6Xt5+1GoUScAm3yfAo7Dbq12FIfAmWr+t5bLXvZbcVqmNQ1THYCtm+2Bae3ant7zcfeAh4slrV97xSSAFHccujx2P1nbet9WXAW1j1+iVY4sIlWT3kuHoj44EJQC+WGKaecmbvAk9gGSALvexeeAGXcJP3+2Ej8yTKwzdroQ+bJ12BTdetwFYE10Q+r8PiZPtL03guGHw49qC5NWZvRkc+74DNb5c+GqmAugrz9rOAl7plLrxrBBzFTejvhXnHQ7C8FXn7XSjwCvCs+1jYjSuRefujpYLzl/tj/nIi5i/9PV/tZiNmZV7Gcmq8mNXO304mCDgBd8vfA/OfvZgXHQ9klZxwPbAY89+L3NevhpXFcoKA68BN05V86g7Adgz62NGYd90KG72Hua8B3sdG0H5MnH2YZy755ncY9NTLijTNlTb/Dz+sKh/f1rAbAAAAAElFTkSuQmCC",w_=null,C_=null,D_=0,F_=!1,G_=null,k_=["LAMP"],K_=["MESH","CAMERA","EMPTY"],B_=12,X_=["BSDF_PRINCIPLED","BSDF_GLOSSY","BSDF_DIFFUSE","BSDF_TRANSPARENT"],H_=null;t.is_primary_loaded=function(e){return $t.is_primary_loaded(e)},t.update=function(){$t.update_scheduler(R_)},t.setup_canvas=function(e){H_=e},t.update_media_controls=function(e,t){if(w_){C_.style.height=t.toString()+"px",C_.style.width=e.toString()+"px";var _=Math.round(t/2-44),r=Math.round(e/2-44);w_.style.top=_.toString()+"px",w_.style.left=r.toString()+"px"}},t.load=function(e,t,r,a,n){var o={load_main:{priority:$t.ASYNC_PRIORITY,background_loading:!1,inputs:[],is_resource:!1,relative_size:500,primary_only:!1,cb_before:j},duplicate_objects:{priority:$t.SYNC_PRIORITY,background_loading:!1,inputs:["load_main"],is_resource:!1,relative_size:50,primary_only:!1,cb_before:ke},load_binaries:{priority:$t.ASYNC_PRIORITY,background_loading:!1,inputs:["load_main"],is_resource:!1,relative_size:500,primary_only:!1,cb_before:q},wait_for_shaders:{priority:$t.SYNC_PRIORITY,background_loading:!1,inputs:[],is_resource:!1,relative_size:50,primary_only:!0,cb_loop:W},prepare_bindata:{priority:$t.SYNC_PRIORITY,background_loading:!1,inputs:["duplicate_objects","load_binaries"],is_resource:!1,relative_size:100,primary_only:!1,cb_before:Z},prepare_bpy_data:{priority:$t.SYNC_PRIORITY,background_loading:!1,inputs:["duplicate_objects","prepare_bindata"],is_resource:!1,relative_size:100,primary_only:!1,cb_before:le},process_objects:{priority:$t.SYNC_PRIORITY,background_loading:!1,inputs:["prepare_bpy_data"],is_resource:!1,relative_size:150,primary_only:!1,cb_before:Ye},process_scenes:{priority:$t.SYNC_PRIORITY,background_loading:!1,inputs:["process_objects","wait_for_shaders"],is_resource:!1,relative_size:300,primary_only:!1,cb_before:Me},load_smaa_textures:{priority:$t.ASYNC_PRIORITY,background_loading:!1,inputs:["process_scenes"],is_resource:!1,relative_size:30,primary_only:!0,cb_before:It},load_shoremap:{priority:$t.ASYNC_PRIORITY,background_loading:!1,inputs:["process_scenes"],is_resource:!1,relative_size:30,primary_only:!0,cb_before:gt},load_images:{priority:$t.ASYNC_PRIORITY,background_loading:!0,inputs:["process_scenes"],is_resource:!0,relative_size:500,primary_only:!1,cb_before:Je},update_scenes_nla:{priority:$t.SYNC_PRIORITY,background_loading:!1,inputs:["process_scenes","load_images"],is_resource:!1,relative_size:50,primary_only:!1,cb_before:rt},wait_physics_workers:{priority:$t.SYNC_PRIORITY,background_loading:!1,inputs:["load_shoremap"],is_resource:!1,relative_size:20,primary_only:!1,cb_loop:mt},add_physics_objects:{priority:$t.SYNC_PRIORITY,background_loading:!1,inputs:["wait_physics_workers"],is_resource:!1,relative_size:50,primary_only:!1,cb_before:Nt},add_objects:{priority:$t.SYNC_PRIORITY,background_loading:!1,inputs:["add_physics_objects"],is_resource:!1,relative_size:600,primary_only:!1,cb_before:bt,cb_loop:ht,cb_after:Yt,cb_param:{added_objects:[],obj_counter:0}},init_cube_sky_dynamic_props:{priority:$t.SYNC_PRIORITY,background_loading:!1,inputs:["add_objects","load_images"],is_resource:!1,relative_size:50,primary_only:!1,cb_before:Lt},init_logic_nodes:{priority:$t.SYNC_PRIORITY,background_loading:!1,inputs:["update_scenes_nla","add_objects"],is_resource:!1,relative_size:50,primary_only:!1,cb_before:Mt},load_speakers:{priority:$t.ASYNC_PRIORITY,background_loading:!0,inputs:["add_objects"],is_resource:!0,relative_size:100,primary_only:!1,cb_before:nt},mobile_media_start:{priority:$t.SYNC_PRIORITY,background_loading:!1,inputs:["load_images","update_scenes_nla","load_speakers","init_logic_nodes"],is_resource:!0,relative_size:5,primary_only:!1,cb_before:yt,cb_loop:yt},synchronize_media:{priority:$t.SYNC_PRIORITY,background_loading:!0,inputs:["mobile_media_start"],is_resource:!0,relative_size:50,primary_only:!1,cb_before:xt},prepare_nla:{priority:$t.SYNC_PRIORITY,background_loading:!1,inputs:["mobile_media_start"],is_resource:!1,relative_size:5,primary_only:!0,cb_before:ct},start_nla:{priority:$t.SYNC_PRIORITY,background_loading:!0,inputs:["prepare_nla"],is_resource:!1,relative_size:5,primary_only:!0,cb_before:lt}},i=$t.get_scheduler();return i||(i=$t.create_scheduler(),R_={},I_={},Y_={}),R_[i.threads.length]={},$t.create_thread(o,e,t,r,_,a||v_.audio_loading_hack,S_.do_not_load_resources,n,!1)},t.unload=function(e){var t=$t.get_scheduler();if(!t||!t.threads.length||e&&!$t.thread_is_finished(t.threads[e]))return void i_.error("Unable to unload data!");if(0==e)i_.log("%cUNLOAD ALL","color: #00a"),Kt.cleanup(),Bt.cleanup(),l_.cleanup(),Ht.cleanup(),c_.cleanup(),$t.cleanup(),zt.cleanup(),o_.cleanup(),a_.cleanup(),qt.cleanup(),E_.cleanup(),r_.cleanup(),T_.cleanup(),Jt.cleanup(),Xt.cleanup(),u_.cleanup(),t_.cleanup(),__.cleanup(),Zt.cleanup(),Wt.cleanup(),I_=null,Y_={},h_=null,R_=null,F_=!1;else{i_.log("%cUNLOAD DATA "+e,"color: #00a"),Bt.remove_actions(e);for(var _=a_.get_all_objects("ALL",a_.DATA_ID_ALL),r=0;r<_.length;r++){var a=_[r];n_.get_object_data_id(a)!=e&&a_.obj_switch_cleanup_flags(a,!1,!1,!1)}_=a_.get_all_objects("ALL",e);for(var r=_.length-1;r>=0;r--){var a=_[r];Dt(a),a_.remove_object(a)}_=a_.get_all_objects("ALL",a_.DATA_ID_ALL);for(var r=0;r<_.length;r++)a_.obj_switch_cleanup_flags(_[r],!0,!0,!0)}e_.cleanup(e),wt()},t.prepare_object_unloading=Dt,t.set_debug_resources_root=function(e){b_=e},t.activate_media=function(){F_||S_.media_auto_activation||(u_.play(),u_.pause(),u_.reset(),st(h_,a_.DATA_ID_ALL,!0),l_.pause(),S_.init_wa_context_hack&&l_.play_empty_sound(),F_=!0)},t.reset=function(){H_=null},t.prefetch=function(e,t,r){var a={load_main:{priority:$t.ASYNC_PRIORITY,background_loading:!1,inputs:[],is_resource:!1,relative_size:500,primary_only:!1,cb_before:j},load_binaries:{priority:$t.ASYNC_PRIORITY,background_loading:!1,inputs:["load_main"],is_resource:!1,relative_size:500,primary_only:!1,cb_before:q},load_images:{priority:$t.ASYNC_PRIORITY,background_loading:!1,inputs:["load_main"],is_resource:!1,relative_size:500,primary_only:!1,cb_before:Je},preload_sounds:{priority:$t.ASYNC_PRIORITY,background_loading:!1,inputs:["load_main"],is_resource:!1,relative_size:500,primary_only:!1,cb_before:Te}},n=$t.get_scheduler();return n||(n=$t.create_scheduler(),R_={},I_={},Y_={}),R_[n.threads.length]={},$t.create_thread(a,e,t,r,_,!1,S_.do_not_load_resources,!1,!0)},t.unfetch=function(){Xt.clear_cache()}}var a=_(0),n=_(55),o=_(37),i=_(5),s=_(43),E=_(16),c=_(4),l=_(58),T=_(53),d=_(70),u=_(45),f=_(28),P=_(30),A=_(38),S=_(65),p=_(74),O=_(92),v=_(52),m=_(59),N=_(47),g=_(61),R=_(12),I=_(8),b=_(19),h=_(1),Y=_(9),L=_(93),M=_(22),x=_(10),y=_(23),U=_(34),w=_(11),C=_(36),D=_(17),F=_(18),G=_(13),k=_(6),K=_(2),B=_(3),X=_(7),H=_(48),j=Object(a.a)("__data",r);t.a=j},function(e,t,_){"use strict";function r(e,t){function _(){return I.is_built_in_data()?b4w.require(I.paths.built_in_data_module).data:null}function r(){var e={_source_url:null,_parse_response:function(t){switch(e.responseType){case"json":case"text":return t;case"arraybuffer":for(var _=atob(t),r=_.length,a=new Int8Array(r),n=0;n<r;n++)a[n]=_.charCodeAt(n);return a.buffer;default:return t}},status:0,readyState:0,response:"",responseType:"",onreadystatechange:null,overrideMimeType:function(){},addEventListener:function(){},open:function(t,_,r){e._source_url=_,e.readyState=1},send:function(){e.status=404,e.readyState=4;var t=_();t&&e._source_url in t&&(e.status=200,t[e._source_url]&&(e.response=e._parse_response(t[e._source_url]))),"[object Function]"==={}.toString.call(e.onreadystatechange)&&e.onreadystatechange()}};return e}function a(e){for(var _=0,r=0;r<e.length;r++){var a=e[r];if(a.state===y&&_++,_>=M.max_requests)break;if(a.state===x)switch(a.state=y,_++,a.type){case t.AT_JSON_ZIP:case t.AT_ARRAYBUFFER:case t.AT_ARRAYBUFFER_ZIP:u(a,"arraybuffer");break;case t.AT_JSON:u(a,"json");break;case t.AT_TEXT:u(a,"text");break;case t.AT_AUDIOBUFFER:f(a);break;case t.AT_IMAGE_ELEMENT:P(a);break;case t.AT_AUDIO_ELEMENT:A(a);break;case t.AT_VIDEO_ELEMENT:S(a);break;case t.AT_SEQ_VIDEO_ELEMENT:p(a);break;default:R.panic("Wrong asset type: "+a.type)}}}function u(e,a){var n=e.url.split("?v=")[0];if(n in G)return void("json"==a?e.asset_cb(l.O(G[n]),e.id,e.type,e.url,e.param):e.asset_cb(G[n],e.id,e.type,e.url,e.param));var o=_();if(o&&e.url in o)var i=new r;else var i=new XMLHttpRequest;var E=null;if("GET"==e.request_method)i.open("GET",e.url,!0);else if("POST"==e.request_method)switch(i.open("POST",e.url,!0),e.type){case t.AT_TEXT:E="text/plain";break;case t.AT_JSON:E="application/json"}if(e.overwrite_header)for(var c in e.overwrite_header)"Content-Type"==c?E=e.overwrite_header[c]:i.setRequestHeader(c,e.overwrite_header[c]);E&&i.setRequestHeader("Content-Type",E),"text"==a?(i.overrideMimeType("text/plain"),i.responseType="text"):"json"==a?(i.overrideMimeType("application/json"),i.responseType="text"):i.responseType=a,i.onreadystatechange=function(){if(e.state!=w&&4==i.readyState){if(200==i.status||0==i.status){var _=i.response;if(!_||"arraybuffer"==a&&0==_.byteLength)h.error("empty responce when trying to get "+e.url),e.asset_cb(null,e.id,e.type,e.url,e.param);else{switch(e.type){case t.AT_JSON_ZIP:try{_=s.a(_,{to:"string"})}catch(t){return h.error(t+" (parsing gzipped file "+e.url+")"),void e.asset_cb(null,e.id,e.type,e.url,e.param)}case t.AT_JSON:try{_=JSON.parse(_,e.json_reviver)}catch(t){return h.error(t+" (parsing JSON "+e.url+")"),void e.asset_cb(null,e.id,e.type,e.url,e.param)}break;case t.AT_ARRAYBUFFER_ZIP:try{_=s.a(_).buffer}catch(t){return h.error(t+" (parsing gzipped file "+e.url+")"),void e.asset_cb(null,e.id,e.type,e.url,e.param)}}e.is_fetch&&(e.type==t.AT_JSON||e.type==t.AT_JSON_ZIP?G[n]=l.O(_):G[n]=_),e.asset_cb(_,e.id,e.type,e.url,e.param)}}else h.error(i.status+" when trying to get "+e.url),e.asset_cb(null,e.id,e.type,e.url,e.param);e.state=U}},i.addEventListener("progress",function(t){t.lengthComputable&&e.progress_cb(t.loaded/t.total)},!1),i.send(e.post_data)}function f(e){var t=e.url.split("?v=")[0];if(t in B)return e.asset_cb(B[t],e.id,e.type,e.url,e.param),void(e.state=U);"GET"!=e.request_method&&R.panic("Unsupported request type for audio buffer");var a=_();if(a&&e.url in a)var n=new r;else var n=new XMLHttpRequest;n.open("GET",e.url,!0),n.responseType="arraybuffer",n.onreadystatechange=function(){if(e.state!=w&&4==n.readyState)if(200==n.status||0==n.status){var t=n.response;if(t){var _=function(t){if(e.asset_cb(t,e.id,e.type,e.url,e.param),e.state=U,e.is_fetch){var _=e.url.split("?v=")[0];B[_]=t}},r=function(){h.error("failed to decode "+e.url),e.asset_cb(null,e.id,e.type,e.url,e.param),e.state=U};Y.decode_audio_data(t,_,r)}else h.error("empty responce when trying to get "+e.url),e.asset_cb(null,e.id,e.type,e.url,e.param),e.state=U}else h.error(n.status+" when trying to get "+e.url),e.asset_cb(null,e.id,e.type,e.url,e.param),e.state=U},n.send()}function P(e){var t=e.url.split("?v=")[0];if(t in k)return e.asset_cb(k[t],e.id,e.type,e.url,e.param),void(e.state=U);"GET"!=e.request_method&&R.panic("Unsupported request type for image element");var r=document.createElement("img");L.allow_cors&&(r.crossOrigin="Anonymous"),r.onload=function(){if(e.state!=w&&(e.asset_cb(r,e.id,e.type,e.url,e.param),e.state=U,e.is_fetch)){var t=e.url.split("?v=")[0];k[t]=r}},r.addEventListener("error",function(){e.state!=w&&(h.error("could not load image: "+e.url),e.asset_cb(null,e.id,e.type,e.url,e.param),e.state=U)},!1);var a=_();if(a&&e.url in a)if(a[e.url]){var n=v(e.url);r.src="data:"+n+";base64,"+a[e.url]}else{if(b.is_ie11()){var o=document.createEvent("CustomEvent");o.initCustomEvent("error",!1,!1,null)}else var o=new CustomEvent("error");r.dispatchEvent(o)}else r.src=e.url}function A(e){var t=e.url.split("?v=")[0];if(t in K)return e.asset_cb(K[t],e.id,e.type,e.url,e.param),void(e.state=U);"GET"!=e.request_method&&R.panic("Unsupported request type for audio element");var r=document.createElement("audio");L.allow_cors&&(r.crossOrigin="Anonymous"),r.addEventListener("loadeddata",function(){if(e.state!=w&&(e.asset_cb(r,e.id,e.type,e.url,e.param),e.state=U,e.is_fetch)){var t=e.url.split("?v=")[0];K[t]=r}},!1),r.addEventListener("error",function(){e.state!=w&&(h.error("could not load sound: "+e.url),e.asset_cb(null,e.id,e.type,e.url,e.param),e.state=U)},!1),r.addEventListener("stalled",function(){e.state!=w&&(h.error("could not load sound: "+e.url),e.asset_cb(null,e.id,e.type,e.url,e.param),e.state=U)},!1);var a=_();if(a&&e.url in a)if(a[e.url]){var n=m(e.url);r.src="data:"+n+";base64,"+a[e.url],e.state!=w&&(e.asset_cb(r,e.id,e.type,e.url,e.param),e.state=U)}else{if(b.is_ie11()){var o=document.createEvent("CustomEvent");o.initCustomEvent("error",!1,!1,null)}else var o=new CustomEvent("error");r.dispatchEvent(o)}else r.src=e.url,L.is_mobile_device&&r.load();L.mobile_firefox_media_hack&&(r.autoplay=!0,r.pause()),setTimeout(function(){r.some_prop_to_prevent_gc=1},5e3)}function S(e){function t(t){e.state!=w&&(h.error("could not load video: "+e.url,e.param),e.asset_cb(null,e.id,e.type,e.url),e.state=U)}var r=e.url.split("?v=")[0];if(r in k)return e.asset_cb(k[r],e.id,e.type,e.url,e.param),void(e.state=U);"GET"!=e.request_method&&R.panic("Unsupported request type for video element");var a=document.createElement("video");a.muted=!0,L.allow_cors&&(a.crossOrigin="Anonymous"),a.addEventListener("loadeddata",function(){if(a.removeEventListener("error",t,!1),e.state!=w&&(e.asset_cb(a,e.id,e.type,e.url,e.param),e.state=U,e.is_fetch)){var _=e.url.split("?v=")[0];k[_]=a}},!1),a.addEventListener("error",t,!1);var n=_();if(n&&e.url in n)if(n[e.url]){var o=N(e.url);a.src="data:"+o+";base64,"+n[e.url],e.state!=w&&a.addEventListener("loadeddata",function(){e.asset_cb(a,e.id,e.type,e.url,e.param),e.state=U},!1)}else{if(b.is_ie11()){var i=document.createEvent("CustomEvent");i.initCustomEvent("error",!1,!1,null)}else var i=new CustomEvent("error");a.dispatchEvent(i)}else a.src=e.url,L.is_mobile_device&&a.load();(L.mobile_firefox_media_hack||L.ipad_video_hack)&&(a.autoplay=!0,a.pause()),setTimeout(function(){a.some_prop_to_prevent_gc=1},1e4)}function p(e){function t(t){if(e.asset_cb(t,e.id,e.type,e.url,e.param),e.state=U,e.is_fetch){var _=e.url.split("?v=")[0];k[_]=t}}var a=e.url.split("?v=")[0];if(a in k)return e.asset_cb(k[a],e.id,e.type,e.url,e.param),void(e.state=U);"GET"!=e.request_method&&R.panic("Unsupported request type for seq video element");var n=_();if(n&&e.url in n)var o=new r;else var o=new XMLHttpRequest;o.open("GET",e.url,!0),o.responseType="arraybuffer",o.onreadystatechange=function(){if(e.state!=w&&4==o.readyState)if(200==o.status||0==o.status){var _=o.response;_?O(_,t):(h.error("empty responce when trying to get "+e.url),e.asset_cb(null,e.id,e.type,e.url,e.param),e.state=U)}else h.error(o.status+" when trying to get "+e.url),e.asset_cb(null,e.id,e.type,e.url,e.param),e.state=U},o.addEventListener("progress",function(t){t.lengthComputable&&e.progress_cb(t.loaded/t.total)},!1),o.send()}function O(e,t){for(var _=new Int32Array(e),r=new Int8Array(e),a=_[3],n={images:[],blobs:[],fps:_[4]},o=20,i=0;i<a;i++){var s=_[o/4],E=r.subarray(o+4,o+4+s),c=new Blob([E],{type:"image/jpg"}),l=document.createElement("img");l.src=window.URL.createObjectURL(c),n.images.push(l),n.blobs.push(c),o+=s+8-s%4}l.onload=function(){for(var e=0;e<n.images.length;e++)window.URL.revokeObjectURL(n.images[e].src);delete n.blobs,t(n)}}function v(e){var t=T.a(e),_="image";switch(t.toLowerCase()){case"jpeg":case"jpg":_+="/jpeg";break;case"png":_+="/png"}return _}function m(e){var t=T.a(e),_="audio";switch(t.toLowerCase()){case"ogv":case"ogg":_+="/ogg";break;case"mp3":_+="/mpeg";break;case"m4v":case"mp4":_+="/mp4";break;case"webm":_+="/webm"}return _}function N(e){var t=T.a(e),_="video";switch(t.toLowerCase()){case"ogv":_+="/ogg";break;case"webm":_+="/webm";break;case"m4v":case"mp4":_+="/mp4"}return _}function g(e){for(var t=0,_=!0,r=0;r<e.length;r++){var a=e[r],n=e[t];if(a.pack_index===n.pack_index)a.state!==U&&(_=!1);else{if(_){e[r-1].pack_cb();var o=r-t;e.splice(t,o),r-=o}t=r,_=e[r].state===U}if(r===e.length-1&&_){var i=e[r];e.splice(t),i.pack_cb()}}}var R=Object(n.a)(e),I=Object(o.a)(e),b=Object(i.a)(e),h=Object(E.a)(e),Y=Object(c.a)(e),L=I.defaults,M=I.assets;t.AT_ARRAYBUFFER=10,t.AT_ARRAYBUFFER_ZIP=20,t.AT_JSON=30,t.AT_JSON_ZIP=40,t.AT_TEXT=50,t.AT_AUDIOBUFFER=60,t.AT_IMAGE_ELEMENT=70,t.AT_AUDIO_ELEMENT=80,t.AT_VIDEO_ELEMENT=90,t.AT_SEQ_VIDEO_ELEMENT=100;var x=10,y=20,U=30,w=40,C=[],D=0,F={},G={},k={},K={},B={};t.split_extension=function(e){var t=e.split("."),_=Array(2);return _[0]=t.slice(0,-1).join("."),_[1]=String(t.slice(-1)),_},t.get_text_sync=function(e){if(F[e])return F[e];if(M.prevent_caching)var t=e+"?v="+Object(d.c)();else var t=e;var _=new XMLHttpRequest;if(_.overrideMimeType("text/plain"),_.open("GET",t,!1),_.send(null),200==_.status||0==_.status){var r=_.responseText;if(r.length)return F[e]=r,r;R.panic("Error XHR: responce is empty, GET "+e)}else R.panic("Error XHR: "+_.status+", GET "+e)},t.cleanup=function(){for(var e=0;e<C.length;e++)C[e].state=w;C=[],D=0,F={}},t.enqueue=function(e,t,r,n,o){for(var i=0;i<e.length;i++){var s=e[i],E={id:s.id,type:s.type,url:s.url,is_fetch:s.is_fetch,request_method:s.request_method?s.request_method:"GET",overwrite_header:s.overwrite_header?s.overwrite_header:null,post_data:s.post_data?s.post_data:null,param:s.param?s.param:null,state:x,asset_cb:t||function(){},pack_cb:r||function(){},progress_cb:n||function(){},json_reviver:o||null,pack_index:D};if(M.prevent_caching){var c=_();c&&E.url in c||(E.url+="?v="+Object(d.c)())}C.push(E)}a(C),D++},t.update=function(){a(C),g(C)},t.check_image_extension=function(e){return"png"==e||"jpg"==e||"jpeg"==e||"gif"==e||"bmp"==e||"dds"==e||"pvr"==e},t.clear_cache=function(){G={},k={},K={},B={}}}var a=_(0),n=_(5),o=_(4),i=_(35),s=_(90),E=_(1),c=_(23),l=_(2),T=_(48),d=_(46),u=Object(a.a)("__assets",r);t.a=u},function(e,t,_){"use strict";function r(e,t){var _=Object(n.a)(e),r=Object(o.a)(e),a=Object(i.a)(e),c=Object(s.a)(e),l=r.defaults,T=-1,d=-1,u=null,f=[];t.setup_context=function(e){for(var t=["INVALID_ENUM","INVALID_VALUE","INVALID_OPERATION","OUT_OF_MEMORY","INVALID_FRAMEBUFFER_OPERATION","CONTEXT_LOST_WEBGL"],_=0;_<t.length;_++){var r=t[_];r in e&&(f[e[r]]=r)}u=e},t.browser=function(e){switch(e.toLowerCase()){case"chrome":return P("mozilla")&&P("applewebkit")&&P("chrome");case"firefox":return P("mozilla")&&P("gecko")&&P("firefox");case"msie":return P("mozilla")&&P("trident")&&P("msie");case"opera":return P("opera")&&P("presto");case"safari":return P("mozilla")&&P("applewebkit")&&P("safari")&&!P("chrome");default:return!1}};var P=function(e){return navigator.userAgent.toLowerCase().indexOf(e)>-1};t.finite=function(e){if(E._15(e)){for(var t=0;t<e.length;t++)if(!isFinite(e[t]))return!1;return Boolean(e.length)}return!!isFinite(e)},t.gl=function(e){if(l.gl_debug){var t=u.getError();t!=u.NO_ERROR&&(t in f?_.panic("GL Error: "+t+", gl."+f[t]+" ("+e+")"):_.panic("Unknown GL error: "+t+" ("+e+")"))}},t.bound_fb=function(){if(!l.gl_debug&&!l.check_framebuffer_hack)return!0;switch(u.checkFramebufferStatus(u.FRAMEBUFFER)){case u.FRAMEBUFFER_COMPLETE:return!0;case u.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return a.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT"),!1;case u.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return a.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT"),!1;case u.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return a.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS"),!1;case u.FRAMEBUFFER_UNSUPPORTED:return a.error("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED"),!1;case u.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:return a.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MULTISAMPLE"),!1;default:return a.error("FRAMEBUFFER CHECK FAILED"),!1}},t.depth_only_issue=function(){if(-1!=d)return d;var e=u.createFramebuffer();u.bindFramebuffer(u.FRAMEBUFFER,e);var t=c.create_texture(c.TT_DEPTH,!1);c.resize(t,1,1);var _=t.w_texture,r=t.w_target;return u.framebufferTexture2D(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,r,_,0),u.checkFramebufferStatus(u.FRAMEBUFFER)!=u.FRAMEBUFFER_COMPLETE?(d=!0,a.warn("depth-only issue was found")):d=!1,u.bindFramebuffer(u.FRAMEBUFFER,null),u.deleteFramebuffer(e),d},t.multisample_issue=function(){if(1==l.msaa_samples)return!1;if(-1!=T)return T;var e=u.createRenderbuffer();u.bindRenderbuffer(u.RENDERBUFFER,e),u.renderbufferStorageMultisample(u.RENDERBUFFER,l.msaa_samples,u.RGBA8,1,1);var t=u.getRenderbufferParameter(u.RENDERBUFFER,u.RENDERBUFFER_SAMPLES);return t!=l.msaa_samples?(T=!0,a.warn("multisample issue was found: requested "+l.msaa_samples+", got "+t),u.getError()==u.INVALID_OPERATION&&a.warn("the error from multisample issue detected, ignoring")):T=!1,u.bindRenderbuffer(u.RENDERBUFFER,null),T},t.ff_cubemap_out_of_memory=function(){return!(!P("firefox")||u.getError()!=u.OUT_OF_MEMORY)&&(a.warn("Firefox/old GPUs cubemap issue was found."),!0)},t.reset=function(){u=null}}var a=_(0),n=_(5),o=_(4),i=_(1),s=_(17),E=_(2),c=Object(a.a)("__debug_check",r);t.a=c},function(e,t,_){"use strict";function r(e,t){function _(e){a=e}function r(){return a}t.DV_NONE=0,t.DV_OPAQUE_WIREFRAME=1,t.DV_TRANSPARENT_WIREFRAME=2,t.DV_FRONT_BACK_VIEW=3,t.DV_BOUNDINGS=4,t.DV_CLUSTERS_VIEW=5,t.DV_BATCHES_VIEW=6,t.DV_RENDER_TIME=7;var a=null;t.set_debug_view_subs=_,t.get_debug_view_subs=r,t.cleanup=function(){a=null}}var a=_(0),n=Object(a.a)("__debug_subscene",r);t.a=n},function(e,t,_){"use strict";function r(){if("DEBUG"==E){var e=o();return[parseInt(String(e.getFullYear()).slice(-2),10),e.getMonth()+1]}return l}function a(){for(var e="",t=r(),_=0;_<t.length;_++)e+=1==_&&t[_]<10?"0"+t[_]:t[_],_!=t.length-1&&(e+=".");return e}function n(){return E}function o(){return"DEBUG"==E?new Date:c}function i(){var e=o(),t=e.getDate();t=t<10?"0"+String(t):String(t);var _=e.getMonth()+1;_=_<10?"0"+String(_):String(_);var r=String(e.getFullYear()),a=e.getHours();a=a<10?"0"+String(a):String(a);var n=e.getMinutes();n=n<10?"0"+String(n):String(n);var i=e.getSeconds();return i=i<10?"0"+String(i):String(i),t+"."+_+"."+r+" "+a+":"+n+":"+i}function s(){if("DEBUG"!=E)return T;var e=i();return e=e.split(" ").join("").split(":").join("").split(".").join("")}t.e=r,t.f=a,t.d=n,t.a=o,t.b=i,t.c=s;var E="DEBUG",c=null,l=null,T="_b4w_ver_"},function(e,t,_){"use strict";function r(e,t){function _(e,t){return{name:e,p_type:t,time:0,prev_time:-1,use_world_space:!1,count_factor:1,frame_start:0,frame_end:0,time_length:0,lifetime_frames:0,lifetime:0,cyclic:0,mass:0,nfactor:0,gravity:0,fade_in:0,fade_out:0,wind_factor:0,size:0,alpha_start:0,alpha_end:0,color_ramp_length:0,color_ramp:new Float32Array(16),need_buffers_update:!1,positions:null,positions_cache:null,tbn:null,tbn_cache:null,delay_attrs:null,delay_attrs_masked:null,emitter_tsr_snapshots:null,p_data:null,tilt:0,tilt_rand:0}}function r(e){var t=_(e.name,e.type);return t.time=e.time,t.prev_time=e.prev_time,t.use_world_space=e.use_world_space,t.count_factor=e.count_factor,t.frame_start=e.frame_start,t.frame_end=e.frame_end,t.time_length=e.time_length,t.lifetime_frames=e.lifetime_frames,t.lifetime=e.lifetime,t.cyclic=e.cyclic,t.mass=e.mass,t.nfactor=e.nfactor,t.gravity=e.gravity,t.fade_in=e.fade_in,t.fade_out=e.fade_out,t.wind_factor=e.wind_factor,t.size=e.size,t.alpha_start=e.alpha_start,t.alpha_end=e.alpha_end,t.color_ramp_length=e.color_ramp_length,t.color_ramp.set(e.color_ramp),t.need_buffers_update=e.need_buffers_update,t.positions=u.O(e.positions),t.positions_cache=u.O(e.positions_cache),t.tbn=u.O(e.tbn),t.tbn_cache=u.O(e.tbn_cache),t.delay_attrs=u.O(e.delay_attrs),t.delay_attrs_masked=u.O(e.delay_attrs_masked),t.emitter_tsr_snapshots=u.O(e.emitter_tsr_snapshots),t.p_data=u.O(e.p_data),t.tilt=e.tilt,t.tilt_rand=e.tilt_rand,t}function a(e,t,_,r,a,n){for(var o=e.delay_attrs,i=e.emitter_tsr_snapshots,s=e.time,E=e.prev_time,l=0;l<o.length;l+=4){var T=o[l];if(s>E&&s>=T&&T>E||s<E&&(T>E||s>=T))for(var u=0;u<8;u++)i[8*l+u]=r[u],D[u]=r[u];else for(var u=0;u<8;u++)D[u]=i[8*l+u];var f=F;f[0]=t[3*l],f[1]=t[3*l+1],f[2]=t[3*l+2],d.B(f,D,f),a[3*l]=f[0],a[3*l+1]=f[1],a[3*l+2]=f[2];var P=c.e(_,l,C);c.m(P,D,P),c.n(n,P,l);for(var u=1;u<4;u++)a[3*(l+u)]=a[3*l],a[3*(l+u)+1]=a[3*l+1],a[3*(l+u)+2]=a[3*l+2],c.n(n,P,l+u)}}function P(e,t){for(var _=0;_<t.length;_++){var r=t[_],n=r.particles_data;if(n&&n.use_world_space&&!r.forked_batch){var o=n.positions_cache,i=n.tbn_cache;a(n,n.positions,n.tbn,e.render.world_tsr,o,i),n.need_buffers_update=!0}}}function A(e){e?(L.srand(e),k=function(){return L.rand()}):k=function(){return Math.random()}}function S(e){for(var t=[],_=0;_<e;_++)t.push(4*_,4*_+2,4*_+1,4*_,4*_+3,4*_+2);return new Uint16Array(t)}function p(e,t,_){switch(t){case"VERT":var r=_.va_frames[0].a_position,a=_.va_frames[0].a_tbn,n=O(e,r),o=v(n,r),i=m(n,a);break;case"FACE":var o=[],i=[],s=[];u._13(0,s);var E=M.geometry_random_points(_,e,!1,s);u._13(0,s);var l=M.geometry_random_points(_,e,!0,s);i=c.c(4*E.length);for(var T=0;T<E.length;T++)o.push(E[T][0],E[T][1],E[T][2]),o.push(E[T][0],E[T][1],E[T][2]),o.push(E[T][0],E[T][1],E[T][2]),o.push(E[T][0],E[T][1],E[T][2]),c.n(i,l[T],4*T),c.n(i,l[T],4*T+1),c.n(i,l[T],4*T+2),c.n(i,l[T],4*T+3);o=new Float32Array(o);break;case"VOLUME":b.panic("Particle emission from volume is not supported");break;default:b.panic("Wrong emit from option")}return[o,i]}function O(e,t){for(var _=t.length/3,r=[],a=0;a<e;a++){var n=Math.round((_-1)*k());r.push(n),r.push(n),r.push(n),r.push(n)}return r}function v(e,t){for(var _=[],r=0;r<e.length;r++)_.push(t[3*e[r]]),_.push(t[3*e[r]+1]),_.push(t[3*e[r]+2]);return new Float32Array(_)}function m(e,t){for(var _=c.c(e.length),r=0;r<e.length;r++){var a=c.e(t,e[r],C);c.n(_,a,r)}return _}function N(e,t,_,r,a){for(var n=[],o=(_-t)/e,i=0;i<e;i++){var s;s=r?o*i+U*o*(.5-k()):o*i,a||(s+=t),n.push(s),n.push(s),n.push(s),n.push(s)}return new Float32Array(n)}function g(e,t,_){for(var r=[],a=t*_,n=0;n<e;n++){var o=a*k();r.push(t-o),r.push(t-o),r.push(t-o),r.push(t-o)}return r}function R(e,t,_){for(var r=[],a=0;a<e;a++){var n=Math.random();r.push(t[4*a],_[4*a],n),r.push(t[4*a+1],_[4*a+1],n),r.push(t[4*a+2],_[4*a+2],n),r.push(t[4*a+3],_[4*a+3],n)}return new Float32Array(r)}function I(e,t,_,r){for(var a=[],n=0;n<e;n++){var o=[k()-.5,k()-.5,k()-.5];switch(f.normalize(o,o),a.push(t*o[0]),a.push(t*o[1]),a.push(t*o[2]),_){case"NONE":a.push(0);break;case"SPIN":case"VELOCITY":a.push(r);break;case"RAND":a.push(2*r*(k()-.5));break;default:b.panic("Undefined velocity factor")}for(var i=a.slice(-4),s=0;s<12;s++)a.push(i[s%4])}return new Float32Array(a)}var b=Object(n.a)(e),h=Object(o.a)(e),Y=Object(i.a)(e),L=Object(s.a)(e),M=Object(E.a)(e),x=Object(l.a)(e),y=Object(T.a)(e),U=10,w=h.defaults,C=c.c(),D=new Float32Array(8),F=new Float32Array(3),G=[];t.clone_particles_data=r;var k=function(){b.panic("_rand() undefined")};t.update=function(){for(var e=0;e<G.length;e++)for(var t=G[e],_=t.scenes_data,r=0;r<_.length;r++){var a=_[r],n=a.batches;P(t,n)}},t.obj_has_particles=function(e){for(var t=e.scenes_data,_=0;_<t.length;_++)for(var r=t[_].batches,a=0;a<r.length;a++)if(r[a].particles_data)return!0;return!1},t.obj_has_psys=function(e,t){for(var _=e.scenes_data,r=0;r<_.length;r++)for(var a=_[r].batches,n=0;n<a.length;n++){var o=a[n].particles_data;if(o&&o.name==t)return!0}return!1},t.obj_has_anim_particles=function(e){for(var t=e.scenes_data,_=0;_<t.length;_++)for(var r=t[_].batches,a=0;a<r.length;a++){var n=r[a].particles_data;if(n&&"EMITTER"==n.p_type)return!0}return!1},t.bpy_obj_has_particles=function(e){return e.particle_systems.length>0},t.bpy_obj_has_anim_particles=function(e){for(var t=0;t<e.particle_systems.length;t++){if("EMITTER"==e.particle_systems[t].settings.type)return!0}return!1},t.has_dynamic_grass_particles=function(e){for(var t=0;t<e.particle_systems.length;t++){var _=e.particle_systems[t].settings;if("HAIR"==_.type&&_.b4w_dynamic_grass)return!0}return!1},t.create_particles_data=function(e,t,r){var a=e.particles_data=_(t.name,t.settings.type);a.frame_start=t.settings.frame_start,a.frame_end=t.settings.frame_end,a.time_length=(a.frame_end-a.frame_start)/y.get_framerate(),a.lifetime_frames=t.settings.lifetime,a.lifetime=a.lifetime_frames/y.get_framerate(),a.cyclic=t.settings.b4w_cyclic?1:0,a.mass=t.settings.mass,a.nfactor=t.settings.normal_factor,a.gravity=9.81*t.settings.effector_weights.gravity,a.fade_in=t.settings.b4w_fade_in/y.get_framerate(),a.fade_out=t.settings.b4w_fade_out/y.get_framerate(),a.wind_factor=t.settings.effector_weights.wind,a.use_world_space="WORLD"==t.settings.b4w_coordinate_system;var n,o,i;if(e.halo_particles){n=r.halo_settings.size;var s=r.halo_settings.hardness;s<30?(o=.5,i=.9):s<40?(o=.1,i=1):s<50?(o=0,i=.8):(o=0,i=.5)}else n=t.settings.particle_size,o=1,i=1;a.size=n,a.alpha_start=o,a.alpha_end=i,r.use_nodes&&"BILLBOARD"==t.settings.render_type&&(Y.set_batch_directive(e,"NODES",1),Y.set_batch_directive(e,"PARTICLE_BATCH",1),e.has_nodes=!0);var E=t.settings.texture_slots;if(E[0]&&E[0].use_map_size&&E[0].texture&&"BLEND"==E[0].texture.type&&E[0].texture.use_color_ramp&&w.allow_vertex_textures){var c=E[0].texture,l=[];x.calc_color_ramp_data(c.color_ramp,x.PART_COLORRAMP_TEXT_SIZE,l),l=new Uint8Array(l.map(function(e){return u.M(255*e,0,255)}));var T=x.create_color_ramp_texture(l,x.PART_COLORRAMP_TEXT_SIZE);Y.append_texture(e,T,"u_color_ramp_tex",c.name),Y.set_batch_directive(e,"USE_COLOR_RAMP",1)}var d=r.texture_slots,f=[-1,0,0,0,-1,0,0,0,-1,0,0,0,-1,0,0,0];if(d[0]&&"STRAND"==d[0].texture_coords&&d[0].texture&&"BLEND"==d[0].texture.type&&d[0].texture.use_color_ramp){for(var P=d[0].texture.color_ramp.elements,A=Math.min(4*P.length,f.length),S=0;S<A;S+=4){var p=P[S/4];f[S]=p.position,f[S+1]=p.color[0],f[S+2]=p.color[1],f[S+3]=p.color[2]}a.color_ramp_length=P.length}a.color_ramp.set(f)},t.generate_emitter_particles_submesh=function(e,t,_,r){var n=e.particles_data,o=r.world_tsr,i=_.settings.count,s=_.settings.frame_start/y.get_framerate(),E=_.settings.frame_end/y.get_framerate(),c=_.settings.lifetime/y.get_framerate(),l=_.settings.lifetime_random,T=_.settings.emit_from,d=_.settings.factor_random;if(_.settings.use_rotations)var u=_.settings.angular_velocity_mode,f=_.settings.angular_velocity_factor;else var u="NONE",f=0;var P=_.settings.b4w_randomize_emission,O=_.settings.b4w_cyclic;n.tilt=_.settings.billboard_tilt,n.tilt_rand=_.settings.billboard_tilt_random,A(_.seed);var v=M.extract_submesh_all_mats(t,["a_position","a_tbn"],null,r),m=p(i,T,v),b=m[0],h=m[1];n.positions=new Float32Array(b),n.tbn=new Float32Array(h),n.positions_cache=new Float32Array(b.length),n.tbn_cache=new Float32Array(h.length);var Y=N(i,s,E,P,O);if(n.delay_attrs=new Float32Array(Y),n.delay_attrs_masked=new Float32Array(Y),n.use_world_space){n.emitter_tsr_snapshots=new Float32Array(8*Y.length);for(var L=0;L<8*Y.length;L++)for(var x=0;x<8;x++)n.emitter_tsr_snapshots[8*L+x]=o[x];a(n,b,h,o,b,h)}var U=M.init_submesh("EMITTER_PARTICLES"),w=M.create_empty_va_frame();w.a_position=b,w.a_tbn=h,U.va_frames[0]=w,e.draw_mode=M.DM_DYNAMIC_TRIANGLES,U.indices=S(i),U.va_common.a_p_bb_vertex=M.gen_bb_vertices(i),U.base_length=b.length/3;var C=g(i,c,l);return U.va_common.a_p_data=R(i,C,Y),U.va_common.a_p_vels=I(i,d,u,f),n.p_data=new Float32Array(U.va_common.a_p_data),U},t.set_time=function(e,t,_){for(var r=e.scenes_data,a=0;a<r.length;a++)for(var n=r[a].batches,o=0;o<n.length;o++){var i=n[o].particles_data;i&&i.name==t&&!n[o].forked_batch&&(i.prev_time=i.time,i.time=_)}},t.set_size=function(e,t,_){for(var r=e.scenes_data,a=0;a<r.length;a++)for(var n=r[a].batches,o=0;o<n.length;o++){var i=n[o].particles_data;i&&i.name==t&&(i.size=_)}},t.set_normal_factor=function(e,t,_){for(var r=e.scenes_data,a=0;a<r.length;a++)for(var n=r[a].batches,o=0;o<n.length;o++){var i=n[o].particles_data;i&&i.name==t&&(i.nfactor=_)}},t.get_normal_factor=function(e,t){for(var _=e.scenes_data,r=0;r<_.length;r++)for(var a=_[r].batches,n=0;n<a.length;n++){var o=a[n].particles_data;if(o&&o.name==t)return o.nfactor}return 0},t.set_factor=function(e,t,_){for(var r=e.scenes_data,a=0;a<r.length;a++)for(var n=r[a].batches,o=0;o<n.length;o++){var i=n[o],s=i.particles_data;if(s&&s.name==t){s.count_factor=_;var E=s.delay_attrs;if(1==_)var c=E;else if(0==_)for(var c=s.delay_attrs_masked,l=0;l<c.length;l+=4)c[l]=1e4,c[l+1]=c[l],c[l+2]=c[l],c[l+3]=c[l];else for(var T=4/_,c=s.delay_attrs_masked,d=0,l=0;l<c.length;l+=4)l>=d?(c[l]=E[l],d+=T):c[l]=1e4,c[l+1]=c[l],c[l+2]=c[l],c[l+3]=c[l];var u=i.bufs_data,f=u.pointers,P=f.a_p_data;if(P){for(var A=s.p_data,l=0;l<A.length;l+=3)A[l+1]=c[Math.round(l/3)];M.update_bufs_data_array(u,"a_p_data",3,A)}}}},t.update_start_pos=function(e,t,_){for(var r=e.scenes_data,a=0;a<r.length;a++)for(var n=r[a].batches,o=0;o<n.length;o++){var i=n[o].particles_data;if(i&&i.use_world_space)for(var s=0;s<8*i.delay_attrs.length;s++)i.emitter_tsr_snapshots[8*s]=t[0],i.emitter_tsr_snapshots[8*s+1]=t[1],i.emitter_tsr_snapshots[8*s+2]=t[2],i.emitter_tsr_snapshots[8*s+3]=t[3],i.emitter_tsr_snapshots[8*s+4]=_[0],i.emitter_tsr_snapshots[8*s+5]=_[1],i.emitter_tsr_snapshots[8*s+6]=_[2],i.emitter_tsr_snapshots[8*s+7]=_[3]}},t.update_particles_submesh=function(e,t,_){if(e.va_common.a_tbn=c.c(4*_),c.i(e.va_common.a_tbn),t.part_node_data){for(var r=[],a=0;a<_;a++)r.push(a,a,a,a);e.va_common[t.part_node_data.name]=new Float32Array(r)}},t.update_particles_objs_cache=function(e){-1==G.indexOf(e)&&G.push(e)},t.remove_obj_from_cache=function(e){var t=G.indexOf(e);-1!=t&&G.splice(t,1)},t.cleanup=function(){G.length=0}}var a=_(0),n=_(5),o=_(4),i=_(16),s=_(30),E=_(20),c=_(36),l=_(17),T=_(18),d=_(6),u=_(2),f=_(3),P=Object(a.a)("__particles",r);t.a=P},function(e,t,_){"use strict";function r(e){if(""==e)return".";var t=0==e.indexOf("/")|0;t&&0==e.indexOf("//")&&0!=e.indexOf("///")&&(t=2);for(var _=e.split("/"),r=[],a=0;a<_.length;a++){var n=_[a];""!=n&&"."!=n&&(".."!=n||!t&&!r.length||r.length&&".."==r[r.length-1]?r.push(n):r.length&&r.pop())}_=r,e=_.join("/");for(var a=0;a<t;a++)e="/"+e;return e||"."}function a(e){var t=e.split("://",2);return t.length>1?(t[1]=r(t[1]),t.join("://")):r(e)}function n(e){return/(?:\.([^.]+))?$/.exec(e)[1]}t.b=a,t.a=n},function(e,t,_){"use strict";function r(e,t){function _(e){A.error_deprecated("enable_split_screen","screen.request_split_screen");var t=a.get_device_by_type_element(a.DEVICE_HMD);if(!t)return!1;if(v)return!0;var _=a.get_vector_param(t,a.HMD_FOV_LEFT,p),r=a.get_vector_param(t,a.HMD_FOV_RIGHT,O);d.set_hmd_fov(e,_,r);var n=a.get_value_param(t,g);if(n){var o=S.get_active(),i=P.get_scene_data(e,o),s=i.cameras;d.set_eye_distance(s,n)}var E={};if(E.base_line_factor=.5,E.inter_lens_factor=.5,E.enable_hmd_stereo=!0,a.get_value_param(t,a.HMD_WEBVR_TYPE)&(a.HMD_NON_WEBVR|a.HMD_WEBVR_MOBILE|a.HMD_WEBVR_DESKTOP)&&(E.distortion_coefs=[t.distortion_coefs[0],t.distortion_coefs[1]],E.chromatic_aberration_coefs=[t.chromatic_aberration_coefs[0],t.chromatic_aberration_coefs[1],t.chromatic_aberration_coefs[2],t.chromatic_aberration_coefs[3]],t.webvr_hmd_device||(t.base_line_dist&&t.height_dist&&t.bevel_size?E.base_line_factor=(t.base_line_dist-t.bevel_size)/t.height_dist:t.bevel_size||(E.base_line_factor=t.base_line_dist/t.height_dist)),t.inter_lens_dist&&t.width_dist&&!t.webvr_hmd_device&&(E.inter_lens_factor=t.inter_lens_dist/t.width_dist),!m.enabled)){var c=1+t.distortion_coefs[0]+t.distortion_coefs[1];S.multiply_size_mult(c,c)}return S.set_hmd_params(E),f.resize_to_container(!0),a.reset_device(t),v=!0,!0}function r(){for(var e=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],t=[],_=0;_<e.length;_++)e[_]&&t.push(_);return t}var a=Object(n.a)(e),d=Object(o.a)(e),u=Object(i.a)(e),f=Object(s.a)(e),P=Object(E.a)(e),A=Object(c.a)(e),S=Object(l.a)(e),p=T.create(),O=T.create(),v=!1,m=u.debug_subs,N=u.defaults;t.GMPD_BUTTON_12=a.GMPD_BUTTON_12,t.GMPD_BUTTON_13=a.GMPD_BUTTON_13,t.GMPD_BUTTON_15=a.GMPD_BUTTON_15,t.GMPD_BUTTON_14=a.GMPD_BUTTON_14,t.GMPD_BUTTON_3=a.GMPD_BUTTON_3,t.GMPD_BUTTON_0=a.GMPD_BUTTON_0,t.GMPD_BUTTON_1=a.GMPD_BUTTON_1,t.GMPD_BUTTON_2=a.GMPD_BUTTON_2,t.GMPD_BUTTON_5=a.GMPD_BUTTON_5,t.GMPD_BUTTON_7=a.GMPD_BUTTON_7,t.GMPD_BUTTON_4=a.GMPD_BUTTON_4,t.GMPD_BUTTON_6=a.GMPD_BUTTON_6,t.GMPD_BUTTON_8=a.GMPD_BUTTON_8,t.GMPD_BUTTON_9=a.GMPD_BUTTON_9,t.GMPD_BUTTON_10=a.GMPD_BUTTON_10,t.GMPD_BUTTON_11=a.GMPD_BUTTON_11,t.GMPD_BUTTON_16=a.GMPD_BUTTON_16,t.GMPD_BUTTON_17=a.GMPD_BUTTON_17,t.GMPD_BUTTON_18=a.GMPD_BUTTON_18,t.GMPD_BUTTON_19=a.GMPD_BUTTON_19,t.GMPD_BUTTON_20=a.GMPD_BUTTON_20,t.GMPD_BUTTON_21=a.GMPD_BUTTON_21,t.GMPD_BUTTON_22=a.GMPD_BUTTON_22,t.GMPD_BUTTON_23=a.GMPD_BUTTON_23,t.GMPD_BUTTON_24=a.GMPD_BUTTON_24,t.GMPD_BUTTON_25=a.GMPD_BUTTON_25,t.GMPD_TRACKPAD_BUTTON=a.GMPD_TRACKPAD_BUTTON,t.GMPD_TRIGGER_BUTTON=a.GMPD_TRIGGER_BUTTON,t.GMPD_GRIPS_BUTTON=a.GMPD_GRIPS_BUTTON,t.GMPD_MENU_BUTTON=a.GMPD_MENU_BUTTON,t.GMPD_AXIS_0=a.GMPD_AXIS_0,t.GMPD_AXIS_1=a.GMPD_AXIS_1,t.GMPD_AXIS_2=a.GMPD_AXIS_2,t.GMPD_AXIS_3=a.GMPD_AXIS_3,t.GMPD_AXIS_4=a.GMPD_AXIS_4,t.GMPD_AXIS_5=a.GMPD_AXIS_5,t.GMPD_AXIS_6=a.GMPD_AXIS_6,t.GMPD_AXIS_7=a.GMPD_AXIS_7,t.GMPD_AXIS_8=a.GMPD_AXIS_8,t.GMPD_AXIS_9=a.GMPD_AXIS_9,t.GMPD_AXIS_10=a.GMPD_AXIS_10,t.GMPD_AXIS_11=a.GMPD_AXIS_11,t.HMD_ORIENTATION_QUAT=a.HMD_ORIENTATION_QUAT,t.HMD_POSITION=a.HMD_POSITION,t.HMD_WEBVR_TYPE=a.HMD_WEBVR_TYPE,t.HMD_WEBVR_DESKTOP=a.HMD_WEBVR_DESKTOP,t.HMD_WEBVR_MOBILE=a.HMD_WEBVR_MOBILE,t.HMD_NON_WEBVR=a.HMD_NON_WEBVR,t.HMD_WEBVR1=a.HMD_WEBVR1,t.HMD_WEBVR1_1=a.HMD_WEBVR1_1;var g=a.HMD_EYE_DISTANCE;t.HMD_EYE_DISTANCE=g,t.HMD_DISTORTION=a.HMD_DISTORTION,t.HMD_BASELINE_DIST=a.HMD_BASELINE_DIST,t.HMD_SCREEN_LENS_DIST=a.HMD_SCREEN_LENS_DIST,t.HMD_SCREEN_WIDTH=a.HMD_SCREEN_WIDTH,t.HMD_SCREEN_HEIGHT=a.HMD_SCREEN_HEIGHT,t.HMD_BEVEL_SIZE=a.HMD_BEVEL_SIZE,t.MOUSE_LOCATION=a.MOUSE_LOCATION,t.MOUSE_DOWN_WHICH=a.MOUSE_DOWN_WHICH,t.MOUSE_UP_WHICH=a.MOUSE_UP_WHICH,t.MOUSE_WHEEL=a.MOUSE_WHEEL,t.KEYBOARD_UP=a.KEYBOARD_UP,t.KEYBOARD_DOWN=a.KEYBOARD_DOWN,t.TOUCH_START=a.TOUCH_START,t.TOUCH_MOVE=a.TOUCH_MOVE,t.TOUCH_END=a.TOUCH_END,t.GYRO_ORIENTATION_QUAT=a.GYRO_ORIENTATION_QUAT,t.GYRO_ORIENTATION_ANGLES=a.GYRO_ORIENTATION_ANGLES;var R={};R[a.DEVICE_HMD]=[a.HMD_ORIENTATION_QUAT,a.HMD_POSITION],R[a.DEVICE_MOUSE]=[a.MOUSE_LOCATION];var I={};I[a.DEVICE_HMD]=[a.HMD_WEBVR_TYPE];var b={};b[a.DEVICE_MOUSE]=[a.MOUSE_LOCATION,a.MOUSE_DOWN_WHICH,a.MOUSE_UP_WHICH,a.MOUSE_WHEEL],b[a.DEVICE_KEYBOARD]=[a.KEYBOARD_UP,a.KEYBOARD_DOWN],b[a.DEVICE_TOUCH]=[a.TOUCH_START,a.TOUCH_MOVE,a.TOUCH_END],b[a.DEVICE_GYRO]=[a.GYRO_ORIENTATION_QUAT,a.GYRO_ORIENTATION_ANGLES];var h={};h[a.DEVICE_HMD]=[a.HMD_DISTORTION,a.HMD_EYE_DISTANCE,a.HMD_BASELINE_DIST,a.HMD_SCREEN_LENS_DIST,a.HMD_SCREEN_WIDTH,a.HMD_SCREEN_HEIGHT,a.HMD_BEVEL_SIZE],t.DEVICE_GYRO=a.DEVICE_GYRO,t.DEVICE_HMD=a.DEVICE_HMD,t.DEVICE_MOUSE=a.DEVICE_MOUSE,t.DEVICE_KEYBOARD=a.DEVICE_KEYBOARD,t.DEVICE_TOUCH=a.DEVICE_TOUCH,t.can_use_device=a.can_use_device,t.get_device_by_type_element=a.get_device_by_type_element,t.switch_prevent_default=function(e,t){e&&a.switch_prevent_default(e,t)},t.register_device=function(){A.error_once("input.register_device() deprecated")},t.reset_device=function(e){if(!e||e.type!=a.DEVICE_HMD)return void A.error("reset_device is undefined for device.");a.reset_device(e)},t.get_vector_param=function(e,t,_){return e&&e.type in R&&R[e.type].indexOf(t)>=0?a.get_vector_param(e,t,_):(A.error("device hasn't param: ",t),null)},t.get_value_param=function(e,t){return e&&e.type in I&&I[e.type].indexOf(t)>=0?a.get_value_param(e,t):(A.error("device hasn't param: ",t),null)},t.attach_param_cb=function(e,t,_){if(_=_||null,e&&e.type in b&&b[e.type].indexOf(t)>=0)return a.attach_param_cb(e,t,_);A.error("device hasn't param: ",t)},t.detach_param_cb=function(e,t,_){if(_=_||null,e&&e.type in b&&b[e.type].indexOf(t)>=0)return a.detach_param_cb(e,t,_);A.error("device hasn't param: ",t)},t.set_config=function(e,t,_){if(e&&e.type in h&&h[e.type].indexOf(t)>=0)return a.set_config(e,t,_);A.error("device hasn't config: ",t)},t.request_fullscreen_hmd=function(){if(A.error_deprecated("request_fullscreen_hmd","screen.request_fullscreen_hmd"),S.check_active()){var e=S.get_camera(S.get_active());if(e){_(e);var t=a.get_device_by_type_element(a.DEVICE_HMD);if(t){var r=t.webvr_display;if(r&&!r.isPresenting){if(r.capabilities.canPresent){var n=f.get_canvas();r.requestPresent([{source:n}]).then(function(){if(!N.is_mobile_device){var e=r.getEyeParameters("left"),t=r.getEyeParameters("right");f.resize(2*Math.max(e.renderWidth,t.renderWidth),Math.max(e.renderHeight,t.renderHeight),!1)}},function(){A.error("HMD fullscreen request failed.")})}else A.error("HMD fullscreen request failed.")}}}}},t.enable_split_screen=_,t.disable_split_screen=function(){A.error_deprecated("disable_split_screen","screen.exit_split_screen");var e=a.get_device_by_type_element(a.DEVICE_HMD);if(!v||!e||!e.registered)return!1;var t={};t.enable_hmd_stereo=!1,S.set_hmd_params(t);var _=1/(1+e.distortion_coefs[0]+e.distortion_coefs[1]);return S.multiply_size_mult(_,_),f.resize_to_container(!0),!0},t.set_gamepad_key=function(e,t,_){switch(e){case 0:var r=a.DEVICE_GAMEPAD0;break;case 1:var r=a.DEVICE_GAMEPAD1;break;case 2:var r=a.DEVICE_GAMEPAD2;break;case 3:var r=a.DEVICE_GAMEPAD3;break;default:var r=a.DEVICE_GAMEPAD0}var n=a.get_device_by_type_element(r);a.set_config(n,t,_)},t.get_pressed_gmpd_btn=a.get_pressed_gmpd_btn,t.get_moved_gmpd_axis=a.get_moved_gmpd_axis,t.get_gamepad_position=a.get_gamepad_position,t.get_gamepad_orientation=a.get_gamepad_orientation,t.check_enable_gamepad_indices=r,t.get_vr_controller_id=function(e){for(var t=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],_=0,r=0;_<4;_++){var a=t[_];if(a&&(""==a.id||"OpenVR Gamepad"==a.id||"Oculus Touch (Left)"==a.id||"Oculus Touch (Right)"==a.id)){if(r==e)return r;r++}}return e},t.add_click_listener=function(e,t){e&&t&&a.add_click_listener(e,t)},t.remove_click_listener=function(e,t){e&&t&&a.remove_click_listener(e,t)}}var a=_(0),n=_(38),o=_(14),i=_(4),s=_(15),E=_(8),c=_(1),l=_(10),T=_(7),d=Object(a.a)("input",r);t.a=d},function(e,t,_){"use strict";function r(e,t){function _(e,t,_){function r(){document.fullscreenElement===e||document.webkitFullscreenElement===e||document.mozFullScreenElement===e||document.webkitIsFullScreen||document.msFullscreenElement===e?t():(document.removeEventListener("fullscreenchange",r,!1),document.removeEventListener("webkitfullscreenchange",r,!1),document.removeEventListener("mozfullscreenchange",r,!1),document.removeEventListener("MSFullscreenChange",r,!1),_())}e=e||A.get_container(),t=t||function(){},_=_||function(){},document.addEventListener("fullscreenchange",r,!1),document.addEventListener("webkitfullscreenchange",r,!1),document.addEventListener("mozfullscreenchange",r,!1),document.addEventListener("MSFullscreenChange",r,!1),e.requestFullScreen=e.requestFullScreen||e.webkitRequestFullScreen||e.mozRequestFullScreen||e.msRequestFullscreen,e.requestFullScreen?e.requestFullScreen():N.error("B4W App: request fullscreen method is not supported")}function r(){var e=document.exitFullscreen||document.webkitExitFullscreen||document.mozCancelFullScreen||document.msExitFullscreen;"function"!=typeof e&&N.error("B4W App: exit fullscreen method is not supported"),e.apply(document)}function a(e,t){var _=O.get_device_by_type_element(O.DEVICE_HMD);if(!_)return!1;if(b)return!0;if(h=t,g.check_active()){var r=g.get_camera(g.get_active());r&&(_.registered?(f(r),e&&e()):(O.request_register_device(_),_.registered_cb=function(){f(r),e&&e()}))}}function f(e){var t=O.get_device_by_type_element(O.DEVICE_HMD);if(!t)return!1;if(b)return!0;var _=O.get_value_param(t,O.HMD_WEBVR_TYPE);if(_&O.HMD_WEBVR1_1){var r=t.webvr_display,a=r.getEyeParameters("left"),n=r.getEyeParameters("right");A.resize(2*Math.max(a.renderWidth,n.renderWidth),Math.max(a.renderHeight,n.renderHeight),!1)}else{var o=A.get_canvas(),i=Math.max(2*o.height,o.width),s=i/2;A.resize(i,s,!1)}var E=O.get_vector_param(t,O.HMD_FOV_LEFT,R),c=O.get_vector_param(t,O.HMD_FOV_RIGHT,I);P.set_hmd_fov(e,E,c,!Boolean(_&O.HMD_WEBVR1_1));var l={};l.base_line_factor=.5,l.inter_lens_factor=.5,l.enable_hmd_stereo=!0,_&(O.HMD_NON_WEBVR|O.HMD_WEBVR_MOBILE|O.HMD_WEBVR_DESKTOP)&&(l.distortion_coefs=[t.distortion_coefs[0],t.distortion_coefs[1]],l.chromatic_aberration_coefs=[t.chromatic_aberration_coefs[0],t.chromatic_aberration_coefs[1],t.chromatic_aberration_coefs[2],t.chromatic_aberration_coefs[3]],t.webvr_hmd_device||(t.base_line_dist&&t.height_dist&&t.bevel_size?l.base_line_factor=(t.base_line_dist-t.bevel_size)/t.height_dist:t.bevel_size||(l.base_line_factor=t.base_line_dist/t.height_dist)),t.inter_lens_dist&&t.width_dist&&!t.webvr_hmd_device&&(l.inter_lens_factor=t.inter_lens_dist/t.width_dist)),L.enabled||g.multiply_size_mult(.5,1),g.set_hmd_params(l);var T=O.get_value_param(t,O.HMD_EYE_DISTANCE);if(T){var d=g.get_active(),u=m.get_scene_data(e,d),f=u.cameras;P.set_eye_distance(f,T)}return g.render_both_eyes(),b=!0,!0}var P=Object(n.a)(e),A=Object(o.a)(e),S=Object(i.a)(e),p=Object(s.a)(e),O=Object(E.a)(e),v=Object(c.a)(e),m=Object(l.a)(e),N=Object(T.a)(e),g=Object(d.a)(e),R=u.create(),I=u.create(),b=!1,h=function(){},Y=function(){},L=S.debug_subs;t.draw_mixer_strip=p.draw_mixer_strip,t.plot_array=p.plot_array,t.request_fullscreen=_,t.exit_fullscreen=r,t.check_fullscreen=O.check_fullscreen,t.request_fullscreen_hmd=function(e,t,r){if("HMD"!=!S.get("stereo")||"NONE"==S.get("stereo")&&S.get("is_mobile_device")){var a=O.get_device_by_type_element(O.DEVICE_HMD);if(a&&O.get_value_param(a,O.HMD_WEBVR_TYPE)&O.HMD_WEBVR1){var n=a.webvr_display;if(n&&!n.isPresenting){t=t||function(){},r=r||function(){},Y=function(){n.isPresenting?t():(window.removeEventListener("vrdisplaypresentchange",Y),r())},window.addEventListener("vrdisplaypresentchange",Y,!1);if(n.capabilities.canPresent){var o=A.get_canvas();n.requestPresent([{source:o}]).then(function(){},function(){N.error("HMD fullscreen request failed.")})}else N.error("HMD fullscreen request failed.")}}else _(e,t,r)}},t.exit_fullscreen_hmd=function(){if("HMD"!=!S.get("stereo")||"NONE"==S.get("stereo")&&S.get("is_mobile_device")){var e=O.get_device_by_type_element(O.DEVICE_HMD);if(e&&O.get_value_param(e,O.HMD_WEBVR_TYPE)&O.HMD_WEBVR1){var t=e.webvr_display;t&&t.isPresenting&&(t.exitPresent(),A.resize_to_container(!0))}else r()}},t.check_fullscreen_hmd=function(){var e=O.get_device_by_type_element(O.DEVICE_HMD),t=O.get_value_param(e,O.HMD_WEBVR_TYPE)&O.HMD_WEBVR1;return!(!e||!(t&&e.webvr_display||!t&&O.check_fullscreen()))},t.request_split_screen=a,t.exit_split_screen=function(){var e=O.get_device_by_type_element(O.DEVICE_HMD);if(!b||!e||!e.registered)return!1;var t={};return t.enable_hmd_stereo=!1,g.set_hmd_params(t),b=!1,h&&h(),g.render_one_eye(),L.enabled||g.multiply_size_mult(2,1),A.resize_to_container(!0),!0},t.shot=function(e,t){e=e||"image/png",t=t||1;var _=function(t){var _="screenshot."+e.split("/")[1];if(navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(t,_);else{var r=window.document.createElement("a");document.body.appendChild(r),r.style.display="none",r.href=t,r.download="screenshot."+e.split("/")[1],r.click(),document.body.removeChild(r)}};v.canvas_data_url(_,e,t,!0)}}var a=_(0),n=_(14),o=_(15),i=_(4),s=_(51),E=_(38),c=_(79),l=_(8),T=_(1),d=_(10),u=_(7),f=Object(a.a)("screen",r);t.a=f},function(e,t,_){"use strict";function r(e,t){function _(e){e.font="bold 15px Courier New",e.textBaseline="middle",e.shadowBlur=0,e.shadowColor=null}function r(e){if(s(' SCENE "'+e.name+'"'),s(" Active                 Subscene   Lamps   Size   RenderCalls   Time"),!e._render)return void s("No INFO");var t=0,_=0,r=0,a=e._render.graph;return p.traverse(a,function(e,a){var n=a;if(n.type!=O.SINK){for(var o=Math.round(n.camera.width)+"x"+Math.round(n.camera.height),i=0,E=0;E<n.draw_data.length;E++)i+=n.draw_data[E].bundles.length;var c=n.debug_render_calls;n.type!=O.MAIN_CUBE_REFLECT&&n.type!=O.MAIN_CUBE_REFLECT_BLEND||(i*=6);var l=n.do_render&&!n.force_do_not_render,T=l?n.debug_render_time:0;n.enqueue||(n.debug_render_time=0);s(l?" ()":" ()",O.subs_label(n),n.num_lights,o,c,"of",i,"  ",T.toFixed(3)),n.debug_render_calls=0,t+=i,l&&(_+=c,r+=T)}}),[t,_,r]}function a(){I[0]=0,I[1]=0}function i(){I[0]++}function s(){for(var e=v,t=m+I[0]*N,_=arguments[0],r=1;r<arguments.length;r++){var a=arguments[r];_+=E(g[r]-String(a).length)+arguments[r]}i(),R.fillText(_,e,t)}function E(e){for(var t="",_=0;_<e;_++)t+=" ";return t}function c(){return{x:0,y:0,w:0,h:0}}function l(e,t,_,r,a){return a.x=e,a.y=t,a.w=_,a.h=r,a}function T(e,t,_,r){var a=e.w/_;return r.x=e.x+a*t,r.y=e.y,r.w=a,r.h=e.h,r}function d(e,t,_,r){var a=e.h/_;return r.x=e.x,r.y=e.y+a*t,r.w=e.w,r.h=a,r}function u(e,t,_){var r=e.w*t;return _.x=e.x+r,_.y=e.y,_.w=e.w-2*r,_.h=e.h,_}function f(e,t,_){var r=e.h*t;return _.x=e.x,_.y=e.y+r,_.w=e.w,_.h=e.h-2*r,_}function P(e){return e.x+e.w/2}function A(e){var t=R,_=c();return l(0,0,t.canvas.width,t.canvas.height,_),u(_,.01,_),f(_,.02,_),T(_,e,8,_),u(_,.02,_),_}function S(e,t,_,r,a){var n=r[0],o=r[1],i=r[2],s=r[3],E=r[4],c=r[5],l=(s-i)/E;if(l<1)var T=Math.floor(1/l-1e-5).toFixed(0).length;else var T=0;if(c)var d=Math.log(o/i)/Math.log(s/i);else var d=(o-i)/(s-i);if(e.textAlign="center",a?e.fillText("["+n+"]",P(_),_.y):e.fillText(n,P(_),_.y),e.strokeStyle="#00FF00",e.lineWidth=t?3:1,t?(e.textAlign="right",e.fillText(s.toFixed(T),P(_)-10,_.y+15),e.textAlign="right",e.fillText(i.toFixed(T),P(_)-10,_.y+_.h-15)):(e.textAlign="right",e.fillText(i.toFixed(T),_.x+28,_.y+15),e.textAlign="left",e.fillText(s.toFixed(T),_.x+_.w-28,_.y+15)),e.beginPath(),t){var u=_.y+15+(_.h-30)*(1-d);e.moveTo(P(_),_.y+15),e.lineTo(P(_),_.y+_.h-15),e.moveTo(P(_)-5,_.y+15),e.lineTo(P(_)+5,_.y+15),e.moveTo(P(_)-5,_.y+_.h-15),e.lineTo(P(_)+5,_.y+_.h-15),e.moveTo(P(_)-5,u),e.lineTo(P(_)+5,u)}else{var f=_.x+30+(_.w-60)*d;e.moveTo(_.x+30,_.y+15),e.lineTo(_.x+_.w-30,_.y+15),e.moveTo(_.x+30,_.y+15-5),e.lineTo(_.x+30,_.y+15+5),e.moveTo(_.x+_.w-30,_.y+15-5),e.lineTo(_.x+_.w-30,_.y+15+5),e.moveTo(f,_.y+15-5),e.lineTo(f,_.y+15+5)}if(e.stroke(),"EQ_Q"==n){var A=o,S=1+1/(2*A*A)+Math.sqrt((2+1/(A*A))*(2+1/(A*A))/4-1),p=Math.log(S)/Math.log(2);t?(e.textAlign="left",e.fillText(o.toFixed(T),P(_)+10,u),e.textAlign="left",e.fillText("("+p.toFixed(T+1)+")",P(_)+10,u+10)):(e.textAlign="right",e.fillText(o.toFixed(T),f,_.y+30),e.textAlign="left",e.fillText("("+p.toFixed(T+1)+")",f,_.y+30))}else t?(e.textAlign="left",e.fillText(o.toFixed(T),P(_)+10,u)):(e.textAlign="center",e.fillText(o.toFixed(T),f,_.y+30))}var p=Object(n.a)(e),O=Object(o.a)(e),v=30,m=80,N=20,g=[5,30,4,10,5,3,5],R=null,I=[0,0];t.init=function(e){var t=e.getContext("2d");return _(t),R=t,t},t.update_dim=function(){R&&_(R)},t.reset=function(){var e=R;e&&(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle="rgba(0,0,0,0.5)",e.fillRect(0,0,e.canvas.width,e.canvas.height),a())},t.show_debug_info=function(e,t){var _=R;if(_){_.textAlign="left",_.fillStyle="rgba(0,255,0,255)",s(" FPS",(1/t).toFixed(2)),i();for(var a=0,n=0,o=0,E=0;E<e.length;E++){var c=r(e[E]);a+=c[0],n+=c[1],o+=c[2],i()}s(" ----------------------------------------------------------------"),s("    ","TOTAL ACTIVE","","",n,"of",a,"  ",o.toFixed(3))}},t.print=function(){var e=R;e&&(e.textAlign="left",e.fillStyle="rgba(0,255,0,255)",s.apply(Math,arguments))},t.plot_array=function(e,t,_,r,a,n,o){var i=R;if(i){var s=A(t);if(d(s,4,5,s),i.textAlign="center",i.fillStyle="#00FF00",R.fillText(e,P(s),s.y-10),i.strokeStyle="#00FF00",i.lineWidth=.5,i.beginPath(),i.moveTo(s.x,s.y),i.lineTo(s.x+s.w,s.y),i.lineTo(s.x+s.w,s.y+s.h),i.lineTo(s.x,s.y+s.h),i.closePath(),i.stroke(),!n&&!o){n=1e6,o=-1e6;for(var E=0;E<_.length;E++)n=Math.min(n,_[E]),o=Math.max(o,_[E])}i.textAlign="right",R.fillText(String(n),s.x-10,s.y+s.h),R.fillText(String(o),s.x-10,s.y),i.textAlign="center",R.fillText(String(r),s.x,s.y+s.h+15),R.fillText(String(a),s.x+s.w,s.y+s.h+15),i.strokeStyle="#FF0000",i.lineWidth=1.5,i.beginPath();for(var c=s.w/(_.length-1),l=s.h/(o-n),E=0;E<_.length;E++){var T=s.x+c*E,u=s.y+s.h-(_[E]-n)*l;0==E?i.moveTo(T,u):i.lineTo(T,u)}i.stroke()}},t.draw_mixer_strip=function(e,t,_,r,a,n,o){var i=R;if(i){i.textAlign="center",i.fillStyle="#00FF00",i.font="bold 12px Courier";var s=A(_),E=t?"["+e+"]":e;R.fillText(E,P(s),s.y),n>=0&&R.fillText(n?"[M]":"[ ]",P(s)-15,s.y+30),o>=0&&R.fillText(o?"[S]":"[ ]",P(s)+15,s.y+30);for(var T=c(),d=0;d<r.length;d++){var u=r[d],f="VOLUME"==u[0];f?l(s.x,s.y+350,s.w,250,T):l(s.x,s.y+50+50*d,s.w,s.h,T),S(i,f,T,u,d==a)}}}}var a=_(0),n=_(31),o=_(11),i=Object(a.a)("__hud",r);t.a=i},function(e,t,_){"use strict";function r(e,t){function _(e){for(var t=null,_=e.scenes_data.length-1;_>=0;_--){var r=e.scenes_data[_];if(r.scene.b4w_use_nla&&(t=r,r.scene._is_main))break}return t}function r(e,t,_){for(var r=0;r<e.length;r++){var a=e[r];if(t.frame_start>a.frame_end||t.frame_end<a.frame_start){var n=_+" ["+a.frame_start+":"+a.frame_end+"]";B.warn("NLA: Strip is out of scene range: "+n),e.splice(r,1),r--}else a.anim_name||"CLIP"!=a.type||(B.warn('NLA: no action in strip for object "'+_+'".'),e.splice(r,1),r--)}}function a(e,t){for(var _=0;_<e.length;_++){for(var r=e[_],a=t.frame_start,n=t.frame_end+1,o=0;o<e.length;o++){var i=e[o];r.anim_slot==i.anim_slot&&(i.frame_end<=r.frame_start&&(a=r.frame_start),i.frame_start>=r.frame_end&&(n=Math.min(n,i.frame_start)))}r.ext_frame_start=a,r.ext_frame_end=n,u(r)}}function u(e){e.repeat%1==0?e.action_frame_final=e.action_frame_end:e.action_frame_final=e.action_frame_start+(e.action_frame_end-e.action_frame_start)*(e.repeat%1)}function f(e,t){for(var _=G.get_all_actions(),r=[],a=0,n=0;n<e.length;n++){var o=e[n];if(""!=o.anim_uuid)var i=d._18("uuid",o.anim_uuid,_);else var s=o.anim_name,i=d._18("name",s,_)||d._18("name",s+"_B4W_BAKED",_);if(i){var E=i.fcurves,c=[];for(var l in E)c.push(l);r.push(c)}}for(var n=0;n<r.length;n++){for(var T=!1,u=0;u<n;u++)if(d.E(r[n],r[u])){e[n].anim_slot=e[u].anim_slot,T=!0;break}T||(e[n].anim_slot=t+a++)}return a}function P(){return{type:"CLIP",frame_start:0,frame_end:0,scheduled:!1,paused:!1,anim_name:"",anim_uuid:"",anim_slot:0,name_list:null,action_frame_start:0,action_frame_end:0,ext_frame_start:0,ext_frame_end:0,use_reverse:!1,scale:1,repeat:1,action_frame_final:0}}function A(e,t,_){if(e.animation_data){var r=e.animation_data,a=r.nla_tracks;if(a)for(var n=0;n<a.length;n++)a[n].name_list=_,t.push(a[n])}for(var o=e.nodes,n=0;n<o.length;n++){var i=o[n];if(i.node_group){var s=i.node_group.node_tree;if(s){var E=_.slice();E.push(i.name),A(s,t,E)}}}}function S(e,t){e.is_stopped=!0,e.frame_offset-=t-e.range_end,e.user_callback&&e.user_callback()}function p(e,t){return e.user_callback&&e.user_callback(),U(e.range_start,t),e.rewinded_to_start=!0,R(e,t)}function O(e,t,_){for(var r=0;r<e.objects.length;r++){var a=e.objects[r];if(a)for(var n=0;n<a.length;n++){for(var o=a[n],i=o.nla_events,s=0;s<i.length;s++){var E=i[s];"SOUND"==E.type&&t<e.last_frame-q&&(E.scheduled=!1)}for(var s=0;s<i.length;s++){var E=i[s];switch(E.type){case"CLIP":if(E.ext_frame_start<=t&&t<E.ext_frame_end&&!E.scheduled){I(o,E,t,_);for(var r=0;r<i.length;r++)i[r]!=E&&i[r].anim_slot==E.anim_slot&&(i[r].scheduled=!1);E.scheduled=!0}E.scheduled&&b(o,E,t,_);break;case"SOUND":(t<e.last_frame-q||e.last_frame<E.frame_start)&&E.frame_start<=t&&t<E.frame_end&&(E.scheduled||(Y(o,E,t),E.scheduled=!0)),e.last_frame<E.frame_end&&E.frame_end<=t&&E.scheduled&&(E.scheduled=!1)}}}}}function v(e,t,_){for(var r=0;r<t.textures.length;r++){var a=t.textures[r];if(a.video_file||a.seq_video){var n=j.video_get_current_frame(a),o=N(_,a),i=j.video_get_start_frame(a),s=!1,E=!1;if((t.force_update||t.rewinded_to_start)&&(E=!0),!t.is_stopped){var c=g(_,a),l=j.video_is_played(a);a.use_cyclic&&o==i&&(E=!0),l||n==o||(E=!0),c&&!l?j.play_video(a):c&&l?s=!0:!c&&l&&(a.video_file&&n<o?s=!0:j.pause_video(a))}if(E)j.set_frame_video(a.video_tex_name,o,a.vtex_data_id),a.seq_video&&(a.seq_last_discrete_mark=j.seq_video_get_discrete_timemark(a,e));else if(s&&j.video_update_is_available(a))if(a.video_file)j.update_video_texture(a);else{var T=j.seq_video_get_discrete_timemark(a,e);T!=a.seq_last_discrete_mark&&(a.seq_cur_frame=o,j.update_seq_video_texture(a)),a.seq_last_discrete_mark=T}}}}function m(e,t){var _=Math.round(e)-t.frame_start;return t.use_cyclic&&(_%=t.frame_duration)<0&&(_+=t.frame_duration),t.frame_offset+_}function N(e,t){var _=m(e,t),r=d.M(_,t.frame_offset,t.frame_offset+j.video_get_duration(t)-1);return t.seq_video&&(r=j.video_frame_to_seq_frame(t,r))==t.seq_movie_length&&r--,r}function g(e,t){var _=m(e,t);return t.frame_offset<=_&&_<=t.frame_offset+j.video_get_duration(t)}function R(e,t){var _=(t-V)*Q.get_framerate()+e.frame_offset;if(_>e.frame_start){if(_-=e.frame_start,e.cyclic){_%=e.frame_end-e.frame_start+1}_+=e.frame_start}else _=e.frame_start;return _}function I(e,t,_,r){var a=t.name_list;""!=t.anim_uuid?G.apply_by_uuid(e,a,t.anim_uuid,t.anim_slot):G.apply(e,a,t.anim_name,t.anim_slot),G.set_behavior(e,G.AB_FINISH_STOP,t.anim_slot);var n=h(t.frame_start,t);G.set_frame(e,n,t.anim_slot)}function b(e,t,_,r){var a=h(_,t),n=G.get_current_frame_float(e,t.anim_slot);Math.abs(a-n)>q&&G.set_frame(e,a,t.anim_slot)}function h(e,t){if((e=d.M(e,t.frame_start,t.frame_end))==t.frame_end)var _=t.action_frame_final;else var r=(e-t.frame_start)/t.scale,a=t.action_frame_end-t.action_frame_start,n=r%a,_=t.action_frame_start+n;return t.use_reverse&&(_=t.action_frame_end-_+t.action_frame_start),_}function Y(e,t,_){var r=(t.frame_start-_)/Q.get_framerate(),a=(t.frame_end-t.frame_start)/Q.get_framerate();H.play(e,r,a)}function L(e,t){for(var _=[],r=0;r<e.length;r++){var a=e[r],n=a.strips;if(n)for(var o=0;o<n.length;o++){var i=n[o],s=P();s.type=i.type,s.frame_start=i.frame_start,s.frame_end=i.frame_end,s.anim_slot=t,s.action_frame_start=i.action_frame_start,s.action_frame_end=i.action_frame_end,s.use_reverse=i.use_reverse,s.scale=i.scale,s.repeat=i.repeat,i.action&&(s.anim_name=i.action.name,s.anim_uuid=i.action.uuid,s.name_list=a.name_list),_.push(s)}}return _}function M(e){return!("SPEAKER"!=e.type&&"LAMP"!=e.type||!e.data.animation_data||!e.data.animation_data.nla_tracks.length)}function x(e){if("MESH"!=e.type||!e.data)return!1;var t=e.data.materials;if(!t)return!1;for(var _=0;_<t.length;_++){var r=t[_],a=r.node_tree;if(r.use_nodes&&a&&y(a))return!0}return!1}function y(e,t){if(e.animation_data){var _=e.animation_data,r=_.nla_tracks;if(r&&r.length)return!0}for(var a=e.nodes,n=0;n<a.length;n++){var o=a[n];if(o.node_group){var i=o.node_group.node_tree;i&&y(i,t)}}return!1}function U(e,t){var _=X.get_active();if(_._nla){var r=R(_._nla,t);_._nla.frame_offset-=r-e,_._nla.force_update=!0}}function w(e){var t=X.get_active();return t._nla?R(t._nla,e):-1}function C(){var e=X.get_active();if(e._nla){e._nla.is_stopped=!0;for(var t=e._nla.textures,_=0;_<t.length;_++){var r=t[_];j.pause_video(r)}}}function D(e){var t=X.get_active();t._nla&&(t._nla.is_stopped=!1,t._nla.user_callback=e||null)}function F(){var e=X.get_active();if(!e._nla)return!1;var t=e._nla;t.range_start=t.frame_start,t.range_end=t.frame_end}var G=Object(n.a)(e),k=Object(o.a)(e),K=Object(i.a)(e),B=Object(s.a)(e),X=Object(E.a)(e),H=Object(c.a)(e),j=Object(l.a)(e),Q=Object(T.a)(e),z=[],V=-1,q=1e-6;t.update_object=function(e,t){var r=_(t);if(r){r.obj_has_nla_on_scene=!0;var a=0,n=e.animation_data;if(n&&n.nla_tracks.length){var o=n.nla_tracks;if(K.is_armature(t)||K.is_camera(t)||K.is_mesh(t)||K.is_empty(t)||K.is_line(t)||K.is_lamp(t)||K.is_speaker(t)||K.is_world(t)){var i=L(o,a);i.length&&(t.nla_events=t.nla_events.concat(i),a++)}}if(M(e)){var o=e.data.animation_data.nla_tracks,i=L(o,a);i.length&&(t.nla_events=t.nla_events.concat(i),a++)}if(K.is_mesh(t))for(var s=t.materials,E=0;E<s.length;E++){var c=s[E];if(c.use_nodes&&c.node_tree){var o=[];A(c.node_tree,o,[c.name]);var i=L(o,a);i.length&&(a+=f(i,a),t.nla_events=t.nla_events.concat(i))}}if(K.is_world(t)){if(e.use_nodes&&e.node_tree){var o=[];A(e.node_tree,o,[e.name]);var i=L(o,a);i.length&&(a+=f(i,a),t.nla_events=t.nla_events.concat(i))}}else{for(var E=0;E<e.particle_systems.length;E++){var l=e.particle_systems[E],T=l.settings;if("EMITTER"==T.type&&T.b4w_allow_nla){var d=P();d.type="CLIP",d.frame_start=r.scene.frame_start,d.frame_end=r.scene.frame_end+1,d.anim_name=l.name,d.anim_slot=a,d.action_frame_start=d.frame_start,d.action_frame_end=d.frame_end,t.nla_events.push(d),a++}}for(var u=a+1,E=0;E<t.vertex_anim.length;E++){var S=t.vertex_anim[E];if(S.allow_nla){a=u;var d=P();d.type="CLIP",d.frame_start=S.frame_start,d.frame_end=S.frame_end,d.anim_name=S.name,d.anim_slot=a,d.action_frame_start=d.frame_start,d.action_frame_end=d.frame_end,t.nla_events.push(d)}}}}},t.update_scene=function(e,t,_){e._nla||(e._nla={frame_start:e.frame_start,frame_end:e.frame_end,frame_offset:0,last_frame:-1,range_end:e.frame_end,range_start:e.frame_start,user_callback:null,cyclic:t,objects:[],textures:[],scene_name:e.name,is_stopped:!1,force_update:!1,rewinded_to_start:!0},z.push(e._nla));for(var n=e._nla,o=k.get_scene_objs_derived(e,"ALL",_),i=0;i<o.length;i++){var s=o[i];if(s.nla_events.length){n.objects[_]||(n.objects[_]=[]);for(var E=0;E<s.scenes_data.length;E++){var c=s.scenes_data[E];c.scene==e&&c.obj_has_nla_on_scene&&n.objects[_].push(s)}r(s.nla_events,n,s.name),a(s.nla_events,n)}}for(var l=e._render.video_textures,i=0;i<l.length;i++){var T=l[i]._render;if(T.use_nla&&(T.video_file||T.seq_video)&&T.vtex_data_id==_){var u=P();u.type="VIDEO",T.use_cyclic?(u.frame_start=0,u.frame_end=n.frame_end):(u.frame_start=d.M(T.frame_start,0,n.frame_end),u.frame_end=d.M(T.frame_start+T.frame_duration,0,n.frame_end)),u.anim_name=l[i].name,n.textures.push(T)}}},t.prepare=function(){for(var e=0;e<z.length;e++)for(var t=z[e],_=0;_<t.objects.length;_++){var r=t.objects[_];if(r)for(var e=0;e<r.length;e++)for(var a=r[e],n=a.nla_events,o=0;o<n.length;o++){var i=n[o];G.init_action_cache(a,i.name_list,i.uuid,i.anim_name,i.anim_slot)}}},t.start=function(){V=0},t.get_start_time=function(){return V},t.get_frame_offset=function(e){return e._nla?e._nla.frame_offset:null},t.set_frame_offset=function(e,t){return!!e._nla&&(e._nla.frame_offset=t,!0)},t.update=function(e,t){if(!(V<0)){0==V&&(V=e);for(var _=0;_<z.length;_++){var r=z[_];r.is_stopped&&(r.frame_offset-=Q.get_framerate()*t);var a=R(r,e);(!r.is_stopped||r.force_update)&&a>=r.range_end&&(r.cyclic?a=p(r,e):S(r,a)),r.is_stopped&&!r.force_update||(O(r,a,t),v(e,r,a),r.last_frame=a),r.force_update=!1,r.rewinded_to_start=!1}}},t.cleanup=function(e){if(0==e)z.length=0,V=-1;else for(var t=0;t<z.length;t++)z[t].objects[e]=null},t.bpy_obj_has_nla=function(e){var t=e.animation_data;return!!(t&&t.nla_tracks.length||M(e)||x(e))},t.set_frame=U,t.get_frame=w,t.stop_nla=C,t.play_nla=D,t.get_frame_start=function(){var e=X.get_active();return e._nla?e._nla.frame_start:-1},t.get_frame_end=function(){var e=X.get_active();return e._nla?e._nla.frame_end:-1},t.is_play=function(){var e=X.get_active();return!!e._nla&&!e._nla.is_stopped},t.check_nla=function(){var e=X.get_active();return!!e._nla&&e.b4w_use_nla},t.check_logic_nodes=function(){var e=X.get_active();return!!e._nla&&e.b4w_logic_nodes.length>0},t.set_range=function(e,t){var _=X.get_active();if(!_._nla)return!1;_._nla.range_start=e,_._nla.range_end=t},t.set_range_end=function(e){var t=X.get_active();if(!t._nla)return!1;t._nla.range_end=e},t.set_range_start=function(e){var t=X.get_active();if(!t._nla)return!1;t._nla.range_start=e},t.reset_range=F,t.set_cyclic=function(e){var t=X.get_active();if(!t._nla)return!1;t._nla.cyclic=e},t.clear_callback=function(){var e=X.get_active();e._nla&&(e._nla.user_callback=null)},t.set_offset_from_range_start=function(e){var t=X.get_active(),_=t._nla;_&&(_.frame_offset=-(e-V)*Q.get_framerate()+_.range_start,_.force_update=!0)},t.get_frame_end=function(){var e=X.get_active(),t=e._nla;return t?t.frame_end:null}}var a=_(0),n=_(37),o=_(12),i=_(8),s=_(1),E=_(10),c=_(23),l=_(17),T=_(18),d=_(2),u=Object(a.a)("__nla",r);t.a=u},function(e,t,_){"use strict";function r(e,t){function _(e,t){return t||(t=D.get_container()),{type:e,value:0,payload:null,element:t,do_activation:!1,key:0,collision_id:"",calc_pos_norm:!1,collision_obj:null,collision_cb:function(){},col_imp_obj:null,col_imp_cb:function(){},source_object:null,from:new Float32Array(3),to:new Float32Array(3),is_binary_value:!1,ign_src_rot:!1,ray_test_id:0,ray_test_cb:function(){},axis:"",time_last:0,trans_last:new Float32Array(3),quat_last:new Float32Array(4),threshold:0,quat_temp:new Float32Array(4),avg_linear_vel:0,avg_angular_vel:0,rotation_threshold:0,avg_vertical_vel:0,period:0,repeat:!1,enable_toggle_switch:!1,gamepad_id:0,position:P.create(),orientation:T.create(),callback:function(){}}}function r(e){e.mouse_select_data.is_updated||(e.mouse_select_data.obj=G.pick_object(e.mouse_select_data.coord[0],e.mouse_select_data.coord[1]),e.mouse_select_data.is_updated=!0,e.global_selected_obj=e.mouse_select_data.obj);for(var t=0;t<Ge;++t){var _=e.touch_select_dlist[t];_.is_updated||(_.obj=G.pick_object(_.coord[0],_.coord[1]),_.is_updated=!0,e.global_selected_obj=_.obj)}}function a(e){if(!e.is_updated_keyboard){for(var t=0;t<e.downed_keys.length;t++)e.downed_keys[t]==we?e.downed_keys[t]=Ce:e.downed_keys[t]==De&&(e.downed_keys[t]=Ue);e.is_updated_keyboard=!0}e.mouse_state==we?e.mouse_state=Ce:e.mouse_state==De&&(e.mouse_state=Ue);for(var _=0;_<e.touch_select_dlist.length;_++){var r=e.touch_select_dlist[_];r.touch_state==we?r.touch_state=Ce:r.touch_state==De&&(r.touch_state=Ue)}e.wheel_delta=0,e.mouse_last_x=e.mouse_curr_x,e.mouse_last_y=e.mouse_curr_y,e.downed_keys[0]=Ue,e.touches_last_x.set(e.touches_curr_x),e.touches_last_y.set(e.touches_curr_y),e.touch_zoom_last_dist=e.touch_zoom_curr_dist,e.gyro_gamma_last=e.gyro_gamma_new,e.gyro_beta_last=e.gyro_beta_new,e.gyro_alpha_last=e.gyro_alpha_new,e.is_updated_gyro_quat=!1}function A(e){function t(){return{coord:new Float32Array(2),is_updated:!0,obj:null,identifier:-1,touch_state:Ue}}e||(e=D.get_container());for(var _=0;_<q.length;_++){var r=q[_];if(e==r.element)return r}for(var r={element:e,is_updated_keyboard:!0,mouse_state:Ue,is_touch_ended:!0,mouse_last_x:0,mouse_last_y:0,mouse_curr_x:0,mouse_curr_y:0,pointerlock_dx:0,pointerlock_dy:0,touches_last_x:new Float32Array(2),touches_curr_x:new Float32Array(2),touches_last_y:new Float32Array(2),touches_curr_y:new Float32Array(2),touch_zoom_curr_dist:0,touch_zoom_last_dist:0,touch_start_rot:0,downed_keys:new Uint8Array(256),wheel_delta:0,global_selected_obj:null,mouse_select_data:t(),touch_select_dlist:new Array(Ge),is_updated_gyro_quat:!1,gyro_quat:T.create(),gyro_gamma_new:0,gyro_beta_new:0,gyro_alpha_new:0,gyro_gamma_last:0,gyro_beta_last:0,gyro_alpha_last:1/0,orientation_quat_cb:null,orientation_angles_cb:null,mouse_wheel_cb:null,mouse_down_which_cb:null,mouse_select_cb:null,touch_select_start_cb:null,touch_select_end_cb:null,mouse_up_which_cb:null,mouse_location_cb:null,pointerlock_cb:null,keyboard_downed_keys_cb:null,touch_start_cb:null,touch_move_cb:null,touch_end_cb:null,registered_accum_values:{}},_=0;_<Ge;++_)r.touch_select_dlist[_]=t();return r.orientation_quat_cb=function(e){r.is_updated_gyro_quat||(F.gyro_angles_to_quat(e,r.gyro_quat),r.is_updated_gyro_quat=!0)},r.orientation_angles_cb=function(e){var t=P.copy(e,Z);r.gyro_alpha_new=t[0],r.gyro_beta_new=t[1],r.gyro_gamma_new=t[2],r.gyro_alpha_last==1/0&&(r.gyro_alpha_last=t[0],r.gyro_beta_last=t[1],r.gyro_gamma_last=t[2])},r.mouse_wheel_cb=function(e){r.wheel_delta+=e*X.mouse_wheel_notch_multiplier},r.mouse_down_which_cb=function(e){var t=F.get_device_by_type_element(F.DEVICE_MOUSE,r.element),_=F.get_vector_param(t,F.MOUSE_LOCATION,W);r.mouse_last_x=_[0],r.mouse_last_y=_[1],r.mouse_curr_x=_[0],r.mouse_curr_y=_[1],r.mouse_state!=De&&r.mouse_state!=Ue||(r.mouse_state=we),r.which=e},r.mouse_select_cb=function(e){var t=F.get_device_by_type_element(F.DEVICE_MOUSE,r.element),_=F.get_vector_param(t,F.MOUSE_LOCATION,W),a=D.client_to_canvas_coords(_[0],_[1],W);r.mouse_select_data.is_updated=!1,r.mouse_select_data.coord[0]=a[0],r.mouse_select_data.coord[1]=a[1]},r.touch_select_start_cb=function(e){for(var t=0;t<e.length;++t){for(var _=e[t],a=null,n=null,o=0;o<r.touch_select_dlist.length;o++){var i=r.touch_select_dlist[o],s=i.touch_state==De||i.touch_state==Ue;if(i.identifier==_.identifier){s&&(n=i);break}!a&&s&&(a=i,a.identifier=_.identifier)}var E=n||a;if(E){var c=D.client_to_canvas_coords(e[t].clientX,e[t].clientY,W);E.is_updated=!1,E.touch_state=we,E.coord[0]=c[0],E.coord[1]=c[1]}}},r.touch_select_end_cb=function(e){for(var t=0;t<r.touch_select_dlist.length;++t){for(var _=r.touch_select_dlist[t],a=!1,n=0;n<e.length;++n){if(e[n].identifier==_.identifier){a=!0;break}}a||(_.touch_state!=Ue&&(_.touch_state=De),_.obj=null)}},r.mouse_up_which_cb=function(e){var t=F.get_device_by_type_element(F.DEVICE_MOUSE,r.element),_=F.get_vector_param(t,F.MOUSE_LOCATION,W);r.mouse_last_x=_[0],r.mouse_last_y=_[1],r.mouse_curr_x=_[0],r.mouse_curr_y=_[1],r.mouse_state!=Ue&&(r.mouse_state=De),r.which=e},r.mouse_location_cb=function(e){H.ie11_edge_touchscreen_hack&&r.mouse_state==Ue||(r.mouse_curr_x=e[0],r.mouse_curr_y=e[1])},r.pointerlock_cb=function(e){r.pointerlock_dx+=e[0],r.pointerlock_dy+=e[1]},r.keyboard_down_keys_cb=function(e){r.downed_keys[e]!=Ce&&(r.downed_keys[e]=we,r.is_updated_keyboard=!1)},r.keyboard_down_mod_keys_cb=function(e){for(var t=0;t<r.downed_keys.length;t++)r.downed_keys[t]!=Ue&&(r.downed_keys[t]=De,r.is_updated_keyboard=!1)},r.keyboard_up_keys_cb=function(e){r.is_updated_keyboard=!1,r.downed_keys[e]=De},r.touch_start_cb=function(e){if(r.is_touch_ended=!1,1==e.length)r.touches_last_x[0]=e[0].clientX,r.touches_last_x[1]=-1,r.touches_last_y[0]=e[0].clientY,r.touches_last_y[1]=-1;else if(e.length>1){var t=M(e);r.touch_zoom_curr_dist=r.touch_zoom_last_dist=t,r.touches_last_x[0]=e[0].clientX,r.touches_last_x[1]=e[1].clientX,r.touches_last_y[0]=e[0].clientY,r.touches_last_y[1]=e[1].clientY,r.touch_start_rot=x(e)}r.touches_curr_x.set(r.touches_last_x),r.touches_curr_y.set(r.touches_last_y)},r.touch_move_cb=function(e){if(1===e.length)r.touches_curr_x[0]=e[0].clientX,r.touches_curr_x[1]=-1,r.touches_curr_y[0]=e[0].clientY,r.touches_curr_y[1]=-1;else if(e.length>1){r.touches_curr_x[0]=e[0].clientX,r.touches_curr_x[1]=e[1].clientX,r.touches_curr_y[0]=e[0].clientY,r.touches_curr_y[1]=e[1].clientY;var t=M(e);r.touch_zoom_curr_dist=t}},r.touch_end_cb=function(e){0==e.length&&(r.is_touch_ended=!0)},q.push(r),r}function S(e,t){if(t in e.registered_accum_values&&e.registered_accum_values[t]>0)return void(e.registered_accum_values[t]+=1);switch(e.registered_accum_values[t]=1,t){case"orientation_quat":var _=F.get_device_by_type_element(F.DEVICE_GYRO);_&&F.attach_param_cb(_,F.GYRO_ORIENTATION_ANGLES,e.orientation_quat_cb);break;case"orientation_angles":var _=F.get_device_by_type_element(F.DEVICE_GYRO);_&&F.attach_param_cb(_,F.GYRO_ORIENTATION_ANGLES,e.orientation_angles_cb);break;case"mouse_wheel":var _=F.get_device_by_type_element(F.DEVICE_MOUSE,e.element);_&&F.attach_param_cb(_,F.MOUSE_WHEEL,e.mouse_wheel_cb);break;case"mouse_down_which":var _=F.get_device_by_type_element(F.DEVICE_MOUSE,e.element);_&&F.attach_param_cb(_,F.MOUSE_DOWN_WHICH,e.mouse_down_which_cb);break;case"mouse_select":var _=F.get_device_by_type_element(F.DEVICE_MOUSE,e.element);_&&F.attach_param_cb(_,F.MOUSE_DOWN_WHICH,e.mouse_select_cb);break;case"touch_select":var _=F.get_device_by_type_element(F.DEVICE_TOUCH,e.element);_&&(F.attach_param_cb(_,F.TOUCH_START,e.touch_select_start_cb),F.attach_param_cb(_,F.TOUCH_END,e.touch_select_end_cb));break;case"mouse_up_which":var _=F.get_device_by_type_element(F.DEVICE_MOUSE,e.element);_&&F.attach_param_cb(_,F.MOUSE_UP_WHICH,e.mouse_up_which_cb);break;case"mouse_location":var _=F.get_device_by_type_element(F.DEVICE_MOUSE,e.element);_&&F.attach_param_cb(_,F.MOUSE_LOCATION,e.mouse_location_cb);break;case"mouse_pointerlock":var _=F.get_device_by_type_element(F.DEVICE_MOUSE,e.element);_&&F.attach_param_cb(_,F.MOUSE_LOCATION_PL,e.pointerlock_cb);break;case"keyboard_downed_keys":var _=F.get_device_by_type_element(F.DEVICE_KEYBOARD,e.element);_&&(F.attach_param_cb(_,F.KEYBOARD_DOWN,e.keyboard_down_keys_cb),F.attach_param_cb(_,F.KEYBOARD_DOWN_MODIFIED,e.keyboard_down_mod_keys_cb),F.attach_param_cb(_,F.KEYBOARD_UP,e.keyboard_up_keys_cb));break;case"touch_start":var _=F.get_device_by_type_element(F.DEVICE_TOUCH,e.element);_&&F.attach_param_cb(_,F.TOUCH_START,e.touch_start_cb);break;case"touch_move":var _=F.get_device_by_type_element(F.DEVICE_TOUCH,e.element);_&&F.attach_param_cb(_,F.TOUCH_MOVE,e.touch_move_cb);break;case"touch_end":var _=F.get_device_by_type_element(F.DEVICE_TOUCH,e.element);_&&F.attach_param_cb(_,F.TOUCH_END,e.touch_end_cb)}}function p(e,t){if(t in e.registered_accum_values&&e.registered_accum_values[t]>0&&(e.registered_accum_values[t]-=1,!e.registered_accum_values[t]))switch(t){case"orientation_quat":var _=F.get_device_by_type_element(F.DEVICE_GYRO);_&&F.detach_param_cb(_,F.GYRO_ORIENTATION_QUAT,e.orientation_quat_cb);break;case"orientation_angles":var _=F.get_device_by_type_element(F.DEVICE_GYRO);_&&F.detach_param_cb(_,F.GYRO_ORIENTATION_ANGLES,e.orientation_angles_cb);break;case"mouse_wheel":var _=F.get_device_by_type_element(F.DEVICE_MOUSE,e.element);_&&F.detach_param_cb(_,F.MOUSE_WHEEL,e.mouse_wheel_cb);break;case"mouse_down_which":var _=F.get_device_by_type_element(F.DEVICE_MOUSE,e.element);_&&F.detach_param_cb(_,F.MOUSE_DOWN_WHICH,e.mouse_down_which_cb);break;case"mouse_select":var _=F.get_device_by_type_element(F.DEVICE_MOUSE,e.element);_&&F.detach_param_cb(_,F.MOUSE_DOWN_WHICH,e.mouse_select_cb);break;case"touch_select":var _=F.get_device_by_type_element(F.DEVICE_TOUCH,e.element);_&&(F.detach_param_cb(_,F.TOUCH_START,e.touch_select_start_cb),F.detach_param_cb(_,F.TOUCH_END,e.touch_select_end_cb));break;case"mouse_up_which":var _=F.get_device_by_type_element(F.DEVICE_MOUSE,e.element);_&&F.detach_param_cb(_,F.MOUSE_UP_WHICH,e.mouse_up_which_cb);break;case"mouse_location":var _=F.get_device_by_type_element(F.DEVICE_MOUSE,e.element);_&&F.detach_param_cb(_,F.MOUSE_LOCATION,e.mouse_location_cb);break;case"mouse_pointerlock":var _=F.get_device_by_type_element(F.DEVICE_MOUSE,e.element);_&&F.detach_param_cb(_,F.MOUSE_LOCATION_PL,e.pointerlock_cb);break;case"keyboard_downed_keys":var _=F.get_device_by_type_element(F.DEVICE_KEYBOARD,e.element);_&&(F.detach_param_cb(_,F.KEYBOARD_DOWN,e.keyboard_down_keys_cb),F.detach_param_cb(_,F.KEYBOARD_DOWN_MODIFIED,e.keyboard_down_mod_keys_cb),F.detach_param_cb(_,F.KEYBOARD_UP,e.keyboard_up_keys_cb));break;case"touch_start":var _=F.get_device_by_type_element(F.DEVICE_TOUCH,e.element);_&&F.detach_param_cb(_,F.TOUCH_START,e.touch_start_cb);break;case"touch_move":var _=F.get_device_by_type_element(F.DEVICE_TOUCH,e.element);_&&F.detach_param_cb(_,F.TOUCH_MOVE,e.touch_move_cb);break;case"touch_end":var _=F.get_device_by_type_element(F.DEVICE_TOUCH,e.element);_&&F.detach_param_cb(_,F.TOUCH_END,e.touch_end_cb)}}function O(e,t){e.value=Number(t)}function v(e){for(var t=e.sensors,_=e.sensor_values,r=0;r<t.length;r++)_[r]=t[r].value;return e.logic_fun(_)}function m(e,_,r){if(r)switch(e.type){case de:var a=e.source_object,n=u.i(a.render.world_tsr,Z),o=u.f(a.render.world_tsr,$),i=P.dist(e.trans_last,n),s=e.quat_temp;T.invert(e.quat_last,s),T.multiply(o,s,s),T.normalize(s,s);var E=Math.abs(2*Math.acos(s[3])),c=i/r;e.avg_linear_vel=f._50(c,e.avg_linear_vel,r,Me),e.payload[0]=c;var l=E/r;e.avg_angular_vel=f._50(l,e.avg_angular_vel,r,Me),e.payload[1]=l,e.avg_linear_vel>=e.threshold||e.avg_angular_vel>=e.rotation_threshold?O(e,1):O(e,0),P.copy(n,e.trans_last),T.copy(o,e.quat_last),e.time_last=_;break;case ue:var a=e.source_object,n=u.i(a.render.world_tsr,Z),d=Math.abs(n[1]-e.trans_last[1])/r;e.avg_vertical_vel=f._50(d,e.avg_vertical_vel,r,Me),e.payload=d,e.avg_vertical_vel>=e.threshold?O(e,1):O(e,0),P.copy(n,e.trans_last),e.time_last=_;break;case fe:!e.do_activation&&e.period>=0&&_-e.time_last>=e.period&&(O(e,1),e.repeat?e.time_last=_:e.period=-e.period);break;case Pe:e.time_last||(e.time_last=_),O(e,_-e.time_last),e.time_last=_;break;case Ae:O(e,_);break;case pe:var S=A(e.element);e.payload[0]=S.gyro_gamma_new-S.gyro_gamma_last,e.payload[1]=S.gyro_beta_new-S.gyro_beta_last,e.payload[2]=S.gyro_alpha_new-S.gyro_alpha_last;break;case Oe:var S=A(e.element);e.payload[0]=S.gyro_gamma_new,e.payload[1]=S.gyro_beta_new,e.payload[2]=S.gyro_alpha_new;break;case ve:var S=A(e.element);T.copy(S.gyro_quat,e.payload);break;case me:var p=F.get_device_by_type_element(F.DEVICE_HMD);F.get_vector_param(p,F.HMD_ORIENTATION_QUAT,e.payload);break;case Ne:var p=F.get_device_by_type_element(F.DEVICE_HMD);F.get_vector_param(p,F.HMD_POSITION,e.payload);break;case Re:var p=y(e.gamepad_id);e.value=F.get_gamepad_btn_value(p,e.key);break;case Ie:var p=y(e.gamepad_id);e.value=F.get_gamepad_axis_value(p,e.key);break;case be:var p=y(e.gamepad_id);F.get_gamepad_position(p,e.payload),O(e,1);break;case he:var p=y(e.gamepad_id);F.get_gamepad_orientation(p,e.payload),O(e,1);break;case ge:O(e,e.callback());break;case re:var S=A(e.element);O(e,S.wheel_delta);break;case ae:var S=A(e.element);if(!H.ie11_edge_touchscreen_hack||S.mouse_state==we||S.mouse_state==Ce){var v=S.mouse_curr_x-S.mouse_last_x,m=S.mouse_curr_y-S.mouse_last_y;switch(e.payload.coords[0]=S.mouse_curr_x,e.payload.coords[1]=S.mouse_curr_y,e.axis){case"X":O(e,v);break;case"Y":O(e,m);break;case"XY":var N=Math.sqrt(v*v+m*m);O(e,N)}}break;case Ye:var S=A(e.element),v=S.pointerlock_dx,m=S.pointerlock_dy,g=f._50(v,0,r,U()),R=f._50(m,0,r,U());Math.abs(v)>ye||Math.abs(m)>ye?(S.pointerlock_dx-=g,S.pointerlock_dy-=R,e.payload.coords[0]=g,e.payload.coords[1]=R):(e.payload.coords[0]=0,e.payload.coords[1]=0),O(e,Math.sqrt(v*v+m*m));break;case ne:var S=A(e.element);O(e,S.mouse_state!=Ue|0),e.payload.which=S.which,e.payload.coords[0]=S.mouse_curr_x,e.payload.coords[1]=S.mouse_curr_y;break;case Se:var S=A(e.element);if(O(e,0),e.enable_toggle_switch)S.global_selected_obj==e.source_object&&O(e,1);else if(S.mouse_state!=Ue&&S.mouse_select_data.obj==e.source_object)O(e,1);else for(var I=0;I<Ge;++I){var b=S.touch_select_dlist[I];if(b.touch_state!=Ue&&b.obj==e.source_object){O(e,1);break}}break;case _e:var S=A(e.element);e.payload=S.downed_keys[e.key],1==e.payload||S.downed_keys[0]&&e.key==Fe?O(e,1):e.payload||O(e,0);break;case oe:var S=A(e.element);if(-1==S.touches_curr_x[1]&&-1==S.touches_curr_y[1]){var v=S.touches_curr_x[0]-S.touches_last_x[0],m=S.touches_curr_y[0]-S.touches_last_y[0],N=Math.sqrt(v*v+m*m);if(-1!=S.touches_last_x[1]&&-1!=S.touches_last_y[1]){var h=S.touches_curr_x[0]-S.touches_last_x[1],Y=S.touches_curr_y[0]-S.touches_last_y[1],L=Math.sqrt(h*h+Y*Y);L<N&&(v=h,m=Y,N=L)}e.payload.gesture=t.PL_SINGLE_TOUCH_MOVE}else{var M=W;M[0]=(S.touches_curr_x[0]+S.touches_curr_x[1])/2,M[1]=(S.touches_curr_y[0]+S.touches_curr_y[1])/2;var x=J;x[0]=(S.touches_last_x[0]+S.touches_last_x[1])/2,x[1]=(S.touches_last_y[0]+S.touches_last_y[1])/2;var v=M[0]-x[0],m=M[1]-x[1],N=Math.sqrt(v*v+m*m);e.payload.gesture=t.PL_MULTITOUCH_MOVE_PAN}switch(e.payload.coords[0]=S.touches_curr_x[0],e.payload.coords[1]=S.touches_curr_y[0],e.axis){case"X":O(e,v);break;case"Y":O(e,m);break;case"XY":O(e,N)}break;case ie:var S=A(e.element),w=S.touch_zoom_curr_dist-S.touch_zoom_last_dist;e.payload=t.PL_MULTITOUCH_MOVE_ZOOM,O(e,w);break;case se:var S=A(e.element);if(-1!=S.touches_curr_x[1]){var C=S.touches_curr_x[0]-S.touches_curr_x[1],D=S.touches_curr_y[0]-S.touches_curr_y[1],G=Math.atan2(D,C);e.payload=t.PL_MULTITOUCH_MOVE_ROTATE,O(e,G-S.touch_start_rot)}break;case Ee:var S=A(e.element);e.payload.coords[0]=S.touches_curr_x[0],e.payload.coords[1]=S.touches_curr_y[0],S.is_touch_ended?O(e,0):O(e,1)}}function N(e){var _=0;switch(e.type){case t.CT_POSITIVE:var r=v(e);_=r?1:0;break;case t.CT_CONTINUOUS:var a=e.last_pulse,r=v(e);r?(_=1,e.last_pulse=1):1==a?(_=-1,e.last_pulse=-1):_=0;break;case t.CT_TRIGGER:var a=e.last_pulse,r=v(e);r&&-1==a?(_=1,e.last_pulse=1):r||1!=a?_=0:(_=-1,e.last_pulse=-1);break;case t.CT_SHOT:var a=e.last_pulse,r=v(e);r&&-1==a?(_=1,e.last_pulse=1):r||1!=a?_=0:(_=0,e.last_pulse=-1);break;case t.CT_LEVEL:var r=v(e);e.last_logic_result!=r?(_=1,e.last_logic_result=r):_=0;break;case t.CT_CHANGE:for(var n=e.sensors,o=e.last_sensor_values,i=0;i<n.length;i++){var s=n[i].value;_||s==o[i]||(_=1),o[i]=s}break;default:w.panic("Wrong sensor manifold type: "+e.type)}return _}function g(e){for(var t=0;t<e.length;t++){var _=e[t];switch(_.type){case re:case ae:case oe:case ie:case se:case Ee:case fe:O(_,0)}}}function R(e){for(var t=0;t<e.length;t++)if(!e[t])return e[t];return e[e.length-1]}function I(e){if(e.do_activation){switch(e.type){case ce:K.append_collision_test(e.collision_obj,e.collision_id,e.collision_cb,e.calc_pos_norm);break;case le:K.apply_collision_impulse_test(e.col_imp_obj,e.col_imp_cb);break;case Te:e.ray_test_id=K.append_ray_test(e.source_object,e.from,e.to,e.collision_id,e.ray_test_cb,!1,!1,e.calc_pos_norm,e.ign_src_rot),e.payload.ray_test_id=e.ray_test_id;break;case fe:e.time_last=B.get_timeline(),e.period<0&&(e.period=-e.period);break;case _e:var t=A(e.element);S(t,"keyboard_downed_keys");break;case re:var t=A(e.element);S(t,"mouse_wheel");break;case ae:var t=A(e.element);S(t,"mouse_down_which"),S(t,"mouse_up_which"),S(t,"mouse_location");break;case Ye:var t=A(e.element);S(t,"mouse_pointerlock");break;case Le:F.activate_pointerlock(e);break;case ne:var t=A(e.element);S(t,"mouse_down_which"),S(t,"mouse_up_which");break;case oe:var t=A(e.element);S(t,"touch_start"),S(t,"touch_move"),S(t,"touch_end");break;case ie:case se:var t=A(e.element);S(t,"touch_start"),S(t,"touch_move");break;case Ee:var t=A(e.element);S(t,"touch_start"),S(t,"touch_end");break;case Se:var t=A(e.element);S(t,"mouse_select"),S(t,"touch_select"),S(t,"touch_start"),S(t,"touch_end"),S(t,"mouse_down_which"),S(t,"mouse_up_which");break;case pe:case Oe:var t=A(e.element);S(t,"orientation_angles");break;case ve:var t=A(e.element);S(t,"orientation_quat");break;case Re:case be:case he:0==e.gamepad_id?F.get_device_by_type_element(F.DEVICE_GAMEPAD0):1==e.gamepad_id?F.get_device_by_type_element(F.DEVICE_GAMEPAD1):2==e.gamepad_id?F.get_device_by_type_element(F.DEVICE_GAMEPAD2):F.get_device_by_type_element(F.DEVICE_GAMEPAD3)}e.do_activation=!1}}function b(e,t){e=e||Q;var _=e.sensor_manifolds;if(_){var r=e.sensor_manifolds_arr;if(t){var a=_[t];if(a){for(var n=a.sensors,o=0;o<n.length;o++){var i=n[o],s=Y(i,z,V);if(1==s.length){L(i);var E=z.indexOf(i);E>-1?(z.splice(E,1),V.splice(E,1)):w.panic("Sensors cache is corrupted")}else s.length>1&&s.splice(s.indexOf(a),1)}delete _[t];var c=r.indexOf(a);c>-1?r.splice(c,1):w.panic("Incorrect manifolds array"),Object.getOwnPropertyNames(_).length||h(e)}}else{var l=[];for(var T in _)l.push(T);for(var o=0;o<l.length;o++)b(e,l[o])}ee=!0}}function h(e){var t=j.indexOf(e);if(!(t>-1))return void k.error("Wrong object");j.splice(t,1)}function Y(e,t,_){var r=t.indexOf(e);return r>-1?_[r]:[]}function L(e){switch(e.type){case ce:K.remove_collision_test(e.collision_obj,e.collision_id,e.collision_cb),e.do_activation=!0;break;case le:K.clear_collision_impulse_test(e.col_imp_obj),e.do_activation=!0;break;case Te:K.remove_ray_test(e.ray_test_id),e.do_activation=!0;break;case fe:e.do_activation=!0;break;case _e:var t=A(e.element);p(t,"keyboard_downed_keys"),e.do_activation=!0;break;case re:var t=A(e.element);p(t,"mouse_wheel"),e.do_activation=!0;break;case ae:var t=A(e.element);p(t,"mouse_down_which"),p(t,"mouse_up_which"),p(t,"mouse_location"),e.do_activation=!0;break;case Ye:var t=A(e.element);p(t,"mouse_pointerlock"),e.do_activation=!0;break;case ne:var t=A(e.element);p(t,"mouse_down_which"),p(t,"mouse_up_which"),e.do_activation=!0;break;case oe:var t=A(e.element);p(t,"touch_start"),p(t,"touch_move"),p(t,"touch_end"),e.do_activation=!0;break;case ie:case se:var t=A(e.element);p(t,"touch_start"),p(t,"touch_move"),e.do_activation=!0;break;case Ee:var t=A(e.element);p(t,"touch_start"),p(t,"touch_end"),e.do_activation=!0;break;case Se:var t=A(e.element);p(t,"mouse_select"),p(t,"touch_select"),p(t,"touch_start"),p(t,"touch_end"),p(t,"mouse_down_which"),p(t,"mouse_up_which"),e.do_activation=!0;break;case pe:case Oe:var t=A(e.element);p(t,"orientation_angles"),e.do_activation=!0;break;case ve:var t=A(e.element);p(t,"orientation_quat"),e.do_activation=!0;break;case me:case Ne:e.do_activation=!0}}function M(e){var t=e[0],_=e[1],r=t.clientX-_.clientX,a=t.clientY-_.clientY;return Math.sqrt(r*r+a*a)}function x(e){var t=e[0],_=e[1],r=t.clientX-_.clientX,a=t.clientY-_.clientY;return Math.atan2(a,r)}function y(e){if(0==e)var t=F.get_device_by_type_element(F.DEVICE_GAMEPAD0);else if(1==e)var t=F.get_device_by_type_element(F.DEVICE_GAMEPAD1);else if(2==e)var t=F.get_device_by_type_element(F.DEVICE_GAMEPAD2);else var t=F.get_device_by_type_element(F.DEVICE_GAMEPAD3);return t}function U(){return xe*ke}var w=Object(n.a)(e),C=Object(o.a)(e),D=Object(i.a)(e),F=Object(s.a)(e),G=Object(E.a)(e),k=Object(c.a)(e),K=Object(l.a)(e),B=Object(d.a)(e),X=C.controls,H=C.defaults,j=[],Q={},z=[],V=[],q=[],W=new Float32Array(2),J=new Float32Array(2),Z=P.create(),$=T.create(),ee=!1,te=0,_e=20,re=30,ae=40,ne=50,oe=60,ie=70,se=75,Ee=80,ce=90,le=100,Te=110,de=120,ue=130,fe=140,Pe=150,Ae=160,Se=170,pe=180,Oe=190,ve=200,me=210,Ne=220,ge=230,Re=240,Ie=250,be=260,he=270,Ye=280,Le=290;t.CT_POSITIVE=10,t.CT_CONTINUOUS=20,t.CT_TRIGGER=30,t.CT_SHOT=40,t.CT_LEVEL=50,t.CT_CHANGE=60,t.PL_SINGLE_TOUCH_MOVE=0,t.PL_MULTITOUCH_MOVE_ZOOM=1,t.PL_MULTITOUCH_MOVE_PAN=2,t.PL_MULTITOUCH_MOVE_ROTATE=3;var Me=.3,xe=.1,ye=.01,Ue=0,we=1,Ce=2,De=3,Fe=16,Ge=10,ke=1;t.update=function(e,t){for(var _=0;_<q.length;_++){var n=q[_];r(n)}for(var _=0;_<z.length;_++){m(z[_],e,t)}for(var _=0;_<j.length;_++)for(var o=j[_],i=o.sensor_manifolds_arr,s=0;s<i.length;s++){var E=i[s];if(E.update_counter!=te){E.update_counter=te;var c=N(E);if(c){var l=o==Q?null:o;if(ee=!1,E.callback(l,E.id,c,E.callback_param),ee){_=-1;break}}}}for(var _=0;_<j.length;_++)for(var o=j[_],i=o.sensor_manifolds_arr,s=0;s<i.length;s++){var E=i[s];g(E.sensors)}for(var _=0;_<q.length;_++){var n=q[_];a(n)}te++},t.create_custom_sensor=function(e){var t=_(10);return O(t,e),t},t.create_keyboard_sensor=function(e){var t=document,r=_(_e,t);return r.key=e,r.do_activation=!0,r},t.create_gamepad_btn_sensor=function(e,t){var r=document,a=_(Re,r);return t=t||F.get_first_gmpd_id(),a.gamepad_id=t,a.key=e,a.do_activation=!0,a},t.create_gamepad_axis_sensor=function(e,t){var r=document,a=_(Ie,r);return t=void 0==t?F.get_first_gmpd_id():t,a.gamepad_id=t,a.key=e,a.do_activation=!0,a},t.create_gamepad_position_sensor=function(e){var t=document,r=_(be,t);return e=void 0===e?F.get_first_gmpd_id():e,r.gamepad_id=e,r.do_activation=!0,r.payload=P.create(),r},t.create_gamepad_orientation_sensor=function(e){var t=document,r=_(he,t);return e=void 0===e?F.get_first_gmpd_id():e,r.gamepad_id=e,r.do_activation=!0,r.payload=T.create(),r},t.create_collision_sensor=function(e,t,r){if(!e||!K.obj_has_physics(e))return k.error("Wrong collision object"),null;var a=_(ce);return a.collision_obj=e,a.collision_id=t,a.calc_pos_norm=r,a.payload={coll_obj:null,coll_pos:r?new Float32Array(3):null,coll_norm:r?new Float32Array(3):null,coll_dist:0},a.collision_cb=function(e,t,_,r,n){O(a,e);var o=a.payload;o.coll_obj=t,a.calc_pos_norm&&(o.coll_pos.set(_),o.coll_norm.set(r),o.coll_dist=n)},a.do_activation=!0,a},t.create_collision_impulse_sensor=function(e){if(!e||!e.physics)return k.error("Wrong collision impulse object"),null;var t=_(le);return t.col_imp_obj=e,t.col_imp_cb=function(e){O(t,e)},t.do_activation=!0,t},t.create_ray_sensor=function(e,t,r,a,n,o,i){var s=_(Te);return s.source_object=e,s.from=t,s.to=r,s.collision_id=a,s.is_binary_value=n,s.calc_pos_norm=o,s.ign_src_rot=i,s.payload={hit_fract:0,obj_hit:null,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),ray_test_id:0},s.ray_test_cb=function(e,t,_,r,a,n){s.is_binary_value?O(s,-1==t?0:1):O(s,t),s.payload.hit_fract=t,s.payload.obj_hit=_,s.payload.hit_time=r,s.calc_pos_norm&&(s.payload.hit_pos.set(a),s.payload.hit_norm.set(n))},s.do_activation=!0,s},t.create_mouse_click_sensor=function(e){var t=_(ne,e);return t.do_activation=!0,t.payload={coords:new Float32Array(2),which:null},t},t.create_mouse_wheel_sensor=function(e){var t=_(re,e);return t.do_activation=!0,t},t.create_mouse_move_sensor=function(e,t){var r=_(ae,t);return r.axis=e||"XY",r.payload={coords:new Float32Array(2)},r.do_activation=!0,r},t.create_touch_move_sensor=function(e,t){var r=_(oe,t);return r.axis=e||"XY",r.payload={coords:new Float32Array(2),gesture:0},r.do_activation=!0,r},t.create_touch_zoom_sensor=function(e){var t=_(ie,e);return t.payload=0,t.do_activation=!0,t},t.create_touch_rotate_sensor=function(e){var t=_(se,e);return t.payload=0,t.do_activation=!0,t},t.create_touch_click_sensor=function(e){var t=_(Ee,e);return t.payload={coords:new Float32Array(2)},t.do_activation=!0,t},t.create_motion_sensor=function(e,t,r){if(!e)return k.error("Wrong collision object"),null;var a=_(de);a.source_object=e;var n=u.j(e.render.world_tsr),o=u.g(e.render.world_tsr);return a.quat_temp=new Float32Array(4),a.trans_last=new Float32Array(n),a.quat_last=new Float32Array(o),a.avg_linear_vel=0,a.avg_angular_vel=0,a.threshold=t||.1,a.rotation_threshold=r||.1,a.time_last=0,a.payload=new Float32Array([0,0]),a},t.create_vertical_velocity_sensor=function(e,t){if(!e)return k.error("Wrong collision object"),null;var r=_(ue);r.source_object=e;var a=u.j(e.render.world_tsr),n=u.g(e.render.world_tsr);return r.trans_last=new Float32Array(a),r.quat_last=new Float32Array(n),r.avg_vertical_vel=0,r.threshold=t||1,r.time_last=0,r.payload=0,r},t.create_timer_sensor=function(e,t){var r=_(fe);return r.period=e,r.repeat=t,r.do_activation=!0,r},t.reset_timer_sensor=function(e,t,_,r){e=e||Q;var a=e.sensor_manifolds;if(!a||!a[t])return k.error("reset_timer_sensor(): wrong object"),null;var n=a[t].sensors[_];if(!n)return k.error("reset_timer_sensor(): sensor not found"),null;n.time_last=B.get_timeline(),n.period=r},t.create_elapsed_sensor=function(){var e=_(Pe);return e.time_last=0,e},t.create_gyro_delta_sensor=function(){var e=_(pe,window);return e.payload=new Float32Array(3),F.get_device_by_type_element(F.DEVICE_GYRO)?O(e,1):O(e,0),e.do_activation=!0,e},t.create_gyro_angles_sensor=function(){var e=_(Oe,window);return e.payload=new Float32Array(3),F.get_device_by_type_element(F.DEVICE_GYRO)?O(e,1):O(e,0),e.do_activation=!0,e},t.create_gyro_quat_sensor=function(){var e=_(ve,window);return e.payload=T.create(),F.get_device_by_type_element(F.DEVICE_GYRO)?O(e,1):O(e,0),e.do_activation=!0,e},t.create_hmd_quat_sensor=function(){var e=_(me,window);return e.payload=T.create(),F.get_device_by_type_element(F.DEVICE_HMD)?O(e,1):O(e,0),e.do_activation=!0,e},t.create_hmd_position_sensor=function(){var e=_(Ne,window);return e.payload=P.create(),F.get_device_by_type_element(F.DEVICE_HMD)?O(e,1):O(e,0),e.do_activation=!0,e},t.create_timeline_sensor=function(){return _(Ae)},t.create_selection_sensor=function(e,t){var r=_(Se);return r.source_object=e,r.enable_toggle_switch=t,r.do_activation=!0,r},t.create_callback_sensor=function(e,t){var r=_(ge);return r.callback=e,O(r,t),r},t.create_plock_mouse_sensor=function(e){var t=_(Ye,e);return t.payload={coords:new Float32Array(2)},t.do_activation=!0,t},t.create_plock_sensor=function(e){var t=_(Le,e);return t.do_activation=!0,t},t.sensor_set_value=O,t.get_sensor_value=function(e,t,_){e=e||Q;var r=e.sensor_manifolds;if(!r||!r[t])return k.error("get_sensor_value(): wrong object"),null;var a=r[t].sensors[_];return a?a.value:(k.error("get_sensor_value(): sensor not found"),null)},t.get_sensor_payload=function(e,t,_){e=e||Q;var r=e.sensor_manifolds;if(!r||!r[t])return k.error("get_sensor_payload(): wrong object"),null;var a=r[t].sensors[_];return a?a.payload:(k.error("get_sensor_payload(): sensor not found"),null)},t.cleanup=function(){j=[],Q={};for(var e=0;e<z.length;e++)L(z[e]);z.length=0,V.length=0},t.check_sensor_manifold=function(e,t){if(e=e||Q,!e.sensor_manifolds)return!1;if(t&&e.sensor_manifolds[t])return!0;if(t)return!1;for(var _ in e.sensor_manifolds)return!0;return!1},t.create_sensor_manifold=function(e,t,_,r,a,n,o){e=e||Q,e.sensor_manifolds_arr=e.sensor_manifolds_arr||[],e.sensor_manifolds=e.sensor_manifolds||{};var i=e.sensor_manifolds,s=e.sensor_manifolds_arr;i[t]&&b(e,t);var E={id:t,type:_,sensors:r.slice(0),logic_fun:a,sensor_values:new Array(r.length),callback:n,callback_param:o,last_pulse:-1,last_logic_result:0,last_sensor_values:new Array(r.length),update_counter:-1};i[t]=E,s.push(E),-1==j.indexOf(e)&&j.push(e);for(var c=0;c<E.sensors.length;c++){var l=E.sensors[c];I(l);var T=z.indexOf(l);-1==T?(z.push(l),V.push([E])):V[T].push(E)}ee=!0},t.default_AND_logic_fun=R,t.default_OR_logic_fun=function(e){for(var t=0;t<e.length;t++)if(e[t])return e[t];return e[e.length-1]},t.remove_sensor_manifold=b,t.reset=function(){for(var e=0;e<j.length;e++){var t=j[e],_=t.sensor_manifolds,r=t.sensor_manifolds_arr;for(var a in _)delete _[a];r.length=0}for(var e=0;e<z.length;e++)L(z[e]);j.length=0,z.length=0,V.length=0},t.debug=function(){k.log(String(j.length)+" objects with manifolds",j),k.log(String(z.length)+" sensors",z);for(var e=[],t=[],_=0;_<z.length;_++){var r=z[_];r.type==ce&&e.push(r),r.type==Te&&t.push(r)}k.log(String(e.length)+" collision sensors",e),k.log(String(t.length)+" ray sensors",t)},t.set_plock_smooth_factor=function(e){ke=e}}var a=_(0),n=_(5),o=_(4),i=_(15),s=_(38),E=_(12),c=_(1),l=_(19),T=_(9),d=_(18),u=_(6),f=_(2),P=_(3),A=Object(a.a)("__controls",r);t.a=A},function(e,t,_){"use strict";function r(e,t){function _(e,t,_,r,a){return i.V(e,r[_[0]],r[_[1]],r[_[2]])}function r(e,t,_,r,a){var n=Math.abs(e[2]-t[2]);return n<a&&l.is_vector_in_poly(e,_,r)?n:Number.MAX_VALUE}function a(e,t,r){if(r||(r=_),!E.obj_has_physics(e))return void c.error_once("No physics for object "+e.name);var a=e.physics.navmesh;return a?l.navmesh_get_island(a,t,r):(c.error(e.name+" is not a navigation mesh object"),null)}var E=Object(n.a)(e),c=Object(o.a)(e),l=Object(s.a)(e);t.CM_WALK=0,t.CM_RUN=1,t.CM_CLIMB=2,t.CM_FLY=3,t.enable_simulation=function(e){if(!E.obj_has_physics(e))return void c.error_once("No physics for object "+e.name);E.enable_simulation(e)},t.disable_simulation=function(e){if(!E.obj_has_physics(e))return void c.error_once("No physics for object "+e.name);E.disable_simulation(e)},t.has_physics=function(e){return E.obj_has_physics(e)},t.has_simulated_physics=function(e){return E.has_simulated_physics(e)},t.has_dynamic_physics=function(e){return E.has_dynamic_physics(e)},t.set_gravity=function(e,t){if(c.error_deprecated("set_gravity","set_object_gravity"),!E.obj_has_physics(e))return void c.error_once("No physics for object "+e.name);E.set_gravity(e,0,0,-t)},t.set_object_gravity=function(e,t){if(!E.obj_has_physics(e))return void c.error_once("No physics for object "+e.name);E.set_gravity(e,t[0],t[1],t[2])},t.set_transform=function(e,t,_){if(!E.obj_has_physics(e))return void c.error_once("No physics for object "+e.name);E.set_transform(e,t,_)},t.sync_transform=function(e){if(!E.obj_has_physics(e))return void c.error_once("No physics for object "+e.name);E.sync_transform(e)},t.apply_velocity=function(e,t,_,r){if(!E.obj_has_physics(e))return void c.error_once("No physics for object "+e.name);E.apply_velocity(e,t,_,r)},t.apply_velocity_world=function(e,t,_,r){if(!E.obj_has_physics(e))return void c.error_once("No physics for object "+e.name);E.apply_velocity_world(e,t,_,r)},t.apply_force=function(e,t,_,r){if(!E.obj_has_physics(e))return void c.error_once("No physics for object "+e.name);E.apply_force(e,t,_,r,!1)},t.apply_force_world=function(e,t,_,r){if(!E.obj_has_physics(e))return void c.error_once("No physics for object "+e.name);E.apply_force(e,t,_,r,!0)},t.apply_torque=function(e,t,_,r){if(!E.obj_has_physics(e))return void c.error_once("No physics for object "+e.name);E.apply_torque(e,t,_,r)},t.set_angular_velocity=function(e,t,_,r){if(!E.obj_has_physics(e))return void c.error_once("No physics for object "+e.name);E.set_angular_velocity(e,t,_,r)},t.vehicle_throttle=function(e,t){if(!E.obj_has_physics(e))return void c.error_once("No physics for object "+e.name);E.is_vehicle_chassis(e)||E.is_vehicle_hull(e)||c.error("Wrong object"),E.vehicle_throttle(e,i.M(t,-1,1))},t.vehicle_throttle_inc=function(e,t,_){if(!E.obj_has_physics(e))return void c.error_once("No physics for object "+e.name);E.is_vehicle_chassis(e)||E.is_vehicle_hull(e)||c.error("Wrong object"),t=i.M(t,0,1);var r=e.vehicle,a=r.engine_force;-1==_||1==_?(a+=_*t,a=Math.max(-1,Math.min(a,1))):0==_&&a>=0?(a-=t,a=Math.max(0,a)):0==_&&a<0?(a+=t,a=Math.min(0,a)):c.error("Wrong steering direction"),E.vehicle_throttle(e,i.M(a,-1,1))},t.vehicle_steer=function(e,t){if(!E.obj_has_physics(e))return void c.error_once("No physics for object "+e.name);E.is_vehicle_chassis(e)||E.is_vehicle_hull(e)||c.error("Wrong object"),E.vehicle_steer(e,i.M(t,-1,1))},t.vehicle_steer_inc=function(e,t,_){if(!E.obj_has_physics(e))return void c.error_once("No physics for object "+e.name);E.is_vehicle_chassis(e)||E.is_vehicle_hull(e)||c.error("Wrong object"),t=i.M(t,0,1);var r=e.vehicle,a=r.steering;-1==_||1==_?(a+=_*t,a=Math.max(-1,Math.min(a,1))):0==_&&a>=0?(a-=t,a=Math.max(0,a)):0==_&&a<0?(a+=t,a=Math.min(0,a)):c.error("Wrong steering direction"),E.vehicle_steer(e,i.M(a,-1,1))},t.vehicle_brake=function(e,t){if(!E.obj_has_physics(e))return void c.error_once("No physics for object "+e.name);E.is_vehicle_chassis(e)||E.is_vehicle_hull(e)||c.error("Wrong object"),E.vehicle_brake(e,i.M(t,0,1))},t.vehicle_brake_inc=function(e,t){if(!E.obj_has_physics(e))return void c.error_once("No physics for object "+e.name);E.is_vehicle_chassis(e)||E.is_vehicle_hull(e)||c.error("Wrong object"),t=i.M(t,-1,1);var _=e.vehicle,r=_.brake_force;r+=r*t,E.vehicle_brake(e,i.M(r,0,1))},t.is_vehicle_chassis=function(e){return E.is_vehicle_chassis(e)},t.is_vehicle_hull=function(e){return E.is_vehicle_hull(e)},t.get_vehicle_name=function(e){return E.obj_has_physics(e)?E.is_vehicle_chassis(e)||E.is_vehicle_hull(e)?e.vehicle_settings.name:(c.error("Wrong object"),null):(c.error_once("No physics for object "+e.name),null)},t.get_vehicle_throttle=function(e){return E.obj_has_physics(e)?E.is_vehicle_chassis(e)||E.is_vehicle_hull(e)?e.vehicle.engine_force:(c.error("Wrong object"),null):(c.error_once("No physics for object "+e.name),null)},t.get_vehicle_steering=function(e){return E.obj_has_physics(e)?E.is_vehicle_chassis(e)||E.is_vehicle_hull(e)?e.vehicle.steering:(c.error("Wrong object"),0):(c.error_once("No physics for object "+e.name),0)},t.get_vehicle_brake=function(e){return E.obj_has_physics(e)?E.is_vehicle_chassis(e)||E.is_vehicle_hull(e)?e.vehicle.brake_force:(c.error("Wrong object"),0):(c.error_once("No physics for object "+e.name),0)},t.get_vehicle_speed=function(e){return E.obj_has_physics(e)?E.is_vehicle_chassis(e)||E.is_vehicle_hull(e)?E.get_vehicle_speed(e):(c.error("Wrong object"),0):(c.error_once("No physics for object "+e.name),0)},t.is_character=function(e){return E.has_character_physics(e)},t.set_character_move_dir=function(e,t,_){if(!E.obj_has_physics(e))return void c.error_once("No physics for object "+e.name);E.set_character_move_dir(e,t,_)},t.set_character_move_type=function(e,t){if(!E.obj_has_physics(e))return void c.error_once("No physics for object "+e.name);E.set_character_move_type(e,t)},t.set_character_walk_velocity=function(e,t){if(!E.obj_has_physics(e))return void c.error_once("No physics for object "+e.name);E.set_character_walk_velocity(e,t)},t.set_character_run_velocity=function(e,t){if(!E.obj_has_physics(e))return void c.error_once("No physics for object "+e.name);E.set_character_run_velocity(e,t)},t.set_character_fly_velocity=function(e,t){if(!E.obj_has_physics(e))return void c.error_once("No physics for object "+e.name);E.set_character_fly_velocity(e,t)},t.character_jump=function(e){if(!E.obj_has_physics(e))return void c.error_once("No physics for object "+e.name);E.character_jump(e)},t.character_rotation_inc=function(e,t,_){if(!E.obj_has_physics(e))return void c.error_once("No physics for object "+e.name);E.character_rotation_inc(e,t,_)},t.set_character_rotation=function(e,t,_){if(!E.obj_has_physics(e))return void c.error_once("No physics for object "+e.name);E.set_character_rotation(e,t,_)},t.set_character_rotation_v=function(e,t){if(!E.obj_has_physics(e))return void c.error_once("No physics for object "+e.name);E.set_character_rotation_v(e,t)},t.set_character_rotation_h=function(e,t){if(!E.obj_has_physics(e))return void c.error_once("No physics for object "+e.name);E.set_character_rotation_h(e,t)},t.set_character_vert_move_dir_angle=function(e,t){if(!E.obj_has_physics(e))return void c.error_once("No physics for object "+e.name);E.set_character_vert_move_dir_angle(e,t)},t.append_collision_test=function(e,t,_,r){if(!E.obj_has_physics(e))return void c.error_once("No physics for object "+e.name);t=t||"ANY",r=r||!1,E.append_collision_test(e,t,_,r)},t.remove_collision_test=function(e,t,_){if(!E.obj_has_physics(e))return void c.error_once("No physics for object "+e.name);t=t||"ANY",E.remove_collision_test(e,t,_)},t.apply_collision_impulse_test=function(e,t){if(!E.obj_has_physics(e))return void c.error_once("No physics for object "+e.name);E.apply_collision_impulse_test(e,t)},t.clear_collision_impulse_test=function(e){if(!E.obj_has_physics(e))return void c.error_once("No physics for object "+e.name);E.clear_collision_impulse_test(e)},t.append_ray_test=function(e,t,_,r,a,n){if(null!=(e=e||null)&&!E.obj_has_physics(e))return c.error_once("No physics for object "+e.name),0;r=r||"ANY",n=n||!1;return E.append_ray_test(e,t,_,r,a,n,!1,!1,!1)},t.append_ray_test_ext=function(e,t,_,r,a,n,o,i,s){return null==(e=e||null)||E.obj_has_physics(e)?(r=r||"ANY",n=n||!1,o=o||!1,i=i||!1,s=s||!1,E.append_ray_test(e,t,_,r,a,n,o,i,s)):(c.error_once("No physics for object "+e.name),0)},t.remove_ray_test=function(e){if(!E.is_ray_test(e))return void c.error("Wrong ray test ID");E.remove_ray_test(e)},t.change_ray_test_from_to=function(e,t,_){if(!E.is_ray_test(e))return void c.error("Wrong ray test ID");E.change_ray_test_from_to(e,t,_)},t.apply_constraint=function(e,t,_,r,a,n,o,i,s,l){if(!E.obj_has_physics(t)||!E.obj_has_physics(a))return void c.error("Wrong objects");E.apply_constraint(e,t,_,r,a,n,o,i,s,l)},t.clear_constraint=function(e){if(!E.obj_has_physics(e)||!E.has_constraint(e))return void c.error("Wrong object");E.clear_constraint(e)},t.pull_to_constraint_pivot=function(e,t,_,r,a,n){if(!E.obj_has_physics(e)||!E.obj_has_physics(r))return void c.error("Wrong objects");E.pull_to_constraint_pivot(e,t,_,r,a,n)},t.navmesh_get_island=a,t.navmesh_find_path=function(e,t,a,n){if(!E.obj_has_physics(e))return void c.error_once("No physics for object "+e.name);var o=e.physics.navmesh;if(!o)return c.error(e.name+" is not a navigation mesh object"),null;n=n||{};var i={};return i.do_not_pull_string=Boolean(n.do_not_pull_string),i.distance_to_closest=n.distance_to_closest||_,i.distance_to_farthest=n.distance_to_farthest||r,i.island=n.island||0,i.allowed_distance=n.allowed_distance||Number.MAX_VALUE,i.return_normals=n.return_normals||!1,l.navmesh_find_path(o,t,a,i)},t.sync_bounding=function(e,t){t||(t=e.scenes_data[0].scene),E.scene_has_physics(t)&&E.sync_bounding(e,t)},t.sync_mesh=function(e,t){t||(t=e.scenes_data[0].scene),E.scene_has_physics(t)&&E.sync_mesh(e,t)}}var a=_(0),n=_(19),o=_(1),i=_(2),s=_(73),E=Object(a.a)("physics",r);t.a=E},function(e,t,_){"use strict";function r(e,t){function _(e){function t(){ee=!1,o.style.visibility="visible"}if(!ee&&!J){var _=Z;if(_){if("visible"==_.lastElementChild.style.visibility)return a(),void(Z=null);if(1==_.style.opacity){var r=_.lastElementChild,n=_.firstElementChild,o=r.firstElementChild,i=Math.ceil(r.getBoundingClientRect().width),s=Math.ceil(r.getBoundingClientRect().height),E=Math.ceil(n.getBoundingClientRect().width),c=Math.ceil(n.getBoundingClientRect().height);r.style.position="absolute",r.style.visibility="visible";var l=!0,T=!0;n.style.display="none",ee=!0,E!=i?z.animate(E,i,200,function(e){e==i&&(l=!1,T||t()),r.style.width=e+"px"}):(l=!1,T||(ee=!1)),c!=s?z.animate(c,s,200,function(e){e==s&&(T=!1,l||t()),r.style.height=e+"px"}):(T=!1,l||(ee=!1))}}}}function r(){$=!0,G.get_container().addEventListener("mouseup",_)}function a(){var e=Z.lastElementChild;Z.firstElementChild.style.display="",e.style.visibility="hidden",e.style.position="relative",e.firstElementChild.style.visibility="hidden"}function O(e){var t=e.obj,_=G.get_container(),r=K.get_meta_tags(t),a=t.name,n="",o=document.createElement("div"),i=o.cloneNode(!1),s=document.createElement("span");return m(o),v(i),o.style.visibility="hidden",r&&(n=r.description||n,a=r.title||a),s.innerHTML=a,R(s),N(s),s.style.whiteSpace="nowrap",i.appendChild(s),o.appendChild(i),n&&I(n,o,e.annotation_max_width),_.appendChild(o),o}function v(e){e.style.cssText+="background-color:   #000;border-radius:      20px 20px 20px 0px;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);opacity:            1.0;box-sizing:         border-box;bottom:             0;left:               0;padding:            6px 12px 6px 12px;position:           absolute;"}function m(e){e.style.cssText+="position:        absolute;height:          0;top:             0;left:            0;transform-style: preserve-3d;"}function N(e){e.style.cssText+="color:       #fff;font-family: Arial;font-size:   12px;font-weight: bold;line-height: 1.25;"}function g(e){e.style.cssText+="background-color:   #000;border-radius:      20px 20px 20px 0px;bottom:             0;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);left:               0;box-sizing:         border-box;opacity:            1.0;padding:            6px 12px 6px 12px;position:           relative;z-index:            2;"}function R(e){e.style.cssText+="-webkit-touch-callout: none;-webkit-user-select:   none;-khtml-user-select:    none;-moz-user-select:      none;-ms-user-select:       none;user-select:           none;cursor:                default;"}function I(e,t,_){var r=document.createElement("div"),n=document.createElement("span");_&&(r.style.maxWidth=_+"px"),g(r),N(n),n.innerHTML=e,r.style.visibility="hidden",n.style.visibility="hidden",r.appendChild(n),t.appendChild(r),k.add_click_listener(t,function(e){ee||t!=Z&&1==t.style.opacity&&(J||(Z&&"visible"==Z.lastElementChild.style.visibility&&a(),Z=t))})}function b(){for(var e=0,t=0;t<W.length;t++)W[t].detect_visibility&&e++;te=new Float32Array(3*e)}function h(e,t){return t.depth-e.depth}function Y(e,t,_){var r=e.element;q.ie_edge_anchors_floor_hack&&(t=Math.floor(t),_=Math.floor(_)),"transform"in r.style?r.style.transform="translate3d("+t+"px, "+_+"px, 0px)":"webkitTransform"in r.style?r.style.webkitTransform="translate3d("+t+"px, "+_+"px, 0px)":(r.style.left=t+"px",r.style.top=_+"px")}function L(e,t){var _=j.get_camera(j.get_main()),r=S.j(e.obj.render.world_tsr);return D.project_point(_,r,t),t}function M(e){var t=j.get_subs(j.get_main(),Q.ANCHOR_VISIBILITY),_=t.camera,r=G.canvas_to_viewport_coords(e.x,e.y,re,_);return H.read_pixels(_.framebuffer,r[0],_.height-r[1],2,2,_e),_e[0]+_e[4]+_e[8]+_e[12]>=255?"visible":"out"==e.appearance||_e[0]+_e[4]+_e[8]+_e[12]==0?"covered":e.appearance}function x(e){G.get_container().removeChild(e.element)}function y(e){for(var t=0;t<W.length;t++)if(W[t].obj==e)return!0;return!1}function U(e,t,_){if(e.element)var r=Math.round(e.element.offsetWidth)||0,a=Math.round(e.element.offsetHeight)||0;else var r=0,a=0;var n=e.x,o=e.y;return t>=n&&t<=n+r&&_<o&&_>=o-a}function w(e,t){if(!e.is_lod)return!0;var _=e.lod_dist_min,r=e.lod_dist_max;return!(t<_)&&(r==B.LOD_DIST_MAX_INFINITY||t<r)}var C=Object(n.a)(e),D=Object(o.a)(e),F=Object(i.a)(e),G=Object(s.a)(e),k=Object(E.a)(e),K=Object(c.a)(e),B=Object(l.a)(e),X=Object(T.a)(e),H=Object(d.a)(e),j=Object(u.a)(e),Q=Object(f.a)(e),z=Object(P.a)(e),V=Object(A.a)(e),q=F.defaults,W=[],J=!1,Z=null,$=!1,ee=!1,te=new Float32Array(0),_e=new Uint8Array(16),re=new Float32Array(2),ae=new Float32Array(3),ne=new Float32Array(3);t.append=function(e){if(!y(e)){var t=e.anchor.detect_visibility&&Boolean(j.get_subs(j.get_main(),Q.ANCHOR_VISIBILITY)),_={type:e.anchor.type,obj:e,x:0,y:0,depth:0,appearance:"out",detect_visibility:t,element:null,move_cb:null,annotation_max_width:e.anchor.max_width,element_id:e.anchor.element_id};switch(_.type){case"ANNOTATION":_.element=O(_);break;case"ELEMENT":if(_.element=document.getElementById(e.anchor.element_id),_.element)for(var a=0;a<W.length;a++)"ELEMENT"==W[a].type&&W[a].element_id==e.anchor.element_id&&(X.warn("Anchor with the id '"+e.anchor.element_id+"' already exists, making the new anchor generic."),_.type="GENERIC");else X.warn("Anchor HTML element with the id '"+e.anchor.element_id+"' was not found, making it generic."),_.type="GENERIC"}W.push(_),b(),$||r()}},t.remove=function(e){for(var t=0;t<W.length;t++){var _=W[t];if(_.obj==e){"ANNOTATION"==_.type&&x(_),W.splice(t,1),b(),t--;break}}},t.update=function(e){for(var t=0,_=W.length;_--;){var r=W[_];if(r.detect_visibility){var a=S.j(r.obj.render.world_tsr);te.set(a,3*t++)}var n=L(r,ae),o=n[0],i=n[1],s=n[2];if(e||o!=r.x||i!=r.y||s!=r.depth){switch(r.type){case"ANNOTATION":var E=o,c=i;Y(r,E,c);break;case"ELEMENT":var l=r.element.getBoundingClientRect(),E=o-l.width/2,c=i-l.height/2;Y(r,E,c)}r.x=o,r.y=i,r.depth=s,r.move_cb&&r.move_cb(o,i,r.appearance,r.obj,r.element)}}W.sort(h);for(var _=0;_<W.length;_++){var r=W[_];"GENERIC"!=r.type&&(Z==r.element?r.element.style.zIndex=W.length:r.element.style.zIndex=_)}if(t>0){var T=j.get_subs(j.get_main(),Q.ANCHOR_VISIBILITY),d=T.draw_data[0].bundles[0],u=d.batch;C.update_anchor_visibility_batch(u,te),Q.append_draw_data(T,d)}},t.update_visibility=function(){for(var e=G.get_container(),t=j.get_active(),_=j.get_subs(t,Q.STEREO),r=Boolean(_&&_.enable_hmd_stereo),n=W.length;n--;){var o=W[n],i=o.obj,s=i.render,E=o.x,c=o.y,l=o.depth,T=j.get_camera(j.get_main()),d=V.get_translation(i,ae),u=V.get_translation(T,ne),f=p.dist(d,u);if(E<0||c<0||l<0||l>1||j.is_hidden(i)||E>=e.clientWidth||c>=e.clientHeight||!w(s,f))var P="out";else var P="visible";if(o.detect_visibility&&"out"!=P&&(P=M(o)),r&&(P="out"),P!=o.appearance){switch(o.type){case"ANNOTATION":case"ELEMENT":var A=o.element;if(!A)break;"out"==P?(A.style.visibility="hidden",A.children.length&&(A.children[0].style.visibility="hidden")):"visible"==P?(A.style.visibility="visible",A.children.length&&(A.children[0].style.visibility="visible"),A.style.opacity=1):(A.style.visibility="visible",A.style.opacity=.1,A.children.length&&(A.children[0].style.visibility="visible"),"ANNOTATION"==o.type&&A.children.length>1&&"visible"==A.lastElementChild.style.visibility&&(a(),A==Z&&(Z=null)))}o.appearance=P,o.move_cb&&o.move_cb(E,c,o.appearance,i,A)}}},t.attach_move_cb=function(e,t){for(var _=0;_<W.length;_++)W[_].obj==e&&(W[_].move_cb=t)},t.detach_move_cb=function(e){for(var t=0;t<W.length;t++)W[t].obj==e&&(W[t].move_cb=null)},t.cleanup=function(){for(var e=0;e<W.length;e++){var t=W[e];"ANNOTATION"==t.type&&x(t)}W.length=0},t.is_anchor=y,t.get_element_id=function(e){for(var t=0;t<W.length;t++)if(W[t].obj==e)return W[t].element_id;return!1},t.pause=function(){J=!0},t.resume=function(){J=!1},t.pick_anchor=function(e,t){for(var _=-1,r=0;r<W.length;r++)if("visible"==W[r].appearance&&U(W[r],e,t))if(_<0){var a=W[r].depth;_=r}else W[r].depth<a&&(_=r,a=W[r].depth);return _<0?null:W[_].obj}}var a=_(0),n=_(16),o=_(14),i=_(4),s=_(15),E=_(38),c=_(12),l=_(8),T=_(1),d=_(22),u=_(10),f=_(11),P=_(18),A=_(13),S=_(6),p=_(3),O=Object(a.a)("__anchors",r);t.a=O},function(e,t,_){"use strict";function r(){return{bone_index:0,vgroup_index:-1,parent_bone_ptr:null,descend_bones_ptrs:[],chain:[],constraint:null,tsr_bone_rest:l.b(),tsr_bone_pose:l.b(),tsr_local_rest:l.b(),tsr_local_rest_i:l.b(),tsr_local_pose:l.b(),tsr_local_pose_b:l.b(),tsr_local_pose_a:l.b(),tsr_basis:l.b(),tsr_channel_cache:l.b(),tsr_channel_cache_valid:!1,tail:new Float32Array(3)}}function a(e,t){for(var _=e.data.bones,a=e.pose.bones,n={},o=0;o<a.length;o++){var i=a[o],s=i.bone,E=s.name,T=n[E]=r(),P=new Float32Array(s.matrix_local),A=new Float32Array(16);d.invert(P,A);var S=new Float32Array(i.matrix_basis),p=T.tail;u.subtract(c._1(s.tail_local),c._1(s.head_local),p),c._67(p,A,p),l.d(P,T.tsr_local_rest),l.d(S,T.tsr_basis),l.a(T.tsr_local_rest,T.tsr_local_pose),l.o(T.tsr_local_rest,T.tsr_local_rest_i)}for(var o=0;o<_.length;o++){var O=_[o],E=O.name,i=c._18("name",E,a),T=n[E],v=i.parent_recursive;T.chain.push(T);for(var m=0;m<v.length;m++){var N=v[m],g=N.name,R=n[g];T.chain.push(R)}if(v.length){var N=v[0],g=N.name,R=n[g];T.parent_bone_ptr=R,l.o(R.tsr_local_rest,f),l.p(f,T.tsr_local_rest,T.tsr_bone_rest),R.descend_bones_ptrs.push(T)}else l.a(T.tsr_local_rest,T.tsr_bone_rest);T.bone_index=o,T.name=E,l.p(T.tsr_bone_rest,T.tsr_basis,T.tsr_bone_pose)}t.render.bone_pointers=n}function n(e,t,_,r,a){var n=e.render,o=n.frame_factor,i=n.bone_pointers[t],s=i.bone_index,E=i.tsr_local_rest,c=A,d=n.trans_before,u=n.trans_after,O=n.quats_before,v=n.quats_after,m=d[4*s],N=d[4*s+1],g=d[4*s+2],R=d[4*s+3],I=u[4*s],b=u[4*s+1],h=u[4*s+2],Y=u[4*s+3];c[0]=(1-o)*m+o*I,c[1]=(1-o)*N+o*b,c[2]=(1-o)*g+o*h,c[3]=(1-o)*R+o*Y;var L=S,M=p;L[0]=O[4*s],L[1]=O[4*s+1],L[2]=O[4*s+2],L[3]=O[4*s+3],M[0]=v[4*s],M[1]=v[4*s+1],M[2]=v[4*s+2],M[3]=v[4*s+3],T.slerp(L,M,o,L);var x=f;if(l.u(c,x),l.q(L,x),_){var y=P;l.E(E,i.tail,y),l.p(x,y,x)}else l.p(x,E,x);if(r){var U=i.parent_bone_ptr;if(U){var w=U.tsr_local_pose,C=P;l.o(w,C),l.p(C,x,x)}var D=i.tsr_bone_rest,F=P;l.o(D,F),l.p(F,x,x)}l.a(x,a)}function o(e,t,_,r){var a=e.render,n=a.bone_pointers[t],o=a.trans_before,E=a.quats_before;r?l.p(n.tsr_bone_rest,_,n.tsr_bone_pose):l.a(_,n.tsr_local_pose),s(n,r,o,E),a.frame_factor=0,i(e)}function i(e){for(var t=e.render,_=t.skinned_renders,r=t.mesh_to_arm_bone_maps,a=0;a<_.length;a++){for(var n=_[a],o=r[a],i=0;i<o.length;i+=2)for(var s=o[i],E=o[i+1],c=0;c<4;c++)n.quats_before[s+c]=t.quats_before[E+c],n.quats_after[s+c]=t.quats_after[E+c],n.trans_before[s+c]=t.trans_before[E+c],n.trans_after[s+c]=t.trans_after[E+c];n.frame_factor=t.frame_factor}}function s(e,t,_,r){var a=e.tsr_bone_pose,n=e.tsr_local_rest,o=e.tsr_local_pose,i=e.parent_bone_ptr;if(i){var E=i.tsr_local_pose;if(t)l.p(E,a,o);else{var c=P;l.o(E,c),l.p(c,o,a)}}else t?l.a(a,o):l.a(o,a);var T=f;l.o(n,T),l.p(o,T,T);var d=e.bone_index;_[4*d]=T[0],_[4*d+1]=T[1],_[4*d+2]=T[2],_[4*d+3]=T[3],r[4*d]=T[4],r[4*d+1]=T[5],r[4*d+2]=T[6],r[4*d+3]=T[7];for(var u=e.descend_bones_ptrs,A=0;A<u.length;A++){var S=u[A];S.constraint||s(S,!0,_,r)}}function E(e,t){return t in e.render.bone_pointers}t.e=a,t.b=n,t.c=o,t.f=i,t.d=s,t.a=E;var c=_(2),l=_(6),T=_(9),d=_(21),u=_(3),f=l.b(),P=l.b(),A=new Float32Array(4),S=new Float32Array(4),p=new Float32Array(4)},function(e,t,_){"use strict";function r(e){var t={name:"",type:e,use_diffuse:!1,use_specular:!1,prev_direction:new Float32Array(3),direction:new Float32Array(3),color:new Float32Array(3),color_intensity:new Float32Array(3),energy:0,default_energy:0,distance:0,use_sphere:!1,spot_size:0,spot_blend:0,clip_start:.1,clip_end:30,falloff_type:"",generate_shadows:!1,need_sun_fog_update:!1,dynamic_intensity:!1};return t.use_diffuse=!0,t.use_specular=!0,t.energy=1,t.distance=25,t.falloff_type="INVERSE_SQUARE",t}function a(e,t){var _=e.data,a=t.light=r(_.type);a.name=t.name,a.use_diffuse=_.use_diffuse,a.use_specular=_.use_specular;var n=T.g(t.render.world_tsr),o=d._33(n,d.f,f);u.normalize(o,o),a.direction.set(o),a.color[0]=_.color[0],a.color[1]=_.color[1],a.color[2]=_.color[2],a.energy=a.default_energy=_.energy,c(a),a.distance=_.distance,a.use_sphere=_.use_sphere,a.clip_start=_.clip_start,a.clip_end=_.clip_end,"POINT"!==a.type&&"SPOT"!==a.type||(a.distance=_.distance),"SPOT"===a.type?(a.spot_blend=_.spot_blend,a.spot_size=_.spot_size):"POINT"===a.type&&(a.spot_size=Math.PI/2),a.generate_shadows=_.b4w_generate_shadows,a.dynamic_intensity=_.b4w_dynamic_intensity}function n(e,t){e.color[0]=t[0],e.color[1]=t[1],e.color[2]=t[2],c(e)}function o(e,t){e.spot_blend=t}function i(e,t){e.distance=t}function s(e,t){e.spot_size=t}function E(e,t){e.energy=t,c(e)}function c(e){u.scale(e.color,e.energy,e.color_intensity)}function l(e){var t=e.light;if(t){var _=T.g(e.render.world_tsr);if(d._33(_,d.f,t.direction),u.normalize(t.direction,t.direction),"SUN"==t.type){var r=Math.acos(u.dot(t.prev_direction,d.n)),a=Math.acos(u.dot(t.direction,d.n)),n=Math.floor(r/.025),o=Math.floor(a/.025);t.need_sun_fog_update=n!=o}u.copy(t.direction,t.prev_direction)}}t.a=a,t.b=n,t.e=o,t.c=i,t.f=s,t.d=E,t.g=l;var T=_(6),d=_(2),u=_(3),f=new Float32Array(3)},function(e,t,_){"use strict";function r(e,t){function _(e){return{type:e,obj_parent:null,target:null,use_offset:!1,tsr_restore:null,tsr_offset:null,euler_offset:null,axes:null,track_axis:null,vertical_axis:null,use_target_z:!1,influence:0,bone_name:"",softness:0,clamp_left:0,clamp_right:0,clamp_up:0,clamp_down:0,dist_min:0,dist_max:0,left_edge:!1,left_right_dist:0,top_edge:!1,top_bottom_dist:0,distance:0,hor_units:"",vert_units:""}}function r(e,t){e.constraint&&e.constraint.obj_parent&&d(e.constraint.obj_parent,e),t.obj_parent&&a(t.obj_parent,e),e.constraint=t}function a(e,t){-1==e.cons_descends.indexOf(t)?e.cons_descends.push(t):h.panic("Descendant object override is forbidden")}function d(e,t){var _=e.cons_descends.indexOf(t);-1!=_?e.cons_descends.splice(_,1):h.panic("No descendant object")}function u(e,t,a,n,o,i){var s=_(y);s.obj_parent=t,s.track_axis=new Float32Array(a),s.vertical_axis=new Float32Array(n),s.use_target_z=o,s.tsr_restore=new Float32Array(e.render.world_tsr),s.influence=i,r(e,s),v(e,s,0)}function f(e,t,a,n,o,i){var s=_(C);s.obj_parent=t,s.tsr_offset=E.b(),E.t(a,s.tsr_offset),s.axes=new Float32Array(n),s.influence=i,s.use_offset=o,s.tsr_restore=new Float32Array(e.render.world_tsr),r(e,s),v(e,s,0)}function P(e,t,a,n,o){var i=_(D);i.obj_parent=t;var s=E.f(e.render.world_tsr,J);i.euler_offset=c._35(s,new Float32Array(3)),i.axes=new Float32Array(a),i.influence=o,i.use_offset=n,i.tsr_restore=new Float32Array(e.render.world_tsr),r(e,i),v(e,i,0)}function A(e,t,a){var n=_(F);n.obj_parent=t,n.tsr_offset=E.b(),E.a(e.render.world_tsr,n.tsr_offset),n.tsr_restore=new Float32Array(e.render.world_tsr),n.influence=a,r(e,n),v(e,n,0)}function S(e,t,a){var n=_(k);n.obj_parent=t,n.tsr_offset=new Float32Array(a),r(e,n),v(e,n,0)}function p(e,t,a,n){var o=_(K);o.obj_parent=t,o.bone_name=a,o.tsr_offset=new Float32Array(n),r(e,o),v(e,o,0)}function O(e,t,a){var n=_(H);if(n.obj_parent=t,n.tsr_restore=new Float32Array(e.render.world_tsr),n.tsr_offset=E.b(),c._16(a.right)?(n.left_edge=!1,n.left_right_dist=a.right):c._16(a.left)?(n.left_edge=!0,n.left_right_dist=a.left):(n.left_edge=!0,n.left_right_dist=0),c._16(a.bottom)?(n.top_edge=!1,n.top_bottom_dist=a.bottom):c._16(a.top)?(n.top_edge=!0,n.top_bottom_dist=a.top):(n.top_edge=!0,n.top_bottom_dist=0),c._16(a.distance)?n.distance=a.distance:n.distance=0,c._16(a.rotation))var o=new Float32Array(a.rotation);else var o=l.create();E.q(o,n.tsr_offset),c._16(a.hor_units)?n.hor_units=a.hor_units:n.hor_units="widths",c._16(a.vert_units)?n.vert_units=a.vert_units:n.vert_units="heights",r(e,n),v(e,n,0)}function v(e,t,_){switch(t.type){case M:E.p(t.obj_parent.render.world_tsr,t.tsr_offset,e.render.world_tsr);break;case G:var r=E.j(e.render.world_tsr),a=E.g(e.render.world_tsr),n=E.i(t.tsr_offset,V),o=t.obj_parent.render.world_tsr,s=E.g(t.obj_parent.render.world_tsr);l.multiply(l.invert(t.parent_prev_rotation,t.parent_prev_rotation),a,a),l.multiply(s,a,a),E.B(n,o,r),l.copy(s,t.parent_prev_rotation),I(e,t);break;case B:var r=E.j(e.render.world_tsr),a=E.g(e.render.world_tsr),o=t.obj_parent.render.world_tsr,d=E.j(o),u=t.softness,f=V,P=l.copy(a,W),n=E.i(t.tsr_offset,q);E.B(n,o,f),c._53(f,r,_,u,r),c._30(r,P,d,c.c),c._51(P,a,_,.16*u,a);break;case x:var a=E.g(e.render.world_tsr),A=Z,n=E.i(t.tsr_offset,q),S=E.h(t.tsr_offset),p=E.f(t.tsr_offset,W);i.b(t.obj_parent,t.bone_name,!0,!1,A),E.p(t.obj_parent.render.world_tsr,A,A),a[0]=A[4],a[1]=A[5],a[2]=A[6],a[3]=A[7],l.multiply(a,p,a),E.r(S*A[3],e.render.world_tsr);var r=E.j(e.render.world_tsr);E.B(n,A,r);break;case y:var r=E.j(e.render.world_tsr),a=E.g(e.render.world_tsr),O=E.j(t.obj_parent.render.world_tsr),v=t.influence;if(t.use_target_z)var m=E.f(t.obj_parent.render.world_tsr,W),N=T.transformQuat(c.f,m,V);else var N=c.f;c._30(r,a,O,t.track_axis);var g=T.subtract(O,r,q);T.normalize(g,g),c._31(a,t.vertical_axis,N,g);var R=E.f(t.tsr_restore,W);l.slerp(R,a,v,a),E.t(r,t.tsr_restore);break;case U:var r=E.j(e.render.world_tsr),a=E.g(e.render.world_tsr),O=E.j(t.obj_parent.render.world_tsr);c._30(r,a,O,c.c);var b=T.dist(r,O);if(b>t.dist_max)var h=b-t.dist_max;else if(b<t.dist_min)var h=b-t.dist_min;else var h=0;h&&(T.sub(O,r,V),T.normalize(V,V),T.scale(V,h,V),T.add(r,V,r));break;case w:var o=t.obj_parent.render.world_tsr,r=E.j(e.render.world_tsr),n=E.i(t.tsr_offset,V);E.B(n,o,r),E.q(E.g(e.render.world_tsr),t.tsr_restore);break;case C:var d=E.j(t.obj_parent.render.world_tsr),r=E.j(e.render.world_tsr),Y=t.axes,j=E.i(t.tsr_offset,V),n=T.set(0,0,0,q);t.use_offset&&T.add(n,j,n);var v=t.influence;Y[0]&&(r[0]=(1-v)*j[0]+v*(c._49(Y[0])*d[0]+n[0])),Y[1]&&(r[1]=(1-v)*j[1]+v*(c._49(Y[1])*d[1]+n[1])),Y[2]&&(r[2]=(1-v)*j[2]+v*(c._49(Y[2])*d[2]+n[2])),E.q(E.g(e.render.world_tsr),t.tsr_restore);break;case D:var Y=t.axes,s=E.f(t.obj_parent.render.world_tsr,W),Q=c._34(s,t.euler_offset,q);if(c.Q(Q,t.euler_offset),Y[0]){if(t.use_offset){var z=T.set(t.euler_offset[0],0,0,V);c._44(Q,z,Q)}Q[0]=c._49(Y[0])*Q[0]}else Q[0]=t.euler_offset[0];if(Y[1]){if(t.use_offset){var z=T.set(0,t.euler_offset[1],0,V);c._44(Q,z,Q)}Q[1]=c._49(Y[1])*Q[1]}else Q[1]=t.euler_offset[1];if(Y[2]){if(t.use_offset){var z=T.set(0,0,t.euler_offset[2],V);c._44(Q,z,Q)}Q[2]=c._49(Y[2])*Q[2]}else Q[2]=t.euler_offset[2];c.Q(Q,t.euler_offset);var v=t.influence,ee=c.Y(Q,W),te=E.f(t.tsr_restore,J);l.slerp(te,ee,v,E.g(e.render.world_tsr)),E.t(E.j(e.render.world_tsr),t.tsr_restore);break;case F:var v=t.influence,d=E.i(t.obj_parent.render.world_tsr,V),s=E.f(t.obj_parent.render.world_tsr,W),_e=E.i(t.tsr_offset,q),R=E.f(t.tsr_offset,J);c.G(_e,d,v,E.j(e.render.world_tsr)),l.slerp(R,s,v,E.g(e.render.world_tsr)),E.t(E.j(e.render.world_tsr),t.tsr_restore);break;case X:var a=E.g(e.render.world_tsr),o=t.obj_parent.render.world_tsr,s=E.g(t.obj_parent.render.world_tsr),n=E.i(t.tsr_offset,q),p=E.f(t.tsr_offset,W);l.multiply(s,p,a);var r=E.j(e.render.world_tsr);E.B(n,o,r);break;case k:var re=t.obj_parent.render,ae=e.render;E.p(re.world_tsr,t.tsr_offset,ae.world_tsr);break;case K:var ne=t.tsr_offset,A=Z;i.b(t.obj_parent,t.bone_name,!0,!1,A),E.p(t.obj_parent.render.world_tsr,A,A),E.p(A,ne,e.render.world_tsr);break;case H:var oe=t.obj_parent,ie=L.get_first_cam(oe),r=E.j(e.render.world_tsr),se=L.get_edge(ie,"LEFT"),Ee=L.get_edge(ie,"RIGHT"),ce=L.get_edge(ie,"TOP"),le=L.get_edge(ie,"BOTTOM");if("heights"==t.hor_units)var Te=ce-le;else var Te=Ee-se;if(t.left_edge?r[0]=se+Te*t.left_right_dist:r[0]=Ee-Te*t.left_right_dist,"heights"==t.vert_units)var de=ce-le;else var de=Ee-se;if(t.top_edge?r[1]=ce-de*t.top_bottom_dist:r[1]=le+de*t.top_bottom_dist,L.is_ortho(ie))r[2]=-t.distance;else{r[2]=-1,T.normalize(r,r);var ue=t.distance/Math.abs(r[2]);T.scale(r,ue,r)}E.w(r,oe.render.world_tsr,r);var fe=E.j(oe.render.world_tsr);T.add(fe,r,r);var te=E.g(e.render.world_tsr),Pe=E.g(oe.render.world_tsr),p=E.f(t.tsr_offset,J);l.multiply(Pe,p,te)}if("CAMERA"==e.render.type&&e.render.move_style!=L.MS_STATIC){var Ae=e.render.vertical_axis;if(t.type==G){var s=E.g(t.obj_parent.render.world_tsr);Ae=T.transformQuat(Ae,s,$)}L.correct_up(e,Ae)}}function m(e,t,r,a,n,o){var i=_(j);i.bone_name=r,i.target=t,i.tsr_offset=E.b(),E.t(new Float32Array(a),i.tsr_offset),E.q(new Float32Array(n),i.tsr_offset),E.r(o,i.tsr_offset),N(e,i),R(e,i)}function N(e,t){var _=t.target,r=t.bone_name,a=e.render.bone_pointers[r];g(_,e,r),_.cons_armat_bone_descends.push([e,r]),a.constraint=t}function g(e,t,_){for(var r=e.cons_armat_bone_descends,a=0;a<r;a++){var n=r[a];if(n[0]==t&&n[1]==_)return void r.splice(a,1)}}function R(e,t){switch(t.type){case j:var _=t.target,r=_.render.world_tsr,a=e.render.world_tsr,n=Z;E.o(a,n),E.p(n,r,n),i.c(e,t.bone_name,n,!1)}e.need_update_transform=!0}function I(e,t){var _=E.g(e.render.world_tsr),r=E.g(t.obj_parent.render.world_tsr),a=E.f(t.tsr_offset,J),n=l.multiply(r,a,W),o=L.get_camera_angles_from_quat(n,e.render.vertical_axis,Q),i=L.get_camera_angles_from_quat(_,e.render.vertical_axis,z),s=c.H(i[0],o[0]+t.clamp_right,o[0]+t.clamp_left),T=c.H(i[1],o[1]+t.clamp_down,o[1]+t.clamp_up);c._46(_,e.render.vertical_axis,s,T,_)}function b(e,t){for(var _=0;_<e.length;_++){var r=e[_];if(!b(r.cons_descends,t)||r.name==t.name)return!1}return!0}var h=Object(n.a)(e),Y=Object(o.a)(e),L=Object(s.a)(e),M=1,x=2,y=3,U=5,w=7,C=8,D=9,F=11,G=12,k=13,K=14,B=15,X=16,H=17,j=18;t.CONS_TYPE_STIFF_OBJ=M,t.CONS_TYPE_STIFF_BONE=x,t.CONS_TYPE_TRACK_OBJ=y,t.CONS_TYPE_FOLLOW_OBJ=U,t.CONS_TYPE_STIFF_TRANS_OBJ=w,t.CONS_TYPE_COPY_LOC_OBJ=C,t.CONS_TYPE_SEMI_STIFF_OBJ=G,t.CONS_TYPE_CHILD_OF=k,t.CONS_TYPE_CHILD_OF_BONE=K,t.CONS_TYPE_SEMI_SOFT_OBJ=B,t.CONS_TYPE_STIFF_TRANS_ROT_OBJ=X,t.CONS_TYPE_STIFF_VIEWPORT=H,t.BONE_CONS_TYPE_STIFF_OBJ=j;var Q=new Float32Array(2),z=new Float32Array(2),V=new Float32Array(3),q=new Float32Array(3),W=new Float32Array(4),J=new Float32Array(4),Z=E.b(),$=new Float32Array(3);t.append_stiff_obj=function(e,t,a,n,o){var i=_(M);i.obj_parent=t,i.tsr_offset=E.b(),n=n||l.create(),E.t(a,i.tsr_offset),E.r(o,i.tsr_offset),E.q(n,i.tsr_offset),i.tsr_restore=new Float32Array(e.render.world_tsr),r(e,i),v(e,i,0)},t.append_stiff_bone=function(e,t,a,n,o,i){var s=_(x);s.obj_parent=t,s.bone_name=a,s.tsr_restore=new Float32Array(e.render.world_tsr),s.tsr_offset=E.b(),E.t(new Float32Array(n),s.tsr_offset),E.q(new Float32Array(o),s.tsr_offset),E.r(i,s.tsr_offset),r(e,s),v(e,s,0)},t.append_semi_stiff_obj=function(e,t,a,n,o,i,s,T){var d=_(G),u=E.g(e.render.world_tsr),f=E.g(t.render.world_tsr);n?(l.copy(n,u),l.multiply(f,u,u)):n=l.create(),d.obj_parent=t,d.tsr_offset=E.b(),E.t(a,d.tsr_offset),E.q(n,d.tsr_offset),d.parent_prev_rotation=new Float32Array(f),d.clamp_left=c.A(o),d.clamp_right=c.A(i),d.clamp_up=c.B(s,-Math.PI,Math.PI),d.clamp_down=c.B(T,-Math.PI,Math.PI),d.tsr_restore=new Float32Array(e.render.world_tsr),r(e,d),v(e,d,0)},t.append_semi_soft_obj=function(e,t,a,n){var o=_(B);o.obj_parent=t,o.softness=n,o.tsr_restore=new Float32Array(e.render.world_tsr),o.tsr_offset=E.b(),E.t(new Float32Array(a),o.tsr_offset),r(e,o),v(e,o,0)},t.append_stiff_trans_rot_obj=function(e,t,a,n,o){var i=_(X);i.obj_parent=t,i.tsr_restore=new Float32Array(e.render.world_tsr),i.tsr_offset=E.b(),E.t(new Float32Array(a),i.tsr_offset),E.q(new Float32Array(n),i.tsr_offset),E.r(o,i.tsr_offset),r(e,i),v(e,i,0)},t.remove_parent_descendant=d,t.append_track_obj=u,t.append_follow_obj=function(e,t,a,n){var o=_(U);o.obj_parent=t,o.dist_min=a,o.dist_max=n,o.tsr_restore=new Float32Array(e.render.world_tsr),r(e,o),v(e,o,0)},t.append_stiff_trans_obj=function(e,t,a){var n=_(w);n.obj_parent=t,n.tsr_offset=E.b(),n.tsr_restore=new Float32Array(e.render.world_tsr),E.t(new Float32Array(a),n.tsr_offset),r(e,n),v(e,n,0)},t.append_copy_loc_obj=f,t.append_copy_rot_obj=P,t.append_copy_trans_obj=A,t.append_child_of=S,t.append_child_of_bone=p,t.append_stiff_viewport=O,t.update_constraint=function(e,t){e.constraint&&v(e,e.constraint,t)},t.update_bone_constraint=function(e,t){var _=e.render.bone_pointers[t];_.constraint&&R(e,_.constraint)},t.check_constraint=function(e){return!!e.constraint},t.remove=function(e,t){e.constraint.obj_parent&&d(e.constraint.obj_parent,e),t&&E.a(e.constraint.tsr_restore,e.render.world_tsr),e.constraint=null},t.get_type=function(e){return e.constraint?e.constraint.type:null},t.has_child_of=function(e){var t=e.constraint;return!(!t||t.type!=k&&t.type!=K)},t.get_child_of_parent_tsr=function(e){var t=e.constraint;if(t&&t.type==k)return t.obj_parent.render.world_tsr;if(t&&t.type==K){var _=Z;return i.b(t.obj_parent,t.bone_name,!0,!1,_),E.p(t.obj_parent.render.world_tsr,_,_),_}return null},t.get_child_of_offset=function(e){var t=e.constraint;return!t||t.type!=k&&t.type!=K?null:t.tsr_offset},t.prepare_object_relations=function(e,t){for(var _=t.render,r=0;r<e.constraints.length;r++){var a=e.constraints[r],n=a.type;if(a.target){var o=a.target._object;if("COPY_LOCATION"==n){var i=new Float32Array(E.j(t.render.world_tsr)),s=new Float32Array(a.axes);f(t,o,i,s,a.use_offset,a.influence)}else if("COPY_ROTATION"==n){var s=new Float32Array(a.axes);P(t,o,s,a.use_offset,a.influence)}else if("COPY_TRANSFORMS"==n)A(t,o,a.influence);else if("TRACK_TO"==n){var l=a.track_axis;if("TRACK_Y"==l)var T=c.e;else if("TRACK_NEGATIVE_Y"==l)var T=c.b;else if("TRACK_X"==l)var T=c.d;else if("TRACK_NEGATIVE_X"==l)var T=c.a;else if("TRACK_Z"==l)var T=c.f;else if("TRACK_NEGATIVE_Z"==l)var T=c.c;var d=a.up_axis;if("UP_X"==d)var v=c.d;else if("UP_Y"==d)var v=c.e;else if("UP_Z"==d)var v=c.f;u(t,o,T,v,a.use_target_z,a.influence)}}}if(t.parent){!t.parent_is_dupli&&t.physics_settings.use_collision_compound&&t.parent.physics_settings.use_collision_compound&&(t.use_obj_physics=!1);for(var N=!1,r=0;r<t.scenes_data.length;r++)if(t.scenes_data[r].scene._physics){N=!0;break}if(N&&Y.has_dynamic_settings(t)){if(t.parent_is_dupli)var g=E.a(_.world_tsr,E.b());else var g=_.world_tsr;E.p(t.parent.render.world_tsr,g,_.world_tsr)}else if(t.parent_is_dupli||!t.parent_bone){var g=E.a(_.world_tsr,E.b());if(t.viewport_alignment&&"CAMERA"==t.parent.type){var R={distance:t.viewport_alignment.distance,rotation:E.g(g)};switch(t.viewport_alignment.alignment){case"TOP_LEFT":R.top=0,R.left=0;break;case"TOP":R.top=0,R.left=.5;break;case"TOP_RIGHT":R.top=0,R.right=0;break;case"LEFT":R.top=.5,R.left=0;break;case"CENTER":R.top=.5,R.left=.5;break;case"RIGHT":R.top=.5,R.right=0;break;case"BOTTOM_LEFT":R.bottom=0,R.left=0;break;case"BOTTOM":R.bottom=0,R.left=.5;break;case"BOTTOM_RIGHT":R.bottom=0,R.right=0}O(t,t.parent,R)}else S(t,t.parent,g)}else{var g=E.a(_.world_tsr,E.b());p(t,t.parent,t.parent_bone,g)}}if("ARMATURE"==t.type)for(var I=e.pose.bones,r=0;r<I.length;r++){var b=I[r],h=b.constraints;if(h)for(var L=0;L<h.length;L++){var M=h[L];if("COPY_TRANSFORMS"==M.type&&!M.subtarget&&!M.mute){var o=M.target._object;m(t,o,b.name,c.m,c.k,1)}}}},t.check_compatibility=function(e,t){return b(e.cons_descends,t)},t.check_self_applying=function(e,t){return e.name!=t.name}}var a=_(0),n=_(5),o=_(19),i=_(56),s=_(14),E=_(6),c=_(2),l=_(9),T=_(3),d=Object(a.a)("__constraints",r);t.a=d},function(e,t,_){"use strict";function r(e,t){function _(e,t){return{name:e.name,type:e.type,label:e.label,slot_idx_order:e.slot_idx_order,slot_idx_jump:e.slot_idx_jump,frame_start:e.frame_range[0],frame_end:e.frame_range[1],frame_start_mask:!e.frame_range_mask||e.frame_range_mask[0],frame_end_mask:!e.frame_range_mask||e.frame_range_mask[1],param_name:e.param_name,op:e.operation,mute:e.mute,dupli_name_list:e.object,anim_name:e.anim_name,parse_json_vars:e.parse_json_vars,parse_json_paths:e.parse_json_paths,objects_paths:e.objects_paths,nodes_paths:e.nodes_paths,floats:e.floats,bools:e.bools,vars:e.variables,strings:e.strings,logic_functions:e.logic_functions,logic_node_trees:e.logic_node_trees,materials_names:e.materials_names,shader_nd_type:e.shader_nd_type,common_usage_names:e.common_usage_names,encode_json_vars:e.encode_json_vars,encode_json_paths:e.encode_json_paths,thread:t,process_node:qt[e.type]?qt[e.type]:L,processed:!1,links_dict:e.links,instances:[],func_id:-1,links_keys:null,select_object_idx:-1}}function r(e,t,_){var r=t.thread_index+1-e.instances.length;if(r>0)for(var a=0;a<r;a++)e.instances.push(0);return e.instances[t.thread_index]||(e.instances[t.thread_index]=function(){return{objects:{},slot_idx_jump:-1,state:$e,sel_obj_idxs:[],timer:-1,camera_state:{},anim_slot:be.SLOT_ALL,obj_state:null}}(),_&&_(e,e.instances[t.thread_index],t)),e.instances[t.thread_index]}function a(e,t,_){return e[0]?t[e[1]]:_[e[1]]}function h(e,t,_,r){e[0]?t[e[1]]=r:_[e[1]]=r}function Y(e,t,_,r,a,n){switch(t.state){case We:break;case Je:_.curr_node=e.slot_idx_order}}function L(e,t,_,r,a,n){switch(t.state){case We:ye.error("Unknown node type: "+e.type);break;case Je:_.curr_node=e.slot_idx_order}}function M(e){var t=e.thread_state.callstack,_=t.length,a=[];_<=1&&a.push(e.nodes);for(var n=1;n<_;n++)a.push(t[n].logic_func.func.nodes);for(var n=0;n<a.length;n++)for(var o=0;o<a[n].length;o++){var i=a[n][o];if("PLAY"==i.type){var s=r(i,e.thread_state);s.state=$e}}}function x(e,t){for(var _=e.nodes,a=0;a<_.length;a++){var n=_[a];if("SWITCH_SELECT"==n.type&&n!=t){r(n,e.thread_state).state=_t}}}function y(e,t,_,r){for(var a=Wt[e],n=0;n<Wt[e].logic_threads.length;n++)a.curr_thread=Wt[e].logic_threads[n],ve(Wt[e].logic_threads[n],a,t,_,r)}function U(e,t,_){var r=we.get("url_params");if(r&&e in r)return Number(r[e]);var a=_?location.hash:location.search;if(!a)return 0;for(var n=a.slice(1).split("&"),o=0;o<n.length;o++){var i=n[o].split("=");if(i.length>1&&i[0]==e)return Ne(i[1],t)}return 0}function w(e){return xe.get_world_by_name(e.dupli_name_list[0],0)}function C(e,t,_,r,a,n){switch(t.state){case Je:_.callstack.push({caller_node:null,variables:_.variables,logic_func:null}),_.curr_node=e.slot_idx_order}}function D(e,t,_,n,o,i){function s(e,t,_){E||(t.obj=xe.get_object(xe.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths.id0,0),t.obj||(ye.error("Logic script error: object not found. Node: ",e.name),e.mute=!0))}var E=e.bools.id0;switch(t.state){case We:break;case Je:var c=r(e,_,s),l=E?a(e.vars.id0,t.variables,_.variables):c.obj;e.bools.ch?Ue.change_visibility_rec(l,!0):Ue.change_visibility(l,!0),_.curr_node=e.slot_idx_order}}function F(e,t,_,n,o,i){function s(e,t,_){E||(t.obj=xe.get_object(xe.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths.id0,0),t.obj||(ye.error("Logic script error: object not found. Node: ",e.name),e.mute=!0))}var E=e.bools.id0;switch(t.state){case We:break;case Je:var c=r(e,_,s),l=E?a(e.vars.id0,t.variables,_.variables):c.obj;e.bools.ch?Ue.change_visibility_rec(l,!1):Ue.change_visibility(l,!1),_.curr_node=e.slot_idx_order}}function G(e,t,_,r,a,n){switch(t.state){case Je:h(e.vars.vd,t.variables,_.variables,U(e.param_name,e.floats.ptp,e.bools.hsh)),_.curr_node=e.slot_idx_order}}function k(e,t,_,r,a,n){switch(t.state){case We:ye.error("Logic script error: node is deprecated. Node: ",e.name),e.mute=!0}}function K(e,t,_){var n=xe.get_selectable_objects(),o=r(e,_.thread_state);o.sel_obj_idxs=[],o.links_idxs=[];for(var i in e.objects_paths){var s=e.bools[i]?a(e.vars[i],t.variables,_.thread_state.variables):xe.get_object(xe.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths[i],0),E=n.indexOf(s);if(-1==E)return ye.error("logic script error: non-selectable object:",e.objects_paths[i][e.objects_paths[i].length-1]),-1;o.sel_obj_idxs.push(E),o.links_idxs.push(e.links_dict[i])}o.sel_objs_len=n.length;for(var c=[],l=0;l<n.length;l++)c.push(Ce.create_selection_sensor(n[l],!1));var T=$t();Ce.create_sensor_manifold(null,"LOGIC_NODES_SWITCH_SELECT_"+Re(e.label),Ce.CT_SHOT,c,Ce.default_OR_logic_fun,T,[e,t,_])}function B(e,t,_,a,n,o){function i(e,t,_){t.state=_t}switch(t.state){case We:break;case Je:var s=r(e,_,i);if(s.state==_t)s.state=rt,x(t.logic_threads[_.thread_index],e),K(e,t,t.logic_threads[_.thread_index]);else if(s.state==rt)s.state=at;else if(s.state==nt||s.state==ot){if(e.vars.vd&&e.vars.vd[1]){var E=xe.get_selectable_objects();h(e.vars.vd,t.variables,_.variables,E[s.select_object_idx])}_.curr_node=s.state?s.slot_idx_jump:e.slot_idx_order,s.state=_t,Ce.remove_sensor_manifold(null,"LOGIC_NODES_SWITCH_SELECT_"+Re(e.label));break}}}function X(e,t,_,r,n,o){switch(t.state){case We:var i=Object.keys(e.vars);for(var s in i)i[s].startsWith("id")||i.splice(s,1);e.links_keys=i;break;case Je:var E=a(e.vars.v,t.variables,_.variables);for(var s in e.links_keys){if(E==a(e.vars[e.links_keys[s]],t.variables,_.variables))return void(_.curr_node=e.links_dict[e.links_keys[s]])}_.curr_node=e.slot_idx_order}}function H(e,t,_,a,n,o){switch(t.state){case We:Me.stop_nla(),e.bools.not_wait||(e.bools.not_wait=!1);break;case Je:var i=r(e,_);switch(i.state){case $e:if(Me.is_play(t._nla)){if(t.curr_thread==t.nla_thread&&_.in_progress)break;var s=t.nla_thread;if(s){var E=le(s),c=E[s.thread_state.curr_node];s.thread_state.curr_node=c.slot_idx_order,M(t.nla_thread)}}if(_.in_progress=!e.bools.not_wait,t.nla_thread=t.curr_thread,i.state=et,e.frame_start_mask&&(Me.set_range_start(e.frame_start),Me.set_offset_from_range_start(a)),e.frame_end_mask)Me.set_range_end(e.frame_end);else{var l=Me.get_frame(a),T=-1;for(var d in t.sorted_markers_values)if(l<t.sorted_markers_values[d]){T=d;break}T>=0?Me.set_range_end(t.sorted_markers_values[T]):Me.set_range_end(Me.get_frame_end())}Me.play_nla(null),e.bools.not_wait&&(_.curr_node=e.slot_idx_order,i.state=$e,_.in_progress=!1);break;case et:Me.is_play()||(_.curr_node=e.slot_idx_order,i.state=$e,_.in_progress=!1);break;case tt:_.curr_node=e.slot_idx_order,i.state=$e,t.nla_thread=null,_.in_progress=!1;break;default:he.panic("Unknown state of "+e.name),i.state=$e}}}function j(e,t,_,r,n,o){switch(t.state){case Je:var i=0,s="{";for(var E in e.vars){i>0&&(s+=", ");var c=e.vars[E][1],l=a(e.vars[E],t.variables,_.variables);s+='"'+c+'": ';try{s+=JSON.stringify(l)}catch(e){s+=l?'{"name": "'+l.name+'", "type": "'+l.type+'"}':"Object"}++i}s+="}",ye.log(e.common_usage_names.msg,s),_.curr_node=e.slot_idx_order}}function Q(e,t,_,r,a,n){switch(t.state){case Je:e.bools.rst&&Me.set_offset_from_range_start(r),Me.stop_nla(),_.curr_node=e.slot_idx_order}}function z(e,t,_,r,n,o){switch(t.state){case Je:var i=e.bools.url?Ne(a(e.vars.url,t.variables,_.variables),lt):e.strings.url;window.location.href=i,t.state=Ze}}function V(e,t,_,n,o,i){function s(e,_,a,n,o){var i=JSON.stringify(e),s=o[0],E=o[1],c=r(s,E);h(o[0].vars.dst,t.variables,E.variables,i),c.state=1}var E=r(e,_);switch(t.state){case Je:switch(E.state){case it:E.state=st;var c=e.bools.url?Ne(a(e.vars.url,t.variables,_.variables),lt):e.strings.url,l={};if(e.bools.ct&&(l["Content-Type"]=e.strings.ct),"GET"==e.common_usage_names.request_type)Ye.enqueue([{id:c,type:Ye.AT_JSON,url:c,overwrite_header:l,param:[e,_]}],s,null,null,null);else if("POST"==e.common_usage_names.request_type){var T=Ne(a(e.vars.dst1,t.variables,_.variables),lt);Ye.enqueue([{id:c,type:Ye.AT_JSON,url:c,overwrite_header:l,request_method:"POST",post_data:T,param:[e,_]}],s,null,null,null)}break;case st:break;case Et:E.state=it,_.curr_node=e.slot_idx_order}}}function q(e,t,_,a,n,o){function i(e,t,_){for(var r=0;r<2;r++)t.objects["id"+r]=xe.get_object(xe.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths["id"+r],0),t.objects["id"+r]||(ye.error("Logic script error: object not found. Node: ",e.name),e.mute=!0)}switch(t.state){case We:break;case Je:var s=r(e,_,i);xe.inherit_material(s.objects.id0,e.materials_names.id0,s.objects.id1,e.materials_names.id1),_.curr_node=e.slot_idx_order}}function W(e,t,_,n,o,i){var s=r(e,_);switch(t.state){case We:break;case Je:if(s.state==$e)return s.state=et,s.timer=0,void(_.in_progress=!0);if(s.state==et){s.timer+=o;(e.bools.dl?Ne(a(e.vars.dl,t.variables,_.variables),ct):e.floats.dl)<s.timer&&(s.state=$e,_.curr_node=e.slot_idx_order,_.in_progress=!1)}}}function J(e,t,_,n,o,i){function s(e,t,_){var r=t.objects.id0=xe.get_object(xe.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths.id0,0);r||(ye.error("Logic script error: object not found. Node: ",e.name),e.mute=!0);var a=e.common_usage_names.sk;Fe.check_shape_keys(r)?Fe.has_shape_key(r,a)||(ye.error("Wrong key name:",a),e.mute=!0):(ye.error("No shape keys in object:",r.name),e.mute=!0)}switch(t.state){case We:break;case Je:var E=r(e,_,s);Fe.apply_shape_key(E.objects.id0,e.common_usage_names.sk,e.bools.skv?Ne(a(e.vars.skv,t.variables,_.variables),ct):e.floats.skv),_.curr_node=e.slot_idx_order}}function Z(e,t,_,n,o,i){function s(e,t,_){E||(t.obj=xe.get_object(xe.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths.id0,0),t.obj||(ye.error("Logic script error: object not found. Node: ",e.name),e.mute=!0),t.obj&&t.obj.render&&t.obj.render.outlining||(ye.error("Can't evaluate 'Outline' logic node: wrong object"),e.mute=!0))}var E=e.bools.id0;switch(t.state){case We:break;case Je:var c=r(e,_,s),l=E?a(e.vars.id0,t.variables,_.variables):c.obj;switch(e.common_usage_names.outline_operation){case"PLAY":var T=l.render.outline_anim_settings_default;xe.apply_outline_anim(l,T.outline_duration,T.outline_period,T.outline_relapses);break;case"STOP":xe.clear_outline_anim(l);break;case"INTENSITY":xe.set_outline_intensity(l,e.bools.in?Ne(a(e.vars.in,t.variables,_.variables),ct):e.floats.in)}_.curr_node=e.slot_idx_order}}function $(e,t,_,n,o,i){function s(e,t,_,r){switch(Le.get_move_style(e)){case Le.MS_TARGET_CONTROLS:Le.set_trans_pivot(e,t,_);break;case Le.MS_EYE_CONTROLS:case Le.MS_STATIC:Be.set_tsr(e,r);break;case Le.MS_HOVER_CONTROLS:I.sub(_,t,je),I.normalize(je,je),Le.set_hover_pivot(e,_);var a=0,n=0;Qe[0]=je[0],Qe[1]=0,Qe[2]=je[2];var o=I.dot(Qe,je);n=Math.acos(o/(I.length(Qe)*I.length(je))),a=je[2]?Math.atan(je[0]/je[2]):je[0]>0?0:Math.PI,je[2]>0&&je[0]>0?ze[1]=-(Math.PI+ze[1]):je[2]>0&&je[0]<0?ze[1]=-(Math.PI+ze[1]):je[2]<0&&je[0]<0?(ze[0]+=Math.PI,a=-(Math.PI-a)):je[2]<0&&je[0]>0&&(ze[0]+=Math.PI,a-=Math.PI),Le.set_rotation_hover_angles(e,a+Math.PI,-n)}Be.update_transform(e),Ge.sync_transform(e)}function E(e,t,_,r){S.lookAt(t,_,R.f,qe),S.invert(qe,qe);var a=Ve;A.fromMat4(qe,a),O.fromMat3(a,He),O.normalize(He,He);var n=g.h(e.render.world_tsr);g.s(t,n,He,r)}function c(e,_,r){var a=null;a=_.objects.ca=ce(e,"id0",l,t.variables,r.variables),a||l||(ye.error("Logic script error: object not found. Node: ",e.name),e.mute=!0),_.objects.tr=ce(e,"id1",T,t.variables,r.variables),_.objects.tr||T||(ye.error("Logic script error: object not found. Node: ",e.name),e.mute=!0),_.objects.ta=ce(e,"id2",d,t.variables,r.variables),_.objects.ta||d||(ye.error("Logic script error: object not found. Node: ",e.name),e.mute=!0),_.state=$e,_.camera_state={trans_start:new Float32Array(3),trans_end:new Float32Array(3),interp_trans:new Float32Array(3),target_start:new Float32Array(3),target_end:new Float32Array(3),interp_target:new Float32Array(3),tsr_start:new Float32Array(8),tsr_end:new Float32Array(8),interp_tsr:new Float32Array(8)}}var l=e.bools.id0,T=e.bools.id1,d=e.bools.id2;switch(t.state){case We:break;case Je:var u=r(e,_,c),f=l?a(e.vars.id0,t.variables,_.variables):u.objects.ca,P=T?a(e.vars.id1,t.variables,_.variables):u.objects.tr,p=d?a(e.vars.id2,t.variables,_.variables):u.objects.ta,v=g.j(P.render.world_tsr),m=g.j(p.render.world_tsr);switch(u.state){case $e:var N=e.bools.dur?Ne(a(e.vars.dur,t.variables,_.variables),ct):e.floats.dur;if(0==N)return E(f,v,m,u.camera_state.tsr_end),s(f,v,m,u.camera_state.tsr_end),void(_.curr_node=e.slot_idx_order);var b=g.j(f.render.world_tsr);I.copy(b,u.camera_state.trans_start);var h=Le.get_move_style(f);h==Le.MS_HOVER_CONTROLS?I.copy(f.render.hover_pivot,u.camera_state.target_start):h==Le.MS_STATIC||h==Le.MS_EYE_CONTROLS?(g.a(f.render.world_tsr,u.camera_state.tsr_start),E(f,v,m,u.camera_state.tsr_end)):I.copy(f.render.pivot,u.camera_state.target_start),I.copy(v,u.camera_state.trans_end),I.copy(m,u.camera_state.target_end),u.state=et;var Y=Ke.animate(0,1,1e3*N,function(e){Ue.check_active()&&(h==Le.MS_STATIC||h==Le.MS_EYE_CONTROLS?g.n(u.camera_state.tsr_start,u.camera_state.tsr_end,R._52(e),u.camera_state.interp_tsr):(u.camera_state.interp_target=I.lerp(u.camera_state.target_start,u.camera_state.target_end,R._52(e),u.camera_state.interp_target),u.camera_state.interp_trans=I.lerp(u.camera_state.trans_start,u.camera_state.trans_end,R._52(e),u.camera_state.interp_trans)),s(f,u.camera_state.interp_trans,u.camera_state.interp_target,u.camera_state.interp_tsr),1==e&&(u.state=tt))});break;case et:break;case tt:Ke.clear_animation(Y),u.state=$e,_.curr_node=e.slot_idx_order}}}function ee(e,t,_,n,o,i){function s(e,t,_){if(!E.id0){(t.objects.id0=xe.get_object(xe.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths.id0,0))||(ye.error("Logic script error: object not found. Node: ",e.name),e.mute=!0)}E.pvo&&!E.id1&&(t.objects.id1=xe.get_object(xe.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths.id1,0))}var E=e.bools;switch(t.state){case We:break;case Je:var c=r(e,_,s),l=E.id0?a(e.vars.id0,t.variables,_.variables):c.objects.id0,T=l.render;if(c.cam_state={target_cam_upside_down:T.target_cam_upside_down,use_panning:T.use_panning,horizontal_limits:T.horizontal_limits,vertical_limits:T.vertical_limits,distance_limits:T.distance_limits,hover_horiz_trans_limits:T.hover_horiz_trans_limits,hover_vert_trans_limits:T.hover_vert_trans_limits,pivot_limits:T.pivot_limits,enable_hover_hor_rotation:T.enable_hover_hor_rotation},Xe.is_camera(l)){var d=l.render,u=c.cam_state;switch(Le.wipe_move_style(l),e.common_usage_names.camera_move_style){case Ht:d.move_style=Le.MS_STATIC;break;case Qt:d.move_style=Le.MS_EYE_CONTROLS;var f=g.j(d.world_tsr);Le.setup_eye_model(l,f,null,u.horizontal_limits,u.vertical_limits);break;case zt:d.move_style=Le.MS_HOVER_CONTROLS;var f=g.j(d.world_tsr),P=je;if(e.bools.pvo){var A=E.id1?a(e.vars.id1,t.variables,_.variables):c.objects.id1;P=g.j(A.render.world_tsr)}else P[0]=e.bools.pvx?Ne(a(e.vars.pvx,t.variables,_.variables),ct):e.floats.pvx,P[1]=e.bools.pvy?Ne(a(e.vars.pvy,t.variables,_.variables),ct):e.floats.pvy,P[2]=e.bools.pvz?Ne(a(e.vars.pvz,t.variables,_.variables),ct):e.floats.pvz;Le.setup_hover_model(l,f,P,u.distance_limits,u.vertical_limits,u.hover_horiz_trans_limits,u.hover_vert_trans_limits,u.enable_hover_hor_rotation);break;case jt:d.move_style=Le.MS_TARGET_CONTROLS;var f=g.j(d.world_tsr),P=je;if(e.bools.pvo){var A=E.id1?a(e.vars.id1,t.variables,_.variables):c.objects.id1;P=g.j(A.render.world_tsr)}else P[0]=e.bools.pvx?Ne(a(e.vars.pvx,t.variables,_.variables),ct):e.floats.pvx,P[1]=e.bools.pvy?Ne(a(e.vars.pvy,t.variables,_.variables),ct):e.floats.pvy,P[2]=e.bools.pvz?Ne(a(e.vars.pvz,t.variables,_.variables),ct):e.floats.pvz;Le.setup_target_model(l,f,P,u.horizontal_limits,u.vertical_limits,u.distance_limits,u.pivot_limits,u.use_panning)}var S=Qe;S[0]=e.bools.vtr?Ne(a(e.vars.vtr,t.variables,_.variables),ct):e.floats.vtr,S[1]=e.bools.vro?Ne(a(e.vars.vro,t.variables,_.variables),ct):e.floats.vro,S[2]=e.bools.vzo?Ne(a(e.vars.vzo,t.variables,_.variables),ct):e.floats.vzo,S[0]=R.M(S[0],0,1/0),S[1]=R.M(S[1],0,1/0),S[2]=R.M(S[2],0,.99),d.velocity_trans=S[0],d.velocity_rot=S[1],d.velocity_zoom=S[2],Be.update_transform(l),Ge.sync_transform(l),Le.init_ortho_props(l)}else ye.error("Logic script error: object is not a Camera. Node: ",e.name);_.curr_node=e.slot_idx_order}}function te(e,t,_,n,o,i){function s(e,t,_){E.id0||(t.objects.id0=xe.get_object(xe.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths.id0,0))||(ye.error("Logic script error: object not found. Node: ",e.name),e.mute=!0)}var E=e.bools;switch(t.state){case We:break;case Je:var c=r(e,_,s),l=E.id0?a(e.vars.id0,t.variables,_.variables):c.objects.id0;if(Xe.is_camera(l)){switch(l.render.move_style){case Le.MS_TARGET_CONTROLS:if(e.bools.dsl){var T=e.bools.dslmin?Ne(a(e.vars.dslmin,t.variables,_.variables),ct):e.floats.dslmin,d=e.bools.dslmax?Ne(a(e.vars.dslmax,t.variables,_.variables),ct):e.floats.dslmax,u={};u.min=Math.max(T,0),u.max=Math.max(d,0),Le.set_distance_limits(l,u)}if(e.bools.vrl){var f=e.bools.vrldown?Ne(a(e.vars.vrldown,t.variables,_.variables),ct):e.floats.vrldown,P=e.bools.vrlup?Ne(a(e.vars.vrlup,t.variables,_.variables),ct):e.floats.vrlup,u={};u.down=f,u.up=P,u.camera_space="CAMERA"==e.common_usage_names.cam_lim_vert_rot_space_type,Le.set_vertical_rot_limits(l,u)}if(e.bools.hrl){var A=e.bools.hrlleft?Ne(a(e.vars.hrlleft,t.variables,_.variables),ct):e.floats.hrlleft,S=e.bools.hrlright?Ne(a(e.vars.hrlright,t.variables,_.variables),ct):e.floats.hrlright,u={};u.left=A,u.right=S,u.camera_space="CAMERA"==e.common_usage_names.cam_lim_hor_rot_space_type,Le.set_horizontal_rot_limits(l,u)}if(e.bools.pvl){var p=e.bools.pvlmin?Ne(a(e.vars.pvlmin,t.variables,_.variables),ct):e.floats.pvlmin,O=e.bools.pvlmax?Ne(a(e.vars.pvlmax,t.variables,_.variables),ct):e.floats.pvlmax,u={};u.min_z=p,u.max_z=O,Le.set_pivot_limits(l,u)}break;case Le.MS_HOVER_CONTROLS:if(e.bools.htl){var v=e.bools.htlmin?Ne(a(e.vars.htlmin,t.variables,_.variables),ct):e.floats.htlmin,m=e.bools.htlmax?Ne(a(e.vars.htlmax,t.variables,_.variables),ct):e.floats.htlmax,u={};u.min=v,u.max=m,Le.set_hor_trans_limits(l,u)}if(e.bools.vtl){var N=e.bools.vtlmin?Ne(a(e.vars.vtlmin,t.variables,_.variables),ct):e.floats.vtlmin,g=e.bools.vtlmax?Ne(a(e.vars.vtlmax,t.variables,_.variables),ct):e.floats.vtlmax,u={};u.min=N,u.max=g,Le.set_vert_trans_limits(l,u)}if(e.bools.vrl){var f=e.bools.vrldown?Ne(a(e.vars.vrldown,t.variables,_.variables),ct):e.floats.vrldown,P=e.bools.vrlup?Ne(a(e.vars.vrlup,t.variables,_.variables),ct):e.floats.vrlup,u={};u.down=f,u.up=P,u.camera_space="CAMERA"==e.common_usage_names.cam_lim_vert_rot_space_type,Le.hover_set_vertical_limits(l,u)}if(e.bools.dsl){var T=e.bools.dslmin?Ne(a(e.vars.dslmin,t.variables,_.variables),ct):e.floats.dslmin,d=e.bools.dslmax?Ne(a(e.vars.dslmax,t.variables,_.variables),ct):e.floats.dslmax,u={};u.min=Math.max(T,0),u.max=Math.max(d,0),Le.hover_set_distance_limits(l,u)}break;case Le.MS_EYE_CONTROLS:if(e.bools.vrl){var f=e.bools.vrldown?Ne(a(e.vars.vrldown,t.variables,_.variables),ct):e.floats.vrldown,P=e.bools.vrlup?Ne(a(e.vars.vrlup,t.variables,_.variables),ct):e.floats.vrlup,u={};u.down=f,u.up=P,u.camera_space="CAMERA"==e.common_usage_names.cam_lim_vert_rot_space_type,Le.set_vertical_rot_limits(l,u)}if(e.bools.hrl){var A=e.bools.hrlleft?Ne(a(e.vars.hrlleft,t.variables,_.variables),ct):e.floats.hrlleft,S=e.bools.hrlright?Ne(a(e.vars.hrlright,t.variables,_.variables),ct):e.floats.hrlright,u={};u.left=A,u.right=S,u.camera_space="CAMERA"==e.common_usage_names.cam_lim_hor_rot_space_type,Le.set_horizontal_rot_limits(l,u)}break;case Le.MS_STATIC:}Be.update_transform(l),Ge.sync_transform(l)}else ye.error("Logic script error: object is not a Camera. Node: ",e.name);_.curr_node=e.slot_idx_order}}function _e(e,t,_,n,o,i){function s(e,t){Be.set_tsr(e,t),Be.update_transform(e),Ge.sync_transform(e)}function E(e,_,r){_.objects.id0=ce(e,"id0",l,t.variables,r.variables),_.objects.id0||l||(ye.error("Logic script error: object not found. Node: ",e.name),e.mute=!0),_.objects.id1=ce(e,"id1",T,t.variables,r.variables),_.objects.id1||T||(ye.error("Logic script error: object not found. Node: ",e.name),e.mute=!0),_.state=$e,_.obj_state={dest_tsr_start:new Float32Array(8),dest_tsr_end:new Float32Array(8),interp_tsr_dest:new Float32Array(8)}}var c=e.bools,l=c.id0,T=c.id1;switch(t.state){case We:break;case Je:var d=r(e,_,E),u=c.id0?a(e.vars.id0,t.variables,_.variables):d.objects.id0;if(u.is_dynamic){g.a(u.render.world_tsr,d.obj_state.dest_tsr_start);var f=c.id1?a(e.vars.id1,t.variables,_.variables):d.objects.id1;switch(g.a(f.render.world_tsr,d.obj_state.dest_tsr_end),d.state){case $e:var P=e.bools.dur?Ne(a(e.vars.dur,t.variables,_.variables),ct):e.floats.dur;if(0==P)return s(u,d.obj_state.dest_tsr_end),void(_.curr_node=e.slot_idx_order);d.state=et;var A=Ke.animate(0,1,1e3*P,function(e){Ue.check_active()&&(d.obj_state.interp_dest=g.n(d.obj_state.dest_tsr_start,d.obj_state.dest_tsr_end,R._52(e),d.obj_state.interp_tsr_dest),s(u,d.obj_state.interp_tsr_dest),1==e&&(d.state=tt))});break;case et:break;case tt:Ke.clear_animation(A),d.state=$e,_.curr_node=e.slot_idx_order}break}ye.error("Logic script error: object '"+u.name+"' must be dynamic. Node: ",e.name),_.curr_node=e.slot_idx_order}}function re(e,t,_,n,o,i){function s(e,t,_){_==Kt?Be.set_tsr(e,t):Be.set_tsr_rel(e,t),Be.update_transform(e),Ge.sync_transform(e)}function E(e,_,r){_.obj=ce(e,"id0",c,t.variables,r.variables),_.obj||c||(ye.error("Logic script error: object not found. Node: ",e.name),e.mute=!0),_.state=$e,_.obj_state={space:Kt,tsr_start:new Float32Array(8),tsr_end:new Float32Array(8),interp_tsr:new Float32Array(8)}}var c=e.bools.id0,l=r(e,_,E);switch(t.state){case We:break;case Je:var T=c?a(e.vars.id0,t.variables,_.variables):l.obj;switch(l.state){case $e:var d=Qe;d[0]=e.bools.trx?Ne(a(e.vars.trx,t.variables,_.variables),ct):e.floats.trx,d[1]=e.bools.try?Ne(a(e.vars.try,t.variables,_.variables),ct):e.floats.try,d[2]=e.bools.trz?Ne(a(e.vars.trz,t.variables,_.variables),ct):e.floats.trz;var u=je;u[0]=e.bools.rox?Ne(a(e.vars.rox,t.variables,_.variables),ct)*Math.PI/180:e.floats.rox,u[1]=e.bools.roy?Ne(a(e.vars.roy,t.variables,_.variables),ct)*Math.PI/180:e.floats.roy,u[2]=e.bools.roz?Ne(a(e.vars.roz,t.variables,_.variables),ct)*Math.PI/180:e.floats.roz;var f=e.bools.sc?a(e.vars.sc,t.variables,_.variables):e.floats.sc;switch(R.Y(u,He),g.s(d,f,He,l.obj_state.tsr_end),l.obj_state.space=e.common_usage_names.space_type,l.obj_state.space){case Kt:Be.get_tsr(T,l.obj_state.tsr_start);break;case Bt:Be.get_tsr_rel(T,l.obj_state.tsr_start);break;case Xt:Be.get_tsr_rel(T,l.obj_state.tsr_start),g.p(l.obj_state.tsr_start,l.obj_state.tsr_end,l.obj_state.tsr_end)}var P=e.bools.dur?Ne(a(e.vars.dur,t.variables,_.variables),ct):e.floats.dur;if(0==P)return s(T,l.obj_state.tsr_end,l.obj_state.space),void(_.curr_node=e.slot_idx_order);l.state=et;var A=Ke.animate(0,1,1e3*P,function(e){Ue.check_active()&&(g.n(l.obj_state.tsr_start,l.obj_state.tsr_end,R._52(e),l.obj_state.interp_tsr),s(T,l.obj_state.interp_tsr,l.obj_state.space),1==e&&(l.state=tt))});break;case et:break;case tt:Ke.clear_animation(A),l.state=$e,_.curr_node=e.slot_idx_order}}}function ae(e,t,_,n,o,i){function s(e,_,r){_.obj=ce(e,"id0",E,t.variables,r.variables),_.obj||E||(ye.error("Logic script error: object not found. Node: ",e.name),e.mute=!0)}var E=e.bools.id0;switch(t.state){case We:void 0==e.bools.not_wait&&(e.bools.not_wait=!0);break;case Je:var c=r(e,_,s);switch(c.obj=E?a(e.vars.id0,t.variables,_.variables):c.obj,ke.is_playing(c.obj)||c.state==et&&(c.state=tt),c.state){case $e:for(var l in t.logic_threads){var T=t.logic_threads[l].thread_state.curr_node;if(-1!=T){var d=t.logic_threads[l].nodes[T];"SPEAKER_PLAY"==d.type&&d!=e&&c.state==et&&d.obj==e.obj&&(d.state=tt)}}e.bools.not_wait||(_.in_progress=!0),ke.play_def(c.obj),c.state=et;break;case et:e.bools.not_wait&&(_.curr_node=e.slot_idx_order,c.state=$e);break;case tt:e.bools.not_wait||(_.in_progress=!1),_.curr_node=e.slot_idx_order,c.state=$e;break;default:he.panic("Unknown state of "+e.name),c.state=$e}}}function ne(e,t,_,n,o,i){function s(e,_,r){_.obj=ce(e,"id0",E,t.variables,r.variables),_.obj||E||(ye.error("Logic script error: object not found. Node: ",e.name),e.mute=!0)}var E=e.bools.id0;switch(t.state){case We:break;case Je:var c=r(e,_,s),l=E?a(e.vars.id0,t.variables,_.variables):c.obj;ke.stop(l),_.curr_node=e.slot_idx_order}}function oe(e,t,_,n,o,i){function s(e,t,_){e.objects_paths.id0&&(t.objects.id0=xe.get_object(xe.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths.id0,0),e.objects_paths.id0||(ye.error("Logic script error: object not found. Node: ",e.name),e.mute=!0),e.nodes_paths.id0.unshift(e.materials_names.id0))}switch(t.state){case We:break;case Je:var E=r(e,_,s),c=E.objects.id0,l=e.nodes_paths.id0,T=l[0],d=De.name_list_to_node_name(l,1),u=De.find_batch_material(c,T,"MAIN");if(_.curr_node=e.slot_idx_order,null===u)return void ye.error('Material "'+T+'" was not found in the object "'+c.name+'".');"ShaderNodeRGB"==e.shader_nd_type&&xe.set_nodemat_rgb(c,T,d,e.bools.id0?Ne(a(e.vars.id0,t.variables,_.variables),ct):e.floats.id0,e.bools.id1?Ne(a(e.vars.id1,t.variables,_.variables),ct):e.floats.id1,e.bools.id2?Ne(a(e.vars.id2,t.variables,_.variables),ct):e.floats.id2),"ShaderNodeValue"==e.shader_nd_type&&xe.set_nodemat_value(c,T,d,e.bools.id0?Ne(a(e.vars.id0,t.variables,_.variables),ct):e.floats.id0)}}function ie(e,t,_,r,n,o){switch(t.state){case Je:var i=-1==e.vars.id0[1]?e.floats.inp1:Ne(a(e.vars.id0,t.variables,_.variables),ct),s=-1==e.vars.id1[1]?e.floats.inp2:Ne(a(e.vars.id1,t.variables,_.variables),ct),E=0;switch(e.op){case Pt:E=i+s;break;case ft:E=i*s;break;case ut:E=i-s;break;case dt:0==s&&he.panic("Division by zero in Logic script"),E=i/s;break;case At:E=Math.random()*(s-i)+i;break;case St:E=Math.sin(i);break;case pt:E=Math.cos(i);break;case Ot:E=Math.tan(i);break;case vt:E=Math.asin(i);break;case mt:E=Math.acos(i);break;case Nt:E=Math.atan(i);break;case gt:E=Math.log(i);break;case Rt:E=Math.min(i,s);break;case It:E=Math.max(i,s);break;case bt:E=Math.round(i);break;case ht:E=i%s;break;case Yt:E=Math.abs(i)}h(e.vars.vd,t.variables,_.variables,E),_.curr_node=e.slot_idx_order}}function se(e,t,_,r,n,o){switch(t.state){case Je:var i=e.common_usage_names.variable_type,s=Ie(e,i),E=!1;if(i==Tt){var c=e.bools.id0?a(e.vars.id0,t.variables,_.variables):xe.get_object(xe.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths.id0,0),l=e.bools.id1?a(e.vars.id1,t.variables,_.variables):xe.get_object(xe.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths.id1,0);switch(e.common_usage_names.condition){case kt:c==l&&(E=!0);break;case Gt:c!=l&&(E=!0)}}else{var c=-1==e.vars.id0[1]?s.inp1:Ne(a(e.vars.id0,t.variables,_.variables),i),l=-1==e.vars.id1[1]?s.inp2:Ne(a(e.vars.id1,t.variables,_.variables),i);switch(e.common_usage_names.condition){case kt:c==l&&(E=!0);break;case Gt:c!=l&&(E=!0);break;case Ft:c<l&&(E=!0);break;case Dt:c>l&&(E=!0);break;case Ct:c<=l&&(E=!0);break;case wt:c>=l&&(E=!0)}}_.curr_node=E?e.slot_idx_jump:e.slot_idx_order}}function Ee(e,t,_,r,n,o){switch(t.state){case Je:if(e.bools.vs)var i=a(e.vars.vs,t.variables,_.variables);else{var s=e.common_usage_names.variable_type,E=Ie(e,s);if(s==Tt)var i=xe.get_object(xe.GET_OBJECT_BY_DUPLI_NAME_LIST,E.id0,0);else var i=E.inp1}h([e.bools.new&&e.bools.gl||e.vars.vd[0],e.vars.vd[1]],t.variables,_.variables,i),_.curr_node=e.slot_idx_order}}function ce(e,t,_,r,n){return _?a(e.vars[t],r,n):xe.get_object(xe.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths[t],0)}function le(e){var t=e.thread_state.callstack;if(t.length<=1)var _=e.nodes;else var _=t[t.length-1].logic_func.func.nodes;return _}function Te(e,t,_,n,o,i){function s(e,_,r){_.obj=c?w(e):ce(e,"id0",E,t.variables,r.variables),_.obj||E||(ye.error("Logic script error: object not found. Node: ",e.name),e.mute=!0)}var E=e.bools.id0,c=e.bools.env;switch(t.state){case We:break;case Je:var l=r(e,_,s);switch(c||(l.obj=E?a(e.vars.id0,t.variables,_.variables):l.obj),l.state!=et||be.is_play(l.obj,l.anim_slot)||(l.state=tt),l.state){case $e:for(var T in t.logic_threads){var d=t.logic_threads[T],u=le(d),f=d.thread_state.curr_node;if(-1!=f){var P=u[f],A=r(P,d.thread_state);"PLAY_ANIM"==P.type&&P!=e&&A.state==et&&A.obj==l.obj&&(A.state=tt)}}var S=e.common_usage_names.param_anim_behavior;if(""==e.anim_name)be.apply_def(l.obj),be.set_behavior(l.obj,S,be.SLOT_ALL);else{var p=function(e,t){for(var _=-1,r=0;r<8;r++){var a=e.anim_slots[r];if(a&&a.animation_name&&be.strip_baked_suffix(a.animation_name)==be.strip_baked_suffix(t)){if(-1==_)return-1;_=r}}return _}(l.obj,e.anim_name);-1==p?(l.anim_slot=be.slot_by_anim_type(l.obj,e.anim_name),be.apply(l.obj,null,e.anim_name,l.anim_slot)):l.anim_slot=p,be.set_behavior(l.obj,S,l.anim_slot)}e.bools.not_wait||(_.in_progress=!0),be.play(l.obj,null,l.anim_slot),l.state=et,e.bools.not_wait&&(_.curr_node=e.slot_idx_order,l.state=$e);break;case et:break;case tt:e.bools.not_wait||(_.in_progress=!1),_.curr_node=e.slot_idx_order,l.state=$e;break;default:he.panic("Unknown state of "+e.name),l.state=$e}}}function de(e,t,_,n,o,i){function s(e,_,r){_.obj=c?w(e):ce(e,"id0",E,t.variables,r.variables),_.obj||E||(ye.error("Logic script error: object not found. Node: ",e.name),e.mute=!0)}var E=e.bools.id0,c=e.bools.env;switch(t.state){case We:break;case Je:var l=r(e,_,s);l.obj=E?a(e.vars.id0,t.variables,_.variables):l.obj,be.stop(l.obj,be.SLOT_ALL),e.bools.rst&&be.set_first_frame(l.obj,be.SLOT_ALL),_.curr_node=e.slot_idx_order}}function ue(e,t,_,r,n,o){switch(t.state){case Je:var i=e.bools.id0?Ne(a(e.vars.id0,t.variables,_.variables),lt):e.strings.id0,s=e.bools.id1?Ne(a(e.vars.id1,t.variables,_.variables),lt):e.strings.id1,E=0;switch(e.common_usage_names.string_operation){case Lt:E=i+s;break;case Mt:E=i.indexOf(s);break;case xt:var c=e.bools.id2?Ne(a(e.vars.id2,t.variables,_.variables),lt):e.strings.id2;E=i.replace(s,c);break;case yt:var l=e.vars;E=i.substring(0,i.indexOf(s)),h(l.dst1,t.variables,_.variables,i.substring(i.indexOf(s)+1,i.length)),""==a(l.dst,t.variables,_.variables)&&(E=a(l.dst1,t.variables,_.variables),h(l.dst1,t.variables,_.variables,""));break;case Ut:switch(e.common_usage_names.condition){case kt:E=i==s?1:0;break;case Gt:E=i!=s?1:0;break;case Ft:E=i<s?1:0;break;case Dt:E=i>s?1:0;break;case Ct:E=i<=s?1:0;break;case wt:E=i>=s?1:0}}h(e.vars.dst,t.variables,_.variables,E),_.curr_node=e.slot_idx_order}}function fe(e,t,_,r,a,n){switch(t.state){case Je:var o=e.bools.nla?Ne(Me.get_frame(r),ct):Ne(Ke.get_frame(r),ct);h(e.vars.vd,t.variables,_.variables,o),_.curr_node=e.slot_idx_order}}function Pe(e,t,_,r,n,o){switch(t.state){case Je:switch(e.common_usage_names.json_operation){case"PARSE":try{var i=Ne(a(e.vars.jsn,t.variables,_.variables),lt),s=JSON.parse(i);!function(e,t,_,r){for(var a=0;a<t.length;a++){for(var n=t[a],o=n.split("."),i=e,s=_[a],E=0;E<o.length&&void 0!==(i=i[o[E]])&&null!==i;E++);i=ge(i),r[s]=i}}(s,e.parse_json_paths,e.parse_json_vars,_.variables)}catch(e){ye.error("logic script error: non valid JSON string")}break;case"ENCODE":var E={};!function(e,t,_,r){r||(r={});for(var a=0;a<t.length;a++){var n=t[a],o=n.split("."),i=r,s=_[a];if(s in e){for(var E=0;E<o.length-1;E++)void 0===i[o[E]]&&(isNaN(o[E+1])?i[o[E]]={}:i[o[E]]=[]),i=i[o[E]];i[o[o.length-1]]=ge(e[s])}}}(_.variables,e.encode_json_paths,e.encode_json_vars,E);var c=Ne(JSON.stringify(E),lt);h(e.vars.jsn,t.variables,_.variables,c)}_.curr_node=e.slot_idx_order}}function Ae(e,t,_,r,n,o){switch(t.state){case Je:for(var i,s=e.bools.cb?Ne(a(e.vars.cb,t.variables,_.variables),lt):e.strings.cb,E=[],c=0,l="id"+c,T=e.common_usage_names.js_cb_params;l in T;)i=T[l]==Vt?xe.get_object(xe.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths[l],0):a(e.vars[l],t.variables,_.variables),E.push(i),c++,l="id"+c;var d=[];for(c=0,l="out"+c;l in e.vars;)i=a(e.vars[l],t.variables,_.variables),d.push(i),c++,l="out"+c;var u=1;if(s in Jt){if(u=!Jt[s](E,d))for(var f=0;f<d.length;f++)(l="out"+f)in e.vars&&h(e.vars[l],t.variables,_.variables,ge(d[f]))}else ye.error("logic script error: no custom callback with id "+s);u&&(_.curr_node=e.slot_idx_order)}}function Se(e,t,_,r,a,n){switch(t.state){case Je:var o,i,s,E,c,l,T=e.common_usage_names.time_type,d=new Date;"L"==T?(o=d.getFullYear(),i=d.getMonth(),s=d.getDate(),E=d.getHours(),c=d.getMinutes(),l=d.getSeconds()):(o=d.getUTCFullYear(),i=d.getUTCMonth(),s=d.getUTCDate(),E=d.getUTCHours(),c=d.getUTCMinutes(),l=d.getUTCSeconds()),e.bools.y&&h(e.vars.y,t.variables,_.variables,o),e.bools.M&&h(e.vars.M,t.variables,_.variables,i),e.bools.d&&h(e.vars.d,t.variables,_.variables,s),e.bools.h&&h(e.vars.h,t.variables,_.variables,E),e.bools.m&&h(e.vars.m,t.variables,_.variables,c),e.bools.s&&h(e.vars.s,t.variables,_.variables,l),_.curr_node=e.slot_idx_order}}function pe(e,t,_,r,a,n){switch(t.state){case Je:h(e.vars.s,t.variables,_.variables,a),_.curr_node=e.slot_idx_order}}function Oe(e,t,_,r,a,n){switch(t.state){case We:for(var o=e.logic_node_trees.id0,i=e.logic_functions.id0,s=0;s<t.logic_functions.length;s++){var E=t.logic_functions[s];if(E.id[0][0]==o[0]&&E.id[0][1]==o[1]&&E.id[1]==i){e.func_id=s;break}}break;case Je:var c={};_.variables_references={};for(var l in e.vars){var T=e.vars[l][1],d=e.strings[l];c[d]=e.vars[l][0]?t.variables[T]:_.variables[T],l.startsWith("out")&&(_.variables_references[T]=d)}_.callstack.push({caller_node:e,variables:c,logic_func:t.logic_functions[e.func_id]}),_.variables=c,_.update_script_cycle=!0,_.curr_node=t.logic_functions[e.func_id].func.nodes[0].slot_idx_order}}function ve(e,t,_,r,a,n){e.thread_state.update_script_cycle=!1;var o=e.thread_state.callstack;if(o.length<=1)var i=e.nodes;else var i=o[o.length-1].logic_func.func.nodes;if(i.length){if(!n)for(var s=0;s<i.length;s++)i[s].processed=!1;for(var s=0;s<i.length;s++){if(!(e.thread_state.curr_node>=0)){if(e.thread_state.callstack.length>1){var E=e.thread_state.callstack.pop(),c=E.caller_node,l=o[o.length-1];if(l.logic_func)var T=l.logic_func.func.nodes;else var T=e.nodes;e.thread_state.curr_node=c.slot_idx_order;var d=T[c.slot_idx_order],u=e.thread_state.variables;e.thread_state.variables=l.variables;for(var f in e.thread_state.variables_references){var P=e.thread_state.variables_references[f];void 0===e.thread_state.variables[f]?t.variables[f]=u[P]:e.thread_state.variables[f]=u[P]}return void ve(e,t,_,r,a,!0)}return}var d=i[e.thread_state.curr_node];if(d.processed)return;if(d.mute){if("ENTRYPOINT"==d.type)return;e.thread_state.curr_node=d.slot_idx_order,d.processed=!0}else if(d.process_node(d,t,e.thread_state,_,r,a),d.processed=!0,e.thread_state.update_script_cycle)return}o.splice(0,o.length)}}function me(e,t){function r(e,t){return e-t}var a=e.b4w_logic_nodes,n=t.logic_threads,o=t.logic_functions;t.state=We;for(var i=-1,s=0;s<a.length;s++){for(var E={nodes:[],thread_state:{scene:e,curr_node:0,in_progress:!1,update_script_cycle:!1,thread_index:s,callstack:[],variables:{R1:0,R2:0,R3:0,R4:0,R5:0,R6:0,R7:0,R8:0}}},c=a[s],l=0;l<c.length;l++){var T=c[l],d=_(T,E);E.nodes.push(d)}switch(E.nodes[0].type){case"ENTRYPOINT":i++,E.thread_state.thread_index=i,n.push(E);break;case"DEF_FUNC":var u=E.nodes[0];E.thread_state=null;var f={id:[u.logic_node_trees.id0,u.logic_functions.id0],func:E};o.push(f)}}for(var s=0;s<n.length;s++)for(var E=n[s],P=0;P<E.nodes.length;P++)d=E.nodes[P],d.mute||d.process_node(d,t,E.thread_state,0,0);for(var s=0;s<o.length;s++)for(var A=o[s].func,P=0;P<A.nodes.length;P++)d=A.nodes[P],d.mute||d.process_node(d,t,0,0,0);var S=e.timeline_markers;for(var p in S)t.sorted_markers_values.push(S[p]);t.sorted_markers_values.sort(r),t.state=Je,Wt.push(t)}function Ne(e,t){switch(t){case ct:return Number(e)?Number(e):0;case lt:return String(e);case Tt:return e;default:return null}}function ge(e){switch(typeof e){case"string":return Ne(e,lt);case"number":return Ne(e,ct);default:return Ne(e,lt)}}function Re(e){Zt[e]||(Zt[e]=0);var t=e+"_"+Zt[e];return t=t.replace(/ /g,"_").replace(/\//g,"_"),Zt[e]++,t}function Ie(e,t){switch(t){case ct:return e.floats;case lt:return e.strings;case Tt:return e.objects_paths}}var be=Object(n.a)(e),he=Object(o.a)(e),Ye=Object(i.a)(e),Le=Object(s.a)(e),Me=Object(E.a)(e),xe=Object(c.a)(e),ye=Object(l.a)(e),Ue=Object(T.a)(e),we=Object(d.a)(e),Ce=Object(u.a)(e),De=Object(f.a)(e),Fe=Object(P.a)(e),Ge=Object(p.a)(e),ke=Object(v.a)(e),Ke=Object(m.a)(e),Be=Object(N.a)(e),Xe=Object(b.a)(e),He=new Float32Array(4),je=new Float32Array(3),Qe=new Float32Array(3),ze=new Float32Array(2),Ve=new Float32Array(9),qe=new Float32Array(16),We=1,Je=2,Ze=3,$e=-1,et=0,tt=1,_t=-3,rt=-2,at=-1,nt=0,ot=1,it=-1,st=0,Et=1,ct=0,lt=1,Tt=2;t.NT_NUMBER=ct,t.NT_STRING=lt,t.NT_OBJECT=Tt;var dt=0,ut=1,ft=2,Pt=3,At=4,St=5,pt=6,Ot=7,vt=8,mt=9,Nt=10,gt=11,Rt=12,It=13,bt=14,ht=15,Yt=16;t.NMO_DIV=dt,t.NMO_SUB=ut,t.NMO_MUL=ft,t.NMO_ADD=Pt,t.NMO_RAND=At,t.NMO_SIN=St,t.NMO_COS=pt,t.NMO_TAN=Ot,t.NMO_ARCSIN=vt,t.NMO_ARCCOS=mt,t.NMO_ARCTAN=Nt,t.NMO_LOG=gt,t.NMO_MIN=Rt,t.NMO_MAX=It,t.NMO_ROUND=bt,t.NMO_MOD=ht,t.NMO_ABS=Yt;var Lt=0,Mt=1,xt=2,yt=3,Ut=4;t.NSO_JOIN=Lt,t.NSO_FIND=Mt,t.NSO_REPLACE=xt,t.NSO_SPLIT=yt,t.NSO_COMPARE=Ut;var wt=0,Ct=1,Dt=2,Ft=3,Gt=4,kt=5;t.NC_GEQUAL=wt,t.NC_LEQUAL=Ct,t.NC_GREATER=Dt,t.NC_LESS=Ft,t.NC_NOTEQUAL=Gt,t.NC_EQUAL=kt;var Kt=0,Bt=1,Xt=2;t.NST_WORLD=Kt,t.NST_PARENT=Bt,t.NST_LOCAL=Xt;var Ht=0,jt=1,Qt=2,zt=3;t.NCMS_STATIC=Ht,t.NCMS_TARGET=jt,t.NCMS_EYE=Qt,t.NCMS_HOVER=zt;var Vt=0;t.NCPT_OBJECT=Vt,t.NCPT_VARIABLE=1;var qt={ENTRYPOINT:C,HIDE:D,SHOW:F,PAGEPARAM:G,SWITCH_SELECT:B,SELECT:k,PLAY:H,REDIRECT:z,MATH:ie,CONDJUMP:se,REGSTORE:Ee,PLAY_ANIM:Te,SELECT_PLAY:Y,SEND_REQ:V,INHERIT_MAT:q,SET_SHADER_NODE_PARAM:oe,DELAY:W,APPLY_SHAPE_KEY:J,OUTLINE:Z,MOVE_CAMERA:$,SET_CAMERA_MOVE_STYLE:ee,SET_CAMERA_LIMITS:te,MOVE_TO:_e,TRANSFORM_OBJECT:re,SPEAKER_PLAY:ae,SPEAKER_STOP:ne,STOP_ANIM:de,STOP_TIMELINE:Q,CONSOLE_PRINT:j,STRING:ue,GET_TIMELINE:fe,JSON:Pe,JS_CALLBACK:Ae,EMPTY:Y,DATE_TIME:Se,ELAPSED:pe,CALL_FUNC:Oe,DEF_FUNC:Y,SWITCH:X},Wt=[],Jt={},Zt={};t.init_logic=function(e,t){var _={data_id:t,scene_name:e.name,state:0,nla_thread:null,scene:e,curr_thread:null,logic_threads:[],logic_functions:[],sorted_markers_values:[],variables:{},variables_references:{}};e._logic=_,me(e,_)},t.update=function(e,t){var _=Me.get_start_time();if(!(_<=0))for(var r=0;r<Wt.length;r++)y(r,e,t,_)},t.append_custom_cb=function(e,t){Jt[e]=t},t.remove_custom_cb=function(e){delete Jt[e]},t.run_ep=function(e,t){for(var _=0;_<Wt.length;_++)if(Wt[_].scene_name==e){for(var r=Wt[_],a=0;a<r.logic_threads.length;a++){var n=r.logic_threads[a].nodes[0];if(n.name==t){n.bools.js&&(n.mute=!1),r.logic_threads[a].thread_state.curr_node=0;break}}break}};var $t=function(){return function(e,t,_,a){var n=a[0],o=a[1],i=a[2],s=r(n,i.thread_state);if(s.state==at){for(var E=0;E<s.sel_objs_len;E++){if(Ce.get_sensor_value(e,t,E)){for(var c=0;c<s.sel_obj_idxs.length;c++)if(s.sel_obj_idxs[c]==E)return o.nla_thread==s.thread?(Me.is_play(o._nla)&&(s.state=_t),i.thread_state.in_progress||(s.state=ot,s.slot_idx_jump=s.links_idxs[c])):(s.state=ot,s.slot_idx_jump=s.links_idxs[c]),void(s.select_object_idx=E);s.select_object_idx=E}}s.state=nt}}};t.cleanup=function(){Wt.length=0,Jt={},Zt={}}}var a=_(0),n=_(37),o=_(5),i=_(43),s=_(14),E=_(52),c=_(12),l=_(1),T=_(10),d=_(4),u=_(53),f=_(16),P=_(20),A=_(27),S=_(21),p=_(19),O=_(9),v=_(23),m=_(18),N=_(13),g=_(6),R=_(2),I=_(3),b=_(8),h=Object(a.a)("__logic_nodes",r);t.a=h},function(e,t,_){"use strict";function r(e,t){function _(){window.performance||(Ee.log("Apply performance workaround"),window.performance={});var e=Date.now();window.performance.now||(Ee.log("Apply performance.now() workaround"),window.performance.now=function(){return Date.now()-e}),fe.set_timeline(0)}function r(e,t){for(var _=null,r=t?he:be,a=0;a<r.length;a++){var n=r[a];try{_=e.getContext(n,Se)}catch(e){}if(_)break}return _&&z.detect_tegra_invalid_enum_issue(_),_}function a(e,t,_){e.addEventListener("webglcontextlost",function(e){e.preventDefault(),Ee.error("WebGL context lost"),F()},!1),ee.setup_context(_);var r=ee.get_renderer_info();r&&Ee.log("%cRENDERER INFO:","color: #00a",_.getParameter(r.UNMASKED_VENDOR_WEBGL)+", "+_.getParameter(r.UNMASKED_RENDERER_WEBGL)),ce.setup_context(_),te.setup_context(_),ue.setup_context(_),de.setup_context(_),V.setup_context(_),q.setup(_),Z.setup_context(_),J.setup_canvas(e),V.init(e,t),le.setup_dim(e.width,e.height,1),Te.init(),_e.init(),Re=B(),k()}function C(e){Ie=e}function D(){Ie=function(){}}function F(){G()||(ve=performance.now()/1e3,Te.pause(),se.pause(),ue.pause(),X.pause())}function G(){return me<ve}function k(){var e="HMD"===pe.stereo&&_e.get_webvr_display();e?e.requestAnimationFrame(k):Le(k);var t=performance.now()/1e3;Oe||(Oe=t);var _=t-Oe;if(!(_<1/pe.max_fps)){for(var r=fe.get_timeline(),a=0;a<Ne.length;a++)Ne[a](r,_);G()||(me>Oe&&(_-=me-Math.max(ve,Oe)),fe.set_delta(_),r+=_,fe.set_timeline(r),$.update(),j.update(),J.update(),K(r,_),Re(_)),Oe=t,e&&e.isPresenting&&e.submitFrame()}}function K(e,t){J.is_primary_loaded()&&(re.reset(),Pe.update(t),oe.update(e,t),ae.update(e,t),Te.update(e,t),t&&H.update(t),J.is_primary_loaded()&&(se.update(e,t),J.is_primary_loaded()&&(_e.update(e),W.update(e,t),J.is_primary_loaded()&&(X.update(!1),ie.update(e,t),Ae.update(),Ie(t,e),J.is_primary_loaded()&&(le.update(e,t),X.update_visibility(),ne.frame())))))}function B(){var e=60,t=0,_=pe.fps_measurement_interval,r=pe.fps_callback_interval;return function(a){if(!(a<1/pe.max_fps)){e=y._50(1/a,e,a,_);var n=se.get_fps();t=(t+1)%r,0==t&&ge(Math.round(e),n)}}}var X=Object(n.a)(e),H=Object(o.a)(e),j=Object(i.a)(e),Q=Object(s.a)(e),z=Object(E.a)(e),V=Object(c.a)(e),q=Object(l.a)(e),W=Object(T.a)(e),J=Object(d.a)(e),Z=Object(u.a)(e),$=Object(f.a)(e),ee=Object(P.a)(e),te=Object(A.a)(e),_e=Object(S.a)(e),re=Object(p.a)(e),ae=Object(O.a)(e),ne=Object(v.a)(e),oe=Object(m.a)(e),ie=Object(N.a)(e),se=Object(g.a)(e),Ee=Object(R.a)(e),ce=Object(I.a)(e),le=Object(b.a)(e),Te=Object(h.a)(e),de=Object(Y.a)(e),ue=Object(L.a)(e),fe=Object(M.a)(e),Pe=Object(x.a)(e),Ae=Object(w.a)(e),Se=Q.context,pe=Q.defaults,Oe=0,ve=0,me=0,Ne=[],ge=function(){},Re=function(){},Ie=function(){},be=["webgl","experimental-webgl"],he=["webgl2","experimental-webgl2"],Ye=null,Le=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/pe.max_fps)}}();t.init=function(e,t){Ee.set_verbose(pe.console_verbose);var n=Object(U.f)()+" "+Object(U.d)()+" ("+Object(U.b)()+")";if(Ee.log("%cINIT ENGINE","color: #00a",n),Ee.log("%cUSER AGENT:","color: #00a",navigator.userAgent),!window.WebGLRenderingContext)return null;_(),t?re.init(t):(Q.defaults.show_hud_debug_info=!1,Q.sfx.mix_mode=!1),z.apply_context_alpha_hack(),z.check_user_agent("Chrome")||z.check_user_agent("Firefox")||(pe.webgl2=!1);var o=r(e,pe.webgl2);return!o&&pe.webgl2&&(pe.webgl2=!1,o=r(e,!1)),o?(Ee.log("%cINIT WEBGL "+(pe.webgl2?"2":"1"),"color: #00a"),Ye=o,a(e,t,o),Q.apply_quality(),z.set_hardware_defaults(o,!0),Q.set_paths(),de.load_shaders(),pe.ie11_edge_touchscreen_hack&&(e.style["touch-action"]="none"),Ee.log("%cSET PRECISION:","color: #00a",pe.precision),o):null},t.set_fps_callback=function(e){ge=e},t.clear_fps_callback=function(){ge=function(){}},t.set_render_callback=function(e){C(e)},t.clear_render_callback=function(){D()},t.pause=F,t.resume=function(){G()&&(me=performance.now()/1e3,Te.resume(),se.resume(),ue.play(!0),X.resume())},t.is_paused=G,t.reset=function(){J.unload(0),q.reset(),J.reset(),ee.reset(),ce.reset(),te.reset(),ue.reset_mod(),de.reset(),Z.reset(),V.reset(),J.reset(),V.reset(),fe.reset(),Te.reset(),Oe=0,ve=0,me=0,ge=function(){},Re=function(){},Ie=function(){},Ne.length=0,Ye=null},t.canvas_data_url=function(e,t,_,r){ne.canvas_data_url(e,t,_,r)},t.detect_mobile=function(){return z.detect_mobile()},t.append_loop_cb=function(e){for(var t=0;t<Ne.length;t++)if(Ne[t]==e)return;Ne.push(e)},t.remove_loop_cb=function(e){for(var t=0;t<Ne.length;t++)if(Ne[t]==e){Ne.splice(t,1);break}},t.get_renderer_info=function(){var e=ee.get_renderer_info();return e?{vendor:Ye.getParameter(e.UNMASKED_VENDOR_WEBGL),renderer:Ye.getParameter(e.UNMASKED_RENDERER_WEBGL)}:null}}var a=_(0),n=_(55),o=_(37),i=_(43),s=_(4),E=_(35),c=_(15),l=_(66),T=_(53),d=_(42),u=_(44),f=_(62),P=_(28),A=_(20),S=_(38),p=_(51),O=_(52),v=_(79),m=_(59),N=_(12),g=_(19),R=_(1),I=_(22),b=_(10),h=_(23),Y=_(34),L=_(17),M=_(18),x=_(13),y=_(2),U=_(46),w=_(47),C=Object(a.a)("main",r);t.a=C},function(e,t,_){"use strict";function r(e,t){function _(e,t,_,a,n,o,i,s){var E=r(e,t,_,o,i,s);return it&&Xe(E.graph,a,n),E}function r(e,t,_,n,o,i){if(t in _t)return _t[t];var s={graph:null,id:t,cleanup_on_unload:!0};if(_||(at={},nt=0),"SHADOW"!=n&&"COLOR_ID"!=n){for(var E=Je.create(),c=e.nodes,l=0;l<c.length;l++){if(null==re(E,c[l],0,n,o,i))return _t[t]=null,s}if(_&&-1==Z(e,E,"GROUP_OUTPUT","group"))return s;var T=xe(E),u=_?e.links:e.links.slice();if(!ye(E,u,T))return s;if(_)return s.graph=E,s;for(var l=0;l<u.length;l++)for(var f=u[l],P=w(f.from_node,E),A=w(f.to_node,E),p=0;p<P.length;p++)for(var O=0;O<A.length;O++){var v=P[p],m=A[O],N=Je.get_node_attr(E,v),L=Je.get_node_attr(E,m);if(!be(E,v,m,N,L,f))return _t[t]=null,s}U(E);var x=!1,D=-1;"GLOW"==n?D=Z(e,E,"B4W_GLOW_OUTPUT","material",!0):(D=Z(e,E,"OUTPUT","material",!1,!0),-1==D&&(D=Z(e,E,"OUTPUT_MATERIAL","material",!1,!0)),-1==D&&(D=Z(e,E,"OUTPUT_WORLD","material",!1,!0),x=!0)),-1==D&&(E=Y(),D=0),C(E);var F=Je.subgraph_node_conn(E,D,Je.BACKWARD_DIR);x?(g(F,n),R(F,n),I(F),b(F)):(a(F,n,i),S(F,n,i)),M(F),G(F),V(F),y(F,n),je(F)}else{var k=r(e,t,_,"MAIN",o,i),K=function(e){var t=d.N(e);return t.inputs=d.O(e.inputs),t.outputs=d.O(e.outputs),t},B=Je.clone(k.graph,K),D=Z(e,B,"OUTPUT","material",!1,!0);-1==D&&(D=Z(e,B,"OUTPUT_MATERIAL","material",!1,!0)),h(B,D);var F=Je.subgraph_node_conn(B,D,Je.BACKWARD_DIR);M(F)}return s.graph=F,_t[t]=s,s}function a(e,t,_){var r=[];Je.traverse(e,function(e,t){if("MATERIAL"==t.type||"MATERIAL_EXT"==t.type){var _={node_id:e,node:t};r.push(_)}});for(var a=0;a<r.length;++a){var n=r[a].node_id,o=r[a].node,i=Je.gen_node_id(e);Je.append_node(e,i,o.data.material_begin);var s=Je.gen_node_id(e);Je.append_node(e,s,o.data.material_end),Je.append_edge(e,i,s,[4,2]);for(var E={5:["LIGHTING_APPLY",10],6:["LIGHTING_APPLY",6],7:["MATERIAL_END",3],8:["MATERIAL_END",4],9:["MATERIAL_END",5]},c=Je.in_edge_count(e,n),l=[],T=[],d=[],u={},f=0;f<c;f++){var A=Je.get_in_edge(e,n,f);A in u||(u[A]=0);var S=Je.get_edge_attr(e,A,n,u[A]++);l.push([A,n,S]);var p=E[S[1]];if(p)switch(p[0]){case"MATERIAL_END":T.push([A,s,[S[0],p[1]]]);break;case"LIGHTING_APPLY":d.push([A,[S[0],p[1]]])}else T.push([A,i,S])}P(e,o.data.value,i,s,d,_);for(var f=0;f<l.length;f++)Je.remove_edge_by_attr(e,l[f][0],l[f][1],l[f][2]);for(var f=0;f<T.length;f++)Je.append_edge(e,T[f][0],T[f][1],T[f][2]);for(var O=Je.out_edge_count(e,n),v=[],m=[],N={},f=0;f<O;f++){var g=Je.get_out_edge(e,n,f);g in N||(N[g]=0);var S=Je.get_edge_attr(e,n,g,N[g]++);v.push([n,g,S]),m.push([s,g,S])}for(var f=0;f<v.length;f++)Je.remove_edge_by_attr(e,v[f][0],v[f][1],v[f][2]);for(var f=0;f<m.length;f++)Je.append_edge(e,m[f][0],m[f][1],m[f][2]);Je.remove_node(e,n)}}function P(e,t,_,r,a,n){var o={name:"LIGHTING_AMBIENT",type:"LIGHTING_AMBIENT"},i=re(e,o,0,null,null,[]),s=i;if(A(e,_,i,"E"),A(e,_,i,"A"),A(e,_,i,"D"),!t.use_shadeless)for(var E,c,l,T,d=0;d<n.length;d++){var u=n[d];o={name:"LIGHTING_LAMP",type:"LIGHTING_LAMP"},E=re(e,o,0,null,null,[]),o={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"},c=re(e,o,0,null,null,[]),A(e,s,c,"color"),A(e,s,c,"specular"),A(e,E,c,"ldir"),A(e,_,c,"normal"),A(e,_,c,"D"),A(e,_,c,"S"),A(e,E,c,"lcolorint"),A(e,_,E,"shadow_factor");var f="SPECULAR_"+t.specular_shader;if(o={name:f,type:f,use_tangent_shading:t.use_tangent_shading},l=re(e,o,0,null,null,[]),A(e,E,l,"ldir"),A(e,E,l,"lfac"),A(e,_,l,"normal"),A(e,l,c,"sfactor"),A(e,E,l,"norm_fac"),A(e,_,l,"sp_params"),"HEMI"==u.type)var P="DIFFUSE_LAMBERT";else var P="DIFFUSE_"+t.diffuse_shader;o={name:P,type:P,use_tangent_shading:t.use_tangent_shading},T=re(e,o,0,null,null,[]),A(e,E,T,"ldir"),A(e,E,T,"lfac"),A(e,_,T,"normal"),A(e,E,T,"norm_fac"),A(e,T,c,"lfactor"),"DIFFUSE_LAMBERT"!=P&&A(e,_,T,"dif_params");for(var S=0;S<a.length;S++){var p=a[S][0],O=a[S][1];Je.append_edge(e,p,c,O)}s=c}A(e,s,r,"color"),A(e,s,r,"specular")}function A(e,t,_,r){for(var a=Je.get_node_attr(e,t),n=Je.get_node_attr(e,_),o=-1,i=n.inputs,s=0;s<i.length;s++){if(r==i[s].identifier){o=s;break}}if(-1!=o){for(var E=-1,c=a.outputs,s=0;s<c.length;s++){if(r==c[s].identifier){E=s;break}}-1!=E&&(Je.append_edge(e,t,_,[E,o]),c[E].is_linked=!0,i[o].is_linked=!0)}}function S(e,t,_){var r=[];Je.traverse(e,function(e,t){if("OUTPUT_MATERIAL"==t.type){var _={node_id:e,node:t};r.push(_)}});for(var a=0;a<r.length;++a){var n=r[a].node_id,o=r[a].node,i=!1,s=!1,E=Je.gen_node_id(e);Je.append_node(e,E,o.data.output_surface);for(var c=Je.in_edge_count(e,n),l=[],T=[],d={},u=0;u<c;u++){var f=Je.get_in_edge(e,n,u);f in d||(d[f]=0);var P=Je.get_edge_attr(e,f,n,d[f]++);switch(l.push([f,n,P]),P[1]){case ht:i=!0,T.push([f,E,P]);break;case Yt:s=!0;var A=Je.gen_node_id(e);Je.append_node(e,A,o.data.displacement_bump),T.push([f,A,[P[0],0]])}}for(var u=0;u<l.length;u++)Je.remove_edge_by_attr(e,l[u][0],l[u][1],l[u][2]);for(var u=0;u<T.length;u++)Je.append_edge(e,T[u][0],T[u][1],T[u][2]);if(Je.remove_node(e,n),i)s&&p(e,E,A),m(e,t,_);else{var S=Je.get_node_attr(e,E);e.nodes=[0,S],e.edges=[]}}}function p(e,t,_){var r=Je.subgraph_node_conn(e,t,Je.BACKWARD_DIR),a=v(r);if(a.length){var n=Je.subgraph_node_conn(e,_,Je.BACKWARD_DIR),o=L(n);Je.traverse(o,function(e,t){var _="displacement%join%"+t.name;t.name=_}),Je.append_subgraph(o,r,[],[]);var i=-1;Je.traverse(r,function(e,t){if("DISPLACEMENT_BUMP"==t.type)return i=e,1});for(var s=0;s<a.length;s++){var E=a[s],c=Je.get_node_attr(r,E);A(r,i,E,"Normal"),O(c,"USE_NORMAL_IN",1)}}e.nodes=r.nodes,e.edges=r.edges}function O(e,t,_){for(var r=e.dirs,a=0;a<r.length;a++){var n=r[a];n[0]==t&&(n[1]=_)}}function v(e){var t=[];return Je.traverse(e,function(e,_){for(var r=!1,a=_.inputs,n=0;n<a.length;n++)if("Normal"==a[n].identifier){r=!a[n].is_linked;break}r&&t.push(e)}),t}function m(e,t,_){var r=[];Je.traverse(e,function(e,t){if("OUTPUT_SURFACE"==t.type){var _={node_id:e,node:t};r.push(_)}});var a=[];r.length&&Je.traverse(e,function(e,t){if("MIX_SHADER"==t.type){var _={node_id:e,node:t};a.push(_)}});for(var n=0;n<r.length;++n){var o=r[n].node_id,i=r[n].node,s=Je.gen_node_id(e);Je.append_node(e,s,i.data.bsdf_begin);var E=Je.gen_node_id(e);Je.append_node(e,E,i.data.bsdf_end),Je.append_edge(e,s,E,[4,2]);for(var c=Je.in_edge_count(e,o),l=[],T=[],d=[],u={},f=0;f<c;f++){var P=Je.get_in_edge(e,o,f),A=Je.get_node_attr(e,P);P in u||(u[P]=0);var S=Je.get_edge_attr(e,P,o,u[P]++);if(l.push([P,o,S]),T.push([P,s,S]),"BSDF_GLOSSY"==A.type||"BSDF_DIFFUSE"==A.type||"MIX_SHADER"==A.type||"EMISSION"==A.type||"BSDF_TRANSPARENT"==A.type||"BSDF_PRINCIPLED"==A.type){T.push([P,s,[1,1]]),T.push([P,s,[2,2]]),T.push([P,s,[3,3]]),T.push([P,s,[4,4]]),T.push([P,s,[5,5]]),T.push([P,s,[6,6]]),T.push([P,s,[7,7]]),T.push([P,s,[8,8]]),T.push([P,s,[9,9]]),T.push([P,s,[10,10]]);for(var p=0;p<a.length;++p)for(var O=a[p].node_id,v=Je.in_edge_count(e,O),m=0;m<v;m++){var g=Je.get_in_edge(e,O,m),R=Je.get_node_attr(e,g),I=Je.get_edge_attr(e,g,O,0);if(0!=I[1]&&("BSDF_GLOSSY"==R.type||"BSDF_DIFFUSE"==R.type||"MIX_SHADER"==R.type||"EMISSION"==R.type||"BSDF_TRANSPARENT"==R.type||"BSDF_PRINCIPLED"==R.type)){var b=1==I[1]?3:13;T.push([g,O,[1,b]]),T.push([g,O,[2,b+1]]),T.push([g,O,[3,b+2]]),T.push([g,O,[4,b+3]]),T.push([g,O,[5,b+4]]),T.push([g,O,[6,b+5]]),T.push([g,O,[7,b+6]]),T.push([g,O,[8,b+7]]),T.push([g,O,[9,b+8]]),T.push([g,O,[10,b+9]])}}}}N(e,i.data.value,s,E,d,_),T.push([E,o,[0,0]]),T.push([E,o,[1,1]]);for(var f=0;f<l.length;f++)Je.remove_edge_by_attr(e,l[f][0],l[f][1],l[f][2]);for(var f=0;f<T.length;f++)Je.append_edge(e,T[f][0],T[f][1],T[f][2])}}function N(e,t,_,r,a,n){var o={name:"LIGHTING_AMBIENT",type:"LIGHTING_AMBIENT"},i=re(e,o,0,null,null,[]),s=i;A(e,_,i,"E"),A(e,_,i,"A"),A(e,_,i,"D");for(var E,c,l,T=0;T<n.length;T++){o={name:"LIGHTING_LAMP",type:"LIGHTING_LAMP"},E=re(e,o,0,null,null,[]),o={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"},c=re(e,o,0,null,null,[]),A(e,s,c,"color"),A(e,s,c,"specular"),A(e,E,c,"ldir"),A(e,_,c,"normal"),A(e,_,c,"D"),A(e,_,c,"S"),A(e,E,c,"lcolorint"),A(e,_,E,"shadow_factor");var d=t.bsdf_shader;o={name:d,type:d},l=re(e,o,0,null,null,[]),A(e,E,l,"ldir"),A(e,E,l,"lfac"),A(e,_,l,"normal"),A(e,E,l,"norm_fac"),A(e,_,l,"bsdf_params"),A(e,l,c,"lfactor"),A(e,l,c,"sfactor");for(var u=0;u<a.length;u++){var f=a[u][0],P=a[u][1];Je.append_edge(e,f,c,P)}s=c}A(e,_,r,"bsdf_params"),A(e,_,r,"d_color"),A(e,_,r,"s_color"),A(e,_,r,"e_color"),A(e,_,r,"emission"),A(e,_,r,"a_color"),A(e,_,r,"alpha"),A(e,s,r,"color"),A(e,s,r,"specular")}function g(e,t){var _=[];Je.traverse(e,function(e,t){if("OUTPUT_WORLD"==t.type){var r={node_id:e,node:t};_.push(r)}});for(var r=0;r<_.length;++r){var a=_[r].node_id,n=_[r].node,o=Je.gen_node_id(e);Je.append_node(e,o,n.data.output_world_surface);for(var i=Je.in_edge_count(e,a),s=[],E=[],c={},l=0;l<i;l++){var T=Je.get_in_edge(e,a,l);T in c||(c[T]=0);var d=Je.get_edge_attr(e,T,a,c[T]++);switch(s.push([T,a,d]),d[1]){case ht:E.push([T,o,d])}}for(var l=0;l<s.length;l++)Je.remove_edge_by_attr(e,s[l][0],s[l][1],s[l][2]);for(var l=0;l<E.length;l++)Je.append_edge(e,E[l][0],E[l][1],E[l][2]);Je.remove_node(e,a)}}function R(e,t){var _=[];if(Je.traverse(e,function(e,t){if("MIX_SHADER"==t.type||"ADD_SHADER"==t.type){var r={node_id:e,node:t};_.push(r)}}),_.length)for(var r={name:"RGB_WORLD_NODE",type:"RGB_WORLD_NODE",factor:.5},a=0;a<_.length;a++){var n=_[a].node_id,o=_[a].node;switch(r.name=o.name,r.fac=o.inputs[0].default_value,r.fac_is_linked=o.inputs[0].is_linked,r.color1_is_linked=o.inputs[1].is_linked,r.color2_is_linked=o.inputs[2].is_linked,o.type){case"ADD_SHADER":r.type="ADD_WORLD_RGB";break;case"MIX_SHADER":r.type="MIX_WORLD_RGB"}for(var i=re(e,r,0,t,null,[]),s=Je.in_edge_count(e,n),E=[],c=[],l={},T=0;T<s;T++){var d=Je.get_in_edge(e,n,T);d in l||(l[d]=0);var u=Je.get_edge_attr(e,d,n,l[d]++);E.push([d,n,u]),c.push([d,i,u])}for(var T=0;T<E.length;T++)Je.remove_edge_by_attr(e,E[T][0],E[T][1],E[T][2]);for(var T=0;T<c.length;T++)Je.append_edge(e,c[T][0],c[T][1],c[T][2]);for(var f=Je.out_edge_count(e,n),P=[],A=[],S={},T=0;T<f;T++){var p=Je.get_out_edge(e,n,T);p in S||(S[p]=0);var u=Je.get_edge_attr(e,n,p,S[p]++);P.push([n,p,u]),A.push([i,p,u])}for(var T=0;T<P.length;T++)Je.remove_edge_by_attr(e,P[T][0],P[T][1],P[T][2]);for(var T=0;T<A.length;T++)Je.append_edge(e,A[T][0],A[T][1],A[T][2]);Je.remove_node(e,n)}}function I(e){var t=-1,_=[],r=[],a=["OUTPUT_WORLD_SURFACE","BACKGROUND","RGB","VALUE","ADD_WORLD_RGB","MIX_WORLD_RGB","TEXTURE_ENVIRONMENT_EQUIRECTANGULAR","TEXTURE_ENVIRONMENT_MIRROR_BALL","GEOMETRY_NO","GEOMETRY_TRN","GEOMETRY_GL","GEOMETRY_IN","TEXTURE_COLOR","TEX_COORD_GE","TEX_COORD_OB","TEX_COORD_NO","COMBRGB","COMBHSV","CURVE_RGB","CURVE_VEC","B4W_LINEAR_TO_SRGB","B4W_NORMAL_VIEW","B4W_VECTOR_VIEW","B4W_SRGB_TO_LINEAR","B4W_REFLECT","B4W_CLAMP","B4W_TIME","B4W_SMOOTHSTEP","NORMAL","MAPPING","MATH_ADD","MATH_SUBTRACT","MATH_MULTIPLY","MATH_DIVIDE","MATH_SINE","MATH_COSINE","MATH_TANGENT","MATH_ARCSINE","MATH_ARCCOSINE","MATH_ARCTANGENT","MATH_POWER","MATH_LOGARITHM","MATH_MINIMUM","MATH_MAXIMUM","MATH_ROUND","MATH_LESS_THAN","MATH_GREATER_THAN","MATH_MODULO","MATH_ABSOLUTE","MIX_RGB_MIX","MIX_RGB_ADD","MIX_RGB_MULTIPLY","MIX_RGB_SUBTRACT","MIX_RGB_SCREEN","MIX_RGB_DIVIDE","MIX_RGB_DIFFERENCE","MIX_RGB_DARKEN","MIX_RGB_LIGHTEN","MIX_RGB_OVERLAY","MIX_RGB_DODGE","MIX_RGB_BURN","MIX_RGB_HUE","MIX_RGB_SATURATION","MIX_RGB_VALUE","MIX_RGB_COLOR","MIX_RGB_SOFT_LIGHT","MIX_RGB_LINEAR_LIGHT","SEPRGB","SEPHSV","VALTORGB","VECT_TRANSFORM","VECT_MATH_ADD","VECT_MATH_SUBTRACT","VECT_MATH_AVERAGE","VECT_MATH_DOT_PRODUCT","VECT_MATH_CROSS_PRODUCT","VECT_MATH_NORMALIZE"];Je.traverse(e,function(e,r){var n=r.type;switch(a.indexOf(n)){case-1:var o={node_id:e,node:r};_.push(o);break;case 0:t=e}});for(var n=0;n<_.length;n++)for(var o=_[n].node_id,i=Je.out_edge_count(e,o),s={},E=0;E<i;E++){var c=Je.get_out_edge(e,o,E);c in s||(s[c]=0);var l=Je.get_edge_attr(e,o,c,s[c]++);r.push([o,c,l])}for(var n=0;n<r.length;n++)Je.remove_edge_by_attr(e,r[n][0],r[n][1],r[n][2]);if(r.length){var T=Je.subgraph_node_conn(e,t,Je.BACKWARD_DIR);e.nodes=T.nodes,e.edges=T.edges}}function b(e){var t=-1,_=[],r=[];Je.traverse(e,function(e,r){switch(r.type){case"ADD_WORLD_RGB":case"MIX_WORLD_RGB":var a={node_id:e,node:r};_.push(a);break;case"OUTPUT_WORLD_SURFACE":t=e;var a={node_id:e,node:r};_.push(a)}});for(var a=0;a<_.length;a++)for(var n=_[a].node_id,o=_[a].node,i=Je.in_edge_count(e,n),s={},E=0;E<i;E++){var c=Je.get_in_edge(e,n,E),l=Je.get_node_attr(e,c);c in s||(s[c]=0);var T=Je.get_edge_attr(e,c,n,s[c]++);"OUTPUT_WORLD_SURFACE"!=o.type&&0==T[1]||"ADD_WORLD_RGB"==l.type||"MIX_WORLD_RGB"==l.type||"BACKGROUND"==l.type||r.push([c,n,T])}for(var a=0;a<r.length;a++)Je.remove_edge_by_attr(e,r[a][0],r[a][1],r[a][2]);if(r.length){var d=Je.subgraph_node_conn(e,t,Je.BACKWARD_DIR);e.nodes=d.nodes,e.edges=d.edges}}function h(e,t){Je.traverse_edges(e,function(_,r,a){var n=Je.get_node_attr(e,r);r==t&&"Color"==n.inputs[a[1]].identifier&&Je.remove_edge_by_attr(e,_,r,a)})}function Y(){var e=Je.create(),t={default_value:new Float32Array([0,0,0]),identifier:"Color",is_linked:!1,name:"Color"},_={default_value:1,identifier:"Alpha",is_linked:!1,name:"Alpha"},r={data:null,dirs:[],params:[],inputs:[t,_],outputs:[],type:"OUTPUT",vparams:[]};return Je.append_node(e,0,r),e}function L(e){return Je.clone(e,_e,Ie)}function M(e){Je.traverse(e,function(t,_){for(var r=_.inputs,a=_.outputs,n=0;n<r.length;n++)x(e,r[n],t,n,1);for(var n=0;n<a.length;n++)x(e,a[n],t,n,0)})}function x(e,t,_,r,a){if(t.is_linked){var n=!0;Je.traverse_edges(e,function(e,t,o){(!a&&e==_&&o[0]==r||a&&t==_&&o[1]==r)&&(n=!1)}),n&&(t.is_linked=!1)}}function y(e,t){var _=[];Je.traverse_edges(e,function(r,a,n){var o=Je.get_node_attr(e,r),i=Je.get_node_attr(e,a),s=d._15(o.outputs[n[0]].default_value),E=d._15(i.inputs[n[1]].default_value);if(s!=E){var c,l={default_value:[0,0,0],identifier:"Vector",is_linked:!0,name:"Vector"},T={default_value:0,identifier:"Value",is_linked:!0,name:"Value"};s&&!E?c=$("vector_to_scalar","B4W_VECTOSCAL",[l],[T]):!s&&E&&(c=$("scalar_to_vector","B4W_SCALTOVEC",[T],[l])),re(e,c,0,t,null,[]),_.push([r,a,e.nodes[e.nodes.length-2],n])}});for(var r=0;r<_.length;++r)Je.remove_edge_by_attr(e,_[r][0],_[r][1],_[r][3]),Je.append_edge(e,_[r][0],_[r][2],[_[r][3][0],0]),Je.append_edge(e,_[r][2],_[r][1],[0,_[r][3][1]])}function U(e){var t=[];Je.traverse(e,function(_,r){switch(r.type){case"B4W_TRANSLUCENCY":Je.traverse_edges(e,function(a,n,o){var i=Je.get_node_attr(e,n);if(a==_&&"MATERIAL_EXT"==i.type){var s=o[0];"Translucency"==r.outputs[s].name&&t.push(a,n,[o[0]+1,o[1]+1])}})}});for(var _=0;_<t.length;_+=3)Je.append_edge(e,t[_],t[_+1],t[_+2])}function w(e,t){var _=[];if(Je.traverse(t,function(t,r){r.name==e.name&&_.push(t)}),_.length)return _;Ve.panic("Node not found")}function C(e){var t=[];Je.traverse(e,function(e,_){"B4W_PARALLAX"!=_.type&&"REROUTE"!=_.type||t.push(e,_)});for(var _=0;_<t.length;_+=2){var r=t[_],a=t[_+1];if("B4W_PARALLAX"==a.type)D(e,r,a);else if("REROUTE"==a.type){for(var n=Je.get_in_edge(e,r,0),o=Je.out_edge_count(e,r),i=[],s=[],E=[],c=0;c<o;c++){var l=Je.get_out_edge(e,r,c),T=s.indexOf(l),d=T>=0?E[T]:0,u=Je.get_edge_attr(e,r,l,d);if(u){var f=u[1],P=a.inputs[0].default_value,A=Je.get_node_attr(e,l),S=A.inputs[f];switch(typeof P){case"number":if("object"==typeof S.default_value)for(var p=S.default_value,O=0;O<p.length;O++)p[O]=P;else"number"==typeof S.default_value&&(S.default_value=P);break;case"object":if("object"==typeof S.default_value)for(var p=S.default_value,O=0;O<p.length;O++)p[O]=P[O];else"number"==typeof S.default_value&&(S.default_value=.35*P[0]+.45*P[1]+.2*P[2])}}for(var v=a.outputs,O=0;O<v.length;O++)v[O].default_value=a.inputs[0].default_value;-1!=T?E[T]+=1:(s.push(l),E.push(1),i.push(r,l))}if(-1!=n)for(var m=Je.get_edge_attr(e,n,r,0)[0],c=0;c<s.length;c++)for(var O=0;O<E[c];O++){var N=Je.get_edge_attr(e,r,s[c],O)[1];Je.append_edge(e,n,s[c],[m,N])}for(var c=0;c<i.length;c+=2)Je.remove_edge(e,i[c],i[c+1],-1)}}}function D(e,t,_){var r=F(e,t,1);if(-1!=r){var a=Je.get_node_attr(e,r);if(_.data=a.data,Je.remove_edge(e,r,t,-1),0==Je.out_edge_count(e,r)){var n=Je.get_in_edge(e,r,0);-1!=n&&Je.remove_edge(e,n,r,-1),Je.remove_node(e,r)}}_.inputs.splice(1,1)}function F(e,t,_){for(var r=e.edges,a=0;a<r.length;a+=3)if(r[a+1]==t){var n=r[a+2][1];if(n==_)return r[a]}return-1}function G(e){B(e),j(e),k(e)}function k(e,t){var _={};Je.traverse(e,function(e,t){if("GEOMETRY_UV"==t.type||"UVMAP"==t.type||"TEX_COORD_UV"==t.type){var r=t.data.value;r in _||(_[r]=[]),_[r].push(e,t)}});for(var r in _){var a=_[r];if(a.length>2)for(var n=K(r),o=re(e,n,0,t,null,[]),i=Je.get_node_attr(e,o),s=0;s<a.length;s+=2){for(var E=a[s],c=a[s+1],l=[],T={},d=Je.out_edge_count(e,E),u=0;u<d;u++){var f=Je.get_out_edge(e,E,u);f in T||(T[f]=0);var P=Je.get_edge_attr(e,E,f,T[f]);T[f]++,l.push(E,f,P);var A=P.splice(0,P.length);switch(c.type){case"GEOMETRY_UV":A[0]=0,i.outputs[0].is_linked=!0;break;case"UVMAP":case"TEX_COORD_UV":A[0]=1,i.outputs[1].is_linked=!0}Je.append_edge(e,o,f,A)}for(var u=0;u<l.length;u+=3)Je.remove_edge(e,l[u],l[u+1],0);Je.remove_node(e,E)}}}function K(e){var t={default_value:[0,0,0],identifier:"UV_geom",is_linked:!1,name:"UV_geom"},_={default_value:[0,0,0],identifier:"UV_cycles",is_linked:!1,name:"UV_cycles"},r=$("merged_uv","UV_MERGED",[],[t,_]);return r.uv_layer=e,r}function B(e){var t=[];Je.traverse(e,function(e,_){"GEOMETRY_VC"!=_.type&&"GEOMETRY_NO"!=_.type&&"GEOMETRY_FB"!=_.type&&"GEOMETRY_VW"!=_.type&&"GEOMETRY_GL"!=_.type&&"GEOMETRY_LO"!=_.type&&"GEOMETRY_OR"!=_.type&&"GEOMETRY_BF"!=_.type&&"GEOMETRY_IN"!=_.type||t.push(e,_)});for(var _=[],r=0;r<t.length;r+=2){for(var a=t[r],n=t[r+1],o=!0,i=0;i<_.length;i++){var s=_[i];if(Q(n,s.attr)){for(var E=[],c=Je.out_edge_count(e,a),l=0;l<c;l++){var T=Je.get_out_edge(e,a,l),d=Je.get_edge_attr(e,a,T,0);E.push(a,T,d),Je.append_edge(e,s.id,T,d)}for(var l=0;l<E.length;l+=3)Je.remove_edge(e,E[l],E[l+1],0);Je.remove_node(e,a),o=!1;break}}if(o){var s={id:a,attr:n};_.push(s)}}}function X(e){for(var t={},_=0;_<e.nodes.length;_+=2){var r=e.nodes[_];t[r]={ascs_ids:{},is_completed:!1}}for(var _=0;_<e.edges.length;_+=3){var a=e.edges[_];t[e.edges[_+1]].ascs_ids[a]=!0}for(var r in t)H(r,t);for(var r in t)t[r]=Object.keys(t[r].ascs_ids).map(function(e){return parseInt(e,10)});return t}function H(e,t){var _=t[e];if(!_.is_completed){var r=d.O(_);for(var a in _.ascs_ids){H(a,t);var n=t[a];for(var o in n.ascs_ids)r.ascs_ids[o]=!0}r.is_completed=!0,t[e]=r}}function j(e){var t=[];if(Je.traverse(e,function(e,_){"TEXTURE_COLOR"!=_.type&&"TEXTURE_NORMAL"!=_.type||t.push(e,_)}),t.length){for(var _=X(e),r=[],a=0;a<t.length;a+=2){for(var n=t[a],o=t[a+1],i=!0,s=0;s<r.length;s++){var E=r[s];if(!(E.merged_nodes.length>=3)&&(Q(o,E.attr)&&!(_[n].indexOf(E.id)>-1||_[E.id].indexOf(n)>-1))){for(var c=!1,l=0;l<E.merged_nodes.length;l++){var T=E.merged_nodes[l].id;if(_[n].indexOf(T)>-1||_[T].indexOf(n)>-1){c=!0;break}}if(!c){var d=[],u=Je.in_edge_count(e,n),f={};for(l=0;l<u;l++){var P=Je.get_in_edge(e,n,l);P in f||(f[P]=0);var A=Je.get_edge_attr(e,P,n,f[P]++);d.push(P,n,A)}var S=[],p=Je.out_edge_count(e,n),O={};for(l=0;l<p;l++){var v=Je.get_out_edge(e,n,l);v in O||(O[v]=0);var A=Je.get_edge_attr(e,n,v,O[v]++);S.push(n,v,A)}for(var m=d.concat(S),l=0;l<m.length;l+=3)Je.remove_edge(e,m[l],m[l+1],0);Je.remove_node(e,n);var N={id:n,attr:o,edges_in:d,edges_out:S};E.merged_nodes.push(N),i=!1;break}}}if(i){var E={id:n,attr:o,merged_nodes:[]};r.push(E)}}for(var a=0;a<r.length;a++){for(var E=r[a],g=E.merged_nodes.length,s=0;s<g;s++){var R=E.merged_nodes[s],N=R.attr,I=R.edges_in,b=R.edges_out;E.attr.inputs[s+1].is_linked=N.inputs[0].is_linked,E.attr.inputs[s+1].default_value=N.inputs[0].default_value,E.attr.outputs[2*(s+1)].is_linked=N.outputs[0].is_linked,E.attr.outputs[2*(s+1)].default_value=N.outputs[0].default_value,E.attr.outputs[2*(s+1)+1].is_linked=N.outputs[1].is_linked,E.attr.outputs[2*(s+1)+1].default_value=N.outputs[1].default_value;for(var l=0;l<I.length;l+=3){var P=I[l],A=I[l+2];A[1]+=s+1,Je.append_edge(e,P,E.id,A)}for(var l=0;l<b.length;l+=3){var v=b[l+1],A=b[l+2];A[0]+=2*(s+1),Je.append_edge(e,E.id,v,A)}E.attr.dirs.push(["USE_uv"+(s+2),1])}Je.remove_node(e,E.id),Je.append_node(e,E.id,E.attr)}}}function Q(e,t){if(e.type!==t.type)return!1;switch(e.type){case"GEOMETRY_VC":return e.data.value==t.data.value;case"GEOMETRY_NO":return z(e,t,"USE_NORMAL_IN");case"GEOMETRY_FB":case"GEOMETRY_VW":case"GEOMETRY_GL":case"GEOMETRY_LO":case"GEOMETRY_OR":case"GEOMETRY_BF":case"GEOMETRY_IN":return!0;case"TEXTURE_COLOR":case"TEXTURE_NORMAL":return e.data.bpy_uuid==t.data.bpy_uuid&&e.data.value.img_uuid==t.data.value.img_uuid;case"VALUE":case"RGB":return e.origin_name==t.origin_name;default:return!1}}function z(e,t,_){for(var r=e.dirs,a=-1,n=0;n<r.length;n++){var o=r[n];if(o[0]==_){a=o[1];break}}for(var i=t.dirs,s=-1,n=0;n<i.length;n++){var E=i[n];if(E[0]==_){s=E[1];break}}return a===s}function V(e){var t=[],_=[];Je.traverse(e,function(e,r){"GEOMETRY_VC"==r.type&&t.push(e,r),"GEOMETRY_VW"==r.type&&_.push(e,r)}),q(e,t),W(e,_)}function q(e,t){for(var _=0;_<t.length;_+=2){for(var r=t[_],a=t[_+1],n=!1,o=[],i=[],s=[[],[],[]],E=Je.out_edge_count(e,r),c=0;c<E;c++){var l=Je.get_out_edge(e,r,c);if("SEPRGB"!=Je.get_node_attr(e,l).type){n=!1;break}o.push(r,l);for(var T={},u=Je.out_edge_count(e,l),f=0;f<u;f++){var P=Je.get_out_edge(e,l,f);P in T||(T[P]=0);var A=Je.get_edge_attr(e,l,P,T[P]++);o.push(l,P),s[A[0]].push(r,P,A)}i.push(l),n=!0}if(n){for(var S=0,p=0,c=0;c<s.length;c++)s[c].length&&(S++,p|=1<<2-c);if(S){a.type+=S,a.outputs=[];for(var c=0;c<s.length;c++)if(s[c].length){a.outputs.push({default_value:0,identifier:"RGB"[c],is_linked:!0,name:"RGB"[c]});for(var f=0;f<s[c].length;f+=3)s[c][f+2][0]=d._41(p,c)}for(var c=0;c<o.length;c+=2)Je.remove_edge(e,o[c],o[c+1],0);for(var c=0;c<i.length;c++)Je.remove_node(e,i[c]);for(var c=0;c<s.length;c++)for(var f=0;f<s[c].length;f+=3)Je.append_edge(e,s[c][f],s[c][f+1],s[c][f+2])}}}}function W(e,t){for(var _=0;_<t.length;_+=2){for(var r=t[_],a=!0,n=[],o=Je.out_edge_count(e,r),i=0;i<o;i++){var s=Je.get_out_edge(e,r,i);if("B4W_REFLECT"==Je.get_node_attr(e,s).type){var E=Je.get_edge_attr(e,r,s,0),c=Je.get_edge_attr(e,r,s,1);E&&1==E[1]||c&&1==c[1]?a=!1:n.push(r,s)}else a=!1}for(var i=0;i<n.length;i+=2)J(e,n[i],n[i+1]);a&&Je.remove_node(e,r)}}function J(e,t,_){var r=Je.get_node_attr(e,_);r.type+="_WORLD",Je.remove_edge(e,t,_,0),r.inputs.splice(0,1);var a=Je.get_in_edge(e,_,0);if(a!=Je.NULL_NODE){Je.get_edge_attr(e,a,_,0)[1]=0}}function Z(e,t,_,r,a,n){for(var o=e.nodes,i=null,s=0;s<o.length;s++){var E=o[s];a?"GROUP"==E.type&&E.node_tree_name==_&&(i=E):E.type==_&&(i=E)}return i?w(i,t)[0]:(n||Ze.error('No "'+_+'" node in node '+r),-1)}function $(e,t,_,r){return{name:e,type:t,inputs:_,outputs:r}}function ee(e,t,_,r){return{from_node:e,from_socket:t,to_node:_,to_socket:r}}function te(){return{name:"",origin_name:"",type:"",vparams:[],inputs:[],outputs:[],params:[],data:null,dirs:[]}}function _e(e){var t=te();t.name=e.name,t.origin_name=e.origin_name,t.type=e.type;for(var _=t.vparams,r=e.vparams,a=0;a<r.length;a++){var n=r[a];_.push(ge(n))}for(var o=t.params,i=e.params,a=0;a<i.length;a++){var s=i[a];o.push(ge(s))}for(var E=t.inputs,c=e.inputs,a=0;a<c.length;a++){var l=c[a];E.push(pe(l))}for(var T=t.outputs,d=e.outputs,a=0;a<d.length;a++){var u=d[a];T.push(pe(u))}for(var f=t.dirs,P=e.dirs,a=0;a<P.length;a++){var A=P[a];f.push(A.slice())}return t.data=e.data,t}function re(e,t,_,r,a,n){var o=t.name,i=t.name,s=t.type,l=[],T=[],f=[],P=[],A=null,S="uv_layer"in t?t.uv_layer||a&&a.uv_name||"":"",p="color_layer"in t?t.color_layer||a&&a.vc_name||"":"",O=[];switch(s){case"BSDF_ANISOTROPIC":case"BSDF_GLASS":case"BSDF_HAIR":case"BSDF_TRANSLUCENT":case"BSDF_REFRACTION":case"BSDF_TOON":case"BSDF_VELVET":case"SUBSURFACE_SCATTERING":case"AMBIENT_OCCLUSION":case"VOLUME_ABSORPTION":case"VOLUME_SCATTER":case"BLACKBODY":case"WAVELENGTH":case"SEPXYZ":case"COMBXYZ":case"LIGHT_FALLOFF":case"TEX_SKY":case"TEX_NOISE":case"TEX_WAVE":case"TEX_MUSGRAVE":case"TEX_GRADIENT":case"TEX_MAGIC":case"TEX_CHECKER":case"TEX_BRICK":case"WIREFRAME":case"TANGENT":case"LIGHT_PATH":case"HOLDOUT":case"HAIR_INFO":case"SCRIPT":T=ve(t),f=me(t),Ze.warn(s+" node is not fully supported.");break;case"BRIGHTCONTRAST":case"ADD_SHADER":T=ve(t),f=me(t);break;case"MIX_SHADER":T.push(fe(t,"Fac"));var v=fe(t,"Shader"),m=v.is_linked;T.push(v);var N=fe(t,"Shader_001");N||(N=fe(t,"Shader.001"));var g=N.is_linked;T.push(N),T.push(Se("d_color1","d_color1",[0,0,0],m)),T.push(Se("d_roughness1","d_roughness1",0,m)),T.push(Se("s_color1","s_color1",[0,0,0],m)),T.push(Se("s_roughness1","s_roughness1",0,m)),T.push(Se("metalness1","metalness1",0,m)),T.push(Se("normal1","normal1",[0,0,0],m)),T.push(Se("e_color1","e_color1",[0,0,0],m)),T.push(Se("emission1","emission1",0,m)),T.push(Se("a_color1","a_color1",[0,0,0],m)),T.push(Se("alpha1","alpha1",1,m)),T.push(Se("d_color2","d_color2",[0,0,0],g)),T.push(Se("d_roughness2","d_roughness2",0,g)),T.push(Se("s_color2","s_color2",[0,0,0],g)),T.push(Se("s_roughness2","s_roughness2",0,g)),T.push(Se("metalness2","metalness2",0,g)),T.push(Se("normal2","normal2",[0,0,0],g)),T.push(Se("e_color2","e_color2",[0,0,0],g)),T.push(Se("emission2","emission2",0,g)),T.push(Se("a_color2","a_color2",[0,0,0],g)),T.push(Se("alpha2","alpha2",1,g));var R=Pe(t,"Shader"),I=R.is_linked;f=[R,Se("d_color","d_color",[0,0,0],I),Se("d_roughness","d_roughness",0,I),Se("s_color","s_color",[0,0,0],I),Se("s_roughness","s_roughness",0,I),Se("metalness","metalness",0,I),Se("normal","normal",[0,0,0],I),Se("e_color","e_color",[0,0,0],I),Se("emission","emission",0,I),Se("a_color","a_color",[0,0,0],I),Se("alpha","alpha",1,I)];break;case"OBJECT_INFO":T=ve(t),f=[];var b=Pe(t,"Location"),h=Pe(t,"Object Index"),Y=Pe(t,"Material Index"),L=Pe(t,"Random");f.push(b),f.push(h),f.push(Y),f.push(L),O.push(["USE_LOCATION_OUT",0|b.is_linked]),O.push(["USE_OBJ_IND_OUT",0|h.is_linked]),O.push(["USE_MAT_IND_OUT",0|Y.is_linked]),O.push(["USE_RANDOM_OUT",0|L.is_linked]);break;case"UVMAP":if(S||(s="EMPTY_UV"),"EMPTY_UV"!=s){var M=Ee("param_"+s+"_a"),x=Ee("param_"+s+"_v");l.push(Ne(M)),l.push(Ne(x)),P.push(Ne(x)),A={name:M,value:S}}f=me(t);break;case"UV_MERGED":var M=Ee("param_UV_MERGED_a"),x=Ee("param_UV_MERGED_v");l.push(Ne(M)),l.push(Ne(x)),f.push(Pe(t,"UV_geom")),f.push(Pe(t,"UV_cycles")),P.push(Ne(x)),A={name:M,value:S};break;case"CAMERA":T=[],f=me(t);break;case"COMBRGB":case"COMBHSV":T=ve(t),f=me(t);break;case"CURVE_RGB":case"CURVE_VEC":"CURVE_RGB"==s?(ze(t,0,0,1)&&O.push(["READ_R",1]),ze(t,1,0,1)&&O.push(["READ_G",1]),ze(t,2,0,1)&&O.push(["READ_B",1]),ze(t,3,0,1)&&O.push(["READ_A",1])):(ze(t,0,-1,1)&&O.push(["READ_R",1]),ze(t,1,-1,1)&&O.push(["READ_G",1]),ze(t,2,-1,1)&&O.push(["READ_B",1])),T=ve(t),f=me(t),A={value:t};break;case"PARTICLE_INFO":T=ve(t),f=me(t);for(var y=0;y<t.outputs.length;y++){var U=t.outputs[y],w=U.identifier,C=Ne("v_param_PART_INFO_"+w.replace(" ",""));if(U.is_linked)switch(w){case"Size":O.push(["PART_INFO_SIZE",$e.glsl_value(1)]);break;case"Age":O.push(["PART_INFO_AGE",$e.glsl_value(1)]);break;case"Lifetime":O.push(["PART_INFO_LT",$e.glsl_value(1)]);break;case"Location":O.push(["PART_INFO_LOC",$e.glsl_value(1)]);break;case"Index":var D=Ne("a_param_PART_INFO_"+U.identifier.replace(" ",""));A=D,O.push(["PART_INFO_IND",$e.glsl_value(1)]);break;case"Velocity":O.push(["PART_INFO_VEL",$e.glsl_value(1)]);break;case"Angular Velocity":O.push(["PART_INFO_A_VEL",$e.glsl_value(1)])}"Age"!=w&&"Lifetime"!=w&&"Size"!=w&&(l.push(C),P.push(C))}D&&l.push(D);break;case"NEW_GEOMETRY":case"GEOMETRY":if(!ce(t))return!0;if(!(s=le(t,_)))return Ze.error("Geometry output is not supported"),null;switch(s){case"GEOMETRY_UV":if(S||(s="EMPTY_UV"),"EMPTY_UV"!=s){var M=Ee("param_GEOMETRY_UV_a"),x=Ee("param_GEOMETRY_UV_v");l.push(Ne(M)),l.push(Ne(x)),P.push(Ne(x)),A={name:M,value:S}}f.push(Pe(t,"UV"));break;case"GEOMETRY_VC":if(p||(s="EMPTY_VC"),"EMPTY_VC"!=s){var F=Ee("param_GEOMETRY_VC_a"),G=Ee("param_GEOMETRY_VC_v");l.push(Ne(F)),l.push(Ne(G)),P.push(Ne(G)),A={name:F,value:p}}f.push(Pe(t,"Vertex Color"));break;case"GEOMETRY_NO":T.push(Se("Normal","Normal",[0,0,0],!1)),O.push(["USE_NORMAL_IN",0]),f.push(Pe(t,"Normal"));break;case"GEOMETRY_TRN":s="GEOMETRY_NO",T.push(Se("Normal","Normal",[0,0,0],!1)),f.push(Pe(t,"True Normal")),O.push(["USE_NORMAL_IN",0]),Ze.warn("Geometry True Normal output is not fully supported.");break;case"GEOMETRY_FB":f.push(Pe(t,"Front/Back"));break;case"GEOMETRY_VW":f.push(Pe(t,"View"));break;case"GEOMETRY_GL":f.push(Pe(t,"Global")||Pe(t,"Position"));break;case"GEOMETRY_LO":f.push(Pe(t,"Local"));break;case"GEOMETRY_OR":var k=Ee("param_GEOMETRY_OR_v");l.push(Ne(k)),f.push(Pe(t,"Orco")),P.push(Ne(k));break;case"GEOMETRY_IN":f.push(Pe(t,"Incoming"));break;case"GEOMETRY_BF":f.push(Pe(t,"Backfacing"))}break;case"ATTRIBUTE":if(!ce(t))return!0;if("EMPTY_VC"!=(s=p?"GEOMETRY_VC":"EMPTY_VC")){var F=Ee("param_GEOMETRY_VC_a"),G=Ee("param_GEOMETRY_VC_v");l.push(Ne(F)),l.push(Ne(G)),P.push(Ne(G)),A={name:F,value:p}}f.push(Pe(t,"Color"));break;case"TEX_COORD":if(!ce(t))return!0;switch(s=Te(t,_)){case"TEX_COORD_UV":if(S||(s="EMPTY_UV"),"EMPTY_UV"!=s){var M=Ee("param_TEX_COORD_UV_a"),x=Ee("param_TEX_COORD_UV_v");l.push(Ne(M)),l.push(Ne(x)),P.push(Ne(x)),A={name:M,value:S}}f.push(Pe(t,"UV"));break;case"TEX_COORD_NO":f.push(Pe(t,"Normal"));break;case"TEX_COORD_GE":var K=Ee("param_TEX_COORD_GE_v");l.push(Ne(K)),f.push(Pe(t,"Generated")),P.push(Ne(K));break;case"TEX_COORD_OB":f.push(Pe(t,"Object"));break;case"TEX_COORD_CA":f.push(Pe(t,"Camera"));break;case"TEX_COORD_WI":f.push(Pe(t,"Window"));break;case"TEX_COORD_RE":f.push(Pe(t,"Reflection"))}break;case"GROUP":var B=t.node_tree_name;switch(B){case"B4W_LINEAR_TO_SRGB":if(!ae(t,[1],[1])){A=ne(t,r,a,[]);break}s="B4W_LINEAR_TO_SRGB";break;case"B4W_NORMAL_VIEW":case"B4W_VECTOR_VIEW":if(!ae(t,[1],[1])){A=ne(t,r,a,[]);break}s="B4W_VECTOR_VIEW";break;case"B4W_SRGB_TO_LINEAR":if(!ae(t,[1],[1])){A=ne(t,r,a,[]);break}s="B4W_SRGB_TO_LINEAR";break;case"B4W_REFLECT":if(!ae(t,[1,1],[1])){A=ne(t,r,a,[]);break}s="B4W_REFLECT";break;case"B4W_REFRACTION":if(!ae(t,[1,0],[1])){A=ne(t,r,a,[]);break}s="B4W_REFRACTION";break;case"B4W_PARALLAX":if(!ae(t,[1,1,0,0,0],[1])){A=ne(t,r,a,[]);break}var X=Ee("param_B4W_PARALLAX_texture");P.push(Ne(X)),s="B4W_PARALLAX";break;case"B4W_CLAMP":if(!ae(t,[1],[1])){A=ne(t,r,a,[]);break}s="B4W_CLAMP";break;case"B4W_TRANSLUCENCY":if(!ae(t,[0,0,0,0,0],[0])){A=ne(t,r,a,[]);break}s="B4W_TRANSLUCENCY";break;case"B4W_TIME":if(!ae(t,[],[0])){A=ne(t,r,a,[]);break}s="B4W_TIME";break;case"B4W_SMOOTHSTEP":if(!ae(t,[0,0,0],[0])){A=ne(t,r,a,[]);break}s="B4W_SMOOTHSTEP";break;case"B4W_GLOW_OUTPUT":s="B4W_GLOW_OUTPUT";break;default:A=ne(t,r,a,n)}if(T=ve(t),f=me(t),"B4W_TRANSLUCENCY"==B){var H=Se("TranslucencyParams","TranslucencyParams",[0,0,0,0]);H.is_linked=f[0].is_linked,f.push(H)}break;case"LAMP":var j=t.lamp;j?(j.uuid in at?O.push(["LAMP_INDEX",String(at[j.uuid])]):(at[j.uuid]=nt,O.push(["LAMP_INDEX",String(nt++)])),A=at):(Ze.error("There is no lamp in node: "+t.name),O.push(["LAMP_INDEX",-1])),f.push(Pe(t,"Color")),f.push(Pe(t,"Light Vector")),f.push(Pe(t,"Distance")),f.push(Pe(t,"Visibility Factor"));break;case"LIGHTING_AMBIENT":T=[Se("E","E",[0,0,0],!0),Se("A","A",[0,0,0],!0),Se("D","D",[0,0,0],!0)],f=[Se("color","color",[0,0,0],!0),Se("specular","specular",[0,0,0],!0)];break;case"LIGHTING_BEGIN":f=[Se("E","E",[0,0,0],!0),Se("A","A",[0,0,0],!0),Se("D","D",[0,0,0],!0),Se("S","S",[0,0,0],!0),Se("normal","normal",[0,0,0],!0),Se("dif_params","dif_params",[0,0],!0),Se("sp_params","sp_params",[0,0],!0),Se("shadow_factor","shadow_factor",0,!0),Se("translucency_color","translucency_color",0,!0),Se("translucency_params","translucency_params",[0,0,0,0],!0)];break;case"LIGHTING_END":T=[Se("color","color",[0,0,0],!0),Se("specular","specular",[0,0,0],!0)];break;case"LIGHTING_LAMP":T=[Se("shadow_factor","shadow_factor",0,!0)],f=[Se("ldir","ldir",[0,0,0],!0),Se("lfac","lfac",[0,0],!0),Se("lcolorint","lcolorint",[0,0,0],!0),Se("norm_fac","norm_fac",0,!0)];break;case"DIFFUSE_LAMBERT":T=[Se("ldir","ldir",[0,0,0],!0),Se("lfac","lfac",[0,0],!0),Se("normal","normal",[0,0,0],!0),Se("norm_fac","norm_fac",0,!0)],f=[Se("lfactor","lfactor",0,!0)],O.push(["MAT_USE_TBN_SHADING",0|t.use_tangent_shading]);break;case"DIFFUSE_FRESNEL":case"DIFFUSE_MINNAERT":case"DIFFUSE_OREN_NAYAR":case"DIFFUSE_TOON":T=[Se("ldir","ldir",[0,0,0],!0),Se("lfac","lfac",[0,0],!0),Se("normal","normal",[0,0,0],!0),Se("norm_fac","norm_fac",0,!0),Se("dif_params","dif_params",[0,0],!0)],f=[Se("lfactor","lfactor",0,!0)],O.push(["MAT_USE_TBN_SHADING",0|t.use_tangent_shading]);break;case"SPECULAR_BLINN":case"SPECULAR_PHONG":case"SPECULAR_COOKTORR":T=[Se("ldir","ldir",[0,0,0],!0),Se("lfac","lfac",[0,0],!0),Se("normal","normal",[0,0,0],!0),Se("norm_fac","norm_fac",0,!0),Se("sp_params","sp_params",[0,0],!0)],f=[Se("sfactor","sfactor",0,!0)],O.push(["MAT_USE_TBN_SHADING",0|t.use_tangent_shading]);break;case"SPECULAR_TOON":case"SPECULAR_WARDISO":T=[Se("ldir","ldir",[0,0,0],!0),Se("lfac","lfac",[0,0],!0),Se("normal","normal",[0,0,0],!0),Se("norm_fac","norm_fac",0,!0),Se("sp_params","sp_params",[0,0],!0)],f=[Se("sfactor","sfactor",0,!0)],O.push(["MAT_USE_TBN_SHADING",0|t.use_tangent_shading]);break;case"BSDF_COMPUTE":T=[Se("ldir","ldir",[0,0,0],!0),Se("lfac","lfac",[0,0],!0),Se("normal","normal",[0,0,0],!0),Se("norm_fac","norm_fac",0,!0),Se("bsdf_params","bsdf_params",[0,0,0,0],!0)],f=[Se("lfactor","lfactor",0,!0),Se("sfactor","sfactor",0,!0)];break;case"LIGHTING_APPLY":T=[Se("color","color",[0,0,0,0],!0),Se("specular","specular",[0,0,0],!0),Se("lfactor","lfactor",0,!0),Se("sfactor","sfactor",0,!0),Se("ldir","ldir",[0,0,0],!0),Se("normal","normal",[0,0,0],!0),Se("translucency_params","translucency_params",[0,0,0,0],!0),Se("D","D",[0,0,0],!0),Se("S","S",[0,0,0],!0),Se("lcolorint","lcolorint",[0,0,0],!0),Se("translucency_color","translucency_color",0,!0)],f=[Se("color","color",[0,0,0,0],!0),Se("specular","specular",[0,0,0],!0)];break;case"NORMAL":T=ve(t),f=me(t);var Q=Pe(t,"Normal");P.push(Ne(Ee("param_NORMAL_Normal"),Q.default_value,3));break;case"MAPPING":var z=t.vector_type;s="MAPPING",T.push(fe(t,"Vector")),f.push(Pe(t,"Vector"));var V=d._1(t.rotation),q=d._1(t.scale),W=d._1(t.translation),J=E.create(),Z=d.Z(V,E.create());"TEXTURE"!=z&&"NORMAL"!=z||(q[0]=q[0]||1,q[1]=q[1]||1,q[2]=q[2]||1);var $=new Float32Array([q[0],0,0,0,q[1],0,0,0,q[2]]);switch(E.multiply(Z,$,J),J=d._22(J,c.create()),z){case"POINT":J[12]=W[0],J[13]=W[1],J[14]=W[2];break;case"TEXTURE":J[12]=W[0],J[13]=W[1],J[14]=W[2],J=c.invert(J,J);break;case"NORMAL":c.invert(J,J),c.transpose(J,J)}switch(z){case"NORMAL":O.push(["MAPPING_IS_NORMAL",1]);case"TEXTURE":O.push(["MAPPING_TRS_MATRIX_DEF",1]),O.push(["MAPPING_TRS_MATRIX",$e.glsl_value(J,16)]);break;case"POINT":0!==u.length(V)?(O.push(["MAPPING_TRS_MATRIX_DEF",1]),O.push(["MAPPING_TRS_MATRIX",$e.glsl_value(J,16)])):(0!==u.sqrDist(q,d.n)&&(O.push(["MAPPING_SCALE_DEF",1]),O.push(["MAPPING_SCALE",$e.glsl_value(q,3)])),0!==u.length(W)&&(O.push(["MAPPING_TRANS_DEF",1]),O.push(["MAPPING_TRANS",$e.glsl_value(W,3)])));break;case"VECTOR":0!==u.length(V)?(O.push(["MAPPING_TRS_MATRIX_DEF",1]),O.push(["MAPPING_TRS_MATRIX",$e.glsl_value(J,16)])):0!==u.sqrDist(q,d.n)&&(O.push(["MAPPING_SCALE_DEF",1]),O.push(["MAPPING_SCALE",$e.glsl_value(q,3)]))}t.use_min&&(O.push(["MAPPING_MIN_CLIP_DEF",1]),O.push(["MAPPING_MIN_CLIP",$e.glsl_value(t.min,3)])),t.use_max&&(O.push(["MAPPING_MAX_CLIP_DEF",1]),O.push(["MAPPING_MAX_CLIP",$e.glsl_value(t.max,3)]));break;case"MATERIAL":case"MATERIAL_EXT":var ee=[],te=[],_e=[],oe=[Se("E","E",[0,0,0],!0),Se("A","A",[0,0,0],!0),Se("D","D",[0,0,0],!0),Se("S","S",[0,0,0],!0),Se("normal","normal",[0,0,0],!0),Se("dif_params","dif_params",[0,0],!0),Se("sp_params","sp_params",[0,0],!0),Se("shadow_factor","shadow_factor",0,!0)],ie=[Se("color","color",[0,0,0],!0),Se("specular","specular",[0,0,0],!0),Se("normal","normal",[0,0,0],!0)],se=[Pe(t,"Color"),Pe(t,"Alpha"),Pe(t,"Normal")],Ae=[],pe=fe(t,"Color");pe.default_value.splice(3),_e.push(pe),T.push(pe),pe=fe(t,"Spec"),pe.default_value.splice(3),_e.push(pe),T.push(pe),pe=fe(t,"DiffuseIntensity"),pe||(pe=fe(t,"Refl")),pe.default_value=t.diffuse_intensity,_e.push(pe),T.push(pe);var Oe=fe(t,"Normal");if(Oe.default_value.splice(3),_e.push(Oe),T.push(Oe),"MATERIAL_EXT"==s){pe=fe(t,"Emit"),pe||(pe=Se("Emit","Emit",0)),_e.push(pe),T.push(pe),pe=fe(t,"Translucency"),pe?(pe.default_value=0,pe.name="Translucency",pe.identifier="Translucency"):pe=Se("Translucency","Translucency",0),T.push(pe),pe=fe(t,"Translucency"),pe?(pe.default_value=[0,0,0,0],pe.name="TranslucencyParams",pe.identifier="TranslucencyParams"):pe=Se("TranslucencyParams","TranslucencyParams",[0,0,0,0]),T.push(pe);var ge=fe(t,"Reflectivity"),Re=fe(t,"Ray Mirror");if(ge){pe=ge;var Ie="Reflectivity"}else if(Re){pe=Re;var Ie="Ray Mirror"}else{pe=ge;var Ie="Reflectivity"}pe||(pe=Se(Ie,Ie,0)),T.push(pe),ie.push(pe),pe=fe(t,"SpecTra"),pe||(pe=Se("SpecTra","SpecTra",0)),T.push(pe),ie.push(pe),pe=fe(t,"Alpha"),pe||(pe=Se("Alpha","Alpha",t.alpha)),T.push(pe),ie.push(pe),se.push(Pe(t,"Diffuse")),se.push(Pe(t,"Spec")),ee.push(["MATERIAL_EXT",1]),te.push(["MATERIAL_EXT",1])}else _e.push(Se("emit_intensity","emit_intensity",0)),ie.push(Se("reflect_factor","reflect_factor",0)),ie.push(Se("specular_alpha","specular_alpha",0)),ie.push(Se("alpha_in","alpha_in",0)),se.push(Se("diffuse_out","diffuse_out",0)),se.push(Se("spec_out","spec_out",0)),ee.push(["MATERIAL_EXT",0]),te.push(["MATERIAL_EXT",0]);Ae.push(Ne(Ee("param_MATERIAL_alpha"),t.alpha)),Ae.push(Ne(Ee("param_MATERIAL_spec_alpha"),t.specular_alpha)),f=se,ee.push(["USE_MATERIAL_NORMAL",0|Oe.is_linked]),t.use_diffuse&&(ee.push(["USE_MATERIAL_DIFFUSE",1]),te.push(["USE_MATERIAL_DIFFUSE",1])),t.use_specular&&te.push(["USE_MATERIAL_SPECULAR",1]);var be,he=[],Ye=0;switch(t.specular_shader){case"COOKTORR":case"PHONG":be=t.specular_hardness;break;case"WARDISO":be=t.specular_slope;break;case"TOON":be=t.specular_toon_size,Ye=t.specular_toon_smooth;break;case"BLINN":be=t.specular_ior,Ye=t.specular_hardness;break;default:Ze.error("unsupported specular shader: "+t.specular_shader+' (material "'+t.material_name+'")'),be=t.specular_hardness}var Le,Me;switch(t.diffuse_shader){case"LAMBERT":Le=0,Me=0;break;case"OREN_NAYAR":Le=t.roughness,Me=0;break;case"FRESNEL":Le=t.diffuse_fresnel,Me=t.diffuse_fresnel_factor;break;case"MINNAERT":Le=t.darkness,Me=0;break;case"TOON":Le=t.diffuse_toon_size,Me=t.diffuse_toon_smooth;break;default:Ze.error("unsupported diffuse shader: "+t.diffuse_shader+' (material "'+t.material_name+'")'),Le=0,Me=0}he.push(Ne(Ee("param_MATERIAL_diffuse"),[Le,Me],2)),he.push(Ne(Ee("param_MATERIAL_spec"),[t.specular_intensity,be,Ye],3)),ee.push(["SHADELESS_MAT",t.use_shadeless?1:0]);var xe={name:t.name,value:{specular_shader:t.specular_shader,diffuse_shader:t.diffuse_shader,use_shadeless:t.use_shadeless,use_tangent_shading:t.use_tangent_shading}},ye={name:"material_begin",type:"MATERIAL_BEGIN",inputs:_e,outputs:oe,params:he,data:xe,dirs:ee,vparams:[]},Ue={name:"material_end",type:"MATERIAL_END",inputs:ie,outputs:se,params:Ae,data:xe,dirs:te,vparams:[]};A={name:t.name,value:{specular_shader:t.specular_shader,diffuse_shader:t.diffuse_shader,use_shadeless:t.use_shadeless,use_tangent_shading:t.use_tangent_shading},material_begin:ye,material_end:Ue};break;case"BSDF_PRINCIPLED":T=ve(t);var we=fe(t,"Base Color"),Ce=fe(t,"Metallic"),De=fe(t,"Roughness"),Fe=fe(t,"Normal");T=[we,Ce,De,Fe],O.push(["USE_NORMAL_IN",0|Fe.is_linked]);var Ge=Pe(t,"BSDF"),ke=Ge.is_linked;f=[Ge,Se("d_color","d_color",[0,0,0],ke),Se("d_roughness","d_roughness",0,ke),Se("s_color","s_color",[0,0,0],ke),Se("s_roughness","s_roughness",0,ke),Se("metalness","metalness",1,ke),Se("normal","normal",[0,0,0],ke),Se("e_color","e_color",[0,0,0],ke),Se("emisson","emisson",0,ke),Se("a_color","a_color",[0,0,0],ke),Se("alpha","alpha",1,ke)];break;case"BSDF_DIFFUSE":T=ve(t),O.push(["USE_NORMAL_IN",0|T[2].is_linked]);var Ge=Pe(t,"BSDF"),ke=Ge.is_linked;f=[Ge,Se("d_color","d_color",[0,0,0],ke),Se("d_roughness","d_roughness",0,ke),Se("s_color","s_color",[0,0,0],ke),Se("s_roughness","s_roughness",0,ke),Se("metalness","metalness",0,ke),Se("normal","normal",[0,0,0],ke),Se("e_color","e_color",[0,0,0],ke),Se("emisson","emisson",0,ke),Se("a_color","a_color",[0,0,0],ke),Se("alpha","alpha",1,ke)];break;case"BSDF_GLOSSY":T=ve(t),O.push(["USE_NORMAL_IN",0|T[2].is_linked]);var Ge=Pe(t,"BSDF"),ke=Ge.is_linked;f=[Ge,Se("d_color","d_color",[0,0,0],ke),Se("d_roughness","d_roughness",0,ke),Se("s_color","s_color",[0,0,0],ke),Se("s_roughness","s_roughness",0,ke),Se("metalness","metalness",1,ke),Se("normal","normal",[0,0,0],ke),Se("e_color","e_color",[0,0,0],ke),Se("emisson","emisson",0,ke),Se("a_color","a_color",[0,0,0],ke),Se("alpha","alpha",1,ke)];break;case"BSDF_TRANSPARENT":var Ke=t.b4w_use_alpha;T=ve(t);var Ge=Pe(t,"BSDF"),ke=Ge.is_linked;f=[Ge,Se("d_color","d_color",[0,0,0],ke),Se("d_roughness","d_roughness",0,ke),Se("s_color","s_color",[0,0,0],ke),Se("s_roughness","s_roughness",0,ke),Se("metalness","metalness",0,ke),Se("normal","normal",[0,0,0],ke),Se("e_color","e_color",[0,0,0],ke),Se("emisson","emisson",0,ke),Se("a_color","a_color",[0,0,0],ke),Se("alpha","alpha",Ke?0:1,ke)],A={value:{use_alpha:Ke}},O.push(["USE_ALPHA",0|Ke]);break;case"EMISSION":T=ve(t);var Be=Pe(t,"Emission"),Xe=Be.is_linked;f=[Be,Se("d_color","d_color",[0,0,0],Xe),Se("d_roughness","d_roughness",0,Xe),Se("s_color","s_color",[0,0,0],Xe),Se("s_roughness","s_roughness",0,Xe),Se("metalness","metalness",1,Xe),Se("normal","normal",[0,0,0],Xe),Se("e_color","e_color",[0,0,0],Xe),Se("emisson","emisson",1,Xe),Se("a_color","a_color",[0,0,0],ke),Se("alpha","alpha",1,ke)];break;case"MATH":switch(t.operation){case"ADD":s="MATH_ADD";break;case"SUBTRACT":s="MATH_SUBTRACT";break;case"MULTIPLY":s="MATH_MULTIPLY";break;case"DIVIDE":s="MATH_DIVIDE";break;case"SINE":s="MATH_SINE";break;case"COSINE":s="MATH_COSINE";break;case"TANGENT":s="MATH_TANGENT";break;case"ARCSINE":s="MATH_ARCSINE";break;case"ARCCOSINE":s="MATH_ARCCOSINE";break;case"ARCTANGENT":s="MATH_ARCTANGENT";break;case"POWER":s="MATH_POWER";break;case"LOGARITHM":s="MATH_LOGARITHM";break;case"MINIMUM":s="MATH_MINIMUM";break;case"MAXIMUM":s="MATH_MAXIMUM";break;case"ROUND":s="MATH_ROUND";break;case"LESS_THAN":s="MATH_LESS_THAN";break;case"GREATER_THAN":s="MATH_GREATER_THAN";break;case"MODULO":s="MATH_MODULO";break;case"ABSOLUTE":s="MATH_ABSOLUTE";break;default:return Ze.error("Unsupported MATH operation: "+t.operation),null}O.push(["MATH_USE_CLAMP",Number(t.use_clamp)]),T=ve(t),f=me(t);break;case"MIX_RGB":switch(t.blend_type){case"MIX":s="MIX_RGB_MIX";break;case"ADD":s="MIX_RGB_ADD";break;case"MULTIPLY":s="MIX_RGB_MULTIPLY";break;case"SUBTRACT":s="MIX_RGB_SUBTRACT";break;case"SCREEN":s="MIX_RGB_SCREEN";break;case"DIVIDE":s="MIX_RGB_DIVIDE";break;case"DIFFERENCE":s="MIX_RGB_DIFFERENCE";break;case"DARKEN":s="MIX_RGB_DARKEN";break;case"LIGHTEN":s="MIX_RGB_LIGHTEN";break;case"OVERLAY":s="MIX_RGB_OVERLAY";break;case"DODGE":s="MIX_RGB_DODGE";break;case"BURN":s="MIX_RGB_BURN";break;case"HUE":s="MIX_RGB_HUE";break;case"SATURATION":s="MIX_RGB_SATURATION";break;case"VALUE":s="MIX_RGB_VALUE";break;case"COLOR":s="MIX_RGB_COLOR";break;case"SOFT_LIGHT":s="MIX_RGB_SOFT_LIGHT";break;case"LINEAR_LIGHT":s="MIX_RGB_LINEAR_LIGHT";break;default:return Ze.error("Unsupported MIX_RGB blend type: "+t.blend_type),null}O.push(["MIX_RGB_USE_CLAMP",Number(t.use_clamp)]),T=ve(t),f=me(t);break;case"MIX_WORLD_RGB":case"ADD_WORLD_RGB":T=[Se("Factor","Factor",t.fac,t.fac_is_linked),Se("Color1","Color1",[0,0,0],t.color1_is_linked),Se("Color2","Color1",[0,0,0],t.color2_is_linked)],f=[Se("Color","Color",[0,0,0],!0)];break;case"OUTPUT":T=ve(t),f=[];break;case"OUTPUT_MATERIAL":T=ve(t),f=[];var He=fe(t,"Surface"),je=He.is_linked,Qe=[],Ve=[],qe=[He,Se("d_color","d_color",[0,0,0],je),Se("d_roughness","d_roughness",0,je),Se("s_color","s_color",[0,0,0],je),Se("s_roughness","s_roughness",0,je),Se("metalness","metalness",0,je),Se("normal","normal",[0,0,0],je),Se("e_color","e_color",[0,0,0],je),Se("emission","emission",0,je),Se("a_color","a_color",[0,0,0],je),Se("alpha","alpha",0,je)],We=[Se("E","E",[0,0,0],!0),Se("A","A",[0,0,0],!0),Se("D","D",[0,0,0],!0),Se("S","S",[0,0,0],!0),Se("normal","normal",[0,0,0],!0),Se("bsdf_params","bsdf_params",[0,0,0,0],!0),Se("shadow_factor","shadow_factor",0,!0),Se("d_color","d_color",[0,0,0],!0),Se("s_color","s_color",[0,0,0],!0),Se("e_color","e_color",[0,0,0],!0),Se("emission","emission",0,!0),Se("a_color","a_color",[0,0,0],!0),Se("alpha","alpha",0,!0)],tt=[Se("color","color",[0,0,0],!0),Se("specular","specular",[0,0,0],!0),Se("normal","normal",[0,0,0],!0),Se("bsdf_params","bsdf_params",[0,0,0,0],!0),Se("d_color","d_color",[0,0,0],!0),Se("s_color","s_color",[0,0,0],!0),Se("e_color","e_color",[0,0,0],!0),Se("emission","emission",0,!0),Se("a_color","a_color",[0,0,0],!0),Se("alpha","alpha",0,!0)],_t=[Se("color","color",[0,0,0],je),Se("alpha","alpha",1,je)],rt=[],it=[],st={name:"bsdf_begin",type:"BSDF_BEGIN",inputs:qe,outputs:We,params:rt,data:null,dirs:Qe,vparams:[]},Et={name:"bsdf_end",type:"BSDF_END",inputs:tt,outputs:_t,params:it,data:null,dirs:Ve,vparams:[]},ct=[He,Se("alpha","alpha",1,je)],ht=[],Yt=[],Lt=[],Mt={name:"output_surface",type:"OUTPUT_SURFACE",inputs:ct,outputs:ht,params:Yt,data:{value:{bsdf_shader:"BSDF_COMPUTE"},bsdf_begin:st,bsdf_end:Et},dirs:Lt,vparams:[]},xt=[Se("Height","Height",0,!0)],yt=[Se("Normal","Normal",[0,0,0],!1)],Ut=[],wt=[],Ct={name:"displacement_bump",type:"DISPLACEMENT_BUMP",inputs:xt,outputs:yt,params:Ut,data:null,dirs:wt,vparams:[]};A={name:t.name,output_surface:Mt,displacement_bump:Ct};break;case"OUTPUT_WORLD":T=ve(t),f=me(t);var He=fe(t,"Surface"),Dt=[He],Ft=[],Gt=[],kt=[],Mt={name:"output_world_surface",type:"OUTPUT_WORLD_SURFACE",inputs:Dt,outputs:Ft,params:Gt,data:null,dirs:kt,vparams:[]};A={name:t.name,output_world_surface:Mt};break;case"RGB":var Kt=t.name,Bt={name:"-1",value:Kt};P.push(Bt),f.push(Pe(t,"Color"));break;case"SEPRGB":case"SEPHSV":T=ve(t),f=me(t);break;case"TEX_ENVIRONMENT":var Xt=t.image;if(Xt){s="TEXTURE_ENVIRONMENT_"+t.projection,"NONE"==t.color_space?O.push(["NON_COLOR",1]):O.push(["NON_COLOR",0]),T.push(fe(t,"Vector")),O.push(["USE_VECTOR_IN",0|T[0].is_linked]),f.push(Pe(t,"Color"));var X=Ee("param_TEXTURE_texture");P.push(Ne(X));var Ht=et.create_texture(et.TT_RGBA_INT,!1);Ht.repeat=!0,Ht.source="IMAGE",ot.anisotropic_available&&(Ht.anisotropic_filtering=16),et.append_img_info(Ht,Xt),A={bpy_name:t.name,bpy_uuid:"",name:X,value:Ht}}else s="TEXTURE_EMPTY";break;case"TEX_IMAGE":var Xt=t.image;if(Xt){s="TEXTURE_COLOR","NONE"==t.color_space?O.push(["NON_COLOR",1]):O.push(["NON_COLOR",0]),O.push(["CONVERT_UV",0]);for(var jt=0;jt<4;++jt){var pe,Qt,zt;jt?(pe=Se("Vector"+jt,"Vector"+jt,[0,0,0],!1),Qt=Se("Color"+jt,"Color"+jt,[0,0,0],!1),zt=Se("Alpha"+jt,"Alpha"+jt,0,!1)):(pe=fe(t,"Vector"),Qt=Pe(t,"Color"),zt=Pe(t,"Alpha")),T.push(pe),f.push(Qt),f.push(zt)}var X=Ee("param_TEXTURE_texture");P.push(Ne(X));var Ht=et.create_texture(et.TT_RGBA_INT,!1);Ht.repeat="REPEAT"==t.extension,Ht.source="IMAGE",et.append_img_info(Ht,Xt),A={bpy_name:t.name,bpy_uuid:"",name:X,value:Ht}}else s="TEXTURE_EMPTY";break;case"TEXTURE":if("TEXTURE_EMPTY"==(s=ue(t)))f.push(Pe(t,"Color")),f.push(Pe(t,"Normal")),f.push(Pe(t,"Value"));else if("TEXTURE_ENVIRONMENT_CUBE"==s)T.push(fe(t,"Vector")),f.push(Pe(t,"Color")),f.push(Pe(t,"Value"));else{if("TEXTURE_NORMAL"==s&&"ENVIRONMENT_MAP"==t.texture.type)return Ze.error("Wrong output for ENVIRONMENT_MAP texture: "+t.name),null;if("TEXTURE_COLOR"==s){var Vt=!1,qt=t.texture.image;!qt||"Non-Color"!=qt.colorspace_settings_name&&"Non-Colour Data"!=qt.colorspace_settings_name||(Vt=!0),O.push(["NON_COLOR",Number(Vt)]),O.push(["CONVERT_UV",1])}for(var jt=0;jt<4;++jt){var pe,Qt,zt,Wt="TEXTURE_COLOR"==s?"Color":"Normal";jt?(pe=Se("Vector"+jt,"Vector"+jt,[0,0,0],!1),Qt=Se(Wt+jt,Wt+jt,[0,0,0],!1),zt=Se("Value"+jt,"Value"+jt,0,!1)):(pe=fe(t,"Vector"),Qt=Pe(t,Wt),zt=Pe(t,"Value")),T.push(pe),f.push(Qt),f.push(zt)}}if("TEXTURE_EMPTY"!=s){var X=Ee("param_TEXTURE_texture");P.push(Ne(X));var Ht=t.texture._render;A={bpy_name:t.texture.name,bpy_uuid:t.texture.uuid,name:X,value:Ht}}break;case"VALTORGB":T=ve(t),f=me(t),A={value:t};var Jt=t.color_ramp.interpolation;"CONSTANT"!=Jt&&"LINEAR"!=Jt&&Ze.warn("Color Ramp node is not fully supported.");break;case"VALUE":s="VALUE";var Kt=t.name,Bt={name:"-1",value:Kt};P.push(Bt),f.push(Pe(t,"Value"));break;case"VECT_MATH":switch(t.operation){case"ADD":s="VECT_MATH_ADD";break;case"SUBTRACT":s="VECT_MATH_SUBTRACT";break;case"AVERAGE":s="VECT_MATH_AVERAGE";break;case"DOT_PRODUCT":s="VECT_MATH_DOT_PRODUCT";break;case"CROSS_PRODUCT":s="VECT_MATH_CROSS_PRODUCT";break;case"NORMALIZE":s="VECT_MATH_NORMALIZE";break;default:return Ze.error("Unsupported VECT_MATH operation: "+t.operation),null}T=ve(t),f=me(t);break;case"VECT_TRANSFORM":switch(t.vector_type){case"POINT":O.push(["VECTOR_TYPE",$e.glsl_value(lt)]);break;case"VECTOR":O.push(["VECTOR_TYPE",$e.glsl_value(Tt)]);break;case"NORMAL":O.push(["VECTOR_TYPE",$e.glsl_value(dt)]);break;default:return Ze.error("Unsupported VECT_TRANSFORM vector_type: "+t.vector_type),null}var Zt=t.convert_from,$t=t.convert_to,e_=ut;if("WORLD"==Zt)if("WORLD"==$t)e_=ut;else if("OBJECT"==$t)e_=ft;else{if("CAMERA"!=$t)return Ze.error("Unsupported VECT_TRANSFORM convert_to: "+t.convert_to),null;e_=Pt}else if("OBJECT"==Zt)if("WORLD"==$t)e_=At;else if("OBJECT"==$t)e_=St;else{if("CAMERA"!=$t)return Ze.error("Unsupported VECT_TRANSFORM convert_to: "+t.convert_to),null;e_=pt}else{if("CAMERA"!=Zt)return Ze.error("Unsupported VECT_TRANSFORM convert_from: "+t.convert_from),null;if("WORLD"==$t)e_=Ot;else if("OBJECT"==$t)e_=vt;else{if("CAMERA"!=$t)return Ze.error("Unsupported VECT_TRANSFORM convert_to: "+t.convert_to),null;e_=mt}}O.push(["CONVERT_TYPE",$e.glsl_value(e_)]),T=ve(t),f=me(t);break;case"NORMAL_MAP":var t_=Nt;switch(t.space){case"TANGENT":t_=Nt;break;case"OBJECT":t_=gt;break;case"WORLD":t_=Rt;break;case"BLENDER_OBJECT":t_=It;break;case"BLENDER_WORLD":t_=bt;break;default:return Ze.error("Unsupported NORMAL_MAP space: "+t.space),null}O.push(["SPACE",$e.glsl_value(t_)]),T.push(fe(t,"Strength")),T.push(fe(t,"Color")),T.push(Se("Normal","Normal",[0,0,0],!1)),O.push(["USE_NORMAL_IN",0]),f.push(Pe(t,"Normal"));break;case"FRESNEL":var Oe=fe(t,"Normal");T.push(fe(t,"IOR")),T.push(Oe),f.push(Pe(t,"Fac")),O.push(["USE_FRESNEL_NORMAL",0|Oe.is_linked]);break;case"LAYER_WEIGHT":var Oe=fe(t,"Normal");T.push(fe(t,"Blend")),T.push(Oe),f=me(t),O.push(["USE_NORMAL_IN",0|Oe.is_linked]);break;case"BUMP":var Oe=fe(t,"Normal");O.push(["INVERT",t.invert?1:0]),O.push(["USE_NORMAL_IN",0|Oe.is_linked]),T=ve(t),f=me(t);break;case"BACKGROUND":default:T=ve(t),f=me(t)}var __={name:o,origin_name:i,type:s,vparams:l,inputs:T,outputs:f,params:P,data:A,dirs:O},r_=Je.gen_node_id(e);return Je.append_node(e,r_,__),"GEOMETRY"!=t.type&&"TEX_COORD"!=t.type&&"NEW_GEOMETRY"!=t.type||!de(t,_)||null!=re(e,t,++_,r,a,n)?r_:null}function ae(e,t,_){for(var r=e.inputs,a=e.outputs,n=e.node_tree_name,o=0;o<t.length;o++){var i=r[o],s=t[o];if(!i||i.default_value instanceof Array!=s)return Ze.warn('Wrong inputs for custom node group "'+e.name+'" of type: "',n,'".Processing as general node group.'),!1}for(var o=0;o<_.length;o++){var E=a[o],c=_[o];if(!E||E.default_value instanceof Array!=c)return Ze.warn('Wrong outputs for custom node group "'+e.name+'" of type: "',n,'".Processing as general node group.'),!1}return!0}function ne(e,t,_,a){var n=se(e.node_group.node_tree),o=e.node_tree_name;if("B4W_REPLACE"==o||"B4W_LEVELS_OF_QUALITY"==o){var i=$("Group input","GROUP_INPUT",[],e.inputs),s=$("Group output","GROUP_OUTPUT",e.outputs,[]),E=null;E="B4W_REPLACE"==o||"B4W_LEVELS_OF_QUALITY"==o&&(ot.quality==qe.P_LOW||ot.force_low_quality_nodes)?ee(i,i.outputs[1],s,s.inputs[0]):ee(i,i.outputs[0],s,s.inputs[0]),n.nodes=[i,s],n.links=[E]}return Me(e.name,n),{node_group_graph:r(n,e.node_group.uuid,!0,t,_,a).graph,node_group_links:n.links}}function oe(){tt={}}function ie(e){var t=typeof e;return"string"!=t&&"number"!=t&&"boolean"!=t&&e?d.N(e):e}function se(e){var t={};for(var _ in e)if("links"==_||"nodes"==_){t[_]=[];for(var r=0;r<e[_].length;r++){t[_][r]={};for(var a in e[_][r])if("links"==_){t[_][r][a]={};for(var n in e[_][r][a])t[_][r][a][n]=ie(e[_][r][a][n])}else t[_][r][a]=ie(e[_][r][a])}}else t[_]=ie(e[_]);return t}function Ee(e){tt[e]||(tt[e]=0);var t=e+"_"+tt[e];return t=t.replace(/ /g,"_").replace(/\//g,"_"),tt[e]++,t}function ce(e){for(var t=e.outputs,_=0;_<t.length;_++){if(t[_].is_linked)return!0}return!1}function le(e,t){for(var _=e.outputs,r=0,a=0;a<_.length;a++){var n=_[a];if(n.is_linked&&!(r++<t))switch(n.identifier){case"UV":return"GEOMETRY_UV";case"Vertex Color":return"GEOMETRY_VC";case"Normal":return"GEOMETRY_NO";case"True Normal":return"GEOMETRY_TRN";case"Front/Back":return"GEOMETRY_FB";case"View":return"GEOMETRY_VW";case"Global":case"Position":return"GEOMETRY_GL";case"Local":return"GEOMETRY_LO";case"Orco":return"GEOMETRY_OR";case"Incoming":return"GEOMETRY_IN";case"Backfacing":return"GEOMETRY_BF";default:return null}}}function Te(e,t){for(var _=e.outputs,r=0,a=0;a<_.length;a++){var n=_[a];if(n.is_linked&&!(r++<t))switch(n.identifier){case"Camera":return"TEX_COORD_CA";case"Generated":return"TEX_COORD_GE";case"Normal":return"TEX_COORD_NO";case"Object":return"TEX_COORD_OB";case"Reflection":return"TEX_COORD_RE";case"UV":return"TEX_COORD_UV";case"Window":return"TEX_COORD_WI";default:return null}}}function de(e,t){for(var _=e.outputs,r=0,a=0;a<_.length;a++){if(_[a].is_linked&&r++>t)return!0}return!1}function ue(e){if(!e.texture||!e.texture._render)return"TEXTURE_EMPTY";for(var t=e.outputs,_=!1,r=!1,a=!1,n=0;n<t.length;n++){var o=t[n];if(o.is_linked){switch(o.identifier){case"Color":_=!0;break;case"Normal":r=!0;break;case"Value":a=!0;break;default:Ve.panic("Unknown texture output")}}}return _?(r&&Ze.warn('Node "'+e.name+'" has both Color and Normal outputs. Normal will be omitted.'),"ENVIRONMENT_MAP"==e.texture.type?"TEXTURE_ENVIRONMENT_CUBE":"TEXTURE_COLOR"):r?"TEXTURE_NORMAL":a?"ENVIRONMENT_MAP"==e.texture.type?"TEXTURE_ENVIRONMENT_CUBE":"TEXTURE_COLOR":void 0}function fe(e,t){for(var _=e.inputs,r=0;r<_.length;r++){var a=_[r];if(a.identifier==t)return Ae(a)}return null}function Pe(e,t){for(var _=e.outputs,r=0;r<_.length;r++){var a=_[r];if(a.identifier==t)return Ae(a)}return null}function Ae(e){return{name:e.name,identifier:e.identifier,is_linked:e.is_linked,default_value:Oe(e.default_value)}}function Se(e,t,_,r){return{name:e,identifier:t,is_linked:r,default_value:_}}function pe(e){return Se(e.name,e.identifier,e.default_value,e.is_linked)}function Oe(e){return d._15(e)?e.slice(0):e}function ve(e){for(var t=[],_=0;_<e.inputs.length;_++){var r=Ae(e.inputs[_]);r.default_value.length&&r.default_value.splice(3),t.push(r)}return t}function me(e){for(var t=[],_=0;_<e.outputs.length;_++){var r=Ae(e.outputs[_]);t.push(r)}return t}function Ne(e,t,_){if(null===t||void 0===t)var r=null;else var r=$e.glsl_value(t,_);return{name:e,value:r}}function ge(e){return{name:e.name,value:e.value}}function Re(e){return e=e.replace(/(,)/g,"$1 "),e=e.replace(/(^|[^0-9]|\s)(0\.0)($|[^0-9]|\s)/g,"$1_0_0$3"),e=e.replace(/(^|[^0-9]|\s)(1\.0)($|[^0-9]|\s)/g,"$1_1_0$3"),e=e.replace(/\s+/g,"")}function Ie(e){return e.slice()}function be(e,t,_,r,a,n){for(var o=[],i=n.from_socket.identifier,s=n.to_socket.identifier,E=r.outputs,c=0;c<E.length;c++){if(E[c].identifier==i){o.push(c);break}}for(var l=a.inputs,c=0;c<l.length;c++){if(l[c].identifier==s){o.push(c);break}}return 2==o.length&&Je.append_edge(e,t,_,o),!0}function he(e){for(var t=[],_=[],r=[],a=[],n=[],o=[],i=0;i<e.inputs.length;i++){var s=e.inputs[i];if(s.is_linked)t.push(null),_.push(null);else{t.push(Ee("in_"+e.type+"_"+Ye(s.identifier)));var E=$e.glsl_value(s.default_value,0);ot.shader_constants_hack&&(e.type.indexOf("MIX_RGB_")>=0&&("Color1"==s.identifier||"Color2"==s.identifier||"Fac"==s.identifier)||e.type.indexOf("MATH_")>=0&&("Value"==s.identifier||"Value_001"==s.identifier||"Value.001"==s.identifier)||e.type.indexOf("VECT_MATH_")>=0&&("Vector_001"==s.identifier||"Vector.001"==s.identifier)||e.type.indexOf("LIGHTING_APPLY")>=0||e.type.indexOf("MATERIAL_END")>=0||e.type.indexOf("MATERIAL_BEGIN")>=0)&&(E=Re(E)),_.push(E)}}for(var i=0;i<e.outputs.length;i++){var c=e.outputs[i];c.is_linked?r.push(null):r.push(Ee("out_"+e.type+"_"+Ye(c.identifier)))}for(var i=0;i<e.params.length;i++){var l=e.params[i];a.push(l.name),n.push(l.value)}for(var i=0;i<e.vparams.length;i++){var T=e.vparams[i];o.push(T.name)}return{id:e.type,inputs:t,input_values:_,outputs:r,params:a,param_values:n,vparams:o,dirs:JSON.parse(JSON.stringify(e.dirs))}}function Ye(e){return e.replace(/\./g,"")}function Le(e,t,_){return"GROUP_INPUT"==e?t+"*GI*"+_:"GROUP_OUTPUT"==e?t+"*GO*"+_:t+"%join%"+_}function Me(e,t){for(var _=t.nodes,r=t.links,a=0;a<_.length;a++)_[a].name=Le(_[a].type,e,_[a].name);for(var a=0;a<r.length;a++)r[a].from_node.name=Le(r[a].from_node.type,e,r[a].from_node.name),r[a].to_node.name=Le(r[a].to_node.type,e,r[a].to_node.name)}function xe(e){var t=[];return Je.traverse(e,function(e,_){"GROUP"==_.type&&t.push(_)}),t}function ye(e,t,_){for(var r=0;r<_.length;r++){var a=_[r].data.node_group_graph,n=_[r].data.node_group_links;if(!a)return!1;Je.traverse(a,function(t,_){Je.append_node(e,Je.gen_node_id(e),_)});for(var o=0;o<n.length;o++)t.push(n[o]);Be(_[r],t,e)}return!0}function Ue(e,t,_,r,a,n){switch(e.type){case"GROUP":e.name==t&&r.push(_);break;case"GROUP_INPUT":e.name.indexOf(t+"*GI*")||a.push(_);break;case"GROUP_OUTPUT":e.name.indexOf(t+"*GO*")||n.push(_)}}function we(e,t,_){for(var r=[],a=0;a<_.length;a++){for(var n=_[a],o=null,i=0;i<t.length;i++)if(n.from_socket.identifier==t[i].to_socket.identifier){o=t[i];break}o?(n.from_node=o.from_node,n.from_socket=o.from_socket):r.push(n)}for(var a=0;a<t.length;a++)e.splice(e.indexOf(t[a]),1);return r}function Ce(e,t){if(t.length)for(var _=t[0].from_node.name,r=0;r<e.length;r++)e[r].from_node.name==_&&t.push(e[r])}function De(e,t,_){for(var r=w(e.to_node,t),a=0;a<r.length;a++)for(var n=Je.get_node_attr(t,r[a]),o=0;o<n.inputs.length;o++){var i=n.inputs[o];if(i.identifier==e.to_socket.identifier){var s=Ge(i.default_value),E=Ge(_);if(E==s)i.default_value=_;else switch(s){case st:ke(_,i.default_value);break;case Et:i.default_value=Ke(_)}break}}}function Fe(e,t,_,r){for(var a=0;a<r.length;a++){for(var n,o=r[a],i=0;i<_.inputs.length;i++)if(o.from_socket.identifier==_.inputs[i].identifier){n=_.inputs[i].default_value;break}De(o,t,n);var s=e.indexOf(o);-1!=s&&e.splice(s,1)}}function Ge(e){return e instanceof Object?st:Et}function ke(e,t){return t[0]=t[1]=t[2]=e,t}function Ke(e){return(e[0]+e[1]+e[2])/3}function Be(e,t,_){for(var r=e.name,a=[],n=[],o=[],i=[],s=0;s<t.length;s++){var E=t[s];Ue(E.from_node,r,E,a,o,i),Ue(E.to_node,r,E,n,o,i)}var c=we(t,n,o),l=we(t,i,a);if(Ce(t,c),Fe(t,_,e,c),l.length){var T;Je.traverse(_,function(e,t){"GROUP_OUTPUT"!=t.type||t.name.indexOf(r+"*GO*")||(T=t)}),Fe(t,_,T,l)}}function Xe(e,t,_){Ze.log("\n====== USER: "+t+", MATERIAL: "+_+" ======\n"+We.nodegraph_to_dot(e,!0)+"\n=============================================================")}function He(){for(var e in _t)delete _t[e];for(var e in rt)delete rt[e];for(var t in at)delete at[t];nt=0}function je(e){var t=[],_=[];Je.traverse(e,function(e,r){switch(r.type){case"VALTORGB":t.push(r);break;case"CURVE_VEC":case"CURVE_RGB":_.push(r)}});var r=0,a=null,n=null,o=t.length+_.length;if(t.length){a=et.extract_col_ramps_data(t,et.COLORRAMP_TEXT_SIZE);for(var i=0;i<t.length;i++)t[i].dirs.push(["NODE_TEX_ROW",$e.glsl_value((r+.5)/o)]),r++}if(_.length){n=et.extract_vec_curves_data(_,et.CURVE_NODES_TEXT_SIZE);for(var i=0;i<_.length;i++)_[i].dirs.push(["NODE_TEX_ROW",$e.glsl_value((r+.5)/o)]),r++}var s=null;if(a&&n?(s=new Uint8Array(a.length+n.length),s.set(a),s.set(n,a.length)):s=a||n,s)var E=et.create_color_ramp_texture(s,et.CURVE_NODES_TEXT_SIZE);else var E=null;for(var i=0;i<t.length;i++)t[i].data.texture=E;for(var i=0;i<_.length;i++)_[i].data.texture=E}function Qe(e){var t=-1;return Je.traverse(e,function(e,_){if("TEXTURE_ENVIRONMENT_EQUIRECTANGULAR"==_.type||"TEXTURE_ENVIRONMENT_MIRROR_BALL"==_.type){var r=_.data.value.height;t=Math.max(t,r)}}),t}function ze(e,t,_,r){var a=e.curve_mapping.curves_data[t];return!(2==a.length&&a[0][0]<_+ct&&a[0][1]<_+ct&&a[1][0]>r-ct&&a[1][1]>r-ct)}var Ve=Object(n.a)(e),qe=Object(o.a)(e),We=Object(i.a)(e),Je=Object(s.a)(e),Ze=Object(l.a)(e),$e=Object(T.a)(e),et=Object(f.a)(e),tt={},_t={},rt={},at={},nt=0,ot=qe.defaults,it=!1,st=0,Et=1,ct=.01,lt=0,Tt=1,dt=2,ut=0,ft=1,Pt=2,At=3,St=4,pt=5,Ot=6,vt=7,mt=8;t.VT_WORLD_TO_WORLD=ut,t.VT_WORLD_TO_OBJECT=ft,t.VT_WORLD_TO_CAMERA=Pt,t.VT_OBJECT_TO_WORLD=At,t.VT_OBJECT_TO_OBJECT=St,t.VT_OBJECT_TO_CAMERA=pt,t.VT_CAMERA_TO_WORLD=Ot,t.VT_CAMERA_TO_OBJECT=vt,t.VT_CAMERA_TO_CAMERA=mt;var Nt=0,gt=1,Rt=2,It=3,bt=4;t.NM_TANGENT=Nt,t.NM_OBJECT=gt,t.NM_WORLD=Rt,t.NM_BLENDER_OBJECT=It,t.NM_BLENDER_WORLD=bt;var ht=0,Yt=2;t.get_ngraph_proxy_cached=function(e){return _t[e]},t.cleanup_ngraph_proxy=function(e){delete _t[e]},t.compose_ngraph_proxy=_,t.create_lighting_graph=function(e,t,_){if(e in rt)return rt[e];var r=Je.create(),a={name:"LIGHTING_BEGIN",type:"LIGHTING_BEGIN"},n=re(r,a,0,null,null,_);return a={name:"LIGHTING_END",type:"LIGHTING_END"},P(r,t,n,re(r,a,0,null,null,_),[[n,[8,10]],[n,[9,6]]],_),M(r),rt[e]=r,r},t.generate_graph_id=function(e,t,_,r){switch(e+=_,t){case"GLOW":e+="11";case"COLOR_ID":case"SHADOW":e+="00";default:e+="10"}return r&&r.vc_name&&(e+=r.vc_name),r&&r.uv_name&&(e+=r.uv_name),e},t.compose_node_elements=function(e){var t=[],_={};oe();var r=Je.topsort(e);return Je.traverse(r,function(e,r){var a=he(r);t.push(a),_[e]=a}),Je.traverse_edges(r,function(e,t,a){var n=Je.get_node_attr(r,e),o=n.outputs[a[0]],i=_[e].outputs,s=_[t].inputs,E=i[a[0]]||Ee("out_"+n.type+"_"+Ye(o.identifier));i[a[0]]=E,s[a[1]]=E}),t},t.check_material_glow_output=function(e){if(e.node_tree)for(var t=0;t<e.node_tree.nodes.length;t++){var _=e.node_tree.nodes[t];if("GROUP"==_.type&&"B4W_GLOW_OUTPUT"==_.node_tree_name)return!0}return!1},t.print_node_graph=Xe,t.cleanup=He,t.get_max_env_texture_height=Qe}var a=_(0),n=_(5),o=_(4),i=_(87),s=_(31),E=_(27),c=_(21),l=_(1),T=_(34),d=_(2),u=_(3),f=_(17),P=Object(a.a)("__nodemat",r);t.a=P},function(e,t,_){"use strict";function r(e,t){var _=Object(n.a)(e),r=[],a={},i=["color: #3366FF","color: #CC33FF","color: #FF3366","color: #33FF66","color: #FFCC33"];t.fbmsg=function(){for(var e=[performance.now()],t=0;t<arguments.length;t++){var _=arguments[t];if(o._15(_))for(var a=0;a<_.length;a++)e.push(_[a]);else e.push(arguments[t])}r.push(e)},t.msg=function(){for(var e=1,t=0;t<r.length;t++){var _=r[t];_[1]==arguments[0]&&e++}for(var _=[e],t=0;t<arguments.length;t++){var a=arguments[t];if(o._15(a))for(var n=0;n<a.length;n++)_.push(a[n]);else _.push(arguments[t])}r.push(_)},t.print_telemetry=function(e){e||(e=1);for(var t=0,a={},n=Math.max(0,performance.now()-1e3*e),o=0;o<r.length;o++){var s=r[o];if(!((e=s[0])<n)){var E=String(s[1]);a[E]||(a[E]=i[t++%i.length]);for(var c=a[E],l=["%c"+(e/1e3).toFixed(6),c,E],T=2;T<s.length;T++)l.push(s[T]);_.log.apply(this,l)}}r.splice(0)},t.plot_telemetry=function(e){e||(e=1);for(var t={},a=Math.max(0,performance.now()-1e3*e),n=0;n<r.length;n++){var o=r[n];if(!((e=o[0])<a))for(var i=2;i<o.length;i++){var s=String(o[1]);o.length>3&&(s+="_"+String(i-2)),t[s]||(t[s]=s+"\n"),t[s]+=String(e)+" "+o[i]+"\n"}}var E="";for(var s in t)E+=t[s]+"\n\n";_.log(E),r.splice(0)},t.exec_count=function(e){e in a?a[e]+=1:a[e]=1},t.update=function(){for(var e in a)_.log(e,a[e]),a[e]=0}}var a=_(0),n=_(1),o=_(2),i=Object(a.a)("__debug_telemetry",r);t.a=i},function(e,t,_){"use strict";function r(e,t){function _(e,t,_,r){for(var a=[],n=[],o=[],i=e*t,E=2*_/(e-1),c=2*r/(t-1),l=0;l<e;l++)for(var T=l*E-_,u=0;u<t;u++){var f=u*c-r;if(n.push(T,f,0),o.push(l/(e-1),u/(t-1)),l&&u){var P=l*t+u,A=P-1,S=(l-1)*t+u,p=S-1;a.push(P,A,S),a.push(A,p,S)}}var O=d.create_empty_va_frame();O.a_position=new Float32Array(n),O.a_tbn=s.c(i);var v=d.init_submesh("GRID_PLANE");return v.va_frames[0]=O,v.va_common.a_texcoord=new Float32Array(o),v.indices=new Uint32Array(a),v.base_length=n.length/3,v}function r(e){var t=e.length;t%4&&l.panic("Wrong array");for(var _=[],r=[],a=0;a<t;a+=4){var n=e[a],o=e[a+1],i=e[a+2],E=e[a+3];c(n,r),c(o,r),c(i,r),c(E,r),_.push(a,a+1,a+2),_.push(a,a+2,a+3)}var T=d.create_empty_va_frame();T.a_position=new Float32Array(r),T.a_tbn=s.c(t/4);var u=d.init_submesh("FROM_QUADS");return u.va_frames[0]=T,u.indices=new Uint32Array(_),u.base_length=r.length/3,u}function a(e,t){var _=3*t;return[e[_],e[_+1],e[_+2]]}function c(e,t){t.push(e[0],e[1],e[2])}var l=Object(n.a)(e),T=Object(o.a)(e),d=Object(i.a)(e),u=T.defaults;t.generate_line=function(){var e=d.init_submesh("LINE"),t=d.create_empty_va_frame();return t.a_position=new Float32Array(3),t.a_direction=new Float32Array(3),e.va_frames[0]=t,e.indices=new Uint32Array(1),e.base_length=1,e},t.generate_plane=function(e,t){var r=_(2,2,e,t);return r.name="PLANE",r},t.generate_grid=_,t.generate_cascaded_grid=function(e,t,_){function r(e,t){return e%2==1&&(0==t||t==E-1)||t%2==1&&(0==e||e==i-1)}for(var a=_/Math.pow(2,e-1),n=a,o=a,i=t+1,E=t+1,c=[],l=[],T=0,f=0,P=0,A=-1,S=[],p=0;p<e;p++){for(var O=2*n/(i-1),v=2*o/(E-1),m=[],N=[],g=0,R=0;R<i;R++){for(var I=R*O-n,b=[],h=0;h<E;h++){var Y=h*v-o;if(I>-f&&I<f&&Y>-P&&Y<P)b.push(-1),g++;else{for(var L=null,M=0;M<S.length;M+=3)if(I==S[M]&&Y==S[M+1]){L=S[M+2];break}if(null!==L)var x=L;else var x=A+1;if(r(R,h))b.push(-2),g++;else{if(null==L){if(0==h||h==E-1||0==R||R==i-1){if(p==e-1)var y=O;else var y=2*O;m.push(I,Y,x)}else var y=O;l.push(I,Y,y),T++,A++}b.push(x)}if(R&&h)if(1==R){if(r(R-1,h))if(h>1){var U=x-1,w=N[R-1][h+1],C=w-1;c.push(C,U,x),c.push(w,C,x)}else{var w=N[R-1][h+1],C=w-1;c.push(w,C,x)}else if(!r(R,h)){var U=x-1,w=N[R-1][h];c.push(w,U,x)}}else if(R==i-1){if(!r(R,h))if(h==E-1){var U=x-1,w=N[R-1][h-1],C=N[R-2][h];c.push(w,U,x),c.push(C,w,x)}else{var U=x-1,w=N[R-1][h],C=w-1,D=w+1;c.push(C,U,x),c.push(w,C,x),c.push(D,w,x),2==h&&(D=N[R-2][h-2],c.push(C,D,U))}}else if(1==h)if(r(R,h-1)){var U=N[R-1][h],w=N[R-1][h-1];c.push(U,w,x)}else{var U=b[h-1],w=N[R-1][h],C=N[R-2][h-1];c.push(w,U,x),c.push(w,C,U)}else if(h==E-1){if(!r(R,h)){var U=b[h-1],w=N[R-1][h-1],C=N[R-2][h];c.push(w,U,x),c.push(C,w,x)}}else if(-1!=N[R-1][h]&&-1!=N[R-1][h-1]&&-1!=b[h-1]){var U=b[h-1],w=N[R-1][h],C=N[R-1][h-1];if(c.push(w,U,x),c.push(w,C,U),h==E-2&&r(R,h+1)){var D=N[R-1][h+1];c.push(D,w,x)}}else if(h==E-2&&r(R,h+1)){var w=N[R-1][h],D=N[R-1][h+1];c.push(D,w,x)}}}N.push(b)}S=m,f=n,P=o,n*=2,o*=2}if(f<2e4){var F=-2*f/(i-1);l.push(-2e4,-2e4,F),l.push(-2e4,2e4,F),l.push(-f,-P,F),l.push(-f,P,F),l.push(2e4,-2e4,F),l.push(2e4,2e4,F),l.push(f,-P,F),l.push(f,P,F);var x=A+1;c.push(x+1,x+2,x+3,x+1,x+0,x+2,x+2,x+4,x+6,x+2,x+0,x+4,x+1,x+7,x+5,x+1,x+3,x+7,x+7,x+4,x+5,x+6,x+4,x+7),T+=8}var G=d.create_empty_va_frame();G.a_position=new Float32Array(l),G.a_tbn=s.c(T),s.j(G.a_tbn,[.707,0,0,.707],G.a_tbn);var k=d.init_submesh("MULTIGRID_PLANE");return k.va_frames[0]=G,k.indices=new Uint32Array(c),k.base_length=l.length/3,u.water_wireframe_debug&&(d.submesh_drop_indices(k,1,!0),G.a_polyindex=d.extract_polyindices(k)),k},t.generate_from_triangles=function(e){var t=e.length;t%3&&l.panic("Wrong array");for(var _=[],r=[],a=0;a<t;a+=3){var n=e[a],o=e[a+1],i=e[a+2];c(n,r),c(o,r),c(i,r),_.push(a,a+1,a+2)}var s=d.create_empty_va_frame();s.a_position=new Float32Array(r);var E=d.init_submesh("FROM_TRIANGLES");return E.va_frames[0]=s,E.indices=new Uint32Array(_),E.base_length=r.length/3,E},t.generate_from_quads=r,t.generate_frustum=function(e){e=E._68(e,[]);var t=[];t.push(e[0],e[1],e[2],e[3]),t.push(e[0],e[3],e[5],e[4]),t.push(e[3],e[2],e[6],e[5]),t.push(e[1],e[7],e[6],e[2]),t.push(e[0],e[4],e[7],e[1]),t.push(e[4],e[5],e[6],e[7]);var _=r(t);return _.name="FRUSTUM",_},t.generate_fullscreen_tri=function(){var e=d.init_submesh("FULLSCREEN_TRI"),t=d.create_empty_va_frame();return t.a_position=new Float32Array([0,0,1,0,0,1]),e.va_frames[0]=t,e.indices=new Uint32Array([0,1,2]),e.base_length=3,e},t.generate_fullscreen_quad=function(){var e=d.init_submesh("FULLSCREEN_QUAD"),t=d.create_empty_va_frame();return t.a_position=new Float32Array([-1,1,1,1,-1,-1,1,-1]),e.va_frames[0]=t,e.indices=new Uint32Array([0,2,1,1,2,3]),e.base_length=4,e},t.generate_billboard=function(){var e=d.init_submesh("BILLBOARD"),t=d.create_empty_va_frame();return t.a_bb_vertex=d.gen_bb_vertices(1),e.va_frames[0]=t,e.indices=new Uint32Array([0,2,1,0,3,2]),e.base_length=4,e},t.generate_uv_sphere=function(e,t,_,r,n,o){var i,E,l=d.init_submesh("UV_SPHERE"),T=[],u=[],f=[];for(E=0;E<=t;E++)for(i=0;i<=e;i++){var P=i/e,A=E/t,S=-_*Math.cos(2*P*Math.PI)*Math.sin(A*Math.PI),p=_*Math.cos(A*Math.PI),O=_*Math.sin(2*P*Math.PI)*Math.sin(A*Math.PI);if(n){S=Math.abs(S)<1e-5?0:S,p=Math.abs(p)<1e-5?0:p,O=Math.abs(O)<1e-5?0:O}u.push(S+r[0],p+r[1],O+r[2])}var v=0;for(E=0;E<t;E++)for(i=0;i<e;i++){var m=a(u,(e+1)*E+i+1),N=a(u,(e+1)*E+i),g=a(u,(e+1)*(E+1)+i),R=a(u,(e+1)*(E+1)+i+1);Math.abs(m[1])==_+r[1]?(c(m,T),c(g,T),c(R,T),o?f.push(v,v+1,v+1,v+2,v+2,v):f.push(v,v+1,v+2),v+=3):Math.abs(g[1])==_+r[1]?(c(m,T),c(N,T),c(g,T),o?f.push(v,v+1,v+1,v+2,v+2,v):f.push(v,v+1,v+2),v+=3):(c(m,T),c(N,T),c(g,T),c(R,T),o?(f.push(v,v+1),f.push(v+1,v+2),f.push(v+2,v+3),f.push(v+3,v)):(f.push(v,v+1,v+2),f.push(v,v+2,v+3)),v+=4)}var I={};if(I.a_position=T,o)I.a_tbn=s.c();else{var b=d.calc_shared_indices(f,u,T),h=d.calc_normals(f,T,b);I.a_tbn=s.d(h)}return l.va_frames[0]=I,l.indices=f,l.base_length=T.length/3,l},t.generate_index=function(e){var t=d.init_submesh("INDEX"),_=d.create_empty_va_frame();_.a_index=new Float32Array(3*e);for(var r=new Uint16Array(3*e),a=0;a<3*e;a++)_.a_index[a]=a,r[a]=a;return t.va_frames[0]=_,t.indices=r,t.base_length=3*e,t}}var a=_(0),n=_(5),o=_(4),i=_(20),s=_(36),E=_(2),c=Object(a.a)("__primitives",r);t.a=c},function(e,t,_){"use strict";function r(e,t){function _(e,t){var _=[];q.traverse_edges(e,function(t,r,a){var n=a;_.indexOf(n)>-1?q.replace_edge_attr(e,t,r,n,y(n)):_.push(n)}),q.traverse(e,function(e,r){for(var a=r,n=0;n<a.slinks_internal.length;n++){var o=a.slinks_internal[n];t||a.type!=J.MAIN_PLANE_REFLECT&&a.type!=J.MAIN_CUBE_REFLECT&&a.type!=J.MAIN_XRAY||(o.use_renderbuffer=!0),_.indexOf(o)>-1?a.slinks_internal[n]=y(o):_.push(o)}})}function r(e,t){q.traverse(e,function(_,r){r.type==J.ANTIALIASING&&q.traverse_inputs(e,_,function(e,t,_){var r=t;if(r.type==J.MOTION_BLUR)for(var a=0;a<r.slinks_internal.length;a++){var n=r.slinks_internal[a];n.min_filter=Z.TF_LINEAR,n.mag_filter=Z.TF_LINEAR}}),t||q.traverse_inputs(e,_,function(e,t,_){var r=_;"DEPTH"==r.from&&(r.use_renderbuffer=!0)})}),q.traverse(e,function(t,_){var r={};a(e,t,r);for(var n in r){for(var o=r[n],i=o[0],s=0;s<o.length;s++)if(o[s].min_filter==Z.TF_LINEAR){i=o[s];break}for(var E=o[0],s=0;s<o.length;s++)if(o[s].mag_filter==Z.TF_LINEAR){E=o[s];break}for(var c=o[0],s=0;s<o.length;s++)if(!o[s].use_renderbuffer){c=o[s];break}for(var s=0;s<o.length;s++)o[s].min_filter=i.min_filter,o[s].mag_filter=E.mag_filter,o[s].use_renderbuffer=c.use_renderbuffer}})}function a(e,t,_){q.traverse_inputs(e,t,function(t,r,n){var o=n;o.active&&o.from==o.to&&(_[o.from]=_[o.from]||[],-1==_[o.from].indexOf(o)&&_[o.from].push(o),a(e,t,_))}),q.traverse_outputs(e,t,function(e,t,r){var a=r;a.active&&(_[a.from]=_[a.from]||[],-1==_[a.from].indexOf(a)&&_[a.from].push(a))});var r=q.get_node_attr(e,t);if(r.type==J.MOTION_BLUR)for(var n=0;n<r.slinks_internal.length;n++){var o=r.slinks_internal[n];_[o.from].push(o)}}function P(e){var t=[J.MOTION_BLUR,J.SMAA_RESOLVE,J.SMAA_NEIGHBORHOOD_BLENDING,J.MAIN_PLANE_REFLECT,J.MAIN_CUBE_REFLECT,J.PERFORMANCE];ee.webgl2||t.push(J.AVERAGE_LUMINANCE);var _=q.topsort(e),r=[];q.traverse(_,function(e,a){for(var n=a,o=0;o<n.slinks_internal.length;o++){var i=n.slinks_internal[o];t.indexOf(n.type)>-1&&(i.unique_texture=!0);var s=v(r,i,A(i));i.texture=s,n.textures_internal[o]=s}for(var o=0;o<n.textures_internal.length;o++){var s=n.textures_internal[o];O(r,s)}q.traverse_outputs(_,e,function(a,o,i){var s=i;if(!s.texture){if(t.indexOf(n.type)>-1)s.unique_texture=!0;else{var E=S(_,e,s.from);if(E&&s.active&&!s.texture)return p(r,E),void(s.texture=E)}E=v(r,s,A(s)),s.texture=E}}),q.traverse_inputs(_,e,function(e,t,_){O(r,_.texture)}),q.traverse_outputs(_,e,function(e,t,_){var a=_;a.texture&&"NONE"==a.to&&O(r,a.texture)})})}function A(e){var t=e.to,_=e.active,r=e.texture;e.to="",e.active=!1,e.texture=null;var a=V.calc_variable_id(e,0);return e.to=t,e.active=_,e.texture=r,a}function S(e,t,_){var r=null;return q.traverse_inputs(e,t,function(e,t,a){var n=a;if(n.active&&n.from==n.to&&n.from==_&&n.texture)return r=n.texture,!0}),q.traverse_outputs(e,t,function(e,t,a){var n=a;if(n.active&&n.from==_&&n.texture)return r=n.texture,!0}),r}function p(e,t){for(var _=0;_<e.length;_++){var r=e[_];r.tex===t&&r.ref++}}function O(e,t){for(var _=0;_<e.length;_++){var r=e[_];r.tex===t&&r.ref&&r.ref--}}function v(e,t,_){if(t.parent_slink)return p(e,t.parent_slink.texture),t.parent_slink.texture;if(t.unique_texture)return m(t);for(var r=null,a=0;a<e.length;a++){var n=e[a];if(n.id==_&&0===n.ref){r=n;break}}if(!r||_e||ee.firefox_tex_reuse_hack){var o=m(t);return e.push({id:_,ref:1,tex:o}),o}return r.ref++,r.tex}function m(e){var t=e.size_mult_x*e.size,_=e.size_mult_y*e.size,r=e.use_comparison,a=e.use_mipmap;switch(e.from){case"COLOR":if(e.use_renderbuffer){var n=Z.create_texture(e.multisample?Z.TT_RB_RGBA_MS:Z.TT_RB_RGBA,r,a);Z.resize(n,t,_)}else{if(e.floating_point)var n=Z.create_texture(Z.TT_RGBA_FLOAT,r,a);else var n=Z.create_texture(Z.TT_RGBA_INT,r,a);Z.resize(n,t,_),Z.set_filters(n,e.min_filter,e.mag_filter)}return n;case"DEPTH":if(e.use_renderbuffer){var n=Z.create_texture(e.multisample?Z.TT_RB_DEPTH_MS:Z.TT_RB_DEPTH,r,a);Z.resize(n,t,_)}else{var n=Z.create_texture(Z.TT_DEPTH,r,a);Z.resize(n,t,_),Z.set_filters(n,e.min_filter,e.mag_filter)}return n;case"CUBEMAP":var n=Z.create_cubemap_texture(t,a);return n;case"SCREEN":case"NONE":return null;default:X.panic("Wrong slink param: "+e.from)}}function N(e,t){var _=!1;q.traverse_edges(e,function(r,a,n){var o=n;if(o){var i=q.get_node_attr(e,r),s=q.get_node_attr(e,a);return t(o,!1,i,s)?(_=!0,!0):void 0}}),_||q.traverse(e,function(e,_){for(var r=_,a=0;a<r.slinks_internal.length;a++){var n=r.slinks_internal[a];if(t(n,!0,r,null))return!0}})}function g(e){q.traverse(e,function(t,_){if(_.type!=J.SINK){var r=_.camera;q.traverse_outputs(e,t,function(e,t,_){_.texture&&_.active&&_.texture&&(H.set_attachment(r,_.from,_.texture),_.from==_.to&&t.camera&&H.set_attachment(t.camera,_.from,_.texture))});for(var a=0;a<_.slinks_internal.length;a++){var n=_.slinks_internal[a];if(n.active&&n.from==n.to){var o=_.textures_internal[a];H.set_attachment(r,n.from,o)}}!r.color_attachment&&!r.depth_attachment||r.framebuffer||(r.framebuffer=W.render_target_create(r.color_attachment,r.depth_attachment))}}),q.traverse(e,function(t,_){if(_.type==J.RESOLVE||_.type==J.COPY){var r=D(e,_);_.camera.framebuffer_prev=r[0].camera.framebuffer}})}function R(e){var t=null,_=0;return q.traverse(e,function(e,r){if(r.type==$.subs_type){if(_==$.subs_number)return t=r,!0;_++}}),t}function I(e,t){var _=q.node_by_attr(e,t),r=J.create_subs_postprocessing("NONE"),a=q.append_node_attr(e,r),n=q.get_sink_nodes(e)[0];q.traverse_edges(e,function(t,_,r){_==n&&q.reconnect_edges(e,t,n,t,a)});var o=b(t,e);q.traverse_edges(e,function(a,n,i){if(a==_){if(o){var s=J.create_subs_resolve();q.append_node_attr(e,s);var E=x("COLOR","RESOLVE",1,1,1,!0,!0);E.multisample=!0,E.use_renderbuffer=!0;var c=x("DEPTH","RESOLVE",1,1,1,!0,!0);c.multisample=!0,c.use_renderbuffer=!0,q.append_edge_attr(e,t,s,E),q.append_edge_attr(e,t,s,c),t=s}return q.append_edge_attr(e,t,r,x($.slink_type,"u_color",i.size,i.size_mult_x,i.size_mult_y,i.update_dim,i.apply_resolution_factors)),!0}}),q.append_edge(e,a,n,x("SCREEN","NONE",.5,.5,.5,!0,!0))}function b(e,t){var _=!1,r=q.node_by_attr(t,e);if(q.out_edge_count(t,r)){var a=q.get_out_edge(t,r,0),n=q.get_edge_attr(t,r,a,0);if("COLOR"==n.from&&"COLOR"==n.to||"DEPTH"==n.from&&"DEPTH"==n.to){_=b(q.get_node_attr(t,a),t)}else _="RESOLVE"==n.to}return _}function h(e,t,_,r){var a=_.cameras,n=t.hmd_stereo_use,o=t.anaglyph_use,i=t.reflection_params.plane_refl_subs,s=t.reflection_params.plane_refl_subs_blend,E=q.get_node_id(e,r),c=r,l=q.subgraph_node_conn(e,E,q.BACKWARD_DIR),T=[],d=[],u=[],f=function(t){var r;if(re.indexOf(t.type)>-1)d.push(t),r=t;else{if(r=J.clone_subs(t),r.type==J.MAIN_PLANE_REFLECT)for(var o=0;o<i.length;o++)if(i[o][0]==t){i[o]=[t,r],r.camera.reflection_plane=t.camera.reflection_plane,_.cameras.push(r.camera);break}if(t.type==J.MAIN_PLANE_REFLECT_BLEND){for(var o=0;o<i.length;o++)if(s[o][0]==t){s[o]=[t,r],r.camera=i[o][1].camera;break}}else a.indexOf(t.camera)>-1&&(n?(H.make_stereo(t.camera,H.TYPE_HMD_LEFT),H.make_stereo(r.camera,H.TYPE_HMD_RIGHT),r.force_do_not_render=!0):(H.make_stereo(t.camera,H.TYPE_STEREO_LEFT),H.make_stereo(r.camera,H.TYPE_STEREO_RIGHT)),a.push(r.camera));var E=q.node_by_attr(e,t);if(q.traverse_inputs(e,E,function(e,t,_){re.indexOf(t.type)>-1&&T.push([t,r,_])}),t.type!==J.MOTION_BLUR)for(var o=0;o<t.slinks_internal.length;o++)r.slinks_internal[o].parent_slink=t.slinks_internal[o];for(var c=!0,o=0;o<q.in_edge_count(e,E);o++){var l=q.get_in_edge(e,E,o),f=q.get_node_attr(e,l);-1==re.indexOf(f.type)&&(c=!1)}c&&u.push(r)}return r},P=function(e){var t=y(e,!0);return t.parent_slink=e,t};l=q.clone(l,f,P);for(var A=0;A<d.length;A++)q.remove_node(l,q.node_by_attr(l,d[A]));q.cleanup_loose_edges(l);var S=J.create_subs_stereo(n,o),p=q.append_node_attr(e,S);if(ee.ios_copy_tex_hack)var O=J.create_subs_postprocessing("NONE"),v=x("COLOR","u_color",1,1,1,!0,!0);else var O=J.create_subs_copy(),v=x("COLOR","COPY",1,1,1,!0,!0);v.min_filter=Z.TF_LINEAR,v.mag_filter=Z.TF_LINEAR,q.append_node_attr(e,O),q.append_edge_attr(e,c,O,v);var m=x("COLOR","u_sampler_left",1,1,1,!0,!0);if(m.unique_texture=!0,m.min_filter=Z.TF_LINEAR,m.mag_filter=Z.TF_LINEAR,q.append_edge_attr(e,O,S,m),!c.is_pp){if(ee.ios_copy_tex_hack)var N=J.create_subs_postprocessing("NONE"),g=x("COLOR","u_color",1,1,1,!0,!0);else var N=J.create_subs_copy(),g=x("COLOR","COPY",1,1,1,!0,!0);q.append_node_attr(l,N),g.parent_slink=v;var R=q.get_sink_nodes(l)[0],I=q.get_node_attr(l,R);q.append_edge_attr(l,I,N,g)}var b=x("COLOR","u_sampler_right",1,1,1,!0,!0);c.is_pp&&(b.parent_slink=v),b.min_filter=Z.TF_LINEAR,b.mag_filter=Z.TF_LINEAR,q.append_subgraph(l,e,[q.get_sink_nodes(l)[0],p,b]);for(var A=0;A<T.length;A++){var h=T[A][0],Y=T[A][1],L=T[A][2];q.append_edge_attr(e,h,Y,L)}for(var M=x("SCREEN","NONE",0,0,0,!1,!1),A=0;A<u.length;A++)q.append_edge_attr(e,O,u[A],M);return q.traverse_edges(e,function(t,_,r){q.get_node_attr(e,t).type===J.MOTION_BLUR&&(r.parent_slink=null)}),S}function Y(e,t,_){var r=[];q.traverse(e,function(t,_){if(-1==re.indexOf(_.type)&&_.slinks_internal.length&&w(e,_,J.STEREO))for(var a=0;a<_.slinks_internal.length;a++){var n=_.slinks_internal[a];-1==r.indexOf(n)&&r.push(n)}}),q.traverse_edges(e,function(t,_,a){var n=q.get_node_attr(e,t),o=q.get_node_attr(e,_);-1==re.indexOf(n.type)&&w(e,o,J.STEREO)&&-1==r.indexOf(a)&&r.push(a)});for(var a=0;a<r.length;a++)r[a].size_mult_x*=t,r[a].size_mult_y*=_}function L(e,t,_){var r=e.texel_size_multiplier;e.texel_size[0]=t*e.texel_mask[0]*r,e.texel_size[1]=_*e.texel_mask[1]*r}function M(e,t){e.texel_size_multiplier=t}function x(e,t,_,r,a,n,o){return{from:e,to:t,size:_,size_mult_x:r,size_mult_y:a,update_dim:n,apply_resolution_factors:o,active:!0,texture:null,multisample:!1,floating_point:!1,use_renderbuffer:!1,min_filter:Z.TF_NEAREST,mag_filter:Z.TF_NEAREST,unique_texture:!1,use_comparison:!1,use_mipmap:!1}}function y(e,t){var _=x(e.from,e.to,e.size,e.size_mult_x,e.size_mult_y,e.update_dim,e.apply_resolution_factors);return _.active=e.active,!t&&e.texture&&X.panic("Failed to clone slink with attached texture"),_.texture=e.texture,_.multisample=e.multisample,_.use_renderbuffer=e.use_renderbuffer,_.min_filter=e.min_filter,_.mag_filter=e.mag_filter,_.unique_texture=e.unique_texture,_.use_comparison=e.use_comparison,_.use_mipmap=e.use_mipmap,_}function U(e,t){for(var _=0,r=D(e,t),a=0,n=0;n<r.length;n++){var o=r[n];if(o.type==J.SHADOW_CAST){a++,t.p_light_matrix=t.p_light_matrix||new Array;var i=o.shadow_lamp_index>0?o.shadow_lamp_index:_;t.p_light_matrix[i]=o.camera.proj_matrix,_++}}t.v_light_ts&&t.v_light_r||(ee.mac_os_shadow_hack?t.v_light_tsr=new Float32Array(9*a):(t.v_light_ts=new Float32Array(4*a),t.v_light_r=new Float32Array(4*a)))}function w(e,t,_){if(t.type==_)return!0;for(var r=F(e,t),a=0;a<r.length;a++)if(w(e,r[a],_))return!0;return!1}function C(e,t,_){if(t.type==_)return!0;for(var r=D(e,t),a=0;a<r.length;a++)if(C(e,r[a],_))return!0;return!1}function D(e,t){var _=q.node_by_attr(e,t);_==q.NULL_NODE&&X.panic("Subscene not in graph");for(var r=[],a=q.in_edge_count(e,_),n=0;n<a;n++){var o=q.get_in_edge(e,_,n);o!=_&&r.push(q.get_node_attr(e,o))}return r}function F(e,t){var _=q.node_by_attr(e,t);_==q.NULL_NODE&&X.panic("Subscene not in graph");for(var r=[],a=q.out_edge_count(e,_),n=0;n<a;n++){var o=q.get_out_edge(e,_,n);o!=_&&r.push(q.get_node_attr(e,o))}return r}function G(e){var t=[],_=[];return N(e,function(e,r,a,n){if(e.texture){-1==t.indexOf(e.texture)&&(t.push(e.texture),_.push(e.texture,t.length-1))}}),_}function k(e,t,_){var r=J.subs_label(t);if(t.camera){r+="\\n";for(var a=0;a<_.length;a+=2){var n=t.camera.color_attachment;_[a]==n&&(Z.is_renderbuffer(n)?r+="CR"+_[a+1]+" ":r+="C"+_[a+1]+" ")}for(var a=0;a<_.length;a+=2){var o=t.camera.depth_attachment;_[a]==o&&(Z.is_renderbuffer(o)?r+="DR"+_[a+1]:r+="D"+_[a+1])}}t.slinks_internal.length&&(r+="\\n-----\\n");for(var a=0;a<t.slinks_internal.length;a++)r+=B(t.slinks_internal[a],e,null,_);if(t.type==J.SINK)var i="dotted";else if(t.enqueue)var i="solid";else var i="dashed";return i+=",bold",String(e)+' [label="'+r+'" color="black" style="'+i+'"];\n'}function K(e,t,_,r){var a=B(_,e,t,r);if(_.active)var n="solid";else var n="dotted";return String(e)+" -> "+String(t)+' [label="'+a+'" style="'+n+'"];\n'}function B(e,t,_,r){var a="";if(a+=e.from+"\\n",a+="NONE"!=e.to?e.to+"\\n":"",a+="(",e.update_dim){var n=e.size_mult_x,o=e.size_mult_y;Math.round(n)!=n&&(n=n.toFixed(2)),Math.round(o)!=o&&(o=o.toFixed(2));a+=(1==n?"":n)+"S"+"x"+((1==o?"":o)+"S"),a+=e.apply_resolution_factors?" FACT":" VIEW"}else{var n=e.size_mult_x,o=e.size_mult_y;a+=e.size*n+"x"+e.size*o}if("SCREEN"!=e.from){a+=" ",e.use_renderbuffer?a+="RR":a+=function(e){var t="";return e.min==Z.TF_LINEAR?t+="L":e.min==Z.TF_NEAREST&&(t+="N"),e.mag==Z.TF_LINEAR?t+="L":e.mag==Z.TF_NEAREST&&(t+="N"),t}({min:e.min_filter,mag:e.mag_filter});for(var i=0;i<r.length;i+=2)r[i]==e.texture&&(a+=" "+r[i+1])}return a+=")\\n"}var X=Object(n.a)(e),H=Object(o.a)(e),j=Object(i.a)(e),Q=Object(s.a)(e),z=Object(E.a)(e),V=Object(c.a)(e),q=Object(l.a)(e),W=Object(T.a)(e),J=Object(d.a)(e),Z=Object(u.a)(e),$=j.debug_subs,ee=j.defaults,te=j.scenes,_e=!1,re=[J.GRASS_MAP,J.SHADOW_CAST,J.MAIN_CUBE_REFLECT,J.MAIN_CUBE_REFLECT_BLEND];t.check_slink_tex_conn=function(e){switch(e.to){case"COLOR":case"CUBEMAP":case"DEPTH":case"SCREEN":case"OFFSCREEN":case"RESOLVE":case"COPY":case"NONE":return!1;default:return!0}},t.traverse_slinks=N,t.create_rendering_graph=function(e,t,a,n){var o=q.create(),i=[],s=[],E=[],c=[],l=[],T=[],d=[],u=[],A=[],S=e.lamps_number,p=e.water_params,O=e.shore_smoothing,v=e.soft_particles,m=e.ssao,N=e.god_rays,b=e.reflection_params,Y=e.materials_params,L=e.bloom_params,w=e.motion_blur,C=e.compositing,D=e.antialiasing,G=e.world_light_set,k=e.world_fog_set,K=e.shadow_params,B=e.mb_params,X=e.cc_params,j=e.god_rays_params,V=e.outline_params,W=e.dof,_e=e.depth_tex,re=e.refractions,ae=Boolean(n.length),ne=ee.msaa_samples>1;ee.reuse_depth_optimization=ee.reuse_depth_optimization&&Boolean(K)&&!(ne&&m);var oe=ee.reuse_depth_optimization,ie=x("COLOR","COLOR",1,1,1,!0,!0),se=x("DEPTH","DEPTH",1,1,1,!0,!0);if(ne){var Ee=y(se);ie.multisample=!0,ie.use_renderbuffer=!0,se.multisample=!0,se.use_renderbuffer=!0}var ce=t.cameras[0];if(e.dynamic_grass){var le=J.create_subs_grass_map();q.append_node_attr(o,le);var Te=te.grass_tex_size;le.camera.width=Te,le.camera.height=Te;var de=x("DEPTH","u_grass_map_depth",Te,1,1,!1,!1);ee.webgl2||(de.min_filter=Z.TF_LINEAR,de.mag_filter=Z.TF_LINEAR);var ue=x("COLOR","u_grass_map_color",Te,1,1,!1,!1);ue.min_filter=Z.TF_LINEAR,ue.mag_filter=Z.TF_LINEAR}else var le=null,de=null,ue=null;if(K){H.update_camera_shadows(ce,K);for(var fe=0;fe<K.lamp_types.length;fe++)for(var Pe=K.csm_num,Ae=0;Ae<Pe;Ae++){var Se=J.create_subs_shadow_cast(Ae,fe,K,S);q.append_node_attr(o,Se),E.push(Se);var Te=K.csm_resolution,pe=Se.camera;t.shadow_cameras.push(pe),pe.width=Te,pe.height=Te,Se.clear_color=!0;var Oe=fe>0?fe:Ae;if(ee.rgba_fallback_shadows){var ve=x("COLOR","u_shadow_map"+Oe,Te,1,1,!1,!1);c.push(ve);var me=x("DEPTH","DEPTH",Te,1,1,!1,!1);me.use_renderbuffer=!0,Se.slinks_internal.push(me)}else{var Ne=x("DEPTH","u_shadow_map"+Oe,Te,1,1,!1,!1);ee.compared_mode_depth&&(Ne.min_filter=Z.TF_LINEAR,Ne.mag_filter=Z.TF_LINEAR,Ne.use_comparison=!0),c.push(Ne),(Q.depth_only_issue()||ee.shadows_color_slink_hack)&&Se.slinks_internal.push(x("COLOR","COLOR",Te,1,1,!1,!1))}le&&(q.append_edge_attr(o,le,Se,de),q.append_edge_attr(o,le,Se,ue))}}if(b&&b.num_cube_refl&&!ae)for(var Ae=0;Ae<b.num_cube_refl;Ae++){var pe=H.create_camera(H.TYPE_PERSP);pe.width=e.cubemap_refl_size,pe.height=e.cubemap_refl_size,H.set_frustum(pe,Math.PI/2,.1,100),H.set_projection(pe,!1);var ge=J.create_subs_main(J.MAIN_CUBE_REFLECT,pe,!1,p,S,k,G,null,e.sun_exist);ge.cube_view_matrices=f._6();for(var fe=0;fe<6;fe++)ge.cube_cam_frustums.push(H.create_frustum_planes());q.append_node_attr(o,ge);var Re=x("CUBEMAP","u_cube_reflection",e.cubemap_refl_size,1,1,!1,!1);if(Re.min_filter=Z.TF_LINEAR,Re.mag_filter=Z.TF_LINEAR,u.push(Re),!b.has_reflexible){var Ie=x("CUBEMAP","u_sky_reflection",1,1,1,!1);Ie.use_mipmap=!0,Ie.min_filter=Z.TF_LINEAR_MIPMAP_LINEAR,Ie.mag_filter=Z.TF_LINEAR,A.push(Ie)}if(le&&(q.append_edge_attr(o,le,ge,de),q.append_edge_attr(o,le,ge,ue)),b.has_blend_reflexible){var be=J.create_subs_main(J.MAIN_CUBE_REFLECT_BLEND,pe,!1,p,S,k,G,null,e.sun_exist);be.cube_view_matrices=ge.cube_view_matrices,be.cube_cam_frustums=ge.cube_cam_frustums,q.append_node_attr(o,be);var he=x("DEPTH","DEPTH",e.cubemap_refl_size,1,1,!1,!1),Ye=x("COLOR","COLOR",e.cubemap_refl_size,1,1,!1,!1);q.append_edge_attr(o,ge,be,he),q.append_edge_attr(o,ge,be,Ye),d.push(be),b.cube_refl_subs_blend.push(be),le&&(q.append_edge_attr(o,le,be,de),q.append_edge_attr(o,le,be,ue))}else{var Le=x("DEPTH","DEPTH",e.cubemap_refl_size,1,1,!1,!1);ge.slinks_internal.push(Le),d.push(ge)}b.cube_refl_subs.push(ge)}if(b&&b.refl_plane_objs.length>0&&!ae)for(var fe=0;fe<b.refl_plane_objs.length;fe++){var pe=H.clone_camera(ce,!0);pe.reflection_plane=new Float32Array(4),t.cameras.push(pe);var ge=J.create_subs_main(J.MAIN_PLANE_REFLECT,pe,!1,p,S,k,G,null,e.sun_exist);q.append_node_attr(o,ge);var Re=x("COLOR","u_plane_reflection",1,e.plane_refl_size,e.plane_refl_size,!0,!0);if(Re.min_filter=Z.TF_LINEAR,Re.mag_filter=Z.TF_LINEAR,T.push(Re),le&&(q.append_edge_attr(o,le,ge,de),q.append_edge_attr(o,le,ge,ue)),b.has_blend_reflexible){var be=J.create_subs_main(J.MAIN_PLANE_REFLECT_BLEND,pe,!1,p,S,k,G,null,e.sun_exist);q.append_node_attr(o,be);var he=x("DEPTH","DEPTH",1,e.plane_refl_size,e.plane_refl_size,!0,!0),Ye=x("COLOR","COLOR",1,e.plane_refl_size,e.plane_refl_size,!0,!0);Ye.min_filter=Z.TF_NEAREST,Ye.mag_filter=Z.TF_NEAREST,q.append_edge_attr(o,ge,be,he),q.append_edge_attr(o,ge,be,Ye),b.plane_refl_subs_blend.push([be]),l.push(be),le&&(q.append_edge_attr(o,le,be,de),q.append_edge_attr(o,le,be,ue))}else{var Le=x("DEPTH","DEPTH",1,e.plane_refl_size,e.plane_refl_size,!0,!0);ge.slinks_internal.push(Le),l.push(ge)}b.plane_refl_subs.push([ge])}if(K){var Me=H.clone_camera(ce,!0);t.cameras.push(Me);var xe=J.create_subs_shadow_receive(o,Me,S);q.append_node_attr(o,xe),xe.self_shadow_normal_offset=K.self_shadow_normal_offset;for(var Ae=0;Ae<E.length;Ae++){var Se=E[Ae],ye=c[Ae];q.append_edge_attr(o,Se,xe,ye)}if(oe){var Ne=x("DEPTH","DEPTH",1,1,1,!0,!0);if(ne){Ne.multisample=!0,Ne.use_renderbuffer=!0;var Ue=J.create_subs_resolve();q.append_node_attr(o,Ue);var we=x("COLOR","RESOLVE",1,1,1,!0,!0);we.multisample=!0,we.use_renderbuffer=!0;var Ce=x("DEPTH","RESOLVE",1,1,1,!0,!0);Ce.multisample=!0,Ce.use_renderbuffer=!0,q.append_edge_attr(o,xe,Ue,we),q.append_edge_attr(o,xe,Ue,Ce)}}else if(ne)var Ne=x("DEPTH","DEPTH",1,1,1,!0,!0);else if(ee.rgba_fallback_shadows){var Ne=x("DEPTH","DEPTH",1,1,1,!0,!0);Ne.use_renderbuffer=!0}else var Ne=se;if(m){var De=x("COLOR","u_color",1,1,1,!0,!0),Fe=x("DEPTH","u_depth",1,1,1,!0,!0),Ge=H.clone_camera(ce,!0);t.cameras.push(Ge);var ke=e.ssao_params,Ke=J.create_subs_ssao(Ge,k,ke);q.append_node_attr(o,Ke);var Be=x("COLOR","u_ssao_mask",1,1,1,!0,!0);q.append_edge_attr(o,xe,Ke,De),q.append_edge_attr(o,xe,Ke,Fe);var Xe=H.clone_camera(ce,!0);t.cameras.push(Xe);var He=J.create_subs_ssao_blur(Xe,ke);q.append_node_attr(o,He);var je=x("COLOR","u_shadow_mask",1,1,1,!0,!0);q.append_edge_attr(o,Ke,He,Be),q.append_edge_attr(o,xe,He,Fe)}le&&(q.append_edge_attr(o,le,xe,de),q.append_edge_attr(o,le,xe,ue))}else var xe=null;var Qe=J.create_subs_main(J.MAIN_OPAQUE,ce,!oe,p,S,k,G,null,e.sun_exist);if(q.append_node_attr(o,Qe),K&&(oe?q.append_edge_attr(o,xe,Qe,Ne):xe.slinks_internal.push(Ne)),ne){var ze=J.create_subs_resolve();q.append_node_attr(o,ze),s.push(ze);var Ve=x("COLOR","RESOLVE",1,1,1,!0,!0);Ve.multisample=!0,Ve.use_renderbuffer=!0;var qe=x("DEPTH","RESOLVE",1,1,1,!0,!0);qe.multisample=!0,qe.use_renderbuffer=!0,q.append_edge_attr(o,Qe,ze,Ve),q.append_edge_attr(o,Qe,ze,qe)}else s.push(Qe);if(xe)if(Be)q.append_edge_attr(o,He,Qe,je);else{var We=x("COLOR","u_shadow_mask",1,1,1,!0,!0);q.append_edge_attr(o,oe&&ne?Ue:xe,Qe,We)}if(le&&(q.append_edge_attr(o,le,Qe,de),q.append_edge_attr(o,le,Qe,ue)),l.length)for(var Je=l.length,fe=0;fe<Je;fe++)q.append_edge_attr(o,l[fe],Qe,T[fe]);if(d.length)for(var fe=0;fe<d.length;fe++)q.append_edge_attr(o,d[fe],Qe,u[fe]);if(i=s,s=[],!ae&&e.color_picking){var Ze=$.enabled&&($.subs_type===J.COLOR_PICKING||$.subs_type===J.COLOR_PICKING_XRAY),pe=H.clone_camera(ce,!0);Ze||(pe.width=pe.height=1),t.cameras.push(pe);var $e=J.create_subs_color_picking(pe,!1,S);if(q.append_node_attr(o,$e),e.xray){pe=H.clone_camera(ce,!0),Ze||(pe.width=pe.height=1),t.cameras.push(pe);var et=J.create_subs_color_picking(pe,!0,S);q.append_node_attr(o,et);var tt=x("COLOR","COLOR",1,1,1,Ze,!0);q.append_edge_attr(o,$e,et,tt);var _t=x("DEPTH","DEPTH",1,1,1,Ze,!0);q.append_edge_attr(o,$e,et,_t)}}else var $e=null;if(!Y.refractions&&!re||ae)var rt=null;else{if(ne)var rt=ze;else{if(ee.ios_copy_tex_hack)var rt=J.create_subs_postprocessing("NONE"),at=x("COLOR","u_color",1,1,1,!0,!0);else var rt=J.create_subs_copy(),at=x("COLOR","COPY",1,1,1,!0,!0);q.append_node_attr(o,rt),q.append_edge_attr(o,i[0],rt,at)}var nt=x("COLOR","u_refractmap",1,1,1,!0,!0)}if(_e&&(re||O||v)){var ot=H.clone_camera(ce,!0);t.cameras.push(ot);var it=J.create_subs_depth_pack(ot);q.append_node_attr(o,it);var st=x("DEPTH","u_depth",1,1,1,!0,!0);q.append_edge_attr(o,ne?ze:Qe,it,st);var Et=x("COLOR","u_scene_depth",1,1,1,!0,!0);Et.min_filter=Z.TF_NEAREST,Et.mag_filter=Z.TF_NEAREST}else var it=null;var ct=function(_){var r=H.clone_camera(ce,!0);t.cameras.push(r);var a=J.create_subs_main(_,r,!1,p,S,k,G,K,e.sun_exist);if(q.append_node_attr(o,a),_==J.MAIN_XRAY){var n=x("COLOR","COLOR",1,1,1,!0,!0);q.append_edge_attr(o,i[0],a,n);var s=x("DEPTH","DEPTH",1,1,1,!0,!0);a.slinks_internal.push(s)}else{if(ne&&i[0].type==J.RESOLVE)var f=Qe;else var f=i[0];q.append_edge_attr(o,Qe,a,se),q.append_edge_attr(o,f,a,ie)}le&&(q.append_edge_attr(o,le,a,de),q.append_edge_attr(o,le,a,ue));for(var P=0;P<E.length;P++){var A=E[P],O=c[P];q.append_edge_attr(o,A,a,O)}if(it&&q.append_edge_attr(o,it,a,Et),l.length)for(var v=l.length,P=0;P<v;P++)q.append_edge_attr(o,l[P],a,T[P]);if(d.length)for(var P=0;P<d.length;P++)q.append_edge_attr(o,d[P],a,u[P]);return rt&&q.append_edge_attr(o,rt,a,nt),a};if(e.glow_over_blend){var lt=ct(J.MAIN_BLEND);s.push(lt),i=s,s=[]}if(e.glow_materials){var Tt=H.clone_camera(ce,!0);t.cameras.push(Tt);var dt=J.create_subs_main(J.MAIN_GLOW,Tt,!1,p,S,k,G);if(q.append_node_attr(o,dt),it&&q.append_edge_attr(o,it,dt,Et),rt&&q.append_edge_attr(o,rt,dt,nt),le&&(q.append_edge_attr(o,le,dt,de),q.append_edge_attr(o,le,dt,ue)),l.length)for(var Je=l.length,fe=0;fe<Je;fe++)q.append_edge_attr(o,l[fe],dt,T[fe]);if(d.length)for(var fe=0;fe<d.length;fe++)q.append_edge_attr(o,d[fe],dt,u[fe]);e.glow_over_blend&&q.append_edge_attr(o,dt,lt,x("SCREEN","NONE",0,0,0,!1,!1)),q.append_edge_attr(o,ne?ze:Qe,dt,ne?Ee:se);var ut=J.create_subs_postprocessing("X_GLOW_BLUR");ut.subtype="GLOW_MASK_SMALL",M(ut,e.glow_params.small_glow_mask_width);var ft=x("COLOR","u_color",1,1,1,!0,!0);ft.min_filter=Z.TF_LINEAR,ft.mag_filter=Z.TF_LINEAR,q.append_node_attr(o,ut),q.append_edge_attr(o,dt,ut,ft);var Pt=J.create_subs_postprocessing("Y_GLOW_BLUR");Pt.subtype="GLOW_MASK_SMALL",M(Pt,e.glow_params.small_glow_mask_width);var At=x("COLOR","u_color",1,.5,.5,!0,!0);At.min_filter=Z.TF_LINEAR,At.mag_filter=Z.TF_LINEAR,q.append_node_attr(o,Pt),q.append_edge_attr(o,ut,Pt,At);var St=J.create_subs_postprocessing("X_GLOW_BLUR");St.subtype="GLOW_MASK_LARGE",M(St,e.glow_params.large_glow_mask_width);var pt=x("COLOR","u_color",1,.5,.5,!0,!0);pt.min_filter=Z.TF_LINEAR,pt.mag_filter=Z.TF_LINEAR,q.append_node_attr(o,St),q.append_edge_attr(o,Pt,St,pt);var Ot=J.create_subs_postprocessing("Y_GLOW_BLUR");Ot.subtype="GLOW_MASK_LARGE",M(Ot,e.glow_params.large_glow_mask_width);var vt=x("COLOR","u_color",1,.25,.25,!0,!0);vt.min_filter=Z.TF_LINEAR,vt.mag_filter=Z.TF_LINEAR,q.append_node_attr(o,Ot),q.append_edge_attr(o,St,Ot,vt);var mt=H.clone_camera(ce,!0);t.cameras.push(mt);var Nt=J.create_subs_glow_combine(mt,e);q.append_node_attr(o,Nt);var gt=x("COLOR","u_src_color",1,1,1,!0,!0);if(gt.min_filter=Z.TF_LINEAR,gt.mag_filter=Z.TF_LINEAR,e.glow_over_blend)if(ne){var Rt=J.create_subs_resolve();q.append_node_attr(o,Rt),q.append_edge_attr(o,lt,Rt,Ve),q.append_edge_attr(o,lt,Rt,qe),q.append_edge_attr(o,Rt,Nt,gt)}else q.append_edge_attr(o,lt,Nt,gt);else q.append_edge_attr(o,ne?ze:Qe,Nt,gt);var It=x("COLOR","u_glow_mask_small",1,.5,.5,!0,!0);It.min_filter=Z.TF_LINEAR,It.mag_filter=Z.TF_LINEAR,q.append_edge_attr(o,Pt,Nt,It);var bt=x("COLOR","u_glow_mask_large",1,.25,.25,!0,!0);bt.min_filter=Z.TF_LINEAR,bt.mag_filter=Z.TF_LINEAR,q.append_edge_attr(o,Ot,Nt,bt),i=[Nt],s=[]}if(!e.glow_over_blend){var lt=ct(J.MAIN_BLEND);s.push(lt),i=s,s=[]}if(ee.debug_view){var pe=H.clone_camera(ce,!0);t.cameras.push(pe);var ht=J.create_subs_debug_view(pe);s.push(ht),q.append_node_attr(o,ht),q.append_edge_attr(o,i[0],ht,ie),q.append_edge_attr(o,i[0],ht,se),le&&(q.append_edge_attr(o,le,ht,de),q.append_edge_attr(o,le,ht,ue)),z.set_debug_view_subs(ht),i=s,s=[]}if(ne){var Yt=J.create_subs_resolve();q.append_node_attr(o,Yt),s.push(Yt),q.append_edge_attr(o,i[0],Yt,Ve),q.append_edge_attr(o,i[0],Yt,qe),i=s,s=[]}var Lt=i.slice(0);if(!ae&&e.anchor_visibility){var pe=H.clone_camera(ce,!0);t.cameras.push(pe);var Mt=J.create_subs_anchor_visibility(pe);q.append_node_attr(o,Mt),q.append_edge_attr(o,i[0],Mt,ne?Ee:se)}if(N&&_e&&!ae){var xt=j.max_ray_length,yt=j.intensity,Ut=j.steps_per_pass,wt=i[0],Ct=!!p,Dt=x("DEPTH","u_input",1,1,1,!0,!0),Ft=x("COLOR","u_input",1,.25,.25,!0,!0);Ft.min_filter=Z.TF_LINEAR,Ft.mag_filter=Z.TF_LINEAR;var Gt=xt/Ut,kt=H.clone_camera(ce,!0);t.cameras.push(kt);var Kt=J.create_subs_god_rays(kt,Ct,xt,!0,Gt,S,Ut);q.append_node_attr(o,Kt),q.append_edge_attr(o,wt,Kt,Dt),Gt=xt/Ut*.5;var Bt=H.clone_camera(ce,!0);t.cameras.push(Bt);var Xt=J.create_subs_god_rays(Bt,Ct,xt,!1,Gt,S,Ut);q.append_node_attr(o,Xt),q.append_edge_attr(o,Kt,Xt,Ft),Gt=xt/Ut*.25;var Ht=H.clone_camera(ce,!0);t.cameras.push(Ht);var jt=J.create_subs_god_rays(Ht,Ct,xt,!1,Gt,S,Ut);q.append_node_attr(o,jt),q.append_edge_attr(o,Xt,jt,Ft);var Qt=J.create_subs_god_rays_comb(yt,S);s.push(Qt),q.append_node_attr(o,Qt);var zt=x("COLOR","u_main",1,1,1,!0,!0);zt.min_filter=Z.TF_LINEAR,zt.mag_filter=Z.TF_LINEAR,q.append_edge_attr(o,wt,Qt,zt);var Vt=x("COLOR","u_god_rays",1,1,1,!0,!0);Vt.min_filter=Z.TF_LINEAR,Vt.mag_filter=Z.TF_LINEAR,q.append_edge_attr(o,jt,Qt,Vt),i=s,s=[]}if(L&&!ae){var wt=i[0],qt=J.create_subs_luminance();q.append_node_attr(o,qt);var zt=x("COLOR","u_input",1,1,1,!0,!0);zt.min_filter=Z.TF_LINEAR,zt.mag_filter=Z.TF_LINEAR,q.append_edge_attr(o,wt,qt,zt);var Wt=L.key,Jt=L.edge_lum,Zt=H.clone_camera(ce,!0);t.cameras.push(Zt);var $t=J.create_subs_luminance_truncated(Wt,Jt,S,Zt);q.append_node_attr(o,$t);var e_=x("COLOR","u_luminance",1,.25,.25,!0,!0);if(e_.min_filter=Z.TF_LINEAR,e_.mag_filter=Z.TF_LINEAR,L.adaptive){var t_=J.create_subs_av_luminance();q.append_node_attr(o,t_),t_.camera.width=1,t_.camera.height=1;var __=x("COLOR","u_input",1,.25,.25,!0,!0);if(__.use_mipmap=!0,__.min_filter=Z.TF_LINEAR_MIPMAP_LINEAR,__.mag_filter=Z.TF_LINEAR,ee.webgl2)e_.use_mipmap=!0,e_.min_filter=Z.TF_LINEAR_MIPMAP_LINEAR,q.append_edge_attr(o,qt,t_,__);else{var r_=J.create_resize_subs(),a_=x("COLOR","u_color",1,.25,.25,!0,!0);q.append_node_attr(o,r_),q.append_edge_attr(o,qt,r_,a_),q.append_edge_attr(o,r_,t_,__)}q.append_edge_attr(o,t_,$t,x("COLOR","u_average_lum",1,1,1,!1,!1)),$t.adaptive_bloom=!0}else $t.adaptive_bloom=!1,$t.average_luminance=L.average_luminance;q.append_edge_attr(o,wt,$t,x("COLOR","u_main",1,1,1,!0,!0)),q.append_edge_attr(o,qt,$t,e_);for(var n_=$t,o_=1,i_=[],Ae=0;Ae<5;Ae++){var ut=J.create_subs_postprocessing("X_BLOOM_BLUR");M(ut,e.glow_params.small_glow_mask_width);var ft=x("COLOR","u_color",1,o_,o_,!0,!0);ft.min_filter=Z.TF_LINEAR,ft.mag_filter=Z.TF_LINEAR,q.append_node_attr(o,ut),q.append_edge_attr(o,n_,ut,ft),o_/=2;var Pt=J.create_subs_postprocessing("Y_BLOOM_BLUR");M(Pt,e.glow_params.small_glow_mask_width);var At=x("COLOR","u_color",1,o_,o_,!0,!0);At.min_filter=Z.TF_LINEAR,At.mag_filter=Z.TF_LINEAR,q.append_node_attr(o,Pt),q.append_edge_attr(o,ut,Pt,At),n_=Pt,Pt.bloom_blur_scale=o_,ut.bloom_blur_scale=o_,i_.push(Pt,o_)}var s_=L.blur,E_=J.create_subs_bloom_combine(s_,5);q.append_node_attr(o,E_);for(var Ae=0;Ae<i_.length;Ae+=2){var Pt=i_[Ae],c_=i_[Ae+1],It=x("COLOR","u_bloom_level_"+(Ae/2).toString(),1,c_,c_,!0,!0);It.min_filter=Z.TF_LINEAR,It.mag_filter=Z.TF_LINEAR,q.append_edge_attr(o,Pt,E_,It)}q.append_edge_attr(o,wt,E_,x("COLOR","u_main",1,1,1,!0,!0)),s.push(E_),i=s,s=[]}if(W&&_e&&!ae){var wt=i[0],l_=H.clone_camera(ce,!0);t.cameras.push(l_);var T_=ee.tex_float_available&&ee.cbuffer_float_available,d_=a.dof_bokeh&&T_;if(d_){var u_=(ee.tex_float_lin_available,Z.TF_NEAREST),f_=x("COLOR","u_color",1,1,1,!0,!0);f_.min_filter=u_,f_.mag_filter=u_;var P_=x("DEPTH","u_depth",1,1,1,!0,!0),A_=x("COLOR","u_color",1,.5,.5,!0,!0);A_.floating_point=!0,A_.min_filter=Z.TF_NEAREST,A_.mag_filter=Z.TF_NEAREST;var S_=x("COLOR","u_color",1,.5,.5,!0,!0);S_.floating_point=!0,S_.min_filter=Z.TF_NEAREST,S_.mag_filter=Z.TF_NEAREST;var p_=x("COLOR","u_blurred1",1,.5,.5,!0,!0);p_.floating_point=!0,p_.min_filter=u_,p_.mag_filter=u_;var O_=x("COLOR","u_blurred2",1,.5,.5,!0,!0);O_.floating_point=!0,O_.min_filter=u_,O_.mag_filter=u_;var v_=Lt[0];if(a.dof_foreground_blur){var m_=H.clone_camera(ce,!0);t.cameras.push(m_);var N_=J.create_subs_coc(m_,"COC_FOREGROUND");m_.dof_distance=a.dof_distance,m_.dof_object=a.dof_object,m_.dof_front_start=a.dof_front_start,m_.dof_front_end=a.dof_front_end,m_.dof_rear_start=a.dof_rear_start,m_.dof_rear_end=a.dof_rear_end,m_.dof_power=a.dof_power,m_.dof_bokeh=a.dof_bokeh,m_.dof_bokeh_intensity=a.dof_bokeh_intensity,m_.dof_foreground_blur=a.dof_foreground_blur,m_.dof_on=!0,q.append_node_attr(o,N_),q.append_edge_attr(o,wt,N_,f_),q.append_edge_attr(o,v_,N_,P_);var g_=J.create_subs_postprocessing("X_ALPHA_BLUR");q.append_node_attr(o,g_),q.append_edge_attr(o,N_,g_,A_);var R_=J.create_subs_postprocessing("Y_ALPHA_BLUR");q.append_node_attr(o,R_),q.append_edge_attr(o,g_,R_,S_);var I_=H.clone_camera(ce,!0),b_=J.create_subs_coc(I_,"COC_COMBINE");t.cameras.push(I_),I_.dof_distance=a.dof_distance,I_.dof_object=a.dof_object,I_.dof_front_start=a.dof_front_start,I_.dof_front_end=a.dof_front_end,I_.dof_rear_start=a.dof_rear_start,I_.dof_rear_end=a.dof_rear_end,I_.dof_power=a.dof_power,I_.dof_bokeh=a.dof_bokeh,I_.dof_bokeh_intensity=a.dof_bokeh_intensity,I_.dof_foreground_blur=a.dof_foreground_blur,I_.dof_on=!0,q.append_node_attr(o,b_),q.append_edge_attr(o,wt,b_,f_),q.append_edge_attr(o,v_,b_,P_),q.append_edge_attr(o,R_,b_,x("COLOR","u_coc_fg",1,.5,.5,!0,!0))}else{var I_=H.clone_camera(ce,!0);t.cameras.push(I_);var b_=J.create_subs_coc(I_,"COC_ALL");I_.dof_distance=a.dof_distance,I_.dof_object=a.dof_object,I_.dof_front_start=a.dof_front_start,I_.dof_front_end=a.dof_front_end,I_.dof_rear_start=a.dof_rear_start,I_.dof_rear_end=a.dof_rear_end,I_.dof_power=a.dof_power,I_.dof_bokeh=a.dof_bokeh,I_.dof_bokeh_intensity=a.dof_bokeh_intensity,I_.dof_foreground_blur=a.dof_foreground_blur,I_.dof_on=!0,q.append_node_attr(o,b_),q.append_edge_attr(o,wt,b_,f_),q.append_edge_attr(o,v_,b_,P_)}var h_=J.create_subs_postprocessing("X_DOF_BLUR");h_.camera.dof_bokeh_intensity=a.dof_bokeh_intensity,q.append_node_attr(o,h_),q.append_edge_attr(o,b_,h_,A_);var Y_=J.create_subs_postprocessing("Y_DOF_BLUR");Y_.camera.dof_bokeh_intensity=a.dof_bokeh_intensity,q.append_node_attr(o,Y_),q.append_edge_attr(o,h_,Y_,S_);var L_=J.create_subs_postprocessing("Y_DOF_BLUR");L_.camera.dof_bokeh_intensity=a.dof_bokeh_intensity,q.append_node_attr(o,L_),q.append_edge_attr(o,h_,L_,S_);var M_=J.create_subs_dof(l_,d_);l_.dof_distance=a.dof_distance,l_.dof_object=a.dof_object,l_.dof_front_start=a.dof_front_start,l_.dof_front_end=a.dof_front_end,l_.dof_rear_start=a.dof_rear_start,l_.dof_rear_end=a.dof_rear_end,l_.dof_power=a.dof_power,l_.dof_bokeh=a.dof_bokeh,l_.dof_bokeh_intensity=a.dof_bokeh_intensity,l_.dof_foreground_blur=a.dof_foreground_blur,l_.dof_on=!0,s.push(M_),q.append_node_attr(o,M_),q.append_edge_attr(o,wt,M_,x("COLOR","u_sharp",1,1,1,!0,!0)),q.append_edge_attr(o,Y_,M_,p_),q.append_edge_attr(o,L_,M_,O_)}else{var x_=x("COLOR","u_color",1,1,1,!0,!0);x_.min_filter=Z.TF_LINEAR,x_.mag_filter=Z.TF_LINEAR;var y_=x("COLOR","u_color",1,1,1,!0,!0);y_.min_filter=Z.TF_LINEAR,y_.mag_filter=Z.TF_LINEAR;var h_=J.create_subs_postprocessing("X_BLUR");q.append_node_attr(o,h_),q.append_edge_attr(o,wt,h_,x_);var U_=J.create_subs_postprocessing("Y_BLUR");q.append_node_attr(o,U_),q.append_edge_attr(o,h_,U_,y_);var w_=Lt[0],M_=J.create_subs_dof(l_,d_);l_.dof_distance=a.dof_distance,l_.dof_object=a.dof_object,l_.dof_front_start=a.dof_front_start,l_.dof_front_end=a.dof_front_end,l_.dof_rear_start=a.dof_rear_start,l_.dof_rear_end=a.dof_rear_end,l_.dof_power=a.dof_power,l_.dof_bokeh=a.dof_bokeh,l_.dof_bokeh_intensity=a.dof_bokeh_intensity,l_.dof_foreground_blur=a.dof_foreground_blur,l_.dof_on=!0,s.push(M_),q.append_node_attr(o,M_),q.append_edge_attr(o,wt,M_,x("COLOR","u_sharp",1,1,1,!0,!0)),q.append_edge_attr(o,U_,M_,x("COLOR","u_blurred",1,1,1,!0,!0)),q.append_edge_attr(o,w_,M_,x("DEPTH","u_depth",1,1,1,!0,!0))}i=s,s=[]}if(e.xray){var C_=ct(J.MAIN_XRAY);s.push(C_),i=s,s=[]}if(w&&!ae){var D_=i[0],F_=J.create_subs_motion_blur(B.mb_decay_threshold,B.mb_factor);s.push(F_),q.append_node_attr(o,F_);var G_=x("COLOR","u_mb_tex_curr",1,1,1,!0,!0);q.append_edge_attr(o,D_,F_,G_);var k_=x("COLOR","u_mb_tex_accum",1,1,1,!0,!0);F_.slinks_internal.push(k_),i=s,s=[]}if(!ae&&e.outline){var wt=i[0],K_=H.clone_camera(ce,!0);t.cameras.push(K_);var B_=J.create_subs_outline_mask(K_,S);q.append_node_attr(o,B_);var X_=J.create_subs_postprocessing("X_EXTEND"),H_=x("COLOR","u_color",1,1,1,!0,!0),j_=x("COLOR","u_outline_mask",1,1,1,!0,!0);j_.min_filter=Z.TF_LINEAR,j_.mag_filter=Z.TF_LINEAR,X_.is_for_outline=!0,q.append_node_attr(o,X_),q.append_edge_attr(o,B_,X_,H_);var Q_=x("COLOR","u_color",1,.5,.5,!0,!0);Q_.min_filter=Z.TF_LINEAR,Q_.mag_filter=Z.TF_LINEAR;var z_=J.create_subs_postprocessing("Y_EXTEND");z_.is_for_outline=!0,q.append_node_attr(o,z_),q.append_edge_attr(o,X_,z_,Q_);var h_=J.create_subs_postprocessing("X_BLUR");h_.is_for_outline=!0,q.append_node_attr(o,h_),q.append_edge_attr(o,z_,h_,Q_);var V_=x("COLOR","u_color",1,.25,.25,!0,!0);V_.min_filter=Z.TF_LINEAR,V_.mag_filter=Z.TF_LINEAR;var q_=x("COLOR","u_outline_mask_blurred",1,.25,.25,!0,!0);q_.min_filter=Z.TF_LINEAR,q_.mag_filter=Z.TF_LINEAR;var U_=J.create_subs_postprocessing("Y_BLUR");U_.is_for_outline=!0,q.append_node_attr(o,U_),q.append_edge_attr(o,h_,U_,V_);var W_=J.create_subs_outline(V);q.append_node_attr(o,W_);var J_=x("COLOR","u_outline_src",1,1,1,!0,!0);J_.min_filter=Z.TF_LINEAR,J_.mag_filter=Z.TF_LINEAR,q.append_edge_attr(o,wt,W_,J_),q.append_edge_attr(o,B_,W_,j_),q.append_edge_attr(o,U_,W_,q_),s.push(W_),i=s,s=[]}if(_(o,_e),(e.anaglyph_use||e.hmd_stereo_use||e.sidebyside_use)&&!ae){var Z_=h(o,e,t,i[0]);s.push(Z_),i=s,s=[]}if(C&&!ae){var wt=i[0],$_=X.brightness,er=X.contrast,tr=X.exposure,_r=X.saturation,rr=J.create_subs_compositing($_,er,tr,_r),ar=x("COLOR","u_color",1,1,1,!0,!0);ar.min_filter=Z.TF_LINEAR,ar.mag_filter=Z.TF_LINEAR,(e.anaglyph_use||e.hmd_stereo_use||e.sidebyside_use)&&!ae&&(ar.unique_texture=!0),q.append_node_attr(o,rr),q.append_edge_attr(o,wt,rr,ar),s.push(rr),i=s,s=[]}if(!i[0].is_pp||i[0].type==J.MOTION_BLUR||i[0].type==J.RESOLVE){var nr=J.create_subs_postprocessing("NONE");q.append_node_attr(o,nr);var or=x("COLOR","u_color",1,1,1,!0,!0);or.min_filter=Z.TF_LINEAR,or.mag_filter=Z.TF_LINEAR,q.append_edge_attr(o,i[0],nr,or),s.push(nr),i=s,s=[]}if(D){var wt=i[0];if(ee.smaa){var ir=x("COLOR","u_color",1,1,1,!0,!1);ir.min_filter=Z.TF_LINEAR,ir.mag_filter=Z.TF_LINEAR;var sr=J.create_subs_smaa(J.SMAA_EDGE_DETECTION,e);q.append_node_attr(o,sr),q.append_edge_attr(o,wt,sr,ir);var Er=J.create_subs_smaa(J.SMAA_BLENDING_WEIGHT_CALCULATION,e);q.append_node_attr(o,Er),q.append_edge_attr(o,sr,Er,ir);var cr=x("COLOR","u_search_tex",1,1,1,!1,!1),lr=x("COLOR","u_area_tex",1,1,1,!1,!1);cr.min_filter=Z.TF_LINEAR,cr.mag_filter=Z.TF_LINEAR,lr.min_filter=Z.TF_LINEAR,lr.mag_filter=Z.TF_LINEAR,Er.slinks_internal.push(cr),Er.slinks_internal.push(lr);var Tr=J.create_subs_smaa(J.SMAA_NEIGHBORHOOD_BLENDING,e);q.append_node_attr(o,Tr),q.append_edge_attr(o,wt,Tr,ir);var dr=x("COLOR","u_blend",1,1,1,!0,!1);dr.min_filter=Z.TF_LINEAR,dr.mag_filter=Z.TF_LINEAR,q.append_edge_attr(o,Er,Tr,dr),s.push(Tr)}else{var ur=J.create_subs_aa(e);q.append_node_attr(o,ur);var fr=x("COLOR","u_color",1,1,1,!0,!1);fr.min_filter=Z.TF_LINEAR,fr.mag_filter=Z.TF_LINEAR,(e.anaglyph_use||e.hmd_stereo_use||e.sidebyside_use)&&!ae&&(fr.unique_texture=!0),q.append_edge_attr(o,wt,ur,fr),s.push(ur)}i=s,s=[]}s.push(i[0]),$e&&(et?s.push(et):s.push($e)),Mt&&s.push(Mt);var Te=1;if(e.sky_params.render_sky){var Pr=e.sky_params,Ar=e.world_light_set,Sr=Ar.sky_texture_param;Te=Sr?Sr.tex_size:Te;var pr=J.create_subs_sky(Ar,S,Pr,Te);if(q.append_node_attr(o,pr),s.push(pr),A.length&&(q.append_edge_attr(o,pr,Qe,A[0]),lt&&q.append_edge_attr(o,pr,lt,A[0]),dt&&q.append_edge_attr(o,pr,dt,A[0]),C_&&q.append_edge_attr(o,pr,C_,A[0])),b.has_pbr_reflexible)if(ee.webgl2&&!ee.is_mobile_device){var Or=J.create_subs_irradiance(S,Te);q.append_node_attr(o,Or);var vr=x("CUBEMAP","u_sky_reflection",Te,1,1,!1);vr.use_mipmap=!0,vr.min_filter=Z.TF_LINEAR_MIPMAP_LINEAR,vr.mag_filter=Z.TF_LINEAR,q.append_edge_attr(o,pr,Or,vr);var mr=x("CUBEMAP","u_irradiance",32,1,1,!1);mr.use_mipmap=!1,mr.min_filter=Z.TF_LINEAR,mr.mag_filter=Z.TF_LINEAR,q.append_edge_attr(o,Or,Qe,mr),lt&&q.append_edge_attr(o,Or,lt,mr),dt&&q.append_edge_attr(o,Or,dt,mr),C_&&q.append_edge_attr(o,Or,C_,mr),s.push(Or);var Nr=J.create_subs_rougness_convolution(S);q.append_node_attr(o,Nr),q.append_edge_attr(o,pr,Nr,vr);var gr=x("CUBEMAP","u_cube_r_convolution",128,1,1,!1);gr.use_mipmap=!1,gr.min_filter=Z.TF_LINEAR_MIPMAP_LINEAR,gr.mag_filter=Z.TF_LINEAR,q.append_edge_attr(o,Nr,Qe,gr),lt&&q.append_edge_attr(o,Nr,lt,gr),dt&&q.append_edge_attr(o,Nr,dt,gr),C_&&q.append_edge_attr(o,Nr,C_,gr);var Rr=J.create_subs_brdf();q.append_node_attr(o,Rr);var Ir=x("COLOR","u_brdf",512,1,1,!1);Ir.min_filter=Z.TF_LINEAR,Ir.mag_filter=Z.TF_LINEAR,q.append_edge_attr(o,Rr,Qe,Ir),lt&&q.append_edge_attr(o,Rr,lt,Ir),dt&&q.append_edge_attr(o,Rr,dt,Ir),C_&&q.append_edge_attr(o,Rr,C_,Ir)}else{var vr=x("CUBEMAP","u_sky_reflection",Te,1,1,!1);vr.use_mipmap=!0,vr.min_filter=Z.TF_LINEAR_MIPMAP_LINEAR,vr.mag_filter=Z.TF_LINEAR,q.append_edge_attr(o,pr,Qe,vr),lt&&q.append_edge_attr(o,pr,lt,vr),dt&&q.append_edge_attr(o,pr,dt,vr),C_&&q.append_edge_attr(o,pr,C_,vr)}}var br=J.create_subs_sink();q.append_node_attr(o,br);for(var Ae=0;Ae<s.length;Ae++){var hr=s[Ae];switch(hr.blend=!0,hr.type){case J.COLOR_PICKING:case J.COLOR_PICKING_XRAY:q.append_edge_attr(o,hr,br,x("COLOR","NONE",1,1,1,Ze,!1)),q.append_edge_attr(o,hr,br,x("DEPTH","NONE",1,1,1,Ze,!1));break;case J.SKY:var Yr=x("CUBEMAP","u_sky",Te,1,1,!1);q.append_edge_attr(o,hr,br,Yr);break;case J.IRRADIANCE:var Lr=x("CUBEMAP","u_irradiance",Te,1,1,!1);Lr.use_mipmap=!0,Lr.min_filter=Z.TF_NEAREST,Lr.mag_filter=Z.TF_NEAREST,q.append_edge_attr(o,Or,br,Lr);break;case J.ANCHOR_VISIBILITY:var Mr=x("COLOR","NONE",1,1,1,!0,!1);q.append_edge_attr(o,hr,br,Mr);break;default:if(ae){var xr=n[0],yr=x("COLOR","OFFSCREEN",1,1,1,!0,!0);yr.texture=xr,q.append_edge_attr(o,s[Ae],br,yr);for(var fe=1;fe<n.length;fe++){var Ur=n[fe],wr=J.create_subs_postprocessing("NONE");q.append_node_attr(o,wr);var Cr=x("COLOR","SCALE",1,1,1,!0,!0);q.append_edge_attr(o,s[Ae],wr,Cr);var Dr=Ur.source_size/xr.source_size;yr=x("COLOR","OFFSCREEN",1,Dr,Dr,!0,!0),yr.texture=Ur,q.append_edge_attr(o,wr,br,yr)}}else q.append_edge_attr(o,s[Ae],br,x("SCREEN","NONE",1,1,1,!0,!1))}}if(ze&&!F(o,ze).length&&(q.remove_node(o,q.node_by_attr(o,ze)),q.cleanup_loose_edges(o)),_(o,_e),r(o,_e),$.enabled){var Fr=R(o);Fr&&I(o,Fr)}if(P(o),g(o),K&&q.traverse(o,function(e,t){t.type!=J.SHADOW_RECEIVE&&t.type!=J.MAIN_BLEND&&t.type!=J.MAIN_XRAY||U(o,t)}),!b.has_reflexible)for(var Ae=0;Ae<u.length;Ae++)u[Ae].active=!1;return o},t.multiply_size_mult_by_graph=Y,t.set_texel_size=L,t.set_texel_size_mult=M,t.create_performance_graph=function(){var e=q.create(),t=J.create_subs_perf(),_=H.create_camera(H.TYPE_NONE);_.width=512,_.height=512,t.camera=_,q.append_node_attr(e,t),t.slinks_internal.push(x("COLOR","u_color",512,1,1,!1,!1));var r=J.create_subs_sink();return q.append_node_attr(e,r),q.append_edge_attr(e,t,r,x("COLOR","NONE",512,1,1,!1,!1)),P(e),g(e),e},t.find_on_screen=function(e){var t=null;return q.traverse(e,function(e,_){return!(!_.camera||null!==_.camera.framebuffer)&&(t=_,!0)}),t},t.find_input=function(e,t,_){for(var r=D(e,t),a=0;a<r.length;a++)if(r[a].type==_)return r[a];return null},t.get_inputs_by_type=function(e,t,_){for(var r=D(e,t),a=[],n=0;n<r.length;n++)r[n].type==_&&a.push(r[n]);return a},t.has_lower_subs=w,t.has_upper_subs=C,t.get_inputs=D,t.get_outputs=F,t.find_subs=function(e,t){var _=null;return q.traverse(e,function(e,r){return r.type==t&&(_=r,!0)}),_},t.debug_convert_to_dot=function(e){var t="digraph scenegraph {\n";t+="    ",t+='size="11.7,16.5";\n',t+="    ",t+='ratio="fill";\n',t+="    ",t+='node [shape=box margin="0.25,0.055"];\n';var _=G(e);return q.traverse(e,function(e,r){t+="    ",t+=k(e,r,_)}),q.traverse_edges(e,function(e,r,a){t+="    ",t+=K(e,r,a,_)}),t+="}"},t.create_rendering_queue=function(e){for(var t=q.topsort_attr(e),_=[],r=0;r<t.length;r++){var a=t[r];a.enqueue&&_.push(a)}return _}}var a=_(0),n=_(5),o=_(14),i=_(4),s=_(44),E=_(45),c=_(30),l=_(31),T=_(22),d=_(11),u=_(17),f=_(2),P=Object(a.a)("__scenegraph",r);t.a=P},function(e,t,_){"use strict";function r(e,t){function _(){return D}function r(e){D=e}function a(e,r,a,n){var o=_(),i=R.create();for(var s in r){var c=E(r[s]);(n&&c.is_resource||!e&&c.primary_only)&&v(c),R.append_node_attr(i,c)}for(var s in r){var c=r[s];c.name=s;for(var l=0;l<c.inputs.length;l++)R.append_edge_attr(i,r[c.inputs[l]],c,null)}var T=function(e,t,_,r,a,n){t.is_primary&&(o.start_secondary_threads=!0),g(t)||(t.status=Y),t.loaded_cb(t.id,!0),a(t,_),I.log("%cTHREAD "+t.id+": LOADED CALLBACK",C)},d=E({name:"out",priority:t.FINISH_PRIORITY,cb_before:T,relative_size:5});if(a)var u=R.get_sink_nodes(i);else{var u,f,P=R.clone(i);do{u=R.get_sink_nodes(P),f=[];for(var l=0;l<u.length;l++){var A=u[l],S=R.get_node_attr(P,A);S.background_loading&&f.push(A)}for(var l=0;l<f.length;l++)R.remove_node(P,f[l]);f.length&&R.cleanup_loose_edges(P)}while(f.length)}R.append_node_attr(i,d);for(var l=0;l<u.length;l++){var A=u[l],S=R.get_node_attr(i,A);d.inputs.push(S.name),R.append_edge_attr(i,S,d,null)}return i}function E(e){return e.background_loading=e.background_loading||!1,e.priority||0===e.priority||(e.priority=e.SYNC_PRIORITY),e.inputs=e.inputs||[],e.is_finished=e.is_finished||!1,e.skip=e.skip||!1,e.relative_size=e.relative_size||0,e.is_resource=e.is_resource||!1,e.primary_only=e.primary_only||!1,e.status=x,e.loop_index=0,e.load_rate=0,e.cb_param=e.cb_param||null,e}function c(e,t,_){if(t.complete_load_cb(_,t),t.status=L,e.active_threads--,h.debug_loading){var r=Math.round(performance.now()-t.time_load_start);I.log("%cTHREAD "+t.id+": 100% LOADING END "+r+"ms",C)}m(t)}function l(e,_){var r=e.stages_queue.length;do{var a=e.stages_queue[0],n=R.get_node_attr(e.stage_graph,a),o=u(e,n,_);n.priority==t.ASYNC_PRIORITY&&(e.reset_time_cycle=!0);var i=e.stages_queue.shift();e.stages_queue.push(i),r--}while(!o&&0!=r)}function T(e,t){for(var _=[],r=[],a=0;a<t.length;a++){var n=t[a];R.get_node_attr(e.stage_graph,n).is_finished&&(R.traverse_outputs(e.stage_graph,n,function(r,a,n){var o=!0;R.traverse_inputs(e.stage_graph,r,function(e,t,_){if(!t.is_finished)return o=!1,1}),o&&-1==_.indexOf(r)&&-1==t.indexOf(r)&&_.push(r)}),r.push(a))}for(var a=r.length-1;a>=0;a--)t.splice(r[a],1);return _}function d(e){var t=[],_=e.stages_queue,r=!1;do{var a=T(e,_);t.push.apply(t,_),a.length>0&&(r=!0),_=a}while(a.length>0);var n=function(t,_){var r=R.get_node_attr(e.stage_graph,t),a=R.get_node_attr(e.stage_graph,_),n=a.priority-r.priority;return 0==n&&(n=r.background_loading-a.background_loading),n};return r&&t.sort(n),e.stages_queue=t,e.stages_queue.length}function u(e,t,_){if(t.skip)return t.is_finished=!0,h.debug_loading&&I.log("%cTHREAD "+e.id+": SKIP STAGE "+t.name,C),A(e,t),!1;if(h.debug_loading&&t.status==x){var r=f(e),a="LOADING START "+t.name,n=Math.round(performance.now()-e.time_load_start);I.log("%cTHREAD "+e.id+": "+r+"% "+a+" "+n+"ms ",C)}if(!t.cb_before&&!t.cb_loop&&!t.cb_after)return A(e,t),!1;if(t.status==x&&(t.status++,t.cb_before))return t.cb_before(_,e,t,t.cb_param,A,S),!0;if(t.status==y){if(t.cb_loop)return t.cb_loop(_,e,t,t.cb_param,A,S),!0;t.status++}return!(t.status!=U||(t.status++,!t.cb_after))&&(t.cb_after(_,e,t,t.cb_param,A,S),!0)}function f(e){if(0==e.stages_size_total)return 100;var t=0;return R.traverse(e.stage_graph,function(_,r){P(e,r)&&(t+=r.load_rate*r.relative_size)}),i._63(100*t/e.stages_size_total)}function P(e,t){return!(e.do_not_load_resources&&t.is_resource)}function A(e,t){if(t.is_finished=!0,t.status=w,p(e,t,1),h.debug_loading){var _=f(e),r="LOADING END "+t.name,a=Math.round(performance.now()-e.time_load_start);I.log("%cTHREAD "+e.id+": "+_+"% "+r+" "+a+"ms ",C)}}function S(e,t,_){_<1?p(e,t,_):t.status++}function p(e,t,r){var a=_();if(t.cb_before||t.cb_loop||t.cb_after){t.load_rate=r;var n=f(e);e.curr_percents==n&&1!=r||(e.stageload_cb(n,performance.now()-e.time_load_start,e.id),e.curr_percents=n,a.make_idle_iteration=!0)}}function O(e,t){var _=null;return R.traverse(e.stage_graph,function(e,r){if(r.name==t)return _=r,1}),_}function v(e){e.skip=!0}function m(e){e.stageload_cb=null,e.complete_load_cb=null,h.debug_loading||(e.stage_graph=null),e.stages_queue=null}function N(){return 0==_().active_threads}function g(e){return e&&(e.status==L||e.status==M)}var R=Object(n.a)(e),I=Object(o.a)(e),b=Object(s.a)(e),h=b.defaults,Y=2,L=3,M=4,x=0,y=1,U=2,w=3,C="color: #f0f;";t.SYNC_PRIORITY=0,t.ASYNC_PRIORITY=1,t.FINISH_PRIORITY=2;var D=null;t.get_scheduler=_,t.create_scheduler=function(){var e={threads:[],current_thread_index:0,active_threads:0,start_secondary_threads:!1,make_idle_iteration:!1};return r(e),e},t.create_thread=function(e,t,r,n,o,i,s,E,c){var l=_(),T=l.threads.length,d={id:T,is_primary:0==T,status:0,filepath:t,binary_name:"",loaded_cb:r||function(){},load_hidden:E||!1,wait_complete_loading:i,time_load_start:0,curr_percents:0,stages_size_total:0,reset_time_cycle:!1,stageload_cb:n||function(){},complete_load_cb:o||function(){},stage_graph:null,stages_queue:null,has_video_textures:!1,has_background_music:!1,init_wa_context:!1,is_preloading:c},u=a(d.is_primary,e,i,s);d.stage_graph=u;for(var f=[],A=R.get_source_nodes(u),S=0;S<A.length;S++)f.push(A[S]);return d.stages_queue=f,R.traverse(u,function(e,t){(t.cb_before||t.cb_loop||t.cb_after)&&P(d,t)&&(d.stages_size_total+=t.relative_size)}),l.threads.push(d),l.active_threads++,d.id},t.update_scheduler=function(e){var t=_();if(t&&!N()){if(t.make_idle_iteration)return void(t.make_idle_iteration=!1);var r=performance.now();do{var a=t.threads[t.current_thread_index],n=e[a.id];if(g(a)||(0==a.status&&(a.status=1,a.time_load_start=performance.now(),a.stageload_cb(0,0,a.id),h.debug_loading&&I.log("%cTHREAD "+a.id+": 0% LOADING START 0ms",C)),d(a)?l(a,n):c(t,a,n)),t.start_secondary_threads&&(t.current_thread_index=(t.current_thread_index+1)%t.threads.length),a.reset_time_cycle)return void(a.reset_time_cycle=!1)}while(performance.now()-r<16)}},t.abort_thread=function(e){var t=_();c(t,e,null),e.status=M,e.is_primary&&(t.start_secondary_threads=!0),e.loaded_cb(e.id,!1)},t.stage_part_finish_cb=S,t.skip_stage_by_name=function(e,t){var _=O(e,t);null!==_&&v(_)},t.is_finished=N,t.thread_is_finished=g,t.is_primary_loaded=function(e){var t=_();return!!t&&(e|=0,t.threads[e]&&(t.threads[e].status==L||t.threads[e].status==Y))},t.graph_to_dot=function(e){if(!h.debug_loading)return void I.error("Debug mode isn't enabled. Can not retrieve the graph.");var r=_();return r&&r.threads[e]&&r.threads[e].stage_graph?R.debug_dot(r.threads[e].stage_graph,function(e,_){if(_.skip)return"SKIPPED\n("+_.name+")";var r=_.name+"\n",a=[];return a.push(_.priority==t.ASYNC_PRIORITY?"ASYNC":"SYNC"),_.background_loading&&a.push("BKG"),_.is_resource&&a.push("RES"),r+a.join(" | ")},null):null},t.cleanup=function(){r(null)}}var a=_(0),n=_(31),o=_(1),i=_(2),s=_(4),E=Object(a.a)("__loader",r);t.a=E},function(e,t,_){"use strict";function r(e,t){var _=null;t.setup=function(e){_=e},t.get_gl=function(){return _},t.reset=function(){_=null}}var a=_(0),n=Object(a.a)("__context",r);t.a=n},function(e,t,_){"use strict";function r(e,t){var _=Object(n.a)(e),r=Object(o.a)(e),a=Object(i.a)(e),d=Object(s.a)(e),u=Object(E.a)(e),f=Object(c.a)(e);t.append_stiff=function(e,t,_,n,o){return a.is_dynamic(e)?r.check_self_applying(e,t)?r.check_compatibility(e,t)?(_=_||new Float32Array(3),o=o||1,n=n||[0,0,0,1],t instanceof Array&&2==t.length?r.append_stiff_bone(e,t[0],t[1],_,n,o):r.append_stiff_obj(e,t,_,n,o),f.update_transform(e),void d.sync_transform(e)):void u.error("Constraint recursion is forbidden."):void u.error("Can not apply constraint. Object and target must be different."):void u.error('Wrong object: "'+e.name+'" is not dynamic.')},t.append_semi_stiff=function(e,t,_,n,o,i,s,E){return a.is_dynamic(e)?r.check_self_applying(e,t)?r.check_compatibility(e,t)?(o=l._16(o)?o:Math.PI/2,i=l._16(i)?i:-Math.PI/2,s=l._16(s)?s:Math.PI/2,E=l._16(E)?E:-Math.PI/2,_=_||new Float32Array(3),n=n?new Float32Array(n):null,r.append_semi_stiff_obj(e,t,_,n,o,i,s,E),f.update_transform(e),void d.sync_transform(e)):void u.error("Constraint recursion is forbidden."):void u.error("Can not apply constraint. Object and target must be different."):void u.error('Wrong object: "'+e.name+'" is not dynamic.')},t.append_semi_stiff_cam=function(e,r,a,n,o,i,s,E){if(u.error_deprecated("append_semi_stiff_cam","append_semi_stiff"),!_.is_eye_camera(e))return void u.error("append_semi_stiff_cam(): wrong object type, only EYE camera objects can be parented.");t.append_semi_stiff(e,r,a,n,o,i,s,E)},t.append_semi_soft_cam=function(e,r,a,n){if(u.error_deprecated("append_semi_soft_cam","append_semi_soft"),!_.is_eye_camera(e))return void u.error("append_semi_soft_cam(): wrong object type, only EYE camera objects can be parented.");t.append_semi_soft(e,r,a,n)},t.append_semi_soft=function(e,t,_,n){return a.is_dynamic(e)?r.check_self_applying(e,t)?r.check_compatibility(e,t)?((!l._16(n)||n<0)&&(n=.25),_=_||new Float32Array(3),r.append_semi_soft_obj(e,t,_,n),f.update_transform(e),void d.sync_transform(e)):void u.error("Constraint recursion is forbidden."):void u.error("Can not apply constraint. Object and target must be different."):void u.error('Wrong object: "'+e.name+'" is not dynamic.')},t.append_stiff_trans=function(e,t,_){return a.is_dynamic(e)?r.check_self_applying(e,t)?r.check_compatibility(e,t)?(_=_||new Float32Array(3),r.append_stiff_trans_obj(e,t,_),f.update_transform(e),void d.sync_transform(e)):void u.error("Constraint recursion is forbidden."):void u.error("Can not apply constraint. Object and target must be different."):void u.error('Wrong object: "'+e.name+'" is not dynamic.')},t.append_copy_loc=function(e,t,_,n,o){if(!a.is_dynamic(e))return void u.error('Wrong object: "'+e.name+'" is not dynamic.');if(!r.check_self_applying(e,t))return void u.error("Can not apply constraint. Object and target must be different.");if(!r.check_compatibility(e,t))return void u.error("Constraint recursion is forbidden.");n=n||!1,_=_||"XYZ",o=o||1;var i=f.get_translation(e,new Float32Array(3)),s=new Float32Array(3);s[0]=-1!=_.indexOf("-X")?-1:-1!=_.indexOf("X")?1:0,s[1]=-1!=_.indexOf("-Y")?-1:-1!=_.indexOf("Y")?1:0,s[2]=-1!=_.indexOf("-Z")?-1:-1!=_.indexOf("Z")?1:0,r.append_copy_loc_obj(e,t,i,s,n,o),f.update_transform(e),d.sync_transform(e)},t.append_copy_trans=function(e,t,_){return a.is_dynamic(e)?r.check_self_applying(e,t)?r.check_compatibility(e,t)?(_=_||1,r.append_copy_trans_obj(e,t,_),f.update_transform(e),void d.sync_transform(e)):void u.error("Constraint recursion is forbidden."):void u.error("Can not apply constraint. Object and target must be different."):void u.error('Wrong object: "'+e.name+'" is not dynamic.')},t.append_copy_rot=function(e,t,_,n,o){if(!a.is_dynamic(e))return void u.error('Wrong object: "'+e.name+'" is not dynamic.');if(!r.check_self_applying(e,t))return void u.error("Can not apply constraint. Object and target must be different.");if(!r.check_compatibility(e,t))return void u.error("Constraint recursion is forbidden.");n=n||!1,_=_||"XYZ",o=o||1;var i=new Float32Array(3);i[0]=-1!=_.indexOf("-X")?-1:-1!=_.indexOf("X")?1:0,i[1]=-1!=_.indexOf("-Y")?-1:-1!=_.indexOf("Y")?1:0,i[2]=-1!=_.indexOf("-Z")?-1:-1!=_.indexOf("Z")?1:0,r.append_copy_rot_obj(e,t,i,n,o),f.update_transform(e),d.sync_transform(e)},t.append_stiff_trans_rot=function(e,t,_,n){return a.is_dynamic(e)?r.check_self_applying(e,t)?r.check_compatibility(e,t)?(_=_||new Float32Array(3),n=n?new Float32Array(n):[0,0,0,1],r.append_stiff_trans_rot_obj(e,t,_,n,1),f.update_transform(e),void d.sync_transform(e)):void u.error("Constraint recursion is forbidden."):void u.error("Can not apply constraint. Object and target must be different."):void u.error('Wrong object: "'+e.name+'" is not dynamic.')},t.append_track=function(e,t,_,n,o,i){if(!a.is_dynamic(e))return void u.error('Wrong object: "'+e.name+'" is not dynamic.');if(!r.check_self_applying(e,t))return void u.error("Can not apply constraint. Object and target must be different.");if(!r.check_compatibility(e,t))return void u.error("Constraint recursion is forbidden.");var s=l.e;"-Y"==_?s=l.b:"Y"==_?s=l.e:"-X"==_?s=l.a:"X"==_?s=l.d:"-Z"==_?s=l.c:"Z"==_&&(s=l.f);var E=l.f;if("X"==n?E=l.d:"Y"==n&&(E=l.e),1==Math.abs(T.dot(s,E)))return void u.error("Can not use parallel vectors for track and up axes.");i=i||1,o=o||!1,r.append_track_obj(e,t,s,E,o,i),f.update_transform(e),d.sync_transform(e)},t.append_follow=function(e,t,_,n){return a.is_dynamic(e)?r.check_self_applying(e,t)?r.check_compatibility(e,t)?(r.append_follow_obj(e,t,_,n),f.update_transform(e),void d.sync_transform(e)):void u.error("Constraint recursion is forbidden."):void u.error("Can not apply constraint. Object and target must be different."):void u.error('Wrong object: "'+e.name+'" is not dynamic.')},t.append_stiff_viewport=function(e,t,_){return a.is_dynamic(e)?r.check_self_applying(e,t)?r.check_compatibility(e,t)?(_=_||{},r.append_stiff_viewport(e,t,_),f.update_transform(e),void d.sync_transform(e)):void u.error("Constraint recursion is forbidden."):void u.error("Can not apply constraint. Object and target must be different."):void u.error('Wrong object: "'+e.name+'" is not dynamic.')},t.remove=function(e,t){t=t||!1,e.constraint&&r.remove(e,t),t&&f.update_transform(e)}}var a=_(0),n=_(14),o=_(58),i=_(8),s=_(19),E=_(1),c=_(13),l=_(2),T=_(3),d=Object(a.a)("constraints",r);t.a=d},function(e,t,_){"use strict";function r(e,t){var _=Object(n.a)(e);t.set_timeout=_.set_timeout,t.clear_timeout=_.clear_timeout,t.get_timeline=_.get_timeline,t.animate=_.animate,t.clear_animation=_.clear_animation}var a=_(0),n=_(18),o=Object(a.a)("time",r);t.a=o},function(e,t,_){"use strict";function r(e,t){function _(e){e?"b4w"!==e?i=e:o.error("b4w prefix denied"):o.warn("Prefix should be a string. Last declared storage prefix will be used.")}function r(e){return s[e||i]?JSON.parse(s[e||i]):{}}function a(e,t){s[t||i]=JSON.stringify(e)}var o=Object(n.a)(e),i="b4w",s=null;t.init=_,t.set=function(e,t,_){var n=r(_);n[e]=String(t),a(n,_)},t.cleanup=function(e){delete s[e||i]},t.get=function(e,t){var _=r(t);return _[e]?_[e]:""},t.debug=function(e){o.log(r(e||i))},function(){try{s=window.localStorage;try{s.tmp=null,delete s.tmp}catch(e){o.warn("localStorage quota is limited. Disabling localStorage"),s=null}}catch(e){o.warn("Applying chrome localStorage bug workaround"),s=null}s||(o.warn("localStorage is not available, initializing temporary storage"),s={})}()}var a=_(0),n=_(1),o=Object(a.a)("storage",r);t.a=o},function(e,t,_){"use strict";function r(e,t){function _(e,t,_,r){for(var a=new Uint16Array(4),n=new Uint16Array(_*r),o=0,i=0,s=0,E=0,c=0,l=0,T=0,d=0,u=0,f=_/4,P=r/4,A=0;A<P;A++)for(var S=0;S<f;S++)s=t+4*(A*f+S),a[0]=e[s],a[1]=e[s+1],E=31&a[0],c=2016&a[0],l=63488&a[0],T=31&a[1],d=2016&a[1],u=63488&a[1],a[2]=5*E+3*T>>3|5*c+3*d>>3&2016|5*l+3*u>>3&63488,a[3]=5*T+3*E>>3|5*d+3*c>>3&2016|5*u+3*l>>3&63488,o=e[s+2],i=4*A*_+4*S,n[i]=a[3&o],n[i+1]=a[o>>2&3],n[i+2]=a[o>>4&3],n[i+3]=a[o>>6&3],i+=_,n[i]=a[o>>8&3],n[i+1]=a[o>>10&3],n[i+2]=a[o>>12&3],n[i+3]=a[o>>14],o=e[s+3],i+=_,n[i]=a[3&o],n[i+1]=a[o>>2&3],n[i+2]=a[o>>4&3],n[i+3]=a[o>>6&3],i+=_,n[i]=a[o>>8&3],n[i+1]=a[o>>10&3],n[i+2]=a[o>>12&3],n[i+3]=a[o>>14];return n}function r(e,t,r,a){var n,o,i,E,I,b,h,Y,L,M,x,y=new Int32Array(r,0,A);if(y[S]!=l)return c.error("Invalid magic number in DDS header"),0;if(!y[g]&d)return c.error("Unsupported format, must contain a FourCC code"),0;switch(n=y[R]){case u:o=8,i=t?t.COMPRESSED_RGB_S3TC_DXT1_EXT:null;break;case f:o=16,i=t?t.COMPRESSED_RGBA_S3TC_DXT3_EXT:null;break;case P:o=16,i=t?t.COMPRESSED_RGBA_S3TC_DXT5_EXT:null;break;default:return c.error("Unsupported FourCC code:",s(n)),null}if(M=1,y[O]&T&&!1!==a&&(M=Math.max(1,y[N])),E=y[m],I=y[v],h=y[p]+4,t)for(x=0;x<M;++x)b=Math.max(4,E)/4*Math.max(4,I)/4*o,L=new Uint8Array(r,h,b),e.compressedTexImage2D(e.TEXTURE_2D,x,i,E,I,0,L),h+=b,E=Math.max(.5*E,1),I=Math.max(.5*I,1);else{if(n!=u)return c.error("No manual decoder for",s(n),"and no native support"),0;b=Math.max(4,E)/4*Math.max(4,I)/4*o,L=new Uint16Array(r),Y=_(L,h/2,E,I),e.texImage2D(e.TEXTURE_2D,0,e.RGB,E,I,0,e.RGB,e.UNSIGNED_SHORT_5_6_5,Y),a&&e.generateMipmap(e.TEXTURE_2D)}return M}function a(e,t,_,a,n,o){var i=new XMLHttpRequest;return i.open("GET",_,!0),i.responseType="arraybuffer",i.onload=function(){if(200==i.status){e.bindTexture(e.TEXTURE_2D,a);var _=r(e,t,i.response,n);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,_>1?e.LINEAR_MIPMAP_LINEAR:e.LINEAR)}o&&o(a)},i.send(null),a}function i(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}function s(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)}var E=Object(n.a)(e),c=Object(o.a)(e),l=542327876,T=131072,d=4,u=i("DXT1"),f=i("DXT3"),P=i("DXT5"),A=31,S=0,p=1,O=2,v=3,m=4,N=7,g=20,R=21;t.upload_dds_levels=r,t.upload_pvr_levels=function(e,t,_){var r=new Uint32Array(_,0,13);if(55727696==r[0]){var a=r[7],n=r[6],o=r[11],i=52+r[12];switch(r[2]){case 0:var s=2,c=1;break;case 1:var s=2,c=3;break;case 2:var s=4,c=0;break;case 3:var s=4,c=2;break;default:E.panic("Unsupported PVR V3 format.")}}else if(559044176==r[11]){var a=r[2],n=r[1],o=r[3],i=r[0];o++;var l=r[4],T=255&l,d=r[10],u=d>0;if(25==T)var s=4,c=u?2:0;else if(24==T)var s=2,c=u?3:1;else E.panic("Unsupported PVR V2 format.")}else E.panic("Unsupported PVR version.");if(2==s)var f=8,P=4;else var f=4,P=4;switch(c){case 0:var A=t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;break;case 1:var A=t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;break;case 2:var A=t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;break;case 3:var A=t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}for(var S=f*P*s/8,p=0;p<o;p++){var O=Math.max(a>>p,1),v=Math.max(n>>p,1),m=O/f,N=v/P;m<2&&(m=2),N<2&&(N=2);var g=m*N*S,R=new Uint8Array(_,i,g);e.compressedTexImage2D(e.TEXTURE_2D,p,A,O,v,0,R),i+=g}},t.get_width_height=function(e,t){switch(t){case"dds":var _=new Int32Array(e,0,A);return{width:_[m],height:_[v]};case"pvr":var _=new Uint32Array(e,0,13);if(55727696==_[0])var r=_[7],a=_[6];else var r=_[2],a=_[1];return{width:r,height:a}}},t.get_compress_ratio=function(e,t){var _=1;if("dds"==t){var r=new Int32Array(e,0,A),a=r[R];switch(a){case u:_=6;break;case f:case P:_=4;break;default:c.error("Unsupported FourCC code:",s(a))}}else if("pvr"==t){var r=new Uint32Array(e,0,13);if(55727696==r[0]){var n=r[2];switch(n){case 0:_=12;break;case 1:_=16;break;case 2:_=6;break;case 3:_=8}}else{var o=255&r[4],i=r[10]>0;25==o?_=i?8:6:24==o&&(_=i?16:12)}}return _},t.load_dds_texture=function(e,t,_,r){var n=e.createTexture();return a(e,t,_,n,!0,r),n}}var a=_(0),n=_(5),o=_(1),i=(_(2),Object(a.a)("__texcomp",r));t.a=i},function(e,t,_){"use strict";function r(e,t){var _=Object(n.a)(e),r={};t.fill_vbo_garbage_info=function(e,t,_,a,n){r[e]||(r[e]={shaders:t,attrs:{}}),_ in r[e].attrs||(r[e].attrs[_]=a),n&&(r[e].attrs[_]=0)},t.calc_vbo_garbage_byte_size=function(){var e=0;for(var t in r)for(var _ in r[t].attrs)e+=r[t].attrs[_];return e},t.show_vbo_garbage_info=function(){var e={};for(var t in r)for(var a in r[t].attrs){var n=r[t].attrs[a];if(n){var o=r[t].shaders;o in e||(e[o]={total_size:0,attrs:{}}),a in e[o].attrs||(e[o].attrs[a]=0),e[o].attrs[a]+=n,e[o].total_size+=n}}for(var o in e){_.groupCollapsed(o,e[o].total_size);for(var a in e[o].attrs)_.log_raw(a,e[o].attrs[a]);_.groupEnd()}},t.cleanup=function(){r={}}}var a=_(0),n=_(1),o=Object(a.a)("__debug",r);t.a=o},function(e,t,_){"use strict";function r(e,t){function _(){var e=T.get_disjoint_timer_query();if(e){var t=e.createQuery();e.beginQuery(t)}else var t=performance.now();return t}function r(){var e=l.get_debug_view_subs();return e&&e.debug_view_mode==l.DV_RENDER_TIME}function a(e,t,_){var r=T.get_disjoint_timer_query(),a=0;if(r){_&&r.endQuery();for(var n=0;n<e.length;n++){var o=e[n],i=r.getQueryAvailable(o),s=r.getDisjoint();if(i&&!s){a=r.getQueryObject(o)/1e6,t&&(a=E._50(a,t,1,f)),e.splice(n,1),n--}}}else a=performance.now()-e.pop(),t&&(a=E._50(a,t,1,f));return a}var c=Object(n.a)(e),l=Object(o.a)(e),T=Object(i.a)(e),d=Object(s.a)(e),u=c.defaults,f=10;t.start_subs=function(e){(u.show_hud_debug_info||e.type==d.PERFORMANCE)&&(e.do_not_debug||e.debug_render_time_queries.push(_()))},t.start_batch=function(e){"MAIN"==e.type&&r()&&e.debug_render_time_queries.push(_())},t.stop_subs=function(e){if((u.show_hud_debug_info||e.type==d.PERFORMANCE)&&!e.do_not_debug){var t=a(e.debug_render_time_queries,e.debug_render_time,!0);t&&(e.debug_render_time=t)}},t.stop_batch=function(e){if("MAIN"==e.type&&r()){var t=a(e.debug_render_time_queries,e.debug_render_time,!0);t&&(e.debug_render_time=t)}},t.is_debug_view_render_time_mode=r,t.process_timer_queries=function(e){var t=a(e.debug_render_time_queries,e.debug_render_time,!1);t&&(e.debug_render_time=t)}}var a=_(0),n=_(4),o=_(45),i=_(28),s=_(11),E=_(2),c=Object(a.a)("__debug_rendertime",r);t.a=c},function(e,t,_){"use strict";function r(e,t){function _(e){var t,_,r,a,n,o,i={},s=[],E=[],c=Math.pow(10,4);for(r=0,a=e.vertices.length;r<a;r++)t=e.vertices[r],_=Math.round(t[0]*c)+"_"+Math.round(t[1]*c)+"_"+Math.round(t[2]*c),void 0===i[_]?(i[_]=r,s.push(t),E[r]=s.length-1):E[r]=E[i[_]];var l=[];for(r=0,a=e.faces.length;r<a;r++){n=e.faces[r],n.indices[0]=E[n.indices[0]],n.indices[1]=E[n.indices[1]],n.indices[2]=E[n.indices[2]],o=[n.indices[0],n.indices[1],n.indices[2]];for(var T=0;T<3;T++)if(o[T]==o[(T+1)%3]){l.push(r);break}}for(r=l.length-1;r>=0;r--){var d=l[r];e.faces.splice(d,1)}var u=e.vertices.length-s.length;for(e.vertices.length=0,r=0;r<s.length;r++)e.vertices.push(s[r]);return u}function r(e,t){return e>t?t+"-"+e:e+"-"+t}function a(e){for(var t=[],_=e.vertices,a=0,n=0;n<e.faces.length;n++){var o=e.faces[n];t.push({id:a++,vertex_ids:o.indices,centroid:o.centroid,normal:o.normal,neighbours:[]})}for(var i={polygons:t,vertices:_},s={},n=0;n<t.length;n++)for(var E=0;E<3;E++){var c=r(t[n].vertex_ids[E],t[n].vertex_ids[(E+1)%3]);c in s||(s[c]=[]),s[c].push(t[n])}for(var l=Object.keys(s),n=0,T=l.length;n<T;n++)for(var c=l[n],E=0;E<s[c].length;E++)for(var d=E+1;d<s[c].length;d++)s[c][E].neighbours.push(s[c][d]),s[c][d].neighbours.push(s[c][E]);return i}function l(e){var t,_;for(t=0;t<e.faces.length;t++)_=e.faces[t],E.add(e.vertices[_.indices[0]],e.vertices[_.indices[1]],w),E.add(w,e.vertices[_.indices[2]],w),E.scale(w,1/3,_.centroid)}function T(e){for(var t=0;t<e.faces.length;t++){var _=e.faces[t],r=E.subtract(e.vertices[_.indices[1]],e.vertices[_.indices[0]],w),a=E.subtract(e.vertices[_.indices[2]],e.vertices[_.indices[0]],C),n=E.cross(r,a,w);E.normalize(n,n),E.copy(n,_.normal)}}function d(e){return l(e),T(e),_(e),a(e)}function u(e,t){return parseFloat(e.toFixed(t))}function f(e){for(var t=e.polygons,_=[],r=0,a=function(e){for(var t=e.neighbours,_=0;_<t.length;_++){var r=t[_];void 0==r.island&&(r.island=e.island,a(r))}},n=0;n<t.length;n++){var o=t[n];void 0==o.island&&(o.island=r++,a(o)),_[o.island]||(_[o.island]=[]),_[o.island].push(t[n])}return _}function P(e,t){if(e.indexOf)return e.indexOf(t);for(var _=0;_<e.length;_++)if(e[_]==t)return _;return-1}function A(e){for(var t={},_=e.vertices,r=0;r<_.length;r++)_[r][0]=u(_[r][0],2),_[r][1]=u(_[r][1],2),_[r][2]=u(_[r][2],2);t.vertices=e.vertices;var a=f(e);t.islands=[];for(var n=function(e,t){for(var _=0;_<e.length;_++)if(t===e[_])return _},r=0;r<a.length;r++){for(var o=[],i=a[r],s=0;s<i.length;s++){for(var E=[],c=i[s],l=0;l<c.neighbours.length;l++)E.push(n(i,c.neighbours[l]));for(var T=[],l=0;l<c.neighbours.length;l++)T.push(V(c,c.neighbours[l]));c.centroid[0]=u(c.centroid[0],2),c.centroid[1]=u(c.centroid[1],2),c.centroid[2]=u(c.centroid[2],2),o.push({id:n(i,c),neighbours:E,vertex_ids:c.vertex_ids,centroid:c.centroid,normal:c.normal,portals:T,f:0,g:0,h:0,cost:1,visited:!1,closed:!1,parent:null})}t.islands.push(o)}return t}function S(e,t,_,r,a,n){function i(e,t){return E.subtract(e,t,w),E.dot(w,w)}!function(e){for(var t=0;t<e.length;t++){var _=e[t];_.f=0,_.g=0,_.h=0,_.cost=1,_.visited=!1,_.closed=!1,_.parent=null}}(e);var s=o.a(function(e){return e.f});for(o.c(s,t);s.content.length>0;){var c=o.b(s);if(c===_){for(var l=c,T=[];l.parent;)T.push(l),l=l.parent;return T.push(t),T.reverse()}c.closed=!0;for(var d=function(e,t){for(var _=[],r=0;r<t.neighbours.length;r++)_.push(e[t.neighbours[r]]);return _}(e,c),u=0,f=d.length;u<f;u++){var P=d[u];if(!P.closed){var A=c.g+E.dist(P.centroid,c.centroid),S=P.visited;(!S||A<P.g)&&(P.visited=!0,P.parent=c,P.h=P.h||i(P.centroid,a)+i(P.centroid,r),P.g=A,P.f=P.g+P.h,S?o.d(s,P):o.c(s,P))}}}return[]}function p(e,t){e.push(t[0]),e.push(t[1]),e.push(t[2])}function O(e,t,_,r){var a=E.subtract(t,e,w),n=E.subtract(_,e,C),o=E.cross(a,n,w);return s._49(E.dot(r,o))}function v(e,t){return E.subtract(e,t,w),E.dot(w,w)<1e-5}function m(e,t,_){var r=E.subtract(t.right,t.left,w),a=_.normal,n=t.normal,o=Math.acos(E.dot(a,n));o*=-s._49(E.dot(r,E.cross(a,n,C)));var c=i.identity(B);return i.translate(c,t.left,c),i.rotate(c,o,r,c),i.translate(c,E.scale(t.left,-1,C),c),i.multiply(e,c,e),e}function N(e,t,_,r,a,n,o){var i=E.transformMat4(_,n,D);i[3]=1;var s=E.transformMat4(r,n,w),l=E.subtract(s,i,F),T=E.subtract(t,e,w),d=E.cross(a,T,G);if(Math.abs(E.dot(d,l))<.01)var u=.5;else{E.normalize(d,d),d[3]=-E.dot(d,t);var u=-c.dot(d,i)/c.dot(d,l)}var f=E.subtract(r,_,w);return E.scaleAndAdd(_,f,u,o)}function g(e,t,_,r,a,n,o,s,c){for(var l=i.identity(k),T=a;T<_;T++)if(e[T].is_crucial&&(T>a||!T)){var d=N(t,r,e[T].left,e[T].right,n,l,E.create());p(o,d),s&&p(c,e[T].normal),T&&m(l,e[T],e[T-1])}}function R(e,t){function _(t,_){d=_,u=d,f=d,r=t,a=r,n=r,E.copy(t,o),E.copy(t,s),E.copy(e[d].normal,c)}var r,a,n,o,s,c,l=[],T=[],d=0,u=0,f=0;r=e[0].right,a=e[0].left,n=e[0].right,o=E.copy(a,X),s=E.copy(n,H),c=E.copy(e[0].normal,z),p(l,r),t&&p(T,e[0].normal);for(var P=i.identity(K),A=1;A<e.length;A++){var S=e[A].left,N=e[A].right,R=E.transformMat4(S,P,j),I=E.transformMat4(N,P,Q);if(e[A].is_crucial&&m(P,e[A],e[A-1]),O(r,s,I,c)<=0){var b=v(r,n);if(!(b||O(r,o,I,c)>0)){var h=v(o,r);h||g(e,o,u,r,d,c,l,t,T),P=i.identity(P),_(a,u),A=d,h||(p(l,r),t&&p(T,e[A].normal));continue}n=N,E.copy(I,s),f=A}if(O(r,o,R,c)>=0){var b=v(r,a);if(!(b||O(r,s,R,c)<0)){var Y=v(s,r);Y||g(e,s,f,r,d,c,l,t,T),P=i.identity(P),_(n,f),A=d,Y||(p(l,r),t&&p(T,e[A].normal));continue}a=S,E.copy(R,o),u=A}}var L=e.length-1,M=e[L].left,x=v(r,M);return x||g(e,o,L,r,d,c,l,t,T),x&&d||p(l,M),t?(p(T,e[L].normal),{positions:new Float32Array(l),normals:new Float32Array(T)}):{positions:new Float32Array(l),normals:null}}function I(e,t){for(var _=!1,r=-1,a=e.length,n=a-1;++r<a;n=r)(e[r][1]<=t[1]&&t[1]<e[n][1]||e[n][1]<=t[1]&&t[1]<e[r][1])&&t[0]<(e[n][0]-e[r][0])*(t[1]-e[r][1])/(e[n][1]-e[r][1])+e[r][0]&&(_=!_);return _}function b(e,t,_){for(var r=[],a=0;a<t.length;a++){var n=t[a];r.push(_[n])}return!!I(r,e)}function h(e,t,_,r,a){for(var n=null,o=Number.MAX_VALUE,i=0;i<e.length;i++){var s=e[i],E=a(_,s.centroid,s.vertex_ids,t,o);E<o&&(n=s,o=E)}return r>0&&o>r?null:n}function Y(e,t){for(var _=0;_<e.neighbours.length;_++)if(e.neighbours[_]===t.id)return e.portals[_]}function L(e,t,_,r,a){e.push({left:t,right:_,is_crucial:r,normal:a})}function M(e,t,_,r,a){var n=[];L(n,t,t,!1,e[0]&&e[0].normal||s.f);for(var o=0;o<e.length;o++){var i=e[o],c=e[o+1];if(c){var l=Math.abs(E.dot(i.normal,c.normal))<.999,T=Y(i,c);L(n,r[T[0]],r[T[1]],l,c.normal)}}return L(n,_,_,!1,n[n.length-1].normal),R(n,a)}function x(e,t){if(t){for(var _=new Float32Array(3*e.length),r=0;r<e.length;r++)_.set(e[r].centroid,3*r);return{positions:_,normals:null}}for(var a=new Float32Array(3*e.length),n=new Float32Array(3*e.length),r=0;r<e.length;r++)a.set(e[r].centroid,3*r),n.set(e[r].normal,3*r);return{positions:a,normals:n}}function y(e,t,_,r){var a=r.island,n=e.islands[a],o=e.vertices,i=h(n,o,t,r.allowed_distance,r.distance_to_closest);if(!i)return null;var s=h(n,o,_,r.allowed_distance,r.distance_to_farthest);return s?S(n,i,s,t,_,o):null}var U=Object(n.a)(e),w=E.create(),C=E.create(),D=c.create(),F=c.create(),G=c.create(),k=i.create(),K=i.create(),B=i.create(),X=E.create(),H=E.create(),j=E.create(),Q=E.create(),z=E.create(),V=function(e,t){function _(e){var t=e[0];e[0]=e[1],e[1]=e[2],e[2]=t}for(var r=e.vertex_ids,a=t.vertex_ids,n=[],o=0;o<r.length;o++)P(a,r[o])>=0&&n.push(r[o]);if(n.length<2)return[];P(n,r[0])>=0&&P(n,r[r.length-1])>=0&&_(r),P(n,a[0])>=0&&P(n,a[a.length-1])>=0&&_(a),n=[];for(var o=0;o<r.length;o++)P(a,r[o])>=0&&n.push(r[o]);return n};t.navmesh_build_from_bufs_data=function(e){for(var t=U.get_vbo_source_by_type(e.vbo_source_data,U.VBO_FLOAT),_=e.ibo_array,r=[],a=0;a<_.length;a+=3)r.push({indices:new Uint32Array([_[a],_[a+1],_[a+2]]),centroid:new Float32Array(3),normal:new Float32Array(3)});for(var n=[],a=0;a<t.length;a+=3){var o=new Float32Array(3);o[0]=t[a],o[1]=t[a+1],o[2]=t[a+2],n.push(o)}return A(d({vertices:n,faces:r}))},t.navmesh_get_island=function(e,t,_){for(var r=null,a=Number.MAX_VALUE,n=e.islands,o=0;o<n.length;o++)for(var i=0;i<n[o].length;i++){var s=n[o][i];E.subtract(s.centroid,t,w);var c=_(t,s.centroid,s.vertex_ids,e.vertices,a);c<a&&(r=o,a=c)}return r},t.is_vector_in_poly=b,t.navmesh_find_path=function(e,t,_,r){var a=y(e,t,_,r);return a&&a.length?r.do_not_pull_string?x(a,r.return_normals):M(a,t,_,e.vertices,r.return_normals):null}}var a=_(0),n=_(20),o=_(41),i=_(21),s=_(2),E=_(3),c=_(7),l=Object(a.a)("__navmesh",r);t.a=l},function(e,t,_){"use strict";function r(){return{name:"",type:"",uuid:"",use_nodes:!1,node_tree:null,texture_slots:[],blend_mode:"",use_shadeless:!1,use_transparency:!1,use_backface_culling:!1,use_tangent_shading:!1,use_orco_tex_coord:!1,use_vertex_color_paint:!1,use_double_sided_lighting:!1,do_not_render:!1,render_above_all:!1,is_lens_flares:!1,is_wettable:!1,is_refractive:!1,refr_bump:0,pass_index:0,offset_z:0,diffuse_shader:"",diffuse_color:new Float32Array(3),diffuse_intensity:0,diffuse_toon_size:0,diffuse_toon_smooth:0,roughness:0,diffuse_fresnel:0,diffuse_fresnel_factor:0,darkness:0,alpha:0,specular_shader:"",specular_color:new Float32Array(3),specular_intensity:0,specular_toon_size:0,specular_toon_smooth:0,specular_hardness:0,specular_ior:0,specular_slope:0,specular_alpha:0,emit:0,ambient:0,water_settings:{is_water:!1,shore_smoothing:!1,absorb_factor:0,foam_factor:0,shallow_col:new Float32Array(3),shore_col:new Float32Array(3),shallow_col_fac:0,shore_col_fac:0,fog_color:new Float32Array(3),fog_density:0,sss_strength:0,sss_width:0,norm_uv_velocity:0,is_dynamic:!1,waves_height:0,waves_length:0,dst_noise_scale0:0,dst_noise_scale1:0,dst_noise_freq0:0,dst_noise_freq1:0,dir_min_shore_fac:0,dir_freq:0,dir_noise_scale:0,dir_noise_freq:0,dir_min_noise_fac:0,dst_min_fac:0,waves_hor_fac:0,is_generated_mesh:!1,num_cascads:0,num_subdivs:0,detailed_dist:0,enable_caust:!1,caust_scale:0,caust_brightness:0},terrain_settings:{is_terrain:!1,dynamic_grass_size:"",dynamic_grass_color:""},raytrace_mirror:{reflect_factor:0,fresnel:0,fresnel_factor:0},halo_settings:{size:0,hardness:0,rings_color:new Float32Array(3),lines_color:new Float32Array(3),ring_count:0,line_count:0,star_tip_count:0,is_sky_stars:!1,stars_blend_height:0,stars_min_height:0},physics_settings:{use_coll_physics:!1,use_ghost:!1,friction:0,elasticity:0,collision_id:"",collision_margin:0,collision_group:0,collision_mask:0}}}function a(){var e=r();return e.name="DEFAULT",e.type="SURFACE",e.uuid=i._4(),e.use_nodes=!1,e.node_tree=null,e.texture_slots=[],e.blend_mode="OPAQUE",e.use_shadeless=!1,e.use_transparency=!1,e.use_backface_culling=!0,e.use_vertex_color_paint=!1,e.use_double_sided_lighting=!1,e.render_above_all=!1,e.is_refractive=!1,e.refr_bump=0,e.pass_index=0,e.offset_z=0,e.diffuse_shader="LAMBERT",e.diffuse_color.set([.8,.8,.8]),e.diffuse_intensity=.8,e.alpha=1,e.specular_shader="COOKTORR",e.specular_color.set([1,1,1]),e.specular_intensity=.5,e.specular_hardness=50,e.specular_alpha=1,e.emit=0,e.ambient=1,e.water_settings.is_water=!1,e.terrain_settings.is_terrain=!1,e.raytrace_mirror.reflect_factor=0,e.raytrace_mirror.fresnel=0,e.raytrace_mirror.fresnel_factor=1.25,e.physics_settings.use_coll_physics=!1,e}function n(e,t){t.name=e.name,t.type=e.type,t.uuid=e.uuid,t.use_nodes=e.use_nodes,t.node_tree=e.node_tree,t.texture_slots=e.texture_slots,t.blend_mode=e.game_settings.alpha_blend,t.use_shadeless=e.use_shadeless,t.use_transparency=e.use_transparency,t.use_backface_culling=e.game_settings.use_backface_culling,t.use_tangent_shading=e.use_tangent_shading,t.use_orco_tex_coord=e.use_orco_tex_coord,t.use_vertex_color_paint=e.use_vertex_color_paint,t.use_double_sided_lighting=e.b4w_double_sided_lighting,t.do_not_render=e.b4w_do_not_render,t.render_above_all=e.b4w_render_above_all,t.is_lens_flares=e.b4w_lens_flares,t.is_wettable=e.b4w_wettable,t.is_refractive=e.b4w_refractive,t.refr_bump=e.b4w_refr_bump,t.pass_index=e.pass_index,t.offset_z=e.offset_z,t.diffuse_shader=e.diffuse_shader,t.diffuse_color.set(e.diffuse_color),t.diffuse_intensity=e.diffuse_intensity,t.diffuse_toon_size=e.diffuse_toon_size,t.diffuse_toon_smooth=e.diffuse_toon_smooth,t.roughness=e.roughness,t.diffuse_fresnel=e.diffuse_fresnel,t.diffuse_fresnel_factor=e.diffuse_fresnel_factor,t.darkness=e.darkness,t.alpha=e.alpha,t.specular_shader=e.specular_shader,t.specular_color.set(e.specular_color),t.specular_intensity=e.specular_intensity,t.specular_toon_size=e.specular_toon_size,t.specular_toon_smooth=e.specular_toon_smooth,t.specular_hardness=e.specular_hardness,t.specular_ior=e.specular_ior,t.specular_slope=e.specular_slope,t.specular_alpha=e.specular_alpha,t.emit=e.emit,t.ambient=e.ambient;var _=t.water_settings;_.is_water=e.b4w_water,_.shore_smoothing=e.b4w_water_shore_smoothing,_.absorb_factor=e.b4w_water_absorb_factor,_.foam_factor=e.b4w_foam_factor,_.shallow_col.set(e.b4w_shallow_water_col),_.shore_col.set(e.b4w_shore_water_col),_.shallow_col_fac=e.b4w_shallow_water_col_fac,_.shore_col_fac=e.b4w_shore_water_col_fac,_.fog_color.set(e.b4w_water_fog_color),_.fog_density=e.b4w_water_fog_density,_.sss_strength=e.b4w_water_sss_strength,_.sss_width=e.b4w_water_sss_width,_.norm_uv_velocity=e.b4w_water_norm_uv_velocity,_.is_dynamic=e.b4w_water_dynamic,_.waves_height=e.b4w_waves_height,_.waves_length=e.b4w_waves_length,_.dst_noise_scale0=e.b4w_water_dst_noise_scale0,_.dst_noise_scale1=e.b4w_water_dst_noise_scale1,_.dst_noise_freq0=e.b4w_water_dst_noise_freq0,_.dst_noise_freq1=e.b4w_water_dst_noise_freq1,_.dir_min_shore_fac=e.b4w_water_dir_min_shore_fac,_.dir_freq=e.b4w_water_dir_freq,_.dir_noise_scale=e.b4w_water_dir_noise_scale,_.dir_noise_freq=e.b4w_water_dir_noise_freq,_.dir_min_noise_fac=e.b4w_water_dir_min_noise_fac,_.dst_min_fac=e.b4w_water_dst_min_fac,_.waves_hor_fac=e.b4w_water_waves_hor_fac,_.is_generated_mesh=e.b4w_generated_mesh,_.num_cascads=e.b4w_water_num_cascads,_.num_subdivs=e.b4w_water_subdivs,_.detailed_dist=e.b4w_water_detailed_dist,_.enable_caust=e.b4w_water_enable_caust,_.caust_scale=e.b4w_water_caust_scale,_.caust_brightness=e.b4w_water_caust_brightness;var r=t.terrain_settings;r.is_terrain=e.b4w_terrain,r.dynamic_grass_size=e.b4w_dynamic_grass_size,r.dynamic_grass_color=e.b4w_dynamic_grass_color;var a=t.raytrace_mirror;a.reflect_factor=e.raytrace_mirror.reflect_factor,a.fresnel=e.raytrace_mirror.fresnel,a.fresnel_factor=e.raytrace_mirror.fresnel_factor;var n=t.halo_settings;n.size=e.halo.size,n.hardness=e.halo.hardness,n.rings_color.set(e.halo.b4w_halo_rings_color),n.lines_color.set(e.halo.b4w_halo_lines_color),n.ring_count=e.halo.ring_count,n.line_count=e.halo.line_count,n.star_tip_count=e.halo.star_tip_count,n.is_sky_stars=e.b4w_halo_sky_stars,n.stars_blend_height=e.b4w_halo_stars_blend_height,n.stars_min_height=e.b4w_halo_stars_min_height;var o=t.physics_settings;o.use_coll_physics=e.b4w_collision,o.use_ghost=e.b4w_use_ghost,o.friction=e.physics.friction,o.elasticity=e.physics.elasticity,o.collision_id=e.b4w_collision_id,o.collision_margin=e.b4w_collision_margin,o.collision_group=e.b4w_collision_group,o.collision_mask=e.b4w_collision_mask}function o(e){var t=e;t.name=e.name,t.type=e.type,t.uuid=e.uuid,t.use_nodes=e.use_nodes,t.node_tree=e.node_tree,t.texture_slots=e.texture_slots.slice(),t.blend_mode=e.blend_mode,t.use_shadeless=e.use_shadeless,t.use_transparency=e.use_transparency,t.use_backface_culling=e.use_backface_culling,t.use_tangent_shading=e.use_tangent_shading,t.use_orco_tex_coord=e.use_orco_tex_coord,t.use_vertex_color_paint=e.use_vertex_color_paint,t.use_double_sided_lighting=e.use_double_sided_lighting,t.do_not_render=e.do_not_render,t.render_above_all=e.render_above_all,t.is_lens_flares=e.is_lens_flares,t.is_wettable=e.is_wettable,t.is_refractive=e.is_refractive,t.refr_bump=e.refr_bump,t.pass_index=e.pass_index,t.offset_z=e.offset_z,t.diffuse_shader=e.diffuse_shader,t.diffuse_color.set(e.diffuse_color),t.diffuse_intensity=e.diffuse_intensity,t.diffuse_toon_size=e.diffuse_toon_size,t.diffuse_toon_smooth=e.diffuse_toon_smooth,t.roughness=e.roughness,t.diffuse_fresnel=e.diffuse_fresnel,t.diffuse_fresnel_factor=e.diffuse_fresnel_factor,t.darkness=e.darkness,t.alpha=e.alpha,t.specular_shader=e.specular_shader,t.specular_color.set(e.specular_color),t.specular_intensity=e.specular_intensity,t.specular_toon_size=e.specular_toon_size,t.specular_toon_smooth=e.specular_toon_smooth,t.specular_hardness=e.specular_hardness,t.specular_ior=e.specular_ior,t.specular_slope=e.specular_slope,t.specular_alpha=e.specular_alpha,t.emit=e.emit,t.ambient=e.ambient;var _=e.water_settings,r=t.water_settings;r.is_water=_.is_water,r.shore_smoothing=_.shore_smoothing,r.absorb_factor=_.absorb_factor,r.foam_factor=_.foam_factor,r.shallow_col.set(_.shallow_col),r.shore_col.set(_.shore_col),r.shallow_col_fac=_.shallow_col_fac,r.shore_col_fac=_.shore_col_fac,r.fog_color=_.fog_color,r.fog_density=_.fog_density,r.sss_strength=_.sss_strength,r.sss_width=_.sss_width,r.norm_uv_velocity=_.norm_uv_velocity,r.is_dynamic=_.is_dynamic,r.waves_height=_.waves_height,r.waves_length=_.waves_length,r.dst_noise_scale0=_.dst_noise_scale0,r.dst_noise_scale1=_.dst_noise_scale1,r.dst_noise_freq0=_.dst_noise_freq0,r.dst_noise_freq1=_.dst_noise_freq1,r.dir_min_shore_fac=_.dir_min_shore_fac,r.dir_freq=_.dir_freq,r.dir_noise_scale=_.dir_noise_scale,r.dir_noise_freq=_.dir_noise_freq,r.dir_min_noise_fac=_.dir_min_noise_fac,r.dst_min_fac=_.dst_min_fac,r.waves_hor_fac=_.waves_hor_fac,r.is_generated_mesh=_.is_generated_mesh,r.num_cascads=_.num_cascads,r.num_subdivs=_.num_subdivs,r.detailed_dist=_.detailed_dist,r.enable_caust=_.enable_caust,r.caust_scale=_.caust_scale,r.caust_brightness=_.caust_brightness;var a=e.terrain_settings,n=t.terrain_settings;n.is_terrain=a.is_terrain,n.dynamic_grass_size=a.dynamic_grass_size,n.dynamic_grass_color=a.dynamic_grass_color;var o=e.raytrace_mirror,i=t.raytrace_mirror;i.reflect_factor=o.reflect_factor,i.fresnel=o.fresnel,i.fresnel_factor=o.fresnel_factor;var s=e.halo_settings,E=t.halo_settings;E.size=s.size,E.hardness=s.hardness,E.rings_color.set(s.rings_color),E.lines_color.set(s.lines_color),E.ring_count=s.ring_count,E.line_count=s.line_count,E.star_tip_count=s.star_tip_count,E.is_sky_stars=s.is_sky_stars,E.stars_blend_height=s.stars_blend_height,E.stars_min_height=s.stars_min_height;var c=e.physics_settings,l=t.physics_settings;return l.use_coll_physics=c.use_coll_physics,l.use_ghost=c.use_ghost,l.friction=c.friction,l.elasticity=c.elasticity,l.collision_id=c.collision_id,l.collision_margin=c.collision_margin,l.collision_group=c.collision_group,l.collision_mask=c.collision_mask,t}t.c=r,t.b=a,t.d=n,t.a=o;var i=_(2)},function(e,t,_){"use strict";function r(e,t){function _(e,t,_){_||(_=[]);var r=e+t,a=e+2;_[0]=0;for(var n=2;n<=r;n++)_[n-1]=n>t&&n<a?_[n-2]+1:_[n-2];return _}function r(e,t,_,r,a){var n=r.length;a||(a=new Float32Array(n));for(var o=n+e,i=new Float32Array(o),s=1;s<=o-1;s++)t>=_[s-1]&&t<_[s+1-1]?i[s-1]=1:i[s-1]=0;for(var E=2;E<=e;E++)for(var s=1;s<=o-E;s++){if(0!=i[s-1])var c=(t-_[s-1])*i[s-1]/(_[s+E-1-1]-_[s-1]);else var c=0;if(0!=i[s+1-1])var l=(_[s+E-1]-t)*i[s+1-1]/(_[s+E-1]-_[s+1-1]);else var l=0;i[s-1]=c+l}t==_[o-1]&&(i[n-1]=1);for(var T=0,s=1;s<=n;s++)T+=i[s-1]*r[s-1];for(var s=1;s<=n;s++)a[s-1]=0!=T?i[s-1]*r[s-1]/T:0;return a}function a(e,t,_,r,a){var n=r.length;a||(a=new Float32Array(n));var o=new Float32Array(n),i=new Float32Array(n);s(n,e,t,_,o,i);for(var E=0,c=1;c<=n;c++)E+=o[c-1]*r[c-1];for(var l=0,c=1;c<=n;c++)l+=i[c-1]*r[c-1];for(var c=1;c<=n;c++)if(0!=E){var T=i[c-1]*r[c-1]/E,d=o[c-1]*r[c-1]*l/(E*E);a[c-1]=T+d}else a[c-1]=0;return a}function s(e,t,_,r,a,n){a||(a=new Float32Array(e)),n||(n=new Float32Array(e));for(var o=e+t,i=new Float32Array(o),s=new Float32Array(o),E=1;E<=o-1;E++)_>=r[E-1]&&_<r[E+1-1]?i[E-1]=1:i[E-1]=0;_==r[o-1]&&(i[e-1]=1);for(var c=2;c<=t;c++)for(var E=1;E<=o-c;E++){if(0!=i[E-1])var l=(_-r[E-1])*i[E-1]/(r[E+c-1-1]-r[E-1]);else var l=0;if(0!=i[E+1-1])var T=(r[E+c-1]-_)*i[E+1-1]/(r[E+c-1]-r[E+1-1]);else var T=0;if(0!=i[E-1])var d=i[E-1]/(r[E+c-1-1]-r[E-1]);else var d=0;if(0!=i[E+1-1])var u=-i[E+1-1]/(r[E+c-1]-r[E+1-1]);else var u=0;if(0!=s[E-1])var f=(_-r[E-1])*s[E-1]/(r[E+c-1-1]-r[E-1]);else var f=0;if(0!=s[E+1-1])var P=(r[E+c-1]-_)*s[E+1-1]/(r[E+c-1]-r[E+1-1]);else var P=0;i[E-1]=l+T,s[E-1]=d+u+f+P}for(var E=1;E<=e;E++)a[E-1]=i[E-1],n[E-1]=s[E-1];return a}function E(e,t,_){_||(_=[]);for(var a=e.cpoints,n=e.is_3d?4:3,o=e.weights,i=e.knot,s=e.order,E=a.length/n,c=E+s,l=0,T=i[c-1]/(t-1),d=0;d<t;d++){i[c-1]-l<5e-6&&(l=i[c-1]);for(var u=r(s,l,i,o),f=0;f<n;f++){_[n*d+f]=0;for(var P=0;P<E;P++){var A=u[P]*a[n*P+f];_[n*d+f]+=A}}l+=T}return _}function c(e,t){var _=(Math.max(t,0),l(e));return Math.min(t,_)}function l(e){var t=e.knot;return t[t.length-1]}function T(e){var t=e.cumulative_length;return t[t.length-1]}function d(e,t,_,r,a,n,o,i){var s=e+(t-e)/2,E=u(s,r,a,n,o),c=E-_;return i=i||.01,Math.abs(c)<i?s:c>0?d(e,s,_,r,a,n,o,i):d(s,t,_,r,a,n,o,i)}function u(e,t,_,r,a){var n=1-e;return t*n*n*n+3*_*n*n*e+3*r*n*e*e+a*e*e*e}var f=Object(n.a)(e);t.create_spline=function(e){var t={},r=e.data,a=r.splines[0];if(!a||"NURBS"!=a.type||!a.use_endpoint_u)return null;var n=a.order_u;t.order=n;var o=a.points,i=_(o.length/5,n,[]);t.knot=i,"2D"==r.dimensions?t.is_3d=!1:"3D"==r.dimensions?t.is_3d=!0:f.panic("Wrong curve dimensions");for(var s=[],c=[],l=0;l<o.length;l+=5)s.push(o[l]),s.push(o[l+1]),s.push(o[l+2]),t.is_3d&&s.push(o[l+3]),c.push(o[l+4]);t.cpoints=s,t.weights=c,o=E(t,1e3,[]);var T=t.is_3d?4:3,d=new Float32Array(1e3);d[0]=0;for(var l=1;l<1e3;l+=1){var u=o[(l-1)*T],P=o[(l-1)*T+1],A=o[(l-1)*T+2],S=o[l*T],p=o[l*T+1],O=o[l*T+2],v=Math.sqrt((S-u)*(S-u)+(p-P)*(p-P)+(O-A)*(O-A));d[l]=d[l-1]+v}return t.cumulative_length=d,t},t.spline_point=function(e,t,_){_||(_=[]),t=c(e,t);var a=e.cpoints,n=e.is_3d?4:3,o=e.weights,i=e.knot,s=e.order,E=a.length/n,l=E+s;i[l-1]-t<5e-6&&(t=i[l-1]);var T=new Float32Array(E);r(s,t,i,o,T);for(var d=0;d<n;d++){_[d]=0;for(var u=0;u<E;u++)_[d]+=T[u]*a[n*u+d]}return _},t.spline_derivative=function(e,t,_){_||(_=[]);var r=e.cpoints,n=e.is_3d?4:3,o=e.weights,i=e.knot,s=e.order,E=r.length/n,c=E+s;i[c-1]-t<5e-6&&(t=i[c-1]);var l=new Float32Array(E);a(s,t,i,o,l);for(var T=0;T<n;T++){_[T]=0;for(var d=0;d<E;d++)_[T]+=l[d]*r[n*d+T]}return _},t.spline_max_t=l,t.spline_length=T,t.spline_len_to_t=function(e,t){if(t<=0)return 0;var _=l(e);if(t>=T(e))return _;var r=e.cumulative_length,a=o.F(r,t,0,r.length-1);return _*(a+(t-r[a])/(r[a+1]-r[a]))/1e3},t.linear_interpolation=function(e,t,_,r,a){return _+(a-r)*(e-_)/(t-r)},t.linear=function(e,t,_){var r=t[0],a=t[1],n=_[0],o=_[1],i=(o-a)/(n-r);return i*e+(a-i*r)},t.bezier=function(e,t,_,r,a,n){return u(d(0,1,e,t[0],_[0],r[0],a[0],n),t[1],_[1],r[1],a[1])},t.calchandle_curvemap=function(e,t,_,r,a){var n=new Float32Array(3),o=new Float32Array(3),s=new Float32Array(3),E=new Float32Array(3),c=new Float32Array(3),l=new Float32Array(3);i.copy(e[1],o),null==t?(i.copy(_[1],s),n[0]=2*o[0]-s[0],n[1]=2*o[1]-s[1]):i.copy(t[1],n),null==_?(i.copy(t[1],n),s[0]=2*o[0]-n[0],s[1]=2*o[1]-n[1]):i.copy(_[1],s),i.subtract(o,n,E),i.subtract(s,o,c);var T=i.length(E),d=i.length(c);if(0==T&&(T=1),0==d&&(d=1),"AUTO"==r||"AUTO"==a){l[0]=c[0]/d+E[0]/T,l[1]=c[1]/d+E[1]/T;var u=2.5614*i.length(l);0!=u&&("AUTO"==r&&(T/=u,i.scaleAndAdd(o,l,-T,e[0])),"AUTO"==a&&(d/=u,i.scaleAndAdd(o,l,d,e[2])))}"VECTOR"==r&&i.scaleAndAdd(o,E,-1/3,e[0]),"VECTOR"==a&&i.scaleAndAdd(o,c,1/3,e[2])},t.correct_bezpart=function(e,t,_,r){var a,n,o,i,s=[],E=[];s[0]=e[0]-t[0],s[1]=e[1]-t[1],E[0]=r[0]-_[0],E[1]=r[1]-_[1],o=r[0]-e[0],a=Math.abs(s[0]),n=Math.abs(E[0]),a+n!=0&&a+n>o&&(i=o/(a+n),t[0]=e[0]-i*s[0],t[1]=e[1]-i*s[1],_[0]=r[0]-i*E[0],_[1]=r[1]-i*E[1])}}var a=_(0),n=_(5),o=_(2),i=_(3),s=Object(a.a)("__curve",r);t.a=s},function(e,t,_){"use strict";function r(e,t){var _=Object(n.a)(e),r=Object(i.a)(e),a=Object(o.a)(e),c=Object(s.a)(e),l=Object(E.a)(e);t.P_LOW=_.P_LOW,t.P_HIGH=_.P_HIGH,t.P_ULTRA=_.P_ULTRA,t.P_CUSTOM=_.P_CUSTOM,t.P_AUTO=_.P_AUTO,t.set=_.set,t.get=_.get,t.reset=_.reset,t.reset_limits=_.reset_limits,t.get_std_assets_path=_.get_assets_path,t.get_assets_path=_.get_assets_path,t.apply_quality=function(e){if(c.is_primary_loaded())return void l.error("Cannot change quality profile after a scene is loaded.");_.set("quality",e),a.get_gl()&&(_.apply_quality(),r.set_hardware_defaults(a.get_gl(),!1))}}var a=_(0),n=_(4),o=_(66),i=_(35),s=_(42),E=_(1),c=Object(a.a)("config",r);t.a=c},function(e,t,_){"use strict";function r(e,t){var _=Object(n.a)(e),r=Object(o.a)(e);t.load=_.load,t.unload=function(e){e|=0,_.unload(e)},t.set_debug_resources_root=_.set_debug_resources_root,t.is_primary_loaded=_.is_primary_loaded,t.is_idle=r.is_finished,t.load_and_add_new=_.load,t.cleanup=t.unload,t.activate_media=_.activate_media,t.prefetch=_.prefetch,t.unfetch=_.unfetch}var a=_(0),n=_(42),o=_(65),i=Object(a.a)("data",r);t.a=i},function(e,t,_){"use strict";function r(e,t){function _(e,t,_,r){Te.group(Se.subs_label(e),r);for(var a=0;a<_.length;a++){var n=_[a],o=n.render;if(o.type==r)for(var i=!1,s=0;s<t.length;s++){for(var E=t[s].bundles,c=0;c<E.length;c++){var l=E[c];if(l.do_render&&l.obj_render==o){"STATIC"==r?Te.log_raw(n.origin_name,n):Te.log_raw(n.name,n),i=!0;break}}if(i)break}}Te.groupEnd()}function r(e,t){var _=oe.get_debug_shaders();if(!_)return void Te.warn("WEBGL_debug_shaders extension not found");var r=_.getTranslatedShaderSource(e),a=_.getTranslatedShaderSource(t);if(q.detect_mobile()){r=r.replace("#version","#version 300 //"),a=a.replace("#version","#version 300 //");var o=G("/analyze_shader/vert_gles",r),i=G("/analyze_shader/frag_gles",a)}else{r=r.replace("#version","#version 400 //"),a=a.replace("#version","#version 400 //");var o=G("/analyze_shader/vert",r),i=G("/analyze_shader/frag",a)}var s=n(o),E=n(i);return{vsrc:Z.get_gl().getShaderSource(e),vsrc_trans:r,vout:o,vstats:s,fsrc:Z.get_gl().getShaderSource(t),fsrc_trans:a,fout:i,fstats:E}}function n(e){var t={};if(!e)return t;for(var _=e.split("\n"),r=0;r<_.length;r++){var a=_[r];if(-1!=a.search(new RegExp(/^[A-Z.]+ ?/))){var n=a.split(" ")[0];n in t||(t[n]=0),t[n]++}}var o=0,i=0,s=0;for(var n in t)switch(n){case"KIL":case"TEX":case"TXB":case"TXP":case"KIL.F":case"TEX.F":case"TXB.F":case"TXD.F":case"TXL.F":case"TXQ.F":case"TXP.F":i+=t[n],o+=t[n];break;case"ATTRIB":s+=t[n];break;case"ADDRESS":case"PARAM":case"TEMP":case"ALIAS":case"OUTPUT":case"END":break;default:o+=t[n]}return t.ALL_OPS=o,t.TEX_OPS=i,t.ATTRIBS=s,t}function G(e,t){var _=new XMLHttpRequest;if(_.open("POST",e,!1),_.send(t),200==_.status)return _.responseText;throw Te.error(_.responseText),"Error POST XHR: "+_.status}function k(e){e.sort(function(e,t){return t.fstats.ALL_OPS-e.fstats.ALL_OPS});for(var t=0;t<e.length;t++){var _=e[t],r=_.fstats,a=_.vstats,n=K(_.cshader);n=n.length?"\t\t("+n.join(", ")+")":"\t\t(NA)",Te.groupCollapsed("VERT ->","OPS",a.ALL_OPS,"ATT",a.ATTRIBS,"TEX",a.TEX_OPS,"\t\tFRAG ->","OPS",r.ALL_OPS,"TEX",r.TEX_OPS,n),Te.groupCollapsed("directives");for(var o=_.shaders_info.directives.slice().sort(),i=0;i<o.length;i++){var s=o[i];Te.log_raw(s[0],s[1])}Te.groupEnd(),Te.groupCollapsed("node elements");for(var E=_.shaders_info.node_elements,i=0;i<E.length;i++)Te.log_raw(E[i]);Te.groupEnd(),Te.groupCollapsed("vert source"),Te.log_raw(_.vsrc),Te.groupEnd(),Te.groupCollapsed("vert translated source"),Te.log_raw(_.vsrc_trans),Te.groupEnd();var c=["ALL_OPS","TEX_OPS","ATTRIBS"];Te.groupCollapsed("vert ops stats");for(var l in a)-1==c.indexOf(l)&&Te.log_raw(l,a[l]);Te.groupEnd(),Te.groupCollapsed("vert assembly"),Te.log_raw(_.vout),Te.groupEnd(),Te.groupCollapsed("frag source"),Te.log_raw(_.fsrc),Te.groupEnd(),Te.groupCollapsed("frag translated source"),Te.log_raw(_.fsrc_trans),Te.groupEnd(),Te.groupCollapsed("frag ops stats");for(var l in r)-1==c.indexOf(l)&&Te.log_raw(l,r[l]);Te.groupEnd(),Te.groupCollapsed("frag assembly"),Te.log_raw(_.fout),Te.groupEnd(),Te.groupEnd()}}function K(e){for(var t=[],_=ue.get_all_scenes(),r=0;r<_.length;r++)for(var a=_[r],n=Ee.get_scene_objs(a,"MESH",Ee.DATA_ID_ALL),o=0;o<n.length;o++){var i=n[o],s=ce.get_scene_data(i,a);if(s&&s.batches.length)for(var E=s.batches,c=0;c<E.length;c++){var l=E[c];if(l.shader==e)for(var T=0;T<l.material_names.length;T++){var d=l.material_names[T];-1==t.indexOf(d)&&t.push(d)}}}return t}function B(e,t){var _=function(){return Ye.push(_),e.apply(e,arguments)};return _}function X(e,t,_,r,a){if(typeof t!=typeof e)throw"debug.eqv: wrong expected data type";if(e.length!=t.length)throw"debug.eqv: wrong expected vector length";_=_||he;for(var n=0;n<e.length;n++){if("number"!=typeof t[n]||isNaN(t[n]))throw"debug.eqv: wrong expected data type";if("number"!=typeof e[n]||isNaN(e[n]))throw"debug.eqv: wrong result data type";if(t[n]>e[n]+_||t[n]<e[n]-_)throw"debug.eqv: wrong result"}H(r,a,"eqv")}function H(e,t,_){if(e=e||"",t=t||"",ye){if(""==e)throw"debug."+_+': no error is expected, but got "'+Me+'"';if(Me!=e)throw"debug."+_+': error "'+e+'" is expected, but got "'+Me+'"'}else if(""!=e)throw"debug."+_+': error "'+e+'" is expected, but got nothing';if(xe){if(""==t)throw"debug."+_+': no warning is expected, but got "'+Le+'"';if(Le!=t)throw"debug."+_+': warning "'+t+'" is expected, but got "'+Le+'"'}else if(""!=t)throw"debug."+_+': warning "'+t+'" is expected, but got nothing';xe=!1,ye=!1}function j(){Ie&&(Ee.obj_switch_cleanup_flags(Ie,!1,!1,!1),$.prepare_object_unloading(Ie),Ee.obj_switch_cleanup_flags(Ie,!0,!0,!0),Ee.remove_object(Ie),Ie=null)}var Q=Object(o.a)(e),z=Object(i.a)(e),V=Object(s.a)(e),q=Object(c.a)(e),W=Object(l.a)(e),J=Object(T.a)(e),Z=Object(E.a)(e),$=Object(d.a)(e),ee=Object(u.a)(e),te=Object(f.a)(e),_e=Object(P.a)(e),re=Object(A.a)(e),ae=Object(S.a)(e),ne=Object(p.a)(e),oe=Object(O.a)(e),ie=Object(v.a)(e),se=Object(m.a)(e),Ee=Object(N.a)(e),ce=Object(g.a)(e),le=Object(R.a)(e),Te=Object(I.a)(e),de=Object(b.a)(e),ue=Object(h.a)(e),fe=Object(Y.a)(e),Pe=Object(L.a)(e),Ae=Object(M.a)(e),Se=Object(x.a)(e),pe=Object(U.a)(e),Oe=Object(y.a)(e),ve=Object(w.a)(e),me=C.b(),Ne=new Float32Array(2),ge=F.create(),Re=F.create(),Ie=null,be=V.defaults,he=1e-6,Ye=[],Le="",Me="",xe=!1,ye=!1,Ue=!0,we=new Uint8Array(4);t.DV_NONE=re.DV_NONE,t.DV_OPAQUE_WIREFRAME=re.DV_OPAQUE_WIREFRAME,t.DV_TRANSPARENT_WIREFRAME=re.DV_TRANSPARENT_WIREFRAME,t.DV_FRONT_BACK_VIEW=re.DV_FRONT_BACK_VIEW,t.DV_BOUNDINGS=re.DV_BOUNDINGS,t.DV_CLUSTERS_VIEW=re.DV_CLUSTERS_VIEW,t.DV_BATCHES_VIEW=re.DV_BATCHES_VIEW,t.DV_RENDER_TIME=re.DV_RENDER_TIME,t.physics_stats=function(){le.debug_workers()},t.physics_id=function(e){Te.log("O",le.find_obj_by_body_id(e));var t=le.get_active_scene();if(!t)return void Te.error("No active physics scene.");for(var _=t._physics.bundles,r=0;r<_.length;r++){var a=_[r];a.physics.body_id==e&&Te.log("B",a)}},t.visible_objects=function(){for(var e=ue.get_active(),t=Ee.get_scene_objs(e,"MESH",Ee.DATA_ID_ALL),r=ue.subs_array(e,[Se.MAIN_OPAQUE,Se.MAIN_BLEND,Se.MAIN_GLOW]),a=0;a<r.length;a++){var n=r[a],o=n.draw_data;o.length&&(_(n,o,t,"DYNAMIC"),_(n,o,t,"STATIC"))}},t.object_info=function(e){for(var t=ue.get_active(),_=Ee.get_scene_objs(t,"MESH",Ee.DATA_ID_ALL),r=0;r<_.length;r++){var a=_[r];if(a.name==e){Te.log("Object",a);for(var n=ue.get_all_subscenes(t),o=0;o<n.length;o++){for(var i=n[o],s=[],E=i.draw_data,c=0;c<E.length;c++)for(var l=E[c].bundles,T=0;T<l.length;T++)l[T].obj_render==a.render&&s.push(l[T]);Te.log("Subscene "+i.type,s)}}}},t.objects_stat=function(){var e=ue.get_active();Te.log("Armatures: "+Ee.get_scene_objs(e,"ARMATURE",Ee.DATA_ID_ALL).length),Te.log("Cameras: "+Ee.get_scene_objs(e,"CAMERA",Ee.DATA_ID_ALL).length),Te.log("Curves: "+Ee.get_scene_objs(e,"CURVE",Ee.DATA_ID_ALL).length),Te.log("Empties: "+Ee.get_scene_objs(e,"EMPTY",Ee.DATA_ID_ALL).length),Te.log("Lamps: "+Ee.get_scene_objs(e,"LAMP",Ee.DATA_ID_ALL).length),Te.log("Meshes: "+Ee.get_scene_objs(e,"MESH",Ee.DATA_ID_ALL).length),Te.log("Speakers: "+Ee.get_scene_objs(e,"SPEAKER",Ee.DATA_ID_ALL).length)},t.num_vertices=function(){for(var e=0,t=ue.get_active(),_=ue.subs_array(t,[Se.MAIN_OPAQUE,Se.MAIN_BLEND,Se.MAIN_GLOW]),r=0;r<_.length;r++)for(var a=_[r],n=a.draw_data,o=0;o<n.length;o++)for(var i=n[o].bundles,s=0;s<i.length;s++){var E=i[s].batch;E&&(e+=E.num_vertices)}return e},t.num_triangles=function(){for(var e=0,t=ue.get_active(),_=ue.subs_array(t,[Se.MAIN_OPAQUE,Se.MAIN_BLEND,Se.MAIN_GLOW]),r=0;r<_.length;r++)for(var a=_[r],n=a.draw_data,o=0;o<n.length;o++)for(var i=n[o].bundles,s=0;s<i.length;s++){var E=i[s].batch;E&&(e+=E.num_triangles)}return e},t.num_draw_calls=function(){for(var e=ue.get_active(),t=ue.subs_array(e,[Se.MAIN_OPAQUE,Se.MAIN_BLEND,Se.MAIN_GLOW,Se.MAIN_PLANE_REFLECT,Se.MAIN_PLANE_REFLECT_BLEND]),_=0,r=0;r<t.length;r++)for(var a=t[r],n=a.draw_data,o=0;o<n.length;o++)_+=n[o].bundles.length;for(var i=ue.subs_array(e,[Se.MAIN_CUBE_REFLECT,Se.MAIN_CUBE_REFLECT_BLEND]),r=0;r<i.length;r++)for(var a=i[r],n=a.draw_data,o=0;o<n.length;o++)_+=6*n[o].bundles.length;return _},t.num_shaders=function(){var e=Ae.get_compiled_shaders();return D._8(e)},t.geometry_stats=function(){for(var e=ue.get_active(),t=ue.get_all_subscenes(e),_={},r=0;r<t.length;r++){var a=t[r];if(a.type!=Se.SINK&&a.type!=Se.DEBUG_VIEW)for(var n=a.draw_data,o=0;o<n.length;o++)for(var i=n[o].bundles,s=0;s<i.length;s++){var E=i[s].batch,c=i[s].obj_render;E&&(a.type!=Se.COLOR_PICKING&&a.type!=Se.OUTLINE_MASK||c.origin_selectable||c.origin_outlining)&&(_[E.id]=E)}}var l=0,T=0;for(var d in _){var u=_[d].bufs_data;u.debug_ibo_bytes&&(T+=u.debug_ibo_bytes/1048576),l+=u.debug_vbo_bytes/1048576}return{vbo_memory:l,ibo_memory:T}},t.num_textures=function(){for(var e=[],t=0,_=ue.get_active(),r=ue.subs_array(_,[Se.MAIN_OPAQUE,Se.MAIN_BLEND,Se.MAIN_GLOW]),a=0;a<r.length;a++)for(var n=r[a],o=n.draw_data,i=0;i<o.length;i++)for(var s=o[i].bundles,E=0;E<s.length;E++){var c=s[E].batch;if(c)for(var l=c.textures,T=0;T<l.length;T++){var d=l[T];if("IMAGE"===d.source||"ENVIRONMENT_MAP"===d.source){var u=d.w_texture;if(-1===e.indexOf(u)){e.push(u);var f=d.width*d.height*4/1048576/d.compress_ratio;f*=1.3333,t+=f}}}}return{number:e.length,memory:t}},t.num_render_targets=function(){for(var e=[],t=0,_=ue.get_active(),r=ue.get_all_subscenes(_),a=0;a<r.length;a++){var n=r[a];if(n.type!=Se.SINK){var o=n.camera,i=[o.color_attachment,o.depth_attachment];i.push.apply(i,n.textures_internal);for(var s=0;s<i.length;s++){var E=i[s];Oe.is_texture(E)&&-1==e.indexOf(E)&&(e.push(E),t+=o.width*o.height*Oe.get_texture_texel_size(E))}}}return{number:e.length,memory:t/1024/1024}},t.make_camera_frustum_shot=function(){var e=ue.get_active(),t=ue.get_subs(e,Se.MAIN_OPAQUE);t&&ue.make_frustum_shot(t.camera,t,[1,1,0])},t.make_light_frustum_shot=function(){var e=ue.get_active(),t=ue.get_subs(e,Se.MAIN_OPAQUE),_=ue.subs_array(e,[Se.SHADOW_CAST]);if(t)for(var r=0;r<_.length;r++){var a,n=_[r];switch(r){case 0:a=[1,0,0];break;case 1:a=[0,1,0];break;case 2:a=[0,0,1];break;default:a=[1,0,1]}ue.make_frustum_shot(n.camera,t,a)}},t.scenegraph_to_dot=function(){for(var e=ue.get_all_scenes(),t=0;t<e.length;t++){var _=e[t],r=ue.get_graph(_);Te.log("\n"+fe.debug_convert_to_dot(r))}},t.loading_graph_to_dot=function(e){e|=0,Te.log("\n"+se.graph_to_dot(e))},t.controls_info=W.debug,t.object_distance=function(e,t){var _=C.j(e.render.world_tsr),r=C.j(t.render.world_tsr);return F.dist(_,r)},t.msg=function(){ae.msg.apply(ae,arguments)},t.fbmsg=function(){ae.fbmsg.apply(ae,arguments)},t.print_telemetry=function(){ae.print_telemetry.apply(ae,arguments)},t.plot_telemetry=function(){ae.plot_telemetry.apply(ae,arguments)},t.fbres=function(e,t){t||(t=16);var _=function(){ae.fbmsg("FBRES",e()),setTimeout(_,t)};_()},t.assert_constants=function(){var e=new Float32Array(3),t=new Float32Array([0,0,0,1]),_=new Float32Array([1,0,0]),r=new Float32Array([0,1,0]),a=new Float32Array([0,0,1]),n=new Float32Array([-1,0,0]),o=new Float32Array([0,-1,0]),i=new Float32Array([0,0,-1]);if(!D.P(e,D.m))throw"Wrong VEC3_IDENT";if(!D.P(t,D.k))throw"Wrong QUAT4_IDENT";if(!D.P(_,D.d))throw"Wrong AXIS_X";if(!D.P(r,D.e))throw"Wrong AXIS_Y";if(!D.P(a,D.f))throw"Wrong AXIS_Z";if(!D.P(n,D.a))throw"Wrong AXIS_MX";if(!D.P(o,D.b))throw"Wrong AXIS_MY";if(!D.P(i,D.c))throw"Wrong AXIS_MZ"},t.mute_music=function(){for(var e=Pe.get_speaker_objects(),t=0;t<e.length;t++){var _=e[t];"BACKGROUND_MUSIC"==Pe.get_spk_behavior(_)&&Pe.mute(_,!0)}},t.check_finite=function(e){return _e.finite(e)},t.set_debug_params=function(e){var t=ue.get_active(),_=ue.subs_array(t,[Se.DEBUG_VIEW]);if(!_.length)return void Te.error("Debugging is not available on the scene.");for(var r=0;r<_.length;r++){var a=_[r];if("number"==typeof e.debug_view_mode)switch(e.debug_view_mode){case re.DV_NONE:case re.DV_OPAQUE_WIREFRAME:case re.DV_TRANSPARENT_WIREFRAME:case re.DV_FRONT_BACK_VIEW:case re.DV_BOUNDINGS:case re.DV_CLUSTERS_VIEW:case re.DV_BATCHES_VIEW:case re.DV_RENDER_TIME:ue.set_debug_view_mode(a,e.debug_view_mode);break;default:Te.error("set_debug_params(): Wrong debug view mode")}"number"==typeof e.debug_colors_seed&&ue.set_debug_colors_seed(a,e.debug_colors_seed),"number"==typeof e.render_time_threshold&&ue.set_render_time_threshold(a,e.render_time_threshold),"object"==typeof e.wireframe_edge_color&&ue.set_wireframe_edge_color(a,D._1(e.wireframe_edge_color))}},t.get_error_quantity=function(){return Te.get_error_count()},t.get_warning_quantity=function(){return Te.get_warning_count()},t.clear_errors_warnings=function(){return Te.clear_errors_warnings()},t.analyze_shaders=function(e){var t=Ae.get_compiled_shaders(),_=0;for(var a in t)e&&-1===a.indexOf(e)||_++;var n="of "+_+" analyzing...",o={};for(var a in t)if(!e||-1!==a.indexOf(e)){var i=t[a],s=r(i.vshader,i.fshader);if(s){var E=i.shaders_info,c=E.vert+" + "+E.frag;s.cshader=i,s.shaders_info=E;var l=o[c]=o[c]||[];l.push(s),Te.log_raw(n)}}for(var c in o){Te.group("%c"+c,"color: #800");var l=o[c];k(l),Te.groupEnd()}},t.fake_load=function(e,t,_,r,a){e=e||null,e||Q.panic("Stage load callback is undefined"),t=t||5e3,_=_||0,r=r||100,r>100&&Q.panic("Max percentage must be less than 100"),_<0&&Q.panic("Min percentage must be greater than 0"),_>r&&Q.panic("Max percentage must be greater than min percentage");var n=pe.animate(_,r,t,function(t){var _=t.toFixed();if(e(_),100==_)return pe.clear_animation(n),void(a&&a())})},t.test_performance=function(e){if(!Ae.check_shaders_loaded())return void window.setTimeout(function(){t.test_performance(e)},100);if(!oe.get_disjoint_timer_query())return void e(0,0);var _=be.gl_debug;be.gl_debug=!0;var r=fe.create_performance_graph();ue.generate_auxiliary_batches(null,r);for(var a=fe.find_subs(r,Se.PERFORMANCE),n=a.camera,o=0;o<5;o++)de.draw(a);be.gl_debug=_,window.setTimeout(function(){ne.process_timer_queries(a);var t=a.debug_render_time,_=n.width*n.height*4*10/(t/1e3)/Math.pow(10,9);e(t,_)},100)},t.calc_vbo_garbage_byte_size=ee.calc_vbo_garbage_byte_size,t.show_vbo_garbage_info=ee.show_vbo_garbage_info,t.print_batches_stat=function(){te.print_batches_stat()},t.start_debug=function(e){Ye=[],Ue=!0,"string"==typeof e&&(e=a.a.require(e));for(var t in e)"function"==typeof e[t]&&(e[t]=B(e[t],t))},t.check_debug_result=function(){return Ue},t.test=function(e,t){var _=Te.error,r=Te.error_once,a=Te.warn;Te.error=Te.error_once=function(){var e=Te.compose_args_prefix(arguments,"B4W ERROR");Me=e.join(" "),ye=!0},Te.warn=function(){var e=Te.compose_args_prefix(arguments,"B4W WARN");Le=e.join(" "),xe=!0},xe=!1,ye=!1;try{t();var n=!0}catch(t){Ue=!1,console.error('Test "'+e+'" failed with exception: "'+t+'"');var n=!1;xe=!1,ye=!1}return Te.error=_,Te.error_once=r,Te.warn=a,n},t.pix=function(e){var t=J.get_viewport_width(),_=J.get_viewport_height(),r=t/2,a=_/2;J.resize(t,_,!1);var n=ue.get_active(),o=n._render.graph,i=fe.find_on_screen(o);i||Q.panic("Couldn't find onscreen subscene");var s=i.camera,E=J.canvas_to_viewport_coords(r,a,Ne,i.camera);E[1]=s.height-E[1],X(e,de.read_pixels(s.framebuffer,E[0],E[1],1,1,we),1)},t.eqs=function(e,t,_,r){if(JSON.stringify(e)!=JSON.stringify(t))throw"debug.eqs: wrong result";H(_,r,"eqs")},t.eqv=X,t.eqf=function(e,t,_,r,a){if("number"!=typeof t||isNaN(t))throw"debug.eqf: wrong expected data type";if("number"!=typeof e||isNaN(e))throw"debug.eqf: wrong result data type";if(_=_||he,t>e+_||t<e-_)throw"debug.eqf: wrong result";H(r,a,"eqf")},t.eq=function(e,t,_,r){if(e!==t)throw"debug.eq: wrong result";H(_,r,"eq")},t.ok=function(e,t,_){if(!Boolean(e))throw"debug.ok: wrong result";H(t,_,"ok")},t.stat=function(e){var t=[];"string"==typeof e&&(e=a.a.require(e));for(var _ in e)-1==Ye.indexOf(e[_])&&"function"==typeof e[_]&&t.push(_);if(t.length){Te.groupCollapsed(t.length+" function(s) not tested.");for(var r=0;r<t.length;r++)Te.log_raw(t[r]);Te.groupEnd()}else Te.group("All functions were tested.")},t.show_normals=function(e,t,_,r){j();var a=z.find_batch_material(e,t,"MAIN");if(!ie.has_dyn_geom(e)||!a)return Te.error("Normals are not avaliable for the dynamic object:",e.name),!1;var n=a.bufs_data;if(!(n&&n.pointers&&n.pointers.a_position&&n.pointers.a_tbn))return Te.error("Normals are not avaliable for the object:",e.name),!1;var o=ie.extract_array_float(n,"a_position"),i=ie.extract_array_float(n,"a_normal"),s=ve.get_tsr(e,me);Ie=Ee.create_line("normal_line");for(var E=new Float32Array(2*o.length),c=0;c<o.length;c+=3){var l=ge;l[0]=o[c+0],l[1]=o[c+1],l[2]=o[c+2];var T=C.B(l,s,Re);E[2*c+0]=T[0],E[2*c+1]=T[1],E[2*c+2]=T[2];var d=F.scale(i.subarray(c,c+3),_,Re),u=F.add(l,d,Re),f=C.B(u,s,Re);E[2*c+3]=f[0],E[2*c+4]=f[1],E[2*c+5]=f[2]}var P=z.get_first_batch(Ie);ie.draw_line(P,E,!0),de.assign_attribute_setters(P),P.diffuse_color.set([1,1,1,1]),P.line_width=r},t.hide_normals=j}var a=_(32),n=_(0),o=_(5),i=_(16),s=_(4),E=_(66),c=_(35),l=_(53),T=_(15),d=_(42),u=_(71),f=_(94),P=_(44),A=_(45),S=_(62),p=_(72),O=_(28),v=_(20),m=_(65),N=_(12),g=_(8),R=_(19),I=_(1),b=_(22),h=_(10),Y=_(64),L=_(23),M=_(34),x=_(11),y=_(17),U=_(18),w=_(13),C=_(6),D=_(2),F=_(3),G=Object(n.a)("debug",r);t.a=G},function(e,t,_){"use strict";function r(e,t){function _(e,t,_){var a=r.get_canvas();if(a.toBlob)a.toBlob(e,t,_);else{for(var n=atob(a.toDataURL(t,_).split(",")[1]),o=new Uint8Array(n.length),i=0;i<n.length;i++)o[i]=n.charCodeAt(i);e(new Blob([o],{type:t||"image/png"}))}}var r=Object(n.a)(e),a={callback:null,format:"image/png",quality:1,blob_url:"",last_auto_revoke:!1,curr_auto_revoke:!1};t.canvas_data_url=function(e,t,_,r){a.curr_auto_revoke=void 0!==r||r,a.last_auto_revoke=a.curr_auto_revoke,a.callback=e,a.format=t||a.format,a.quality=_||a.quality},t.frame=function(e,t){var r=a.callback;r&&(a.last_auto_revoke&&a.blob_url&&URL.revokeObjectURL(a.blob_url),_(function(e){navigator.msSaveOrOpenBlob?r(e):(a.blob_url=URL.createObjectURL(e),r(a.blob_url))},a.format,a.quality),a.callback=null,a.format="image/png",a.quality=1)}}var a=_(0),n=_(15),o=Object(a.a)("__main",r);t.a=o},function(e,t,_){"use strict";function r(e,t){t.create=o.b,t.from_values=o.e,t.copy=o.a,t.identity=o.l,t.set_sep=o.s,t.set_trans=o.t,t.set_scale=o.r,t.set_transcale=o.u,t.set_quat=o.q,t.get_trans_view=o.j,t.get_scale=o.h,t.get_quat_view=o.g,t.invert=o.o,t.to_mat4=function(e,t){return t||(t=n.create()),o.v(e,t),t},t.from_mat4=o.d,t.multiply=o.p,t.transform_vec3=o.B,t.transform_vec3_inv=o.C,t.transform_vectors=o.D,t.transform_dir_vectors=o.x,t.transform_dir_vec3=o.w,t.transform_tangents=o.A,t.translate=o.E,t.interpolate=function(e,t,_,r){return r||(r=o.b()),o.n(e,t,_,r),r}}var a=_(0),n=_(21),o=_(6),i=Object(a.a)("tsr",r);t.a=i},function(e,t,_){"use strict";function r(e,t){function _(){u.remove_sensor_manifold(null,"VR_CONTROLLERS")}function r(e,t){function _(t,_,r){if(r>0){var n=P.get_active_camera();if(!n)return;if(a.is_eye_camera(n)){var o=u.get_sensor_payload(t,_,1),i=u.get_sensor_payload(t,_,2),E=d.add(i,y,R);if(S.set_translation_v(n,E),o)if(e==w){o=s.multiply(x,o,M);var c=d.transformQuat(p.AXIS_MY,o,R);a.set_vertical_axis(n,c),S.set_rotation_v(n,o)}else if(e==C||e==D){var l=S.get_rotation(n,Y),T=s.invert(l,Y),f=s.multiply(O,T,Y),A=a.get_vertical_axis(n,R);if(Math.abs(A[2])<Math.PI/4)var m=d.cross(A,p.AXIS_MY,I);else if(Math.abs(A[1])<Math.PI/4)var m=d.cross(A,p.AXIS_Z,I);d.normalize(m,m);var N=d.transformQuat(m,f,b),g=d.dot(A,N),U=d.scaleAndAdd(N,A,-g,b);d.normalize(U,U);var F=d.cross(A,m,R),G=Math.acos(p.clamp(d.dot(m,U),0,1)),k=p.sign(d.dot(U,F)),K=G*k;v+=K;var B=s.setAxisAngle(p.AXIS_Z,-v,Y);if(e==D)var X=s.multiply(B,o,h);else var H=p.quat_project(o,p.AXIS_MZ,p.AXIS_Z,p.AXIS_Y,L),j=s.invert(H,L),Q=s.multiply(j,o,L),X=s.multiply(B,Q,h);var c=d.transformQuat(p.AXIS_MY,X,R);a.set_vertical_axis(n,c),S.set_rotation_v(n,X),s.copy(X,O)}}}}if(t){var r=P.get_active_camera();r&&A.request_split_screen(function(){a.is_eye_camera(r)||(m=a.is_target_camera(r),N=a.is_hover_camera(r),g=a.is_static_camera(r),a.eye_setup(r));var e=u.create_elapsed_sensor(),n=u.create_hmd_position_sensor();O=S.get_rotation(r,O),u.create_sensor_manifold(null,"HMD_ROTATE_CAMERA",u.CT_CONTINUOUS,[e,t,n],null,_)})}}var a=Object(n.a)(e),u=Object(o.a)(e),f=Object(i.a)(e),P=Object(E.a)(e),A=Object(c.a)(e),S=Object(l.a)(e),p=Object(T.a)(e),O=s.create(),v=0,m=!1,N=!1,g=!1,R=d.create(),I=d.create(),b=d.create(),h=s.create(),Y=s.create(),L=s.create(),M=s.create(),x=s.create(),y=d.create(),U={pivot:d.create()};t.HMD_NONE_MOUSE_ALL_AXES=0;var w=1;t.HMD_ALL_AXES_MOUSE_NONE=w;var C=2;t.HMD_ROLL_PITCH_MOUSE_YAW=C;var D=3;t.HMD_ALL_AXES_MOUSE_YAW=D,t.enable_hmd=function(e){var t=null,_=f.get_device_by_type_element(f.DEVICE_HMD);_&&(t=f.get_value_param(_,f.HMD_WEBVR_TYPE)&(f.HMD_WEBVR_MOBILE|f.HMD_WEBVR_DESKTOP|f.HMD_WEBVR1)?u.create_hmd_quat_sensor():u.create_gyro_quat_sensor(),r(e,t))},t.check_browser_support=function(){return Boolean(f.can_use_device(f.DEVICE_HMD))},t.enable_controllers=function(e,t){function r(_,r,a){if(e){var n=u.get_sensor_payload(_,r,0),o=u.get_sensor_payload(_,r,2);d.add(y,n,n),S.set_translation_v(e,n),S.set_rotation_v(e,o)}if(t){var i=u.get_sensor_payload(_,r,1),s=u.get_sensor_payload(_,r,3);d.add(y,i,i),S.set_translation_v(t,i),S.set_rotation_v(t,s)}}if(_(),e||t){var a=f.get_vr_controller_id(0),n=u.create_gamepad_position_sensor(a),o=u.create_gamepad_orientation_sensor(a),i=f.get_vr_controller_id(1),s=u.create_gamepad_position_sensor(i),E=u.create_gamepad_orientation_sensor(i);u.create_sensor_manifold(null,"VR_CONTROLLERS",u.CT_CONTINUOUS,[n,s,o,E],null,r)}},t.disable_controllers=_,t.disable_hmd=function(){if(u.check_sensor_manifold(null,"HMD_ROTATE_CAMERA")){u.remove_sensor_manifold(null,"HMD_ROTATE_CAMERA"),A.exit_split_screen();var e=P.get_active_camera();m?a.target_setup(e,U):N?a.hover_setup(e,U):g&&a.static_setup(e,U),a.set_vertical_axis(e,p.AXIS_Z);var t=S.get_rotation(e,h);S.set_rotation_v(e,t)}},t.set_rotate_quat=function(e){s.copy(e,x)},t.get_rotate_quat=function(e){return s.copy(x,e),e},t.set_position=function(e){s.copy(e,y)},t.get_position=function(e){return s.copy(y,e),e}}var a=_(0),n=_(33),o=_(24),i=_(49),s=_(9),E=_(29),c=_(50),l=_(40),T=_(26),d=_(3),u=Object(a.a)("hmd",r);t.a=u},function(e,t,_){"use strict";function r(e,t){var _=Object(n.a)(e),r=Object(o.a)(e),a=Object(i.a)(e),E=Object(s.a)(e);t.play=function(e,t,_){t=t||0,_=_||0,a.play(e,t,_)},t.play_def=function(e){a.play_def(e)},t.is_playing=function(e){return a.is_playing(e)},t.stop=function(e){a.stop(e)},t.pause=function(e){a.speaker_pause(e)},t.resume=function(e){a.speaker_resume(e)},t.loop_stop=function(e,t,_){t=t||0,_=_||!1,a.loop_stop(e,t,_)},t.playrate=function(e,t){a.playrate(e,t)},t.get_playrate=function(e){return a.get_playrate(e)},t.cyclic=function(e,t){a.cyclic(e,t)},t.is_cyclic=function(e){return a.is_cyclic(e)},t.listener_reset_speed=function(e,t){a.listener_stride()},t.listener_stride=function(){a.listener_stride()},t.speaker_reset_speed=function(e,t,_){a.speaker_stride(e)},t.speaker_stride=function(e){a.speaker_stride(e)},t.get_volume=function(e){return e&&"object"==typeof e?a.get_volume(e):a.get_master_volume()},t.set_volume=function(e,t){e&&"object"==typeof e?a.set_volume(e,t):a.set_master_volume(t)},t.mute=function(e,t){e&&"object"==typeof e?a.mute(e,t):a.mute_master(t)},t.is_muted=function(e){return e&&"object"==typeof e?a.is_muted(e):a.is_master_muted()},t.get_speaker_objects=function(){return a.get_speaker_objects().slice(0)},t.check_active_speakers=a.check_active_speakers,t.set_compressor_params=function(e){a.set_compressor_params(r.get_active(),e)},t.get_compressor_params=function(){return a.get_compressor_params(r.get_active())},t.duck=function(e,t,_){e&&"object"==typeof e?a.duck(e,t,_):a.duck_master(t,_)},t.unduck=function(e){e&&"object"==typeof e?a.unduck(e):a.unduck_master()},t.apply_playlist=a.apply_playlist,t.clear_playlist=a.clear_playlist,t.detect_audio_container=a.detect_audio_container,t.detect_video_container=a.detect_video_container,t.set_positional_params=a.set_positional_params,t.get_positional_params=a.get_positional_params,t.set_filter_params=a.set_filter_params,t.get_filter_params=a.get_filter_params,t.get_filter_freq_response=a.get_filter_freq_response,t.get_duration=function(e){return e&&_.is_speaker(e)?a.get_duration(e):(E.error('Object "'+(e?e.name:void 0)+'" is not a valid speaker'),0)}}var a=_(0),n=_(8),o=_(10),i=_(23),s=_(1),E=Object(a.a)("sfx",r);t.a=E},function(e,t,_){"use strict";function r(e,t){var _=Object(n.a)(e),r=Object(o.a)(e),a=Object(i.a)(e);t.SLOT_0=_.SLOT_0,t.SLOT_1=_.SLOT_1,t.SLOT_2=_.SLOT_2,t.SLOT_3=_.SLOT_3,t.SLOT_4=_.SLOT_4,t.SLOT_5=_.SLOT_5,t.SLOT_6=_.SLOT_6,t.SLOT_7=_.SLOT_7,t.SLOT_ALL=_.SLOT_ALL,t.OBJ_ANIM_TYPE_NONE=_.OBJ_ANIM_TYPE_NONE,t.OBJ_ANIM_TYPE_ARMATURE=_.OBJ_ANIM_TYPE_ARMATURE,t.OBJ_ANIM_TYPE_OBJECT=_.OBJ_ANIM_TYPE_OBJECT,t.OBJ_ANIM_TYPE_VERTEX=_.OBJ_ANIM_TYPE_VERTEX,t.OBJ_ANIM_TYPE_SOUND=_.OBJ_ANIM_TYPE_SOUND,t.OBJ_ANIM_TYPE_PARTICLES=_.OBJ_ANIM_TYPE_PARTICLES,t.OBJ_ANIM_TYPE_MATERIAL=_.OBJ_ANIM_TYPE_MATERIAL,t.OBJ_ANIM_TYPE_STATIC=_.OBJ_ANIM_TYPE_STATIC,t.AB_CYCLIC=_.AB_CYCLIC,t.AB_FINISH_RESET=_.AB_FINISH_RESET,t.AB_FINISH_STOP=_.AB_FINISH_STOP,t.is_animated=function(e){return _.is_animated(e)},t.get_anim_names=function(e){return _.obj_is_animatable(e)?_.get_anim_names(e):[]},t.get_current_anim_name=function(e,t){return _.is_animated(e)?(t=t||_.SLOT_0,_.get_anim_by_slot_num(e,t)):null},t.apply=function(e,t,r){if(r>_.SLOT_7)return void a.error("Can't apply animation to slot "+r+' for object "'+e.name+'". Object can have maximum of 8 animation slots');if(r=r||_.SLOT_0,_.is_animated(e)){var n=_.get_slot_num_by_anim(e,t);if(-1!=n&&n!=r)return void a.error('Animation "'+t+'" is already applied to object "'+e.name+'" (slot "'+n+'").')}if(!_.validate_action_by_name(e,t))return void a.error('No fcurves in action "'+t+'"');_.apply(e,null,t,r)},t.apply_ext=function(e,t,r){if(r>_.SLOT_7)return void a.error("Can't apply animation to slot "+r+' for object "'+e.name+'". Object can have maximum of 8 animation slots');r=r||_.SLOT_0;var n=t[0];if(!_.validate_action_by_name(e,n))return void a.error('No fcurves in action "'+n+'"');var o=t.slice(1);_.apply(e,o,n,r)},t.remove=function(e){_.remove(e)},t.remove_slot_animation=function(e,t){_.is_animated(e)&&(t=t||_.SLOT_0,_.remove_slot_animation(e,t))},t.apply_def=function(e){_.apply_def(e)},t.play=function(e,t,r){if(!_.is_animated(e))return void a.error('Object "'+e.name+'" has no applied animation');r=r||_.SLOT_0,_.play(e,t,r),_.update_object_animation(e,0,r,!0)},t.stop=function(e,t){_.is_animated(e)&&(t=t||_.SLOT_0,_.stop(e,t))},t.is_play=function(e,t){return!!_.is_animated(e)&&(t=t||_.SLOT_0,_.is_play(e,t))},t.set_frame=function(e,t,r){_.is_animated(e)&&(r=r||_.SLOT_0,_.set_frame(e,t,r))},t.set_first_frame=function(e,t){_.is_animated(e)&&_.set_first_frame(e,t)},t.set_last_frame=function(e,t){if(_.is_animated(e)){t=t||_.SLOT_0;var r=_.get_anim_start_frame(e,t),a=_.get_anim_length(e,t);_.set_frame(e,r+a-_.LAST_FRAME_EPSILON,t)}},t.get_frame=function(e,t){return _.is_animated(e)?(t=t||_.SLOT_0,_.get_current_frame_float(e,t)):0},t.set_speed=function(e,t,r){_.is_animated(e)&&(r=r||_.SLOT_0,t=t||1,_.set_speed(e,t,r))},t.get_speed=function(e,t){return _.is_animated(e)?(t=t||_.SLOT_0,e.anim_slots[t]?_.get_speed(e,t):0):0},t.get_anim_start_frame=function(e,t){return _.is_animated(e)?(t=t||_.SLOT_0,e.anim_slots[t]?_.get_anim_start_frame(e,t):-1):-1},t.get_anim_length=function(e,t){return _.is_animated(e)?(t=t||_.SLOT_0,e.anim_slots[t]?_.get_anim_length(e,t):-1):-1},t.set_behavior=function(e,t,r){_.is_animated(e)&&(r=r||_.SLOT_0,_.set_behavior(e,t,r))},t.get_behavior=function(e,t){return _.is_animated(e)?(t=t||_.SLOT_0,_.get_behavior(e,t)):null},t.apply_smoothing=function(e,t,r,a){a=a||_.SLOT_0,_.is_animated(e)&&_.apply_smoothing(e,t,r,a)},t.frame_to_sec=function(e){return _.frame_to_sec(e)},t.get_slot_num_by_anim=function(e,t){return _.is_animated(e)&&t?_.get_slot_num_by_anim(e,t):-1},t.get_anim_type=function(e,t){return _.is_animated(e)?_.get_anim_type(e,t):null},t.apply_to_first_empty_slot=function(e,t){return _.apply_to_first_empty_slot(e,t)},t.get_skel_mix_factor=function(e){return e.render.anim_mix_factor},t.set_skel_mix_factor=function(e,t,n,o){if(!r.is_armature(e))return void a.error("Can't blend animation. Object \""+e.name+'" is not armature');t=Math.min(Math.max(t,0),1),e.render.anim_mix_factor!=t&&(n=n||0,o=o||null,_.set_skel_mix_factor(e,t,n,o))},t.set_skeletal_slots=function(e,t,_,r){t=void 0==t?-1:t,_=void 0==t?-1:_,r=r||0;var a=e.render,n=a.blend_skel_slots;t>=0&&(n[0]=t),_>=0&&(n[1]=_),e.render.anim_mix_factor=r},t.get_first_skeletal_slot=function(e){return e.render.blend_skel_slots[0]},t.get_second_skeletal_slot=function(e){return e.render.blend_skel_slots[1]},t.mix_from_cur_pos=function(e,t,r,a){a=a||null,r=r||0,_.mix_from_cur_pos(e,t,r,a)}}var a=_(0),n=_(37),o=_(8),i=_(1),s=Object(a.a)("animation",r);t.a=s},function(e,t,_){"use strict";function r(e,t){if(!t)return void console.log("b4w init failure");l.create_preloader(),e.oncontextmenu=function(e){return e.preventDefault(),e.stopPropagation(),!1},a()}function a(){c.load("./my_project.json",o,n)}function n(e){l.update_preloader(e)}function o(e,t){if(!t)return void console.log("b4w load failure");E.enable_camera_controls();var _=u.get_canvas();_.addEventListener("mousedown",i,!1),_.addEventListener("touchstart",i,!1)}function i(e){e.preventDefault&&e.preventDefault();var t=f.get_coords_x(e),_=f.get_coords_y(e),r=P.pick_object(t,_);r&&(A&&(d.stop(A),d.set_frame(A,0)),A=r,d.apply_def(r),d.play(r))}Object.defineProperty(t,"__esModule",{value:!0});var s=_(85),E=s.a.app,c=(s.a.config,s.a.data),l=s.a.preloader,T=s.a.version,d=s.a.animation,u=s.a.container,f=s.a.mouse,P=s.a.scenes,A=null,S="DEBUG"==T.type();!function(){E.init({canvas_container_id:"main_canvas_container",callback:r,show_fps:S,console_verbose:S,autoresize:!0})}()},function(e,t,_){"use strict";var r=_(32),a=_(86),n=_(95),o=_(96),i=_(97),s=_(98),E=_(81),c=_(99),l=_(100),T=_(101),d=_(102),u=_(103),f=_(104),P=_(69),A=_(105),S=_(83),p=_(106),O=_(107),v=_(33),m=_(76),N=_(67),g=_(39),R=_(24),I=_(77),b=_(78),h=_(108),Y=_(109),L=_(49),M=_(110),x=_(111),y=_(60),U=_(112),w=_(113),C=_(114),D=_(115),F=_(116),G=_(54),k=_(117),K=_(29),B=_(50),X=_(82),H=_(118),j=_(68),Q=_(40),z=_(80),V=_(26),q=_(119),W=_(1),J=_(3),Z=_(7),$=_(27),ee=_(21),te=_(9);r.a.app=a.a,r.a.camera_anim=n.a,r.a.fps=o.a,r.a.gp_conf=i.a,r.a.gyroscope=s.a,r.a.hmd=E.a,r.a.hmd_conf=c.a,r.a.mixer=l.a,r.a.mouse=T.a,r.a.npc_ai=d.a,r.a.preloader=u.a,r.a.screenshooter=f.a,r.a.storage=P.a,r.a.anchors=A.a,r.a.animation=S.a,r.a.armature=p.a,r.a.assets=O.a,r.a.camera=v.a,r.a.config=m.a,r.a.constraints=N.a,r.a.container=g.a,r.a.controls=R.a,r.a.data=I.a,r.a.debug=b.a,r.a.geometry=h.a,r.a.hud=Y.a,r.a.input=L.a,r.a.lights=M.a,r.a.logic_nodes=x.a,r.a.main=y.a,r.a.material=U.a,r.a.math=w.a,r.a.nla=C.a,r.a.objects=D.a,r.a.particles=F.a,r.a.physics=G.a,r.a.rgb=k.a,r.a.scenes=K.a,r.a.screen=B.a,r.a.sfx=X.a,r.a.textures=H.a,r.a.time=j.a,r.a.transform=Q.a,r.a.tsr=z.a,r.a.util=V.a,r.a.version=q.a,r.a.print=W.a,r.a.vec3=J,r.a.vec4=Z,r.a.mat3=$,r.a.mat4=ee,r.a.quat=te,r.a.register("vec3",function(e,t){for(var _ in J)e[_]=J[_]}),r.a.register("vec4",function(e,t){for(var _ in Z)e[_]=Z[_]}),r.a.register("mat3",function(e,t){for(var _ in $)e[_]=$[_]}),r.a.register("mat4",function(e,t){for(var _ in ee)e[_]=ee[_]}),r.a.register("quat",function(e,t){for(var _ in te)e[_]=te[_]}),t.a=r.a},function(e,t,_){"use strict";function r(e,t){function _(){var e=V.is_paused(),t=function(){document.hidden?(e=V.is_paused(),V.pause()):e||V.resume()};document.addEventListener("visibilitychange",t,!1)}function r(){var e=0,t=X.get_container(),_=V.is_paused(),r=!0,a=function(){if(e%Me==0){var a=t.getBoundingClientRect();a.top>window.innerHeight||a.bottom<0?(r&&(_=V.is_paused()),V.pause(),r=!1):_||r||(V.resume(),r=!0)}e++};V.append_loop_cb(a)}function a(e,t,_,r){var a=document.createElement("canvas"),n=document.getElementById(e);if(n||(W.error('Warning: canvas container "'+e+'" not found, appending to body'),n=document.body),a.style.position="absolute",a.style.left=0,a.style.top=0,a.style.width=n.offsetWidth+"px",a.style.height=n.offsetHeight+"px",a.width=n.offsetWidth*window.devicePixelRatio,a.height=n.offsetHeight*window.devicePixelRatio,t){var o=document.createElement("canvas");o.style.position="absolute",a.style.left=0,a.style.top=0,o.style.pointerEvents="none"}else var o=null;return n.appendChild(a),V.init(a,o)?(o&&X.insert_to_container(o,"LAST"),!0):(_&&U("Browser could not initialize WebGL","For more info visit","https://www.blend4web.com/doc/en/problems_and_solutions.html#problems-upon-startup",r),!1)}function v(e,t){e?(t&&(document.getElementById(t).style.display="block"),we=document.getElementById(e)):(we=document.createElement("div"),we.innerHTML=0,we.style.cssText="position:absolute;font-family: Arial, sans-serif;top: 20px;right: 20px;text-shadow: 0px 0px 6px #000;font-size: 40px;line-height: 50px;font-weight: bold;color: #fff;",X.insert_to_container(we,"JUST_AFTER_CANVAS"))}function m(e,t){var _=String(e);t&&(_+="/"+String(t)),we.innerHTML=_}function N(e){var t=document.getElementById(e),_=t.cloneNode(!0);return t.parentNode.replaceChild(_,t),_}function g(e,t,_){var r=Math.max(k.hover_get_distance(e),ve),a=$.get_rotation(e,Qe),n=ee.quat_to_dir(a,t,He);n[2]=0,O.normalize(n,n),O.scale(n,r*_,n);var o=$.get_translation(e,je);O.add(o,n,o),k.set_translation(e,o)}function R(e,t){var _=k.hover_get_vertical_limits(e,Ve);if(_.up!=_.down){var r=k.get_camera_angles(e,Xe)[1],a=(_.down-r)/(_.down-_.up),n=k.hover_get_distance_limits(e,Ve);a=Math.max(a,Oe/n.max),k.rotate_camera(e,0,a*t)}}function I(e,t,_,r){t*=ae,_*=ae,r*=ae,$.move_local(e,t,_,r)}function b(e){return e/(1-e)}function h(e,t,_){var r=k.target_get_distance(e),a=Math.abs(t),n=Math.pow(a*_,te-Math.pow(a*_,_e));t=t<0?r>Ye?-r*n:0:r*b(n),$.move_local(e,0,0,t)}function Y(e,t,_,r,a){for(var n=r*_,o=t;o>0;--o)r+=n,a+=n,n=r*_;return a}function L(e,t,_,r,a,n){if(n){var o=k.target_get_pivot(e,He),i=k.get_translation(e),s=O.dist(o,i)+r;r=t>0?Y(e,t,-_,s,r):Y(e,-t,b(_),s,r)}else r-=t*a*_;return r}function M(e,t,_,r,a,n){Ce=e,De=t,Fe=_,Ge=r,ke=a,Ke=n;var o=Z.get_active_camera();x(o);var i=!1,s=null,E=!1;switch(k.get_move_style(o)){case k.MS_TARGET_CONTROLS:i=!e;break;case k.MS_EYE_CONTROLS:s=Z.get_first_character();break;case k.MS_STATIC:return;case k.MS_HOVER_CONTROLS:E=!0}var c=k.get_velocities(o,ze),l=H.create_elapsed_sensor();if(q.has_simulated_physics(o)){var T=H.create_collision_sensor(o,null,!0),d=function(e,t,_){var r=H.get_sensor_payload(e,t,0).coll_dist;if(r<0){var a=H.get_sensor_payload(e,t,0).coll_norm,n=He;O.scale(a,-he*r,n);var o=$.get_translation(e,je);O.add(o,n,o),$.set_translation_v(e,o)}};H.create_sensor_manifold(o,"CAMERA_COLLISION",H.CT_POSITIVE,[T],null,d)}if(s){var u=$.get_translation(o),f=$.get_rotation(o),P=ee.cam_quat_to_mesh_quat(f);u[2]-=be,q.set_transform(s,u,P),B.append_stiff_trans(o,s,[0,0,.5]);var A=new Float32Array(2),S=!0;q.set_character_move_type(s,q.CM_FLY);var p=function(){S=!S,q.set_character_move_type(s,S?q.CM_FLY:q.CM_WALK)};H.create_kb_sensor_manifold(o,"TOGGLE_CHAR_MOVE_TYPE",H.CT_SHOT,H.KEY_C,p)}var v,m,N,b,Y,M,y,U,w,K,X,j,Q=function(e,t,_){if(1==_){var r=H.get_sensor_value(e,t,0);switch(k.get_velocities(e,c),t){case"FORWARD":if(s)A[0]=1;else if(E){var a=k.get_camera_angles(e,Xe)[1],n=Math.abs(a)>=Math.PI/4?ee.AXIS_Y:ee.AXIS_MZ;g(e,n,c.trans*fe*r)}else i?h(e,-c.zoom,r):I(e,0,0,-c.trans*r);break;case"BACKWARD":if(s)A[0]=-1;else if(E){var a=k.get_camera_angles(e,Xe)[1],n=Math.abs(a)>=Math.PI/4?ee.AXIS_MY:ee.AXIS_Z;g(e,n,c.trans*fe*r)}else i?h(e,c.zoom,r):I(e,0,0,c.trans*r);break;case"UP":E?R(e,-c.zoom*Pe*r):s||I(e,0,c.trans*r,0);break;case"DOWN":E?R(e,c.zoom*Pe*r):s||I(e,0,-c.trans*r,0);break;case"LEFT":s?A[1]=1:E?g(e,ee.AXIS_MX,c.trans*fe*r):I(e,-c.trans*r,0,0);break;case"RIGHT":s?A[1]=-1:E?g(e,ee.AXIS_X,c.trans*fe*r):I(e,c.trans*r,0,0);break;case"ROT_LEFT":i?k.rotate_camera(e,-c.rot*ce*r,0):k.rotate_camera(e,c.rot*ce*r,0);break;case"ROT_RIGHT":i?k.rotate_camera(e,c.rot*ce*r,0):k.rotate_camera(e,-c.rot*ce*r,0);break;case"ROT_UP":i?k.rotate_camera(e,0,-c.rot*ce*r):k.rotate_camera(e,0,c.rot*ce*r);break;case"ROT_DOWN":i?k.rotate_camera(e,0,c.rot*ce*r):k.rotate_camera(e,0,-c.rot*ce*r)}}else switch(t){case"FORWARD":case"BACKWARD":s&&(A[0]=0);break;case"LEFT":case"RIGHT":s&&(A[1]=0)}if(s){q.set_character_move_dir(s,A[0],A[1]);var o=k.get_camera_angles_char(e,Be);q.set_character_rotation_h(s,o[0]),q.set_character_vert_move_dir_angle(s,o[1])}};if(n)y=U=w=K=X=j=H.create_custom_sensor(0);else{var V=z.check_enable_gamepad_indices();if(V.length)var W=V[V.length-1];else var W=0;y=H.create_gamepad_btn_sensor(z.GMPD_BUTTON_6,W),U=H.create_gamepad_btn_sensor(z.GMPD_BUTTON_7,W),w=H.create_gamepad_axis_sensor(z.GMPD_AXIS_0,V),K=H.create_gamepad_axis_sensor(z.GMPD_AXIS_1,V),X=H.create_gamepad_axis_sensor(z.GMPD_AXIS_2,V),j=H.create_gamepad_axis_sensor(z.GMPD_AXIS_3,V)}t?v=m=N=b=Y=M=H.create_custom_sensor(0):(v=H.create_keyboard_sensor(H.KEY_W),m=H.create_keyboard_sensor(H.KEY_S),N=H.create_keyboard_sensor(H.KEY_A),b=H.create_keyboard_sensor(H.KEY_D),Y=H.create_keyboard_sensor(H.KEY_R),M=H.create_keyboard_sensor(H.KEY_F));var J=H.create_keyboard_sensor(H.KEY_UP),te=H.create_keyboard_sensor(H.KEY_DOWN),_e=H.create_keyboard_sensor(H.KEY_LEFT),ae=H.create_keyboard_sensor(H.KEY_RIGHT),Oe=function(e){return e[0]&&(e[1]||e[2]||e[3])},ve=function(e){return e[0]&&(e[1]||e[2]>xe)},me=function(e){return e[0]&&(e[1]||e[2]<-xe)},Ne=function(e){return e[0]&&(e[1]||e[2]||e[3]>xe)},ge=function(e){return e[0]&&(e[1]||e[2]||e[3]<-xe)};if(E||(H.create_sensor_manifold(o,"FORWARD",H.CT_CONTINUOUS,[l,v,K],me,Q),H.create_sensor_manifold(o,"BACKWARD",H.CT_CONTINUOUS,[l,m,K],ve,Q)),i?(H.create_sensor_manifold(o,"ROT_UP",H.CT_CONTINUOUS,[l,J,Y,j],ge,Q),H.create_sensor_manifold(o,"ROT_DOWN",H.CT_CONTINUOUS,[l,te,M,j],Ne,Q),H.create_sensor_manifold(o,"ROT_LEFT",H.CT_CONTINUOUS,[l,_e,N,X],ge,Q),H.create_sensor_manifold(o,"ROT_RIGHT",H.CT_CONTINUOUS,[l,ae,b,X],Ne,Q)):E?(H.create_sensor_manifold(o,"LEFT",H.CT_CONTINUOUS,[l,_e,N,w],ge,Q),H.create_sensor_manifold(o,"RIGHT",H.CT_CONTINUOUS,[l,ae,b,w],Ne,Q),H.create_sensor_manifold(o,"FORWARD",H.CT_CONTINUOUS,[l,J,v,K],ge,Q),H.create_sensor_manifold(o,"BACKWARD",H.CT_CONTINUOUS,[l,te,m,K],Ne,Q),H.create_sensor_manifold(o,"UP",H.CT_CONTINUOUS,[l,M,j],ve,Q),H.create_sensor_manifold(o,"DOWN",H.CT_CONTINUOUS,[l,Y,j],me,Q)):(H.create_sensor_manifold(o,"UP",H.CT_CONTINUOUS,[l,Y,y],Oe,Q),H.create_sensor_manifold(o,"DOWN",H.CT_CONTINUOUS,[l,M,U],Oe,Q),H.create_sensor_manifold(o,"LEFT",H.CT_CONTINUOUS,[l,N,w],me,Q),H.create_sensor_manifold(o,"RIGHT",H.CT_CONTINUOUS,[l,b,w],ve,Q),H.create_sensor_manifold(o,"ROT_UP",H.CT_CONTINUOUS,[l,J,j],me,Q),H.create_sensor_manifold(o,"ROT_DOWN",H.CT_CONTINUOUS,[l,te,j],ve,Q),H.create_sensor_manifold(o,"ROT_LEFT",H.CT_CONTINUOUS,[l,_e,X],me,Q),H.create_sensor_manifold(o,"ROT_RIGHT",H.CT_CONTINUOUS,[l,ae,X],ve,Q)),!_){var Re=0,Ie=H.create_mouse_wheel_sensor(r),Me=0,we=H.create_touch_zoom_sensor(r),Qe=function(e,t,_){if(1==_){var r=H.get_sensor_value(e,t,0);if(k.get_velocities(e,c),i||E)Re=L(e,r,c.zoom,Re,Se,i);else{var a=r*c.zoom;c.trans*=1+a,k.set_velocities(e,c)}}};H.create_sensor_manifold(o,"MOUSE_WHEEL",H.CT_LEVEL,[Ie],null,Qe);var Ve=function(e,t,_,r){if(1==_){var a=H.get_sensor_value(e,t,0);k.get_velocities(e,c),H.get_sensor_payload(e,t,0)===H.PL_MULTITOUCH_MOVE_ZOOM&&(Me=L(e,a,c.zoom*re,Me,pe,i))}};H.create_sensor_manifold(o,"TOUCH_ZOOM",H.CT_LEVEL,[we],null,Ve);var qe=function(e,t,_){if(i||E)if(Math.abs(Re)>Le||Math.abs(Me)>Le){var r=H.get_sensor_value(e,t,0),a=ee.smooth(Re,0,r,C());Re-=a;var n=ee.smooth(Me,0,r,D());if(Me-=n,E)R(e,-(a+n));else{var o=k.target_get_distance(e)+a+n;o=Math.max(o,Ye),k.target_set_distance(e,o)}}else Re=0,Me=0};H.create_sensor_manifold(o,"ZOOM_INTERPOL",H.CT_POSITIVE,[l],null,qe)}var We=0,Je=0,Ze=0,$e=0,et=function(e,t,_,r){if(1==_){var a=H.get_sensor_value(e,t,1);if(k.get_velocities(e,c),E)var n=le*c.trans,o=Te*c.rot;else var n=oe*c.rot,o=ie*c.trans;1===H.get_sensor_payload(e,t,0).which?(We+="X"==r?-a*n:0,Je+="Y"==r?-a*n:0):2!==H.get_sensor_payload(e,t,0).which&&3!==H.get_sensor_payload(e,t,0).which||(Ze+="X"==r?-a*o:0,$e+="Y"==r?-a*o:0)}},tt=0,_t=0;if(!n){var rt=function(e,t,_){k.get_velocities(e,c),tt+=c.trans*ye},at=function(e,t,_){k.get_velocities(e,c),_t+=c.zoom*Ue},nt=function(e,t,_){k.get_velocities(e,c),tt-=c.trans*ye},ot=function(e,t,_){k.get_velocities(e,c),_t-=c.zoom*Ue};i?(H.create_sensor_manifold(o,"GMPD_PAN_Y_POS",H.CT_CONTINUOUS,[y],null,at),H.create_sensor_manifold(o,"GMPD_PAN_Y_NEG",H.CT_CONTINUOUS,[U],null,ot),H.create_sensor_manifold(o,"GMPD_PAN_X_POS",H.CT_CONTINUOUS,[w],function(e){return e[0]<-xe},nt),H.create_sensor_manifold(o,"GMPD_PAN_X_NEG",H.CT_CONTINUOUS,[w],function(e){return e[0]>xe},rt)):E&&(H.create_sensor_manifold(o,"GMPD_PAN_X_POS",H.CT_CONTINUOUS,[X],function(e){return e[0]<-xe},nt),H.create_sensor_manifold(o,"GMPD_PAN_X_NEG",H.CT_CONTINUOUS,[X],function(e){return e[0]>xe},rt))}if(a){var it=H.create_mouse_move_sensor("X",window),st=H.create_mouse_move_sensor("Y",window),Et=H.create_mouse_click_sensor(r),ct=H.create_mouse_click_sensor(window),lt=!1,Tt=function(e){return e[2]?lt=!0:e[0]||(lt=!1),lt&&e[0]};H.create_sensor_manifold(o,"MOUSE_X",H.CT_POSITIVE,[ct,it,Et],Tt,et,"X"),H.create_sensor_manifold(o,"MOUSE_Y",H.CT_POSITIVE,[ct,st,Et],Tt,et,"Y");var dt=z.get_device_by_type_element(z.DEVICE_MOUSE,window);z.switch_prevent_default(dt,!1)}else{var it=H.create_mouse_move_sensor("X",r),st=H.create_mouse_move_sensor("Y",r),ut=H.create_mouse_click_sensor(r);H.create_sensor_manifold(o,"MOUSE_X",H.CT_POSITIVE,[ut,it],null,et,"X"),H.create_sensor_manifold(o,"MOUSE_Y",H.CT_POSITIVE,[ut,st],null,et,"Y")}var ft=0,Pt=0,At=0,St=0,pt=H.create_touch_move_sensor("X",r),Ot=H.create_touch_move_sensor("Y",r),vt=function(e,t,_,r){if(1==_){if(k.get_velocities(e,c),E)var a=de*c.trans;else var a=se*c.rot;var n=H.get_sensor_value(e,t,0);if(H.get_sensor_payload(e,t,0).gesture===H.PL_SINGLE_TOUCH_MOVE)ft+="X"==r?-n*a:0,Pt+="Y"==r?-n*a:0;else if(H.get_sensor_payload(e,t,0).gesture===H.PL_MULTITOUCH_MOVE_PAN){if(E)var o=ue*c.rot;else var o=Ee*c.trans;At+="X"==r?-n*o:0,St+="Y"==r?-n*o:0}}};H.create_sensor_manifold(o,"TOUCH_X",H.CT_POSITIVE,[pt],null,vt,"X"),H.create_sensor_manifold(o,"TOUCH_Y",H.CT_POSITIVE,[Ot],null,vt,"Y");var mt=function(e,t,_){if(Math.abs(We)>Le||Math.abs(Je)>Le||Math.abs(ft)>Le||Math.abs(Pt)>Le||Math.abs(Ze)>Le||Math.abs($e)>Le||Math.abs(At)>Le||Math.abs(St)>Le||Math.abs(tt)>Le||Math.abs(_t)>Le){var r=H.get_sensor_value(e,t,0),a=ee.smooth(We,0,r,F()),n=ee.smooth(Je,0,r,F());We-=a,Je-=n;var o=ee.smooth(ft,0,r,G()),c=ee.smooth(Pt,0,r,G());ft-=o,Pt-=c;var l=ee.smooth(Ze,0,r,F()),T=ee.smooth($e,0,r,F());Ze-=l,$e-=T;var d=ee.smooth(At,0,r,G()),u=ee.smooth(St,0,r,G());At-=d,St-=u;var f=ee.smooth(tt,0,r,F()),P=ee.smooth(_t,0,r,F());if(tt-=f,_t-=P,i){k.rotate_camera(e,a+o,n+c);var A=k.target_get_distance(e);k.target_pan_pivot(e,A*(l+d+f),A*(T+u+P))}else if(E){if(a+o&&g(e,ee.AXIS_X,(a+o)*Ae),n+c){var S=k.get_camera_angles(e,Xe)[1],p=Math.abs(S)>Math.PI/4?ee.AXIS_MY:ee.AXIS_Z;g(e,p,(n+c)*Ae)}k.rotate_camera(e,l+d+f,0)}else if(k.rotate_camera(e,(a+o)*ne,(n+c)*ne),s){var O=k.get_camera_angles_char(e,Be);q.set_character_rotation_h(s,O[0]),q.set_character_vert_move_dir_angle(s,O[1])}}};H.create_sensor_manifold(o,"ROT_TRANS_INTERPOL",H.CT_POSITIVE,[l],null,mt),H.create_kb_sensor_manifold(o,"DEC_STEREO_DIST",H.CT_SHOT,H.KEY_LEFT_SQ_BRACKET,function(e,t,_){var r=k.get_stereo_distance(e);k.set_stereo_distance(e,.9*r)}),H.create_kb_sensor_manifold(o,"INC_STEREO_DIST",H.CT_SHOT,H.KEY_RIGHT_SQ_BRACKET,function(e,t,_){var r=k.get_stereo_distance(e);k.set_stereo_distance(e,1.1*r)})}function x(e){function t(e,t,_){y(),M(Ce,De,Fe,Ge,ke,Ke)}var _=k.get_move_style(e),r=function(){var t=k.get_move_style(e),r=t!=_;return _=t,r},a=H.create_callback_sensor(r);H.create_sensor_manifold(e,"CHANGE_MOVE_STYLE",H.CT_POSITIVE,[a],null,t)}function y(){var e=Z.get_active_camera();H.check_sensor_manifold(e,"TOGGLE_CHAR_MOVE_TYPE")&&Z.get_first_character()&&B.remove(e);for(var t=["FORWARD","BACKWARD","ROT_UP","ROT_DOWN","ROT_LEFT","ROT_RIGHT","UP","DOWN","LEFT","RIGHT","MOUSE_WHEEL","TOUCH_ZOOM","ZOOM_INTERPOL","MOUSE_X","MOUSE_Y","TOUCH_X","TOUCH_Y","ROT_TRANS_INTERPOL","CHANGE_MOVE_STYLE","TOGGLE_CHAR_MOVE_TYPE"],_=0;_<t.length;_++)H.remove_sensor_manifold(e,t[_])}function U(e,t,_,r){var a=document.createElement("div"),n=document.createElement("div"),o=document.createElement("div");if(r)for(var i=0;i<r.length;i++){var s=document.getElementById(r[i]);s&&s.parentNode.removeChild(s)}a.style.cssText="z-index:10;width:100%;height:auto;position:absolute;top:50%;margin-top:150px;text-align:center;",n.style.cssText="color:#fff;font-size:24px;",o.style.cssText="color:#fff;font-size:20px;",n.innerHTML=e,o.innerHTML=t+'   <a style="color:#fff;font-size:20px;width:100%;" href="'+_+'">'+_.replace("https://www.","")+"</a>",a.appendChild(n),a.appendChild(o),document.body.appendChild(a)}function w(e,t,_,r,a){function n(){var i=performance.now()-o;a(t+i*(_-t)/r),(i>=r||!e.parentNode)&&V.remove_loop_cb(n)}var o=performance.now();V.append_loop_cb(n)}function C(){return Ne*me}function D(){return ge*me}function F(){return Re*me}function G(){return Ie*me}var k=Object(n.a)(e),K=Object(o.a)(e),B=Object(i.a)(e),X=Object(s.a)(e),H=Object(E.a)(e),j=Object(c.a)(e),Q=Object(l.a)(e),z=Object(T.a)(e),V=Object(d.a)(e),q=Object(u.a)(e),W=Object(f.a)(e),J=Object(P.a)(e),Z=Object(A.a)(e),$=Object(S.a)(e),ee=Object(p.a)(e),te=1,_e=.15,re=.03,ae=5,ne=.5,oe=.003,ie=75e-5,se=.003,Ee=75e-5,ce=.75,le=.003,Te=75e-5,de=.003,ue=.003,fe=.5,Pe=30,Ae=.2,Se=2,pe=2,Oe=2,ve=1,me=1,Ne=.1,ge=.15,Re=.08,Ie=.12,be=.5,he=.25,Ye=.001,Le=1e-5,Me=10,xe=.1,ye=.002,Ue=.05,we=null,Ce=!1,De=!1,Fe=!1,Ge=null,ke=!1,Ke=!1,Be=new Float32Array(2),Xe=new Float32Array(2),He=new Float32Array(3),je=new Float32Array(3),Qe=new Float32Array(4),ze={},Ve={};t.init=function(e){e=e||{};var t=!1,n=null,o=function(){},i=null,s=null,E=0,c=null,l=!0,T=!1,d=!0,u=!0,f=!1,P=!1,A=!1,S=!1,p=K.get("quality");for(var O in e)switch(O){case"canvas_container_id":n=e.canvas_container_id;break;case"callback":o=e.callback;break;case"autoresize":t=e.autoresize;break;case"show_hud_debug_info":A=e.show_hud_debug_info;break;case"sfx_mix_mode":f=e.sfx_mix_mode;break;case"show_fps":P=e.show_fps;break;case"track_container_position":S=e.track_container_position,W.error_once("track_container_position deprecated. Not needed anymore. Use the container.get_coords_target_space method.");break;case"fps_wrapper_id":c=e.fps_wrapper_id;break;case"fps_elem_id":s=e.fps_elem_id;break;case"error_purge_elements":i=e.error_purge_elements;break;case"report_init_failure":u=e.report_init_failure;break;case"pause_invisible":d=e.pause_invisible;break;case"key_pause_enabled":l=e.key_pause_enabled;break;case"force_container_ratio":E=e.force_container_ratio;break;case"min_capabilities":T=e.min_capabilities;break;case"quality":p=e.quality;break;default:K.set(O,e[O])}p!=K.P_AUTO&&K.set("quality",p);var N=function(e){e.keyCode==H.KEY_P&&(V.is_paused()?V.resume():V.pause())};l&&document.addEventListener("keydown",N,!1),K.set("show_hud_debug_info",A),K.set("sfx_mix_mode",f);var g=A||f||null,R=function(){var e=a(n,g,u,i),l=X.get_canvas();if(!e)return void o(l,!1);var f=X.get_container();X.resize_to_container(),P&&(v(s,c),V.set_fps_callback(m)),d&&(_(),r()),E&&V.append_loop_cb(function(){f.style.height=f.clientWidth/E+"px"}),t&&V.append_loop_cb(function(){X.resize_to_container()}),S&&V.append_loop_cb(function(){X.force_offsets_updating()}),T&&K.reset_limits(),p==K.P_AUTO?Q.test_performance(function(e,t){0==e?(W.log("QUALITY TEST RESULT: UNSUPPORTED, using HIGH"),K.apply_quality(K.P_HIGH)):t<1.5?(W.log("QUALITY TEST RESULT: LOW ("+t.toFixed(1)+" GB/s)"),K.apply_quality(K.P_LOW)):(W.log("QUALITY TEST RESULT: HIGH ("+t.toFixed(1)+" GB/s)"),K.apply_quality(K.P_HIGH)),o(l,!0)}):o(l,!0)},I=function(){j.cleanup()};"complete"==document.readyState?window.setTimeout(R,0):window.addEventListener("load",R,!1),window.addEventListener("unload",I,!1)},t.set_onclick=function(e,t){var _=N(e);_.addEventListener("mouseup",function(e){t(_.value)},!1)},t.set_onchange=function(e,t){var _=N(e);_.addEventListener("change",function(e){var r=_.checked,a=void 0!=r?r:_.value;t(a)},!1)},t.set_onkeypress=function(e,t){var _=N(e);_.addEventListener("keypress",function(e){t(e.keyCode,_.value)},!1)},t.enable_camera_controls=M,t.disable_camera_controls=y,t.enable_object_controls=function(e,t){var _=q.is_vehicle_chassis(e)||q.is_vehicle_hull(e),r=function(e,t,r){if(1==r){var a=H.get_sensor_value(e,t,0);switch(t){case"FORWARD":_?q.vehicle_throttle(e,1):$.move_local(e,0,-1*a,0);break;case"BACKWARD":_?q.vehicle_throttle(e,-1):$.move_local(e,0,1*a,0);break;case"LEFT":_?q.vehicle_steer(e,-1):$.move_local(e,1*a,0,0);break;case"RIGHT":_?q.vehicle_steer(e,1):$.move_local(e,-1*a,0,0)}}else switch(t){case"FORWARD":case"BACKWARD":_&&q.vehicle_throttle(e,0);break;case"LEFT":case"RIGHT":_&&q.vehicle_steer(e,0)}},a=H.create_elapsed_sensor(),n=H.create_keyboard_sensor(H.KEY_W),o=H.create_keyboard_sensor(H.KEY_S),i=H.create_keyboard_sensor(H.KEY_A),s=H.create_keyboard_sensor(H.KEY_D),E=H.create_keyboard_sensor(H.KEY_UP),c=H.create_keyboard_sensor(H.KEY_DOWN),l=H.create_keyboard_sensor(H.KEY_LEFT),T=H.create_keyboard_sensor(H.KEY_RIGHT),d=function(e){return e[0]&&(e[1]||e[2])};H.create_sensor_manifold(e,"FORWARD",H.CT_CONTINUOUS,[a,n,E],d,r),H.create_sensor_manifold(e,"BACKWARD",H.CT_CONTINUOUS,[a,o,c],d,r),H.create_sensor_manifold(e,"LEFT",H.CT_CONTINUOUS,[a,i,l],d,r),H.create_sensor_manifold(e,"RIGHT",H.CT_CONTINUOUS,[a,s,T],d,r)},t.disable_object_controls=function(e){for(var t=["FORWARD","BACKWARD","LEFT","RIGHT"],_=0;_<t.length;_++)H.remove_sensor_manifold(e,t[_])},t.enable_debug_controls=function(){H.create_kb_sensor_manifold(null,"CAMERA_SHOT",H.CT_SHOT,H.KEY_K,function(){Q.make_camera_frustum_shot()}),H.create_kb_sensor_manifold(null,"LIGHT_SHOT",H.CT_SHOT,H.KEY_L,function(){Q.make_light_frustum_shot()}),H.create_kb_sensor_manifold(null,"TELEMETRY",H.CT_SHOT,H.KEY_T,function(){Q.plot_telemetry()})},t.request_fullscreen=function(e,t,_){W.error_deprecated("request_fullscreen","screen.request_fullscreen"),J.request_fullscreen(e,t,_)},t.exit_fullscreen=function(){W.error_deprecated("exit_fullscreen","screen.exit_fullscreen"),J.exit_fullscreen()},t.check_fullscreen=function(){return W.error_deprecated("check_fullscreen","screen.check_fullscreen"),J.check_fullscreen()},t.report_app_error=U,t.get_url_params=function(e){e=!!e;var t=decodeURIComponent(location.href.toString());if(-1==t.indexOf("?"))return null;for(var _=t.split("?")[1].split("&"),r={},a=0;a<_.length;a++){var n=_[a].split("="),o=n[0];if(n.length>1){var i=n[1];e?o in r?r[o].push(i):r[o]=[i]:r[o]=i}else e?o in r||(r[o]=[]):r[o]=""}return r},t.css_animate=function(e,t,_,r,a,n,o,i){function s(a){e&&(E[t]=n+a+o,(_>r&&a<=r||_<r&&a>=r)&&(E[t]=n+r+o,i()))}if(e&&t&&isFinite(_)&&isFinite(r)&&isFinite(a)){n=n||"",o=o||"",i=i||function(){};var E=e.style,c=t.charAt(0).toUpperCase()+t.slice(1);if(void 0!=E[t]);else if(void 0!=E["webkit"+c])t="webkit"+c;else if(void 0!=E["ms"+c])t="ms"+c;else{if(void 0==E["moz"+c])return;t="moz"+c}w(e,_,r,a,s)}},t.attr_animate=function(e,t,_,r,a,n){function o(a){e&&(a>=0&&e.setAttribute(t,a),(_>r&&a<=r||_<r&&a>=r)&&(e.setAttribute(t,r),n()))}e&&t&&isFinite(_)&&isFinite(r)&&isFinite(a)&&(n=n||function(){},w(e,_,r,a,o))},t.queue_animate=function(e){if(e.length){var _=e.shift(),r=_.elem,a=_.prop,n=_.from,o=_.to,i=_.duration,s=_.opt_prefix,E=_.opt_suffix,c=function(){_.cb&&_.cb(),t.queue_animate(e)};"css"==_.type?t.css_animate(r,a,n,o,i,s,E,c):"attr"==_.type&&t.attr_animate(r,a,n,o,i,c)}},t.set_camera_smooth_factor=function(e){me=e},t.get_camera_smooth_factor=function(){return me}}var a=_(0),n=_(33),o=_(76),i=_(67),s=_(39),E=_(24),c=_(77),l=_(78),T=_(49),d=_(60),u=_(54),f=_(1),P=_(50),A=_(29),S=_(40),p=_(26),O=_(3),v=Object(a.a)("app",r);t.a=v},function(e,t,_){"use strict";function r(e,t){var _=Object(n.a)(e);t.nodegraph_to_dot=function(e,t){if(t)var r=function(e){var t="";switch(e.type){case"GEOMETRY_UV":t="\nuv_layer: "+e.data.value;break;case"TEXTURE_COLOR":case"TEXTURE_NORMAL":t="\ntexture: "+e.data.value.name+"\n("+e.data.value.img_filepath+")"}return""==t&&(t="\n---"),t},a=function(e,t){var _=t.type+"("+t.name+")",a=t.inputs;if(_+="\n\nINPUTS:",a.length)for(var n=0;n<a.length;n++)_+="\n"+a[n].identifier+": ",a[n].is_linked?_+="linked":_+=a[n].default_value;else _+="\n---";var o=t.outputs;if(_+="\n\nOUTPUTS:",o.length)for(var n=0;n<o.length;n++)_+="\n"+o[n].identifier+": ",o[n].is_linked?_+="linked(default "+o[n].default_value+")":_+="not used";else _+="\n---";return _+="\n\nDATA:",_+=r(t)},n=function(t,r,a){var n=_.get_node_attr(e,t),o=_.get_node_attr(e,r),i=n.outputs[a[0]],s=o.inputs[a[1]];return i.identifier+"\n==>\n"+s.identifier};else var a=function(e,t){return t.type},n=function(t,r,a){var n=_.get_node_attr(e,t),o=_.get_node_attr(e,r),i=n.outputs[a[0]],s=o.inputs[a[1]];return i.identifier+"\n==>\n"+s.identifier};return _.debug_dot(e,a,n)}}var a=_(0),n=_(31),o=Object(a.a)("__debug_nodegraph",r);t.a=o},function(e,t,_){"use strict";function r(e,t){function _(e){for(var t=document.getElementsByTagName("script"),_=Object(s.b)(e),r=0;r<t.length;r++)if(t[r].src==_)return t[r];return null}function r(e,t,_){for(var r=0;r<v.length;r+=2)v[r+1]==e&&(O[r+Number(!t)]=_)}function a(e,t){for(var _=0;_<v.length;_+=2)if(v[_+1]==e)return O[_+Number(!t)];return null}function E(e){for(var t=0;t<e.length;t++){var _=e[t],r=0;for(var a in _){var n=_[a];switch(n.constructor){case Float32Array:r+=n.length;break;case Number:r+=1}}r-=1,_.len=r}}var c=Object(o.a)(e),l=Object(i.a)(e),T=!0;t.IN_LOADED=0,t.IN_COLLISION=1,t.IN_COLLISION_POS_NORM=2,t.IN_COLLISION_IMPULSE=3,t.IN_ERROR=4,t.IN_FBMSG=5,t.IN_FLOATER_BOB_TRANSFORM=6,t.IN_LOG=7,t.IN_PROP_OFFSET=8,t.IN_RAY_HIT=9,t.IN_RAY_HIT_POS_NORM=10,t.IN_REMOVE_RAY_TEST=11,t.IN_TRANSFORM=12,t.IN_VEHICLE_SPEED=13,t.IN_PING=14,t.IN_FPS=15,t.IN_DEBUG_STATS=16;var d=t.IN_COLLISION,u=t.IN_COLLISION_POS_NORM,f=t.IN_PROP_OFFSET,P=t.IN_RAY_HIT,A=t.IN_RAY_HIT_POS_NORM,S=t.IN_TRANSFORM;t.OUT_INIT=100,t.OUT_ACTIVATE=101,t.OUT_ADD_BOAT_BOB=102,t.OUT_ADD_CAR_WHEEL=103,t.OUT_ADD_FLOATER_BOB=104,t.OUT_APPEND_BOUNDING_BODY=105,t.OUT_APPEND_BOAT=106,t.OUT_APPEND_CAR=107,t.OUT_APPEND_CHARACTER=108,t.OUT_APPEND_COLLISION_TEST=109,t.OUT_APPEND_CONSTRAINT=110,t.OUT_APPEND_FLOATER=111,t.OUT_APPEND_GHOST_MESH_BODY=112,t.OUT_APPEND_STATIC_MESH_BODY=113,t.OUT_APPEND_WATER=114,t.OUT_REMOVE_BODY=115,t.OUT_APPLY_CENTRAL_FORCE=116,t.OUT_APPLY_COLLISION_IMPULSE_TEST=117,t.OUT_APPLY_TORQUE=118,t.OUT_CHARACTER_JUMP=119,t.OUT_CHARACTER_ROTATION_INCREMENT=120,t.OUT_CLEAR_COLLISION_IMPULSE_TEST=121,t.OUT_DISABLE_SIMULATION=122,t.OUT_ENABLE_SIMULATION=123,t.OUT_PAUSE=124,t.OUT_APPEND_RAY_TEST=125,t.OUT_REMOVE_RAY_TEST=126,t.OUT_CHANGE_RAY_TEST_FROM_TO=127,t.OUT_REMOVE_COLLISION_TEST=128,t.OUT_REMOVE_CONSTRAINT=129,t.OUT_RESUME=130,t.OUT_SET_CHARACTER_FLY_VELOCITY=131,t.OUT_SET_CHARACTER_HOR_ROTATION=132,t.OUT_SET_CHARACTER_MOVE_DIR=133,t.OUT_SET_CHARACTER_MOVE_TYPE=134,t.OUT_SET_CHARACTER_ROTATION=135,t.OUT_SET_CHARACTER_RUN_VELOCITY=136,t.OUT_SET_CHARACTER_VERT_ROTATION=137,t.OUT_SET_CHARACTER_WALK_VELOCITY=138,t.OUT_SET_GRAVITY=139,t.OUT_SET_LINEAR_VELOCITY=140,t.OUT_SET_TRANSFORM=141,t.OUT_SET_WATER_TIME=142,t.OUT_ADD_WATER_WRAPPER=143,t.OUT_UPDATE_BOAT_CONTROLS=144,t.OUT_UPDATE_CAR_CONTROLS=145,t.OUT_PING=146,t.OUT_DEBUG=147,t.OUT_UPDATE_WORLD=148,t.OUT_SET_ANGULAR_VELOCITY=149,t.OUT_SET_CHARACTER_VERT_MOVE_DIR_ANGLE=150,t.OUT_UPDATE_BOUNDING_BODY=151,t.OUT_UPDATE_STATIC_MESH_BODY=152;var p=t.OUT_SET_TRANSFORM,O=n.a.worker_listeners,v=n.a.worker_namespaces,m={msg_id:S,body_id:0,time:0,trans:new Float32Array(3),quat:new Float32Array(4),linvel:new Float32Array(3),angvel:new Float32Array(3),len:0},N={msg_id:f,chassis_hull_body_id:0,prop_ind:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},g={msg_id:P,id:0,body_id_hit:0,hit_fract:0,hit_time:0,len:0},R={msg_id:A,id:0,body_id_hit:0,hit_fract:0,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),len:0},I={msg_id:d,body_id_a:0,body_id_b:0,result:0,len:0},b={msg_id:u,body_id_a:0,body_id_b:0,result:0,coll_point:new Float32Array(3),coll_norm:new Float32Array(3),coll_dist:0,len:0},h={msg_id:p,body_id:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},Y=[m,N,g,R,I,b,h];t.create_worker=function(t,o){var i={is_main:!!t,web_worker:null,buf_arr:[],fb_worker_ns:""};if(o){var s={addEventListener:function(e,t,_){"message"!=e&&c.panic("Wrong web worker event"),r(i.fb_worker_ns,i.is_main,t)},removeEventListener:function(e,t,_){"message"!=e&&c.panic("Wrong web worker event"),r(i.fb_worker_ns,i.is_main,null)},postMessage:function(e,t){a(i.fb_worker_ns,!i.is_main)({data:e})},terminate:function(){for(var e=0;e<v.length;e+=2)if(v[e+1]==i.fb_worker_ns)return O.splice(e,2),void v.splice(e,2)}};if(i.web_worker=s,i.is_main){var E=e,d=l.unique_name(E+"_worker");v.push(E),v.push(d),O.push(null),O.push(null),i.fb_worker_ns=d;var u=_(t);u?T?u.addEventListener("load",function(){n.a.require("__bindings",i.fb_worker_ns)},!1):(n.a.cleanup("__bindings",i.fb_worker_ns),n.a.cleanup("__ipc",i.fb_worker_ns),n.a.require("__bindings",i.fb_worker_ns)):(u=document.createElement("script"),u.src=t,u.defer="defer",u.async="async",u.addEventListener("load",function(){T=!1,n.a.require("__bindings",i.fb_worker_ns)},!1),document.head.appendChild(u))}else i.fb_worker_ns=e}else i.web_worker=t?new Worker(t):self;return i},t.attach_handler=function(e,t){E(Y);var _=function(r){if(r.constructor==ArrayBuffer)r=new Float32Array(r);else if(r[0].constructor==ArrayBuffer){for(var a=0;a<r.length;a++)_(r[a]);return}var n=0|r[0];switch(n){case S:var o=m;o.body_id=0|r[1],o.time=r[2],o.trans[0]=r[3],o.trans[1]=r[4],o.trans[2]=r[5],o.quat[0]=r[6],o.quat[1]=r[7],o.quat[2]=r[8],o.quat[3]=r[9],o.linvel[0]=r[10],o.linvel[1]=r[11],o.linvel[2]=r[12],o.angvel[0]=r[13],o.angvel[1]=r[14],o.angvel[2]=r[15];break;case f:var o=N;o.chassis_hull_body_id=0|r[1],o.prop_ind=0|r[2],o.trans[0]=r[3],o.trans[1]=r[4],o.trans[2]=r[5],o.quat[0]=r[6],o.quat[1]=r[7],o.quat[2]=r[8],o.quat[3]=r[9];break;case P:var o=g;o.id=0|r[1],o.body_id_hit=0|r[2],o.hit_fract=r[3],o.hit_time=r[4];break;case A:var o=R;o.id=0|r[1],o.body_id_hit=0|r[2],o.hit_fract=r[3],o.hit_time=r[4],o.hit_pos[0]=r[5],o.hit_pos[1]=r[6],o.hit_pos[2]=r[7],o.hit_norm[0]=r[8],o.hit_norm[1]=r[9],o.hit_norm[2]=r[10];break;case d:var o=I;o.body_id_a=0|r[1],o.body_id_b=0|r[2],o.result=!!r[3];break;case u:var o=b;o.body_id_a=0|r[1],o.body_id_b=0|r[2],o.result=!!r[3],o.coll_point[0]=r[4],o.coll_point[1]=r[5],o.coll_point[2]=r[6],o.coll_norm[0]=r[7],o.coll_norm[1]=r[8],o.coll_norm[2]=r[9],o.coll_dist=r[10];break;case p:var o=h;o.body_id=0|r[1],o.trans[0]=r[2],o.trans[1]=r[3],o.trans[2]=r[4],o.quat[0]=r[5],o.quat[1]=r[6],o.quat[2]=r[7],o.quat[3]=r[8];break;default:var o=r}t(e,n,o)};e.web_worker.addEventListener("message",function(e){_(e.data)},!1)},t.cleanup=function(){},t.post_msg=function(e,t){if(e)switch(t){case S:var _=m,r=new Float32Array(_.len);r[0]=_.msg_id,r[1]=_.body_id,r[2]=_.time,r[3]=_.trans[0],r[4]=_.trans[1],r[5]=_.trans[2],r[6]=_.quat[0],r[7]=_.quat[1],r[8]=_.quat[2],r[9]=_.quat[3],r[10]=_.linvel[0],r[11]=_.linvel[1],r[12]=_.linvel[2],r[13]=_.angvel[0],r[14]=_.angvel[1],r[15]=_.angvel[2],e.buf_arr.push(r.buffer);break;case f:var _=N,r=new Float32Array(_.len);r[0]=_.msg_id,r[1]=_.chassis_hull_body_id,r[2]=_.prop_ind,r[3]=_.trans[0],r[4]=_.trans[1],r[5]=_.trans[2],r[6]=_.quat[0],r[7]=_.quat[1],r[8]=_.quat[2],r[9]=_.quat[3],e.buf_arr.push(r.buffer);break;case P:var _=g,r=new Float32Array(_.len);r[0]=_.msg_id,r[1]=_.id,r[2]=_.body_id_hit,r[3]=_.hit_fract,r[4]=_.hit_time,e.buf_arr.push(r.buffer);break;case A:var _=R,r=new Float32Array(_.len);r[0]=_.msg_id,r[1]=_.id,r[2]=_.body_id_hit,r[3]=_.hit_fract,r[4]=_.hit_time,r[5]=_.hit_pos[0],r[6]=_.hit_pos[1],r[7]=_.hit_pos[2],r[8]=_.hit_norm[0],r[9]=_.hit_norm[1],r[10]=_.hit_norm[2],e.buf_arr.push(r.buffer);break;case d:var _=I,r=new Float32Array(_.len);r[0]=_.msg_id,r[1]=_.body_id_a,r[2]=_.body_id_b,r[3]=_.result,e.buf_arr.push(r.buffer);break;case u:var _=b,r=new Float32Array(_.len);r[0]=_.msg_id,r[1]=_.body_id_a,r[2]=_.body_id_b,r[3]=_.result,r[4]=_.coll_point[0],r[5]=_.coll_point[1],r[6]=_.coll_point[2],r[7]=_.coll_norm[0],r[8]=_.coll_norm[1],r[9]=_.coll_norm[2],r[10]=_.coll_dist,e.buf_arr.push(r.buffer);break;case p:var _=h,r=new Float32Array(_.len);r[0]=_.msg_id,r[1]=_.body_id,r[2]=_.trans[0],r[3]=_.trans[1],r[4]=_.trans[2],r[5]=_.quat[0],r[6]=_.quat[1],r[7]=_.quat[2],r[8]=_.quat[3],e.buf_arr.push(r.buffer);break;default:for(var r=[],a=1;a<arguments.length;a++)r.push(arguments[a]);e.web_worker.postMessage(r)}},t.post_msg_arr=function(e){e&&e.buf_arr.length&&(e.web_worker.postMessage(e.buf_arr),e.buf_arr.length=0)},t.get_msg_cache=function(e){switch(e){case S:return m;case f:return N;case P:return g;case A:return R;case d:return I;case u:return b;case p:return h;default:return null}},t.terminate=function(e){e.web_worker.terminate(),e.web_worker=null},t.is_active=function(e){return!!e.web_worker},t.is_fallback=function(e){return!!e.fb_worker_ns}}var a=_(0),n=_(32),o=_(5),i=_(30),s=_(48),E=Object(a.a)("__ipc",r);t.a=E},function(e,t,_){"use strict";function r(e,t){function _(e){e.sort(r)}function r(e,t){return e.z_index-t.z_index}function a(e,t){if(e.world_bounds){var _=e.world_bounds.bs;return T.squaredDistance(_.center,t)+_.radius*_.radius}return 1/0}function d(e,t){var _=e.obj_render;if(_.is_visible=!1,_.hide)return!1;var r=t.camera;if(t.type==O.SHADOW_CAST)var a=r.lod_eye;else var a=c.i(r.world_tsr,N);var n=e.batch;return!!S.update_lod_visibility(n,_,a)&&(_.is_visible=!0,t.type==O.DEBUG_VIEW?t.debug_view_mode==P.DV_BOUNDINGS?n.debug_sphere:!n.debug_sphere:(t.type!=O.OUTLINE_MASK||0!=_.outline_intensity)&&!(!n.do_not_cull&&e.world_bounds&&v&&u(r.frustum_planes,e.world_bounds.bs,e.world_bounds.be,n.use_be)))}function u(e,t,_,r){var a=t.center;if(l._55(a,e,t.radius))return!0;if(!r)return!1;var n=_.axis_x,o=_.axis_y,i=_.axis_z;return a=_.center,l.X(a,e,n,o,i)}function f(e){var t=e.particles_data;if(t&&t.need_buffers_update){var _=e.bufs_data;A.make_dynamic(_);var r=_.pointers,a=r.a_position.offset;A.vbo_source_data_set_attr(_.vbo_source_data,"a_position",t.positions_cache,a);var n=r.a_tbn.offset;A.vbo_source_data_set_attr(_.vbo_source_data,"a_tbn",t.tbn_cache,n),A.update_gl_buffers(_)}}var P=Object(n.a)(e),A=Object(o.a)(e),S=Object(i.a)(e),p=Object(s.a)(e),O=Object(E.a)(e),v=!0,m=[O.MAIN_OPAQUE,O.MAIN_BLEND,O.MAIN_PLANE_REFLECT,O.MAIN_CUBE_REFLECT,O.MAIN_PLANE_REFLECT_BLEND,O.MAIN_CUBE_REFLECT_BLEND,O.MAIN_GLOW,O.MAIN_XRAY,O.SHADOW_CAST,O.SHADOW_RECEIVE,O.OUTLINE_MASK,O.DEBUG_VIEW,O.COLOR_PICKING,O.COLOR_PICKING_XRAY],N=new Float32Array(3);t.prerender_subs=function(e){if(m.indexOf(e.type)>-1){for(var t=!1,r=e.type==O.MAIN_CUBE_REFLECT||e.type==O.MAIN_CUBE_REFLECT_BLEND,n=e.draw_data,o=0;o<n.length;o++){for(var i=n[o],s=i.bundles,E=!1,l=0;l<s.length;l++){var T=s[l],u=T.batch;if(r)for(var P=0;P<6;P++)e.camera.frustum_planes=e.cube_cam_frustums[P],T.do_render_cube[P]=d(T,e),T.do_render_cube[P]&&(t=!0,E=!0,f(u));else T.do_render=d(T,e),T.do_render&&(t=!0,E=!0,f(u));if(e.need_perm_uniforms_update&&(u.shader.need_uniforms_update=!0),T.do_render){var A=e.camera,S=c.i(A.world_tsr,N),v=a(T,S);T.z_index=v}else T.z_index=1/0}s.length>0&&!s[0].batch.blend&&(_(s),n.z_index=s[0].z_index),i.do_render=E}switch(e.need_perm_uniforms_update=!1,e.type){case O.DEBUG_VIEW:break;default:e.type==O.MAIN_OPAQUE||e.type==O.SHADOW_RECEIVE||e.type==O.MAIN_GLOW||e.type==O.MAIN_PLANE_REFLECT||e.type==O.MAIN_CUBE_REFLECT||t?e.do_render=!0:(e.do_render&&p.clear(e),e.do_render=!1)}}else if(e.need_perm_uniforms_update){for(var n=e.draw_data,o=0;o<n.length;o++)for(var s=n[o].bundles,l=0;l<s.length;l++){var T=s[l],u=T.batch;u.shader.need_uniforms_update=!0}e.need_perm_uniforms_update=!1}e.need_draw_data_sort&&O.sort_draw_data(e)}}var a=_(0),n=_(45),o=_(20),i=_(12),s=_(22),E=_(11),c=_(6),l=_(2),T=_(3),d=Object(a.a)("__prerender",r);t.a=d},function(e,t,_){"use strict";_.d(t,"a",function(){return n});var e,r,a;!function(t){if("object"==typeof exports&&void 0!==e)e.exports=t();else if("function"==typeof r&&r.amd)r([],t);else{var _;_="undefined"!=typeof window?window:"undefined"!=typeof self?self:this,_.pako=t()}}(function(){return function e(t,_,r){function n(i,s){if(!_[i]){if(!t[i]){var E="function"==typeof a&&a;if(!s&&E)return E(i,!0);if(o)return o(i,!0);var c=new Error("Cannot find module '"+i+"'");throw c.code="MODULE_NOT_FOUND",c}var l=_[i]={exports:{}};t[i][0].call(l.exports,function(e){var _=t[i][1][e];return n(_||e)},l,l.exports,e,t,_,r)}return _[i].exports}for(var o="function"==typeof a&&a,i=0;i<r.length;i++)n(r[i]);return n}({1:[function(e,t,_){var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;_.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var _=t.shift();if(_){if("object"!=typeof _)throw new TypeError(_+"must be non-object");for(var r in _)_.hasOwnProperty(r)&&(e[r]=_[r])}}return e},_.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var a={arraySet:function(e,t,_,r,a){if(t.subarray&&e.subarray)return void e.set(t.subarray(_,_+r),a);for(var n=0;n<r;n++)e[a+n]=t[_+n]},flattenChunks:function(e){var t,_,r,a,n,o;for(r=0,t=0,_=e.length;t<_;t++)r+=e[t].length;for(o=new Uint8Array(r),a=0,t=0,_=e.length;t<_;t++)n=e[t],o.set(n,a),a+=n.length;return o}},n={arraySet:function(e,t,_,r,a){for(var n=0;n<r;n++)e[a+n]=t[_+n]},flattenChunks:function(e){return[].concat.apply([],e)}};_.setTyped=function(e){e?(_.Buf8=Uint8Array,_.Buf16=Uint16Array,_.Buf32=Int32Array,_.assign(_,a)):(_.Buf8=Array,_.Buf16=Array,_.Buf32=Array,_.assign(_,n))},_.setTyped(r)},{}],2:[function(e,t,_){function r(e,t){if(t<65537&&(e.subarray&&o||!e.subarray&&n))return String.fromCharCode.apply(null,a.shrinkBuf(e,t));for(var _="",r=0;r<t;r++)_+=String.fromCharCode(e[r]);return _}var a=e("./common"),n=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(e){n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){o=!1}for(var i=new a.Buf8(256),s=0;s<256;s++)i[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;i[254]=i[254]=1,_.string2buf=function(e){var t,_,r,n,o,i=e.length,s=0;for(n=0;n<i;n++)_=e.charCodeAt(n),55296==(64512&_)&&n+1<i&&56320==(64512&(r=e.charCodeAt(n+1)))&&(_=65536+(_-55296<<10)+(r-56320),n++),s+=_<128?1:_<2048?2:_<65536?3:4;for(t=new a.Buf8(s),o=0,n=0;o<s;n++)_=e.charCodeAt(n),55296==(64512&_)&&n+1<i&&56320==(64512&(r=e.charCodeAt(n+1)))&&(_=65536+(_-55296<<10)+(r-56320),n++),_<128?t[o++]=_:_<2048?(t[o++]=192|_>>>6,t[o++]=128|63&_):_<65536?(t[o++]=224|_>>>12,t[o++]=128|_>>>6&63,t[o++]=128|63&_):(t[o++]=240|_>>>18,t[o++]=128|_>>>12&63,t[o++]=128|_>>>6&63,t[o++]=128|63&_);return t},_.buf2binstring=function(e){return r(e,e.length)},_.binstring2buf=function(e){for(var t=new a.Buf8(e.length),_=0,r=t.length;_<r;_++)t[_]=e.charCodeAt(_);return t},_.buf2string=function(e,t){var _,a,n,o,s=t||e.length,E=new Array(2*s);for(a=0,_=0;_<s;)if((n=e[_++])<128)E[a++]=n;else if((o=i[n])>4)E[a++]=65533,_+=o-1;else{for(n&=2===o?31:3===o?15:7;o>1&&_<s;)n=n<<6|63&e[_++],o--;o>1?E[a++]=65533:n<65536?E[a++]=n:(n-=65536,E[a++]=55296|n>>10&1023,E[a++]=56320|1023&n)}return r(E,a)},_.utf8border=function(e,t){var _;for(t=t||e.length,t>e.length&&(t=e.length),_=t-1;_>=0&&128==(192&e[_]);)_--;return _<0?t:0===_?t:_+i[e[_]]>t?_:t}},{"./common":1}],3:[function(e,t,_){function r(e,t,_,r){for(var a=65535&e|0,n=e>>>16&65535|0,o=0;0!==_;){o=_>2e3?2e3:_,_-=o;do{a=a+t[r++]|0,n=n+a|0}while(--o);a%=65521,n%=65521}return a|n<<16|0}t.exports=r},{}],4:[function(e,t,_){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],5:[function(e,t,_){function r(e,t,_,r){var n=a,o=r+_;e^=-1;for(var i=r;i<o;i++)e=e>>>8^n[255&(e^t[i])];return-1^e}var a=function(){for(var e,t=[],_=0;_<256;_++){e=_;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[_]=e}return t}();t.exports=r},{}],6:[function(e,t,_){function r(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}t.exports=r},{}],7:[function(e,t,_){t.exports=function(e,t){var _,r,a,n,o,i,s,E,c,l,T,d,u,f,P,A,S,p,O,v,m,N,g,R,I;_=e.state,r=e.next_in,R=e.input,a=r+(e.avail_in-5),n=e.next_out,I=e.output,o=n-(t-e.avail_out),i=n+(e.avail_out-257),s=_.dmax,E=_.wsize,c=_.whave,l=_.wnext,T=_.window,d=_.hold,u=_.bits,f=_.lencode,P=_.distcode,A=(1<<_.lenbits)-1,S=(1<<_.distbits)-1;e:do{u<15&&(d+=R[r++]<<u,u+=8,d+=R[r++]<<u,u+=8),p=f[d&A];t:for(;;){if(O=p>>>24,d>>>=O,u-=O,0===(O=p>>>16&255))I[n++]=65535&p;else{if(!(16&O)){if(0==(64&O)){p=f[(65535&p)+(d&(1<<O)-1)];continue t}if(32&O){_.mode=12;break e}e.msg="invalid literal/length code",_.mode=30;break e}v=65535&p,O&=15,O&&(u<O&&(d+=R[r++]<<u,u+=8),v+=d&(1<<O)-1,d>>>=O,u-=O),u<15&&(d+=R[r++]<<u,u+=8,d+=R[r++]<<u,u+=8),p=P[d&S];_:for(;;){if(O=p>>>24,d>>>=O,u-=O,!(16&(O=p>>>16&255))){if(0==(64&O)){p=P[(65535&p)+(d&(1<<O)-1)];continue _}e.msg="invalid distance code",_.mode=30;break e}if(m=65535&p,O&=15,u<O&&(d+=R[r++]<<u,(u+=8)<O&&(d+=R[r++]<<u,u+=8)),(m+=d&(1<<O)-1)>s){e.msg="invalid distance too far back",_.mode=30;break e}if(d>>>=O,u-=O,O=n-o,m>O){if((O=m-O)>c&&_.sane){e.msg="invalid distance too far back",_.mode=30;break e}if(N=0,g=T,0===l){if(N+=E-O,O<v){v-=O;do{I[n++]=T[N++]}while(--O);N=n-m,g=I}}else if(l<O){if(N+=E+l-O,(O-=l)<v){v-=O;do{I[n++]=T[N++]}while(--O);if(N=0,l<v){O=l,v-=O;do{I[n++]=T[N++]}while(--O);N=n-m,g=I}}}else if(N+=l-O,O<v){v-=O;do{I[n++]=T[N++]}while(--O);N=n-m,g=I}for(;v>2;)I[n++]=g[N++],I[n++]=g[N++],I[n++]=g[N++],v-=3;v&&(I[n++]=g[N++],v>1&&(I[n++]=g[N++]))}else{N=n-m;do{I[n++]=I[N++],I[n++]=I[N++],I[n++]=I[N++],v-=3}while(v>2);v&&(I[n++]=I[N++],v>1&&(I[n++]=I[N++]))}break}}break}}while(r<a&&n<i);v=u>>3,r-=v,u-=v<<3,d&=(1<<u)-1,e.next_in=r,e.next_out=n,e.avail_in=r<a?a-r+5:5-(r-a),e.avail_out=n<i?i-n+257:257-(n-i),_.hold=d,_.bits=u}},{}],8:[function(e,t,_){function r(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function a(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new S.Buf16(320),this.work=new S.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function n(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=D,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new S.Buf32(fe),t.distcode=t.distdyn=new S.Buf32(Pe),t.sane=1,t.back=-1,Y):x}function o(e){var t;return e&&e.state?(t=e.state,t.wsize=0,t.whave=0,t.wnext=0,n(e)):x}function i(e,t){var _,r;return e&&e.state?(r=e.state,t<0?(_=0,t=-t):(_=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?x:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=_,r.wbits=t,o(e))):x}function s(e,t){var _,r;return e?(r=new a,e.state=r,r.window=null,_=i(e,t),_!==Y&&(e.state=null),_):x}function E(e){return s(e,Ae)}function c(e){if(Se){var t;for(P=new S.Buf32(512),A=new S.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(m(g,e.lens,0,288,P,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;m(R,e.lens,0,32,A,0,e.work,{bits:5}),Se=!1}e.lencode=P,e.lenbits=9,e.distcode=A,e.distbits=5}function l(e,t,_,r){var a,n=e.state;return null===n.window&&(n.wsize=1<<n.wbits,n.wnext=0,n.whave=0,n.window=new S.Buf8(n.wsize)),r>=n.wsize?(S.arraySet(n.window,t,_-n.wsize,n.wsize,0),n.wnext=0,n.whave=n.wsize):(a=n.wsize-n.wnext,a>r&&(a=r),S.arraySet(n.window,t,_-r,a,n.wnext),r-=a,r?(S.arraySet(n.window,t,_-r,r,0),n.wnext=r,n.whave=n.wsize):(n.wnext+=a,n.wnext===n.wsize&&(n.wnext=0),n.whave<n.wsize&&(n.whave+=a))),0}function T(e,t){var _,a,n,o,i,s,E,T,d,u,f,P,A,fe,Pe,Ae,Se,pe,Oe,ve,me,Ne,ge,Re,Ie=0,be=new S.Buf8(4),he=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return x;_=e.state,_.mode===V&&(_.mode=q),i=e.next_out,n=e.output,E=e.avail_out,o=e.next_in,a=e.input,s=e.avail_in,T=_.hold,d=_.bits,u=s,f=E,Ne=Y;e:for(;;)switch(_.mode){case D:if(0===_.wrap){_.mode=q;break}for(;d<16;){if(0===s)break e;s--,T+=a[o++]<<d,d+=8}if(2&_.wrap&&35615===T){_.check=0,be[0]=255&T,be[1]=T>>>8&255,_.check=O(_.check,be,2,0),T=0,d=0,_.mode=F;break}if(_.flags=0,_.head&&(_.head.done=!1),!(1&_.wrap)||(((255&T)<<8)+(T>>8))%31){e.msg="incorrect header check",_.mode=Te;break}if((15&T)!==C){e.msg="unknown compression method",_.mode=Te;break}if(T>>>=4,d-=4,me=8+(15&T),0===_.wbits)_.wbits=me;else if(me>_.wbits){e.msg="invalid window size",_.mode=Te;break}_.dmax=1<<me,e.adler=_.check=1,_.mode=512&T?Q:V,T=0,d=0;break;case F:for(;d<16;){if(0===s)break e;s--,T+=a[o++]<<d,d+=8}if(_.flags=T,(255&_.flags)!==C){e.msg="unknown compression method",_.mode=Te;break}if(57344&_.flags){e.msg="unknown header flags set",_.mode=Te;break}_.head&&(_.head.text=T>>8&1),512&_.flags&&(be[0]=255&T,be[1]=T>>>8&255,_.check=O(_.check,be,2,0)),T=0,d=0,_.mode=G;case G:for(;d<32;){if(0===s)break e;s--,T+=a[o++]<<d,d+=8}_.head&&(_.head.time=T),512&_.flags&&(be[0]=255&T,be[1]=T>>>8&255,be[2]=T>>>16&255,be[3]=T>>>24&255,_.check=O(_.check,be,4,0)),T=0,d=0,_.mode=k;case k:for(;d<16;){if(0===s)break e;s--,T+=a[o++]<<d,d+=8}_.head&&(_.head.xflags=255&T,_.head.os=T>>8),512&_.flags&&(be[0]=255&T,be[1]=T>>>8&255,_.check=O(_.check,be,2,0)),T=0,d=0,_.mode=K;case K:if(1024&_.flags){for(;d<16;){if(0===s)break e;s--,T+=a[o++]<<d,d+=8}_.length=T,_.head&&(_.head.extra_len=T),512&_.flags&&(be[0]=255&T,be[1]=T>>>8&255,_.check=O(_.check,be,2,0)),T=0,d=0}else _.head&&(_.head.extra=null);_.mode=B;case B:if(1024&_.flags&&(P=_.length,P>s&&(P=s),P&&(_.head&&(me=_.head.extra_len-_.length,_.head.extra||(_.head.extra=new Array(_.head.extra_len)),S.arraySet(_.head.extra,a,o,P,me)),512&_.flags&&(_.check=O(_.check,a,P,o)),s-=P,o+=P,_.length-=P),_.length))break e;_.length=0,_.mode=X;case X:if(2048&_.flags){if(0===s)break e;P=0;do{me=a[o+P++],_.head&&me&&_.length<65536&&(_.head.name+=String.fromCharCode(me))}while(me&&P<s);if(512&_.flags&&(_.check=O(_.check,a,P,o)),s-=P,o+=P,me)break e}else _.head&&(_.head.name=null);_.length=0,_.mode=H;case H:if(4096&_.flags){if(0===s)break e;P=0;do{me=a[o+P++],_.head&&me&&_.length<65536&&(_.head.comment+=String.fromCharCode(me))}while(me&&P<s);if(512&_.flags&&(_.check=O(_.check,a,P,o)),s-=P,o+=P,me)break e}else _.head&&(_.head.comment=null);_.mode=j;case j:if(512&_.flags){for(;d<16;){if(0===s)break e;s--,T+=a[o++]<<d,d+=8}if(T!==(65535&_.check)){e.msg="header crc mismatch",_.mode=Te;break}T=0,d=0}_.head&&(_.head.hcrc=_.flags>>9&1,_.head.done=!0),e.adler=_.check=0,_.mode=V;break;case Q:for(;d<32;){if(0===s)break e;s--,T+=a[o++]<<d,d+=8}e.adler=_.check=r(T),T=0,d=0,_.mode=z;case z:if(0===_.havedict)return e.next_out=i,e.avail_out=E,e.next_in=o,e.avail_in=s,_.hold=T,_.bits=d,M;e.adler=_.check=1,_.mode=V;case V:if(t===b||t===h)break e;case q:if(_.last){T>>>=7&d,d-=7&d,_.mode=Ee;break}for(;d<3;){if(0===s)break e;s--,T+=a[o++]<<d,d+=8}switch(_.last=1&T,T>>>=1,d-=1,3&T){case 0:_.mode=W;break;case 1:if(c(_),_.mode=_e,t===h){T>>>=2,d-=2;break e}break;case 2:_.mode=$;break;case 3:e.msg="invalid block type",_.mode=Te}T>>>=2,d-=2;break;case W:for(T>>>=7&d,d-=7&d;d<32;){if(0===s)break e;s--,T+=a[o++]<<d,d+=8}if((65535&T)!=(T>>>16^65535)){e.msg="invalid stored block lengths",_.mode=Te;break}if(_.length=65535&T,T=0,d=0,_.mode=J,t===h)break e;case J:_.mode=Z;case Z:if(P=_.length){if(P>s&&(P=s),P>E&&(P=E),0===P)break e;S.arraySet(n,a,o,P,i),s-=P,o+=P,E-=P,i+=P,_.length-=P;break}_.mode=V;break;case $:for(;d<14;){if(0===s)break e;s--,T+=a[o++]<<d,d+=8}if(_.nlen=257+(31&T),T>>>=5,d-=5,_.ndist=1+(31&T),T>>>=5,d-=5,_.ncode=4+(15&T),T>>>=4,d-=4,_.nlen>286||_.ndist>30){e.msg="too many length or distance symbols",_.mode=Te;break}_.have=0,_.mode=ee;case ee:for(;_.have<_.ncode;){for(;d<3;){if(0===s)break e;s--,T+=a[o++]<<d,d+=8}_.lens[he[_.have++]]=7&T,T>>>=3,d-=3}for(;_.have<19;)_.lens[he[_.have++]]=0;if(_.lencode=_.lendyn,_.lenbits=7,ge={bits:_.lenbits},Ne=m(N,_.lens,0,19,_.lencode,0,_.work,ge),_.lenbits=ge.bits,Ne){e.msg="invalid code lengths set",_.mode=Te;break}_.have=0,_.mode=te;case te:for(;_.have<_.nlen+_.ndist;){for(;Ie=_.lencode[T&(1<<_.lenbits)-1],Pe=Ie>>>24,Ae=Ie>>>16&255,Se=65535&Ie,!(Pe<=d);){if(0===s)break e;s--,T+=a[o++]<<d,d+=8}if(Se<16)T>>>=Pe,d-=Pe,_.lens[_.have++]=Se;else{if(16===Se){for(Re=Pe+2;d<Re;){if(0===s)break e;s--,T+=a[o++]<<d,d+=8}if(T>>>=Pe,d-=Pe,0===_.have){e.msg="invalid bit length repeat",_.mode=Te;break}me=_.lens[_.have-1],P=3+(3&T),T>>>=2,d-=2}else if(17===Se){for(Re=Pe+3;d<Re;){if(0===s)break e;s--,T+=a[o++]<<d,d+=8}T>>>=Pe,d-=Pe,me=0,P=3+(7&T),T>>>=3,d-=3}else{for(Re=Pe+7;d<Re;){if(0===s)break e;s--,T+=a[o++]<<d,d+=8}T>>>=Pe,d-=Pe,me=0,P=11+(127&T),T>>>=7,d-=7}if(_.have+P>_.nlen+_.ndist){e.msg="invalid bit length repeat",_.mode=Te;break}for(;P--;)_.lens[_.have++]=me}}if(_.mode===Te)break;if(0===_.lens[256]){e.msg="invalid code -- missing end-of-block",_.mode=Te;break}if(_.lenbits=9,ge={bits:_.lenbits},Ne=m(g,_.lens,0,_.nlen,_.lencode,0,_.work,ge),_.lenbits=ge.bits,Ne){e.msg="invalid literal/lengths set",_.mode=Te;break}if(_.distbits=6,_.distcode=_.distdyn,ge={bits:_.distbits},Ne=m(R,_.lens,_.nlen,_.ndist,_.distcode,0,_.work,ge),_.distbits=ge.bits,Ne){e.msg="invalid distances set",_.mode=Te;break}if(_.mode=_e,t===h)break e;case _e:_.mode=re;case re:if(s>=6&&E>=258){e.next_out=i,e.avail_out=E,e.next_in=o,e.avail_in=s,_.hold=T,_.bits=d,v(e,f),i=e.next_out,n=e.output,E=e.avail_out,o=e.next_in,a=e.input,s=e.avail_in,T=_.hold,d=_.bits,_.mode===V&&(_.back=-1);break}for(_.back=0;Ie=_.lencode[T&(1<<_.lenbits)-1],Pe=Ie>>>24,Ae=Ie>>>16&255,Se=65535&Ie,!(Pe<=d);){if(0===s)break e;s--,T+=a[o++]<<d,d+=8}if(Ae&&0==(240&Ae)){for(pe=Pe,Oe=Ae,ve=Se;Ie=_.lencode[ve+((T&(1<<pe+Oe)-1)>>pe)],Pe=Ie>>>24,Ae=Ie>>>16&255,Se=65535&Ie,!(pe+Pe<=d);){if(0===s)break e;s--,T+=a[o++]<<d,d+=8}T>>>=pe,d-=pe,_.back+=pe}if(T>>>=Pe,d-=Pe,_.back+=Pe,_.length=Se,0===Ae){_.mode=se;break}if(32&Ae){_.back=-1,_.mode=V;break}if(64&Ae){e.msg="invalid literal/length code",_.mode=Te;break}_.extra=15&Ae,_.mode=ae;case ae:if(_.extra){for(Re=_.extra;d<Re;){if(0===s)break e;s--,T+=a[o++]<<d,d+=8}_.length+=T&(1<<_.extra)-1,T>>>=_.extra,d-=_.extra,_.back+=_.extra}_.was=_.length,_.mode=ne;case ne:for(;Ie=_.distcode[T&(1<<_.distbits)-1],Pe=Ie>>>24,Ae=Ie>>>16&255,Se=65535&Ie,!(Pe<=d);){if(0===s)break e;s--,T+=a[o++]<<d,d+=8}if(0==(240&Ae)){for(pe=Pe,Oe=Ae,ve=Se;Ie=_.distcode[ve+((T&(1<<pe+Oe)-1)>>pe)],Pe=Ie>>>24,Ae=Ie>>>16&255,Se=65535&Ie,!(pe+Pe<=d);){if(0===s)break e;s--,T+=a[o++]<<d,d+=8}T>>>=pe,d-=pe,_.back+=pe}if(T>>>=Pe,d-=Pe,_.back+=Pe,64&Ae){e.msg="invalid distance code",_.mode=Te;break}_.offset=Se,_.extra=15&Ae,_.mode=oe;case oe:if(_.extra){for(Re=_.extra;d<Re;){if(0===s)break e;s--,T+=a[o++]<<d,d+=8}_.offset+=T&(1<<_.extra)-1,T>>>=_.extra,d-=_.extra,_.back+=_.extra}if(_.offset>_.dmax){e.msg="invalid distance too far back",_.mode=Te;break}_.mode=ie;case ie:if(0===E)break e;if(P=f-E,_.offset>P){if((P=_.offset-P)>_.whave&&_.sane){e.msg="invalid distance too far back",_.mode=Te;break}P>_.wnext?(P-=_.wnext,A=_.wsize-P):A=_.wnext-P,P>_.length&&(P=_.length),fe=_.window}else fe=n,A=i-_.offset,P=_.length;P>E&&(P=E),E-=P,_.length-=P;do{n[i++]=fe[A++]}while(--P);0===_.length&&(_.mode=re);break;case se:if(0===E)break e;n[i++]=_.length,E--,_.mode=re;break;case Ee:if(_.wrap){for(;d<32;){if(0===s)break e;s--,T|=a[o++]<<d,d+=8}if(f-=E,e.total_out+=f,_.total+=f,f&&(e.adler=_.check=_.flags?O(_.check,n,f,i-f):p(_.check,n,f,i-f)),f=E,(_.flags?T:r(T))!==_.check){e.msg="incorrect data check",_.mode=Te;break}T=0,d=0}_.mode=ce;case ce:if(_.wrap&&_.flags){for(;d<32;){if(0===s)break e;s--,T+=a[o++]<<d,d+=8}if(T!==(4294967295&_.total)){e.msg="incorrect length check",_.mode=Te;break}T=0,d=0}_.mode=le;case le:Ne=L;break e;case Te:Ne=y;break e;case de:return U;case ue:default:return x}return e.next_out=i,e.avail_out=E,e.next_in=o,e.avail_in=s,_.hold=T,_.bits=d,(_.wsize||f!==e.avail_out&&_.mode<Te&&(_.mode<Ee||t!==I))&&l(e,e.output,e.next_out,f-e.avail_out)?(_.mode=de,U):(u-=e.avail_in,f-=e.avail_out,e.total_in+=u,e.total_out+=f,_.total+=f,_.wrap&&f&&(e.adler=_.check=_.flags?O(_.check,n,f,e.next_out-f):p(_.check,n,f,e.next_out-f)),e.data_type=_.bits+(_.last?64:0)+(_.mode===V?128:0)+(_.mode===_e||_.mode===J?256:0),(0===u&&0===f||t===I)&&Ne===Y&&(Ne=w),Ne)}function d(e){if(!e||!e.state)return x;var t=e.state;return t.window&&(t.window=null),e.state=null,Y}function u(e,t){var _;return e&&e.state?(_=e.state,0==(2&_.wrap)?x:(_.head=t,t.done=!1,Y)):x}function f(e,t){var _,r,a=t.length;return e&&e.state?(_=e.state,0!==_.wrap&&_.mode!==z?x:_.mode===z&&(r=1,(r=p(r,t,a,0))!==_.check)?y:l(e,t,a,a)?(_.mode=de,U):(_.havedict=1,Y)):x}var P,A,S=e("../utils/common"),p=e("./adler32"),O=e("./crc32"),v=e("./inffast"),m=e("./inftrees"),N=0,g=1,R=2,I=4,b=5,h=6,Y=0,L=1,M=2,x=-2,y=-3,U=-4,w=-5,C=8,D=1,F=2,G=3,k=4,K=5,B=6,X=7,H=8,j=9,Q=10,z=11,V=12,q=13,W=14,J=15,Z=16,$=17,ee=18,te=19,_e=20,re=21,ae=22,ne=23,oe=24,ie=25,se=26,Ee=27,ce=28,le=29,Te=30,de=31,ue=32,fe=852,Pe=592,Ae=15,Se=!0;_.inflateReset=o,_.inflateReset2=i,_.inflateResetKeep=n,_.inflateInit=E,_.inflateInit2=s,_.inflate=T,_.inflateEnd=d,_.inflateGetHeader=u,_.inflateSetDictionary=f,_.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":1,"./adler32":3,"./crc32":5,"./inffast":7,"./inftrees":9}],9:[function(e,t,_){var r=e("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],n=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],i=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,_,s,E,c,l,T){var d,u,f,P,A,S,p,O,v,m=T.bits,N=0,g=0,R=0,I=0,b=0,h=0,Y=0,L=0,M=0,x=0,y=null,U=0,w=new r.Buf16(16),C=new r.Buf16(16),D=null,F=0;for(N=0;N<=15;N++)w[N]=0;for(g=0;g<s;g++)w[t[_+g]]++;for(b=m,I=15;I>=1&&0===w[I];I--);if(b>I&&(b=I),0===I)return E[c++]=20971520,E[c++]=20971520,T.bits=1,0;for(R=1;R<I&&0===w[R];R++);for(b<R&&(b=R),L=1,N=1;N<=15;N++)if(L<<=1,(L-=w[N])<0)return-1;if(L>0&&(0===e||1!==I))return-1;for(C[1]=0,N=1;N<15;N++)C[N+1]=C[N]+w[N];for(g=0;g<s;g++)0!==t[_+g]&&(l[C[t[_+g]]++]=g);if(0===e?(y=D=l,S=19):1===e?(y=a,U-=257,D=n,F-=257,S=256):(y=o,D=i,S=-1),x=0,g=0,N=R,A=c,h=b,Y=0,f=-1,M=1<<b,P=M-1,1===e&&M>852||2===e&&M>592)return 1;for(;;){p=N-Y,l[g]<S?(O=0,v=l[g]):l[g]>S?(O=D[F+l[g]],v=y[U+l[g]]):(O=96,v=0),d=1<<N-Y,u=1<<h,R=u;do{u-=d,E[A+(x>>Y)+u]=p<<24|O<<16|v|0}while(0!==u);for(d=1<<N-1;x&d;)d>>=1;if(0!==d?(x&=d-1,x+=d):x=0,g++,0==--w[N]){if(N===I)break;N=t[_+l[g]]}if(N>b&&(x&P)!==f){for(0===Y&&(Y=b),A+=R,h=N-Y,L=1<<h;h+Y<I&&!((L-=w[h+Y])<=0);)h++,L<<=1;if(M+=1<<h,1===e&&M>852||2===e&&M>592)return 1;f=x&P,E[f]=b<<24|h<<16|A-c|0}}return 0!==x&&(E[A+x]=N-Y<<24|64<<16|0),T.bits=b,0}},{"../utils/common":1}],10:[function(e,t,_){t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],11:[function(e,t,_){function r(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}t.exports=r},{}],"/lib/inflate.js":[function(e,t,_){function r(e){if(!(this instanceof r))return new r(e);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var _=o.inflateInit2(this.strm,t.windowBits);if(_!==E.Z_OK)throw new Error(c[_]);this.header=new T,o.inflateGetHeader(this.strm,this.header)}function a(e,t){var _=new r(t);if(_.push(e,!0),_.err)throw _.msg||c[_.err];return _.result}function n(e,t){return t=t||{},t.raw=!0,a(e,t)}var o=e("./zlib/inflate"),i=e("./utils/common"),s=e("./utils/strings"),E=e("./zlib/constants"),c=e("./zlib/messages"),l=e("./zlib/zstream"),T=e("./zlib/gzheader"),d=Object.prototype.toString;r.prototype.push=function(e,t){var _,r,a,n,c,l,T=this.strm,u=this.options.chunkSize,f=this.options.dictionary,P=!1;if(this.ended)return!1;r=t===~~t?t:!0===t?E.Z_FINISH:E.Z_NO_FLUSH,"string"==typeof e?T.input=s.binstring2buf(e):"[object ArrayBuffer]"===d.call(e)?T.input=new Uint8Array(e):T.input=e,T.next_in=0,T.avail_in=T.input.length;do{if(0===T.avail_out&&(T.output=new i.Buf8(u),T.next_out=0,T.avail_out=u),_=o.inflate(T,E.Z_NO_FLUSH),_===E.Z_NEED_DICT&&f&&(l="string"==typeof f?s.string2buf(f):"[object ArrayBuffer]"===d.call(f)?new Uint8Array(f):f,_=o.inflateSetDictionary(this.strm,l)),_===E.Z_BUF_ERROR&&!0===P&&(_=E.Z_OK,P=!1),_!==E.Z_STREAM_END&&_!==E.Z_OK)return this.onEnd(_),this.ended=!0,!1;T.next_out&&(0!==T.avail_out&&_!==E.Z_STREAM_END&&(0!==T.avail_in||r!==E.Z_FINISH&&r!==E.Z_SYNC_FLUSH)||("string"===this.options.to?(a=s.utf8border(T.output,T.next_out),n=T.next_out-a,c=s.buf2string(T.output,a),T.next_out=n,T.avail_out=u-n,n&&i.arraySet(T.output,T.output,a,n,0),this.onData(c)):this.onData(i.shrinkBuf(T.output,T.next_out)))),0===T.avail_in&&0===T.avail_out&&(P=!0)}while((T.avail_in>0||0===T.avail_out)&&_!==E.Z_STREAM_END);return _===E.Z_STREAM_END&&(r=E.Z_FINISH),r===E.Z_FINISH?(_=o.inflateEnd(this.strm),this.onEnd(_),this.ended=!0,_===E.Z_OK):r!==E.Z_SYNC_FLUSH||(this.onEnd(E.Z_OK),T.avail_out=0,!0)},r.prototype.onData=function(e){this.chunks.push(e)},r.prototype.onEnd=function(e){e===E.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},_.Inflate=r,_.inflate=a,_.inflateRaw=n,_.ungzip=a},{"./utils/common":1,"./utils/strings":2,"./zlib/constants":4,"./zlib/gzheader":6,"./zlib/inflate":8,"./zlib/messages":10,"./zlib/zstream":11}]},{},[])("/lib/inflate.js")});var n=window.pako.inflate},function(e,t,_){"use strict";_(32).a.module.shader_texts=function(e,t){e["anchors.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","GLSL_OUT_FRAG_COLOR","=","vec4","(","1.0",")",";","}"]}]},e["anchors.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"ANCHOR_NUM",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["uniform","vec3","u_position","[","ANCHOR_NUM","]",";","uniform","mat4","u_view_proj_matrix",";","uniform","vec2","u_texel_size",";","GLSL_IN","float","a_index",";","void","main","(",")","{","int","c","=","int","(","mod","(","a_index",",","3.0",")",")",";","int","d","=","int","(","a_index","/","3.0",")",";","vec2","e",";","if","(","c","==","0",")","{","e","=","vec2","(","-","4.0","*","u_texel_size","[","0","]",",","-","u_texel_size","[","1","]",")",";","}","else","if","(","c","==","1",")","{","e","=","vec2","(","4.0","*","u_texel_size","[","0","]",",","-","u_texel_size","[","1","]",")",";","}","else","{","e","=","vec2","(","0.0",",","5.0","*","u_texel_size","[","1","]",")",";","}","vec4","f","=","u_view_proj_matrix","*","vec4","(","u_position","[","d","]",",","1.0",")",";","f",".","xy","+=","e","*","f",".","w",";","gl_Position","=","f",";","}"]}]},e["color_id.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"NODES",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"USE_OUTLINE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_VIEW_TSR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_VIEW_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"CAMERA_TYPE",TOKENS:["CAM_TYPE_PERSP"]},{TYPE:"var",NAME:"USE_POSITION_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"USE_REFRACTION",TOKENS:["0"]},{TYPE:"var",NAME:"USE_REFRACTION_CORRECTION",TOKENS:["0"]},{TYPE:"var",NAME:"USE_ENVIRONMENT_LIGHT",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_BLEND_TYPE",TOKENS:["TEXTURE_BLEND_TYPE_MIX"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LAMP_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_TEXTURE",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_VALUES",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_RGBS",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"POISSON_DISK_NUM",TOKENS:["NO_SOFT_SHADOWS"]},{TYPE:"var",NAME:"USE_DERIVATIVES_EXT",TOKENS:["0"]},{TYPE:"var",NAME:"USE_LOD_SMOOTHING",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1","USE_DERIVATIVES_EXT",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"extension",TOKENS:["GL_OES_standard_derivatives",":","enable"]}]}}]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"math.glslv"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"coverage.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_time",";","uniform","float","u_environment_energy",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LIGHTS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_light_positions","[","NUM_LIGHTS","]",";","uniform","vec3","u_light_directions","[","NUM_LIGHTS","]",";","uniform","vec4","u_light_color_intensities","[","NUM_LIGHTS","]",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_eye_frag",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{TYPE:"logical_or_expr",PLACES:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_direction",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_VIEW_TSR",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_VIEW_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_texture",";"]}]}},{TYPE:"elif",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_horizon_color",";","uniform","vec3","u_zenith_color",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_diffuse_color",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_sampler",";","uniform","float","u_alpha_factor",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_OUTLINE",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_color_id",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_plane_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_CUBE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_cube_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_refractmap",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_emit",";","uniform","float","u_ambient",";","uniform","vec2","u_fresnel_params",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_mirror_factor",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_refl_plane",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_LAMP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_lamp_light_positions","[","NUM_LAMP_LIGHTS","]",";","uniform","vec3","u_lamp_light_directions","[","NUM_LAMP_LIGHTS","]",";","uniform","vec3","u_lamp_light_color_intensities","[","NUM_LAMP_LIGHTS","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_VALUE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_node_values","[","NUM_VALUES","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_RGB"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_node_rgbs","[","NUM_RGBS","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec4","u_csm_center_dists",";","uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map0",";","uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";","uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";","uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";","uniform","sampler2D","u_shadow_mask",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_OUTLINE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_outline_intensity",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_OBJECT_INFO"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_obj_info",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_lod_coverage",";","uniform","float","u_lod_cmp_logic",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","h",";","GLSL_IN","vec4","i",";","GLSL_IN","vec3","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","k",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","m",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","n",";","GLSL_IN","vec4","o",";","GLSL_IN","vec4","u",";","GLSL_IN","vec4","v",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","B",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"nodes.glslf"}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","!","C","(","u_lod_coverage",",","u_lod_cmp_logic",")",")","discard",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","D","=","normalize","(","u_camera_eye_frag","-","h",")",";","vec3","E",";","vec3","F",";","vec3","G",";","vec4","H",";","float","I",";","J","(","D",",","E",",","F",",","G",",","H",",","I",")",";","float","L","=","I",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","L","=","(","GLSL_TEXTURE","(","u_sampler",",","A",")",")",".","a",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","M","=","u_alpha_factor","*","L",";","M","+=","(","1.0","-","step","(","0.0",",","M",")",")",";","L","=","mix","(","M",",","1.0",",","u_diffuse_color",".","a",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","L","=","u_diffuse_color",".","a",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA_CLIP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","L","<","0.5",")","discard",";","L","=","1.0",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_OUTLINE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","1.0",",","1.0",",","1.0",",","u_outline_intensity",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","u_color_id",",","1.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]},e["color_id.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"NODES",TOKENS:["0"]},{TYPE:"var",NAME:"CAUSTICS",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"MAIN_BEND_COL",TOKENS:["0"]},{TYPE:"var",NAME:"DETAIL_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"USE_POSITION_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"AU_QUALIFIER",TOKENS:["GLSL_IN"]},{TYPE:"var",NAME:"STATIC_BATCH",TOKENS:["0"]},{TYPE:"var",NAME:"WIND_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"BEND_CENTER_ONLY",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD_JITTERED",TOKENS:["0"]},{TYPE:"var",NAME:"DYNAMIC_GRASS",TOKENS:["0"]},{TYPE:"var",NAME:"SKINNED",TOKENS:["0"]},{TYPE:"var",NAME:"FRAMES_BLENDING",TOKENS:["0"]},{TYPE:"var",NAME:"VERTEX_ANIM",TOKENS:["0"]},{TYPE:"var",NAME:"SMAA_JITTER",TOKENS:["0"]},{TYPE:"var",NAME:"VERTEX_ANIM_MIX_NORMALS_FACTOR",TOKENS:["u_va_frame_factor"]},{TYPE:"var",NAME:"MAX_BONES",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"REFRACTIVE",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"include",FILE:"scale_texcoord.glslv"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","mat3","u_model_tsr","=","mat3","(","0.0",",","0.0",",","0.0",",","1.0",",","0.0",",","0.0",",","0.0",",","1.0",",","0.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr",";","uniform","mat4","u_proj_matrix",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD","DYNAMIC_GRASS",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_eye",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_JITTER"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_quatsb","[","MAX_BONES","]",";","uniform","vec4","u_transb","[","MAX_BONES","]",";","uniform","vec4","u_arm_rel_trans",";","uniform","vec4","u_arm_rel_quat",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FRAMES_BLENDING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_quatsa","[","MAX_BONES","]",";","uniform","vec4","u_transa","[","MAX_BONES","]",";","uniform","float","u_frame_factor",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD_JITTERED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_jitter_amp",";","uniform","float","u_jitter_freq",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec3","u_wind",";","uniform","PRECISION","float","u_time",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_va_frame_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_texture_scale",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position",";","GLSL_IN","vec4","a_tbn",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_influence",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAIN_BEND_COL"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","a_bending_col_main",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DETAIL_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_bending_col_detail",";","AU_QUALIFIER","float","au_detail_bending_amp",";","AU_QUALIFIER","float","au_branch_bending_amp",";","AU_QUALIFIER","float","au_detail_bending_freq",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["AU_QUALIFIER","float","au_wind_bending_amp",";","AU_QUALIFIER","float","au_wind_bending_freq",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BEND_CENTER_ONLY"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","BILLBOARD",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position_next",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{TYPE:"logical_or_expr",PLACES:5}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_tbn_next",";"]}]}}]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","B",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","h",";","GLSL_OUT","vec4","i",";","GLSL_OUT","vec3","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","k",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","float","m",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec2","A",";"]}]}}]}]}}]},{TYPE:"include",FILE:"skin.glslv"},{TYPE:"include",FILE:"wind_bending.glslv"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"nodes.glslv"}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{","mat3","N","=","u_view_tsr",";","vec3","O","=","a_position",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA","CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:3},{TYPE:"logical_or_expr",PLACES:6},{TYPE:"logical_and_expr",PLACES:3},"USE_TBN_SHADING","CALC_TBN",{TYPE:"logical_and_expr",PLACES:2},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:7}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","P",",","Q",";","vec4","S","=","R","(","a_tbn",",","P",",","Q",")",";","vec3","U","=","T","(","S",",","vec3","(","0.0",",","1.0",",","0.0",")",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","V","=","T","(","S",",","vec3","(","1.0",",","0.0",",","0.0",")",")",";","vec3","W","=","Q","*","cross","(","U",",","V",")",";","vec4","Y","=","X","(","W",",","Q","*","P",")",";","V","=","T","(","Y",",","U",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","V","=","vec3","(","0.0",")",";","vec3","W","=","vec3","(","0.0",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","U","=","vec3","(","0.0",")",";","vec3","V","=","vec3","(","0.0",")",";","vec3","W","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["mat3","Z","=","u_model_tsr",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ac","=","normalize","(","_","(","u_model_tsr",",","U",")",")",";","vec3","ad","=","cross","(","vec3","(","0.0",",","0.0",",","1.0",")",",","ac",")",";","vec3","ae","=","cross","(","ac",",","ad",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ae","=","a_shade_tangs",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ae","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["O","=","mix","(","O",",","a_position_next",",","u_va_frame_factor",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{TYPE:"logical_or_expr",PLACES:5}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","af",",","ah",";","vec4","ai","=","R","(","a_tbn_next",",","af",",","ah",")",";","vec3","aj","=","T","(","ai",",","vec3","(","0.0",",","1.0",",","0.0",")",")",";","U","=","mix","(","U",",","aj",",","VERTEX_ANIM_MIX_NORMALS_FACTOR",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ak","=","T","(","ai",",","vec3","(","1.0",",","0.0",",","0.0",")",")",";","vec3","al","=","ah","*","cross","(","aj",",","ak",")",";","vec4","am","=","X","(","al",",","ah","*","af",")",";","ak","=","T","(","am",",","aj",")",";","V","=","mix","(","V",",","ak",",","u_va_frame_factor",")",";","W","=","mix","(","W",",","al",",","u_va_frame_factor",")",";"]}]}}]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["an","(","O",",","V",",","W",",","U",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","BILLBOARD",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ao","=","au_center_pos",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ao","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","aq","=","ap","(","Z",",","ao",")",";","Z","=","as","(","u_camera_eye",",","aq",",","N",",","Z",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","BILLBOARD_JITTERED",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["Z","=","at","(","u_wind",",","u_time",",","u_jitter_amp",",","u_jitter_freq",",","aq",",","Z",")",";"]}]}}]},{TYPE:"txt",TOKENS:["au","aw","=","av","(","O","-","ao",",","ao",",","V",",","ae",",","W",",","U",",","Z",")",";","aw",".","ao","=","aq",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["au","aw","=","av","(","O",",","ao",",","V",",","ae",",","W",",","U",",","Z",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["ax","(","aw",".","O",",","aw",".","ao",",","U",",","mat4","(","0.0",")",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ay","=","T","(","a_tbn",",","vec3","(","0.0",",","1.0",",","0.0",")",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ay","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["ax","(","aw",".","O",",","aw",".","ao",",","ay",",","mat4","(","0.0",")",")",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["A","=","az","(","a_texcoord",",","u_texture_scale",")",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["h","=","aw",".","O",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:12}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["j","=","aw",".","U",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","aA","=","(","dot","(","cross","(","aw",".","U",",","aw",".","V",")",",","aw",".","W",")","<","0.0",")","?","-","1.0",":","1.0",";","k","=","vec4","(","aw",".","V",",","aA",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["B","=","aw",".","aB",";"]}]}}]},{TYPE:"txt",TOKENS:["i","=","vec4","(","ap","(","N",",","aw",".","O",")",",","1.0",")",";","vec4","f","=","u_proj_matrix","*","i",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_JITTER"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["f",".","xy","+=","u_subpixel_jitter","*","f",".","w",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["l","=","aC","(","f",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["m","=","-","i",".","z","/","u_view_max_depth",";"]}]}}]},{TYPE:"txt",TOKENS:["J","(",")",";"]}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","u_proj_matrix","*","vec4","(","ap","(","N",",","aw",".","O",")",",","1.0",")",";","}"]}]},e["debug_view.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"DEBUG_SPHERE",TOKENS:["0"]},{TYPE:"var",NAME:"WIREFRAME_QUALITY",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"DEBUG_SPHERE_DYNAMIC",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_SPHERE",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","int","u_debug_view_mode",";","uniform","float","u_cluster_id",";","uniform","float","u_batch_debug_id_color",";","uniform","float","u_batch_debug_main_render_time",";","uniform","float","u_debug_colors_seed",";","uniform","float","u_debug_render_time_threshold",";","uniform","vec3","u_wireframe_edge_color",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","aD",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","const","float","aE","=","1.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_SPHERE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_SPHERE_DYNAMIC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","vec3","aF","=","vec3","(","1.0",",","0.05",",","0.05",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","vec3","aF","=","vec3","(","0.05",",","0.05",",","1.0",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","vec3","aG","=","vec3","(","0.4",",","0.4",",","1.0",")",";","const","vec3","aH","=","vec3","(","1.0",",","0.4",",","0.4",")",";","const","vec3","aI","=","vec3","(","1.0",",","1.0",",","1.0",")",";","const","vec3","aJ","=","vec3","(","0.0",",","133.0","/","255.0",",","66.0","/","255.0",")",";","const","vec3","aK","=","vec3","(","160.0","/","255.0",",","38.0","/","255.0",",","33.0","/","255.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_SPHERE",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","aP","(",")","{","float","aL","=","1.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIREFRAME_QUALITY",0,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","aM","=","sign","(","aD","-","vec3","(","0.02","*","aE",")",")",";","if","(","aM",".","x","<","0.0","||","aM",".","y","<","0.0","||","aM",".","z","<","0.0",")","aL","=","0.0",";"]}]}},{TYPE:"elif",EXPRESSION:["WIREFRAME_QUALITY",1,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"extension",TOKENS:["GL_OES_standard_derivatives",":","enable"]}]}}]},{TYPE:"txt",TOKENS:["vec3","aN","=","fwidth","(","aD",")",";","vec3","aO","=","smoothstep","(","vec3","(","0.0",")",",","aN","*","aE",",","aD",")",";","aL","=","min","(","min","(","aO",".","x",",","aO",".","y",")",",","aO",".","z",")",";","aL","=","clamp","(","aL",",","0.0",",","1.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["return","aL",";","}"]}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{","vec3","aQ","=","vec3","(","0.0",")",";","float","L","=","0.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_SPHERE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","aM","=","sign","(","aD","-","vec3","(","0.02","*","aE",")",")",";","if","(","aM",".","x","<","0.0","||","aM",".","y","<","0.0","||","aM",".","z","<","0.0",")","{","aQ","=","aF",";","L","=","1.0",";","}","else","discard",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","u_debug_view_mode","==","DV_OPAQUE_WIREFRAME",")","{","float","aL","=","aP","(",")",";","aQ","=","vec3","(","mix","(","u_wireframe_edge_color",",","aI",",","aL",")",")",";","L","=","1.0",";","}","else","if","(","u_debug_view_mode","==","DV_TRANSPARENT_WIREFRAME",")","{","float","aL","=","aP","(",")",";","aQ","=","u_wireframe_edge_color",";","L","=","mix","(","1.0",",","0.0",",","aL",")",";","}","else","if","(","u_debug_view_mode","==","DV_FRONT_BACK_VIEW",")","{","float","aL","=","aP","(",")",";","if","(","gl_FrontFacing",")","aQ","=","mix","(","u_wireframe_edge_color",",","aG",",","aL",")",";","else","aQ","=","mix","(","u_wireframe_edge_color",",","aH",",","aL",")",";","L","=","1.0",";","}","else","if","(","u_debug_view_mode","==","DV_CLUSTERS_VIEW",")","{","float","aR","=","u_cluster_id","+","u_debug_colors_seed","+","2.0",";","aQ","=","vec3","(","fract","(","aR","*","19.73",")",",","fract","(","aR","*","6.34",")",",","fract","(","aR","*","1.56",")",")",";","L","=","1.0",";","}","else","if","(","u_debug_view_mode","==","DV_BATCHES_VIEW",")","{","float","aR","=","u_batch_debug_id_color","+","u_debug_colors_seed",";","aQ","=","vec3","(","fract","(","aR","*","19.73",")",",","fract","(","aR","*","6.34",")",",","fract","(","aR","*","1.56",")",")",";","L","=","1.0",";","}","else","if","(","u_debug_view_mode","==","DV_RENDER_TIME",")","{","float","aS",";","if","(","u_debug_render_time_threshold",">","0.0",")","aS","=","clamp","(","u_batch_debug_main_render_time",",","0.0",",","u_debug_render_time_threshold",")","/","u_debug_render_time_threshold",";","else","aS","=","1.0",";","float","aT","=","clamp","(","2.0","*","aS",",","0.0",",","1.0",")",";","float","aU","=","clamp","(","2.0","*","aS","-","1.0",",","0.0",",","1.0",")",";","float","aV","=","aS",";","aQ","=","mix","(","aJ",",","aK",",","vec3","(","aT",",","aU",",","aV",")",")",";","L","=","1.0",";","}"]}]}}]},{TYPE:"txt",TOKENS:["aW","(","aQ",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aX","(","aQ",",","L",")",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",",","L",")",";","}"]}]},e["debug_view.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"USE_INSTANCED_PARTCLS",TOKENS:["0"]},{TYPE:"var",NAME:"DEBUG_VIEW_SPECIAL_SKYDOME",TOKENS:["0"]},{TYPE:"var",NAME:"DEBUG_SPHERE",TOKENS:["0"]},{TYPE:"var",NAME:"WIND_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"DYNAMIC_GRASS",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD",TOKENS:["0"]},{TYPE:"var",NAME:"VERTEX_ANIM",TOKENS:["0"]},{TYPE:"var",NAME:"SKINNED",TOKENS:["0"]},{TYPE:"var",NAME:"STATIC_BATCH",TOKENS:["0"]},{TYPE:"var",NAME:"AU_QUALIFIER",TOKENS:["GLSL_IN"]},{TYPE:"var",NAME:"BEND_CENTER_ONLY",TOKENS:["0"]},{TYPE:"var",NAME:"FRAMES_BLENDING",TOKENS:["0"]},{TYPE:"var",NAME:"MAIN_BEND_COL",TOKENS:["0"]},{TYPE:"var",NAME:"MAX_BONES",TOKENS:["0"]},{TYPE:"var",NAME:"DETAIL_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD_JITTERED",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position",";","GLSL_IN","vec4","a_tbn",";","GLSL_IN","float","a_polyindex",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_INSTANCED_PARTCLS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_part_ts",";","GLSL_IN","vec4","a_part_r",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_SPHERE",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAIN_BEND_COL"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","a_bending_col_main",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DETAIL_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_bending_col_detail",";","AU_QUALIFIER","float","au_detail_bending_amp",";","AU_QUALIFIER","float","au_branch_bending_amp",";","AU_QUALIFIER","float","au_detail_bending_freq",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["AU_QUALIFIER","float","au_wind_bending_amp",";","AU_QUALIFIER","float","au_wind_bending_freq",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BEND_CENTER_ONLY"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{TYPE:"logical_or_expr",PLACES:3},"USE_INSTANCED_PARTCLS",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position_next",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_influence",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","aD",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","mat3","u_model_tsr","=","mat3","(","0.0",",","0.0",",","0.0",",","1.0",",","0.0",",","0.0",",","0.0",",","1.0",",","0.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr",";","uniform","mat4","u_proj_matrix",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_SPHERE",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_wind",";","uniform","float","u_time",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD","BILLBOARD_JITTERED",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_jitter_amp",";","uniform","float","u_jitter_freq",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS","BILLBOARD",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_eye",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_va_frame_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_quatsb","[","MAX_BONES","]",";","uniform","vec4","u_transb","[","MAX_BONES","]",";","uniform","vec4","u_arm_rel_trans",";","uniform","vec4","u_arm_rel_quat",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FRAMES_BLENDING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_quatsa","[","MAX_BONES","]",";","uniform","vec4","u_transa","[","MAX_BONES","]",";","uniform","float","u_frame_factor",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","sampler2D","u_grass_map_depth",";","uniform","sampler2D","u_grass_map_color",";","uniform","vec4","u_camera_quat",";","uniform","vec3","u_grass_map_dim",";","uniform","float","u_grass_size",";","uniform","float","u_scale_threshold",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_SPHERE",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"skin.glslv"},{TYPE:"include",FILE:"wind_bending.glslv"},{TYPE:"include",FILE:"dynamic_grass.glslv"}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{","if","(","a_polyindex","==","0.0",")","aD","=","vec3","(","1.0",",","0.0",",","0.0",")",";","else","if","(","a_polyindex","==","1.0",")","aD","=","vec3","(","0.0",",","0.0",",","1.0",")",";","else","aD","=","vec3","(","0.0",",","1.0",",","0.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_VIEW_SPECIAL_SKYDOME"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["gl_Position","=","vec4","(","a_position",".","xy",",","0.9999999",",","1.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_INSTANCED_PARTCLS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","Z","=","mat3","(","a_part_ts","[","0","]",",","a_part_ts","[","1","]",",","a_part_ts","[","2","]",",","a_part_ts","[","3","]",",","a_part_r","[","0","]",",","a_part_r","[","1","]",",","a_part_r","[","2","]",",","a_part_r","[","3","]",",","1.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["Z","=","aY","(","u_model_tsr",",","Z",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","Z","=","u_model_tsr",";"]}]}}]},{TYPE:"txt",TOKENS:["mat3","N","=","u_view_tsr",";","vec3","O","=","a_position",";","vec4","S","=","R","(","a_tbn",")",";","vec3","U","=","T","(","S",",","vec3","(","0.0",",","1.0",",","0.0",")",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_SPHERE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["au","aw","=","av","(","O",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","Z",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["O","=","mix","(","O",",","a_position_next",",","u_va_frame_factor",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","V","=","vec3","(","0.0",")",";","vec3","W","=","vec3","(","0.0",")",";","an","(","O",",","V",",","W",",","U",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{TYPE:"logical_or_expr",PLACES:3},"USE_INSTANCED_PARTCLS",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ao","=","au_center_pos",";"]}]}},{TYPE:"elif",EXPRESSION:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ao","=","a_part_ts",".","xyz",";","O","=","ap","(","Z",",","O",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ao","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["au","aw","=","aZ","(","O",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","ao",",","u_grass_map_depth",",","u_grass_map_color",",","u_grass_map_dim",",","u_grass_size",",","u_camera_eye",",","u_camera_quat",",","N",",","Z",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","aq","=","ap","(","Z",",","ao",")",";","Z","=","as","(","u_camera_eye",",","aq",",","N",",","Z",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","BILLBOARD_JITTERED",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","a_","=","aq",";","Z","=","at","(","u_wind",",","u_time",",","u_jitter_amp",",","u_jitter_freq",",","a_",",","Z",")",";"]}]}}]},{TYPE:"txt",TOKENS:["au","aw","=","av","(","O","-","ao",",","ao",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","Z",")",";","aw",".","ao","=","aq",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["au","aw","=","av","(","O",",","ao",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","Z",")",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["ax","(","aw",".","O",",","aw",".","ao",",","U",",","mat4","(","0.0",")",")",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","u_proj_matrix","*","vec4","(","ap","(","N",",","aw",".","O",")",",","1.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]},e["error.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","GLSL_OUT_FRAG_COLOR","=","vec4","(","1.0",",","0.0",",","1.0",",","1.0",")",";","}"]}]},e["error.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position",";","uniform","mat3","u_view_tsr",";","uniform","mat4","u_proj_matrix",";","void","main","(",")","{","gl_Position","=","u_proj_matrix","*","bc","(","u_view_tsr",")","*","vec4","(","a_position",",","1.0",")",";","}"]}]},e["grass_map.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"DYNAMIC_GRASS_SIZE",TOKENS:["0"]},{TYPE:"var",NAME:"DYNAMIC_GRASS_COLOR",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_SIZE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","bd",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","bd",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","bd",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_SIZE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","bd",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","bd",",","vec3","(","1.0",")",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","1.0",",","bd",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","1.0",")",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["}"]}]},e["grass_map.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"DYNAMIC_GRASS_SIZE",TOKENS:["0"]},{TYPE:"var",NAME:"DYNAMIC_GRASS_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"WIND_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"STATIC_BATCH",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD_JITTERED",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_SIZE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","a_grass_size",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_grass_color",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_SIZE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","bd",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","float","bd",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","bd",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","mat3","u_model_tsr","=","mat3","(","0.0",",","0.0",",","0.0",",","1.0",",","0.0",",","0.0",",","0.0",",","1.0",",","0.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr",";","uniform","mat4","u_proj_matrix",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_eye",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","BILLBOARD_JITTERED",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_wind",";","uniform","float","u_time",";","uniform","float","u_jitter_amp",";","uniform","float","u_jitter_freq",";"]}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{","mat3","N","=","u_view_tsr",";","mat3","Z","=","u_model_tsr",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","aq","=","ap","(","Z",",","vec3","(","0.0",")",")",";","Z","=","as","(","u_camera_eye",",","aq",",","N",",","u_model_tsr",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","BILLBOARD_JITTERED",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["Z","=","at","(","u_wind",",","u_time",",","u_jitter_amp",",","u_jitter_freq",",","vec3","(","0.0",")",",","Z",")",";"]}]}}]},{TYPE:"txt",TOKENS:["au","aw","=","av","(","a_position",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","Z",")",";","aw",".","ao","=","aq",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["au","aw","=","av","(","a_position",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","Z",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec4","f","=","u_proj_matrix","*","vec4","(","ap","(","N",",","aw",".","O",")",",","1.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_SIZE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bd","=","vec4","(","a_grass_size",",","a_grass_color",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bd","=","a_grass_size",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bd","=","a_grass_color",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","f",";","}"]}]},e["halo.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"SKY_STARS",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["uniform","vec4","u_diffuse_color",";","uniform","vec3","u_halo_rings_color",";","uniform","vec3","u_halo_lines_color",";","uniform","float","u_halo_hardness",";","uniform","float","u_halo_size",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKY_STARS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_sun_intensity",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_halo_stars_blend",";","uniform","float","u_halo_stars_height",";","uniform","float","u_cam_water_depth",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKY_STARS","WATER_EFFECTS","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","be",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";","GLSL_IN","float","bf",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"include",FILE:"halo_color.glslf"},{TYPE:"txt",TOKENS:["void","main","(",")","{","vec4","bi","=","bh","(",")",";","vec3","aQ","=","bi",".","rgb",";","float","aM","=","bi",".","a",";","aW","(","aQ",")",";","aX","(","aQ",",","aM",")",";","GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",",","aM",")",";","}"]}]},e["halo.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_STARS",TOKENS:["0"]},{TYPE:"var",NAME:"STATIC_BATCH",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr",";","uniform","mat4","u_proj_matrix",";","uniform","PRECISION","float","u_halo_size",";","uniform","vec3","u_camera_eye",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","mat3","u_model_tsr","=","mat3","(","0.0",",","0.0",",","0.0",",","1.0",",","0.0",",","0.0",",","0.0",",","1.0",",","0.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position",";","GLSL_IN","vec2","a_halo_bb_vertex",";","GLSL_IN","float","a_random_vals",";","GLSL_OUT","vec2","A",";","GLSL_OUT","float","bf",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","be",";"]}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{","mat3","N","=","u_view_tsr",";","mat3","Z","=","u_model_tsr",";","vec3","O","=","ap","(","Z",",","a_position",")",";","A","=","a_halo_bb_vertex","*","2.0","-","1.0",";","bf","=","a_random_vals",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKY_STARS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","bk","=","bj","(","O",",","N",")",";","mat3","bl","=","N",";","bl","[","0","]","[","0","]","=","0.0",";","bl","[","0","]","[","1","]","=","0.0",";","bl","[","0","]","[","2","]","=","0.0",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","bk","=","bj","(","O",",","N",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec2","bm","=","(","a_halo_bb_vertex","*","2.0","-","1.0",")","*","u_halo_size",";","vec3","bn","=","vec3","(","bm","[","0","]",",","0.0",",","bm","[","1","]",")",";","vec3","bo","=","ap","(","bk",",","bn",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKY_STARS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","f","=","u_proj_matrix","*","vec4","(","ap","(","bl",",","bo",")",",","1.0",")",";","f",".","z","=","0.99999","*","f",".","w",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["be","=","vec4","(","bo",",","1.0",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","f","=","u_proj_matrix","*","vec4","(","ap","(","N",",","bo",")",",","1.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","f",";","}"]}]},e["irradiance_skybox.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_reflection",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","GLSL_IN","vec3","bp",";","void","main","(",")","{","vec3","bq","=","normalize","(","bp",")",";","vec3","bs",";","vec3","bt","=","vec3","(","0.0",")",";","vec3","bu","=","vec3","(","0.0",",","0.0",",","1.0",")",";","vec3","bv","=","vec3","(","1.0",",","0.0",",","0.0",")",";","const","float","bw","=","0.025",";","float","bx","=","0.0",";","for","(","float","by","=","0.0",";","by","<","2.0","*","M_PI",";","by","+=","bw",")","{","for","(","float","bz","=","0.0",";","bz","<","0.5","*","M_PI",";","bz","+=","bw",")","{","vec3","bA","=","vec3","(","sin","(","bz",")","*","cos","(","by",")",",","sin","(","bz",")","*","sin","(","by",")",",","cos","(","bz",")",")",";","vec3","bB","=","bA",".","x","*","bv","+","bA",".","y","*","bu","+","bA",".","z","*","bq",";","vec3","bs","=","GLSL_TEXTURE_CUBE","(","u_sky_reflection",",","bB",")",".","rgb",";","bC","(","bs",")",";","bt","+=","bs","*","cos","(","bz",")","*","sin","(","bz",")",";","bx","++",";","}","}","bt","=","M_PI","*","bt","*","(","1.0","/","float","(","bx",")",")",";","GLSL_OUT_FRAG_COLOR","=","vec4","(","bt",",","1.0",")",";","}"]}]},e["lens_flares.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_sampler",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec4","aQ","=","GLSL_TEXTURE","(","u_sampler",",","A",")",";","aW","(","aQ",".","rgb",")",";","aX","(","aQ",".","rgb",",","aQ",".","a",")",";","GLSL_OUT_FRAG_COLOR","=","aQ",";","}"]}]},e["lens_flares.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"define",NAME:"LIGHT_INDEX",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr",";","uniform","mat4","u_proj_matrix",";","uniform","vec3","u_light_directions","[","NUM_LIGHTS","]",";","GLSL_IN","float","a_lf_dist",";","GLSL_IN","vec2","a_lf_bb_vertex",";","GLSL_IN","vec2","a_texcoord",";","GLSL_OUT","vec2","A",";","void","main","(",")","{","A","=","a_texcoord",";","vec3","bD","=","normalize","(","u_light_directions","[","LIGHT_INDEX","]",")",";","vec4","f","=","u_proj_matrix","*","vec4","(","_","(","u_view_tsr",",","bD",")",",","0.0",")",";","f",".","x","/=","f",".","w",";","f",".","y","/=","f",".","w",";","f","+=","99999.0","*","step","(","f",".","z",",","0.0",")",";","f","+=","100.0","*","(","step","(","1.0",",","abs","(","f",".","x",")",")","+","step","(","1.0",",","abs","(","f",".","y",")",")",")",";","f",".","x","=","a_lf_dist","*","f",".","x",";","f",".","y","=","a_lf_dist","*","f",".","y",";","float","bE","=","u_proj_matrix","[","1","]","[","1","]","/","u_proj_matrix","[","0","]","[","0","]",";","vec2","bF","=","vec2","(","a_lf_bb_vertex",".","x","/","bE",",","a_lf_bb_vertex",".","y",")",";","if","(","a_lf_dist","<","0.999",")","{","const","float","bG","=","1.9",";","bF","*=","(","1.0","+","bG","*","length","(","f",".","xy",")",")",";","}","gl_Position","=","vec4","(","f",".","xy","+","bF",",","0.999999",",","1.0",")",";","}"]}]},e["line.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:["uniform","vec4","u_diffuse_color",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec3","aQ","=","u_diffuse_color",".","xyz",";","float","L","=","u_diffuse_color",".","a",";","aW","(","aQ",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aX","(","aQ",",","L",")",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",",","L",")",";","}"]}]},e["line.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position",";","GLSL_IN","vec3","a_direction",";","uniform","mat3","u_model_tsr",";","uniform","mat3","u_view_tsr",";","uniform","mat4","u_proj_matrix",";","uniform","float","u_height",";","uniform","float","u_line_width",";","void","main","(",")","{","mat3","N","=","u_view_tsr",";","mat3","Z","=","u_model_tsr",";","au","aw","=","av","(","a_position",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","normalize","(","a_direction",")",",","Z",")",";","vec4","bH","=","u_proj_matrix","*","vec4","(","ap","(","N",",","aw",".","O",")",",","1.0",")",";","bH",".","xyz","/=","bH",".","w",";","vec4","bI","=","u_proj_matrix","*","vec4","(","ap","(","N",",","aw",".","O","+","aw",".","U",")",",","1.0",")",";","bI",".","xyz","/=","bI",".","w",";","float","bE","=","u_proj_matrix","[","1","]","[","1","]","/","u_proj_matrix","[","0","]","[","0","]",";","vec2","bJ","=","(","bI","-","bH",")",".","xy",";","bJ",".","x","*=","bE",";","float","bK","=","M_PI","/","2.0",";","mat2","bL","=","mat2","(","cos","(","bK",")",",","sin","(","bK",")",",","-","sin","(","bK",")",",","cos","(","bK",")",")",";","bJ","=","bL","*","bJ",";","bJ","=","normalize","(","bJ",")",";","vec2","bM","=","(","u_line_width","/","u_height",")","*","vec2","(","1.0","/","bE",",","1.0",")",";","gl_Position","=","vec4","(","bH",".","xy","+","bJ",".","xy","*","bM","/","2.0",",","bH",".","z",",","1.0",")",";","gl_Position","*=","bH",".","w",";","}"]}]},e["main.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"SHADELESS",TOKENS:["0"]},{TYPE:"var",NAME:"CAUSTICS",TOKENS:["0"]},{TYPE:"var",NAME:"USE_ENVIRONMENT_LIGHT",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_TEXTURE",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"NORMAL_TEXCOORD",TOKENS:["0"]},{TYPE:"var",NAME:"USE_VIEW_TSR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_VIEW_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"USE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_NORM_CO",TOKENS:["TEXTURE_COORDS_NONE"]},{TYPE:"var",NAME:"PARALLAX",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"CAMERA_TYPE",TOKENS:["CAM_TYPE_PERSP"]},{TYPE:"var",NAME:"USE_POSITION_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"RGBA_SHADOWS",TOKENS:["0"]},{TYPE:"var",NAME:"USE_BSDF_SKY_DIM",TOKENS:["0"]},{TYPE:"var",NAME:"NODES",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"WETTABLE",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_VALUES",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_RGBS",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LAMP_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"SSAO_ONLY",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"PROCEDURAL_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"REFRACTIVE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_REFRACTION",TOKENS:["0"]},{TYPE:"var",NAME:"USE_REFRACTION_CORRECTION",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION1",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION2",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION3",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_CAST_LAMPS",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_LEVEL",TOKENS:["0.0"]},{TYPE:"var",NAME:"POISSON_DISK_NUM",TOKENS:["NO_SOFT_SHADOWS"]},{TYPE:"var",NAME:"USE_DERIVATIVES_EXT",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TEXTURE_LOD_EXT",TOKENS:["0"]},{TYPE:"var",NAME:"USE_LOD_SMOOTHING",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1","USE_DERIVATIVES_EXT",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"extension",TOKENS:["GL_OES_standard_derivatives",":","enable"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1","USE_TEXTURE_LOD_EXT",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"extension",TOKENS:["GL_EXT_shader_texture_lod",":","enable"]}]}}]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"coverage.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CAUSTICS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"caustics.glslf"}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["RGBA_SHADOWS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"pack.glslf"}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_time",";","uniform","vec2","u_texel_size",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_texture",";"]}]}},{TYPE:"elif",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_horizon_color",";","uniform","vec3","u_zenith_color",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1","USE_BSDF_SKY_DIM",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_bsdf_cube_sky_dim",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_environment_energy",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LIGHTS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_light_positions","[","NUM_LIGHTS","]",";","uniform","vec3","u_light_directions","[","NUM_LIGHTS","]",";","uniform","vec4","u_light_color_intensities","[","NUM_LIGHTS","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CAUSTICS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_sun_quaternion",";","uniform","vec3","u_sun_intensity",";","uniform","vec3","u_sun_direction",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_eye_frag",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{TYPE:"logical_or_expr",PLACES:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_direction",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_VIEW_TSR",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_VIEW_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_color_density",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_underwater_fog_color_density",";","uniform","float","u_cam_water_depth",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_cube_fog",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_lod_coverage",";","uniform","float","u_lod_cmp_logic",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_plane_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_CUBE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_cube_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_mirrormap",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_PBR_SIMPLE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_PBR_STANDARD",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_cube_irradiance",";","uniform","samplerCube","u_cube_r_convolution",";","uniform","sampler2D","u_brdf",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_shadow_mask",";"]}]}},{TYPE:"elif",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec4","u_csm_center_dists",";","uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_refractmap",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION","USE_REFRACTION","REFRACTIVE","USE_REFRACTION_CORRECTION",{TYPE:"logical_and_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_emit",";","uniform","float","u_ambient",";","uniform","vec2","u_fresnel_params",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFLECTION_TYPE","REFL_CUBE",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_mirror_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_refl_plane",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_LAMP","NUM_LAMP_LIGHTS",0,{TYPE:"non_equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_lamp_light_positions","[","NUM_LAMP_LIGHTS","]",";","uniform","vec3","u_lamp_light_directions","[","NUM_LAMP_LIGHTS","]",";","uniform","vec3","u_lamp_light_color_intensities","[","NUM_LAMP_LIGHTS","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_VALUE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_node_values","[","NUM_VALUES","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_RGB"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_node_rgbs","[","NUM_RGBS","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_OBJECT_INFO"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_obj_info",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","h",";","GLSL_IN","vec3","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"PARALLAX",{TYPE:"logical_and_expr",PLACES:2},"SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"CAUSTICS","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:6}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","i",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"CALC_TBN_SPACE",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","k",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","B",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","n",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","o",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","u",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE","USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","m",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"include",FILE:"nodes.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"fog.glslf"}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","!","C","(","u_lod_coverage",",","u_lod_cmp_logic",")",")","discard",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"PARALLAX",{TYPE:"logical_and_expr",PLACES:2},"SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"CAUSTICS","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:3},{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","bN","=","length","(","i",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","bO","=","h",".","z","-","WATER_LEVEL",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","D","=","normalize","(","u_camera_eye_frag","-","h",")",";","vec3","E",";","vec3","F",";","vec3","G",";","vec4","H",";","float","I",";","J","(","D",",","E",",","F",",","G",",","H",",","I",")",";","vec3","aQ","=","E",";","float","L","=","I",";","vec3","U","=","G",";","vec4","bP","=","H",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WETTABLE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aQ","=","max","(","aQ","-","sqrt","(","0.01","*","-","min","(","bO",",","0.0",")",")",",","0.5","*","aQ",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CAUSTICS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bQ","(","aQ",",","bO",",","u_time",",","bP",",","U",",","u_sun_direction",",","u_sun_intensity",",","u_sun_quaternion",",","h",",","bN",")",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA_CLIP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","L","<","0.5",")","discard",";","L","=","1.0",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["L","=","min","(","1.0",",","L",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["L","=","1.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bR","(","aQ",",","bN",",","D",",","bO",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bR","(","aQ",",","bN",",","D",",","1.0",")",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","bS","=","GLSL_TEXTURE_PROJ","(","u_shadow_mask",",","l",")",".","a",";","aQ","=","vec3","(","bS",")",";"]}]}}]},{TYPE:"txt",TOKENS:["aQ","=","max","(","vec3","(","0.0",")",",","aQ",")",";","aW","(","aQ",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA","ALPHA_CLIP",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aX","(","aQ",",","L",")",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",",","L",")",";","}"]}]},e["main.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"SHADELESS",TOKENS:["0"]},{TYPE:"var",NAME:"CAUSTICS",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"MAIN_BEND_COL",TOKENS:["0"]},{TYPE:"var",NAME:"DETAIL_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN",TOKENS:["0"]},{TYPE:"var",NAME:"USE_INSTANCED_PARTCLS",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_NORM_CO",TOKENS:["TEXTURE_COORDS_NONE"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"PARALLAX",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"SMAA_JITTER",TOKENS:["0"]},{TYPE:"var",NAME:"USE_POSITION_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"NODES",TOKENS:["0"]},{TYPE:"var",NAME:"AU_QUALIFIER",TOKENS:["GLSL_IN"]},{TYPE:"var",NAME:"STATIC_BATCH",TOKENS:["0"]},{TYPE:"var",NAME:"WIND_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"BEND_CENTER_ONLY",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD_JITTERED",TOKENS:["0"]},{TYPE:"var",NAME:"DYNAMIC_GRASS",TOKENS:["0"]},{TYPE:"var",NAME:"SKINNED",TOKENS:["0"]},{TYPE:"var",NAME:"FRAMES_BLENDING",TOKENS:["0"]},{TYPE:"var",NAME:"VERTEX_ANIM",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"REFLECTION_PASS",TOKENS:["REFL_PASS_NONE"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"REFRACTIVE",TOKENS:["0"]},{TYPE:"var",NAME:"MAC_OS_SHADOW_HACK",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION1",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION2",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION3",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_CAST_LAMPS",TOKENS:["0"]},{TYPE:"var",NAME:"TEXCOORD",TOKENS:["0"]},{TYPE:"var",NAME:"VERTEX_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"VERTEX_ANIM_MIX_NORMALS_FACTOR",TOKENS:["u_va_frame_factor"]},{TYPE:"var",NAME:"MAX_BONES",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"include",FILE:"scale_texcoord.glslv"},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position",";","GLSL_IN","vec4","a_tbn",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_INSTANCED_PARTCLS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_part_ts",";","GLSL_IN","vec4","a_part_r",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_influence",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{TYPE:"logical_or_expr",PLACES:3},"USE_INSTANCED_PARTCLS",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAIN_BEND_COL"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","a_bending_col_main",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DETAIL_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_bending_col_detail",";","AU_QUALIFIER","float","au_detail_bending_amp",";","AU_QUALIFIER","float","au_branch_bending_amp",";","AU_QUALIFIER","float","au_detail_bending_freq",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["AU_QUALIFIER","float","au_wind_bending_amp",";","AU_QUALIFIER","float","au_wind_bending_freq",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BEND_CENTER_ONLY"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position_next",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_TEX_COORD_RE",{TYPE:"logical_or_expr",PLACES:9}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_tbn_next",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXCOORD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_color",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","h",";","GLSL_OUT","vec3","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"PARALLAX",{TYPE:"logical_and_expr",PLACES:2},"SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"CAUSTICS","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:6}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","i",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"CALC_TBN_SPACE",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","k",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","bT",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXCOORD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec2","A",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_COLOR","DYNAMIC_GRASS",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","bU",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","n",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","o",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","u",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","v",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE","USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE","NODES",{TYPE:"logic_negative_expr",PLACES:1},"USE_NODE_B4W_REFRACTION",{TYPE:"logical_or_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","float","m",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","B",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","mat3","u_model_tsr","=","mat3","(","0.0",",","0.0",",","0.0",",","1.0",",","0.0",",","0.0",",","0.0",",","1.0",",","0.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_view_refl_matrix",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr",";","uniform","mat4","u_proj_matrix",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1},"BILLBOARD","DYNAMIC_GRASS",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_eye",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_JITTER"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","sampler2D","u_grass_map_depth",";","uniform","sampler2D","u_grass_map_color",";","uniform","vec4","u_camera_quat",";","uniform","vec3","u_grass_map_dim",";","uniform","float","u_grass_size",";","uniform","float","u_scale_threshold",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_quatsb","[","MAX_BONES","]",";","uniform","vec4","u_transb","[","MAX_BONES","]",";","uniform","vec4","u_arm_rel_trans",";","uniform","vec4","u_arm_rel_quat",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FRAMES_BLENDING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_quatsa","[","MAX_BONES","]",";","uniform","vec4","u_transa","[","MAX_BONES","]",";","uniform","float","u_frame_factor",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD_JITTERED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_jitter_amp",";","uniform","float","u_jitter_freq",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec3","u_wind",";","uniform","PRECISION","float","u_time",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_va_frame_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_texture_scale",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_normal_offset",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAC_OS_SHADOW_HACK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_v_light_tsr","[","NUM_CAST_LAMPS","]",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_v_light_ts","[","NUM_CAST_LAMPS","]",";","uniform","vec4","u_v_light_r","[","NUM_CAST_LAMPS","]",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","mat4","u_p_light_matrix0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{TYPE:"include",FILE:"dynamic_grass.glslv"},{TYPE:"include",FILE:"shadow.glslv"},{TYPE:"include",FILE:"skin.glslv"},{TYPE:"include",FILE:"wind_bending.glslv"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"nodes.glslv"}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat4","bV","=","u_view_refl_matrix",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat4","bV","=","mat4","(","0.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["mat3","N","=","u_view_tsr",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_INSTANCED_PARTCLS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","Z","=","mat3","(","a_part_ts","[","0","]",",","a_part_ts","[","1","]",",","a_part_ts","[","2","]",",","a_part_ts","[","3","]",",","a_part_r","[","0","]",",","a_part_r","[","1","]",",","a_part_r","[","2","]",",","a_part_r","[","3","]",",","1.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["Z","=","aY","(","u_model_tsr",",","Z",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","Z","=","u_model_tsr",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","O","=","a_position",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:3},"NODES",{TYPE:"logic_negative_expr",PLACES:1},"USE_TBN_SHADING","CALC_TBN",{TYPE:"logical_and_expr",PLACES:2},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:14}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","P",",","Q",";","vec4","S","=","R","(","a_tbn",",","P",",","Q",")",";","vec3","bW","=","T","(","S",",","vec3","(","0.0",",","1.0",",","0.0",")",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:3},"NODES",{TYPE:"logic_negative_expr",PLACES:1},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:13}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","U","=","bW",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","U","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE","NODES",{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","V","=","T","(","S",",","vec3","(","1.0",",","0.0",",","0.0",")",")",";","vec3","W","=","Q","*","cross","(","U",",","V",")",";","vec4","Y","=","X","(","W",",","Q","*","P",")",";","V","=","T","(","Y",",","U",")",";"]}]}},{TYPE:"elif",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","bX","=","ap","(","Z",",","O",")",";","vec3","ac","=","normalize","(","_","(","Z",",","bW",")",")",";","vec3","D","=","bX","-","u_camera_eye",";","vec3","W","=","cross","(","D",",","ac",")",";","vec3","V","=","cross","(","ac",",","W",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","V","=","vec3","(","0.0",")",";","vec3","W","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ac","=","normalize","(","_","(","Z",",","bW",")",")",";","vec3","ad","=","cross","(","vec3","(","0.0",",","0.0",",","1.0",")",",","ac",")",";","vec3","ae","=","cross","(","ac",",","ad",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ae","=","a_shade_tangs",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ae","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["O","=","mix","(","O",",","a_position_next",",","u_va_frame_factor",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"USE_NODE_BSDF_BEGIN","USE_NODE_TEX_COORD_RE","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:10}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","af",",","ah",";","vec4","ai","=","R","(","a_tbn_next",",","af",",","ah",")",";","vec3","aj","=","T","(","ai",",","vec3","(","0.0",",","1.0",",","0.0",")",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_BSDF_BEGIN","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:8}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["U","=","mix","(","U",",","aj",",","VERTEX_ANIM_MIX_NORMALS_FACTOR",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ak","=","T","(","ai",",","vec3","(","1.0",",","0.0",",","0.0",")",")",";","vec3","al","=","ah","*","cross","(","aj",",","ak",")",";","vec4","am","=","X","(","al",",","ah","*","af",")",";","ak","=","T","(","am",",","aj",")",";","V","=","mix","(","V",",","ak",",","u_va_frame_factor",")",";","W","=","mix","(","W",",","al",",","u_va_frame_factor",")",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["an","(","O",",","V",",","W",",","U",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{TYPE:"logical_or_expr",PLACES:3},"USE_INSTANCED_PARTCLS",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ao","=","au_center_pos",";"]}]}},{TYPE:"elif",EXPRESSION:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ao","=","a_part_ts",".","xyz",";","O","=","ap","(","Z",",","O",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ao","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["au","aw","=","aZ","(","O",",","V",",","ae",",","W",",","U",",","ao",",","u_grass_map_depth",",","u_grass_map_color",",","u_grass_map_dim",",","u_grass_size",",","u_camera_eye",",","u_camera_quat",",","N",",","Z",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","aq","=","ap","(","Z",",","ao",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["O","=","(","bV","*","vec4","(","O",",","1.0",")",")",".","xyz",";","ao","=","(","bV","*","vec4","(","ao",",","1.0",")",")",".","xyz",";","aq","=","(","bV","*","vec4","(","aq",",","1.0",")",")",".","xyz",";"]}]}}]},{TYPE:"txt",TOKENS:["Z","=","as","(","u_camera_eye",",","aq",",","N",",","Z",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","BILLBOARD_JITTERED",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","a_","=","aq",";","Z","=","at","(","u_wind",",","u_time",",","u_jitter_amp",",","u_jitter_freq",",","a_",",","Z",")",";"]}]}}]},{TYPE:"txt",TOKENS:["au","aw","=","av","(","O","-","ao",",","ao",",","V",",","ae",",","W",",","U",",","Z",")",";","aw",".","ao","=","aq",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["au","aw","=","av","(","O",",","ao",",","V",",","ae",",","W",",","U",",","Z",")",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"CALC_TBN_SPACE",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","aA","=","(","dot","(","cross","(","aw",".","U",",","aw",".","V",")",",","aw",".","W",")","<","0.0",")","?","-","1.0",":","1.0",";","k","=","vec4","(","aw",".","V",",","aA",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["B","=","aw",".","aB",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["ax","(","aw",".","O",",","aw",".","ao",",","U",",","bV",")",";"]}]}}]},{TYPE:"txt",TOKENS:["h","=","aw",".","O",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:13}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["j","=","aw",".","U",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bT","=","u_camera_eye","-","aw",".","O",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXCOORD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["A","=","az","(","a_texcoord",",","u_texture_scale",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bU","=","aw",".","aQ",";"]}]}},{TYPE:"elif",EXPRESSION:["VERTEX_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bU","=","a_color",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2},"BILLBOARD",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","bY","=","bV","*","vec4","(","aw",".","O",",","1.0",")",";","bY",".","xyz","=","ap","(","N",",","bY",".","xyz",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","bY","=","vec4","(","ap","(","N",",","aw",".","O",")",",","1.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"PARALLAX",{TYPE:"logical_and_expr",PLACES:2},"SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"CAUSTICS","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:6}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["i","=","bY",";"]}]}}]},{TYPE:"txt",TOKENS:["vec4","f","=","u_proj_matrix","*","bY",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_JITTER"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["f",".","xy","+=","u_subpixel_jitter","*","f",".","w",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE","USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["l","=","aC","(","f",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bZ","(","aw",".","O",",","aw",".","U",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE","NODES",{TYPE:"logic_negative_expr",PLACES:1},"USE_NODE_B4W_REFRACTION",{TYPE:"logical_or_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["m","=","-","bY",".","z","/","u_view_max_depth",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["J","(",")",";"]}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","f",";","}"]}]},e["main_stack.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"TEXTURE_NORM_CO",TOKENS:["TEXTURE_COORDS_NONE"]},{TYPE:"var",NAME:"TEXTURE_SPEC_CO",TOKENS:["TEXTURE_COORDS_NONE"]},{TYPE:"var",NAME:"CAUSTICS",TOKENS:["0"]},{TYPE:"var",NAME:"USE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_COLOR0_CO",TOKENS:["TEXTURE_COORDS_NONE"]},{TYPE:"var",NAME:"TEXTURE_COLOR1_CO",TOKENS:["TEXTURE_COORDS_NONE"]},{TYPE:"var",NAME:"PARALLAX",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_PASS",TOKENS:["REFL_PASS_PLANE"]},{TYPE:"var",NAME:"RGBA_SHADOWS",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_SPEC",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA_AS_SPEC",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_STENCIL_ALPHA_MASK",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_STENCIL_ALPHA_MASK_CO",TOKENS:["TEXTURE_COORDS_NONE"]},{TYPE:"var",NAME:"NORMAL_TEXCOORD",TOKENS:["0"]},{TYPE:"var",NAME:"USE_REFRACTION_CORRECTION",TOKENS:["0"]},{TYPE:"var",NAME:"DOUBLE_SIDED_LIGHTING",TOKENS:["0"]},{TYPE:"var",NAME:"SHADELESS",TOKENS:["0"]},{TYPE:"var",NAME:"TEXCOORD",TOKENS:["0"]},{TYPE:"var",NAME:"VERTEX_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"WETTABLE",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION1",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION2",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION3",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_CAST_LAMPS",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_LEVEL",TOKENS:["0.0"]},{TYPE:"var",NAME:"PROCEDURAL_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_BLEND_TYPE",TOKENS:["TEXTURE_BLEND_TYPE_MIX"]},{TYPE:"var",NAME:"SKY_TEXTURE",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"PARALLAX_LOD_DIST",TOKENS:["5.0"]},{TYPE:"var",NAME:"PARALLAX_STEPS",TOKENS:["5.0"]},{TYPE:"var",NAME:"USE_ENVIRONMENT_LIGHT",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"REFRACTIVE",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"DYNAMIC_GRASS",TOKENS:["0"]},{TYPE:"var",NAME:"POISSON_DISK_NUM",TOKENS:["NO_SOFT_SHADOWS"]},{TYPE:"var",NAME:"SSAO_ONLY",TOKENS:["0"]},{TYPE:"var",NAME:"USE_LOD_SMOOTHING",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"coverage.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CAUSTICS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"caustics.glslf"}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["RGBA_SHADOWS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"pack.glslf"}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_time",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_texture",";"]}]}},{TYPE:"elif",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_horizon_color",";","uniform","vec3","u_zenith_color",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_environment_energy",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LIGHTS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_light_positions","[","NUM_LIGHTS","]",";","uniform","vec3","u_light_directions","[","NUM_LIGHTS","]",";","uniform","vec4","u_light_color_intensities","[","NUM_LIGHTS","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CAUSTICS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_sun_quaternion",";","uniform","vec3","u_sun_intensity",";","uniform","vec3","u_sun_direction",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_color_density",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_underwater_fog_color_density",";","uniform","float","u_cam_water_depth",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_cube_fog",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_lod_coverage",";","uniform","float","u_lod_cmp_logic",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_colormap0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_SPEC","ALPHA_AS_SPEC",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_specmap0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_STENCIL_ALPHA_MASK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_colormap1",";","uniform","sampler2D","u_stencil0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_plane_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_CUBE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_cube_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_shadow_mask",";"]}]}},{TYPE:"elif",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec4","u_csm_center_dists",";","uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_refractmap",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE","USE_REFRACTION_CORRECTION",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_emit",";","uniform","float","u_ambient",";","uniform","vec2","u_fresnel_params",";","uniform","float","u_specular_alpha",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFLECTION_TYPE","REFL_CUBE",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_reflect_factor",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_mirror_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_refl_plane",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec4","u_diffuse_color",";","uniform","vec2","u_diffuse_params",";","uniform","float","u_diffuse_intensity",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_normal_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_diffuse_color_factor",";","uniform","float","u_alpha_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_SPEC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_specular_color_factor",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec3","u_specular_color",";","uniform","vec3","u_specular_params",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"PARALLAX",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_parallax_scale",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_refr_bump",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","h",";","GLSL_IN","vec3","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"PARALLAX",{TYPE:"logical_and_expr",PLACES:2},"SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"CAUSTICS",{TYPE:"logical_and_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:5}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","i",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"CALC_TBN_SPACE",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","k",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","bT",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","B",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXCOORD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_COLOR","DYNAMIC_GRASS",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","bU",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","n",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","o",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","u",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","m",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"shadow.glslf"}]}}]},{TYPE:"include",FILE:"mirror.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"refraction.glslf"}]}}]},{TYPE:"include",FILE:"environment.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"lighting_nodes.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"fog.glslf"}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","!","C","(","u_lod_coverage",",","u_lod_cmp_logic",")",")","discard",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"PARALLAX",{TYPE:"logical_and_expr",PLACES:2},"SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"CAUSTICS","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:3},{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","bN","=","length","(","i",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","bO","=","h",".","z","-","WATER_LEVEL",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXCOORD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","b_","=","A",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","ca","=","normalize","(","j",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DOUBLE_SIDED_LIGHTING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","gl_FrontFacing","==","false",")"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","gl_FrontFacing",")"]}]}}]},{TYPE:"txt",TOKENS:["ca","=","ca",";","else","ca","=","-","ca",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","W","=","cross","(","ca",",","k",".","xyz",")","*","k",".","w",";","mat3","cb","=","mat3","(","k",".","xyz",",","W",",","ca",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","N","=","u_view_tsr_frag",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NORMAL_TEXCOORD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","cc","=","normalize","(","_","(","N",",","j",")",")",".","st",";","cc","=","cc","*","vec2","(","0.495",")","+","vec2","(","0.5",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"PARALLAX",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","bN","<","PARALLAX_LOD_DIST",")","{","float","cd","=","clamp","(","0.5","*","(","PARALLAX_LOD_DIST","-","bN",")",",","0.0",",","1.0",")",";","float","ce","=","u_parallax_scale","*","cd",";","vec3","cf","=","normalize","(","bT","*","cb",")",";","float","cg","=","1.0","/","PARALLAX_STEPS",";","vec2","ch","=","cf",".","xy","*","ce","/","(","PARALLAX_STEPS","*","cf",".","z",")",";","float","ci","=","1.0",";","float","cj",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","ck","=","cc",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","ck","=","b_",";"]}]}}]},{TYPE:"txt",TOKENS:["cj","=","GLSL_TEXTURE","(","u_normalmap0",",","ck",")",".","a",";","for","(","float","cl","=","1.0",";","cl","<=","PARALLAX_STEPS",";","cl","++",")","{","if","(","cj","<","ci",")","{","ci","-=","cg",";","ck","-=","ch",";","cj","=","GLSL_TEXTURE","(","u_normalmap0",",","ck",")",".","a",";","}","}","vec2","cm","=","ck","+","ch",";","float","cn","=","GLSL_TEXTURE","(","u_normalmap0",",","cm",")",".","a","-","(","ci","+","cg",")",";","float","co","=","cj","-","ci",";","float","cp","=","co","/","(","co","-","cn",")",";","ck","=","cp","*","cm","+","(","1.0","-","cp",")","*","ck",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXCOORD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["b_","+=","ck","-","cc",";"]}]}}]},{TYPE:"txt",TOKENS:["cc","=","ck",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NORMAL_TEXCOORD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cc","+=","ck","-","b_",";"]}]}}]},{TYPE:"txt",TOKENS:["b_","=","ck",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","cq",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cq","=","GLSL_TEXTURE","(","u_normalmap0",",","cc",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cq","=","GLSL_TEXTURE","(","u_normalmap0",",","b_",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","cr","=","cq",".","rgb","-","0.5",";","cr","=","mix","(","vec3","(","0.0",",","0.0",",","1.0",")",",","cr",",","u_normal_factor",")",";","vec3","U","=","cb","*","cr",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","U","=","ca",";"]}]}}]},{TYPE:"txt",TOKENS:["U","=","normalize","(","U",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NORMAL_TEXCOORD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cc","=","normalize","(","_","(","N",",","U",")",")",".","st",";","cc","=","cc","*","vec2","(","0.495",")","+","vec2","(","0.5",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","D","=","normalize","(","bT",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_COLOR","DYNAMIC_GRASS",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","cs","=","bU",";","bC","(","cs",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_COLOR","DYNAMIC_GRASS",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","ct","=","vec4","(","cs",",","1.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","ct","=","u_diffuse_color",";"]}]}}]},{TYPE:"txt",TOKENS:["float","cu","=","1.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NORMAL",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","cv","=","GLSL_TEXTURE","(","u_colormap0",",","cc",")",";"]}]}},{TYPE:"elif",EXPRESSION:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_UV_ORCO",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","cv","=","GLSL_TEXTURE","(","u_colormap0",",","b_",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bC","(","cv",".","rgb",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_STENCIL_ALPHA_MASK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","cw",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR1_CO","TEXTURE_COORDS_NORMAL",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cw","=","GLSL_TEXTURE","(","u_colormap1",",","cc",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cw","=","GLSL_TEXTURE","(","u_colormap1",",","b_",")",";"]}]}}]},{TYPE:"txt",TOKENS:["bC","(","cw",".","rgb",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_STENCIL_ALPHA_MASK_CO","TEXTURE_COORDS_NORMAL",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","cx","=","GLSL_TEXTURE","(","u_stencil0",",","cc",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","cx","=","GLSL_TEXTURE","(","u_stencil0",",","b_",")",";"]}]}}]},{TYPE:"txt",TOKENS:["cv","=","mix","(","cv",",","cw",",","cx",".","r",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["ct",".","rgb","=","mix","(","ct",".","rgb",",","cv",".","rgb",",","u_diffuse_color_factor",")",";","float","M","=","u_alpha_factor","*","cv",".","a",";","M","+=","(","1.0","-","step","(","0.0",",","M",")",")",";","ct",".","a","=","mix","(","M",",","1.0",",","u_diffuse_color",".","a",")",";","cu","=","cv",".","a",";"]}]}},{TYPE:"elif",EXPRESSION:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["ct",".","rgb","*=","mix","(","vec3","(","1.0",")",",","cv",".","rgb",",","u_diffuse_color_factor",")",";","ct",".","a","=","cv",".","a",";","cu","=","cv",".","a",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","aQ","=","ct",".","rgb",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","cy","=","u_diffuse_intensity","*","ct",".","rgb",";","vec3","cA","=","u_environment_energy","*","cz","(","U",")",";","vec3","cB","=","u_ambient","*","cA",";","vec4","bP","=","cC","(","cy",")",";","vec3","cD","=","u_emit","*","ct",".","rgb",";","vec3","cE","=","u_specular_color",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_SPEC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA_AS_SPEC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","cF","=","vec3","(","cu",")",";"]}]}},{TYPE:"elif",EXPRESSION:["TEXTURE_SPEC_CO","TEXTURE_COORDS_NORMAL",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","cF","=","GLSL_TEXTURE","(","u_specmap0",",","cc",")",".","rgb",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","cF","=","GLSL_TEXTURE","(","u_specmap0",",","b_",")",".","rgb",";"]}]}}]},{TYPE:"txt",TOKENS:["bC","(","cF",".","rgb",")",";","cE","=","mix","(","cE",",","cF",",","u_specular_color_factor",")",";"]}]}}]},{TYPE:"txt",TOKENS:["float","cG","=","u_specular_params","[","0","]",";","vec2","cH","=","vec2","(","u_specular_params","[","1","]",",","u_specular_params","[","2","]",")",";","vec3","cI","=","cG","*","cE",";","vec3","aQ",";","vec3","cJ",";","cK","(","cD",",","cB",",","cy",",","cI",",","h",",","U",",","D",",","cH",",","u_diffuse_params",",","bP",",","0.0",",","vec4","(","0.0",")",",","aQ",",","cJ",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cL","(","aQ",",","D",",","U",",","u_reflect_factor",",","N",")",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_CUBE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cL","(","aQ",",","D",",","U",",","u_reflect_factor",",","mat3","(","0.0",")",")",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cL","(","aQ",",","D",",","U",",","u_mirror_factor",",","mat3","(","0.0",")",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aQ","+=","cJ",";"]}]}}]},{TYPE:"txt",TOKENS:["float","L","=","ct",".","a",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WETTABLE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aQ","=","max","(","aQ","-","sqrt","(","0.01","*","-","min","(","bO",",","0.0",")",")",",","0.5","*","aQ",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CAUSTICS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bQ","(","aQ",",","bO",",","u_time",",","bP",",","U",",","u_sun_direction",",","u_sun_intensity",",","u_sun_quaternion",",","h",",","bN",")",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA_CLIP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","L","<","0.5",")","discard",";","L","=","1.0",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","t","=","max","(","max","(","cJ",".","r",",","cJ",".","g",")",",","cJ",".","b",")","*","u_specular_alpha",";","L","=","ct",".","a","*","(","1.0","-","t",")","+","t",";"]}]}}]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["L","=","1.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","cM","=","-","(","_","(","N",",","U",")",")",".","xy",";","aQ","=","mix","(","cN","(","l",",","cM","*","u_refr_bump",")",",","aQ",",","L",")",";","L","=","1.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bR","(","aQ",",","bN",",","D",",","bO",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bR","(","aQ",",","bN",",","D",",","1.0",")",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","bS","=","GLSL_TEXTURE_PROJ","(","u_shadow_mask",",","l",")",".","a",";","aQ","=","vec3","(","bS",")",";"]}]}}]},{TYPE:"txt",TOKENS:["aW","(","aQ",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA","ALPHA_CLIP",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aX","(","aQ",",","L",")",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",",","L",")",";","}"]}]},e["node_skybox.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"USE_VIEW_TSR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_VIEW_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_VALUES",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_RGBS",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_VALUE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_node_values","[","NUM_VALUES","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_RGB"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_node_rgbs","[","NUM_RGBS","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_VIEW_TSR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_VIEW_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","bp",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"include",FILE:"nodes.glslf"},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_TEXTURE_ENVIRONMENT_EQUIRECTANGULAR","USE_NODE_TEXTURE_ENVIRONMENT_MIRROR_BALL","USE_NODE_GEOMETRY_NO","USE_NODE_GEOMETRY_GL","USE_NODE_GEOMETRY_IN","USE_NODE_TEX_COORD_GE","USE_NODE_TEX_COORD_OB","USE_NODE_TEX_COORD_NO","USE_NODE_B4W_REFLECT_WORLD",{TYPE:"logical_or_expr",PLACES:9}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","D","=","-","normalize","(","bp",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","D",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","E",";","vec3","F",";","vec3","G",";","vec4","H",";","float","I",";","J","(","D",",","E",",","F",",","G",",","H",",","I",")",";","E","=","max","(","vec3","(","0.0",")",",","E",")",";","aW","(","E",")",";","GLSL_OUT_FRAG_COLOR","=","vec4","(","E",",","_1_0",")",";","}"]}]},e["particle_system.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"NUM_VALUES",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_RGBS",TOKENS:["0"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"NUM_LAMP_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"PROCEDURAL_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_TEXTURE",TOKENS:["0"]},{TYPE:"var",NAME:"NORMAL_TEXCOORD",TOKENS:["0"]},{TYPE:"var",NAME:"USE_VIEW_TSR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_VIEW_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"SOFT_STRENGTH",TOKENS:["0.25"]},{TYPE:"var",NAME:"SOFT_PARTICLES",TOKENS:["0"]},{TYPE:"var",NAME:"NODES",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"USE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"USE_ENVIRONMENT_LIGHT",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"TEXTURE_NORM_CO",TOKENS:["TEXTURE_COORDS_NONE"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"CAMERA_TYPE",TOKENS:["CAM_TYPE_PERSP"]},{TYPE:"var",NAME:"USE_POSITION_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"USE_DERIVATIVES_EXT",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TEXTURE_LOD_EXT",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1","USE_DERIVATIVES_EXT",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"extension",TOKENS:["GL_OES_standard_derivatives",":","enable"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1","USE_TEXTURE_LOD_EXT",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"extension",TOKENS:["GL_EXT_shader_texture_lod",":","enable"]}]}}]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","NODES",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"pack.glslf"}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_environment_energy",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LIGHTS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_light_positions","[","NUM_LIGHTS","]",";","uniform","vec3","u_light_directions","[","NUM_LIGHTS","]",";","uniform","vec4","u_light_color_intensities","[","NUM_LIGHTS","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_color_density",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_underwater_fog_color_density",";","uniform","float","u_cam_water_depth",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_cube_fog",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_texture",";"]}]}},{TYPE:"elif",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_horizon_color",";","uniform","vec3","u_zenith_color",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_emit",";","uniform","float","u_ambient",";","uniform","float","u_time",";","uniform","vec3","u_camera_eye_frag",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{TYPE:"logical_or_expr",PLACES:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_direction",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_LAMP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_lamp_light_positions","[","NUM_LAMP_LIGHTS","]",";","uniform","vec3","u_lamp_light_directions","[","NUM_LAMP_LIGHTS","]",";","uniform","vec3","u_lamp_light_color_intensities","[","NUM_LAMP_LIGHTS","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_VALUE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_node_values","[","NUM_VALUES","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_RGB"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_node_rgbs","[","NUM_RGBS","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_VIEW_TSR",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_VIEW_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","sampler2D","u_scene_depth",";","uniform","float","u_view_max_depth",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_OBJECT_INFO"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_obj_info",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","k",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{TYPE:"logical_or_expr",PLACES:7}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","h",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"NODES",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","i",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","j",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"fog.glslf"}]}}]},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"particles_nodes.glslf"},{TYPE:"txt",TOKENS:["void","main","(",")","{","vec3","D","=","normalize","(","u_camera_eye_frag","-","h",")",";","vec3","E",";","vec3","F",";","vec3","G",";","vec4","H",";","float","I",";","J","(","D",",","E",",","F",",","G",",","H",",","I",")",";","vec3","aQ","=","E",";","float","L","=","I",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA_CLIP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","L","<","0.5",")","discard",";","L","=","1.0",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["L","=","min","(","1.0",",","L",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["L","=","1.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bR","(","aQ",",","length","(","i",")",",","D",",","1.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","cO","=","-","i",".","z","/","u_view_max_depth",";","vec4","cP","=","GLSL_TEXTURE_PROJ","(","u_scene_depth",",","l",")",";","float","cR","=","cQ","(","cP",")",";","float","cS","=","cR","-","cO",";","float","cT","=","u_view_max_depth","/","SOFT_STRENGTH","*","cS",";","L","=","L","*","min","(","cT",",","1.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["aW","(","aQ",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA","ALPHA_CLIP",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aX","(","aQ",",","L",")",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",",","L",")",";","}"]}]},e["particle_system.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"BILLBOARD_ALIGN",TOKENS:["BILLBOARD_ALIGN_VIEW"]},{TYPE:"var",NAME:"TEXTURE_NORM_CO",TOKENS:["TEXTURE_COORDS_NONE"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"NODES",TOKENS:["0"]},{TYPE:"var",NAME:"HALO_PARTICLES",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"PARTICLES_SHADELESS",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"SOFT_PARTICLES",TOKENS:["0"]},{TYPE:"var",NAME:"COLOR_RAMP_LENGTH",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_PASS",TOKENS:["REFL_PASS_NONE"]},{TYPE:"var",NAME:"WORLD_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_COLOR_RAMP",TOKENS:["0"]},{TYPE:"var",NAME:"USE_POSITION_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"CAUSTICS",TOKENS:["0"]},{TYPE:"var",NAME:"WIND_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"MAIN_BEND_COL",TOKENS:["0"]},{TYPE:"var",NAME:"DETAIL_BEND",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position",";","GLSL_IN","vec4","a_tbn",";","GLSL_IN","vec3","a_p_data",";","GLSL_IN","vec4","a_p_vels",";","GLSL_IN","vec2","a_p_bb_vertex",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","float","cU",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","bU",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","k",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR","HALO_PARTICLES","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{TYPE:"logical_or_expr",PLACES:8}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec2","A",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","h",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PARTICLES_SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","bT",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"NODES",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","i",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","float","bf",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COLOR_RAMP_LENGTH",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_p_color_ramp","[","COLOR_RAMP_LENGTH","]",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_p_time",";","uniform","float","u_p_length",";","uniform","int","u_p_cyclic",";","uniform","float","u_p_fade_in",";","uniform","float","u_p_fade_out",";","uniform","float","u_p_nfactor",";","uniform","float","u_p_gravity",";","uniform","float","u_p_mass",";","uniform","float","u_p_wind_fac",";","uniform","float","u_p_max_lifetime",";","uniform","float","u_p_tilt",";","uniform","float","u_p_tilt_rand",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_view_refl_matrix",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr",";","uniform","mat4","u_proj_matrix",";","uniform","vec3","u_wind",";","uniform","float","u_p_size",";","uniform","vec3","u_camera_eye",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WORLD_SPACE",{TYPE:"logic_negative_expr",PLACES:1},"NODES","HALO_PARTICLES",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_COLOR_RAMP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_color_ramp_tex",";"]}]}}]},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"include",FILE:"particles.glslv"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"particles_nodes.glslv"}]}}]},{TYPE:"txt",TOKENS:["float","cX","(","vec2","cV",",","vec2","cW",")","{","return","(","atan","(","cW",".","y",",","cW",".","x",")","-","atan","(","cV",".","y",",","cV",".","x",")",")",";","}","void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat4","bV","=","u_view_refl_matrix",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat4","bV","=","mat4","(","0.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["mat3","N","=","u_view_tsr",";","cY","pp",";","pp","=","cZ","(",")",";","float","c_",";","mat3","bk","=","da","(",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","db","=","(","bV","*","vec4","(","pp",".","O",",","1.0",")",")",".","xyz",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","db","=","pp",".","O",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","U","=","vec3","(","0.0",",","-","1.0",",","0.0",")",";","if","(","BILLBOARD_ALIGN","==","BILLBOARD_ALIGN_VIEW",")","{","c_","=","pp",".","bK",";","bk","=","bj","(","db",",","N",")",";","}","else","if","(","BILLBOARD_ALIGN","==","BILLBOARD_ALIGN_XY",")","{","c_","=","cX","(","vec2","(","EPSILON",",","1.0",")",",","vec2","(","U",".","x",",","-","U",".","y",")",")","+","pp",".","bK",";","bk","[","0","]","=","db",";","vec4","dc","=","X","(","RIGHT_VECTOR",",","-","M_PI","/","2.0",")",";","bk","=","dd","(","dc",",","bk",")",";","}","else","if","(","BILLBOARD_ALIGN","==","BILLBOARD_ALIGN_YZ",")","{","c_","=","pp",".","bK",";","bk","[","0","]","=","db",";","vec4","de","=","X","(","UP_VECTOR",",","M_PI","/","2.0",")",";","bk","=","dd","(","de",",","bk",")",";","}","else","if","(","BILLBOARD_ALIGN","==","BILLBOARD_ALIGN_ZX",")","{","c_","=","pp",".","bK",";","bk","[","0","]","=","db",";","}","vec3","bn","=","vec3","(","(","a_p_bb_vertex","[","0","]","*","2.0","-","1.0",")","*","pp",".","df","*","u_p_size",",","0.0",",","(","a_p_bb_vertex","[","1","]","*","2.0","-","1.0",")","*","pp",".","df","*","u_p_size",")",";","float","dg","=","a_p_data","[","2","]",";","float","dh","=","u_p_tilt","*","u_p_tilt_rand","*","(","2.0","*","dg","-","1.0",")",";","float","di","=","(","dh","+","u_p_tilt",")","*","M_PI",";","vec4","dj","=","X","(","TOWARD_VECTOR",",","di","+","c_",")",";","vec3","bo","=","ap","(","bk",",","T","(","dj",",","bn",")",")",";","vec4","bY","=","vec4","(","ap","(","N",",","bo",")",",","1.0",")",";","vec4","f","=","u_proj_matrix","*","bY",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bf","=","dg",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","PARTICLES_SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","dk","=","da","(",")",";","dj","=","X","(","TOWARD_VECTOR",",","c_",")",";","dk","=","dd","(","dj",",","dk",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE","NODES",{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2},"USE_TBN_SHADING",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","V","=","vec3","(","1.0",",","0.0",",","0.0",")",";","vec3","W","=","vec3","(","0.0",",","0.0",",","1.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","V","=","vec3","(","0.0",")",";","vec3","W","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["au","aw","=","av","(","vec3","(","0.0",")",",","vec3","(","0.0",")",",","V",",","vec3","(","0.0",")",",","W",",","U",",","aY","(","bk",",","dk",")",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","aA","=","(","dot","(","cross","(","aw",".","U",",","aw",".","V",")",",","aw",".","W",")","<","0.0",")","?","-","1.0",":","1.0",";","k","=","vec4","(","aw",".","V",",","aA",")",";"]}]}}]},{TYPE:"txt",TOKENS:["J","(","pp",".","O",",","pp",".","dl",",","pp",".","dm",",","pp",".","dn",",","pp",".","df",",","a_p_bb_vertex",",","a_p_data","[","0","]",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PARTICLES_SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["au","aw","=","av","(","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","U",",","aY","(","bk",",","dk",")",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["A","=","a_p_bb_vertex",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["A","=","a_p_bb_vertex","*","2.0","-","1.0",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cU","=","pp",".","L",";"]}]}}]},{TYPE:"txt",TOKENS:["bU","=","pp",".","aQ",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1},"PARTICLES_SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT",{TYPE:"logical_or_expr",PLACES:11}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["j","=","aw",".","U",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["l","=","aC","(","f",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"NODES",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["i","=","bY",";"]}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","f",";","h","=","bo",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PARTICLES_SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bT","=","u_camera_eye","-","bo",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]},e["particle_system_stack.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_TEXTURE",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"PROCEDURAL_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_BLEND_TYPE",TOKENS:["TEXTURE_BLEND_TYPE_MIX"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"SOFT_STRENGTH",TOKENS:["0.25"]},{TYPE:"var",NAME:"SOFT_PARTICLES",TOKENS:["0"]},{TYPE:"var",NAME:"NODES",TOKENS:["0"]},{TYPE:"var",NAME:"HALO_PARTICLES",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_ENVIRONMENT_LIGHT",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_STARS",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"USE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"PARTICLES_SHADELESS",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","NODES",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"pack.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_sampler",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_environment_energy",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LIGHTS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_light_positions","[","NUM_LIGHTS","]",";","uniform","vec3","u_light_directions","[","NUM_LIGHTS","]",";","uniform","vec4","u_light_color_intensities","[","NUM_LIGHTS","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_diffuse_color_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_texture",";"]}]}},{TYPE:"elif",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_horizon_color",";","uniform","vec3","u_zenith_color",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec2","u_diffuse_params",";","uniform","float","u_diffuse_intensity",";","uniform","float","u_emit",";","uniform","float","u_ambient",";","uniform","vec3","u_specular_color",";","uniform","vec3","u_specular_params",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_halo_size",";","uniform","vec3","u_halo_rings_color",";","uniform","float","u_halo_hardness",";","uniform","vec3","u_halo_lines_color",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKY_STARS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_sun_intensity",";","uniform","float","u_halo_stars_blend",";","uniform","float","u_halo_stars_height",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_p_alpha_start",";","uniform","float","u_p_alpha_end",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_color_density",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_underwater_fog_color_density",";","uniform","float","u_cam_water_depth",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_cube_fog",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec4","u_diffuse_color",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","sampler2D","u_scene_depth",";","uniform","float","u_view_max_depth",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR","HALO_PARTICLES","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{TYPE:"logical_or_expr",PLACES:8}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","h",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","cU",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","bU",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PARTICLES_SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","bT",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"NODES",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","i",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","bf",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKY_STARS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","be",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","B",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","j",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"include",FILE:"lighting_nodes.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"fog.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"environment.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"halo_color.glslf"}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PARTICLES_SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","D","=","normalize","(","bT",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","bi","=","bh","(",")",";","vec3","aQ","=","bi",".","rgb","*","bU",";","float","dp","=","0.9","*","length","(","A",")",";","float","dq","=","smoothstep","(","u_p_alpha_start",",","u_p_alpha_end",",","dp",")",";","float","L","=","bi",".","a","*","(","1.0","-","dq",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","ct","=","u_diffuse_color",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","cv","=","GLSL_TEXTURE","(","u_sampler",",","A",")",";","bC","(","cv",".","rgb",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["ct",".","rgb","=","mix","(","ct",".","rgb",",","cv",".","rgb",",","u_diffuse_color_factor",")",";"]}]}},{TYPE:"elif",EXPRESSION:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["ct",".","rgb","*=","mix","(","vec3","(","1.0",")",",","cv",".","rgb",",","u_diffuse_color_factor",")",";"]}]}}]},{TYPE:"txt",TOKENS:["ct",".","a","=","cv",".","a",";"]}]}}]},{TYPE:"txt",TOKENS:["ct",".","rgb","*=","bU",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PARTICLES_SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","cy","=","u_diffuse_intensity","*","ct",".","rgb",";","vec3","cD","=","u_emit","*","ct",".","rgb",";","vec3","U","=","normalize","(","j",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{TYPE:"logic_negative_expr",PLACES:1},"SKY_COLOR",{TYPE:"logical_and_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","cA","=","u_environment_energy","*","cz","(","vec3","(","0.0",")",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","cA","=","u_environment_energy","*","cz","(","U",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","cB","=","u_ambient","*","cA",";","float","cG","=","u_specular_params","[","0","]",";","vec2","cH","=","vec2","(","u_specular_params","[","1","]",",","u_specular_params","[","2","]",")",";","vec3","cI","=","cG","*","u_specular_color",";","vec3","aQ",";","vec3","cJ",";","cK","(","cD",",","cB",",","cy",",","cI",",","h",",","U",",","D",",","cH",",","u_diffuse_params",",","vec4","(","1.0",")",",","0.0",",","vec4","(","0.0",")",",","aQ",",","cJ",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","aQ","=","ct",".","rgb",";"]}]}}]},{TYPE:"txt",TOKENS:["float","L","=","ct",".","a","*","cU",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA_CLIP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","L","<","0.5",")","discard",";","L","=","1.0",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["L","=","1.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bR","(","aQ",",","length","(","i",")",",","D",",","1.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","cO","=","-","i",".","z","/","u_view_max_depth",";","vec4","cP","=","GLSL_TEXTURE_PROJ","(","u_scene_depth",",","l",")",";","float","cR","=","cQ","(","cP",")",";","float","cS","=","cR","-","cO",";","float","cT","=","u_view_max_depth","/","SOFT_STRENGTH","*","cS",";","L","=","L","*","min","(","cT",",","1.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["aW","(","aQ",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA","ALPHA_CLIP",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aX","(","aQ",",","L",")",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",",","L",")",";","}"]}]},e["proc_skybox.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:["uniform","vec3","u_sky_color",";","uniform","vec3","u_sun_direction",";","uniform","float","u_rayleigh_brightness",";","uniform","float","u_mie_brightness",";","uniform","float","u_spot_brightness",";","uniform","float","u_scatter_strength",";","uniform","float","u_rayleigh_strength",";","uniform","float","u_mie_strength",";","uniform","float","u_rayleigh_collection_power",";","uniform","float","u_mie_collection_power",";","uniform","float","u_mie_distribution",";","GLSL_IN","vec3","bp",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","const","float","dr","=","0.99",";","const","float","ds","=","1.8",";","const","int","dt","=","8",";","float","dy","(","vec3","O",",","vec3","bD",")","{","float","a","=","dot","(","bD",",","bD",")",";","float","b","=","2.0","*","dot","(","bD",",","O",")",";","float","du","=","dot","(","O",",","O",")","-","1.0",";","float","dv","=","b","*","b","-","4.0","*","a","*","du",";","float","dw","=","sqrt","(","dv",")",";","float","q","=","(","-","b","-","dw",")","/","2.0",";","float","dx","=","du","/","q",";","return","dx",";","}","float","dA","(","float","L",",","float","g",")","{","float","a","=","3.0","*","(","1.0","-","g","*","g",")",";","float","b","=","2.0","*","(","2.0","+","g","*","g",")",";","float","du","=","1.0","+","L","*","L",";","float","dz","=","pow","(","1.0","+","g","*","g","-","2.0","*","g","*","L",",","1.5",")",";","dz","=","max","(","dz",",","0.00001",")",";","return","(","a","/","b",")","*","(","du","/","dz",")",";","}","float","dF","(","vec3","O",",","vec3","bD",",","float","dB",")","{","float","dC","=","dot","(","bD",",","-","O",")",";","if","(","dC","<","0.0",")","{","return","1.0",";","}","vec3","dD","=","O","+","dC","*","bD",";","if","(","length","(","dD",")","<","dB",")","{","return","0.0",";","}","else","if","(","length","(","dD",")",">=","dB",")","{","vec3","cW","=","normalize","(","dD",")","*","dB","-","O",";","float","dE","=","acos","(","dot","(","normalize","(","cW",")",",","bD",")",")",";","return","smoothstep","(","0.0",",","1.0",",","pow","(","dE","*","2.0",",","3.0",")",")",";","}","else","return","1.0",";","}","vec3","dG","(","float","aM",",","vec3","aQ",",","float","aL",")","{","return","aQ","-","aQ","*","pow","(","u_sky_color",",","vec3","(","aL","/","aM",")",")",";","}","void","main","(",")","{","vec3","bq","=","normalize","(","bp",")",";","vec3","dH","=","u_sun_direction",";","float","L","=","dot","(","bq",",","dH",")",";","float","dI","=","dA","(","L",",","-","0.01",")","*","u_rayleigh_brightness","*","dH",".","z",";","float","dJ","=","dA","(","L","-","0.5",",","u_mie_distribution",")","*","u_mie_brightness","*","(","1.0","-","dH",".","z",")",";","float","dK","=","smoothstep","(","0.0",",","100.0",",","dA","(","L",",","0.9995",")",")","*","u_spot_brightness",";","vec3","dL","=","vec3","(","0.0",",","0.0",",","dr",")",";","float","dM","=","dy","(","dL",",","bq",")",";","float","dN","=","dM","/","float","(","dt",")",";","float","dO","=","dF","(","dL",",","bq",",","dr","-","0.3",")",";","vec3","dP","=","vec3","(","0.0",",","0.0",",","0.0",")",";","vec3","dQ","=","vec3","(","0.0",",","0.0",",","0.0",")",";","for","(","int","cl","=","0",";","cl","<","dt",";","cl","++",")","{","float","dR","=","dN","*","float","(","cl",")",";","vec3","O","=","dL","+","bq","*","dR",";","float","dS","=","dF","(","O",",","dH",",","dr","-","0.2",")",";","float","dT","=","dy","(","O",",","dH",")",";","vec3","dU","=","dG","(","dT",",","vec3","(","ds",")",",","u_scatter_strength",")","*","dS",";","dP","+=","dG","(","sqrt","(","dR",")",",","u_sky_color","*","dU",",","u_rayleigh_strength",")",";","dQ","+=","dG","(","dR",",","dU",",","u_mie_strength",")",";","}","dP","=","dP","*","dO","*","pow","(","dM",",","u_rayleigh_collection_power",")","/","float","(","dt",")",";","dQ","=","(","dQ","*","dO","*","pow","(","dM",",","u_mie_collection_power",")",")","/","float","(","dt",")",";","vec3","aQ","=","vec3","(","dK","*","dQ","+","dJ","*","dQ","+","dI","*","dP",")",";","aW","(","aQ",")",";","GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",",","1.0",")",";","}"]}]},e["r_convolution_skybox.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_reflection",";","uniform","float","u_roughness",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","GLSL_IN","vec3","bp",";","float","dZ","(","int","cr",",","int","dV",")","{","float","dW","=","1.0","/","float","(","dV",")",";","float","dX","=","1.0",";","float","dY","=","0.0",";","for","(","int","cl","=","0",";","cl","<","32",";","++","cl",")","{","if","(","cr",">","0",")","{","dX","=","mod","(","float","(","cr",")",",","2.0",")",";","dY","+=","dX","*","dW",";","dW","=","dW","/","2.0",";","cr","=","int","(","float","(","cr",")","/","2.0",")",";","}","}","return","dY",";","}","vec2","ea","(","int","cl",",","int","d_",")","{","return","vec2","(","float","(","cl",")","/","float","(","d_",")",",","dZ","(","cl",",","2",")",")",";","}","vec3","eh","(","vec2","eb",",","vec3","d_",",","float","ec",")","{","float","a","=","ec","*","ec",";","float","by","=","2.0","*","M_PI","*","eb",".","x",";","float","ed","=","sqrt","(","(","1.0","-","eb",".","y",")","/","(","1.0","+","(","a","*","a","-","1.0",")","*","eb",".","y",")",")",";","float","ee","=","sqrt","(","1.0","-","ed","*","ed",")",";","vec3","ef",";","ef",".","x","=","cos","(","by",")","*","ee",";","ef",".","y","=","sin","(","by",")","*","ee",";","ef",".","z","=","ed",";","vec3","bu","=","abs","(","d_",".","z",")","<","0.999","?","vec3","(","0.0",",","0.0",",","1.0",")",":","vec3","(","1.0",",","0.0",",","0.0",")",";","vec3","V","=","normalize","(","cross","(","bu",",","d_",")",")",";","vec3","eg","=","cross","(","d_",",","V",")",";","vec3","bB","=","V","*","ef",".","x","+","eg","*","ef",".","y","+","d_","*","ef",".","z",";","return","normalize","(","bB",")",";","}","void","main","(",")","{","vec3","ei","=","vec3","(","0.0",")",";","if","(","u_roughness","!=","0.0",")","{","vec3","d_","=","normalize","(","bp",")",";","vec3","ej","=","d_",";","vec3","ek","=","ej",";","const","int","el","=","1024",";","float","em","=","0.0",";","for","(","int","cl","=","0",";","cl","<","el",";","++","cl",")","{","vec2","eb","=","ea","(","cl",",","el",")",";","vec3","ef","=","eh","(","eb",",","d_",",","u_roughness",")",";","vec3","en","=","normalize","(","2.0","*","dot","(","ek",",","ef",")","*","ef","-","ek",")",";","float","eo","=","max","(","dot","(","d_",",","en",")",",","0.0",")",";","if","(","eo",">","0.0",")","{","vec3","bs","=","GLSL_TEXTURE_CUBE","(","u_sky_reflection",",","en",")",".","rgb",";","bC","(","bs",")",";","ei","+=","bs","*","eo",";","em","+=","eo",";","}","}","ei","=","ei","/","em",";","}","else","{","vec3","bs","=","GLSL_TEXTURE_CUBE","(","u_sky_reflection",",","normalize","(","bp",")",")",".","rgb",";","bC","(","bs",")",";","ei","=","bs",";","}","GLSL_OUT_FRAG_COLOR","=","vec4","(","ei",",","1.0",")",";","}"]}]},e["shadow.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"NODES",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"SHADELESS",TOKENS:["0"]},{TYPE:"var",NAME:"RGBA_SHADOWS",TOKENS:["0"]},{TYPE:"var",NAME:"USE_VIEW_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_VIEW_TSR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_ENVIRONMENT_LIGHT",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_TEXTURE",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_REFRACTION",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"CAMERA_TYPE",TOKENS:["CAM_TYPE_PERSP"]},{TYPE:"var",NAME:"USE_POSITION_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"USE_REFRACTION_CORRECTION",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION1",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION2",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION3",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LAMP_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_BLEND_TYPE",TOKENS:["TEXTURE_BLEND_TYPE_MIX"]},{TYPE:"var",NAME:"NUM_VALUES",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_RGBS",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_CAST_LAMPS",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"POISSON_DISK_NUM",TOKENS:["NO_SOFT_SHADOWS"]},{TYPE:"var",NAME:"USE_DERIVATIVES_EXT",TOKENS:["0"]},{TYPE:"var",NAME:"CAMERA_TYPE",TOKENS:["CAM_TYPE_PERSP"]},{TYPE:"var",NAME:"USE_LOD_SMOOTHING",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1","USE_DERIVATIVES_EXT",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"extension",TOKENS:["GL_OES_standard_derivatives",":","enable"]}]}}]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"math.glslv"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["RGBA_SHADOWS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"depth_fetch.glslf"},{TYPE:"include",FILE:"pack.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"coverage.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_time",";","uniform","float","u_environment_energy",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LIGHTS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_light_positions","[","NUM_LIGHTS","]",";","uniform","vec3","u_light_directions","[","NUM_LIGHTS","]",";","uniform","vec4","u_light_color_intensities","[","NUM_LIGHTS","]",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_eye_frag",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{TYPE:"logical_or_expr",PLACES:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_direction",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_VIEW_TSR",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_VIEW_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_texture",";"]}]}},{TYPE:"elif",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_horizon_color",";","uniform","vec3","u_zenith_color",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_plane_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_CUBE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_cube_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_emit",";","uniform","float","u_ambient",";","uniform","vec2","u_fresnel_params",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_mirror_factor",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_refl_plane",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_LAMP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_lamp_light_positions","[","NUM_LAMP_LIGHTS","]",";","uniform","vec3","u_lamp_light_directions","[","NUM_LAMP_LIGHTS","]",";","uniform","vec3","u_lamp_light_color_intensities","[","NUM_LAMP_LIGHTS","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_VALUE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_node_values","[","NUM_VALUES","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_RGB"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_node_rgbs","[","NUM_RGBS","]",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_colormap0",";","uniform","float","u_alpha_factor",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec4","u_diffuse_color",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec4","u_csm_center_dists",";","uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_shadow_mask",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_refractmap",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_OBJECT_INFO"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_obj_info",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["RGBA_SHADOWS","SHADOW_USAGE","SHADOW_CASTING",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec2","u_camera_range",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_lod_coverage",";","uniform","float","u_lod_cmp_logic",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","h",";","GLSL_IN","vec3","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","k",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2},"SHADOW_USAGE","SHADOW_CASTING",{TYPE:"equal_expr",PLACES:2},"RGBA_SHADOWS",{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","i",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","n",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","o",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","u",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","m",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","B",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"shadow.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"nodes.glslf"}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","!","C","(","u_lod_coverage",",","u_lod_cmp_logic",")",")","discard",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","D","=","normalize","(","u_camera_eye_frag","-","h",")",";","vec3","E",";","vec3","F",";","vec3","G",";","vec4","H",";","float","I",";","J","(","D",",","E",",","F",",","G",",","H",",","I",")",";","float","L","=","I",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","L","=","(","GLSL_TEXTURE","(","u_colormap0",",","A",")",")",".","a",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","M","=","u_alpha_factor","*","L",";","M","+=","(","1.0","-","step","(","0.0",",","M",")",")",";","L","=","mix","(","M",",","1.0",",","u_diffuse_color",".","a",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","L","=","u_diffuse_color",".","a",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["if","(","L","<","0.5",")","discard",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","NO_SHADOWS",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_CASTING",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["RGBA_SHADOWS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","eq","=","ep","(","-","i",".","z",",","u_camera_range",")",";","GLSL_OUT_FRAG_COLOR","=","er","(","eq",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","1.0",")",";"]}]}}]}]}},{TYPE:"elif",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","es","(","i",".","z",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR",".","a","*=","clamp","(","k",".","r",",","0.999999999",",","1.0",")",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["}"]}]},e["shadow.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"CAUSTICS",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"MAIN_BEND_COL",TOKENS:["0"]},{TYPE:"var",NAME:"DETAIL_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN",TOKENS:["0"]},{TYPE:"var",NAME:"USE_INSTANCED_PARTCLS",TOKENS:["0"]},{TYPE:"var",NAME:"NODES",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"SMAA_JITTER",TOKENS:["0"]},{TYPE:"var",NAME:"MAC_OS_SHADOW_HACK",TOKENS:["0"]},{TYPE:"var",NAME:"USE_POSITION_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"RGBA_SHADOWS",TOKENS:["0"]},{TYPE:"var",NAME:"REFRACTIVE",TOKENS:["0"]},{TYPE:"var",NAME:"AU_QUALIFIER",TOKENS:["GLSL_IN"]},{TYPE:"var",NAME:"BEND_CENTER_ONLY",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION1",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION2",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION3",TOKENS:["0"]},{TYPE:"var",NAME:"HAIR_BILLBOARD",TOKENS:["0"]},{TYPE:"var",NAME:"FRAMES_BLENDING",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_TEX_RES",TOKENS:["2048.0"]},{TYPE:"var",NAME:"VERTEX_ANIM",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_CAST_LAMPS",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"VERTEX_ANIM_MIX_NORMALS_FACTOR",TOKENS:["u_va_frame_factor"]},{TYPE:"var",NAME:"MAX_BONES",TOKENS:["0"]},{TYPE:"var",NAME:"WIND_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"SKINNED",TOKENS:["0"]},{TYPE:"var",NAME:"DYNAMIC_GRASS",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD",TOKENS:["0"]},{TYPE:"var",NAME:"STATIC_BATCH",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD_JITTERED",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"include",FILE:"scale_texcoord.glslv"},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position",";","GLSL_IN","vec4","a_tbn",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_INSTANCED_PARTCLS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_part_ts",";","GLSL_IN","vec4","a_part_r",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_influence",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{TYPE:"logical_or_expr",PLACES:3},"USE_INSTANCED_PARTCLS",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAIN_BEND_COL"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","a_bending_col_main",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DETAIL_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_bending_col_detail",";","AU_QUALIFIER","float","au_detail_bending_amp",";","AU_QUALIFIER","float","au_branch_bending_amp",";","AU_QUALIFIER","float","au_detail_bending_freq",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["AU_QUALIFIER","float","au_wind_bending_amp",";","AU_QUALIFIER","float","au_wind_bending_freq",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BEND_CENTER_ONLY"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position_next",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{TYPE:"logical_or_expr",PLACES:5}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_tbn_next",";"]}]}}]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_COLOR",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","h",";","GLSL_OUT","vec3","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","k",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec2","A",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2},"SHADOW_USAGE","SHADOW_CASTING",{TYPE:"equal_expr",PLACES:2},"RGBA_SHADOWS",{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","i",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","n",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","o",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","u",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","v",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","float","m",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","B",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","mat3","u_model_tsr","=","mat3","(","0.0",",","0.0",",","0.0",",","1.0",",","0.0",",","0.0",",","0.0",",","1.0",",","0.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_JITTER"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr",";","uniform","mat4","u_proj_matrix",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS","BILLBOARD",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_eye",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD","SHADOW_USAGE","SHADOW_CASTING",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_shadow_cast_billboard_view_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","sampler2D","u_grass_map_depth",";","uniform","sampler2D","u_grass_map_color",";","uniform","vec4","u_camera_quat",";","uniform","vec3","u_grass_map_dim",";","uniform","float","u_grass_size",";","uniform","float","u_scale_threshold",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_quatsb","[","MAX_BONES","]",";","uniform","vec4","u_transb","[","MAX_BONES","]",";","uniform","vec4","u_arm_rel_trans",";","uniform","vec4","u_arm_rel_quat",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FRAMES_BLENDING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_quatsa","[","MAX_BONES","]",";","uniform","vec4","u_transa","[","MAX_BONES","]",";","uniform","float","u_frame_factor",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD_JITTERED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_jitter_amp",";","uniform","float","u_jitter_freq",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec3","u_wind",";","uniform","PRECISION","float","u_time",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_va_frame_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_COLOR",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_texture_scale",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_normal_offset",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAC_OS_SHADOW_HACK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_v_light_tsr","[","NUM_CAST_LAMPS","]",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_v_light_ts","[","NUM_CAST_LAMPS","]",";","uniform","vec4","u_v_light_r","[","NUM_CAST_LAMPS","]",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","mat4","u_p_light_matrix0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{TYPE:"include",FILE:"dynamic_grass.glslv"},{TYPE:"include",FILE:"shadow.glslv"},{TYPE:"include",FILE:"skin.glslv"},{TYPE:"include",FILE:"wind_bending.glslv"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"nodes.glslv"}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{","mat3","N","=","u_view_tsr",";","vec3","O","=","a_position",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:3},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:13}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","P",",","Q",";","vec4","S","=","R","(","a_tbn",",","P",",","Q",")",";","vec3","bW","=","T","(","S",",","vec3","(","0.0",",","1.0",",","0.0",")",")",";","vec3","U","=","bW",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","U","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA","CALC_TBN_SPACE",{TYPE:"logical_and_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","V","=","T","(","S",",","vec3","(","1.0",",","0.0",",","0.0",")",")",";","vec3","W","=","Q","*","cross","(","U",",","V",")",";","vec4","Y","=","X","(","W",",","Q","*","P",")",";","V","=","T","(","Y",",","U",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","V","=","vec3","(","0.0",")",";","vec3","W","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["O","=","mix","(","O",",","a_position_next",",","u_va_frame_factor",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{TYPE:"logical_or_expr",PLACES:5}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","af",",","ah",";","vec4","ai","=","R","(","a_tbn_next",",","af",",","ah",")",";","vec3","aj","=","T","(","ai",",","vec3","(","0.0",",","1.0",",","0.0",")",")",";","U","=","mix","(","U",",","aj",",","VERTEX_ANIM_MIX_NORMALS_FACTOR",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ak","=","T","(","ai",",","vec3","(","1.0",",","0.0",",","0.0",")",")",";","vec3","al","=","ah","*","cross","(","aj",",","ak",")",";","vec4","am","=","X","(","al",",","ah","*","af",")",";","ak","=","T","(","am",",","aj",")",";","V","=","mix","(","V",",","ak",",","u_va_frame_factor",")",";","W","=","mix","(","W",",","al",",","u_va_frame_factor",")",";"]}]}}]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["an","(","O",",","V",",","W",",","U",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_INSTANCED_PARTCLS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","Z","=","mat3","(","a_part_ts","[","0","]",",","a_part_ts","[","1","]",",","a_part_ts","[","2","]",",","a_part_ts","[","3","]",",","a_part_r","[","0","]",",","a_part_r","[","1","]",",","a_part_r","[","2","]",",","a_part_r","[","3","]",",","1.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["Z","=","aY","(","u_model_tsr",",","Z",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","Z","=","u_model_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{TYPE:"logical_or_expr",PLACES:3},"USE_INSTANCED_PARTCLS",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ao","=","au_center_pos",";"]}]}},{TYPE:"elif",EXPRESSION:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ao","=","a_part_ts",".","xyz",";","O","=","ap","(","Z",",","O",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ao","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ac","=","normalize","(","_","(","Z",",","bW",")",")",";","vec3","ad","=","cross","(","vec3","(","0.0",",","0.0",",","1.0",")",",","ac",")",";","vec3","ae","=","cross","(","ac",",","ad",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ae","=","a_shade_tangs",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ae","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["au","aw","=","aZ","(","O",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","U",",","ao",",","u_grass_map_depth",",","u_grass_map_color",",","u_grass_map_dim",",","u_grass_size",",","u_camera_eye",",","u_camera_quat",",","N",",","Z",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","aq","=","ap","(","Z",",","ao",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HAIR_BILLBOARD",{TYPE:"logic_negative_expr",PLACES:1},"SHADOW_USAGE","SHADOW_CASTING",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","et","=","u_shadow_cast_billboard_view_tsr",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","et","=","N",";"]}]}}]},{TYPE:"txt",TOKENS:["Z","=","as","(","u_camera_eye",",","aq",",","et",",","Z",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","BILLBOARD_JITTERED",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["Z","=","at","(","u_wind",",","u_time",",","u_jitter_amp",",","u_jitter_freq",",","aq",",","Z",")",";"]}]}}]},{TYPE:"txt",TOKENS:["au","aw","=","av","(","O","-","ao",",","ao",",","V",",","ae",",","W",",","U",",","Z",")",";","aw",".","ao","=","aq",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["au","aw","=","av","(","O",",","ao",",","V",",","ae",",","W",",","U",",","Z",")",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ay","=","bW",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ay","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["ax","(","aw",".","O",",","aw",".","ao",",","ay",",","mat4","(","0.0",")",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["h","=","aw",".","O",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:12}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["j","=","aw",".","U",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","aA","=","(","dot","(","cross","(","aw",".","U",",","aw",".","V",")",",","aw",".","W",")","<","0.0",")","?","-","1.0",":","1.0",";","k","=","vec4","(","aw",".","V",",","aA",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["B","=","aw",".","aB",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["vec4","bY","=","vec4","(","ap","(","N",",","aw",".","O",")",",","1.0",")",";","vec4","f","=","u_proj_matrix","*","bY",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_JITTER"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["f",".","xy","+=","u_subpixel_jitter","*","f",".","w",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["l","=","aC","(","f",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["m","=","-","bY",".","z","/","u_view_max_depth",";"]}]}}]},{TYPE:"txt",TOKENS:["J","(",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["A","=","az","(","a_texcoord",",","u_texture_scale",")",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bZ","(","aw",".","O",",","aw",".","U",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2},"SHADOW_USAGE","SHADOW_CASTING",{TYPE:"equal_expr",PLACES:2},"RGBA_SHADOWS",{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["i","=","bY",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_CASTING",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","eu","=","(","u_proj_matrix","*","vec4","(","N","[","0","]",",","1.0",")",")",".","xy",";","float","ev","=","SHADOW_TEX_RES","/","2.0",";","eu","=","floor","(","eu","*","ev","+","0.5",")","/","ev","-","eu",";","f",".","xy","+=","eu",";"]}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","f",";","}"]}]},e["sky.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"WO_SKYTEX",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYREAL",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYBLEND",TOKENS:["0"]},{TYPE:"var",NAME:"PROCEDURAL_SKYDOME",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYPAPER",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_PASS",TOKENS:["REFL_PASS_NONE"]},{TYPE:"var",NAME:"WATER_LEVEL",TOKENS:["0.0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"REFLECTION_PASS","REFL_PASS_NONE",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_eye_frag",";","uniform","vec4","u_underwater_fog_color_density",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYBLEND","WO_SKYPAPER",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_sky_tex_fac",";","uniform","vec3","u_sky_tex_color",";","uniform","float","u_sky_tex_dvar",";","uniform","vec3","u_horizon_color",";","uniform","vec3","u_zenith_color",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYBLEND","WO_SKYPAPER","WO_SKYTEX",{TYPE:"logical_and_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"sky_blending.glslf"}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","bp",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_SKYDOME",{TYPE:"logic_negative_expr",PLACES:1},"WO_SKYTEX","WO_SKYBLEND",{TYPE:"logical_or_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec3","bs",";","vec3","bq","=","normalize","(","bp",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYBLEND","WO_SKYPAPER",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","ew","=","0.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYREAL"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["ew","=","abs","(","A",".","y",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["ew","=","(","A",".","y","+","1.0",")","*","0.5",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","ex","=","u_horizon_color",";","vec3","ey","=","u_zenith_color",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYTEX"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ez","=","vec3","(","A",",","0.0",")",";","vec4","eA","=","GLSL_TEXTURE_CUBE","(","u_sky",",","bq",")",";","bC","(","eA",".","rgb",")",";","bs","=","eB","(","ex",",","ey",",","eA",",","ew",",","ez",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bs","=","mix","(","ex",",","ey",",","ew",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bs","=","GLSL_TEXTURE_CUBE","(","u_sky",",","bq",")",".","rgb",";","bC","(","bs",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"REFLECTION_PASS","REFL_PASS_NONE",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","eC","=","WATER_LEVEL","-","u_camera_eye_frag",".","z",";","vec3","eD","=","vec3","(","0.0",")",";","vec3","eE","=","mix","(","u_underwater_fog_color_density",".","rgb",",","eD",",","min","(","-","bq",".","z",",","1.0",")",")",";","eE","*=","min","(","1.0","-","min","(","0.03","*","eC",",","0.8",")",",","1.0",")",";","float","aL","=","clamp","(","sign","(","0.01","*","eC","-","bq",".","z",")",",","0.0",",","1.0",")",";","bs","=","mix","(","bs",",","eE",",","aL",")",";"]}]}}]},{TYPE:"txt",TOKENS:["aW","(","bs",")",";","GLSL_OUT_FRAG_COLOR","=","vec4","(","bs",",","1.0",")",";","}"]}]},e["sky.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PROCEDURAL_SKYDOME",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYTEX",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYBLEND",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["uniform","mat4","u_sky_vp_inverse",";","GLSL_IN","vec3","a_position",";","GLSL_OUT","vec3","bp",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_SKYDOME",{TYPE:"logic_negative_expr",PLACES:1},"WO_SKYTEX","WO_SKYBLEND",{TYPE:"logical_or_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec2","A",";"]}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{","vec4","O","=","vec4","(","a_position",".","xy",",","0.9999999",",","1.0",")",";","vec4","bq","=","u_sky_vp_inverse","*","O",";","bp","=","bq",".","xyz",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_SKYDOME",{TYPE:"logic_negative_expr",PLACES:1},"WO_SKYTEX","WO_SKYBLEND",{TYPE:"logical_or_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["A","=","a_position",".","xy",";"]}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","O",";","}"]}]},e["skybox.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PROCEDURAL_SKYDOME",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYTEX",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYBLEND",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["uniform","mat4","u_cube_view_matrix",";","GLSL_IN","vec3","a_position",";","GLSL_OUT","vec3","bp",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_SKYDOME",{TYPE:"logic_negative_expr",PLACES:1},"WO_SKYTEX","WO_SKYBLEND",{TYPE:"logical_or_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec2","A",";"]}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{","vec4","O","=","vec4","(","a_position",".","xy",",","0.999999",",","1.0",")",";","vec4","bq","=","u_cube_view_matrix","*","O",";","bp","=","bq",".","xyz",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_SKYDOME",{TYPE:"logic_negative_expr",PLACES:1},"WO_SKYTEX","WO_SKYBLEND",{TYPE:"logical_or_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["A","=","a_position",".","xy",";"]}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","O",";","}"]}]},e["tex_skybox.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"WO_SKYTEX",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYREAL",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYBLEND",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYPAPER",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","GLSL_IN","vec3","bp",";","GLSL_IN","vec2","A",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYTEX"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_texture",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec4","u_sky_tex_fac",";","uniform","vec3","u_sky_tex_color",";","uniform","float","u_sky_tex_dvar",";","uniform","vec3","u_horizon_color",";","uniform","vec3","u_zenith_color",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYTEX"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"sky_blending.glslf"}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{","vec3","bq","=","normalize","(","bp",")",";","vec3","bs",";","float","ew","=","0.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYPAPER"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYTEX"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bs","=","GLSL_TEXTURE_CUBE","(","u_sky_texture",",","bq",")",".","xyz",";","bC","(","bs",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bs","=","vec3","(","1.0",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYBLEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","L","=","acos","(","bq",".","z",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYREAL"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["ew","=","abs","(","L","*","INV_PI","-","0.5",")","*","2.0",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["ew","=","1.0","-","L","*","INV_PI",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["vec3","ex","=","u_horizon_color",";","vec3","ey","=","u_zenith_color",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYTEX"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","eA","=","GLSL_TEXTURE_CUBE","(","u_sky_texture",",","bq",")",";","bC","(","eA",".","rgb",")",";","vec3","ez","=","vec3","(","bp",".","xy",",","0.0",")",";","bs","=","eB","(","ex",",","ey",",","eA",",","ew",",","ez",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYBLEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bs","=","mix","(","ex",",","ey",",","ew",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bs","=","ex",";"]}]}}]}]}}]}]}}]},{TYPE:"txt",TOKENS:["aW","(","bs",")",";","GLSL_OUT_FRAG_COLOR","=","vec4","(","bs",",","1.0",")",";","}"]}]},e["water.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"USE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"DEBUG_WIREFRAME",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_NORMALMAPS",TOKENS:["0"]},{TYPE:"var",NAME:"FOAM",TOKENS:["0"]},{TYPE:"var",NAME:"SHORE_PARAMS",TOKENS:["0"]},{TYPE:"var",NAME:"GENERATED_MESH",TOKENS:["0"]},{TYPE:"var",NAME:"ABSORB",TOKENS:["6.0"]},{TYPE:"var",NAME:"SSS_STRENGTH",TOKENS:["1.0"]},{TYPE:"var",NAME:"SSS_WIDTH",TOKENS:["0.45"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"WAVES_HEIGHT",TOKENS:["1.0"]},{TYPE:"var",NAME:"WATER_LEVEL",TOKENS:["0.0"]},{TYPE:"var",NAME:"PROCEDURAL_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_TEXTURE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_REFRACTION_CORRECTION",TOKENS:["0"]},{TYPE:"var",NAME:"SHORE_SMOOTHING",TOKENS:["0"]},{TYPE:"var",NAME:"DYNAMIC",TOKENS:["0"]},{TYPE:"var",NAME:"USE_ENVIRONMENT_LIGHT",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"REFRACTIVE",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"pack.glslf"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"define",NAME:"REFL_BUMP",TOKENS:["0.002"]},{TYPE:"txt",TOKENS:["uniform","float","u_time",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_texture",";"]}]}},{TYPE:"elif",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_horizon_color",";","uniform","vec3","u_zenith_color",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_environment_energy",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LIGHTS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_light_positions","[","NUM_LIGHTS","]",";","uniform","vec3","u_light_directions","[","NUM_LIGHTS","]",";","uniform","vec4","u_light_color_intensities","[","NUM_LIGHTS","]",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec3","u_sun_intensity",";","uniform","vec3","u_sun_direction",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"SHORE_SMOOTHING","WATER_EFFECTS","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_cam_water_depth",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_color_density",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_underwater_fog_color_density",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_cube_fog",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_refractmap",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_plane_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FOAM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_foam",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec4","u_diffuse_color",";","uniform","vec2","u_diffuse_params",";","uniform","float","u_diffuse_intensity",";","uniform","float","u_ambient",";","uniform","vec2","u_fresnel_params",";","uniform","vec3","u_specular_color",";","uniform","vec3","u_specular_params",";","uniform","vec3","u_shallow_water_col",";","uniform","vec3","u_shore_water_col",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_water_norm_uv_velocity",";","uniform","vec2","u_normalmap0_scale",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",1,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec2","u_normalmap1_scale",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",2,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec2","u_normalmap2_scale",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",3,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec2","u_normalmap3_scale",";"]}]}}]}]}}]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_mirror_factor",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_reflect_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_view_max_depth",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_water_shallow_col_fac",";","uniform","float","u_water_shore_col_fac",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FOAM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_foam_factor",";","uniform","vec2","u_foam_uv_freq",";","uniform","vec2","u_foam_mag",";","uniform","vec2","u_foam_scale",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_refr_bump",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_WIREFRAME"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","float","aE","=","1.0",";","uniform","vec3","u_wireframe_edge_color",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","bT",";","GLSL_IN","vec3","h",";","GLSL_IN","vec3","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2},"FOAM",{TYPE:"logical_or_expr",PLACES:2},"GENERATED_MESH",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","k",";","GLSL_IN","vec3","eF",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2},"FOAM",{TYPE:"logical_or_expr",PLACES:2},"GENERATED_MESH","DYNAMIC",{TYPE:"logical_and_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","eG",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","eH",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","m",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_WIREFRAME"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","aD",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","B",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"include",FILE:"environment.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE","SHORE_SMOOTHING","USE_REFRACTION_CORRECTION",{TYPE:"logical_and_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"refraction.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"fog.glslf"}]}}]},{TYPE:"txt",TOKENS:["vec3","eP","(","in","vec2","eI",",","in","vec3","U",",","in","vec3","eJ",",","in","vec3","eK",",","out","float","eL",",","in","float","eM",")","{","eL","=","0.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","eN","=","eI",".","xy","+","U",".","xy","*","REFL_BUMP","/","m",";","eL","=","u_reflect_factor",";","vec3","eO",";","if","(","u_cam_water_depth","<","0.0",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eO","=","u_underwater_fog_color_density",".","rgb",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eO","=","u_diffuse_color",".","rgb",";"]}]}}]},{TYPE:"txt",TOKENS:["}","else","{","eO","=","GLSL_TEXTURE","(","u_plane_reflection",",","eN",")",".","rgb",";","bC","(","eO",")",";","}"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eL","=","u_mirror_factor",";","vec3","eO","=","eK","*","GLSL_TEXTURE_CUBE","(","u_mirrormap",",","eJ",")",".","rgb",";","bC","(","eO",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eL","=","u_reflect_factor",";","vec3","eO","=","eK","*","vec3","(","0.3",",","0.5",",","1.0",")",";","bC","(","eO",")",";"]}]}}]},{TYPE:"txt",TOKENS:["eL","=","min","(","eL","*","eM",",","1.0",")",";","return","eO",";","}"]},{TYPE:"include",FILE:"lighting_nodes.glslf"},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","cb","=","mat3","(","k",",","eF",",","j",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","U","=","normalize","(","j",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC","FOAM",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","bO","=","h",".","z","-","WATER_LEVEL",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","bO","=","h",".","z",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2},"FOAM",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GENERATED_MESH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","b_","=","vec2","(","eG",".","x",",","-","eG",".","y",")","+","0.5",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","b_","=","vec2","(","h",".","x",",","-","h",".","y",")","+","0.5",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","b_","=","A",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","eQ","=","vec3","(","0.0",")",";","eQ","+=","GLSL_TEXTURE","(","u_normalmap0",",","b_","*","u_normalmap0_scale","+","vec2","(","0.3",",","0.5",")","*","u_water_norm_uv_velocity","*","u_time",")",".","xyz","-","0.5",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",1,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eQ","+=","GLSL_TEXTURE","(","u_normalmap0",",","b_","*","u_normalmap1_scale","+","vec2","(","-","0.3",",","0.7",")","*","u_water_norm_uv_velocity","*","u_time",")",".","xyz","-","0.5",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",2,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eQ","+=","GLSL_TEXTURE","(","u_normalmap0",",","b_","*","u_normalmap2_scale","+","vec2","(","0.0",",","1.1",")","*","u_water_norm_uv_velocity","*","u_time",")",".","xyz","-","0.5",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",3,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eQ","+=","GLSL_TEXTURE","(","u_normalmap0",",","b_","*","u_normalmap3_scale","+","vec2","(","-","0.66",",","-","0.3",")","*","u_water_norm_uv_velocity","*","u_time",")",".","xyz","-","0.5",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["U","=","mix","(","U",",","normalize","(","cb","*","eQ",")",",","0.3",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["U","=","mix","(","U",",","normalize","(","cb","*","eQ",")",",","0.5",")",";"]}]}}]},{TYPE:"txt",TOKENS:["U","=","normalize","(","U",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","D","=","normalize","(","bT",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","eI","=","l",".","xy","/","l",".","z",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","eI","=","vec2","(","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","eR","=","eI","+","U",".","xy","*","u_refr_bump","/","m",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","L","=","u_diffuse_color",".","a",";","vec4","cP","=","GLSL_TEXTURE_PROJ","(","u_scene_depth",",","l",")",";","float","cR","=","cQ","(","cP",")",";","float","cS","=","max","(","cR","-","m",",","0.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","eT","=","eS","(","cR",",","eR",",","eI",")",";","float","eU","=","max","(","eT","-","m",",","0.0",")",";","float","eV","=","u_view_max_depth","/","ABSORB","*","eU",";","float","eW","=","min","(","L","*","eV",",","1.0",")",";","L","=","min","(","15.0","*","L","*","u_view_max_depth","*","cS",",","1.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","cT","=","u_view_max_depth","/","ABSORB","*","cS",";","if","(","u_cam_water_depth",">","0.0",")","L","=","min","(","L","*","cT",",","1.0",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","L","=","u_diffuse_color",".","a",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","eW","=","L",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","u_cam_water_depth","<","0.0",")","eW","=","0.0",";","vec3","eX","=","GLSL_TEXTURE","(","u_refractmap",",","eR",")",".","rgb",";","bC","(","eX",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","eY","=","pow","(","min","(","eH",".","b","/","u_water_shallow_col_fac",",","1.0",")",",","0.3",")",";","vec3","ct","=","mix","(","u_shallow_water_col",",","u_diffuse_color",".","rgb",",","eY",")",";","eY","=","pow","(","min","(","eH",".","b","/","u_water_shore_col_fac",",","1.0",")",",","0.3",")",";","ct","=","mix","(","u_shore_water_col",",","ct",",","eY",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ct","=","u_diffuse_color",".","rgb",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FOAM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","eZ","=","max","(","1.0","-","u_view_max_depth","*","cS",",","0.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","eZ","=","1.0","-","L",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","e_","=","max","(","bO","/","WAVES_HEIGHT","+","0.1",",","0.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","fa","=","normalize","(","vec3","(","eH",".","rg",",","0.0",")",")",";","vec3","fb","=","normalize","(","mix","(","UP_VECTOR",",","fa",",","0.8",")",")",";","float","fc","=","1.25","*","max","(","dot","(","U",",","fb",")","-","0.2",",","0.0",")",";","fc","+=","max","(","dot","(","U",",","-","UP_VECTOR",")",",","0.0",")",";","eZ","+=","fc","*","(","1.0","-","eH",".","b",")",";","e_","*=","(","1.0","-","0.95","*","pow","(","eH",".","b",",","0.1",")",")",";"]}]}}]},{TYPE:"txt",TOKENS:["eZ","+=","e_",";","eZ","=","min","(","u_foam_factor","*","eZ",",","1.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec4","fd","=","GLSL_TEXTURE","(","u_foam",",","u_foam_mag","*","sin","(","u_foam_uv_freq","*","u_time",")","+","b_","*","u_foam_scale",")",";"]}]}}]},{TYPE:"txt",TOKENS:["float","cG","=","u_specular_params","[","0","]",";","vec2","cH","=","vec2","(","u_specular_params","[","1","]",",","u_specular_params","[","2","]",")",";","vec3","cI","=","cG","*","u_specular_color",";","vec3","cA","=","u_environment_energy","*","cz","(","U",")",";","vec3","cB","=","u_ambient","*","cA",";","vec3","eK","=","cB","+","u_sun_intensity",";","float","eL",";","vec3","eJ","=","reflect","(","-","D",",","U",")",";","vec3","fe","=","normalize","(","eJ","+","D",")",";","float","ff","=","1.0","-","dot","(","D",",","fe",")",";","float","d_","=","u_fresnel_params","[","0","]",";","float","fg","=","u_fresnel_params","[","1","]",";","float","fh","=","fg","+","(","1.0","-","fg",")","*","pow","(","ff",",","d_",")",";","vec3","eO","=","eP","(","eI",",","U",",","eJ",",","eK",",","eL",",","fh",")",";","vec3","cy","=","u_diffuse_intensity","*","ct",";","vec3","aQ",";","vec3","cJ",";","cK","(","vec3","(","0.0",")",",","vec3","(","0.0",")",",","cy",",","cI",",","h",",","U",",","D",",","cH",",","u_diffuse_params",",","vec4","(","1.0",")",",","0.0",",","vec4","(","0.0",")",",","aQ",",","cJ",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","fi","=","max","(","dot","(","u_sun_direction",",","-","j",")","+","SSS_WIDTH",",","0.0",")","*","max","(","dot","(","-","D",",","u_sun_direction",")","-","0.5",",","0.0",")","*","max","(","0.0",",","length","(","u_sun_intensity",")","-","0.1",")",";","fi","=","clamp","(","SSS_STRENGTH","*","fi",",","0.0",",","1.0",")",";","aQ","=","mix","(","aQ",",","u_shallow_water_col",",","fi",")",";","aQ","=","mix","(","aQ",",","u_shore_water_col",",","fi",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aQ","=","mix","(","eX",",","aQ",",","eW",")",";"]}]}}]},{TYPE:"txt",TOKENS:["aQ","=","mix","(","aQ",",","eO",",","eL",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FOAM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","fj","=","mix","(","fd",".","g",",","fd",".","r",",","max","(","4.0","*","(","eZ","-","0.75",")",",","0.0",")",")",";","fj","=","mix","(","fd",".","b",",","fj",",","max","(","2.0","*","eZ","-","1.0",",","0.0",")",")",";","fj","=","mix","(","0.0",",","fj",",","eZ",")",";","aQ","=","mix","(","aQ",",","eK",",","fj",")",";"]}]}}]},{TYPE:"txt",TOKENS:["aQ","+=","cJ",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","fk","=","m","*","u_view_max_depth",";","float","fl","=","1.0",";","if","(","u_cam_water_depth",">","1.0",")","fl","=","2.0",";","bR","(","aQ",",","fk",",","D",",","fl",")",";"]}]}}]},{TYPE:"txt",TOKENS:["aW","(","aQ",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["L","=","max","(","L",",","cJ",".","r",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FOAM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["L","+=","fj",";"]}]}}]}]}},{TYPE:"elif",EXPRESSION:["SHORE_SMOOTHING",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["L","=","1.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aX","(","aQ",",","L",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_WIREFRAME",1,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"extension",TOKENS:["GL_OES_standard_derivatives",":","enable"]}]}}]},{TYPE:"txt",TOKENS:["vec3","aN","=","fwidth","(","aD",")",";","vec3","aO","=","smoothstep","(","vec3","(","0.0",")",",","aN","*","aE",",","aD",")",";","float","fm","=","min","(","min","(","aO",".","x",",","aO",".","y",")",",","aO",".","z",")",";","fm","=","clamp","(","fm",",","0.0",",","1.0",")",";","aQ","=","mix","(","u_wireframe_edge_color",",","aQ",",","fm",")",";","L","=","mix","(","1.0",",","L",",","fm",")",";"]}]}},{TYPE:"elif",EXPRESSION:["DEBUG_WIREFRAME",2,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","aM","=","sign","(","aD","-","vec3","(","0.02","*","aE",")",")",";","float","fm","=","1.0",";","if","(","aM",".","x","<","0.0","||","aM",".","y","<","0.0","||","aM",".","z","<","0.0",")","fm","=","0.0",";","aQ","=","mix","(","u_wireframe_edge_color",",","aQ",",","fm",")",";","L","=","mix","(","1.0",",","L",",","fm",")",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",",","L",")",";","}"]}]},e["water.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"DEBUG_WIREFRAME",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_NORMALMAPS",TOKENS:["0"]},{TYPE:"var",NAME:"FOAM",TOKENS:["0"]},{TYPE:"var",NAME:"SHORE_PARAMS",TOKENS:["0"]},{TYPE:"var",NAME:"MAX_SHORE_DIST",TOKENS:["100.0"]},{TYPE:"var",NAME:"SHORE_MAP_SIZE_X",TOKENS:["1.0"]},{TYPE:"var",NAME:"SHORE_MAP_SIZE_Y",TOKENS:["1.0"]},{TYPE:"var",NAME:"SHORE_MAP_CENTER_X",TOKENS:["0.0"]},{TYPE:"var",NAME:"SHORE_MAP_CENTER_Y",TOKENS:["0.0"]},{TYPE:"var",NAME:"GENERATED_MESH",TOKENS:["0"]},{TYPE:"var",NAME:"DST_NOISE_SCALE_0",TOKENS:["0.05"]},{TYPE:"var",NAME:"DST_NOISE_SCALE_1",TOKENS:["0.03"]},{TYPE:"var",NAME:"DST_NOISE_FREQ_0",TOKENS:["1.3"]},{TYPE:"var",NAME:"DST_NOISE_FREQ_1",TOKENS:["1.0"]},{TYPE:"var",NAME:"DIR_MIN_SHR_FAC",TOKENS:["0.4"]},{TYPE:"var",NAME:"DIR_FREQ",TOKENS:["0.5"]},{TYPE:"var",NAME:"DIR_NOISE_SCALE",TOKENS:["0.05"]},{TYPE:"var",NAME:"DIR_NOISE_FREQ",TOKENS:["0.07"]},{TYPE:"var",NAME:"DIR_MIN_NOISE_FAC",TOKENS:["0.5"]},{TYPE:"var",NAME:"DST_MIN_FAC",TOKENS:["0.2"]},{TYPE:"var",NAME:"WAVES_HOR_FAC",TOKENS:["5.0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"WAVES_HEIGHT",TOKENS:["1.0"]},{TYPE:"var",NAME:"WAVES_LENGTH",TOKENS:["10.0"]},{TYPE:"var",NAME:"WATER_LEVEL",TOKENS:["0.0"]},{TYPE:"var",NAME:"SHORE_SMOOTHING",TOKENS:["0"]},{TYPE:"var",NAME:"DYNAMIC",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"REFRACTIVE",TOKENS:["0"]},{TYPE:"var",NAME:"STATIC_BATCH",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"include",FILE:"procedural.glslf"},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GENERATED_MESH",{TYPE:"logic_negative_expr",PLACES:1},"DYNAMIC",{TYPE:"logic_negative_expr",PLACES:1},"NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_tbn",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GENERATED_MESH",{TYPE:"logic_negative_expr",PLACES:1},"NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2},"FOAM",{TYPE:"logical_or_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_WIREFRAME"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","a_polyindex",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","bT",";","GLSL_OUT","vec3","h",";","GLSL_OUT","vec3","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2},"FOAM",{TYPE:"logical_or_expr",PLACES:2},"GENERATED_MESH",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec2","A",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","k",";","GLSL_OUT","vec3","eF",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2},"FOAM",{TYPE:"logical_or_expr",PLACES:2},"GENERATED_MESH","DYNAMIC",{TYPE:"logical_and_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","eG",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","eH",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","float","m",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_WIREFRAME"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","aD",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","B",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","mat3","u_model_tsr","=","mat3","(","0.0",",","0.0",",","0.0",",","1.0",",","0.0",",","0.0",",","0.0",",","1.0",",","0.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr",";","uniform","mat4","u_proj_matrix",";","uniform","vec3","u_camera_eye",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","float","u_time",";","uniform","vec3","u_wind",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_shore_dist_map",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ft","(","in","vec2","fn",")","{","vec2","fo","=","0.5","+","vec2","(","(","fn",".","x","-","SHORE_MAP_CENTER_X",")","/","SHORE_MAP_SIZE_X",",","(","fn",".","y","-","SHORE_MAP_CENTER_Y",")","/","SHORE_MAP_SIZE_Y",")",";","vec4","fp","=","GLSL_TEXTURE","(","u_shore_dist_map",",","fo",")",";","const","vec2","fq","=","vec2","(","1.0","/","255.0",",","1.0",")",";","float","fr","=","dot","(","fp",".","ba",",","fq",")",";","vec2","fs","=","normalize","(","fp",".","rg","*","2.0","-","1.0",")",";","return","vec3","(","fs",",","fr",")",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMALL_WAVES_FAC",TOKENS:["0.2"]},{TYPE:"txt",TOKENS:["void","fI","(","inout","vec3","fn",",","in","float","fu",",","in","vec3","fp",")","{","float","fw","=","fv","(","DST_NOISE_SCALE_0","*","(","fn",".","xy","+","DST_NOISE_FREQ_0","*","fu",")",")","*","fv","(","DST_NOISE_SCALE_1","*","(","fn",".","yx","-","DST_NOISE_FREQ_1","*","fu",")",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","fx","=","WAVES_LENGTH","/","MAX_SHORE_DIST","/","M_PI",";","float","fr","=","fp",".","b",";","float","fy","=","sqrt","(","fr",")",";","float","fz","=","max","(","fr",",","DIR_MIN_SHR_FAC",")","*","sin","(","fy","/","fx","+","DIR_FREQ","*","fu",")",";","float","fA","=","max","(","fv","(","DIR_NOISE_SCALE","*","(","fn",".","xy","+","DIR_NOISE_FREQ","*","fu",")",")",",","DIR_MIN_NOISE_FAC",")",";","fz","*=","fA",";","float","fB","=","WAVES_HEIGHT","*","mix","(","fz",",","fw",",","max","(","fy",",","DST_MIN_FAC",")",")",";","vec2","fs","=","fp",".","rg",";","float","fC","=","WAVES_HOR_FAC","*","fz","*","max","(","MAX_SHORE_DIST","/","35.0","*","(","0.05","-","fr",")",",","0.0",")",";","vec2","fD","=","fC","*","fs",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","fB","=","WAVES_HEIGHT","*","fw",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GENERATED_MESH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","fE","=","1.0","*","(","fn",".","xy","-","0.3","*","fu",")",";","vec2","fF","=","0.7","*","(","fn",".","yx","+","0.07","*","fu",")",";","float","fH","=","fG","(","fE",")",".","x","+","fG","(","fF",")",".","x","-","1.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["fn",".","xy","+=","fD",";","fH","*=","fr",";"]}]}}]},{TYPE:"txt",TOKENS:["fB","+=","SMALL_WAVES_FAC","*","fH",";"]}]}}]},{TYPE:"txt",TOKENS:["fn",".","z","+=","fB",";","}"]}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_WIREFRAME"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","a_polyindex","==","0.0",")","aD","=","vec3","(","1.0",",","0.0",",","0.0",")",";","else","if","(","a_polyindex","==","1.0",")","aD","=","vec3","(","0.0",",","0.0",",","1.0",")",";","else","aD","=","vec3","(","0.0",",","1.0",",","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GENERATED_MESH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","O","=","a_position",";","float","fJ","=","abs","(","O",".","z",")",";","vec2","fK","=","u_camera_eye",".","xy","-","mod","(","u_camera_eye",".","xy",",","fJ",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["O",".","z","=","WATER_LEVEL",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["O",".","z","=","0.0",";"]}]}}]},{TYPE:"txt",TOKENS:["O",".","xy","+=","fK",";","vec3","bX","=","O",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2},"FOAM",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["A","=","a_texcoord",";"]}]}}]},{TYPE:"txt",TOKENS:["au","aw","=","av","(","a_position",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","u_model_tsr",")",";","vec3","bX","=","aw",".","O",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eH","=","ft","(","bX",".","xy",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","fL","=","length","(","u_wind",")",";","if","(","fL","==","0.0",")","fL","=","1.0",";","float","fM","=","u_time",";","fM","*=","fL",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GENERATED_MESH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","fN","=","fJ",";","vec3","fO","=","bX","+","vec3","(","fN",",","0.0",",","0.0",")",";","vec3","fP","=","bX","+","vec3","(","0.0",",","fN",",","0.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2},"FOAM",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eG","=","bX",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","fO","=","bX","+","vec3","(","0.05",",","0.0",",","0.0",")",";","vec3","fP","=","bX","+","vec3","(","0.0",",","0.05",",","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","fQ","=","ft","(","fO",".","xy",")",";","vec3","fR","=","ft","(","fP",".","xy",")",";","fI","(","fO",",","fM",",","fQ",")",";","fI","(","fP",",","fM",",","fR",")",";","fI","(","bX",",","fM",",","eH",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["fI","(","fO",",","fM",",","vec3","(","0.0",")",")",";","fI","(","fP",",","fM",",","vec3","(","0.0",")",")",";","fI","(","bX",",","fM",",","vec3","(","0.0",")",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GENERATED_MESH","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","a_position",".","z","<","0.0",")","{","bX",".","z","=","WATER_LEVEL","-","1.0",";","fO",".","z","=","bX",".","z",";","fP",".","z","=","bX",".","z",";","}"]}]}}]},{TYPE:"txt",TOKENS:["vec3","eg","=","normalize","(","fO","-","bX",")",";","vec3","V","=","normalize","(","fP","-","bX",")",";","j","=","normalize","(","cross","(","eg",",","V",")",")",";","float","fS","=","dot","(","j",",","UP_VECTOR",")",";","float","aL","=","clamp","(","0.8","-","fS",",","0.0",",","1.0",")",";","j","=","mix","(","j",",","UP_VECTOR",",","aL",")",";"]}]}},{TYPE:"elif",EXPRESSION:["GENERATED_MESH",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","S","=","R","(","a_tbn",")",";","j","=","T","(","S",",","vec3","(","0.0",",","1.0",",","0.0",")",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["j","=","vec3","(","0.0",",","0.0",",","1.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GENERATED_MESH",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","V","=","T","(","S",",","vec3","(","1.0",",","0.0",",","0.0",")",")",";"]}]}},{TYPE:"elif",EXPRESSION:["DYNAMIC",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","V","=","vec3","(","1.0",",","0.0",",","0.0",")",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["k","=","V",";","eF","=","cross","(","j",",","k",")",";"]}]}}]},{TYPE:"txt",TOKENS:["h","=","bX",";","bT","=","u_camera_eye","-","bX",";","vec4","bY","=","vec4","(","ap","(","u_view_tsr",",","bX",")",",","1.0",")",";","vec4","f","=","u_proj_matrix","*","bY",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","fT","=","f",".","x",";","float","fU","=","f",".","y",";","float","fV","=","f",".","w",";","l",".","x","=","(","fT","+","fV",")","/","2.0",";","l",".","y","=","(","fU","+","fV",")","/","2.0",";","l",".","z","=","fV",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["m","=","-","bY",".","z","/","u_view_max_depth",";"]}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","f",";","}"]}]},e["postprocessing/antialiasing.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"AA_METHOD",TOKENS:["AA_METHOD_FXAA_LIGHT"]},{TYPE:"var",NAME:"AA_QUALITY",TOKENS:["AA_QUALITY_LOW"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_color",";","uniform","vec2","u_texel_size",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_REDUCE_MIN",TOKENS:["(","1.0","/","128.0",")"]},{TYPE:"define",NAME:"FXAA_REDUCE_MUL",TOKENS:["(","1.0","/","8.0",")"]},{TYPE:"define",NAME:"FXAA_SPAN_MAX",TOKENS:["8.0"]},{TYPE:"txt",TOKENS:["vec4","fX","(","float","x",",","float","y",")","{","vec2","fW","=","A","+","vec2","(","x",",","y",")","*","u_texel_size",";","return","GLSL_TEXTURE","(","u_color",",","fW",")",";","}","vec4","gt","(",")","{","vec4","fY","=","fX","(","-","1.0",",","-","1.0",")",";","vec4","fZ","=","fX","(","1.0",",","-","1.0",")",";","vec4","f_","=","fX","(","-","1.0",",","1.0",")",";","vec4","gc","=","fX","(","1.0",",","1.0",")",";","vec4","gd","=","fX","(","0.0",",","0.0",")",";","float","gf","=","ge","(","gd",")",";","float","gh","=","ge","(","fY",")",";","float","gi","=","ge","(","fZ",")",";","float","gj","=","ge","(","f_",")",";","float","gk","=","ge","(","gc",")",";","float","gl","=","min","(","gf",",","min","(","min","(","gh",",","gi",")",",","min","(","gj",",","gk",")",")",")",";","float","gm","=","max","(","gf",",","max","(","max","(","gh",",","gi",")",",","max","(","gj",",","gk",")",")",")",";","vec2","bD",";","bD",".","x","=","-","(","(","gh","+","gi",")","-","(","gj","+","gk",")",")",";","bD",".","y","=","(","(","gh","+","gj",")","-","(","gi","+","gk",")",")",";","float","gn","=","max","(","(","gh","+","gi","+","gj","+","gk",")","*","(","0.25","*","FXAA_REDUCE_MUL",")",",","FXAA_REDUCE_MIN",")",";","float","go","=","1.0","/","(","min","(","abs","(","bD",".","x",")",",","abs","(","bD",".","y",")",")","+","gn",")",";","bD","=","min","(","vec2","(","FXAA_SPAN_MAX",",","FXAA_SPAN_MAX",")",",","max","(","vec2","(","-","FXAA_SPAN_MAX",",","-","FXAA_SPAN_MAX",")",",","bD","*","go",")",")","*","u_texel_size",";","vec4","gp","=","0.5","*","(","GLSL_TEXTURE","(","u_color",",","A","+","bD","*","(","1.0","/","3.0","-","0.5",")",")","+","GLSL_TEXTURE","(","u_color",",","A","+","bD","*","(","2.0","/","3.0","-","0.5",")",")",")",";","vec4","gq","=","gp","*","0.5","+","0.25","*","(","GLSL_TEXTURE","(","u_color",",","A","+","bD","*","-","0.5",")","+","GLSL_TEXTURE","(","u_color",",","A","+","bD","*","0.5",")",")",";","float","gs","=","ge","(","gq",")",";","if","(","(","gs","<","gl",")","||","(","gs",">","gm",")",")","return","gp",";","else","return","gq",";","}"]}]}},{TYPE:"elif",EXPRESSION:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_GREEN_AS_LUMA",TOKENS:["1"]},{TYPE:"include",FILE:"fxaa.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["AA_QUALITY","AA_QUALITY_HIGH",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PRESET",TOKENS:["39"]},{TYPE:"define",NAME:"FXAA_QUALITY_SUBPIX",TOKENS:["1.00"]},{TYPE:"define",NAME:"FXAA_QUALITY_EDGE_THRESHOLD",TOKENS:["0.063"]},{TYPE:"define",NAME:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",TOKENS:["0.0312"]}]}},{TYPE:"elif",EXPRESSION:["AA_QUALITY","AA_QUALITY_MEDIUM",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PRESET",TOKENS:["20"]},{TYPE:"define",NAME:"FXAA_QUALITY_SUBPIX",TOKENS:["0.65"]},{TYPE:"define",NAME:"FXAA_QUALITY_EDGE_THRESHOLD",TOKENS:["0.166"]},{TYPE:"define",NAME:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",TOKENS:["0.0625"]}]}},{TYPE:"elif",EXPRESSION:["AA_QUALITY","AA_QUALITY_LOW",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PRESET",TOKENS:["12"]},{TYPE:"define",NAME:"FXAA_QUALITY_SUBPIX",TOKENS:["0.50"]},{TYPE:"define",NAME:"FXAA_QUALITY_EDGE_THRESHOLD",TOKENS:["0.166"]},{TYPE:"define",NAME:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",TOKENS:["0.0833"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","gt","(",")",";"]}]}},{TYPE:"elif",EXPRESSION:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","gu","=","u_texel_size",";","GLSL_OUT_FRAG_COLOR","=","gv","(","A",",","u_color",",","gu",",","FXAA_QUALITY_SUBPIX",",","FXAA_QUALITY_EDGE_THRESHOLD",",","FXAA_QUALITY_EDGE_THRESHOLD_MIN",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]},e["postprocessing/bloom_combine.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"var",NAME:"BLUR_PASS_NUM",TOKENS:["BLUR_PASS_5"]},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_main",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_1",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_bloom_level_0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_2",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_bloom_level_1",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_3",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_bloom_level_2",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_4",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_bloom_level_3",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_5",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_bloom_level_4",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec4","gw","=","GLSL_TEXTURE","(","u_main",",","A",")",";","vec4","gx","=","vec4","(","0.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_1",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["gx","+=","GLSL_TEXTURE","(","u_bloom_level_0",",","A",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_2",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["gx","+=","GLSL_TEXTURE","(","u_bloom_level_1",",","A",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_3",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["gx","+=","GLSL_TEXTURE","(","u_bloom_level_2",",","A",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_4",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["gx","+=","GLSL_TEXTURE","(","u_bloom_level_3",",","A",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_5",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["gx","+=","GLSL_TEXTURE","(","u_bloom_level_4",",","A",")",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","gw","+","gx",";","}"]}]},e["postprocessing/coc.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"COC_TYPE",TOKENS:["COC_ALL"]},{TYPE:"txt",TOKENS:["precision","PRECISION","sampler2D",";"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"depth_fetch.glslf"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_color",";","uniform","sampler2D","u_depth",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COC_TYPE","COC_COMBINE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_coc_fg",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_view_max_depth",";","uniform","float","u_dof_dist",";","uniform","float","u_dof_front_start",";","uniform","float","u_dof_front_end",";","uniform","float","u_dof_rear_start",";","uniform","float","u_dof_rear_end",";","uniform","vec2","u_camera_range",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec4","aQ","=","GLSL_TEXTURE","(","u_color",",","A",")",";","if","(","u_dof_dist",">","0.0",")","{","float","eq","=","gy","(","u_depth",",","A",",","u_camera_range",")",";","eq","*=","u_view_max_depth",";","float","gz","=","0.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COC_TYPE","COC_COMBINE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","gA","=","GLSL_TEXTURE","(","u_coc_fg",",","A",")",";","float","gB","=","gA",".","a",";"]}]}}]},{TYPE:"txt",TOKENS:["if","(","eq","<","u_dof_dist",")","gz","=","(","u_dof_dist","-","eq","-","u_dof_front_start",")","/","(","u_dof_front_end","-","u_dof_front_start",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COC_TYPE","COC_FOREGROUND",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["else","gz","=","(","eq","-","u_dof_dist","-","u_dof_rear_start",")","/","(","u_dof_rear_end","-","u_dof_rear_start",")",";"]}]}}]},{TYPE:"txt",TOKENS:["gz","=","clamp","(","gz",",","0.0",",","1.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COC_TYPE","COC_COMBINE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["gz","=","max","(","gz",",","gB",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COC_TYPE","COC_FOREGROUND",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","gz",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",".","xyz","*","gz",",","gz",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}","else","GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",".","xyz",",","0.0",")",";","}"]}]},e["postprocessing/compositing.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_color",";","uniform","float","u_brightness",";","uniform","float","u_contrast",";","uniform","float","u_exposure",";","uniform","float","u_saturation",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec4","gC","=","GLSL_TEXTURE","(","u_color",",","A",")",";","vec3","aQ","=","gC",".","rgb",";","if","(","u_brightness","<","0.0",")","aQ","=","aQ","*","(","1.0","+","u_brightness",")",";","else","aQ","=","aQ","+","(","(","1.0","-","aQ",")","*","u_brightness",")",";","aQ","=","(","aQ","-","0.5",")","*","(","tan","(","(","u_contrast","+","1.0",")","*","M_PI_4",")",")","+","0.5",";","aQ","*=","u_exposure",";","float","ds","=","ge","(","vec4","(","aQ",",","0.0",")",")",";","aQ","=","mix","(","vec3","(","ds",")",",","aQ",",","u_saturation",")",";","GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",",","gC",".","a",")",";","}"]}]},e["postprocessing/depth_pack.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"txt",TOKENS:["precision","PRECISION","sampler2D",";"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"pack.glslf"},{TYPE:"include",FILE:"depth_fetch.glslf"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_depth",";","uniform","vec2","u_camera_range",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","GLSL_OUT_FRAG_COLOR","=","er","(","clamp","(","gy","(","u_depth",",","A",",","u_camera_range",")",",","0.0",",","0.999999",")",")",";","}"]}]},e["postprocessing/dof.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"DOF_TYPE",TOKENS:["DOF_SIMPLE"]},{TYPE:"txt",TOKENS:["precision","PRECISION","sampler2D",";"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DOF_TYPE","DOF_BOKEH",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","highp","sampler2D","u_sharp",";","uniform","highp","sampler2D","u_blurred1",";","uniform","highp","sampler2D","u_blurred2",";","uniform","float","u_dof_dist",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"depth_fetch.glslf"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_sharp",";","uniform","sampler2D","u_blurred",";","uniform","sampler2D","u_depth",";","uniform","float","u_view_max_depth",";","uniform","float","u_dof_dist",";","uniform","float","u_dof_front_end",";","uniform","float","u_dof_rear_end",";","uniform","vec2","u_camera_range",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec4","gD","=","GLSL_TEXTURE","(","u_sharp",",","A",")",";","if","(","u_dof_dist",">","0.0",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DOF_TYPE","DOF_BOKEH",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","gz",";","vec4","gE","=","GLSL_TEXTURE","(","u_blurred1",",","A",")",";","vec4","gF","=","GLSL_TEXTURE","(","u_blurred2",",","A",")",";","vec4","gG","=","min","(","gE",".","rgba",",","gF",".","rgba",")",";","gz","=","gG",".","a",";","if","(","gz",">","0.0",")","{","gG","=","vec4","(","gG",".","rgb","/","gz",",","gD",".","a",")",";","GLSL_OUT_FRAG_COLOR","=","mix","(","gD",",","gG",",","min","(","gz","*","5.0",",","1.0",")",")",";","}","else","GLSL_OUT_FRAG_COLOR","=","gD",";"]}]}},{TYPE:"elif",EXPRESSION:["DOF_TYPE","DOF_SIMPLE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","eq","=","gy","(","u_depth",",","A",",","u_camera_range",")",";","eq","*=","u_view_max_depth",";","float","gH",";","if","(","eq","<","u_dof_dist",")","gH","=","(","u_dof_dist","-","eq",")","/","u_dof_front_end",";","else","gH","=","(","eq","-","u_dof_dist",")","/","u_dof_rear_end",";","gH","=","clamp","(","gH",",","0.0",",","1.0",")",";","vec4","gI","=","GLSL_TEXTURE","(","u_blurred",",","A",")",";","GLSL_OUT_FRAG_COLOR","=","mix","(","gD",",","gI",",","gH",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","gD",";"]}]}}]},{TYPE:"txt",TOKENS:["}","else","GLSL_OUT_FRAG_COLOR","=","gD",";","}"]}]},e["postprocessing/glow.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_src_color",";","uniform","sampler2D","u_glow_mask_small",";","uniform","sampler2D","u_glow_mask_large",";","uniform","float","u_glow_mask_small_coeff",";","uniform","float","u_glow_mask_large_coeff",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec4","gJ","=","GLSL_TEXTURE","(","u_src_color",",","A",")",";","vec4","gK","=","GLSL_TEXTURE","(","u_glow_mask_small",",","A",")",";","vec4","gL","=","GLSL_TEXTURE","(","u_glow_mask_large",",","A",")",";","GLSL_OUT_FRAG_COLOR","=","gJ",";","if","(","gL",".","a","!=","0.0",")","{","float","gM","=","u_glow_mask_large_coeff","*","gL",".","a",";","gM","=","clamp","(","gM",",","0.0",",","1.0",")",";","GLSL_OUT_FRAG_COLOR",".","rgb","=","mix","(","GLSL_OUT_FRAG_COLOR",".","rgb",",","gL",".","rgb","/","gL",".","a",",","gM",")",";","GLSL_OUT_FRAG_COLOR",".","a","=","mix","(","GLSL_OUT_FRAG_COLOR",".","a",",","1.0",",","gM",")",";","}","if","(","gK",".","a","!=","0.0",")","{","float","gN","=","u_glow_mask_small_coeff","*","gK",".","a",";","gN","=","clamp","(","gN",",","0.0",",","1.0",")",";","GLSL_OUT_FRAG_COLOR",".","rgb","=","mix","(","GLSL_OUT_FRAG_COLOR",".","rgb",",","gK",".","rgb","/","gK",".","a",",","gN",")",";","GLSL_OUT_FRAG_COLOR",".","a","=","mix","(","GLSL_OUT_FRAG_COLOR",".","a",",","1.0",",","gN",")",";","}","}"]}]},e["postprocessing/god_rays.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"DEPTH_RGBA",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"STEPS_PER_PASS",TOKENS:["10.0"]},{TYPE:"txt",TOKENS:["precision","PRECISION","sampler2D",";"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"depth_fetch.glslf"},{TYPE:"include",FILE:"procedural.glslf"},{TYPE:"include",FILE:"pack.glslf"},{TYPE:"txt",TOKENS:["uniform","float","u_time",";","uniform","float","u_radial_blur_step",";","uniform","sampler2D","u_input",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEPTH_RGBA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec2","u_camera_range",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEPTH_RGBA","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","gO",";","GLSL_IN","vec2","gP",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";","GLSL_IN","vec4","gQ",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec2","cS","=","(","gQ",".","xy","-","A",")",";","float","aM","=","length","(","cS",")",";","vec2","gR","=","u_radial_blur_step","*","cS","/","aM",";","float","gS","=","aM","/","u_radial_blur_step",";","gR","*=","min","(","gS",",","STEPS_PER_PASS",")","/","STEPS_PER_PASS",";","gS","=","max","(","gS",",","STEPS_PER_PASS",")",";","vec2","gT","=","A",";","float","gU","=","0.0",";","const","int","gV","=","int","(","STEPS_PER_PASS",")",";","int","gW","=","int","(","gS","+","0.5",")",";","for","(","int","cl","=","0",";","cl","<","gV",";","cl","+=","1",")","{","if","(","cl","<=","gW",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEPTH_RGBA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","eq","=","gy","(","u_input",",","gT",",","u_camera_range",")",";","gU","+=","max","(","(","1.0","-","pow","(","aM",",","0.3",")",")","*","step","(","0.9",",","eq",")",",","0.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","gX","=","GLSL_TEXTURE","(","u_input",",","gT",")",";","gU","+=","cQ","(","gX",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}","gT","+=","gR",";","}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEPTH_RGBA","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","b_","=","A","+","gP",";","float","gY","=","fG","(","vec2","(","2.5","*","(","b_",".","x",")",",","2.5","*","(","b_",".","y",")","+","1.0","*","u_time",")",")",".","x","+","0.75","*","fG","(","vec2","(","5.0","*","(","b_",".","x",")","-","0.66","*","u_time",",","5.0","*","(","b_",".","y",")","+","0.66","*","u_time",")",")",".","x","+","0.5","*","fv","(","vec2","(","7.5","*","(","b_",".","x",")","+","0.33","*","u_time",",","7.5","*","(","b_",".","y",")","-","0.33","*","u_time",")",")",";","gY","*=","clamp","(","1.2","-","sqrt","(","0.2","*","aM",")",",","0.0",",","1.0",")","*","gO",";","gU","=","max","(","gY",",","gU",")",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","er","(","gU","/","STEPS_PER_PASS",")",";","}"]}]},e["postprocessing/god_rays.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"DEPTH_RGBA",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"txt",TOKENS:["uniform","mat4","u_view_proj_matrix",";","uniform","vec3","u_sun_direction",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEPTH_RGBA","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_camera_quat",";","uniform","float","u_cam_water_depth",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec2","a_bb_vertex",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEPTH_RGBA","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","float","gO",";","GLSL_OUT","vec2","gP",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec2","A",";","GLSL_OUT","vec4","gQ",";","void","main","(",")","{","A","=","a_bb_vertex",";","vec3","bD","=","normalize","(","u_sun_direction",")",";","gQ","=","u_view_proj_matrix","*","vec4","(","bD",",","0.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEPTH_RGBA","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","u_cam_water_depth","<","0.0",")","{","gO","=","1.0",";","vec3","gZ","=","vec3","(","0.0",",","1.0",",","0.0",")",";","vec3","g_","=","T","(","u_camera_quat",",","gZ",")",";","g_","=","normalize","(","g_",")",";","float","ha","=","dot","(","g_",",","vec3","(","0.0",",","1.0",",","0.0",")",")",";","float","hb","=","atan","(","g_",".","x",",","g_",".","z",")",";","gP","=","vec2","(","-","hb",",","acos","(","ha",")",")",";","}","else","{","gO","=","0.0",";","}"]}]}}]},{TYPE:"txt",TOKENS:["gQ",".","xy","=","0.5","*","(","gQ",".","xy","/","gQ",".","w","+","1.0",")",";","gQ","+=","99999.0","*","step","(","gQ",".","z",",","0.0",")",";","gl_Position","=","vec4","(","2.0","*","a_bb_vertex",".","xy","-","1.0",",","0.0",",","1.0",")",";","}"]}]},e["postprocessing/god_rays_combine.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"SAFARI_CANVAS_ALPHA_HACK",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"include",FILE:"pack.glslf"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_main",";","uniform","sampler2D","u_god_rays",";","uniform","float","u_god_rays_intensity",";","uniform","vec3","u_sun_intensity",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec4","hc","=","GLSL_TEXTURE","(","u_main",",","A",")",";","vec3","hd","=","clamp","(","u_sun_intensity",",","0.4",",","0.8",")",";","bC","(","hc",".","rgb",")",";","float","he","=","cQ","(","GLSL_TEXTURE","(","u_god_rays",",","A",")",")",";","vec3","hf","=","hc",".","rgb","+","u_god_rays_intensity","*","vec3","(","he",")","*","hd",";","aW","(","hf",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SAFARI_CANVAS_ALPHA_HACK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","hf",",","max","(","0.01",",","hc",".","a",")",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","hf",",","hc",".","a",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]},e["postprocessing/luminance.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_input",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec4","gw","=","GLSL_TEXTURE","(","u_input",",","A",")",";","float","hg","=","dot","(","gw",".","rgb",",","vec3","(","0.2126",",","0.7152",",","0.0722",")",")",";","GLSL_OUT_FRAG_COLOR","=","vec4","(","vec3","(","hg",")",",","1.0",")",";","}"]}]},e["postprocessing/luminance_av.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_input",";","uniform","float","u_mipmap_1x1",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","float","hh","=","max","(","GLSL_TEXTURE","(","u_input",",","A",",","u_mipmap_1x1",")",".","r",",","0.01",")",";","GLSL_OUT_FRAG_COLOR","=","vec4","(","vec3","(","hh",")",",","1.0",")",";","}"]}]},e["postprocessing/luminance_truncated.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"var",NAME:"ADAPTIVE_BLOOM",TOKENS:["0"]},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_main",";","uniform","sampler2D","u_luminance",";","uniform","sampler2D","u_average_lum",";","uniform","float","u_bloom_edge_lum",";","uniform","float","u_bloom_key",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ADAPTIVE_BLOOM",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_average_lum_val",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ADAPTIVE_BLOOM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","hh","=","GLSL_TEXTURE","(","u_average_lum",",","vec2","(","0.5",")",")",".","r",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","hh","=","u_average_lum_val",";"]}]}}]},{TYPE:"txt",TOKENS:["float","hi","=","GLSL_TEXTURE","(","u_luminance",",","A",")",".","r",";","vec4","aQ","=","GLSL_TEXTURE","(","u_main",",","A",")",";","float","hj","=","hi","/","hh",";","float","hk","=","u_bloom_edge_lum",";","GLSL_OUT_FRAG_COLOR","=","aQ","*","u_bloom_key","*","smoothstep","(","hk",",","hk","+","1.2",",","hj",")",";","}"]}]},e["postprocessing/motion_blur.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_mb_tex_curr",";","uniform","sampler2D","u_mb_tex_accum",";","uniform","float","u_motion_blur_exp",";","uniform","float","u_motion_blur_decay_threshold",";","float","hl","=","0.0042",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec4","hm","=","GLSL_TEXTURE","(","u_mb_tex_curr",",","A",")",";","vec4","hn","=","GLSL_TEXTURE","(","u_mb_tex_accum",",","A",")",";","if","(","length","(","hm","-","hn",")",">","u_motion_blur_decay_threshold",")","{","vec4","ho","=","(","1.0","-","u_motion_blur_exp",")","*","hm","+","u_motion_blur_exp","*","hn",";","vec4","hp","=","ho","-","hn",";","vec4","hq","=","hm","-","hn",";","vec4","cS","=","min","(","max","(","abs","(","hp",")",",","vec4","(","hl",")",")",",","abs","(","hq",")",")","*","sign","(","hp",")",";","GLSL_OUT_FRAG_COLOR","=","hn","+","cS",";","}","else","{","GLSL_OUT_FRAG_COLOR","=","hm",";","}","}"]}]},e["postprocessing/outline.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_outline_src",";","uniform","sampler2D","u_outline_mask",";","uniform","sampler2D","u_outline_mask_blurred",";","uniform","vec3","u_outline_color",";","uniform","float","u_draw_outline",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec4","hr","=","GLSL_TEXTURE","(","u_outline_src",",","A",")",";","GLSL_OUT_FRAG_COLOR","=","hr",";","if","(","u_draw_outline","!=","0.0",")","{","vec4","hs","=","GLSL_TEXTURE","(","u_outline_mask",",","A",")",";","vec4","ht","=","GLSL_TEXTURE","(","u_outline_mask_blurred",",","A",")",";","float","hu","=","ht",".","a","-","hs",".","a",";","if","(","hu","!=","0.0",")","{","float","hv","=","smoothstep","(","0.0",",","1.0",",","ht",".","a",")",";","if","(","hs",".","a","==","0.0",")","{","vec3","hw","=","u_outline_color",";","aW","(","hw",")",";","vec4","hx","=","vec4","(","clamp","(","hw",",","0.0",",","1.0",")",",","1.0",")",";","GLSL_OUT_FRAG_COLOR","=","mix","(","hr",",","hx",",","hv",")",";","}","}","}","}"]}]},e["postprocessing/performance.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_color",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec4","aQ","=","vec4","(","0.0",")",";","for","(","int","cl","=","0",";","cl","<","10",";","cl","++",")","{","vec2","hy","=","vec2","(","fract","(","A","*","vec2","(","cl",")","*","vec2","(","1.431",",","3.921",")",")",")",";","aQ","+=","0.01","*","GLSL_TEXTURE","(","u_color",",","hy",")",";","}","GLSL_OUT_FRAG_COLOR","=","aQ",";","}"]}]},e["postprocessing/postprocessing.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"POST_EFFECT",TOKENS:["POST_EFFECT_NONE"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["uniform","vec2","u_texel_size",";","uniform","sampler2D","u_color",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POST_EFFECT","FLIP_CUBEMAP_COORDS",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","int","u_tex_number",";","uniform","vec2","u_delta",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POST_EFFECT","POST_EFFECT_DOF_BLUR",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_dof_bokeh_intensity",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POST_EFFECT","POST_EFFECT_NONE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","u_color",",","A",")",";"]}]}},{TYPE:"elif",EXPRESSION:["POST_EFFECT","POST_EFFECT_GRAYSCALE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","du","=","GLSL_TEXTURE","(","u_color",",","A",")",";","GLSL_OUT_FRAG_COLOR",".","rgb","=","vec3","(","(","du",".","r","+","du",".","g","+","du",".","b",")","/","3.0",")",";","GLSL_OUT_FRAG_COLOR",".","a","=","1.0",";"]}]}},{TYPE:"elif",EXPRESSION:["POST_EFFECT","POST_EFFECT_BLUR",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","fI","=","vec2","(","0.0",",","0.0",")",";","vec2","cS","=","u_texel_size",";","vec4","aQ",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A",")",";","GLSL_OUT_FRAG_COLOR","=","aQ","*","0.2270270270",";","fI","+=","cS",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fI",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","0.1945945946",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fI",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","0.1945945946",";","fI","+=","cS",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fI",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","0.1216216216",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fI",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","0.1216216216",";","fI","+=","cS",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fI",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","0.0540540541",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fI",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","0.0540540541",";","fI","+=","cS",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fI",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","0.0162162162",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fI",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","0.0162162162",";"]}]}},{TYPE:"elif",EXPRESSION:["POST_EFFECT","POST_EFFECT_GLOW_BLUR",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","fI","=","vec2","(","0.0",",","0.0",")",";","vec2","cS","=","u_texel_size",";","vec4","aQ",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A",")",";","GLSL_OUT_FRAG_COLOR","=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.152507",";","fI","+=","cS",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fI",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.141763",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fI",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.141763",";","fI","+=","cS",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fI",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.113861",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fI",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.113861",";","fI","+=","cS",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fI",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.079019",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fI",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.079019",";","fI","+=","cS",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fI",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.047383",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fI",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.047383",";","fI","+=","cS",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fI",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.024549",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fI",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.024549",";","fI","+=","cS",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fI",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.01099",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fI",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.01099",";","fI","+=","cS",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fI",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.00425",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fI",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.00425",";","fI","+=","cS",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fI",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.00142",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fI",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.00142",";","GLSL_OUT_FRAG_COLOR","=","clamp","(","GLSL_OUT_FRAG_COLOR",",","0.0",",","1.0",")",";"]}]}},{TYPE:"elif",EXPRESSION:["POST_EFFECT","POST_EFFECT_DOF_BLUR",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","fI","=","vec2","(","0.0",",","0.0",")",";","vec2","cS","=","u_texel_size",";","vec4","aQ",";","vec4","hz",";","vec4","hA",";","float","gz",";","float","hB","=","u_dof_bokeh_intensity",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A",")",";","hz","=","aQ",";","hA","=","aQ",";","gz","=","aQ",".","a",";","cS","=","gz","*","cS",";","for","(","int","cl","=","0",";","cl","<","12",";","cl","+=","2",")","{","fI","+=","cS",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fI",")",";","hz","+=","aQ",";","hA","=","max","(","hA",",","aQ",")",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fI",")",";","hz","+=","aQ",";","hA","=","max","(","hA",",","aQ",")",";","}","hz","/=","13.0",";","GLSL_OUT_FRAG_COLOR","=","mix","(","hz",",","hA",",","hB",")",";"]}]}},{TYPE:"elif",EXPRESSION:["POST_EFFECT","POST_EFFECT_ALPHA_BLUR",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","fI","=","vec2","(","0.0",",","0.0",")",";","vec2","cS","=","u_texel_size",";","vec4","aQ",";","vec4","hz",";","vec4","hA",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A",")",";","hA","=","max","(","hA",",","aQ",")",";","hz","=","aQ",";","hz",".","a","=","aQ",".","a","*","0.2270270270",";","fI","+=","cS",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fI",")",";","hA",".","a","=","max","(","hA",".","a",",","aQ",".","a",")",";","hz",".","a","+=","aQ",".","a","*","0.1945945946",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fI",")",";","hA",".","a","=","max","(","hA",".","a",",","aQ",".","a",")",";","hz",".","a","+=","aQ",".","a","*","0.1945945946",";","fI","+=","cS",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fI",")",";","hA",".","a","=","max","(","hA",".","a",",","aQ",".","a",")",";","hz",".","a","+=","aQ",".","a","*","0.1216216216",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fI",")",";","hA",".","a","=","max","(","hA",".","a",",","aQ",".","a",")",";","hz",".","a","+=","aQ",".","a","*","0.1216216216",";","fI","+=","cS",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fI",")",";","hA",".","a","=","max","(","hA",".","a",",","aQ",".","a",")",";","hz",".","a","+=","aQ",".","a","*","0.0540540541",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fI",")",";","hA",".","a","=","max","(","hA",".","a",",","aQ",".","a",")",";","hz",".","a","+=","aQ",".","a","*","0.0540540541",";","fI","+=","cS",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fI",")",";","hA",".","a","=","max","(","hA",".","a",",","aQ",".","a",")",";","hz",".","a","+=","aQ",".","a","*","0.0162162162",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fI",")",";","hA",".","a","=","max","(","hA",".","a",",","aQ",".","a",")",";","hz",".","a","+=","aQ",".","a","*","0.0162162162",";","GLSL_OUT_FRAG_COLOR","=","mix","(","hz",",","hA",",","0.5",")",";"]}]}},{TYPE:"elif",EXPRESSION:["POST_EFFECT","POST_EFFECT_EXTEND",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","cS","=","u_texel_size",";","vec4","aQ","=","GLSL_TEXTURE","(","u_color",",","A",")",";","GLSL_OUT_FRAG_COLOR","=","aQ",";","if","(","aQ",".","a","==","0.0",")","{","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","cS",")",";","if","(","aQ",".","a",">","0.0",")","GLSL_OUT_FRAG_COLOR","=","vec4","(","1.0",",","1.0",",","1.0",",","aQ",".","a",")",";","else","{","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","cS",")",";","if","(","aQ",".","a",">","0.0",")","GLSL_OUT_FRAG_COLOR","=","vec4","(","1.0",",","1.0",",","1.0",",","aQ",".","a",")",";","}","}"]}]}},{TYPE:"elif",EXPRESSION:["POST_EFFECT","FLIP_CUBEMAP_COORDS",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","hC","=","u_delta","[","0","]",";","float","hD","=","u_delta","[","1","]",";","float","hE","=","1.0","/","3.0",";","float","hF","=","0.5",";","vec2","hG","=","vec2","(","hE",",","hF",")",";","if","(","u_tex_number","==","0",")","{","vec2","b_","=","mat2","(","0.0",",","-","1.0",",","1.0",",","0.0",")","*","A","*","hG","+","vec2","(","2.0","*","hE",",","hF",")",";","b_","[","0","]","=","max","(","b_","[","0","]",",","2.0","*","hE","+","hC",")",";","b_","[","1","]","=","max","(","b_","[","1","]",",","hD",")",";","GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","u_color",",","vec2","(","b_","[","0","]",",","hF","-","b_","[","1","]",")",")",";","}","else","if","(","u_tex_number","==","1",")","{","vec2","b_","=","mat2","(","0.0",",","-","1.0",",","1.0",",","0.0",")","*","A","*","hG","+","vec2","(","0.0",",","hF",")",";","b_","[","0","]","=","max","(","b_","[","0","]",",","hC",")",";","b_","[","1","]","=","min","(","b_","[","1","]",",","hF","-","hD",")",";","GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","u_color",",","vec2","(","hE","-","b_","[","0","]",",","b_","[","1","]",")",")",";","}","else","if","(","u_tex_number","==","2",")","{","vec2","b_","=","A","*","hG","+","vec2","(","2.0","*","hE",",","hF",")",";","b_","[","0","]","=","max","(","b_","[","0","]",",","2.0","*","hE","+","hC",")",";","b_","[","1","]","=","min","(","b_","[","1","]",",","1.0","-","hD",")",";","GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","u_color",",","vec2","(","b_","[","0","]",",","1.5","-","b_","[","1","]",")",")",";","}","else","if","(","u_tex_number","==","3",")","{","vec2","b_","=","A","*","hG","+","vec2","(","hE",",","0.0",")",";","b_","[","0","]","=","max","(","b_","[","0","]",",","hE","+","hC",")",";","b_","[","0","]","=","min","(","b_","[","0","]",",","2.0","*","hE","-","hC",")",";","b_","[","1","]","=","min","(","b_","[","1","]",",","hF","-","hD",")",";","GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","u_color",",","vec2","(","1.0","-","b_","[","0","]",",","b_","[","1","]",")",")",";","}","else","if","(","u_tex_number","==","4",")","{","vec2","b_","=","A","*","hG","+","vec2","(","hE",",","hF",")",";","b_","[","0","]","=","max","(","b_","[","0","]",",","hE","+","hC",")",";","b_","[","0","]","=","min","(","b_","[","0","]",",","2.0","*","hE","-","hC",")",";","b_","[","1","]","=","min","(","b_","[","1","]",",","1.0","-","hD",")",";","GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","u_color",",","vec2","(","b_","[","0","]",",","3.0","*","hF","-","b_","[","1","]",")",")",";","}","else","{","vec2","b_","=","A","*","hG","+","vec2","(","0.0",",","hF",")",";","b_","[","0","]","=","max","(","b_","[","0","]",",","hC",")",";","b_","[","1","]","=","min","(","b_","[","1","]",",","1.0","-","hD",")",";","b_","[","1","]","=","max","(","b_","[","1","]",",","hF","+","hD",")",";","GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","u_color",",","vec2","(","hE","-","b_","[","0","]",",","b_","[","1","]",")",")",";","}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]},e["postprocessing/postprocessing.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["GLSL_IN","vec2","a_position",";","GLSL_OUT","vec2","A",";","void","main","(",")","{","A","=","2.0","*","a_position",";","gl_Position","=","vec4","(","4.0","*","(","a_position",".","xy","-","0.25",")",",","0.0",",","1.0",")",";","}"]}]},e["postprocessing/precompute_brdf.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"txt",TOKENS:["precision","PRECISION","sampler2D",";","precision","PRECISION","float",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","float","dZ","(","int","cr",",","int","dV",")","{","float","dW","=","1.0","/","float","(","dV",")",";","float","dX","=","1.0",";","float","dY","=","0.0",";","for","(","int","cl","=","0",";","cl","<","32",";","++","cl",")","{","if","(","cr",">","0",")","{","dX","=","mod","(","float","(","cr",")",",","2.0",")",";","dY","+=","dX","*","dW",";","dW","=","dW","/","2.0",";","cr","=","int","(","float","(","cr",")","/","2.0",")",";","}","}","return","dY",";","}","vec2","ea","(","int","cl",",","int","d_",")","{","return","vec2","(","float","(","cl",")","/","float","(","d_",")",",","dZ","(","cl",",","2",")",")",";","}","vec3","eh","(","vec2","eb",",","vec3","d_",",","float","ec",")","{","float","a","=","ec","*","ec",";","float","by","=","2.0","*","M_PI","*","eb",".","x",";","float","ed","=","sqrt","(","(","1.0","-","eb",".","y",")","/","(","1.0","+","(","a","*","a","-","1.0",")","*","eb",".","y",")",")",";","float","ee","=","sqrt","(","1.0","-","ed","*","ed",")",";","vec3","ef",";","ef",".","x","=","cos","(","by",")","*","ee",";","ef",".","y","=","sin","(","by",")","*","ee",";","ef",".","z","=","ed",";","vec3","bu","=","abs","(","d_",".","z",")","<","0.999","?","vec3","(","0.0",",","0.0",",","1.0",")",":","vec3","(","1.0",",","0.0",",","0.0",")",";","vec3","V","=","normalize","(","cross","(","bu",",","d_",")",")",";","vec3","eg","=","cross","(","d_",",","V",")",";","vec3","bB","=","V","*","ef",".","x","+","eg","*","ef",".","y","+","d_","*","ef",".","z",";","return","normalize","(","bB",")",";","}","float","hK","(","float","hH",",","float","ec",")","{","float","a","=","ec",";","float","hI","=","(","a","*","a",")","/","2.0",";","float","hJ","=","hH",";","float","dX","=","hH","*","(","1.0","-","hI",")","+","hI",";","return","hJ","/","dX",";","}","float","hN","(","vec3","d_",",","vec3","ek",",","vec3","en",",","float","ec",")","{","float","hH","=","max","(","dot","(","d_",",","ek",")",",","0.0",")",";","float","eo","=","max","(","dot","(","d_",",","en",")",",","0.0",")",";","float","hL","=","hK","(","hH",",","ec",")",";","float","hM","=","hK","(","eo",",","ec",")",";","return","hM","*","hL",";","}","vec2","hU","(","float","hH",",","float","ec",")","{","vec3","ek",";","ek",".","x","=","sqrt","(","1.0","-","hH","*","hH",")",";","ek",".","y","=","0.0",";","ek",".","z","=","hH",";","float","cB","=","0.0",";","float","hO","=","0.0",";","vec3","d_","=","vec3","(","0.0",",","0.0",",","1.0",")",";","const","int","el","=","1024",";","for","(","int","cl","=","0",";","cl","<","el",";","++","cl",")","{","vec2","eb","=","ea","(","cl",",","el",")",";","vec3","ef","=","eh","(","eb",",","d_",",","ec",")",";","vec3","en","=","normalize","(","2.0","*","dot","(","ek",",","ef",")","*","ef","-","ek",")",";","float","eo","=","max","(","en",".","z",",","0.0",")",";","float","hP","=","max","(","ef",".","z",",","0.0",")",";","float","hQ","=","max","(","dot","(","ek",",","ef",")",",","0.0",")",";","if","(","eo",">","0.0",")","{","float","hR","=","hN","(","d_",",","ek",",","en",",","ec",")",";","float","hS","=","(","hR","*","hQ",")","/","(","hP","*","hH",")",";","float","hT","=","pow","(","1.0","-","hQ",",","5.0",")",";","cB","+=","(","1.0","-","hT",")","*","hS",";","hO","+=","hT","*","hS",";","}","}","cB","/=","float","(","el",")",";","hO","/=","float","(","el",")",";","return","vec2","(","cB",",","hO",")",";","}","void","main","(",")","{","vec2","hV","=","hU","(","A",".","x",",","A",".","y",")",";","GLSL_OUT_FRAG_COLOR","=","vec4","(","hV",",","0.0",",","1.0",")",";","}"]}]},e["postprocessing/smaa.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"SMAA_PASS",TOKENS:["SMAA_RESOLVE"]},{TYPE:"var",NAME:"SMAA_REPROJECTION",TOKENS:["0"]},{TYPE:"var",NAME:"SMAA_PREDICATION",TOKENS:["0"]},{TYPE:"var",NAME:"SMAA_DISABLE_CORNER_DETECTION",TOKENS:["0"]},{TYPE:"var",NAME:"AA_METHOD",TOKENS:["AA_METHOD_SMAA_ULTRA"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"pack.glslf"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_color",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_RESOLVE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_color_prev",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_blend",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_REPROJECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_velocity_tex",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_EDGE_DETECTION",{TYPE:"equal_expr",PLACES:2},"SMAA_PREDICATION",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_predication_tex",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_search_tex",";","uniform","sampler2D","u_area_tex",";","uniform","vec4","u_subsample_indices",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec2","u_texel_size",";","GLSL_IN","vec2","A",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","hW",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","hX",";","GLSL_IN","vec4","hY",";","GLSL_IN","vec4","hZ",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","h_",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["AA_METHOD","AA_METHOD_SMAA_LOW",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_THRESHOLD",TOKENS:["0.15"]},{TYPE:"define",NAME:"SMAA_DISABLE_DIAG_DETECTION",TOKENS:["1"]},{TYPE:"define",NAME:"SMAA_DISABLE_CORNER_DETECTION",TOKENS:["1"]}]}},{TYPE:"elif",EXPRESSION:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_THRESHOLD",TOKENS:["0.1"]},{TYPE:"define",NAME:"SMAA_DISABLE_DIAG_DETECTION",TOKENS:["1"]},{TYPE:"define",NAME:"SMAA_DISABLE_CORNER_DETECTION",TOKENS:["1"]}]}},{TYPE:"elif",EXPRESSION:["AA_METHOD","AA_METHOD_SMAA_HIGH",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_THRESHOLD",TOKENS:["0.1"]},{TYPE:"define",NAME:"SMAA_DISABLE_DIAG_DETECTION",TOKENS:["0"]},{TYPE:"define",NAME:"SMAA_MAX_SEARCH_STEPS_DIAG",TOKENS:["8"]},{TYPE:"define",NAME:"SMAA_CORNER_ROUNDING",TOKENS:["25"]}]}},{TYPE:"elif",EXPRESSION:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_THRESHOLD",TOKENS:["0.05"]},{TYPE:"define",NAME:"SMAA_DISABLE_DIAG_DETECTION",TOKENS:["0"]},{TYPE:"define",NAME:"SMAA_MAX_SEARCH_STEPS_DIAG",TOKENS:["16"]},{TYPE:"define",NAME:"SMAA_CORNER_ROUNDING",TOKENS:["25"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_THRESHOLD",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_THRESHOLD",TOKENS:["0.1"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_DEPTH_THRESHOLD",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_DEPTH_THRESHOLD",TOKENS:["(","0.1","*","SMAA_THRESHOLD",")"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_MAX_SEARCH_STEPS_DIAG",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_MAX_SEARCH_STEPS_DIAG",TOKENS:["8"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_CORNER_ROUNDING",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_CORNER_ROUNDING",TOKENS:["25"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",TOKENS:["2.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_PREDICATION",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_PREDICATION",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_PREDICATION_THRESHOLD",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_PREDICATION_THRESHOLD",TOKENS:["0.01"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_PREDICATION_SCALE",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_PREDICATION_SCALE",TOKENS:["2.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_PREDICATION_STRENGTH",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_PREDICATION_STRENGTH",TOKENS:["0.4"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_REPROJECTION",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_REPROJECTION",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_REPROJECTION_WEIGHT_SCALE",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_REPROJECTION_WEIGHT_SCALE",TOKENS:["30.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_MAX_SEARCH_STEPS",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_MAX_SEARCH_STEPS",TOKENS:["16"]}]}}]},{TYPE:"define",NAME:"SMAA_AREATEX_MAX_DISTANCE",TOKENS:["16"]},{TYPE:"define",NAME:"SMAA_AREATEX_MAX_DISTANCE_DIAG",TOKENS:["20"]},{TYPE:"define",NAME:"SMAA_AREATEX_PIXEL_SIZE",TOKENS:["(","1.0","/","vec2","(","160.0",",","560.0",")",")"]},{TYPE:"define",NAME:"SMAA_AREATEX_SUBTEX_SIZE",TOKENS:["(","1.0","/","7.0",")"]},{TYPE:"define",NAME:"SMAA_SEARCHTEX_SIZE",TOKENS:["vec2","(","66.0",",","33.0",")"]},{TYPE:"define",NAME:"SMAA_SEARCHTEX_PACKED_SIZE",TOKENS:["vec2","(","64.0",",","16.0",")"]},{TYPE:"define",NAME:"SMAA_CORNER_ROUNDING_NORM",TOKENS:["(","float","(","SMAA_CORNER_ROUNDING",")","/","100.0",")"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_EDGE_DETECTION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","id","(","vec2","b_",",","sampler2D","ia",")","{","float","p","=","GLSL_TEXTURE","(","ia",",","b_",")",".","r",";","float","ib","=","GLSL_TEXTURE","(","ia",",","hX",".","xy",")",".","r",";","float","ic","=","GLSL_TEXTURE","(","ia",",","hX",".","zw",")",".","r",";","return","vec3","(","p",",","ib",",","ic",")",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_EDGE_DETECTION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","ii","(","vec2","b_",",","sampler2D","ie",")","{","vec3","ig","=","id","(","b_",",","ie",")",";","vec2","cS","=","abs","(","ig",".","xx","-","ig",".","yz",")",";","vec2","ih","=","step","(","SMAA_PREDICATION_THRESHOLD",",","cS",")",";","return","SMAA_PREDICATION_SCALE","*","SMAA_THRESHOLD","*","(","1.0","-","SMAA_PREDICATION_STRENGTH","*","ih",")",";","}"]}]}}]},{TYPE:"txt",TOKENS:["void","im","(","bvec2","ij",",","inout","vec2","ik",",","vec2","il",")","{","if","(","ij",".","x",")","ik",".","x","=","il",".","x",";","if","(","ij",".","y",")","ik",".","y","=","il",".","y",";","}","void","im","(","bvec4","ij",",","inout","vec4","ik",",","vec4","il",")","{","im","(","ij",".","xy",",","ik",".","xy",",","il",".","xy",")",";","im","(","ij",".","zw",",","ik",".","zw",",","il",".","zw",")",";","}","vec2","io","(","vec2","x",")","{","return","sign","(","x",")","*","floor","(","abs","(","x",")","+",".5",")",";","}","vec4","io","(","vec4","x",")","{","return","sign","(","x",")","*","floor","(","abs","(","x",")","+",".5",")",";","}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_EDGE_DETECTION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","iA","(","vec2","b_",",","sampler2D","ip"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PREDICATION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:[",","sampler2D","ie"]}]}}]},{TYPE:"txt",TOKENS:[")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PREDICATION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","iq","=","ii","(","b_",",","ie",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","iq","=","vec2","(","SMAA_THRESHOLD",",","SMAA_THRESHOLD",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","ir","=","vec3","(","0.2126",",","0.7152",",","0.0722",")",";","float","en","=","dot","(","GLSL_TEXTURE","(","ip",",","b_",")",".","rgb",",","ir",")",";","float","is","=","dot","(","GLSL_TEXTURE","(","ip",",","hX",".","xy",")",".","rgb",",","ir",")",";","float","it","=","dot","(","GLSL_TEXTURE","(","ip",",","hX",".","zw",")",".","rgb",",","ir",")",";","vec4","cS",";","cS",".","xy","=","abs","(","en","-","vec2","(","is",",","it",")",")",";","vec2","ih","=","step","(","iq",",","cS",".","xy",")",";","if","(","dot","(","ih",",","vec2","(","1.0",",","1.0",")",")","==","0.0",")","discard",";","float","iu","=","dot","(","GLSL_TEXTURE","(","ip",",","hY",".","xy",")",".","rgb",",","ir",")",";","float","iv","=","dot","(","GLSL_TEXTURE","(","ip",",","hY",".","zw",")",".","rgb",",","ir",")",";","cS",".","zw","=","abs","(","en","-","vec2","(","iu",",","iv",")",")",";","vec2","iw","=","max","(","cS",".","xy",",","cS",".","zw",")",";","float","ix","=","dot","(","GLSL_TEXTURE","(","ip",",","hZ",".","xy",")",".","rgb",",","ir",")",";","float","iy","=","dot","(","GLSL_TEXTURE","(","ip",",","hZ",".","zw",")",".","rgb",",","ir",")",";","cS",".","zw","=","abs","(","vec2","(","is",",","it",")","-","vec2","(","ix",",","iy",")",")",";","iw","=","max","(","iw",".","xy",",","cS",".","zw",")",";","float","iz","=","max","(","iw",".","x",",","iw",".","y",")",";","ih",".","xy","*=","step","(","iz",",","SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR","*","cS",".","xy",")",";","return","ih",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_DISABLE_DIAG_DETECTION",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","iC","(","vec2","iB",")","{","iB",".","r","=","iB",".","r","*","abs","(","5.0","*","iB",".","r","-","5.0","*","0.75",")",";","return","io","(","iB",")",";","}","vec4","iC","(","vec4","iB",")","{","iB",".","rb","=","iB",".","rb","*","abs","(","5.0","*","iB",".","rb","-","5.0","*","0.75",")",";","return","io","(","iB",")",";","}","vec2","iE","(","sampler2D","iD",",","vec2","b_",",","vec2","bD",",","out","vec2","iB",")","{","vec4","fW","=","vec4","(","b_",",","-","1.0",",","1.0",")",";","vec3","t","=","vec3","(","u_texel_size",",","1.0",")",";","for","(","int","cl","=","0",";","cl","<","SMAA_MAX_SEARCH_STEPS_DIAG",";","cl","++",")","{","if","(","fW",".","z","<","float","(","SMAA_MAX_SEARCH_STEPS_DIAG","-","1",")","&&","fW",".","w",">","0.9",")","{","fW",".","xyz","+=","t","*","vec3","(","bD",",","1.0",")",";","iB","=","GLSL_TEXTURE","(","iD",",","fW",".","xy",",","0.0",")",".","rg",";","fW",".","w","=","dot","(","iB",",","vec2","(","0.5",",","0.5",")",")",";","}","}","return","fW",".","zw",";","}","vec2","iF","(","sampler2D","iD",",","vec2","b_",",","vec2","bD",",","out","vec2","iB",")","{","vec4","fW","=","vec4","(","b_",",","-","1.0",",","1.0",")",";","fW",".","x","+=","0.25","*","u_texel_size",".","x",";","vec3","t","=","vec3","(","u_texel_size",",","1.0",")",";","for","(","int","cl","=","0",";","cl","<","SMAA_MAX_SEARCH_STEPS_DIAG",";","cl","++",")","{","if","(","fW",".","z","<","float","(","SMAA_MAX_SEARCH_STEPS_DIAG","-","1",")","&&","fW",".","w",">","0.9",")","{","fW",".","xyz","=","t","*","vec3","(","bD",",","1.0",")","+","fW",".","xyz",";","iB","=","GLSL_TEXTURE","(","iD",",","fW",".","xy",",","0.0",")",".","rg",";","iB","=","iC","(","iB",")",";","fW",".","w","=","dot","(","iB",",","vec2","(","0.5",",","0.5",")",")",";","}","}","return","fW",".","zw",";","}","vec2","iH","(","sampler2D","iG",",","vec2","aM",",","vec2","iB",",","float","fI",")","{","vec2","b_","=","vec2","(","SMAA_AREATEX_MAX_DISTANCE_DIAG",",","SMAA_AREATEX_MAX_DISTANCE_DIAG",")","*","iB","+","aM",";","b_","=","SMAA_AREATEX_PIXEL_SIZE","*","b_","+","0.5","*","SMAA_AREATEX_PIXEL_SIZE",";","b_",".","x","+=","0.5",";","b_",".","y","+=","SMAA_AREATEX_SUBTEX_SIZE","*","fI",";","return","GLSL_TEXTURE","(","iG",",","b_",",","0.0",")",".","rg",";","}","vec2","iM","(","sampler2D","iD",",","sampler2D","iG",",","vec2","b_",",","vec2","iB",",","vec4","iI",")","{","vec2","ir","=","vec2","(","0.0",",","0.0",")",";","vec4","dz",";","vec2","iJ",";","if","(","iB",".","r",">","0.0",")","{","dz",".","xz","=","iE","(","iD",",","b_",",","vec2","(","-","1.0",",","1.0",")",",","iJ",")",";","dz",".","x","+=","float","(","iJ",".","y",">","0.9",")",";","}","else","dz",".","xz","=","vec2","(","0.0",",","0.0",")",";","dz",".","yw","=","iE","(","iD",",","b_",",","vec2","(","1.0",",","-","1.0",")",",","iJ",")",";","if","(","dz",".","x","+","dz",".","y",">","2.0",")","{","vec4","iK","=","vec4","(","-","dz",".","x","+","0.25",",","dz",".","x",",","dz",".","y",",","-","dz",".","y","-","0.25",")","*","u_texel_size",".","xyxy","+","b_",".","xyxy",";","vec4","du",";","du",".","xy","=","GLSL_TEXTURE","(","iD",",","iK",".","xy","+","u_texel_size","*","vec2","(","-","1",",","0",")",",","0.0",")",".","rg",";","du",".","zw","=","GLSL_TEXTURE","(","iD",",","iK",".","zw","+","u_texel_size","*","vec2","(","1",",","0",")",",","0.0",")",".","rg",";","du",".","yxwz","=","iC","(","du",".","xyzw",")",";","vec2","iL","=","vec2","(","2.0",",","2.0",")","*","du",".","xz","+","du",".","yw",";","im","(","bvec2","(","step","(","0.9",",","dz",".","zw",")",")",",","iL",",","vec2","(","0.0",",","0.0",")",")",";","ir","+=","iH","(","iG",",","dz",".","xy",",","iL",",","iI",".","z",")",";","}","dz",".","xz","=","iF","(","iD",",","b_",",","vec2","(","-","1",",","-","1",")",",","iJ",")",";","if","(","GLSL_TEXTURE","(","iD",",","b_","+","u_texel_size","*","vec2","(","1",",","0",")",",","0.0",")",".","r",">","0.0",")","{","dz",".","yw","=","iF","(","iD",",","b_",",","vec2","(","1",",","1",")",",","iJ",")",";","dz",".","y","+=","float","(","iJ",".","y",">","0.9",")",";","}","else","dz",".","yw","=","vec2","(","0.0",",","0.0",")",";","if","(","dz",".","x","+","dz",".","y",">","2.0",")","{","vec4","iK","=","vec4","(","-","dz",".","x",",","-","dz",".","x",",","dz",".","y",",","dz",".","y",")","*","u_texel_size",".","xyxy","+","b_",".","xyxy",";","vec4","du",";","du",".","x","=","GLSL_TEXTURE","(","iD",",","iK",".","xy","+","u_texel_size","*","vec2","(","-","1",",","0",")",",","0.0",")",".","g",";","du",".","y","=","GLSL_TEXTURE","(","iD",",","iK",".","xy","+","u_texel_size","*","vec2","(","0",",","-","1",")",",","0.0",")",".","r",";","du",".","zw","=","GLSL_TEXTURE","(","iD",",","iK",".","zw","+","u_texel_size","*","vec2","(","1",",","0",")",",","0.0",")",".","gr",";","vec2","iL","=","vec2","(","2.0",",","2.0",")","*","du",".","xz","+","du",".","yw",";","im","(","bvec2","(","step","(","0.9",",","dz",".","zw",")",")",",","iL",",","vec2","(","0",",","0",")",")",";","ir","+=","iH","(","iG",",","dz",".","xy",",","iL",",","iI",".","w",")",".","gr",";","}","return","ir",";","}"]}]}}]},{TYPE:"txt",TOKENS:["float","iP","(","sampler2D","iN",",","vec2","iB",",","float","fI",")","{","vec2","hG","=","SMAA_SEARCHTEX_SIZE","*","vec2","(","0.5",",","-","1.0",")",";","vec2","iO","=","SMAA_SEARCHTEX_SIZE","*","vec2","(","fI",",","1.0",")",";","hG","+=","vec2","(","-","1.0",",","1.0",")",";","iO","+=","vec2","(","0.5",",","-","0.5",")",";","hG","*=","1.0","/","SMAA_SEARCHTEX_PACKED_SIZE",";","iO","*=","1.0","/","SMAA_SEARCHTEX_PACKED_SIZE",";","return","GLSL_TEXTURE","(","iN",",","hG","*","iB","+","iO",",","0.0",")",".","r",";","}","float","iQ","(","sampler2D","iD",",","sampler2D","iN",",","vec2","b_",",","float","iJ",")","{","vec2","iB","=","vec2","(","0.0",",","1.0",")",";","for","(","int","cl","=","0",";","cl","<","SMAA_MAX_SEARCH_STEPS",";","cl","++",")","{","if","(","b_",".","x",">","iJ","&&","iB",".","g",">","0.8281","&&","iB",".","r","==","0.0",")","{","iB","=","GLSL_TEXTURE","(","iD",",","b_",",","0.0",")",".","rg",";","b_","=","-","vec2","(","2.0",",","0.0",")","*","u_texel_size","+","b_",";","}","}","float","fI","=","-","(","255.0","/","127.0",")","*","iP","(","iN",",","iB",",","0.0",")","+","3.25",";","return","u_texel_size",".","x","*","fI","+","b_",".","x",";","}","float","iR","(","sampler2D","iD",",","sampler2D","iN",",","vec2","b_",",","float","iJ",")","{","vec2","iB","=","vec2","(","0.0",",","1.0",")",";","for","(","int","cl","=","0",";","cl","<","SMAA_MAX_SEARCH_STEPS",";","cl","++",")","{","if","(","b_",".","x","<","iJ","&&","iB",".","g",">","0.8281","&&","iB",".","r","==","0.0",")","{","iB","=","GLSL_TEXTURE","(","iD",",","b_",",","0.0",")",".","rg",";","b_","=","vec2","(","2.0",",","0.0",")","*","u_texel_size","+","b_",";","}","}","float","fI","=","-","(","255.0","/","127.0",")","*","iP","(","iN",",","iB",",","0.5",")","+","3.25",";","return","-","u_texel_size",".","x","*","fI","+","b_",".","x",";","}","float","iS","(","sampler2D","iD",",","sampler2D","iN",",","vec2","b_",",","float","iJ",")","{","vec2","iB","=","vec2","(","1.0",",","0.0",")",";","for","(","int","cl","=","0",";","cl","<","SMAA_MAX_SEARCH_STEPS",";","cl","++",")","{","if","(","b_",".","y",">","iJ","&&","iB",".","r",">","0.8281","&&","iB",".","g","==","0.0",")","{","iB","=","GLSL_TEXTURE","(","iD",",","b_",",","0.0",")",".","rg",";","b_","=","-","vec2","(","0.0",",","2.0",")","*","u_texel_size","+","b_",";","}","}","float","fI","=","-","(","255.0","/","127.0",")","*","iP","(","iN",",","iB",".","gr",",","0.0",")","+","3.25",";","return","u_texel_size",".","y","*","fI","+","b_",".","y",";","}","float","iT","(","sampler2D","iD",",","sampler2D","iN",",","vec2","b_",",","float","iJ",")","{","vec2","iB","=","vec2","(","1.0",",","0.0",")",";","for","(","int","cl","=","0",";","cl","<","SMAA_MAX_SEARCH_STEPS",";","cl","++",")","{","if","(","b_",".","y","<","iJ","&&","iB",".","r",">","0.8281","&&","iB",".","g","==","0.0",")","{","iB","=","GLSL_TEXTURE","(","iD",",","b_",",","0.0",")",".","rg",";","b_","=","vec2","(","0.0",",","2.0",")","*","u_texel_size","+","b_",";","}","}","float","fI","=","-","(","255.0","/","127.0",")","*","iP","(","iN",",","iB",".","gr",",","0.5",")","+","3.25",";","return","-","u_texel_size",".","y","*","fI","+","b_",".","y",";","}","vec2","iW","(","sampler2D","iG",",","vec2","aM",",","float","iU",",","float","iV",",","float","fI",")","{","vec2","b_","=","vec2","(","SMAA_AREATEX_MAX_DISTANCE",",","SMAA_AREATEX_MAX_DISTANCE",")","*","io","(","4.0","*","vec2","(","iU",",","iV",")",")","+","aM",";","b_","=","SMAA_AREATEX_PIXEL_SIZE","*","b_","+","0.5","*","SMAA_AREATEX_PIXEL_SIZE",";","b_",".","y","=","SMAA_AREATEX_SUBTEX_SIZE","*","fI","+","b_",".","y",";","return","GLSL_TEXTURE","(","iG",",","b_",",","0.0",")",".","rg",";","}","void","iZ","(","sampler2D","iD",",","inout","vec2","ir",",","vec4","b_",",","vec2","dz",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_DISABLE_CORNER_DETECTION",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","iX","=","step","(","dz",".","xy",",","dz",".","yx",")",";","vec2","iY","=","(","1.0","-","SMAA_CORNER_ROUNDING_NORM",")","*","iX",";","iY","/=","iX",".","x","+","iX",".","y",";","vec2","aL","=","vec2","(","1.0",",","1.0",")",";","aL",".","x","-=","iY",".","x","*","GLSL_TEXTURE","(","iD",",","b_",".","xy","+","u_texel_size","*","vec2","(","0",",","1",")",",","0.0",")",".","r",";","aL",".","x","-=","iY",".","y","*","GLSL_TEXTURE","(","iD",",","b_",".","zw","+","u_texel_size","*","vec2","(","1",",","1",")",",","0.0",")",".","r",";","aL",".","y","-=","iY",".","x","*","GLSL_TEXTURE","(","iD",",","b_",".","xy","+","u_texel_size","*","vec2","(","0",",","-","2",")",",","0.0",")",".","r",";","aL",".","y","-=","iY",".","y","*","GLSL_TEXTURE","(","iD",",","b_",".","zw","+","u_texel_size","*","vec2","(","1",",","-","2",")",",","0.0",")",".","r",";","ir","*=","clamp","(","aL",",","0.0",",","1.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}","void","i_","(","sampler2D","iD",",","inout","vec2","ir",",","vec4","b_",",","vec2","dz",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_DISABLE_CORNER_DETECTION",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","iX","=","step","(","dz",".","xy",",","dz",".","yx",")",";","vec2","iY","=","(","1.0","-","SMAA_CORNER_ROUNDING_NORM",")","*","iX",";","iY","/=","iX",".","x","+","iX",".","y",";","vec2","aL","=","vec2","(","1.0",",","1.0",")",";","aL",".","x","-=","iY",".","x","*","GLSL_TEXTURE","(","iD",",","b_",".","xy","+","u_texel_size","*","vec2","(","1",",","0",")",",","0.0",")",".","g",";","aL",".","x","-=","iY",".","y","*","GLSL_TEXTURE","(","iD",",","b_",".","zw","+","u_texel_size","*","vec2","(","1",",","1",")",",","0.0",")",".","g",";","aL",".","y","-=","iY",".","x","*","GLSL_TEXTURE","(","iD",",","b_",".","xy","+","u_texel_size","*","vec2","(","-","2",",","0",")",",","0.0",")",".","g",";","aL",".","y","-=","iY",".","y","*","GLSL_TEXTURE","(","iD",",","b_",".","zw","+","u_texel_size","*","vec2","(","-","2",",","1",")",",","0.0",")",".","g",";","ir","*=","clamp","(","aL",",","0.0",",","1.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","jc","(","vec2","b_",",","vec2","ja",",","sampler2D","iD",",","sampler2D","iG",",","sampler2D","iN",",","vec4","iI",")","{","vec4","ir","=","vec4","(","0.0",",","0.0",",","0.0",",","0.0",")",";","vec2","iB","=","GLSL_TEXTURE","(","iD",",","b_",")",".","rg",";","if","(","iB",".","g",">","0.0",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_DISABLE_DIAG_DETECTION",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["ir",".","rg","=","iM","(","iD",",","iG",",","b_",",","iB",",","iI",")",";","if","(","ir",".","r","==","-","ir",".","g",")","{"]}]}}]},{TYPE:"txt",TOKENS:["vec2","dz",";","vec3","iK",";","iK",".","x","=","iQ","(","iD",",","iN",",","hX",".","xy",",","hZ",".","x",")",";","iK",".","y","=","hY",".","y",";","dz",".","x","=","iK",".","x",";","float","iU","=","GLSL_TEXTURE","(","iD",",","iK",".","xy",",","0.0",")",".","r",";","iK",".","z","=","iR","(","iD",",","iN",",","hX",".","zw",",","hZ",".","y",")",";","dz",".","y","=","iK",".","z",";","dz","=","abs","(","io","(","dz","/","u_texel_size",".","xx","-","ja",".","xx",")",")",";","vec2","jb","=","sqrt","(","dz",")",";","float","iV","=","GLSL_TEXTURE","(","iD",",","iK",".","zy","+","u_texel_size","*","vec2","(","1",",","0",")",",","0.0",")",".","r",";","ir",".","rg","=","iW","(","iG",",","jb",",","iU",",","iV",",","iI",".","y",")",";","iK",".","y","=","b_",".","y",";","iZ","(","iD",",","ir",".","rg",",","iK",".","xyzy",",","dz",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_DISABLE_DIAG_DETECTION",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["}","else","iB",".","r","=","0.0",";"]}]}}]},{TYPE:"txt",TOKENS:["}","if","(","iB",".","r",">","0.0",")","{","vec2","dz",";","vec3","iK",";","iK",".","y","=","iS","(","iD",",","iN",",","hY",".","xy",",","hZ",".","z",")",";","iK",".","x","=","hX",".","x",";","dz",".","x","=","iK",".","y",";","float","iU","=","GLSL_TEXTURE","(","iD",",","iK",".","xy",",","0.0",")",".","g",";","iK",".","z","=","iT","(","iD",",","iN",",","hY",".","zw",",","hZ",".","w",")",";","dz",".","y","=","iK",".","z",";","dz","=","abs","(","io","(","dz","/","u_texel_size",".","yy","-","ja",".","yy",")",")",";","vec2","jb","=","sqrt","(","dz",")",";","float","iV","=","GLSL_TEXTURE","(","iD",",","iK",".","xz","+","u_texel_size","*","vec2","(","0",",","1",")",",","0.0",")",".","g",";","ir",".","ba","=","iW","(","iG",",","jb",",","iU",",","iV",",","iI",".","x",")",";","iK",".","x","=","b_",".","x",";","i_","(","iD",",","ir",".","ba",",","iK",".","xyxz",",","dz",")",";","}","return","ir",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","jl","(","vec2","b_",",","sampler2D","ip",",","sampler2D","jd"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_REPROJECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:[",","sampler2D","je"]}]}}]},{TYPE:"txt",TOKENS:[")","{","vec4","a",";","a",".","x","=","GLSL_TEXTURE","(","jd",",","hW",".","xy",")",".","a",";","a",".","y","=","GLSL_TEXTURE","(","jd",",","hW",".","zw",")",".","g",";","a",".","wz","=","GLSL_TEXTURE","(","jd",",","b_",")",".","xz",";","if","(","dot","(","a",",","vec4","(","1.0",",","1.0",",","1.0",",","1.0",")",")","<","1e-5",")","{","vec4","aQ","=","GLSL_TEXTURE","(","ip",",","b_",",","0.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_REPROJECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","jf","=","GLSL_TEXTURE","(","je",",","A",")",";","vec2","dl","=","2.0","*","jg","(","jf",")","-","1.0",";","aQ",".","a","=","sqrt","(","2.0","*","length","(","dl",")",")",";"]}]}}]},{TYPE:"txt",TOKENS:["return","aQ",";","}","else","{","bool","cj","=","max","(","a",".","x",",","a",".","z",")",">","max","(","a",".","y",",","a",".","w",")",";","vec4","jh","=","vec4","(","0.0",",","a",".","y",",","0.0",",","a",".","w",")",";","vec2","ji","=","a",".","yw",";","im","(","bvec4","(","cj",",","cj",",","cj",",","cj",")",",","jh",",","vec4","(","a",".","x",",","0.0",",","a",".","z",",","0.0",")",")",";","im","(","bvec2","(","cj",",","cj",")",",","ji",",","a",".","xz",")",";","ji","/=","dot","(","ji",",","vec2","(","1.0",",","1.0",")",")",";","vec4","jj","=","jh","*","vec4","(","u_texel_size",",","-","u_texel_size",")","+","b_",".","xyxy",";","vec4","aQ","=","ji",".","x","*","GLSL_TEXTURE","(","ip",",","jj",".","xy",",","0.0",")",";","aQ","+=","ji",".","y","*","GLSL_TEXTURE","(","ip",",","jj",".","zw",",","0.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_REPROJECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","jf","=","GLSL_TEXTURE","(","je",",","jj",".","xy",")",";","vec2","jk","=","2.0","*","jg","(","jf",")","-","1.0",";","vec2","dl","=","ji",".","x","*","jk",";","jf","=","GLSL_TEXTURE","(","je",",","jj",".","zw",")",";","jk","=","2.0","*","jg","(","jf",")","-","1.0",";","dl","+=","ji",".","y","*","jk",";","aQ",".","a","=","sqrt","(","2.0","*","length","(","dl",")",")",";"]}]}}]},{TYPE:"txt",TOKENS:["return","aQ",";","}","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_RESOLVE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","jq","(","vec2","b_",",","sampler2D","jm",",","sampler2D","jn"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_REPROJECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:[",","sampler2D","je"]}]}}]},{TYPE:"txt",TOKENS:[")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_REPROJECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","jf","=","GLSL_TEXTURE","(","je",",","A",")",";","vec2","dl",";","dl","=","2.0","*","jg","(","jf",")","-","1.0",";","vec4","jo","=","GLSL_TEXTURE","(","jm",",","b_",")",";","vec4","jp","=","GLSL_TEXTURE","(","jn",",","b_","-","dl",")",";","float","cS","=","abs","(","jo",".","a","*","jo",".","a","-","jp",".","a","*","jp",".","a",")","/","2.0",";","float","cp","=","0.5","*","clamp","(","1.0","-","sqrt","(","cS",")","*","SMAA_REPROJECTION_WEIGHT_SCALE",",","0.0",",","1.0",")",";","vec4","aQ","=","mix","(","jo",",","jp",",","cp",")",";","aQ",".","a","=","1.0",";","return","aQ",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","jo","=","GLSL_TEXTURE","(","jm",",","b_",")",";","vec4","jp","=","GLSL_TEXTURE","(","jn",",","b_",")",";","return","mix","(","jo",",","jp",",","0.5",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_EDGE_DETECTION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","aQ","=","vec4","(","iA","(","A",",","u_color"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PREDICATION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:[",","u_predication_tex"]}]}}]},{TYPE:"txt",TOKENS:[")",",","0.0",",","0.0",")",";"]}]}},{TYPE:"elif",EXPRESSION:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","aQ","=","jc","(","A",",","h_",",","u_color",",","u_area_tex",",","u_search_tex",",","u_subsample_indices",")",";"]}]}},{TYPE:"elif",EXPRESSION:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","aQ","=","jl","(","A",",","u_color",",","u_blend"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_REPROJECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:[",","u_velocity_tex"]}]}}]},{TYPE:"txt",TOKENS:[")",";"]}]}},{TYPE:"elif",EXPRESSION:["SMAA_PASS","SMAA_RESOLVE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","aQ","=","vec4","(","jq","(","A",",","u_color",",","u_color_prev"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_REPROJECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:[",","u_velocity_tex"]}]}}]},{TYPE:"txt",TOKENS:[")",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","aQ","=","GLSL_TEXTURE","(","u_color",",","A",")",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","aQ",";","}"]}]},e["postprocessing/smaa.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"SMAA_PASS",TOKENS:["SMAA_RESOLVE"]},{TYPE:"var",NAME:"AA_METHOD",TOKENS:["AA_METHOD_SMAA_LOW"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["uniform","PRECISION","vec2","u_texel_size",";","GLSL_IN","vec2","a_position",";","GLSL_OUT","vec2","A",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","hW",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","hX",";","GLSL_OUT","vec4","hY",";","GLSL_OUT","vec4","hZ",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec2","h_",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["AA_METHOD","AA_METHOD_SMAA_LOW",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_MAX_SEARCH_STEPS",TOKENS:["4"]}]}},{TYPE:"elif",EXPRESSION:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_MAX_SEARCH_STEPS",TOKENS:["8"]}]}},{TYPE:"elif",EXPRESSION:["AA_METHOD","AA_METHOD_SMAA_HIGH",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_MAX_SEARCH_STEPS",TOKENS:["16"]}]}},{TYPE:"elif",EXPRESSION:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_MAX_SEARCH_STEPS",TOKENS:["32"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_MAX_SEARCH_STEPS",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_MAX_SEARCH_STEPS",TOKENS:["16"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_EDGE_DETECTION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["void","jr","(","vec2","b_",")","{","hX","=","u_texel_size",".","xyxy","*","vec4","(","-","1.0",",","0.0",",","0.0",",","-","1.0",")","+","b_",".","xyxy",";","hY","=","u_texel_size",".","xyxy","*","vec4","(","1.0",",","0.0",",","0.0",",","1.0",")","+","b_",".","xyxy",";","hZ","=","u_texel_size",".","xyxy","*","vec4","(","-","2.0",",","0.0",",","0.0",",","-","2.0",")","+","b_",".","xyxy",";","}"]}]}},{TYPE:"elif",EXPRESSION:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["void","js","(","vec2","b_",",","out","vec2","ja",")","{","ja","=","b_","/","u_texel_size",";","hX","=","u_texel_size",".","xyxy","*","vec4","(","-","0.25",",","-","0.125",",","1.25",",","-","0.125",")","+","b_",".","xyxy",";","hY","=","u_texel_size",".","xyxy","*","vec4","(","-","0.125",",","-","0.25",",","-","0.125",",","1.25",")","+","b_",".","xyxy",";","hZ","=","u_texel_size",".","xxyy","*","vec4","(","-","2.0",",","2.0",",","-","2.0",",","2.0",")","*","float","(","SMAA_MAX_SEARCH_STEPS",")","+","vec4","(","hX",".","xz",",","hY",".","yw",")",";","}"]}]}},{TYPE:"elif",EXPRESSION:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["void","jt","(","vec2","b_",")","{","hW","=","u_texel_size",".","xyxy","*","vec4","(","1.0",",","0.0",",","0.0",",","1.0",")","+","b_",".","xyxy",";","}"]}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{","A","=","2.0","*","a_position",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_EDGE_DETECTION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["jr","(","A",")",";"]}]}},{TYPE:"elif",EXPRESSION:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["js","(","A",",","h_",")",";"]}]}},{TYPE:"elif",EXPRESSION:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["jt","(","A",")",";"]}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","vec4","(","4.0","*","(","a_position",".","xy","-","0.25",")",",","0.0",",","1.0",")",";","}"]}]},e["postprocessing/ssao.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"SSAO_WHITE",TOKENS:["0"]},{TYPE:"var",NAME:"SSAO_QUALITY",TOKENS:["SSAO_QUALITY_8"]},{TYPE:"var",NAME:"SSAO_HEMISPHERE",TOKENS:["0"]},{TYPE:"txt",TOKENS:["precision","PRECISION","sampler2D",";"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"depth_fetch.glslf"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_color",";","uniform","sampler2D","u_depth",";","uniform","sampler2D","u_ssao_special_tex",";","uniform","vec2","u_camera_range",";","uniform","vec2","u_texel_size",";","uniform","float","u_ssao_radius_increase",";","uniform","float","u_ssao_influence",";","uniform","float","u_ssao_dist_factor",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","float","ju","(","in","vec2","fW",")","{","return","gy","(","u_depth",",","fW",",","u_camera_range",")",";","}","void","main","(",")","{","vec3","gC","=","GLSL_TEXTURE","(","u_color",",","A",")",".","rgb",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_WHITE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","gC",",","1.0",")",";","return",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","jv","=","normalize","(","2.0","*","GLSL_TEXTURE","(","u_ssao_special_tex",",","A","*","0.25","/","u_texel_size",")",".","rgb","-","1.0",")",";","float","eq","=","ju","(","A",")",";","float","jw","=","eq","*","(","u_camera_range",".","y","-","u_camera_range",".","x",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_QUALITY","SSAO_QUALITY_8",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","float","jx","=","8.0",";","const","int","jy","=","1",";"]}]}},{TYPE:"elif",EXPRESSION:["SSAO_QUALITY","SSAO_QUALITY_16",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","float","jx","=","16.0",";","const","int","jy","=","2",";"]}]}},{TYPE:"elif",EXPRESSION:["SSAO_QUALITY","SSAO_QUALITY_24",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","float","jx","=","24.0",";","const","int","jy","=","3",";"]}]}},{TYPE:"elif",EXPRESSION:["SSAO_QUALITY","SSAO_QUALITY_32",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","float","jx","=","32.0",";","const","int","jy","=","4",";"]}]}}]},{TYPE:"txt",TOKENS:["float","jz","=","u_ssao_radius_increase","*","0.001",";","const","float","jA","=","1.0","+","2.4","/","jx",";","float","jB","=","0.0",";","for","(","int","cl","=","0",";","cl","<","jy",";","cl","++",")","for","(","int","x","=","-","1",";","x","<=","1",";","x","+=","2",")","for","(","int","y","=","-","1",";","y","<=","1",";","y","+=","2",")","for","(","int","z","=","-","1",";","z","<=","1",";","z","+=","2",")","{","vec3","jC","=","reflect","(","normalize","(","vec3","(","x",",","y",",","z",")",")",",","jv",")","*","(","jz","*=","jA",")",";","vec3","jD","=","vec3","(","A",",","jw",")",";","jD","+=","vec3","(","jC",".","xy",",","jC",".","z","*","jw","*","2.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_HEMISPHERE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["jD",".","z","-=","1.4","*","(","jD",".","z","-","jw",")","*","step","(","jw",",","jD",".","z",")",";"]}]}}]},{TYPE:"txt",TOKENS:["float","jE","=","ju","(","jD",".","xy",")","*","(","u_camera_range",".","y","-","u_camera_range",".","x",")",";","float","jF","=","clamp","(","(","jw","-","jE",")","/","jE",",","0.0",",","1.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_HEMISPHERE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["jB","+=","mix","(","1.0",",","jF",",","step","(","jE",",","jD",".","z",")",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["jB","+=","mix","(","step","(","jD",".","z",",","jE",")",",","0.5",",","jF",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}","jB","=","jB","/","jx",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_HEMISPHERE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["jB","=","clamp","(","jB","*","jB","+","0.6","*","jB",",","0.0",",","1.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["jB","=","clamp","(","jB","*","jB","+","jB",",","0.0",",","1.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["float","jG","=","u_ssao_influence","*","(","1.0","-","u_ssao_dist_factor","*","eq",")",";","jB","=","mix","(","1.0",",","jB",",","jG",")",";","GLSL_OUT_FRAG_COLOR","=","vec4","(","gC",",","jB",")",";","}"]}]},e["postprocessing/ssao_blur.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"SSAO_BLUR_DEPTH",TOKENS:["0"]},{TYPE:"txt",TOKENS:["precision","PRECISION","sampler2D",";"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_BLUR_DEPTH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"depth_fetch.glslf"}]}}]},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_ssao_mask",";","uniform","vec2","u_texel_size",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_BLUR_DEPTH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_depth",";","uniform","vec2","u_camera_range",";","uniform","float","u_ssao_blur_discard_value",";","float","ju","(","in","vec2","fW",")","{","return","gy","(","u_depth",",","fW",",","u_camera_range",")",";","}"]}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{","float","jH","=","0.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_BLUR_DEPTH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","jI","=","ju","(","A",")",";","float","cp","=","0.0",";","float","jJ","=","u_ssao_blur_discard_value","*","100.0",";"]}]}}]},{TYPE:"txt",TOKENS:["vec2","jK","=","vec2","(","-","2.0",")",";","for","(","int","cl","=","0",";","cl","<","4",";","++","cl",")","{","for","(","int","jL","=","0",";","jL","<","4",";","++","jL",")","{","vec2","fI","=","(","jK","+","vec2","(","float","(","cl",")",",","float","(","jL",")",")",")","*","u_texel_size",";","float","jM","=","GLSL_TEXTURE","(","u_ssao_mask",",","A","+","fI",")",".","a",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_BLUR_DEPTH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","jN","=","ju","(","A","+","fI",")",";","float","jO","=","1.0","-","clamp","(","abs","(","jN","-","jI",")","*","jJ",",","0.0",",","1.0",")",";","jH","+=","jM","*","jO",";","cp","+=","jO",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["jH","+=","jM",";"]}]}}]},{TYPE:"txt",TOKENS:["}","}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_BLUR_DEPTH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","GLSL_TEXTURE","(","u_ssao_mask",",","A",")",".","rgb",",","jH","/","cp",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","GLSL_TEXTURE","(","u_ssao_mask",",","A",")",".","rgb",",","jH","/","16.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]},e["postprocessing/stereo.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"ANAGLYPH",TOKENS:["0"]},{TYPE:"var",NAME:"SIDEBYSIDE",TOKENS:["0"]},{TYPE:"var",NAME:"EPSILON",TOKENS:["0.000001"]},{TYPE:"var",NAME:"DISTOR_SCALE",TOKENS:["0.8"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_sampler_left",";","uniform","sampler2D","u_sampler_right",";","uniform","vec2","u_texel_size",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ANAGLYPH",{TYPE:"logic_negative_expr",PLACES:1},"SIDEBYSIDE",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","int","u_enable_hmd_stereo",";","uniform","vec4","u_distortion_params",";","uniform","vec4","u_chromatic_aberration_coefs",";","void","jX","(","vec2","b_",",","vec2","ao",",","float","df",",","sampler2D","jP",")","{","vec2","bz","=","(","b_","-","ao",")","*","4.0","*","u_texel_size","[","0","]","/","u_texel_size","[","1","]","/","df",";","float","jQ","=","bz",".","x","*","bz",".","x","+","bz",".","y","*","bz",".","y",";","vec2","jR","=","bz","*","(","1.0","+","u_distortion_params","[","0","]","*","jQ","+","u_distortion_params","[","1","]","*","jQ","*","jQ",")",";","vec2","jS","=","jR","*","0.5","/","(","1.0","+","u_distortion_params","[","0","]","+","u_distortion_params","[","1","]",")",";","if","(","length","(","u_chromatic_aberration_coefs",")",">","0.0",")","{","vec2","jT","=","jS","*","(","1.0","+","u_chromatic_aberration_coefs","[","0","]","+","jQ","*","u_chromatic_aberration_coefs","[","1","]",")","+","0.5",";","vec2","jU","=","jS","+","0.5",";","vec2","jV","=","jS","*","(","1.0","+","u_chromatic_aberration_coefs","[","2","]","+","jQ","*","u_chromatic_aberration_coefs","[","3","]",")","+","0.5",";","if","(","clamp","(","jV",",","0.0",",","1.0",")","!=","jV",")","{","GLSL_OUT_FRAG_COLOR","=","vec4","(","0.0",")",";","}","else","{","vec4","jW","=","GLSL_TEXTURE","(","jP",",","jU",")",";","GLSL_OUT_FRAG_COLOR","[","0","]","=","GLSL_TEXTURE","(","jP",",","jT",")",".","x",";","GLSL_OUT_FRAG_COLOR","[","1","]","=","jW",".","y",";","GLSL_OUT_FRAG_COLOR","[","2","]","=","GLSL_TEXTURE","(","jP",",","jV",")",".","z",";","GLSL_OUT_FRAG_COLOR","[","3","]","=","jW",".","w",";","}","}","else","{","jS","+=","0.5",";","if","(","clamp","(","jS",",","0.0",",","1.0",")","!=","jS",")","{","GLSL_OUT_FRAG_COLOR","=","vec4","(","0.0",")",";","}","else","{","GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","jP",",","jS",")",";","}","}","}"]}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ANAGLYPH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","jY","=","GLSL_TEXTURE","(","u_sampler_left",",","A",")",";","vec4","jZ","=","GLSL_TEXTURE","(","u_sampler_right",",","A",")",";","vec3","j_","=","vec3","(","jY","[","0","]",",","jY","[","1","]",",","jY","[","2","]",")",";","bC","(","j_",")",";","vec3","ka","=","vec3","(","jZ","[","0","]",",","jZ","[","1","]",",","jZ","[","2","]",")",";","bC","(","ka",")",";","mat3","kb","=","mat3","(","0.437",",","-","0.062",",","-","0.048",",","0.449",",","-","0.062",",","-","0.050",",","0.164",",","-","0.024",",","-","0.017",")",";","mat3","bv","=","mat3","(","-","0.011",",","0.377",",","-","0.026",",","-","0.032",",","0.761",",","-","0.093",",","-","0.007",",","0.009",",","1.234",")",";","vec3","aQ","=","clamp","(","kb","*","j_",",","0.0",",","1.0",")","+","clamp","(","bv","*","ka",",","0.0",",","1.0",")",";","aW","(","aQ",")",";","GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",",","jY","[","3","]","+","jZ","[","3","]",")",";"]}]}},{TYPE:"elif",EXPRESSION:["SIDEBYSIDE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","A","[","0","]","<","0.5",")","{","vec2","b_","=","vec2","(","2.0","*","A","[","0","]",",","A","[","1","]",")",";","GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","u_sampler_left",",","b_",")",";","}","else","{","vec2","b_","=","vec2","(","2.0","*","(","A","[","0","]","-","0.5",")",",","A","[","1","]",")",";","GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","u_sampler_right",",","b_",")",";","}"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","u_enable_hmd_stereo","!=","0",")","{","if","(","abs","(","u_distortion_params","[","0","]",")",">","EPSILON","||","abs","(","u_distortion_params","[","1","]",")",">","EPSILON",")","if","(","A","[","0","]","<","0.5",")","{","vec2","b_","=","vec2","(","2.0","*","A","[","0","]",",","A","[","1","]",")",";","vec2","ao","=","vec2","(","0.5","-","(","u_distortion_params","[","3","]","-","0.5",")","/","2.0",",","u_distortion_params","[","2","]",")",";","float","df","=","2.0","*","u_distortion_params","[","3","]","*","DISTOR_SCALE",";","jX","(","b_",",","ao",",","df",",","u_sampler_left",")",";","}","else","{","vec2","b_","=","vec2","(","2.0","*","(","A","[","0","]","-","0.5",")",",","A","[","1","]",")",";","vec2","ao","=","vec2","(","0.5","+","(","u_distortion_params","[","3","]","-","0.5",")","/","2.0",",","u_distortion_params","[","2","]",")",";","float","df","=","2.0","*","u_distortion_params","[","3","]","*","DISTOR_SCALE",";","jX","(","b_",",","ao",",","df",",","u_sampler_right",")",";","}","else","if","(","A","[","0","]","<","0.5",")","{","vec2","b_","=","vec2","(","2.0","*","A","[","0","]",",","A","[","1","]",")",";","GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","u_sampler_left",",","b_",")",";","}","else","{","vec2","b_","=","vec2","(","2.0","*","(","A","[","0","]","-","0.5",")",",","A","[","1","]",")",";","GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","u_sampler_right",",","b_",")",";","}","}","else","{","GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","u_sampler_left",",","A",")",";","}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]},e["postprocessing/velocity.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"pack.glslf"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_depth",";","uniform","mat4","u_view_proj_inverse",";","uniform","mat4","u_view_proj_prev",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","float","eq","=","GLSL_TEXTURE","(","u_depth",",","A",")",".","x",";","vec4","kc","=","vec4","(","A","*","2.0","-","1.0",",","2.0","*","eq","-","1.0",",","1.0",")",";","vec4","cy","=","u_view_proj_inverse","*","kc",";","vec4","kd","=","cy","/","cy",".","w",";","vec4","ke","=","u_view_proj_prev","*","kd",";","ke","/=","ke",".","w",";","vec2","dl","=","(","kc",".","xy","-","ke",".","xy",")","/","4.0","+","0.5",";","dl","=","clamp","(","dl",",","0.0",",","1.0",")",";","GLSL_OUT_FRAG_COLOR","=","er","(","dl",")",";","}"]}]},e["include/blending.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"BLENDING_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"BLENDING_GLSLF",TOKENS:[""]},{TYPE:"txt",TOKENS:["vec3","kf","(","vec3","rgb",")","{","vec4","hI","=","vec4","(","_0_0",",","-","_1_0","/","3.0",",","2.0","/","3.0",",","-","_1_0",")",";","vec4","p","=","mix","(","vec4","(","rgb",".","bg",",","hI",".","wz",")",",","vec4","(","rgb",".","gb",",","hI",".","xy",")",",","step","(","rgb",".","b",",","rgb",".","g",")",")",";","vec4","q","=","mix","(","vec4","(","p",".","xyw",",","rgb",".","r",")",",","vec4","(","rgb",".","r",",","p",".","yzx",")",",","step","(","p",".","x",",","rgb",".","r",")",")",";","float","dz","=","q",".","x","-","min","(","q",".","w",",","q",".","y",")",";","float","iB","=","1.0e-10",";","return","vec3","(","abs","(","q",".","z","+","(","q",".","w","-","q",".","y",")","/","(","6.0","*","dz","+","iB",")",")",",","dz","/","(","q",".","x","+","iB",")",",","q",".","x",")",";","}","vec3","kh","(","vec3","kg",")","{","vec4","hI","=","vec4","(","_1_0",",","2.0","/","3.0",",","_1_0","/","3.0",",","3.0",")",";","vec3","p","=","abs","(","fract","(","vec3","(","kg",".","r",",","kg",".","r",",","kg",".","r",")","+","hI",".","xyz",")","*","6.0","-","hI",".","www",")",";","return","kg",".","b","*","mix","(","hI",".","xxx",",","clamp","(","p","-","hI",".","xxx",",","_0_0",",","_1_0",")",",","kg",".","g",")",";","}","vec3","kl","(","vec3","ki",",","vec3","kj",",","float","kk",")","{","return","mix","(","ki",",","kj",",","kk",")",";","}","vec3","km","(","vec3","ki",",","vec3","kj",",","float","kk",")","{","return","kk","*","ki","+","kj",";","}","vec3","kn","(","vec3","ki",",","vec3","kj",",","float","kk",")","{","return","kj","-","kk","*","ki",";","}","vec3","kp","(","vec3","ki",",","vec3","kj",",","float","kk",")","{","float","ko","=","_1_0","-","kk",";","return","(","vec3","(","ko",")","+","kk","*","ki",")","*","kj",";","}","vec3","kq","(","vec3","ki",",","vec3","kj",",","float","kk",")","{","vec3","ko","=","vec3","(","_1_0","-","kk",")",";","return","vec3","(","_1_0",")","-","(","ko","+","kk","*","(","vec3","(","_1_0",")","-","ki",")",")","*","(","vec3","(","_1_0",")","-","kj",")",";","}","vec3","kr","(","vec3","ki",",","vec3","kj",",","float","kk",")","{","vec3","ko","=","vec3","(","_1_0","-","kk",")",";","return","mix","(","kj","*","(","ko","+","2.0","*","kk","*","ki",")",",","vec3","(","_1_0",")","-","(","ko","+","2.0","*","kk","*","(","vec3","(","_1_0",")","-","ki",")",")","*","(","vec3","(","_1_0",")","-","kj",")",",","step","(","0.5",",","kj",")",")",";","}","vec3","ks","(","vec3","ki",",","vec3","kj",",","float","kk",")","{","return","mix","(","kj",",","abs","(","ki","-","kj",")",",","kk",")",";","}","vec3","kt","(","vec3","ki",",","vec3","kj",",","float","kk",")","{","return","mix","(","kj",",","kj","/","(","ki","+","step","(","ki",",","vec3","(","_0_0",")",")",")",",","kk",")",";","}","vec3","ku","(","vec3","ki",",","vec3","kj",",","float","kk",")","{","return","mix","(","kj",",","min","(","ki",",","kj",")",",","kk",")",";","}","vec3","kv","(","vec3","ki",",","vec3","kj",",","float","kk",")","{","return","max","(","kk","*","ki",",","kj",")",";","}","vec3","kz","(","vec3","ki",",","vec3","kj",",","float","kk",")","{","vec3","kw","=","kf","(","kj",")",";","if","(","kw",".","y","!=","_0_0",")","{","vec3","kx","=","kf","(","ki",")",";","vec3","ky","=","kh","(","vec3","(","kw",".","x",",","kx",".","yz",")",")",";","return","mix","(","ki",",","ky",",","kk",")",";","}","return","ki",";","}","vec3","kA","(","vec3","ki",",","vec3","kj",",","float","kk",")","{","vec3","kw","=","kf","(","ki",")",";","if","(","kw",".","y","!=","_0_0",")","{","vec3","kx","=","kf","(","kj",")",";","return","kh","(","vec3","(","kw",".","x",",","mix","(","kw",".","y",",","kx",".","y",",","kk",")",",","kw",".","z",")",")",";","}","return","ki",";","}","vec3","kB","(","vec3","ki",",","vec3","kj",",","float","kk",")","{","vec3","kw","=","kf","(","ki",")",";","vec3","kx","=","kf","(","kj",")",";","return","kh","(","vec3","(","kw",".","xy",",","mix","(","kw",".","z",",","kx",".","z",",","kk",")",")",")",";","}","vec3","kC","(","vec3","ki",",","vec3","kj",",","float","kk",")","{","vec3","kw","=","kf","(","kj",")",";","if","(","kw",".","y","!=","_0_0",")","{","vec3","kx","=","kf","(","ki",")",";","vec3","ky","=","kh","(","vec3","(","kw",".","xy",",","kx",".","z",")",")",";","return","mix","(","ki",",","ky",",","kk",")",";","}","return","ki",";","}","vec3","kE","(","vec3","ki",",","vec3","kj",",","float","kk",")","{","vec3","kD","=","vec3","(","_1_0",")","-","(","vec3","(","_1_0",")","-","kj",")","*","(","vec3","(","_1_0",")","-","ki",")",";","return","mix","(","ki",",","(","(","vec3","(","_1_0",")","-","ki",")","*","kj","*","ki",")","+","ki","*","kD",",","kk",")",";","}","vec3","kF","(","vec3","ki",",","vec3","kj",",","float","kk",")","{","return","ki","+","kk","*","(","2.0","*","kj","-","_1_0",")",";","}","float","kJ","(","float","kG",",","float","kH",",","float","kk",",","float","kI",")","{","float","ko","=","_1_0","-","kI",";","return","(","ko","+","kk","*","kG",")","*","kH",";","}","float","kK","(","float","kG",",","float","kH",",","float","kk",",","float","kI",")","{","float","ko","=","_1_0","-","kI",";","return","_1_0","-","(","ko","+","kk","*","(","_1_0","-","kG",")",")","*","(","_1_0","-","kH",")",";","}","float","kL","(","float","kG",",","float","kH",",","float","kk",",","float","kI",")","{","float","ko","=","_1_0","-","kI",";","return","mix","(","kH","*","(","ko","+","2.0","*","kk","*","kG",")",",","_1_0","-","(","ko","+","2.0","*","kk","*","(","_1_0","-","kG",")",")","*","(","_1_0","-","kH",")",",","step","(","0.5",",","kH",")",")",";","}"]}]}}]}]},e["include/caustics.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"CAUSTICS_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"CAUSTICS_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"SUN_NUM",TOKENS:["0"]},{TYPE:"var",NAME:"CAUST_SCALE",TOKENS:["0.25"]},{TYPE:"var",NAME:"CAUST_SPEED",TOKENS:["vec2","(","0.0",")"]},{TYPE:"var",NAME:"CAUST_BRIGHT",TOKENS:["0.5"]},{TYPE:"include",FILE:"procedural.glslf"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"define",NAME:"CAUSTICS_VIEW_DISTANCE",TOKENS:["100.0"]},{TYPE:"txt",TOKENS:["void","bQ","(","inout","vec3","aQ",",","float","kM",",","float","fu",",","vec4","bP",",","vec3","U",",","vec3","kN",",","vec3","kO",",","vec4","kP",",","vec3","bo",",","float","bN",")","{","if","(","bN",">","CAUSTICS_VIEW_DISTANCE",")","return",";","vec3","kQ","=","bo","+","U",";","kQ",".","xz","=","10.0","*","sin","(","0.1","*","kQ",".","xz",")",";","vec3","kS","=","T","(","kR","(","kP",")",",","kQ",")",";","vec2","b_","=","kS",".","xz",";","vec3","kT","=","kN",";","float","kU","=","max","(","dot","(","U",",","kT",")",",","0.0",")",";","float","kV","=","0.025",";","vec2","kW","=","CAUST_SPEED","*","fu",";","b_",".","s","+=","0.25","*","sin","(","dot","(","bo","+","fu",",","vec3","(","1.0",")",")",")",";","b_",".","t","+=","0.35","*","(","-","sin","(","dot","(","bo","-","fu",",","vec3","(","-","0.7",")",")",")",")",";","b_",".","st","+=","0.15","*","cos","(","4.0","*","kM","-","kW",".","x",")","+","1.5","*","sin","(","kM","-","0.3","*","kW",".","y",")",";","float","hG","=","CAUST_SCALE","*","(","1.0","+","max","(","0.1","*","kM",",","0.0",")",")",";","vec3","kY","=","kX","(","(","b_","/","hG",")",",","kV",")",";","kY","*=","CAUST_BRIGHT",";","kY","*=","kY",";","float","kZ","=","min","(","0.25","*","kM",",","-","kM",")","+","1.0",";","kZ","=","max","(","kZ",",","0.0",")",";","float","k_","=","bP","[","SUN_NUM","]","*","kU",";","float","la","=","max","(","sign","(","kM",")",",","0.0",")",";","k_","=","k_","+","max","(","0.5","*","sign","(","-","U",".","y",")","*","la",",","0.0",")",";","k_","=","min","(","k_",",","1.0",")",";","aQ","+=","kO","*","kY","*","kZ","*","k_",";","}"]}]}}]}]},e["include/color_util.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"COLOR_UTIL_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"COLOR_UTIL_GLSLF",TOKENS:[""]},{TYPE:"define",NAME:"PREMULTIPLY_ALPHA",TOKENS:["1"]},{TYPE:"var",NAME:"SRGB",TOKENS:["SRGB_NONE"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["void","bC","(","inout","float","aQ",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SRGB","SRGB_SIMPLE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aQ","=","pow","(","aQ",",","2.2",")",";"]}]}},{TYPE:"elif",EXPRESSION:["SRGB","SRGB_PROPER",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","aQ","<","0.04045",")","aQ","=","aQ","/","12.92",";","else","aQ","=","pow","(","aQ","*","(","1.0","/","1.055",")","+","0.0521327",",","2.4",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}","void","aW","(","inout","float","aQ",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SRGB","SRGB_SIMPLE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aQ","=","pow","(","aQ",",","1.0","/","2.2",")",";"]}]}},{TYPE:"elif",EXPRESSION:["SRGB","SRGB_PROPER",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","aQ","<","0.0031308",")","aQ","=","aQ","*","12.92",";","else","aQ","=","1.055","*","pow","(","aQ",",","1.0","/","2.4",")","-","0.055",";"]}]}}]},{TYPE:"txt",TOKENS:["}","void","bC","(","inout","vec3","aQ",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SRGB","SRGB_SIMPLE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aQ","=","pow","(","aQ",",","vec3","(","2.2",")",")",";"]}]}},{TYPE:"elif",EXPRESSION:["SRGB","SRGB_PROPER",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bC","(","aQ",".","r",")",";","bC","(","aQ",".","g",")",";","bC","(","aQ",".","b",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}","void","aW","(","inout","vec3","aQ",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SRGB","SRGB_SIMPLE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aQ","=","pow","(","aQ",",","vec3","(","1.0","/","2.2",")",")",";"]}]}},{TYPE:"elif",EXPRESSION:["SRGB","SRGB_PROPER",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aW","(","aQ",".","r",")",";","aW","(","aQ",".","g",")",";","aW","(","aQ",".","b",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}","void","aX","(","inout","vec3","aQ",",","in","float","L",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PREMULTIPLY_ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aQ","=","aQ","*","L",";"]}]}}]},{TYPE:"txt",TOKENS:["}","float","ge","(","vec4","aQ",")","{","vec3","lb","=","vec3","(","0.299",",","0.587",",","0.114",")",";","float","lc","=","dot","(","aQ",".","rgb",",","lb",")",";","return","lc",";","}"]}]}}]}]},e["include/coverage.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"COVERAGE_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"COVERAGE_GLSLF",TOKENS:[""]},{TYPE:"include",FILE:"procedural.glslf"},{TYPE:"txt",TOKENS:["const","float","ld","=","1000.0",";","bool","C","(","float","L",",","float","le",")","{","if","(","le","<","0.0",")","L","=","1.0","-","L",";","float","lf","=","floor","(","L","*","ld",")",";","float","lh","=","floor","(","lg","(","gl_FragCoord",".","xy",")","*","ld",")",";","if","(","le",">","0.0",")","return","lh","<","lf",";","else","return","lh",">=","lf",";","}"]}]}}]}]},e["include/depth_fetch.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"DEPTH_FETCH_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"DEPTH_FETCH_GLSLF",TOKENS:[""]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"CAMERA_TYPE",TOKENS:["CAM_TYPE_PERSP"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_CASTING",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","ep","(","in","float","li",",","in","vec2","lj",")","{","float","dD","=","lj",".","x",";","float","lk","=","lj",".","y",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CAMERA_TYPE","CAM_TYPE_PERSP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","lk","*","(","1.0","-","dD","/","li",")","/","(","lk","-","dD",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","(","li","-","dD",")","/","(","lk","-","dD",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","gy","(","in","sampler2D","ll",",","in","vec2","fW",",","in","vec2","lj",")","{","float","eq","=","GLSL_TEXTURE","(","ll",",","fW",")",".","r",";","float","dD","=","lj",".","x",";","float","lk","=","lj",".","y",";","float","li","=","2.0","*","dD","/","(","dD","+","lk","-","(","2.0","*","eq","-","1.0",")","*","(","lk","-","dD",")",")",";","return","li",";","}"]}]}}]}]}}]}]},e["include/dynamic_grass.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"DYNAMIC_GRASS_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"DYNAMIC_GRASS_GLSLV",TOKENS:[""]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"DYNAMIC_GRASS",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD",TOKENS:["0"]},{TYPE:"var",NAME:"GRASS_TEXTURE_SIZE",TOKENS:["1024.0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"txt",TOKENS:["vec2","lp","(","vec3","O",",","float","lm",",","vec2","ln",")","{","vec2","lo","=","vec2","(","(","O",".","x","-","ln",".","x",")","/","lm",",","(","O",".","y","-","ln",".","y",")","/","lm",")",";","return","fract","(","lo",")",";","}","vec2","lq","(","vec2","gT",",","float","lm",",","vec2","ln",")","{","return","vec2","(","gT",".","x","*","lm",",","gT",".","y","*","lm",")","+","ln",";","}","au","lr","(",")","{","return","au","(","vec3","(","-","10000.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",")",";","}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL3"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","lB","(","sampler2D","ls",",","vec2","lt",")","{","float","lu","=","1.0","/","GRASS_TEXTURE_SIZE",";","vec4","lv","=","GLSL_TEXTURE","(","ls",",","lt",")",";","vec4","lw","=","GLSL_TEXTURE","(","ls",",","lt","+","vec2","(","lu",",","0.0",")",")",";","vec4","lx","=","GLSL_TEXTURE","(","ls",",","lt","+","vec2","(","0.0",",","lu",")",")",";","vec4","ly","=","GLSL_TEXTURE","(","ls",",","lt","+","vec2","(","lu",",","lu",")",")",";","float","a","=","fract","(","lt",".","x","*","GRASS_TEXTURE_SIZE",")",";","vec4","lz","=","mix","(","lv",",","lw",",","a",")",";","vec4","lA","=","mix","(","lx",",","ly",",","a",")",";","float","b","=","fract","(","lt",".","y","*","GRASS_TEXTURE_SIZE",")",";","return","mix","(","lz",",","lA",",","b",")",";","}"]}]}}]},{TYPE:"txt",TOKENS:["au","aZ","(","vec3","O",",","vec3","V",",","vec3","lC",",","vec3","W",",","vec3","U",",","vec3","ao",",","PRECISION","sampler2D","lD",",","sampler2D","lE",",","vec3","lF",",","float","lG",",","vec3","lH",",","vec4","lI",",","mat3","N",",","mat3","Z",")","{","vec3","lJ","=","T","(","lI",",","vec3","(","0.0",",","0.0",",","-","1.0",")",")",";","float","lK","=","-","lJ",".","x",";","float","lL","=","lJ",".","y",";","vec2","ln","=","vec2","(","lH",".","x","-","lG","*","(","1.0","+","lK",")","/","2.0",",","lH",".","y","-","lG","*","(","1.0","-","lL",")","/","2.0",")",";","vec2","lM","=","lp","(","ao",",","lG",",","ln",")",";","float","lN","=","lG","/","2.0",";","vec2","lO","=","abs","(","lq","(","lM","-","vec2","(","0.5",")",",","lG",",","vec2","(","0.0",")",")",")",";","float","lP","=","lN","*","(","1.0","+","sqrt","(","2.0",")",")","/","2.0",";","if","(","length","(","lO",")",">","lP",")","return","lr","(",")",";","float","lQ","=","lG","/","lF",".","z",";","vec2","lR","=","(","lM","-","vec2","(","0.5",")",")","*","lQ","+","vec2","(","0.5",")",";","vec3","lS","=","lJ","*","(","lG","/","lF",".","z","-","1.0",")","/","2.0",";","lR",".","x","+=","lS",".","x",";","lR",".","y","+=","lS",".","y",";","vec4","lT","=","GLSL_TEXTURE","(","lE",",","lR",")",";","float","hG","=","lT",".","r",";","if","(","hG","<","u_scale_threshold",")","return","lr","(",")",";","float","lU","=","lF",".","y","-","lF",".","x",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL3"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","ci","=","lF",".","y","-","(","lB","(","lD",",","lR",")",")",".","r","*","lU",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","ci","=","lF",".","y","-","(","GLSL_TEXTURE","(","lD",",","lR",")",")",".","r","*","lU",";"]}]}}]},{TYPE:"txt",TOKENS:["vec2","lV","=","O",".","xy","-","ao",".","xy",";","ao",".","xy","=","lq","(","lM",",","lG",",","ln",")",";","ao",".","z","=","ci",";","O",".","xy","=","ao",".","xy","+","lV",";","O",".","z","*=","hG",";","O",".","z","+=","ci",";","vec3","aQ","=","lT",".","gba",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["O","-=","ao",";","mat3","lW","=","as","(","lH",",","ao",",","N",",","Z",")",";","au","aw","=","av","(","O",",","ao",",","V",",","lC",",","W",",","U",",","lW",")",";","aw",".","ao","=","ao",";","aw",".","aQ","=","aQ",";","return","lX","(","aw",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","lX","(","au","(","O",",","ao",",","V",",","lC",",","W",",","U",",","aQ",")",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]}]}}]}]},e["include/environment.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"ENVIRONMENT_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"ENVIRONMENT_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"USE_ENVIRONMENT_LIGHT",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_TEXTURE",TOKENS:["0"]},{TYPE:"txt",TOKENS:["vec3","cz","(","vec3","U",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_ENVIRONMENT_LIGHT"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKY_TEXTURE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","GLSL_TEXTURE_CUBE","(","u_sky_texture",",","U",")",".","rgb",";"]}]}},{TYPE:"elif",EXPRESSION:["SKY_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","lY","=","0.5","*","U",".","z","+","0.5",";","return","mix","(","u_horizon_color",",","u_zenith_color",",","lY",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","vec3","(","1.0",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","vec3","(","0.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]}]},e["include/fog.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FOG_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FOG_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"USE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"FOG_TYPE",TOKENS:["QUADRATIC"]},{TYPE:"var",NAME:"PROCEDURAL_FOG",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["void","mc","(","inout","vec3","aQ",",","in","float","lZ",",","in","float","ci",",","in","vec4","l_",")","{","float","ma","=","clamp","(","(","lZ","-","u_fog_params",".","z",")","/","u_fog_params",".","y",",","0.0",",","1.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FOG_TYPE","QUADRATIC",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["ma","*=","ma",";"]}]}},{TYPE:"elif",EXPRESSION:["FOG_TYPE","LINEAR",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[]}},{TYPE:"elif",EXPRESSION:["FOG_TYPE","INVERSE_QUADRATIC",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["ma","=","sqrt","(","ma",")",";"]}]}}]},{TYPE:"txt",TOKENS:["if","(","u_fog_params",".","w",">","0.0",")","{","if","(","ci",">","u_fog_params",".","w",")","ma","=","0.0",";","else","{","float","mb","=","(","u_fog_params",".","w","-","max","(","ci",",","0.0",")",")","/","u_fog_params",".","w",";","ma","*=","mb","*","mb",";","}","}","l_",".","a","=","1.0","-","(","1.0","-","ma",")","*","(","1.0","-","u_fog_params",".","x",")",";","aQ","=","mix","(","aQ",",","l_",".","rgb",",","l_",".","a",")",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","mh","(","in","mat4","md",",","in","vec3","D",")","{","vec3","me","=","mix","(","md","[","0","]",".","rgb",",","md","[","1","]",".","rgb",",","(","D",".","x","+","1.0",")","/","2.0",")",";","vec3","mf","=","mix","(","md","[","2","]",".","rgb",",","md","[","3","]",".","rgb",",","(","D",".","y","+","1.0",")","/","2.0",")",";","vec3","mg","=","vec3","(","md","[","0","]",".","a",",","md","[","1","]",".","a",",","md","[","2","]",".","a",")",";","vec3","aQ","=","mix","(","me",",","mf",",","abs","(","D",".","y",")",")",";","aQ","=","mix","(","aQ",",","mg",",","abs","(","D",".","z",")",")",";","bC","(","aQ",")",";","return","aQ",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["void","mj","(","inout","float","mi",")","{","mi","-=","0.5",";","mi","=","4.0","*","(","mi","*","mi","*","mi",")","+","0.5",";","}","void","mp","(","inout","vec3","aQ",",","in","float","lZ",",","in","vec3","D",",","in","float","eC",",","in","vec4","mk",",","in","float","fl",")","{","float","ml","=","max","(","D",".","z",",","0.0",")",";","float","mm","=","max","(","lZ","-","max","(","eC","/","ml",",","0.0",")",",","0.0",")",";","float","mn","=","mk",".","w","*","mm",";","vec3","eD","=","vec3","(","0.0",",","0.02",",","0.05",")",";","vec3","mo","=","mk",".","rgb",";","mn","=","min","(","mn",",","1.0",")",";","mj","(","mn",")",";","mn","*=","clamp","(","2.0","-","fl",",","0.0",",","1.0",")",";","vec3","eE","=","mix","(","mo",",","eD",",","min","(","ml",",","1.0",")",")",";","eC","=","clamp","(","-","eC","*","0.03",",","0.0",",","0.8",")",";","eE","*=","1.0","-","eC",";","aQ","=","mix","(","aQ",",","eE",",","mn",")",";","}"]}]}}]},{TYPE:"txt",TOKENS:["void","bR","(","inout","vec3","aQ",",","float","lZ",",","vec3","D",",","float","bO",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","md","=","mh","(","u_cube_fog",",","D",")",";","vec4","eE","=","vec4","(","md",",","u_fog_color_density",".","a",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","eE","=","u_fog_color_density",";"]}]}}]},{TYPE:"txt",TOKENS:["mc","(","aQ",",","lZ",",","h",".","z",",","eE",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mp","(","aQ",",","lZ",",","D",",","u_cam_water_depth",",","u_underwater_fog_color_density",",","bO",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]}]},e["include/fxaa.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"FXAA_BLEND4WEB",TOKENS:["1"]},{TYPE:"var",NAME:"FXAA_QUALITY_P12",TOKENS:["0.0"]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_PS3",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_PS3",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_360",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_360",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_360_OPT",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_360_OPT",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_PC",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_PC",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_PC_CONSOLE",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_PC_CONSOLE",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_GLSL_120",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_GLSL_120",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_GLSL_130",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_GLSL_130",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_HLSL_3",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_HLSL_3",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_HLSL_4",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_HLSL_4",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_HLSL_5",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_HLSL_5",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_GREEN_AS_LUMA",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_GREEN_AS_LUMA",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_EARLY_EXIT",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_EARLY_EXIT",TOKENS:["1"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_DISCARD",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_DISCARD",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_FAST_PIXEL_OFFSET",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifdef",NAME:"GL_EXT_gpu_shader4",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_FAST_PIXEL_OFFSET",TOKENS:["1"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifdef",NAME:"GL_NV_gpu_shader5",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_FAST_PIXEL_OFFSET",TOKENS:["1"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifdef",NAME:"GL_ARB_gpu_shader5",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_FAST_PIXEL_OFFSET",TOKENS:["1"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_FAST_PIXEL_OFFSET",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_FAST_PIXEL_OFFSET",TOKENS:["0"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_GATHER4_ALPHA",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_HLSL_5",1,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_GATHER4_ALPHA",TOKENS:["1"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifdef",NAME:"GL_ARB_gpu_shader5",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_GATHER4_ALPHA",TOKENS:["1"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifdef",NAME:"GL_NV_gpu_shader5",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_GATHER4_ALPHA",TOKENS:["1"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_GATHER4_ALPHA",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_GATHER4_ALPHA",TOKENS:["0"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:[1],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:[0],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",TOKENS:["4.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:[0],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",TOKENS:["2.0"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:[1],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",TOKENS:["0.125"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",TOKENS:["0.25"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_QUALITY_PRESET",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PRESET",TOKENS:["12"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",10,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["3"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["3.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["12.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",11,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["4"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["3.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["12.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",12,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["12.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",13,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["6"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["12.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",14,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["7"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P6",TOKENS:["12.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",15,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["8"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P6",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P7",TOKENS:["12.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",20,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["3"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",21,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["4"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",22,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",23,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["6"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",24,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["7"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["3.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P6",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",25,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["8"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P6",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P7",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",26,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["9"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P6",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P7",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P8",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",27,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["10"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P6",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P7",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P8",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P9",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",28,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["11"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P6",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P7",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P8",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P9",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P10",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",29,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["12"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P6",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P7",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P8",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P9",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P10",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P11",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",39,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["12"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P6",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P7",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P8",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P9",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P10",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P11",TOKENS:["8.0"]}]}}]},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:["float","mq","(","float","x",")","{","return","clamp","(","x",",","0.0",",","1.0",")",";","}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_BLEND4WEB",1,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","mr","(","sampler2D","t",",","vec2","p",")","{","return","GLSL_TEXTURE","(","t",",","p",")",";","}","vec4","mt","(","sampler2D","t",",","vec2","p",",","vec2","ms",",","vec2","r",")","{","return","GLSL_TEXTURE","(","t",",","p","+","(","ms","*","r",")",")",";","}"]}]}}]},{TYPE:"txt",TOKENS:["vec4","gv","(","vec2","fn",",","sampler2D","ia",",","vec2","mu",",","float","mv",",","float","mw",",","float","mx",")","{","vec2","my",";","my",".","x","=","fn",".","x",";","my",".","y","=","fn",".","y",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_GATHER4_ALPHA",1,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","mz","=","mr","(","ia",",","my",")",";","float","gf","=","ge","(","mz",")",";","float","mA","=","ge","(","mt","(","ia",",","my",",","vec2","(","0",",","1",")",",","mu",".","xy",")",")",";","float","mB","=","ge","(","mt","(","ia",",","my",",","vec2","(","1",",","0",")",",","mu",".","xy",")",")",";","float","mC","=","ge","(","mt","(","ia",",","my",",","vec2","(","0",",","-","1",")",",","mu",".","xy",")",")",";","float","mD","=","ge","(","mt","(","ia",",","my",",","vec2","(","-","1",",","0",")",",","mu",".","xy",")",")",";"]}]}}]},{TYPE:"txt",TOKENS:["float","mE","=","max","(","mA",",","gf",")",";","float","mF","=","min","(","mA",",","gf",")",";","float","mG","=","max","(","mB",",","mE",")",";","float","mH","=","min","(","mB",",","mF",")",";","float","mI","=","max","(","mC",",","mD",")",";","float","mJ","=","min","(","mC",",","mD",")",";","float","mK","=","max","(","mI",",","mG",")",";","float","mL","=","min","(","mJ",",","mH",")",";","float","mM","=","mK","*","mw",";","float","mN","=","mK","-","mL",";","float","mO","=","max","(","mx",",","mM",")",";","bool","mP","=","mN","<","mO",";","if","(","mP",")","return","mz",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_GATHER4_ALPHA",0,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","gh","=","ge","(","mt","(","ia",",","my",",","vec2","(","-","1",",","-","1",")",",","mu",".","xy",")",")",";","float","gk","=","ge","(","mt","(","ia",",","my",",","vec2","(","1",",","1",")",",","mu",".","xy",")",")",";","float","gi","=","ge","(","mt","(","ia",",","my",",","vec2","(","1",",","-","1",")",",","mu",".","xy",")",")",";","float","gj","=","ge","(","mt","(","ia",",","my",",","vec2","(","-","1",",","1",")",",","mu",".","xy",")",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[]}}]},{TYPE:"txt",TOKENS:["float","mQ","=","mC","+","mA",";","float","mR","=","mD","+","mB",";","float","mS","=","1.0","/","mN",";","float","mT","=","mQ","+","mR",";","float","mU","=","(","-","2.0","*","gf",")","+","mQ",";","float","mV","=","(","-","2.0","*","gf",")","+","mR",";","float","mW","=","gi","+","gk",";","float","mX","=","gh","+","gi",";","float","mY","=","(","-","2.0","*","mB",")","+","mW",";","float","mZ","=","(","-","2.0","*","mC",")","+","mX",";","float","m_","=","gh","+","gj",";","float","na","=","gj","+","gk",";","float","nb","=","(","abs","(","mU",")","*","2.0",")","+","abs","(","mY",")",";","float","nc","=","(","abs","(","mV",")","*","2.0",")","+","abs","(","mZ",")",";","float","nd","=","(","-","2.0","*","mD",")","+","m_",";","float","ne","=","(","-","2.0","*","mA",")","+","na",";","float","nf","=","abs","(","nd",")","+","nb",";","float","ng","=","abs","(","ne",")","+","nc",";","float","nh","=","m_","+","mW",";","float","ni","=","mu",".","x",";","bool","nj","=","nf",">=","ng",";","float","nk","=","mT","*","2.0","+","nh",";","if","(","!","nj",")","mC","=","mD",";","if","(","!","nj",")","mA","=","mB",";","if","(","nj",")","ni","=","mu",".","y",";","float","nl","=","(","nk","*","(","1.0","/","12.0",")",")","-","gf",";","float","nm","=","mC","-","gf",";","float","nn","=","mA","-","gf",";","float","no","=","mC","+","gf",";","float","np","=","mA","+","gf",";","bool","nq","=","abs","(","nm",")",">=","abs","(","nn",")",";","float","nr","=","max","(","abs","(","nm",")",",","abs","(","nn",")",")",";","if","(","nq",")","ni","=","-","ni",";","float","ns","=","mq","(","abs","(","nl",")","*","mS",")",";","vec2","nt",";","nt",".","x","=","my",".","x",";","nt",".","y","=","my",".","y",";","vec2","nu",";","nu",".","x","=","(","!","nj",")","?","0.0",":","mu",".","x",";","nu",".","y","=","(","nj",")","?","0.0",":","mu",".","y",";","if","(","!","nj",")","nt",".","x","+=","ni","*","0.5",";","if","(","nj",")","nt",".","y","+=","ni","*","0.5",";","vec2","nv",";","nv",".","x","=","nt",".","x","-","nu",".","x","*","FXAA_QUALITY_P0",";","nv",".","y","=","nt",".","y","-","nu",".","y","*","FXAA_QUALITY_P0",";","vec2","nw",";","nw",".","x","=","nt",".","x","+","nu",".","x","*","FXAA_QUALITY_P0",";","nw",".","y","=","nt",".","y","+","nu",".","y","*","FXAA_QUALITY_P0",";","float","nx","=","(","(","-","2.0",")","*","ns",")","+","3.0",";","float","ny","=","ge","(","mr","(","ia",",","nv",")",")",";","float","nz","=","ns","*","ns",";","float","nA","=","ge","(","mr","(","ia",",","nw",")",")",";","if","(","!","nq",")","no","=","np",";","float","nB","=","nr","*","1.0","/","4.0",";","float","nC","=","gf","-","no","*","0.5",";","float","nD","=","nx","*","nz",";","bool","nE","=","nC","<","0.0",";","ny","-=","no","*","0.5",";","nA","-=","no","*","0.5",";","bool","nF","=","abs","(","ny",")",">=","nB",";","bool","nG","=","abs","(","nA",")",">=","nB",";","if","(","!","nF",")","nv",".","x","-=","nu",".","x","*","FXAA_QUALITY_P1",";","if","(","!","nF",")","nv",".","y","-=","nu",".","y","*","FXAA_QUALITY_P1",";","bool","nH","=","(","!","nF",")","||","(","!","nG",")",";","if","(","!","nG",")","nw",".","x","+=","nu",".","x","*","FXAA_QUALITY_P1",";","if","(","!","nG",")","nw",".","y","+=","nu",".","y","*","FXAA_QUALITY_P1",";","if","(","nH",")","{","if","(","!","nF",")","ny","=","ge","(","mr","(","ia",",","nv",".","xy",")",")",";","if","(","!","nG",")","nA","=","ge","(","mr","(","ia",",","nw",".","xy",")",")",";","if","(","!","nF",")","ny","=","ny","-","no","*","0.5",";","if","(","!","nG",")","nA","=","nA","-","no","*","0.5",";","nF","=","abs","(","ny",")",">=","nB",";","nG","=","abs","(","nA",")",">=","nB",";","if","(","!","nF",")","nv",".","x","-=","nu",".","x","*","FXAA_QUALITY_P2",";","if","(","!","nF",")","nv",".","y","-=","nu",".","y","*","FXAA_QUALITY_P2",";","nH","=","(","!","nF",")","||","(","!","nG",")",";","if","(","!","nG",")","nw",".","x","+=","nu",".","x","*","FXAA_QUALITY_P2",";","if","(","!","nG",")","nw",".","y","+=","nu",".","y","*","FXAA_QUALITY_P2",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",3,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","nH",")","{","if","(","!","nF",")","ny","=","ge","(","mr","(","ia",",","nv",".","xy",")",")",";","if","(","!","nG",")","nA","=","ge","(","mr","(","ia",",","nw",".","xy",")",")",";","if","(","!","nF",")","ny","=","ny","-","no","*","0.5",";","if","(","!","nG",")","nA","=","nA","-","no","*","0.5",";","nF","=","abs","(","ny",")",">=","nB",";","nG","=","abs","(","nA",")",">=","nB",";","if","(","!","nF",")","nv",".","x","-=","nu",".","x","*","FXAA_QUALITY_P3",";","if","(","!","nF",")","nv",".","y","-=","nu",".","y","*","FXAA_QUALITY_P3",";","nH","=","(","!","nF",")","||","(","!","nG",")",";","if","(","!","nG",")","nw",".","x","+=","nu",".","x","*","FXAA_QUALITY_P3",";","if","(","!","nG",")","nw",".","y","+=","nu",".","y","*","FXAA_QUALITY_P3",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",4,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","nH",")","{","if","(","!","nF",")","ny","=","ge","(","mr","(","ia",",","nv",".","xy",")",")",";","if","(","!","nG",")","nA","=","ge","(","mr","(","ia",",","nw",".","xy",")",")",";","if","(","!","nF",")","ny","=","ny","-","no","*","0.5",";","if","(","!","nG",")","nA","=","nA","-","no","*","0.5",";","nF","=","abs","(","ny",")",">=","nB",";","nG","=","abs","(","nA",")",">=","nB",";","if","(","!","nF",")","nv",".","x","-=","nu",".","x","*","FXAA_QUALITY_P4",";","if","(","!","nF",")","nv",".","y","-=","nu",".","y","*","FXAA_QUALITY_P4",";","nH","=","(","!","nF",")","||","(","!","nG",")",";","if","(","!","nG",")","nw",".","x","+=","nu",".","x","*","FXAA_QUALITY_P4",";","if","(","!","nG",")","nw",".","y","+=","nu",".","y","*","FXAA_QUALITY_P4",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",5,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","nH",")","{","if","(","!","nF",")","ny","=","ge","(","mr","(","ia",",","nv",".","xy",")",")",";","if","(","!","nG",")","nA","=","ge","(","mr","(","ia",",","nw",".","xy",")",")",";","if","(","!","nF",")","ny","=","ny","-","no","*","0.5",";","if","(","!","nG",")","nA","=","nA","-","no","*","0.5",";","nF","=","abs","(","ny",")",">=","nB",";","nG","=","abs","(","nA",")",">=","nB",";","if","(","!","nF",")","nv",".","x","-=","nu",".","x","*","FXAA_QUALITY_P5",";","if","(","!","nF",")","nv",".","y","-=","nu",".","y","*","FXAA_QUALITY_P5",";","nH","=","(","!","nF",")","||","(","!","nG",")",";","if","(","!","nG",")","nw",".","x","+=","nu",".","x","*","FXAA_QUALITY_P5",";","if","(","!","nG",")","nw",".","y","+=","nu",".","y","*","FXAA_QUALITY_P5",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",6,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","nH",")","{","if","(","!","nF",")","ny","=","ge","(","mr","(","ia",",","nv",".","xy",")",")",";","if","(","!","nG",")","nA","=","ge","(","mr","(","ia",",","nw",".","xy",")",")",";","if","(","!","nF",")","ny","=","ny","-","no","*","0.5",";","if","(","!","nG",")","nA","=","nA","-","no","*","0.5",";","nF","=","abs","(","ny",")",">=","nB",";","nG","=","abs","(","nA",")",">=","nB",";","if","(","!","nF",")","nv",".","x","-=","nu",".","x","*","FXAA_QUALITY_P6",";","if","(","!","nF",")","nv",".","y","-=","nu",".","y","*","FXAA_QUALITY_P6",";","nH","=","(","!","nF",")","||","(","!","nG",")",";","if","(","!","nG",")","nw",".","x","+=","nu",".","x","*","FXAA_QUALITY_P6",";","if","(","!","nG",")","nw",".","y","+=","nu",".","y","*","FXAA_QUALITY_P6",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",7,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","nH",")","{","if","(","!","nF",")","ny","=","ge","(","mr","(","ia",",","nv",".","xy",")",")",";","if","(","!","nG",")","nA","=","ge","(","mr","(","ia",",","nw",".","xy",")",")",";","if","(","!","nF",")","ny","=","ny","-","no","*","0.5",";","if","(","!","nG",")","nA","=","nA","-","no","*","0.5",";","nF","=","abs","(","ny",")",">=","nB",";","nG","=","abs","(","nA",")",">=","nB",";","if","(","!","nF",")","nv",".","x","-=","nu",".","x","*","FXAA_QUALITY_P7",";","if","(","!","nF",")","nv",".","y","-=","nu",".","y","*","FXAA_QUALITY_P7",";","nH","=","(","!","nF",")","||","(","!","nG",")",";","if","(","!","nG",")","nw",".","x","+=","nu",".","x","*","FXAA_QUALITY_P7",";","if","(","!","nG",")","nw",".","y","+=","nu",".","y","*","FXAA_QUALITY_P7",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",8,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","nH",")","{","if","(","!","nF",")","ny","=","ge","(","mr","(","ia",",","nv",".","xy",")",")",";","if","(","!","nG",")","nA","=","ge","(","mr","(","ia",",","nw",".","xy",")",")",";","if","(","!","nF",")","ny","=","ny","-","no","*","0.5",";","if","(","!","nG",")","nA","=","nA","-","no","*","0.5",";","nF","=","abs","(","ny",")",">=","nB",";","nG","=","abs","(","nA",")",">=","nB",";","if","(","!","nF",")","nv",".","x","-=","nu",".","x","*","FXAA_QUALITY_P8",";","if","(","!","nF",")","nv",".","y","-=","nu",".","y","*","FXAA_QUALITY_P8",";","nH","=","(","!","nF",")","||","(","!","nG",")",";","if","(","!","nG",")","nw",".","x","+=","nu",".","x","*","FXAA_QUALITY_P8",";","if","(","!","nG",")","nw",".","y","+=","nu",".","y","*","FXAA_QUALITY_P8",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",9,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","nH",")","{","if","(","!","nF",")","ny","=","ge","(","mr","(","ia",",","nv",".","xy",")",")",";","if","(","!","nG",")","nA","=","ge","(","mr","(","ia",",","nw",".","xy",")",")",";","if","(","!","nF",")","ny","=","ny","-","no","*","0.5",";","if","(","!","nG",")","nA","=","nA","-","no","*","0.5",";","nF","=","abs","(","ny",")",">=","nB",";","nG","=","abs","(","nA",")",">=","nB",";","if","(","!","nF",")","nv",".","x","-=","nu",".","x","*","FXAA_QUALITY_P9",";","if","(","!","nF",")","nv",".","y","-=","nu",".","y","*","FXAA_QUALITY_P9",";","nH","=","(","!","nF",")","||","(","!","nG",")",";","if","(","!","nG",")","nw",".","x","+=","nu",".","x","*","FXAA_QUALITY_P9",";","if","(","!","nG",")","nw",".","y","+=","nu",".","y","*","FXAA_QUALITY_P9",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",10,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","nH",")","{","if","(","!","nF",")","ny","=","ge","(","mr","(","ia",",","nv",".","xy",")",")",";","if","(","!","nG",")","nA","=","ge","(","mr","(","ia",",","nw",".","xy",")",")",";","if","(","!","nF",")","ny","=","ny","-","no","*","0.5",";","if","(","!","nG",")","nA","=","nA","-","no","*","0.5",";","nF","=","abs","(","ny",")",">=","nB",";","nG","=","abs","(","nA",")",">=","nB",";","if","(","!","nF",")","nv",".","x","-=","nu",".","x","*","FXAA_QUALITY_P10",";","if","(","!","nF",")","nv",".","y","-=","nu",".","y","*","FXAA_QUALITY_P10",";","nH","=","(","!","nF",")","||","(","!","nG",")",";","if","(","!","nG",")","nw",".","x","+=","nu",".","x","*","FXAA_QUALITY_P10",";","if","(","!","nG",")","nw",".","y","+=","nu",".","y","*","FXAA_QUALITY_P10",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",11,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","nH",")","{","if","(","!","nF",")","ny","=","ge","(","mr","(","ia",",","nv",".","xy",")",")",";","if","(","!","nG",")","nA","=","ge","(","mr","(","ia",",","nw",".","xy",")",")",";","if","(","!","nF",")","ny","=","ny","-","no","*","0.5",";","if","(","!","nG",")","nA","=","nA","-","no","*","0.5",";","nF","=","abs","(","ny",")",">=","nB",";","nG","=","abs","(","nA",")",">=","nB",";","if","(","!","nF",")","nv",".","x","-=","nu",".","x","*","FXAA_QUALITY_P11",";","if","(","!","nF",")","nv",".","y","-=","nu",".","y","*","FXAA_QUALITY_P11",";","nH","=","(","!","nF",")","||","(","!","nG",")",";","if","(","!","nG",")","nw",".","x","+=","nu",".","x","*","FXAA_QUALITY_P11",";","if","(","!","nG",")","nw",".","y","+=","nu",".","y","*","FXAA_QUALITY_P11",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",12,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","nH",")","{","if","(","!","nF",")","ny","=","ge","(","mr","(","ia",",","nv",".","xy",")",")",";","if","(","!","nG",")","nA","=","ge","(","mr","(","ia",",","nw",".","xy",")",")",";","if","(","!","nF",")","ny","=","ny","-","no","*","0.5",";","if","(","!","nG",")","nA","=","nA","-","no","*","0.5",";","nF","=","abs","(","ny",")",">=","nB",";","nG","=","abs","(","nA",")",">=","nB",";","if","(","!","nF",")","nv",".","x","-=","nu",".","x","*","FXAA_QUALITY_P12",";","if","(","!","nF",")","nv",".","y","-=","nu",".","y","*","FXAA_QUALITY_P12",";","nH","=","(","!","nF",")","||","(","!","nG",")",";","if","(","!","nG",")","nw",".","x","+=","nu",".","x","*","FXAA_QUALITY_P12",";","if","(","!","nG",")","nw",".","y","+=","nu",".","y","*","FXAA_QUALITY_P12",";","}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}","float","nI","=","my",".","x","-","nv",".","x",";","float","nJ","=","nw",".","x","-","my",".","x",";","if","(","!","nj",")","nI","=","my",".","y","-","nv",".","y",";","if","(","!","nj",")","nJ","=","nw",".","y","-","my",".","y",";","bool","nK","=","(","ny","<","0.0",")","!=","nE",";","float","nL","=","(","nJ","+","nI",")",";","bool","nM","=","(","nA","<","0.0",")","!=","nE",";","float","nN","=","1.0","/","nL",";","bool","nO","=","nI","<","nJ",";","float","nP","=","min","(","nI",",","nJ",")",";","bool","nQ","=","nO","?","nK",":","nM",";","float","nR","=","nD","*","nD",";","float","nS","=","(","nP","*","(","-","nN",")",")","+","0.5",";","float","nT","=","nR","*","mv",";","float","nU","=","nQ","?","nS",":","0.0",";","float","nV","=","max","(","nU",",","nT",")",";","if","(","!","nj",")","my",".","x","+=","nV","*","ni",";","if","(","nj",")","my",".","y","+=","nV","*","ni",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_DISCARD",1,{TYPE:"equal_expr",PLACES:2},"FXAA_BLEND4WEB",1,{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","mr","(","ia",",","my",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","vec4","(","mr","(","ia",",","my",")",".","xyz",",","gf",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]}]},e["include/halo_color.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"HALO_COLOR_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"HALO_COLOR_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"NUM_RINGS",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LINES",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_STARS",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_STARS",TOKENS:["0"]},{TYPE:"var",NAME:"WAVES_HEIGHT",TOKENS:["1.0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_RINGS","NUM_LINES",{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","int","nW","=","NUM_RINGS",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","int","nW","=","NUM_LINES",";"]}]}}]},{TYPE:"txt",TOKENS:["float","nX","(","float","x",")","{","return","x","-","floor","(","x","*","(","1.0","/","0.01",")",")","*","0.01",";","}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_RINGS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["void","od","(","inout","float","nY",",","in","float","nZ","[","nW","]",",","in","float","n_",")","{","for","(","int","a","=","0",";","a","<","NUM_RINGS",";","a","++",")","{","float","oa","=","40.0","*","nZ","[","a","]",";","float","ob","=","300.0","*","(","nX","(","oa",")","-","0.005",")",";","float","oc","=","oa",";","float","ma","=","abs","(","oc","*","(","u_halo_size","*","ob","-","n_",")",")",";","nY","+=","1.0","-","min","(","ma",",","1.0",")",";","}","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LINES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["void","oi","(","inout","float","oe",",","in","float","nZ","[","nW","]",",","in","float","aM",")","{","for","(","int","a","=","0",";","a","<","NUM_LINES",";","a","++",")","{","float","of","=","nZ","[","a","]",";","float","og","=","of",";","float","oh","=","1000.0","*","(","nX","(","of",")","-","0.005",")",";","float","ma","=","20.0","*","abs","(","og","*","A",".","x","+","oh","*","A",".","y",")",";","oe","+=","1.0","-","min","(","ma",",","1.0",")",";","}","oe","*=","aM",";","}"]}]}}]},{TYPE:"txt",TOKENS:["void","om","(","inout","float","aM",",","in","vec2","b_",")","{","float","oj",",","bK",";","bK","=","atan","(","b_",".","y",",","b_",".","x",")",";","bK","*=","(","1.0","+","0.25","*","float","(","NUM_STARS",")",")",";","float","ok","=","cos","(","bK",")",";","float","ol","=","sin","(","bK",")",";","bK","=","(","ok","*","b_",".","x","+","ol","*","b_",".","y",")","*","(","ok","*","b_",".","y","-","ol","*","b_",".","x",")",";","oj","=","abs","(","bK",")",";","if","(","oj","<","1.0",")","{","oj","=","(","0.01","*","u_halo_size",")","/","(","oj",")",";","aM","*=","sqrt","(","min","(","oj",",","1.0",")",")",";","}","}","vec4","bh","(",")","{","float","aM","=","(","A",".","x","*","A",".","x","+","A",".","y","*","A",".","y",")",";","float","n_","=","sqrt","(","aM",")",";","aM","=","max","(","1.0","-","aM",",","0.0",")",";","aM","=","pow","(","aM",",","u_halo_hardness",")",";","float","L","=","u_diffuse_color",".","a",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_RINGS","NUM_LINES",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","nZ","[","nW","]",";","for","(","int","cl","=","0",";","cl","<","nW",";","cl","++",")","{","nZ","[","cl","]","=","fract","(","bf","/","float","(","cl","+","1",")",")","-","1.0",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_RINGS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","nY","=","0.0",";","od","(","nY",",","nZ",",","n_",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LINES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","oe","=","0.0",";","oi","(","oe",",","nZ",",","aM",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_STARS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["om","(","aM",",","A",")",";"]}]}}]},{TYPE:"txt",TOKENS:["aM","*=","L",";","vec3","aQ","=","u_diffuse_color",".","rgb",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_RINGS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["nY","*=","aM",";","aQ","+=","u_halo_rings_color","*","nY",";","aM","+=","nY",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LINES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["oe","*=","L",";","aQ","+=","u_halo_lines_color","*","oe",";","aM","+=","oe",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKY_STARS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aM","*=","max","(","1.0","-","2.0","*","u_sun_intensity",".","x",",","0.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","kZ","=","u_halo_stars_blend","*","(","be",".","y","-","u_halo_stars_height",")",";","aM","*=","clamp","(","kZ",",","0.0",",","1.0",")",";","aM","*=","min","(","u_cam_water_depth","+","2.0","*","WAVES_HEIGHT",",","1.0",")",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["vec4","on","=","vec4","(","aQ",",","aM",")",";","return","on",";","}"]}]}}]}]},e["include/lighting_nodes.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"LIGHTING_NODES_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"LIGHTING_NODES_GLSLF",TOKENS:[""]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"node",NAME:"LIGHTING_BEGIN",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"oB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oD",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oE",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"oF",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"oG",QUALIFIER:["vec2"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"oH",QUALIFIER:["vec2"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"oI",QUALIFIER:["vec4"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"oJ",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"oK",QUALIFIER:["vec4"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["oB","=","oo",";","oC","=","op",";","oD","=","oq",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_oE"],STATEMENTS:[{TYPE:"txt",TOKENS:["oE","=","or",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_oF"],STATEMENTS:[{TYPE:"txt",TOKENS:["oF","=","ot",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_oH"],STATEMENTS:[{TYPE:"txt",TOKENS:["oH","=","ov",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_oG"],STATEMENTS:[{TYPE:"txt",TOKENS:["oG","=","ow",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_oI"],STATEMENTS:[{TYPE:"txt",TOKENS:["oI","=","ox",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_oJ"],STATEMENTS:[{TYPE:"txt",TOKENS:["oJ","=","oy",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_oK"],STATEMENTS:[{TYPE:"txt",TOKENS:["oK","=","oz",";"]}]}]}]},{TYPE:"node",NAME:"LIGHTING_AMBIENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"oL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"oM",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"oN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oO",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oP",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["oO","=","vec4","(","oL","+","oN","*","oM",",","_0_0",")",";","oP","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"LIGHTING_LAMP",NODE_VARS:[{TYPE:"node_var",NAME:"LAMP_TYPE",TOKENS:["HEMI"]},{TYPE:"node_var",NAME:"LAMP_IND",TOKENS:["0"]},{TYPE:"node_var",NAME:"LAMP_SPOT_SIZE",TOKENS:["0.8"]},{TYPE:"node_var",NAME:"LAMP_SPOT_BLEND",TOKENS:["0.03"]},{TYPE:"node_var",NAME:"LAMP_LIGHT_DIST",TOKENS:["30.0"]},{TYPE:"node_var",NAME:"LAMP_SHADOW_MAP_IND",TOKENS:["-","1"]},{TYPE:"node_var",NAME:"LAMP_USE_SPHERE",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"oQ",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oS",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oU",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["oS","=","vec2","(","u_light_positions","[","LAMP_IND","]",".","w",",","u_light_color_intensities","[","LAMP_IND","]",".","w",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","HEMI",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["oU","=","_0_5",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["oU","=","_0_0",";"]}]}]},{TYPE:"txt",TOKENS:["oT","=","u_light_color_intensities","[","LAMP_IND","]",".","xyz",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_SHADOW_MAP_IND",1,{TYPE:"negative_expr",PLACES:1},{TYPE:"non_equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["oT","*=","oQ","[","LAMP_SHADOW_MAP_IND","]",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2},"LAMP_TYPE","POINT",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","oV","=","u_light_positions","[","LAMP_IND","]",".","xyz",";","oR","=","oV","-","os",";","float","aM","=","length","(","oR",")",";","float","oW","=","LAMP_LIGHT_DIST","/","(","LAMP_LIGHT_DIST","+","aM","*","aM",")",";","oR","=","normalize","(","oR",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","oX","=","u_light_directions","[","LAMP_IND","]",";","float","oY","=","dot","(","oR",",","oX",")",";","oY","*=","smoothstep","(","_0_0",",","_1_0",",","(","oY","-","LAMP_SPOT_SIZE",")","/","LAMP_SPOT_BLEND",")",";","oW","*=","oY",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_USE_SPHERE"],STATEMENTS:[{TYPE:"txt",TOKENS:["oW","*=","max","(","LAMP_LIGHT_DIST","-","aM",",","_0_0",")","/","LAMP_LIGHT_DIST",";"]}]}]},{TYPE:"txt",TOKENS:["oT","*=","oW",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["oR","=","u_light_directions","[","LAMP_IND","]",";"]}]}]}]},{TYPE:"node",NAME:"DIFFUSE_FRESNEL",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"oZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"o_",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pa",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pc",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pd",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pe","=","cross","(","oZ",",","B",".","xyz",")",";","pa","=","cross","(","pe",",","B",".","xyz",")",";","pa","=","-","normalize","(","pa",")",";"]}]}]},{TYPE:"txt",TOKENS:["pd","=","_0_0",";","if","(","o_",".","r","!=","_0_0",")","{","float","pf","=","(","_1_0","-","pb",")","*","dot","(","pa",",","oZ",")","+","pb",";","if","(","pc","[","0","]","==","_0_0",")","{","pd","=","_1_0",";","}","else","{","float","t","=","_1_0","+","abs","(","pf",")",";","t","=","pc","[","1","]","+","(","_1_0","-","pc","[","1","]",")","*","pow","(","t",",","pc","[","0","]",")",";","pd","=","clamp","(","t",",","_0_0",",","_1_0",")",";","}","pd","=","max","(","pd",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"DIFFUSE_LAMBERT",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ph",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pi",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pk",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pe","=","cross","(","pg",",","B",".","xyz",")",";","pi","=","cross","(","pe",",","B",".","xyz",")",";","pi","=","-","normalize","(","pi",")",";"]}]}]},{TYPE:"txt",TOKENS:["pk","=","_0_0",";","if","(","ph",".","r","!=","_0_0",")","{","float","pf","=","(","_1_0","-","pj",")","*","dot","(","pi",",","pg",")","+","pj",";","pk","=","max","(","pf",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"DIFFUSE_OREN_NAYAR",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pl",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pm",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pn",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"po",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pr",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pu",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pe","=","cross","(","pl",",","B",".","xyz",")",";","pn","=","cross","(","pe",",","B",".","xyz",")",";","pn","=","-","normalize","(","pn",")",";"]}]}]},{TYPE:"txt",TOKENS:["pu","=","_0_0",";","if","(","pm",".","r","!=","_0_0",")","{","float","pf","=","(","_1_0","-","po",")","*","dot","(","pn",",","pl",")","+","po",";","if","(","pr","[","0","]",">","_0_0",")","{","float","pv","=","max","(","dot","(","pn",",","ou",")",",","_0_0",")",";","float","pw","=","pr","[","0","]","*","pr","[","0","]",";","float","cB","=","_1_0","-","_0_5","*","(","pw","/","(","pw","+","0.33",")",")",";","vec3","px","=","pl","-","pf","*","pn",";","vec3","py","=","ou","-","pv","*","pn",";","if","(","length","(","px",")","==","_0_0","||","length","(","py",")","==","_0_0","||","abs","(","pf",")",">","_1_0","||","abs","(","pv",")",">","_1_0",")","pu","=","pf","*","cB",";","else","{","float","pz","=","acos","(","pf",")",";","float","pA","=","acos","(","pv",")",";","vec3","pB","=","normalize","(","px",")",";","vec3","pC","=","normalize","(","py",")",";","float","a",",","b",";","a","=","max","(","pz",",","pA",")",";","b","=","min","(","pz",",","pA",")",";","b","*=","0.95",";","float","t","=","max","(","dot","(","pB",",","pC",")",",","_0_0",")",";","float","hO","=","0.45","*","(","pw","/","(","pw","+","0.09",")",")",";","pu","=","pf","*","(","cB","+","(","hO","*","t","*","sin","(","a",")","*","tan","(","b",")",")",")",";","}","}","else","pu","=","pf",";","pu","=","max","(","pu",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"DIFFUSE_MINNAERT",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pD",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pE",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pG",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pH",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pI",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pe","=","cross","(","pD",",","B",".","xyz",")",";","pF","=","cross","(","pe",",","B",".","xyz",")",";","pF","=","-","normalize","(","pF",")",";"]}]}]},{TYPE:"txt",TOKENS:["pI","=","_0_0",";","if","(","pE",".","r","!=","_0_0",")","{","float","pf","=","(","_1_0","-","pG",")","*","dot","(","pF",",","pD",")","+","pG",";","float","pv","=","max","(","dot","(","pF",",","ou",")",",","_0_0",")",";","if","(","pH","[","0","]","<=","_1_0",")","pI","=","pf","*","pow","(","max","(","pv","*","pf",",","0.1",")",",","pH","[","0","]","-","_1_0",")",";","else","pI","=","pf","*","pow","(","1.0001","-","pv",",","pH","[","0","]","-","_1_0",")",";","pI","=","max","(","pI",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"DIFFUSE_TOON",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pK",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pN",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pO",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pe","=","cross","(","pJ",",","B",".","xyz",")",";","pL","=","cross","(","pe",",","B",".","xyz",")",";","pL","=","-","normalize","(","pL",")",";"]}]}]},{TYPE:"txt",TOKENS:["pO","=","_0_0",";","if","(","pK",".","r","!=","_0_0",")","{","float","pf","=","(","_1_0","-","pM",")","*","dot","(","pL",",","pJ",")","+","pM",";","float","pP","=","acos","(","pf",")",";","if","(","pP","<","pN","[","0","]",")","pO","=","_1_0",";","else","if","(","pP",">","(","pN","[","0","]","+","pN","[","1","]",")","||","pN","[","1","]","==","_0_0",")","pO","=","_0_0",";","else","pO","=","_1_0","-","(","(","pP","-","pN","[","0","]",")","/","pN","[","1","]",")",";","pO","=","max","(","pO",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_PHONG",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pR",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pS",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pT",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pU",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pV",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["pV","=","_0_0",";","if","(","pR",".","g","!=","_0_0",")","{","vec3","pW","=","normalize","(","pQ","+","ou",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["if","(","pT","==","_0_0",")","{","pV","=","dot","(","B",".","xyz",",","pW",")",";","pV","=","sqrt","(","_1_0","-","pV","*","pV",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["pV","=","(","_1_0","-","pT",")","*","max","(","dot","(","pS",",","pW",")",",","_0_0",")","+","pT",";"]}]}]},{TYPE:"txt",TOKENS:["pV","=","pow","(","pV",",","pU","[","0","]",")",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_COOKTORR",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pY",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"p_",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qa",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qb",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["qb","=","_0_0",";","if","(","pY",".","g","!=","_0_0",")","{","vec3","pW","=","normalize","(","pX","+","ou",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["if","(","p_","==","_0_0",")","{","qb","=","dot","(","B",".","xyz",",","pW",")",";","qb","=","sqrt","(","_1_0","-","qb","*","qb",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["qb","=","max","(","dot","(","pZ",",","pW",")",",","_0_0",")",";","qb","=","(","_1_0","-","p_",")","*","qb","+","p_",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","pv","=","max","(","dot","(","B",".","xyz",",","ou",")",",","_0_0",")",";","pv","=","sqrt","(","_1_0","-","pv","*","pv",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","pv","=","max","(","dot","(","pZ",",","ou",")",",","_0_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["qb","=","pow","(","qb",",","qa","[","0","]",")",";","qb","=","qb","/","(","0.1","+","pv",")",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_WARDISO",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qd",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qe",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qf",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qg",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qh",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["qh","=","_0_0",";","if","(","qd",".","g","!=","_0_0",")","{","vec3","pW","=","normalize","(","qc","+","ou",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","qi","=","_0_0",";","float","pv","=","_0_0",";","float","qj","=","_0_0",";","if","(","qf","==","_0_0",")","{","qi","=","dot","(","B",".","xyz",",","pW",")",";","pv","=","dot","(","B",".","xyz",",","ou",")",";","qj","=","dot","(","B",".","xyz",",","qc",")",";","qi","=","sqrt","(","_1_0","-","qi","*","qi",")",";","pv","=","sqrt","(","_1_0","-","pv","*","pv",")",";","qj","=","sqrt","(","_1_0","-","qj","*","qj",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","qi","=","max","(","dot","(","qe",",","pW",")",",","0.01",")",";","float","pv","=","max","(","dot","(","qe",",","ou",")",",","0.01",")",";","float","qj","=","max","(","dot","(","qe",",","qc",")",",","0.01",")",";"]}]}]},{TYPE:"txt",TOKENS:["float","bK","=","tan","(","acos","(","qi",")",")",";","float","L","=","max","(","qg","[","0","]",",","0.01",")",";","qh","=","qj","*","(","_1_0","/","(","4.0","*","M_PI","*","L","*","L",")",")","*","(","exp","(","-","(","bK","*","bK",")","/","(","L","*","L",")",")","/","(","sqrt","(","pv","*","qj",")",")",")",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_TOON",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qk",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ql",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qm",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qo",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qr",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["qr","=","_0_0",";","if","(","ql",".","g","!=","_0_0",")","{","vec3","cj","=","normalize","(","qk","+","ou",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","qu","=","dot","(","cj",",","B",".","xyz",")",";","float","bK","=","qo","[","0","]","+","qo","[","1","]",";","if","(","qn","==","_0_0",")","bK","=","acos","(","sqrt","(","_1_0","-","qu","*","qu",")",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","bK","=","acos","(","dot","(","cj",",","qm",")",")",";"]}]}]},{TYPE:"txt",TOKENS:["if","(","bK","<","qo","[","0","]",")","qr","=","_1_0",";","else","if","(","bK",">=","qo","[","0","]","+","qo","[","1","]","||","qo","[","1","]","==","_0_0",")","qr","=","_0_0",";","else","qr","=","_1_0","-","(","bK","-","qo","[","0","]",")","/","qo","[","1","]",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_BLINN",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qv",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qw",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qx",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qy",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qz",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qA",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","qB","=","qz","[","0","]",";","float","qC","=","qz","[","1","]",";","qA","=","_0_0",";","if","(","qw",".","g","!=","_0_0",")","{","if","(","qB","<","1.0","||","qC","==","_0_0",")","qA","=","_0_0",";","else","{","if","(","qC","<","100.0",")","qC","=","sqrt","(","1.0","/","qC",")",";","else","qC","=","10.0","/","qC",";","vec3","pW","=","normalize","(","ou","+","qv",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","qi","=","0.0",";","if","(","qy","==","_0_0",")","{","float","qD","=","dot","(","B",".","xyz",",","pW",")",";","qi","=","sqrt","(","_1_0","-","qD","*","qD",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","qi","=","(","_1_0","-","qy",")","*","max","(","dot","(","qx",",","pW",")",",","_0_0",")","+","qy",";"]}]}]},{TYPE:"txt",TOKENS:["if","(","qi","<","_0_0",")","qA","=","_0_0",";","else","{","float","pv","=","max","(","dot","(","qx",",","ou",")",",","0.01",")",";","float","qj","=","dot","(","qx",",","qv",")",";","if","(","qj","<=","0.01",")","qA","=","_0_0",";","else","{","float","qE","=","max","(","dot","(","ou",",","pW",")",",","0.01",")",";","float","a","=","_1_0",";","float","b","=","(","2.0","*","qi","*","pv",")","/","qE",";","float","du","=","(","2.0","*","qi","*","qj",")","/","qE",";","float","g","=","min","(","min","(","a",",","b",")",",","du",")",";","float","p","=","sqrt","(","pow","(","qB",",","2.0",")","+","pow","(","qE",",","2.0",")","-","_1_0",")",";","float","mi","=","pow","(","p","-","qE",",","2.0",")","/","pow","(","p","+","qE",",","2.0",")","*","(","_1_0","+","pow","(","qE","*","(","p","+","qE",")","-","_1_0",",","2.0",")","/","pow","(","qE","*","(","p","-","qE",")","+","_1_0",",","2.0",")",")",";","float","pP","=","acos","(","qi",")",";","qA","=","max","(","mi","*","g","*","exp","(","-","pow","(","pP",",","2.0",")","/","(","2.0","*","pow","(","qC",",","2.0",")",")",")",",","_0_0",")",";","}","}","}","}"]}]},{TYPE:"node",NAME:"LIGHTING_APPLY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"qF",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qI",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qL",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qM",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qQ",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qR",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["qR","=","qG","+","qO","*","qN","*","qI",";","qQ","=","qF","+","vec4","(","qO","*","qM","*","qH",",","qI",")",";"]}]},{TYPE:"node",NAME:"LIGHTING_END",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"qS",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qT",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["E","=","qS",".","rgb",";","oA","=","qT",";"]}]},{TYPE:"nodes_global"},{TYPE:"txt",TOKENS:["void","cK","(","vec3","oo",",","vec3","op",",","vec3","oq",",","vec3","or",",","vec3","os",",","vec3","ot",",","vec3","ou",",","vec2","ov",",","vec2","ow",",","vec4","ox",",","float","oy",",","vec4","oz",",","out","vec3","E",",","out","vec3","oA",")","{"]},{TYPE:"nodes_main"},{TYPE:"txt",TOKENS:["}"]}]}}]}]},e["include/math.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"MATH_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"MATH_GLSLV",TOKENS:[""]},{TYPE:"var",NAME:"EPSILON",TOKENS:["0.000001"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"REFRACTIVE",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"USE_POSITION_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"SOFT_PARTICLES",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["struct","au","{","vec3","O",";","vec3","ao",";","vec3","V",";","vec3","aB",";","vec3","W",";","vec3","U",";","vec3","aQ",";","}",";","bool","qU","(","vec3","a",",","vec3","b",")","{","return","any","(","lessThan","(","abs","(","a","-","b",")",",","vec3","(","EPSILON",")",")",")",";","}","vec3","T","(","in","vec4","q",",","in","vec3","kQ",")","{","return","kQ","+","2.0","*","cross","(","q",".","xyz",",","cross","(","q",".","xyz",",","kQ",")","+","q",".","w","*","kQ",")",";","}","vec4","kR","(","in","vec4","qV",")","{","return","vec4","(","-","qV",".","xyz",",","qV",".","w",")",";","}","vec4","qX","(","in","vec4","a",",","in","vec4","b",")","{","vec4","qW",";","qW",".","x","=","a",".","x","*","b",".","w","+","a",".","w","*","b",".","x","+","a",".","y","*","b",".","z","-","a",".","z","*","b",".","y",";","qW",".","y","=","a",".","y","*","b",".","w","+","a",".","w","*","b",".","y","+","a",".","z","*","b",".","x","-","a",".","x","*","b",".","z",";","qW",".","z","=","a",".","z","*","b",".","w","+","a",".","w","*","b",".","z","+","a",".","x","*","b",".","y","-","a",".","y","*","b",".","x",";","qW",".","w","=","a",".","w","*","b",".","w","-","a",".","x","*","b",".","x","-","a",".","y","*","b",".","y","-","a",".","z","*","b",".","z",";","return","qW",";","}","vec4","X","(","in","vec3","qY",",","in","float","qZ",")","{","vec4","qW",";","qZ","=","qZ","*","0.5",";","float","s","=","sin","(","qZ",")",";","qW",".","x","=","s","*","qY","[","0","]",";","qW",".","y","=","s","*","qY","[","1","]",";","qW",".","z","=","s","*","qY","[","2","]",";","qW",".","w","=","cos","(","qZ",")",";","return","qW",";","}","vec4","rd","(","in","vec3","bD",",","in","vec3","q_",")","{","vec4","qW",";","float","dz","=","dot","(","q_",",","bD",")",";","vec3","rc","=","cross","(","q_",",","bD",")",";","qW",".","xyz","=","rc",".","xyz",";","qW",".","w","=","1.0","+","dz",";","return","normalize","(","qW",")",";","}","vec3","rh","(","vec4","re",",","vec4","qV",",","vec3","rf",")","{","vec3","qW","=","rf","*","re",".","w",";","qW","=","T","(","qV",",","qW",")",";","qW","+=","re",".","xyz",";","return","qW",";","}","vec3","ap","(","mat3","ri",",","vec3","rf",")","{","vec3","qW","=","rf","*","ri","[","1","]","[","0","]",";","vec4","qV","=","vec4","(","ri","[","1","]","[","1","]",",","ri","[","1","]","[","2","]",",","ri","[","2","]","[","0","]",",","ri","[","2","]","[","1","]",")",";","qW","=","T","(","qV",",","qW",")",";","qW","+=","ri","[","0","]",";","return","qW",";","}","vec3","rj","(","vec4","re",",","vec4","qV",",","vec3","bD",")","{","vec3","qW","=","bD","*","re",".","w",";","qW","=","T","(","qV",",","qW",")",";","return","qW",";","}","vec3","_","(","mat3","ri",",","vec3","bD",")","{","vec3","qW","=","bD","*","ri","[","1","]","[","0","]",";","vec4","qV","=","vec4","(","ri","[","1","]","[","1","]",",","ri","[","1","]","[","2","]",",","ri","[","2","]","[","0","]",",","ri","[","2","]","[","1","]",")",";","qW","=","T","(","qV",",","qW",")",";","return","qW",";","}","vec3","rk","(","vec4","re",",","vec4","qV",",","vec3","rf",")","{","vec3","qW","=","rf","-","re",".","xyz",";","qW","=","T","(","kR","(","qV",")",",","qW",")",";","qW","/=","re",".","w",";","return","qW",";","}","vec3","rl","(","vec4","re",",","vec4","qV",",","vec3","bD",")","{","return","T","(","kR","(","qV",")",",","bD",")","/","re",".","w",";","}","mat4","rm","(",")","{","return","mat4","(","_1_0",",","_0_0",",","_0_0",",","_0_0",",","_0_0",",","_1_0",",","_0_0",",","_0_0",",","_0_0",",","_0_0",",","_1_0",",","_0_0",",","_0_0",",","_0_0",",","_0_0",",","_1_0",")",";","}","mat4","rn","(","float","bK",")","{","return","mat4","(","_1_0",",","_0_0",",","_0_0",",","_0_0",",","_0_0",",","cos","(","bK",")",",","sin","(","bK",")",",","_0_0",",","_0_0",",","-","sin","(","bK",")",",","cos","(","bK",")",",","_0_0",",","_0_0",",","_0_0",",","_0_0",",","_1_0",")",";","}","mat4","ro","(","float","bK",")","{","return","mat4","(","cos","(","bK",")",",","_0_0",",","-","sin","(","bK",")",",","_0_0",",","_0_0",",","_1_0",",","_0_0",",","_0_0",",","sin","(","bK",")",",","_0_0",",","cos","(","bK",")",",","_0_0",",","_0_0",",","_0_0",",","_0_0",",","_1_0",")",";","}","mat4","rp","(","float","bK",")","{","return","mat4","(","cos","(","bK",")",",","sin","(","bK",")",",","_0_0",",","_0_0",",","-","sin","(","bK",")",",","cos","(","bK",")",",","_0_0",",","_0_0",",","_0_0",",","_0_0",",","_1_0",",","_0_0",",","_0_0",",","_0_0",",","_0_0",",","_1_0",")",";","}","au","lX","(","in","au","kQ",")","{","return","au","(","kQ",".","O",",","kQ",".","ao",",","normalize","(","kQ",".","V",")",",","normalize","(","kQ",".","aB",")",",","normalize","(","kQ",".","W",")",",","normalize","(","kQ",".","U",")",",","kQ",".","aQ",")",";","}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE","USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:5}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","aC","(","vec4","f",")","{","float","fT","=","f",".","x",";","float","fU","=","f",".","y",";","float","fV","=","f",".","w",";","vec3","rq",";","rq",".","x","=","(","fT","+","fV",")","/","2.0",";","rq",".","y","=","(","fU","+","fV",")","/","2.0",";","rq",".","z","=","fV",";","return","rq",";","}"]}]}}]},{TYPE:"txt",TOKENS:["mat3","da","(",")","{","return","mat3","(","_0_0",",","_0_0",",","_0_0",",","_1_0",",","_0_0",",","_0_0",",","_0_0",",","_1_0",",","_0_0",")",";","}","mat4","bc","(","mat3","t",")","{","mat4","rs",";","rs","[","0","]","[","0","]","=","(","_1_0","-","(","t","[","1","]","[","2","]","*","(","t","[","1","]","[","2","]","+","t","[","1","]","[","2","]",")","+","t","[","2","]","[","0","]","*","(","t","[","2","]","[","0","]","+","t","[","2","]","[","0","]",")",")",")","*","t","[","1","]","[","0","]",";","rs","[","0","]","[","1","]","=","(","t","[","1","]","[","1","]","*","(","t","[","1","]","[","2","]","+","t","[","1","]","[","2","]",")","+","t","[","2","]","[","1","]","*","(","t","[","2","]","[","0","]","+","t","[","2","]","[","0","]",")",")","*","t","[","1","]","[","0","]",";","rs","[","0","]","[","2","]","=","(","t","[","1","]","[","1","]","*","(","t","[","2","]","[","0","]","+","t","[","2","]","[","0","]",")","-","t","[","2","]","[","1","]","*","(","t","[","1","]","[","2","]","+","t","[","1","]","[","2","]",")",")","*","t","[","1","]","[","0","]",";","rs","[","0","]","[","3","]","=","_0_0",";","rs","[","1","]","[","0","]","=","(","t","[","1","]","[","1","]","*","(","t","[","1","]","[","2","]","+","t","[","1","]","[","2","]",")","-","t","[","2","]","[","1","]","*","(","t","[","2","]","[","0","]","+","t","[","2","]","[","0","]",")",")","*","t","[","1","]","[","0","]",";","rs","[","1","]","[","1","]","=","(","_1_0","-","(","t","[","1","]","[","1","]","*","(","t","[","1","]","[","1","]","+","t","[","1","]","[","1","]",")","+","t","[","2","]","[","0","]","*","(","t","[","2","]","[","0","]","+","t","[","2","]","[","0","]",")",")",")","*","t","[","1","]","[","0","]",";","rs","[","1","]","[","2","]","=","(","t","[","1","]","[","2","]","*","(","t","[","2","]","[","0","]","+","t","[","2","]","[","0","]",")","+","t","[","2","]","[","1","]","*","(","t","[","1","]","[","1","]","+","t","[","1","]","[","1","]",")",")","*","t","[","1","]","[","0","]",";","rs","[","1","]","[","3","]","=","_0_0",";","rs","[","2","]","[","0","]","=","(","t","[","1","]","[","1","]","*","(","t","[","2","]","[","0","]","+","t","[","2","]","[","0","]",")","+","t","[","2","]","[","1","]","*","(","t","[","1","]","[","2","]","+","t","[","1","]","[","2","]",")",")","*","t","[","1","]","[","0","]",";","rs","[","2","]","[","1","]","=","(","t","[","1","]","[","2","]","*","(","t","[","2","]","[","0","]","+","t","[","2","]","[","0","]",")","-","t","[","2","]","[","1","]","*","(","t","[","1","]","[","1","]","+","t","[","1","]","[","1","]",")",")","*","t","[","1","]","[","0","]",";","rs","[","2","]","[","2","]","=","(","_1_0","-","(","t","[","1","]","[","1","]","*","(","t","[","1","]","[","1","]","+","t","[","1","]","[","1","]",")","+","t","[","1","]","[","2","]","*","(","t","[","1","]","[","2","]","+","t","[","1","]","[","2","]",")",")",")","*","t","[","1","]","[","0","]",";","rs","[","2","]","[","3","]","=","_0_0",";","rs","[","3","]","[","0","]","=","t","[","0","]","[","0","]",";","rs","[","3","]","[","1","]","=","t","[","0","]","[","1","]",";","rs","[","3","]","[","2","]","=","t","[","0","]","[","2","]",";","rs","[","3","]","[","3","]","=","1.0",";","return","rs",";","}","mat3","aY","(","in","mat3","ri",",","in","mat3","rt",")","{","mat3","qW",";","vec3","rf","=","rt","[","0","]",";","vec4","re","=","vec4","(","ri","[","0","]",",","ri","[","1","]","[","0","]",")",";","vec4","qV","=","vec4","(","ri","[","1","]","[","1","]",",","ri","[","1","]","[","2","]",",","ri","[","2","]","[","0","]",",","ri","[","2","]","[","1","]",")",";","qW","[","0","]","=","rh","(","re",",","qV",",","rf",")",";","qW","[","1","]","[","0","]","=","ri","[","1","]","[","0","]","*","rt","[","1","]","[","0","]",";","qW","[","1","]","[","1","]","=","ri","[","1","]","[","1","]","*","rt","[","2","]","[","1","]","+","ri","[","2","]","[","1","]","*","rt","[","1","]","[","1","]","+","ri","[","1","]","[","2","]","*","rt","[","2","]","[","0","]","-","ri","[","2","]","[","0","]","*","rt","[","1","]","[","2","]",";","qW","[","1","]","[","2","]","=","ri","[","1","]","[","2","]","*","rt","[","2","]","[","1","]","+","ri","[","2","]","[","1","]","*","rt","[","1","]","[","2","]","+","ri","[","2","]","[","0","]","*","rt","[","1","]","[","1","]","-","ri","[","1","]","[","1","]","*","rt","[","2","]","[","0","]",";","qW","[","2","]","[","0","]","=","ri","[","2","]","[","0","]","*","rt","[","2","]","[","1","]","+","ri","[","2","]","[","1","]","*","rt","[","2","]","[","0","]","+","ri","[","1","]","[","1","]","*","rt","[","1","]","[","2","]","-","ri","[","1","]","[","2","]","*","rt","[","1","]","[","1","]",";","qW","[","2","]","[","1","]","=","ri","[","2","]","[","1","]","*","rt","[","2","]","[","1","]","-","ri","[","1","]","[","1","]","*","rt","[","1","]","[","1","]","-","ri","[","1","]","[","2","]","*","rt","[","1","]","[","2","]","-","ri","[","2","]","[","0","]","*","rt","[","2","]","[","0","]",";","return","qW",";","}","mat3","dd","(","in","vec4","qV",",","in","mat3","ri",")","{","mat3","qW",";","qW","[","0","]","=","ri","[","0","]",";","qW","[","1","]","[","0","]","=","ri","[","1","]","[","0","]",";","qW","[","1","]","[","1","]","=","qV","[","0","]",";","qW","[","1","]","[","2","]","=","qV","[","1","]",";","qW","[","2","]","[","0","]","=","qV","[","2","]",";","qW","[","2","]","[","1","]","=","qV","[","3","]",";","return","qW",";","}","vec4","R","(","in","vec4","ru",")","{","return","normalize","(","ru",")",";","}","vec4","R","(","in","vec4","ru",",","out","float","P",",","out","float","Q",")","{","vec4","qV","=","R","(","ru",")",";","P","=","length","(","ru",")","*","M_PI",";","Q","=","sign","(","ru","[","3","]",")",";","return","R","(","ru",")",";","}"]}]}}]}]},e["include/mirror.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"MIRROR_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"MIRROR_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"REFLECTION_PASS",TOKENS:["REFL_PASS_NONE"]},{TYPE:"var",NAME:"USE_BSDF_SKY_DIM",TOKENS:[""]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFLECTION_TYPE","REFL_CUBE",{TYPE:"equal_expr",PLACES:2},"REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"define",NAME:"REFL_BUMP",TOKENS:["0.1"]},{TYPE:"txt",TOKENS:["float","rv","(","in","vec3","D",",","vec3","eJ",",","float","d_",",","float","fg",")","{","vec3","fe","=","normalize","(","eJ","+","D",")",";","float","ff","=","1.0","-","dot","(","D",",","fe",")",";","float","r","=","fg","+","(","1.0","-","fg",")","*","pow","(","ff",",","d_",")",";","return","r",";","}","void","cL","(","inout","vec3","rw",",","vec3","D",",","vec3","U",",","float","rx",",","mat3","N",")","{","vec3","eJ","=","reflect","(","-","D",",","U",")",";","float","d_","=","u_fresnel_params","[","0","]",";","float","fg","=","u_fresnel_params","[","1","]",";","float","r","=","1.0",";","if","(","d_","!=","0.0",")","r","=","rv","(","D",",","eJ",",","d_",",","fg",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_CUBE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","eO","=","GLSL_TEXTURE_CUBE","(","u_cube_reflection",",","eJ",")",".","xyz",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_NONE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ry","=","u_refl_plane",".","xyz","*","dot","(","U",",","u_refl_plane",".","xyz",")",";","vec3","rz","=","U","-","ry",";","vec2","rA","=","_","(","N",",","rz",")",".","xy",";","vec2","rB","=","l",".","xy","/","l",".","z",";","rB","+=","rA","*","REFL_BUMP",";","vec3","eO","=","GLSL_TEXTURE","(","u_plane_reflection",",","rB",")",".","rgb",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","eO","=","vec3","(","1.0",")",";","rx","=","0.0",";"]}]}}]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","eO","=","GLSL_TEXTURE_CUBE","(","u_mirrormap",",","eJ",")",".","xyz",";"]}]}}]},{TYPE:"txt",TOKENS:["bC","(","eO",".","rgb",")",";","rw","=","mix","(","rw",",","eO",",","rx","*","r",")",";","}"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_PBR_STANDARD",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","rD","(","float","ed",",","vec3","rC",",","float","ec",")","{","return","rC","+","(","max","(","vec3","(","1.0","-","ec",")",",","rC",")","-","rC",")","*","pow","(","1.0","-","ed",",","5.0",")",";","}","vec3","rP","(","vec3","rw",",","vec3","rE",",","vec3","D",",","vec3","U",",","float","rF",",","float","rG",",","mat3","N",")","{","float","rH","=","max","(","dot","(","normalize","(","U",")",",","D",")",",","_0_0",")",";","vec3","eJ","=","reflect","(","-","D",",","U",")",";","float","ec","=","sqrt","(","rG",")",";","vec3","rC","=","vec3","(","0.04",")",";","rC","=","mix","(","rC",",","rE",",","rF",")",";","vec3","rI","=","rD","(","rH",",","rC",",","ec",")",";","vec3","rJ","=","rI",";","vec3","rK","=","vec3","(","_1_0",")","-","rJ",";","rK","*=","vec3","(","1.0","-","rF",")",";","vec3","bt","=","GLSL_TEXTURE_CUBE","(","u_cube_irradiance",",","U",")",".","xyz",";","vec3","rL","=","bt","*","rw",";","const","float","rM","=","5.0",";","vec3","ei","=","GLSL_TEXTURE_CUBE_LOD","(","u_cube_r_convolution",",","eJ",",","ec","*","rM",")",".","rgb",";","vec2","rN","=","GLSL_TEXTURE","(","u_brdf",",","vec2","(","rH",",","ec",")",")",".","rg",";","vec3","cJ","=","ei","*","(","rI","*","rN",".","x","+","rN",".","y",")",";","vec3","rO","=","(","rK","*","rL","+","cJ",")",";","return","rO",";","}"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_PBR_SIMPLE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","rD","(","float","ed",",","vec3","rC",",","float","ec",")","{","return","rC","+","(","max","(","vec3","(","1.0","-","ec",")",",","rC",")","-","rC",")","*","pow","(","1.0","-","ed",",","5.0",")",";","}","vec3","rP","(","vec3","rw",",","vec3","rE",",","vec3","D",",","vec3","U",",","float","rF",",","float","rG",",","mat3","N",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_BSDF_SKY_DIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","rH","=","max","(","dot","(","normalize","(","U",")",",","D",")",",","_0_0",")",";","vec3","eJ","=","reflect","(","-","D",",","U",")",";","float","rQ","=","max","(","2.0","/","(","rG","*","rG",")","-","2.0",",","_0_0",")",";","vec3","rC","=","vec3","(","0.04",")",";","rC","=","mix","(","rC",",","rE",",","rF",")",";","vec3","rI","=","rD","(","rH",",","rC",",","sqrt","(","rG",")",")",";","vec3","rJ","=","rI",";","vec3","rK","=","vec3","(","_1_0",")","-","rJ",";","rK","*=","1.0","-","rF",";","vec3","rL","=","GLSL_TEXTURE_CUBE_LOD","(","u_sky_reflection",",","normalize","(","U",")",",","100.0",")",".","xyz",";","bC","(","rL",")",";","rL","*=","rw",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","rR","=","u_bsdf_cube_sky_dim",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","rR","=","float","(","textureSize","(","u_sky_reflection",",","0",")",".","x",")",";"]}]}}]},{TYPE:"txt",TOKENS:["float","rS","=","log2","(","rR","*","sqrt","(","3.0",")",")","-","_0_5","*","log2","(","rQ","+","_1_0",")",";","vec3","cJ","=","GLSL_TEXTURE_CUBE_LOD","(","u_sky_reflection",",","eJ",",","rS",")",".","xyz",";","bC","(","cJ",")",";","vec3","rO","=","rK","*","rL","+","rJ","*","cJ",";","return","rO",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","rw",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]}]}}]}]},e["include/nodes.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"NODES_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"NODES_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"CAUSTICS",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"DOUBLE_SIDED_LIGHTING",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_PASS",TOKENS:["REFL_PASS_NONE"]},{TYPE:"var",NAME:"USE_REFRACTION",TOKENS:["0"]},{TYPE:"var",NAME:"HAS_REFRACT_TEXTURE",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"USE_DERIVATIVES_EXT",TOKENS:["0"]},{TYPE:"var",NAME:"CAMERA_TYPE",TOKENS:["CAM_TYPE_PERSP"]},{TYPE:"var",NAME:"IS_WORLD",TOKENS:["0"]},{TYPE:"var",NAME:"USE_BSDF_TRANSPARENT_REFRACT",TOKENS:["0"]},{TYPE:"var",NAME:"USE_BSDF_TRANSPARENT_ALPHA",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_BSDF_BEGIN",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"mirror.glslf"},{TYPE:"include",FILE:"shadow.glslf"},{TYPE:"include",FILE:"environment.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"refraction.glslf"}]}}]},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","rT",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","rW","(","in","vec3","rU",",","in","float","rV",")","{","vec3","eX","=","vec3","(","_0_0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_REFRACTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eX","=","cN","(","l",",","rU",".","xy","*","rV",")",";"]}]}},{TYPE:"elif",EXPRESSION:["HAS_REFRACT_TEXTURE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eX","=","GLSL_TEXTURE","(","u_refractmap",",","l",".","xy","/","l",".","z",")",".","rgb",";","bC","(","eX",")",";"]}]}}]},{TYPE:"txt",TOKENS:["return","eX",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{TYPE:"logical_or_expr",PLACES:6}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","kf","(","vec3","rgb",")","{","vec4","hI","=","vec4","(","_0_0",",","-","_1_0","/","3.0",",","2.0","/","3.0",",","-","_1_0",")",";","vec4","p","=","mix","(","vec4","(","rgb",".","bg",",","hI",".","wz",")",",","vec4","(","rgb",".","gb",",","hI",".","xy",")",",","step","(","rgb",".","b",",","rgb",".","g",")",")",";","vec4","q","=","mix","(","vec4","(","p",".","xyw",",","rgb",".","r",")",",","vec4","(","rgb",".","r",",","p",".","yzx",")",",","step","(","p",".","x",",","rgb",".","r",")",")",";","float","dz","=","q",".","x","-","min","(","q",".","w",",","q",".","y",")",";","float","iB","=","1.0e-10",";","return","vec3","(","abs","(","q",".","z","+","(","q",".","w","-","q",".","y",")","/","(","6.0","*","dz","+","iB",")",")",",","dz","/","(","q",".","x","+","iB",")",",","q",".","x",")",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{TYPE:"logical_or_expr",PLACES:6}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","kh","(","vec3","kg",")","{","vec4","hI","=","vec4","(","_1_0",",","2.0","/","3.0",",","_1_0","/","3.0",",","3.0",")",";","vec3","p","=","abs","(","fract","(","vec3","(","kg",".","r",",","kg",".","r",",","kg",".","r",")","+","hI",".","xyz",")","*","6.0","-","hI",".","www",")",";","return","kg",".","b","*","mix","(","hI",".","xxx",",","clamp","(","p","-","hI",".","xxx",",","_0_0",",","_1_0",")",",","kg",".","g",")",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED","USE_NODE_TEX_COORD_UV","USE_NODE_UVMAP",{TYPE:"logical_or_expr",PLACES:5}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","rX","(","vec2","gT",")","{","return","vec3","(","gT","*","2.0","-","vec2","(","_1_0",",","_1_0",")",",","_0_0",")",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","rY","(","vec3","rf",")","{","return","vec2","(","rf",".","xy","*","_0_5","+","vec2","(","_0_5",",","_0_5",")",")",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","sb","(","vec3","rZ",",","vec3","r_",",","float","sa",")","{","float","du","=","abs","(","dot","(","rZ",",","r_",")",")",";","float","g","=","sa","*","sa","-","_1_0","+","du","*","du",";","float","dY",";","if","(","g",">","_0_0",")","{","g","=","sqrt","(","g",")",";","float","cB","=","(","g","-","du",")","/","(","g","+","du",")",";","float","hO","=","(","du","*","(","g","+","du",")","-","_1_0",")","/","(","du","*","(","g","-","du",")","+","_1_0",")",";","dY","=","_0_5","*","cB","*","cB","*","(","_1_0","+","hO","*","hO",")",";","}","else","{","dY","=","_1_0",";","}","return","dY",";","}"]}]}}]},{TYPE:"node",NAME:"CAMERA",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"sE",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"sF",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"sG",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_sE"],STATEMENTS:[{TYPE:"txt",TOKENS:["sE","=","normalize","(","sB",".","xyz",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_sF"],STATEMENTS:[{TYPE:"txt",TOKENS:["sF","=","abs","(","sB",".","z",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_sG"],STATEMENTS:[{TYPE:"txt",TOKENS:["sG","=","length","(","sB",".","xyz",")",";"]}]}]}]},{TYPE:"node",NAME:"COMBRGB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"sH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"sI",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"sJ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"sK",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["sK","=","vec3","(","sH",",","sI",",","sJ",")",";"]}]},{TYPE:"node",NAME:"COMBHSV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"sL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"sM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"sN",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"sO",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["sO","=","kh","(","vec3","(","sL",",","sM",",","sN",")",")",";"]}]},{TYPE:"node",NAME:"EMPTY_UV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"sP",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["sP","=","vec3","(","-","_1_0",",","-","_1_0",",","_0_0",")",";"]}]},{TYPE:"node",NAME:"EMPTY_VC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"sQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["sQ","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_UV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"sR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sc",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["sR","=","rX","(","sc",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_OR",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"sS",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["sS","=","2.0","*","rT","-","vec3","(","_1_0",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"sT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sd",QUALIFIER:["GLSL_IN","vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["sT","=","max","(","vec3","(","_0_0",")",",","sd",")",";","bC","(","sT",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC1",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"sU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"se",QUALIFIER:["GLSL_IN","float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["sU","=","max","(","_0_0",",","se",")",";","bC","(","sU",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC2",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"sV",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"sW",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sf",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["sV","=","max","(","_0_0",",","sf","[","0","]",")",";","sW","=","max","(","_0_0",",","sf","[","1","]",")",";","bC","(","sV",")",";","bC","(","sW",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC3",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"sX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"sY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"sZ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sg",QUALIFIER:["GLSL_IN","vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["sX","=","max","(","_0_0",",","sg","[","0","]",")",";","sY","=","max","(","_0_0",",","sg","[","1","]",")",";","sZ","=","max","(","_0_0",",","sg","[","2","]",")",";","bC","(","sX",")",";","bC","(","sY",")",";","bC","(","sZ",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_NO",NODE_VARS:[{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"s_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ta",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["ta","=","s_",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["ta","=","su",".","xyz",";"]}]}]}]},{TYPE:"node",NAME:"GEOMETRY_FB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tb",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["tb","=","(","gl_FrontFacing",")","?","_0_0",":","_1_0",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["tb","=","(","gl_FrontFacing",")","?","_1_0",":","_0_0",";"]}]}]}]},{TYPE:"node",NAME:"GEOMETRY_BF",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tc",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["tc","=","(","gl_FrontFacing",")","?","_1_0",":","_0_0",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["tc","=","(","gl_FrontFacing",")","?","_0_0",":","_1_0",";"]}]}]}]},{TYPE:"node",NAME:"GEOMETRY_VW",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"td",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["td","=","-","_","(","u_view_tsr_frag",",","ou",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_LO",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"te",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["te","=","sB",".","xyz",";"]}]},{TYPE:"node",NAME:"GEOMETRY_GL",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tf",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tf","=","os",";"]}]},{TYPE:"node",NAME:"GEOMETRY_IN",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tg",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tg","=","ou",";"]}]},{TYPE:"node",NAME:"NEW_GEOMETRY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"th",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ti",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tj",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tk",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tl",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tm",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"to",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["th","=","vec3","(","_0_0",")",";","ti","=","vec3","(","_0_0",")",";","tj","=","vec3","(","_0_0",")",";","tk","=","vec3","(","_0_0",")",";","tl","=","vec3","(","_0_0",")",";","tm","=","vec3","(","_0_0",")",";","tn","=","_0_0",";","to","=","_0_0",";"]}]},{TYPE:"node",NAME:"HUE_SAT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"tr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tu",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tx",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ty",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","kg","=","kf","(","tx",")",";","kg","[","0","]","+=","(","tr","-","_0_5",")",";","if","(","kg","[","0","]",">","_1_0",")","kg","[","0","]","-=","_1_0",";","else","if","(","kg","[","0","]","<","_0_0",")","kg","[","0","]","+=","_1_0",";","kg","*=","vec3","(","_1_0",",","tu",",","tv",")",";","kg","=","mix","(","vec3","(","_1_0",")",",","mix","(","vec3","(","_0_0",")",",","kg",",","step","(","vec3","(","_0_0",")",",","kg",")",")",",","step","(","kg",",","vec3","(","_1_0",")",")",")",";","ty","=","mix","(","tx",",","kh","(","kg",")",",","tw",")",";"]}]},{TYPE:"node",NAME:"INVERT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"tz",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tA",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tB",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tB","=","mix","(","tA",",","vec3","(","_1_0",")","-","tA",",","tz",")",";"]}]},{TYPE:"node",NAME:"LAMP",NODE_VARS:[{TYPE:"node_var",NAME:"LAMP_TYPE",TOKENS:["HEMI"]},{TYPE:"node_var",NAME:"LAMP_INDEX",TOKENS:["0"]},{TYPE:"node_var",NAME:"LAMP_USE_SPHERE",TOKENS:["0"]},{TYPE:"node_var",NAME:"LAMP_SPOT_SIZE",TOKENS:["0.8"]},{TYPE:"node_var",NAME:"LAMP_SPOT_BLEND",TOKENS:["0.03"]},{TYPE:"node_var",NAME:"LAMP_LIGHT_DIST",TOKENS:["30.0"]}],DECLARATIONS:[{TYPE:"node_out",NAME:"tC",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"tD",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tF",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_INDEX",1,{TYPE:"negative_expr",PLACES:1},{TYPE:"non_equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tC"],STATEMENTS:[{TYPE:"txt",TOKENS:["tC","=","u_lamp_light_color_intensities","[","LAMP_INDEX","]",";"]}]}]},{TYPE:"txt",TOKENS:["vec3","tG","=","u_lamp_light_directions","[","LAMP_INDEX","]",";","vec3","tH","=","u_lamp_light_positions","[","LAMP_INDEX","]",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2},"LAMP_TYPE","POINT",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["tD","=","h","-","tH",";","tE","=","length","(","tD",")",";","tD","=","normalize","(","tD",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tF"],STATEMENTS:[{TYPE:"txt",TOKENS:["tF","=","LAMP_LIGHT_DIST","/","(","LAMP_LIGHT_DIST","+","tE","*","tE",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","oY","=","dot","(","-","tD",",","tG",")",";","oY","*=","smoothstep","(","_0_0",",","_1_0",",","(","oY","-","LAMP_SPOT_SIZE",")","/","LAMP_SPOT_BLEND",")",";","tF","*=","oY",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_USE_SPHERE"],STATEMENTS:[{TYPE:"txt",TOKENS:["tF","*=","max","(","LAMP_LIGHT_DIST","-","tE",",","_0_0",")","/","LAMP_LIGHT_DIST",";"]}]}]}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tD"],STATEMENTS:[{TYPE:"txt",TOKENS:["tD","=","tG",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tE"],STATEMENTS:[{TYPE:"txt",TOKENS:["tE","=","length","(","tH","-","h",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tF"],STATEMENTS:[{TYPE:"txt",TOKENS:["tF","=","_1_0",";"]}]}]}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tC"],STATEMENTS:[{TYPE:"txt",TOKENS:["tC","=","vec3","(","_0_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["tD","=","vec3","(","_0_0",")",";","tE","=","0.0",";"]}]}]}]},{TYPE:"node",NAME:"NORMAL",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"tI",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tJ",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"tK",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"sh",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tJ"],STATEMENTS:[{TYPE:"txt",TOKENS:["tJ","=","sh",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tK"],STATEMENTS:[{TYPE:"txt",TOKENS:["tK","=","-","dot","(","tI",",","sh",")",";"]}]}]}]},{TYPE:"node",NAME:"B4W_VECTOR_VIEW",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"tL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tM",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tM","=","-","_","(","u_view_tsr_frag",",","tL",")",";"]}]},{TYPE:"node",NAME:"BSDF_BEGIN",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"tN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tR",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tS",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tV",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tW",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"t_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ua",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ub",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uc",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ud",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ue",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uf",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ug",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uh",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ui",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uj",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["t_","=","tO",";","ua","=","tQ",";","ub","=","tT",";","ue","=","tO",";","uf","=","tQ",";","ug","=","tU",";","uh","=","tV",";","ui","=","tW",";","uj","=","tX",";","tY","=","sC","*","t_",";","tZ","=","sD","*","u_environment_energy","*","cz","(","ub",")",";","ud","=","cC","(","t_",")",";","H","=","ud",";","uc","[","0","]","=","tP",";","uc","[","1","]","=","tR",";","uc","[","2","]","=","tS",";"]}]},{TYPE:"node",NAME:"BSDF_END",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"uk",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ul",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"um",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"un",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uo",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"up",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ur",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"us",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ut",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uu",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uv",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","uw","=","clamp","(","un","[","1","]",",","_0_0",",","_1_0",")",";","float","rF","=","un","[","2","]",";","uu","=","uk",".","rgb",";","uv","=","_1_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["REFLECTION_TYPE","REFL_PBR_STANDARD",{TYPE:"equal_expr",PLACES:2},"REFLECTION_TYPE","REFL_PBR_SIMPLE",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["uu","+=","rP","(","uo",",","up",",","ou",",","um",",","rF",",","uw",",","mat3","(","_0_0",")",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["uu","+=","rP","(","uo",",","up",",","ou",",","um",",","rF",",","u_view_tsr_frag",")",";"]}]}]},{TYPE:"txt",TOKENS:["uu","+=","ul",";","uu","=","mix","(","uu",",","uq",",","ur",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NODE_BSDF_TRANSPARENT"],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_BSDF_TRANSPARENT_REFRACT"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","ux","=","GLSL_TEXTURE","(","u_refractmap",",","l",".","xy","/","l",".","z",")",".","rgb",";","bC","(","ux",")",";","us","=","us","*","ux",";","uu","+=","us",";","uv","=","_1_0",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_BSDF_TRANSPARENT_ALPHA"],STATEMENTS:[{TYPE:"txt",TOKENS:["uu","=","mix","(","us",",","uu",",","ut",")",";","uv","=","ut",";"]}]}]}]}]},{TYPE:"txt",TOKENS:["um",";"]}]},{TYPE:"node",NAME:"BSDF_COMPUTE",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"uy",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uz",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uA",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uB",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uC",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uD",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uE",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","r_","=","uA",";","float","uF","=","clamp","(","uC","[","0","]",",","_0_0",",","_1_0",")",";","float","uw","=","clamp","(","uC","[","1","]",",","_0_0",",","_1_0",")",";","float","rF","=","uC","[","2","]",";","vec3","pW","=","normalize","(","ou","+","uy",")",";","float","pf","=","(","_1_0","-","uB",")","*","dot","(","r_",",","uy",")","+","uB",";","float","uG","=","(","_1_0","-","uB",")","*","max","(","dot","(","uy",",","pW",")",",","_0_0",")","+","uB",";","float","uH","=","(","_1_0","-","uB",")","*","max","(","dot","(","uA",",","pW",")",",","_0_0",")","+","uB",";","uD","=","_0_0",";","if","(","uz",".","r","!=","_0_0",")","{","if","(","uF",">","_0_0",")","{","float","pv","=","max","(","dot","(","r_",",","ou",")",",","_0_0",")",";","float","pw","=","uF","*","uF",";","float","cB","=","_1_0","-","_0_5","*","(","pw","/","(","pw","+","0.33",")",")",";","vec3","px","=","uy","-","pf","*","r_",";","vec3","py","=","ou","-","pv","*","r_",";","if","(","length","(","px",")","==","_0_0","||","length","(","py",")","==","_0_0","||","abs","(","pf",")",">","_1_0","||","abs","(","pv",")",">","_1_0",")","uD","=","pf","*","cB",";","else","{","float","pz","=","acos","(","pf",")",";","float","pA","=","acos","(","pv",")",";","vec3","pB","=","normalize","(","px",")",";","vec3","pC","=","normalize","(","py",")",";","float","a",",","b",";","a","=","max","(","pz",",","pA",")",";","b","=","min","(","pz",",","pA",")",";","b","*=","0.95",";","float","t","=","max","(","dot","(","pB",",","pC",")",",","_0_0",")",";","float","hO","=","0.45","*","(","pw","/","(","pw","+","0.09",")",")",";","uD","=","pf","*","(","cB","+","(","hO","*","t","*","sin","(","a",")","*","tan","(","b",")",")",")",";","}","}","else","uD","=","pf",";","uD","=","max","(","uD",",","_0_0",")","/","M_PI",";","}","float","L","=","uw",";","float","uI","=","L","*","L",";","float","dX","=","(","uH","*","uI","-","uH",")","*","uH","+","_1_0",";","float","cy","=","uI","/","(","M_PI","*","dX","*","dX",")",";","float","uJ",";","float","uK",";","float","uL","=","pow","(","_1_0","-","uG",",","5.0",")",";","uJ","=","_1_0",";","uK","=","uL",";","float","hI","=","L","/","2.0",";","float","uM","=","hI","*","hI",";","float","uN","=","_1_0","-","uM",";","float","uO","=","_1_0","/","(","uG","*","uG","*","uN","+","uM",")",";","uJ","*=","uO",";","uK","*=","uO",";","float","rC","=","mix","(","0.04",",","_1_0",",","rF",")",";","float","uP","=","mix","(","uK",",","uJ",",","rC",")",";","uE","=","max","(","pf","*","cy","*","uP",",","_0_0",")",";"]}]},{TYPE:"node",NAME:"BSDF_PRINCIPLED",NODE_VARS:[{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"uQ",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uR",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uS",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uW",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uZ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"u_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"va",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vd",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["uX","=","uQ",".","rgb",";","uY","=","uS","*","uS",";","uV","=","uQ",".","rgb",";","uW","=","uS",";","uZ","=","uR",";","vb","=","_0_0",";","vd","=","_1_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["u_","=","uT",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["u_","=","ot",";"]}]}]},{TYPE:"txt",TOKENS:["uU",";","va","=","vec3","(","_0_0",")",";","vc","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"BSDF_ANISOTROPIC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"ve",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vf",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vg",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vh",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vi",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vj",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vk",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vk","=","ve",";","vf",";","vg",";","vh",";","vi",";","vj",";"]}]},{TYPE:"node",NAME:"BSDF_DIFFUSE",NODE_VARS:[{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"vl",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vm",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vn",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vo",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vp",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vq",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vr",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vs",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vt",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vu",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vv",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vx",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vy",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vp","=","vl",";","vq","=","vm",";","vs","=","_1_0",";","vt","=","_0_0",";","vw","=","_0_0",";","vy","=","_1_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["vu","=","vn",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vu","=","ot",";"]}]}]},{TYPE:"txt",TOKENS:["vo",";","vr","=","vec3","(","_0_0",")",";","vv","=","vec3","(","_0_0",")",";","vx","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"BSDF_GLASS",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"vz",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vB",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vD",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vD","=","vz",";","vA",";","vB",";","vC",";"]}]},{TYPE:"node",NAME:"BSDF_GLOSSY",NODE_VARS:[{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"vE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vF",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vI",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vJ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vR",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vK","=","vE",";","vL","=","vF",";","vM","=","_1_0",";","vP","=","_0_0",";","vR","=","_1_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["vN","=","vG",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vN","=","ot",";"]}]}]},{TYPE:"txt",TOKENS:["vH",";","vI","=","vec3","(","_0_0",")",";","vJ","=","_0_0",";","vO","=","vec3","(","_0_0",")",";","vQ","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"BSDF_HAIR",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"vS",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vT",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vV",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vW",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vW","=","vS",";","vT",";","vU",";","vV",";"]}]},{TYPE:"node",NAME:"BSDF_TRANSPARENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"vX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"v_",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wa",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wc",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wd",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"we",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wf",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wh",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wg","=","vX",";","wc","=","_0_0",";","wf","=","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_BSDF_TRANSPARENT_ALPHA"],STATEMENTS:[{TYPE:"txt",TOKENS:["wh","=","_0_0",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["wh","=","_1_0",";"]}]}]},{TYPE:"txt",TOKENS:["wd","=","ot",";","vY",";","vZ","=","vec3","(","_0_0",")",";","v_","=","_0_0",";","wa","=","vec3","(","_0_0",")",";","wb","=","_0_0",";","we","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"BSDF_TRANSLUCENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"wi",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wj",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wk",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wk","=","wi",";","wj",";"]}]},{TYPE:"node",NAME:"BSDF_REFRACTION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"wl",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wm",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wo",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wp",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wp","[","0","]","=","wp","[","1","]","=","wp","[","2","]","=","_0_0",";","wl",";","wm",";","wn",";","wo",";"]}]},{TYPE:"node",NAME:"BSDF_TOON",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"wq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ws",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wt",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wu",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wu","=","wq",";","wr",";","ws",";","wt",";"]}]},{TYPE:"node",NAME:"BSDF_VELVET",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"wv",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wC",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wC","=","wv",";","wA",";","wB",";"]}]},{TYPE:"node",NAME:"SUBSURFACE_SCATTERING",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"wD",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wG",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wI",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wJ","[","0","]","=","wJ","[","1","]","=","wJ","[","2","]","=","_0_0",";","wD",";","wF",";","wG",";","wH",";","wI",";","wE",";"]}]},{TYPE:"node",NAME:"EMISSION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"wK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wM",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wO",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wP",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wQ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wR",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wS",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wW",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wT","=","wL","*","wK",";","wR","=","_0_0",";","wU","=","_1_0",";","wW","=","_1_0",";","wS","=","ot",";","wM",";","wN","=","vec3","(","_0_0",")",";","wO","=","_0_0",";","wP","=","vec3","(","_0_0",")",";","wQ","=","_0_0",";"]}]},{TYPE:"node",NAME:"AMBIENT_OCCLUSION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"wX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wY",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wY","[","0","]","=","wY","[","1","]","=","wY","[","2","]","=","_0_0",";","wX",";"]}]},{TYPE:"node",NAME:"HOLDOUT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"wZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wZ","[","0","]","=","wZ","[","1","]","=","wZ","[","2","]","=","_0_0",";"]}]},{TYPE:"node",NAME:"VOLUME_ABSORPTION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"w_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xa",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xb",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xb","[","0","]","=","xb","[","1","]","=","xb","[","2","]","=","_0_0",";","w_",";","xa",";"]}]},{TYPE:"node",NAME:"VOLUME_SCATTER",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xd",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xe",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xf",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xf","[","0","]","=","xf","[","1","]","=","xf","[","2","]","=","_0_0",";","xc",";","xd",";","xe",";"]}]},{TYPE:"node",NAME:"BUMP",NODE_VARS:[{TYPE:"node_var",NAME:"INVERT",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"xg",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xh",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xi",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xj",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xk",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","aM","=","xh",";","float","gH","=","xg",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["INVERT"],STATEMENTS:[{TYPE:"txt",TOKENS:["aM","=","-","_1_0",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","U","=","xj",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","U","=","ot",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_DERIVATIVES_EXT"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","xl","=","dFdx","(","os",")",";","vec3","xm","=","dFdy","(","os",")",";","vec3","xn","=","cross","(","xm",",","U",")",";","vec3","xo","=","cross","(","U",",","xl",")",";","float","dv","=","dot","(","xl",",","xn",")",";","float","xp","=","abs","(","dv",")",";","vec3","xq","=","dFdx","(","xi",")","*","xn","+","dFdy","(","xi",")","*","xo",";","gH","=","max","(","gH",",","_0_0",")",";","xk","=","normalize","(","xp","*","U","-","aM","*","sign","(","dv",")","*","xq",")",";","xk","=","normalize","(","gH","*","xk","+","(","_1_0","-","gH",")","*","U",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["xk","=","U",";"]}]}]}]},{TYPE:"node",NAME:"DISPLACEMENT_BUMP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xs",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","aM","=","0.1",";","vec3","U","=","ot",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_DERIVATIVES_EXT"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","xl","=","dFdx","(","os",")",";","vec3","xm","=","dFdy","(","os",")",";","vec3","xn","=","cross","(","xm",",","U",")",";","vec3","xo","=","cross","(","U",",","xl",")",";","float","dv","=","dot","(","xl",",","xn",")",";","float","xp","=","abs","(","dv",")",";","vec3","xq","=","dFdx","(","xr",")","*","xn","+","dFdy","(","xr",")","*","xo",";","xs","=","normalize","(","xp","*","U","-","aM","*","sign","(","dv",")","*","xq",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["xs","=","U",";"]}]}]}]},{TYPE:"node",NAME:"NORMAL_MAP",NODE_VARS:[{TYPE:"node_var",NAME:"SPACE",TOKENS:["NM_TANGENT"]},{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"xt",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xu",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xv",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xA",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","xB","=","xv",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","xB","=","sw",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["SPACE","NM_TANGENT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["xA","=","2.0","*","xu",".","xyz","-","_1_0",";","xA","=","sA","*","xA",";"]}]},{TYPE:"node_elif",EXPRESSION:["SPACE","NM_OBJECT",{TYPE:"equal_expr",PLACES:2},"SPACE","NM_BLENDER_OBJECT",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["xA","=","2.0","*","xu",".","xyz","-","_1_0",";","xA",".","yz","*=","-","_1_0",";","xA","=","_","(","u_model_tsr",",","xA",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["SPACE","NM_WORLD",{TYPE:"equal_expr",PLACES:2},"SPACE","NM_BLENDER_WORLD",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["xA","=","2.0","*","xu",".","xyz","-","_1_0",";","xA",".","yz","*=","-","_1_0",";"]}]}]},{TYPE:"txt",TOKENS:["float","ma","=","max","(","xt",",","_0_0",")",";","xA","=","normalize","(","mix","(","xB",",","xA",",","ma",")",")",";"]}]},{TYPE:"node",NAME:"VECT_TRANSFORM",NODE_VARS:[{TYPE:"node_var",NAME:"CONVERT_TYPE",TOKENS:["VT_WORLD_TO_OBJECT"]},{TYPE:"node_var",NAME:"VECTOR_TYPE",TOKENS:["VT_VECTOR"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"xC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xD",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{TYPE:"equal_expr",PLACES:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",{TYPE:"equal_expr",PLACES:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:3}],STATEMENTS:[{TYPE:"txt",TOKENS:["xD","=","xC",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["VECTOR_TYPE","VT_POINT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["xD","=","ap","(","u_view_tsr_frag",",","xC",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["xD","=","ap","(","u_model_tsr_inverse",",","xC",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["xD","=","ap","(","u_model_tsr",",","xC",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["xD","=","ap","(","u_model_tsr",",","xC",")",";","xD","=","ap","(","u_view_tsr_frag",",","xD",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["xD","=","ap","(","u_view_tsr_inverse",",","xC",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["xD","=","ap","(","u_view_tsr_inverse",",","xC",")",";","xD","=","ap","(","u_model_tsr_inverse",",","xD",")",";"]}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["xD","=","_","(","u_view_tsr_frag",",","xC",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["xD","=","_","(","u_model_tsr_inverse",",","xC",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["xD","=","_","(","u_model_tsr",",","xC",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["xD","=","_","(","u_model_tsr",",","xC",")",";","xD","=","_","(","u_view_tsr_frag",",","xD",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["xD","=","_","(","u_view_tsr_inverse",",","xC",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["xD","=","_","(","u_view_tsr_inverse",",","xC",")",";","xD","=","_","(","u_model_tsr_inverse",",","xD",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["VECTOR_TYPE","VT_NORMAL",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["xD","=","normalize","(","xD",")",";"]}]}]}]}]}]},{TYPE:"node",NAME:"BLACKBODY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xF",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xF","[","0","]","=","xF","[","1","]","=","xF","[","2","]","=","_0_0",";","xE",";"]}]},{TYPE:"node",NAME:"WAVELENGTH",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xG",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xH",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xH","[","0","]","=","xH","[","1","]","=","xH","[","2","]","=","_0_0",";","xG",";"]}]},{TYPE:"node",NAME:"SEPXYZ",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xI",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xJ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xL",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xJ","=","xI","[","0","]",";","xK","=","xI","[","1","]",";","xL","=","xI","[","2","]",";"]}]},{TYPE:"node",NAME:"COMBXYZ",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xN",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xO",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xP",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xP","[","0","]","=","xM",";","xP","[","1","]","=","xN",";","xP","[","2","]","=","xO",";"]}]},{TYPE:"node",NAME:"BRIGHTCONTRAST",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xR",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xS",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xT",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","b","=","xR","-","xS","*","_0_5",";","xT","=","max","(","(","_1_0","+","xS",")","*","xQ","+","b",",","vec3","(","_0_0",")",")",";"]}]},{TYPE:"node",NAME:"LIGHT_FALLOFF",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xV",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xW",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xY",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xW","=","xX","=","xY","=","_0_0",";","xU",";","xV",";"]}]},{TYPE:"node",NAME:"TEX_SKY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"x_",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["x_","[","0","]","=","x_","[","1","]","=","x_","[","2","]","=","_0_0",";","xZ",";"]}]},{TYPE:"node",NAME:"TEX_NOISE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"ya",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yc",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yd",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ye",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yf",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["ye","[","0","]","=","ye","[","1","]","=","ye","[","2","]","=","_0_0",";","yf","=","_1_0",";","ya",";","yb",";","yc",";","yd",";"]}]},{TYPE:"node",NAME:"TEX_WAVE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yh",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yi",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yk",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yl",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ym",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yl","[","0","]","=","yl","[","1","]","=","yl","[","2","]","=","_0_0",";","ym","=","_1_0",";","yg",";","yh",";","yi",";","yj",";","yk",";"]}]},{TYPE:"node",NAME:"TEX_VORONOI",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yn",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yo",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yp",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yq",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","[","0","]","=","yp","[","1","]","=","yp","[","2","]","=","_0_0",";","yq","=","_1_0",";","yn",";","yo",";"]}]},{TYPE:"node",NAME:"TEX_MUSGRAVE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yr",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ys",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yt",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yu",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yB",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yD",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yC","[","0","]","=","yC","[","1","]","=","yC","[","2","]","=","_0_0",";","yD","=","_1_0",";","yr",";","ys",";","yt",";","yu",";","yv",";","yA",";","yB",";"]}]},{TYPE:"node",NAME:"TEX_GRADIENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yG",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yF","[","0","]","=","yF","[","1","]","=","yF","[","2","]","=","_0_0",";","yG","=","_1_0",";","yE",";"]}]},{TYPE:"node",NAME:"TEX_MAGIC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yI",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yJ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yL",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yK","[","0","]","=","yK","[","1","]","=","yK","[","2","]","=","_0_0",";","yL","=","_1_0",";","yH",";","yI",";","yJ",";"]}]},{TYPE:"node",NAME:"TEX_CHECKER",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yM",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yR",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yQ","[","0","]","=","yQ","[","1","]","=","yQ","[","2","]","=","_0_0",";","yR","=","_1_0",";","yM",";","yN",";","yO",";","yP",";"]}]},{TYPE:"node",NAME:"TEX_BRICK",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yS",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yW",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yZ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"y_",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"za",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zb",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["za","[","0","]","=","za","[","1","]","=","za","[","2","]","=","_0_0",";","zb","=","_1_0",";","yS",";","yT",";","yU",";","yV",";","yW",";","yX",";","yY",";","yZ",";","y_",";"]}]},{TYPE:"node",NAME:"ADD_SHADER",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zd",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ze",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["ze","=","clamp","(","zc","+","zd",",","vec3","(","_0_0",")",",","vec3","(","_1_0",")",")",";"]}]},{TYPE:"node",NAME:"MIX_SHADER",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zf",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zh",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zi",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zk",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zl",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zm",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zn",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zo",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zp",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zs",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zt",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zu",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zD",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zF",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zI",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zM",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zO",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zP",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zQ",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","sqrt","(","clamp","(","zf",",","_0_0",",","_1_0",")",")",";","zH","=","mix","(","zi",",","zs",",","zR",")",";","zI","=","mix","(","zj",",","zt",",","zR",")",";","if","(","zm",">","_0_0",")","{","if","(","zA",">","_0_0",")","{","zJ","=","mix","(","zk",",","zu",",","zR",")",";","zK","=","mix","(","zl",",","zv",",","zR",")",";","}","else","{","zJ","=","zk",";","zK","=","zl",";","}","}","else","{","zJ","=","zu",";","zK","=","zv",";","}","if","(","zp",">","_0_0",")","{","if","(","zD",">","_0_0",")","{","zN","=","mix","(","zo",",","zC",",","zR",")",";","}","else","{","zN","=","zo",";","}","}","else","{","zN","=","zC",";","}","zL","=","mix","(","zm",",","zA",",","zR",")",";","zM","=","mix","(","zn",",","zB",",","zR",")",";","zO","=","mix","(","zp",",","zD",",","zR",")",";","zP","=","mix","(","zq",",","zE",",","zR",")",";","zQ","=","mix","(","zr",",","zF",",","zR",")",";"]}]},{TYPE:"node",NAME:"UV_MERGED",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"zS",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"si",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_zS"],STATEMENTS:[{TYPE:"txt",TOKENS:["zS","=","rX","(","si",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_zT"],STATEMENTS:[{TYPE:"txt",TOKENS:["zT","=","vec3","(","si",",","_0_0",")",";"]}]}]}]},{TYPE:"node",NAME:"TEX_COORD_UV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"zU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sj",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zU","=","vec3","(","sj",",","_0_0",")",";"]}]},{TYPE:"node",NAME:"TEX_COORD_NO",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"zV",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zV","=","ot",";"]}]},{TYPE:"node",NAME:"TEX_COORD_GE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"zW",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["IS_WORLD",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zW","=","rT",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["zW","=","sr",";"]}]}]}]},{TYPE:"node",NAME:"TEX_COORD_OB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"zX",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["IS_WORLD",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zX","=","ap","(","u_model_tsr_inverse",",","os",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["zX","=","sr",";"]}]}]}]},{TYPE:"node",NAME:"TEX_COORD_CA",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"zY",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zY",".","xy","=","sB",".","xy",";","zY",".","z","=","_1_0",";"]}]},{TYPE:"node",NAME:"TEX_COORD_WI",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"zZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zZ",".","xy","=","l",".","xy","/","l",".","z",";","zZ",".","z","=","_0_0",";"]}]},{TYPE:"node",NAME:"TEX_COORD_RE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"z_",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["z_","=","reflect","(","-","ou",",","ot",")",";"]}]},{TYPE:"node",NAME:"UVMAP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"Aa",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sk",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Aa","=","vec3","(","sk",",","_0_0",")",";"]}]},{TYPE:"node",NAME:"PARTICLE_INFO",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"Ab",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ac",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ad",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ae",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Af",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ag",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ah",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Ab","=","_0_0",";","Ac","=","_0_0",";","Ad","=","_0_0",";","Ae","=","vec3","(","_0_0",")",";","Af","=","_0_0",";","Ag","=","Ae",";","Ah","=","Ae",";"]}]},{TYPE:"node",NAME:"HAIR_INFO",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"Ai",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Aj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ak",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Al",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Ai","=","_0_0",";","Aj","=","_0_0",";","Ak","=","_0_0",";","Al","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"OBJECT_INFO",NODE_VARS:[{TYPE:"node_var",NAME:"USE_LOCATION_OUT",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_OBJ_IND_OUT",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_MAT_IND_OUT",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_RANDOM_OUT",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_out",NAME:"Am",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"An",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ao",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ap",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_LOCATION_OUT"],STATEMENTS:[{TYPE:"txt",TOKENS:["Am","=","u_model_tsr","[","0","]",".","xyz",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OBJ_IND_OUT"],STATEMENTS:[{TYPE:"txt",TOKENS:["An","=","u_obj_info",".","r",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MAT_IND_OUT"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ao","=","u_obj_info",".","g",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_RANDOM_OUT"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ap","=","u_obj_info",".","b",";"]}]}]}]},{TYPE:"node",NAME:"WIREFRAME",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Aq",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ar",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Ar","=","Aq",";"]}]},{TYPE:"node",NAME:"TANGENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"As",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["As","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"LAYER_WEIGHT",NODE_VARS:[{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"At",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Au",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Av",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Aw",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","cr","=","normalize","(","Au",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","cr","=","ot",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CAMERA_TYPE","CAM_TYPE_PERSP",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","Ax","=","normalize","(","ou",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","Ax","=","u_camera_direction",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Av"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","sa","=","max","(","_1_0","-","At",",","0.00001",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"non_equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["sa","=","gl_FrontFacing","==","false","?","sa",":","_1_0","/","sa",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["sa","=","gl_FrontFacing","?","sa",":","_1_0","/","sa",";"]}]}]},{TYPE:"txt",TOKENS:["Av","=","sb","(","Ax",",","cr",",","sa",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["Av","=","_0_0",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Aw"],STATEMENTS:[{TYPE:"txt",TOKENS:["Aw","=","abs","(","dot","(","Ax",",","cr",")",")",";","float","ew","=","At",";","if","(","ew","!=","_0_5",")","{","ew","=","clamp","(","ew",",","_0_0",",","0.99999",")",";","ew","=","(","ew","<","_0_5",")","?","2.0","*","ew",":","_0_5","/","(","_1_0","-","ew",")",";","Aw","=","pow","(","Aw",",","ew",")",";","}","Aw","=","_1_0","-","Aw",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["Aw","=","_0_0",";"]}]}]}]},{TYPE:"node",NAME:"LIGHT_PATH",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"Ay",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Az",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AB",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AC",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AD",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AF",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AG",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AI",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Ay","=","Az","=","AA","=","_0_0",";","AB","=","AC","=","AD","=","_0_0",";","AE","=","AI","=","AG","=","AH","=","_0_0",";","AF","=","_0_0",";"]}]},{TYPE:"node",NAME:"ATTRIBUTE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AL",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AJ","=","AK","=","vec3","(","_0_0",")",";","AL","=","_0_0",";"]}]},{TYPE:"node",NAME:"SCRIPT",NODE_VARS:[],DECLARATIONS:[],STATEMENTS:[]},{TYPE:"node",NAME:"CURVE_VEC",NODE_VARS:[{TYPE:"node_var",NAME:"READ_R",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_G",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_B",TOKENS:["0"]},{TYPE:"node_var",NAME:"NODE_TEX_ROW",TOKENS:["_0_0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"AM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"AN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AO",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AO","=","AN",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_R"],STATEMENTS:[{TYPE:"txt",TOKENS:["AO",".","r","=","(","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","_0_5","*","AN",".","r","+","_0_5",",","NODE_TEX_ROW",")",")",".","r","-","_0_5",")","*","2.0",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_G"],STATEMENTS:[{TYPE:"txt",TOKENS:["AO",".","g","=","(","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","_0_5","*","AN",".","g","+","_0_5",",","NODE_TEX_ROW",")",")",".","g","-","_0_5",")","*","2.0",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_B"],STATEMENTS:[{TYPE:"txt",TOKENS:["AO",".","b","=","(","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","_0_5","*","AN",".","b","+","_0_5",",","NODE_TEX_ROW",")",")",".","b","-","_0_5",")","*","2.0",";"]}]}]},{TYPE:"txt",TOKENS:["AO","=","mix","(","AN",",","AO",",","AM",")",";"]}]},{TYPE:"node",NAME:"CURVE_RGB",NODE_VARS:[{TYPE:"node_var",NAME:"READ_A",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_R",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_G",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_B",TOKENS:["0"]},{TYPE:"node_var",NAME:"NODE_TEX_ROW",TOKENS:["_0_0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"AP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"AQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AR",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_A"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","r","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","AQ",".","r",",","NODE_TEX_ROW",")",")",".","a",";","float","g","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","AQ",".","g",",","NODE_TEX_ROW",")",")",".","a",";","float","b","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","AQ",".","b",",","NODE_TEX_ROW",")",")",".","a",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","r","=","AQ",".","r",";","float","g","=","AQ",".","g",";","float","b","=","AQ",".","b",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_R"],STATEMENTS:[{TYPE:"txt",TOKENS:["AR",".","r","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","r",",","NODE_TEX_ROW",")",")",".","r",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["AR",".","r","=","r",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_G"],STATEMENTS:[{TYPE:"txt",TOKENS:["AR",".","g","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","g",",","NODE_TEX_ROW",")",")",".","g",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["AR",".","g","=","g",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_B"],STATEMENTS:[{TYPE:"txt",TOKENS:["AR",".","b","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","b",",","NODE_TEX_ROW",")",")",".","b",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["AR",".","b","=","b",";"]}]}]},{TYPE:"txt",TOKENS:["AR","=","mix","(","AQ",",","AR",",","AP",")",";"]}]},{TYPE:"node",NAME:"VALTORGB",NODE_VARS:[{TYPE:"node_var",NAME:"NODE_TEX_ROW",TOKENS:["_0_0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"AS",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AU",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec4","AV","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","AS",",","NODE_TEX_ROW",")",")",";","AT","=","AV",".","rgb",";","AU","=","AV",".","a",";"]}]},{TYPE:"node",NAME:"MAPPING",NODE_VARS:[{TYPE:"node_var",NAME:"MAPPING_SCALE_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_SCALE",TOKENS:["vec3","(","_1_0",")"]},{TYPE:"node_var",NAME:"MAPPING_TRANS_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_TRANS",TOKENS:["vec3","(","_0_0",")"]},{TYPE:"node_var",NAME:"MAPPING_TRS_MATRIX_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_TRS_MATRIX",TOKENS:["mat4","(","_1_0",")"]},{TYPE:"node_var",NAME:"MAPPING_MIN_CLIP_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_MIN_CLIP",TOKENS:["vec3","(","_0_0",")"]},{TYPE:"node_var",NAME:"MAPPING_MAX_CLIP_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_MAX_CLIP",TOKENS:["vec3","(","_1_0",")"]},{TYPE:"node_var",NAME:"MAPPING_IS_NORMAL",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"AW",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AX",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AX","=","AW",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_SCALE_DEF"],STATEMENTS:[{TYPE:"txt",TOKENS:["AX","=","AX","*","MAPPING_SCALE",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_TRANS_DEF"],STATEMENTS:[{TYPE:"txt",TOKENS:["AX","=","AX","+","MAPPING_TRANS",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_TRS_MATRIX_DEF"],STATEMENTS:[{TYPE:"txt",TOKENS:["AX","=","(","MAPPING_TRS_MATRIX","*","vec4","(","AX",",","_1_0",")",")",".","xyz",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_MIN_CLIP_DEF"],STATEMENTS:[{TYPE:"txt",TOKENS:["AX","=","max","(","AX",",","MAPPING_MIN_CLIP",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_MAX_CLIP_DEF"],STATEMENTS:[{TYPE:"txt",TOKENS:["AX","=","min","(","AX",",","MAPPING_MAX_CLIP",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_IS_NORMAL"],STATEMENTS:[{TYPE:"txt",TOKENS:["AX","=","normalize","(","AX",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_ADD",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"AY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"AZ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"A_",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["A_","=","AY","+","AZ",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["A_","=","clamp","(","A_",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_SUBTRACT",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ba",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Bb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bc",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Bc","=","Ba","-","Bb",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Bc","=","clamp","(","Bc",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_MULTIPLY",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Bd",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Be",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bf",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Bf","=","Bd","*","Be",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Bf","=","clamp","(","Bf",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_DIVIDE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Bg",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Bh",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bi",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Bi","=","(","Bh","!=","_0_0",")","?","Bg","/","Bh",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Bi","=","clamp","(","Bi",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_SINE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Bj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Bk",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bl",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Bl","=","sin","(","Bj",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Bl","=","clamp","(","Bl",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["Bk",";"]}]},{TYPE:"node",NAME:"MATH_COSINE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Bm",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Bn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bo",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Bo","=","cos","(","Bm",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Bo","=","clamp","(","Bo",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["Bn",";"]}]},{TYPE:"node",NAME:"MATH_TANGENT",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Bp",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Bq",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Br",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Br","=","tan","(","Bp",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Br","=","clamp","(","Br",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["Bq",";"]}]},{TYPE:"node",NAME:"MATH_ARCSINE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Bs",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Bt",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bu",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Bu","=","(","Bs","<=","_1_0","&&","Bs",">=","-","_1_0",")","?","asin","(","Bs",")",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Bu","=","clamp","(","Bu",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["Bt",";"]}]},{TYPE:"node",NAME:"MATH_ARCCOSINE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Bv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Bw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bx",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Bx","=","(","Bv","<=","_1_0","&&","Bv",">=","-","_1_0",")","?","acos","(","Bv",")",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Bx","=","clamp","(","Bx",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["Bw",";"]}]},{TYPE:"node",NAME:"MATH_ARCTANGENT",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"By",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Bz",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BA",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BA","=","atan","(","By",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["BA","=","clamp","(","BA",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["Bz",";"]}]},{TYPE:"node",NAME:"MATH_POWER",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BB",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BC",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BD",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["if","(","BB","<","_0_0","&&","BC","!=","floor","(","BC",")",")","BD","=","_0_0",";","else","if","(","BC","==","_0_0",")","BD","=","_1_0",";","else","if","(","BB","<","_0_0",")","BD","=","mix","(","_1_0",",","-","_1_0",",","sign","(","mod","(","-","BC",",","2.0",")",")",")","*","pow","(","-","BB",",","BC",")",";","else","if","(","BB","==","_0_0",")","BD","=","_0_0",";","else","BD","=","pow","(","BB",",","BC",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["BD","=","clamp","(","BD",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_LOGARITHM",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BF",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BG",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BG","=","(","BE",">","_0_0","&&","BF",">","_0_0",")","?","log2","(","BE",")","/","log2","(","BF",")",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["BG","=","clamp","(","BG",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_MINIMUM",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BI",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BJ",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BJ","=","min","(","BH",",","BI",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["BJ","=","clamp","(","BJ",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_MAXIMUM",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BM",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BM","=","max","(","BK",",","BL",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["BM","=","clamp","(","BM",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_ROUND",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BN",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BO",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BP",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BP","=","floor","(","BN","+","_0_5",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["BP","=","clamp","(","BP",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["BO",";"]}]},{TYPE:"node",NAME:"MATH_LESS_THAN",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BQ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BR",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BS",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BS","=","(","BQ","<","BR",")","?","_1_0",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["BS","=","clamp","(","BS",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_GREATER_THAN",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BT",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BV",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BV","=","(","BT",">","BU",")","?","_1_0",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["BV","=","clamp","(","BV",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_MODULO",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BW",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BY",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BY","=","abs","(","BX",")",">","0.000001","?","mod","(","BW",",","BX",")",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["BY","=","clamp","(","BY",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_ABSOLUTE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BZ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"B_",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ca",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Ca","=","abs","(","BZ",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ca","=","clamp","(","Ca",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["B_",";"]}]},{TYPE:"node",NAME:"MIX_RGB_MIX",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cd",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ce",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","Cb",",","_0_0",",","_1_0",")",";","Ce","=","mix","(","Cc",",","Cd",",","zR",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ce","=","clamp","(","Ce",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_ADD",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cf",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ch",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ci",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","Cf",",","_0_0",",","_1_0",")",";","Ci","=","mix","(","Cg",",","Cg","+","Ch",",","zR",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ci","=","clamp","(","Ci",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_MULTIPLY",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ck",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cl",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cm",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","Cj",",","_0_0",",","_1_0",")",";","Cm","=","mix","(","Ck",",","Ck","*","Cl",",","zR",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cm","=","clamp","(","Cm",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_SUBTRACT",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Co",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cp",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cq",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","Cn",",","_0_0",",","_1_0",")",";","Cq","=","mix","(","Co",",","Co","-","Cp",",","zR",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cq","=","clamp","(","Cq",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_SCREEN",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cs",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ct",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cu",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","Cr",",","_0_0",",","_1_0",")",";","float","Cv","=","_1_0","-","zR",";","Cu","=","vec3","(","_1_0",")","-","(","vec3","(","Cv",")","+","zR","*","(","vec3","(","_1_0",")","-","Ct",")",")","*","(","vec3","(","_1_0",")","-","Cs",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cu","=","clamp","(","Cu",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_DIVIDE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cx",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cy",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cz",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","Cw",",","_0_0",",","_1_0",")",";","float","Cv","=","_1_0","-","zR",";","Cy","+=","step","(","Cy",",","vec3","(","_0_0",")",")",";","Cz","=","Cv","*","Cx","+","zR","*","Cx","/","Cy",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cz","=","clamp","(","Cz",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_DIFFERENCE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CD",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","CA",",","_0_0",",","_1_0",")",";","CD","=","mix","(","CB",",","abs","(","CB","-","CC",")",",","zR",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CD","=","clamp","(","CD",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_DARKEN",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CH",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","CE",",","_0_0",",","_1_0",")",";","CH","=","min","(","CF",".","rgb",",","CG",".","rgb","*","zR",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CH","=","clamp","(","CH",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_LIGHTEN",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CI",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CL",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","CI",",","_0_0",",","_1_0",")",";","CL","=","max","(","CJ",".","rgb",",","CK",".","rgb","*","zR",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CL","=","clamp","(","CL",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_OVERLAY",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CP",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","CM",",","_0_0",",","_1_0",")",";","vec3","CQ","=","vec3","(","_1_0","-","zR",")",";","CP","=","mix","(","CN","*","(","CQ","+","2.0","*","zR","*","CO",")",",","vec3","(","_1_0",")","-","(","CQ","+","2.0","*","zR","*","(","vec3","(","_1_0",")","-","CO",")",")","*","(","vec3","(","_1_0",")","-","CN",")",",","step","(","_0_5",",","CN",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CP","=","clamp","(","CP",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_DODGE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CR",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CS",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CU",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","CR",",","_0_0",",","_1_0",")",";","vec3","CV","=","vec3","(","_1_0",")","-","zR","*","CT",";","vec3","CW","=","clamp","(","CS","/","CV",",","_0_0",",","_1_0",")",";","CU","=","mix","(","mix","(","CW",",","vec3","(","_1_0",")",",","step","(","CV",",","vec3","(","_0_0",")",")",")",",","CS",",","step","(","CS",",","vec3","(","_0_0",")",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CU","=","clamp","(","CU",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_BURN",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"C_",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","CX",",","_0_0",",","_1_0",")",";","vec3","ko","=","vec3","(","_1_0","-","zR",")",";","vec3","CV","=","ko","+","zR","*","CZ",";","vec3","CW","=","clamp","(","vec3","(","_1_0",")","-","(","vec3","(","_1_0",")","-","CY",")","/","CV",",","_0_0",",","_1_0",")",";","C_","=","mix","(","CW",",","vec3","(","_0_0",")",",","step","(","CV",",","vec3","(","_0_0",")",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["C_","=","clamp","(","C_",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_HUE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Da",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Db",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Dd",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","Da",",","_0_0",",","_1_0",")",";","vec3","kg",",","De",",","CV",";","Dd","=","Db",";","De","=","kf","(","Dc",")",";","if","(","De",".","y","!=","_0_0",")","{","kg","=","kf","(","Dd",")",";","kg",".","x","=","De",".","x",";","CV","=","kh","(","kg",")",";","Dd","=","mix","(","Dd",",","CV",",","zR",")",";","}"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Dd","=","clamp","(","Dd",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_SATURATION",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Df",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dh",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Di",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","Df",",","_0_0",",","_1_0",")",";","float","Cv","=","_1_0","-","zR",";","Di","=","Dg",";","vec3","kg",",","De",";","kg","=","kf","(","Di",")",";","if","(","kg",".","y","!=","_0_0",")","{","De","=","kf","(","Dh",")",";","kg",".","y","=","Cv","*","kg",".","y","+","zR","*","De",".","y",";","Di","=","kh","(","kg",")",";","}"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Di","=","clamp","(","Di",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_VALUE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Dj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dk",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dl",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Dm",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","Dj",",","_0_0",",","_1_0",")",";","float","Cv","=","_1_0","-","zR",";","vec3","kg",",","De",";","kg","=","kf","(","Dk",")",";","De","=","kf","(","Dl",")",";","kg",".","z","=","Cv","*","kg",".","z","+","zR","*","De",".","z",";","Dm","=","kh","(","kg",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Dm","=","clamp","(","Dm",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_COLOR",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Dn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Do",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dp",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Dq",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","Dn",",","_0_0",",","_1_0",")",";","vec3","kg",",","De",",","CV",";","Dq","=","Do",";","De","=","kf","(","Dp",")",";","if","(","De",".","y","!=","_0_0",")","{","kg","=","kf","(","Dq",")",";","kg",".","x","=","De",".","x",";","kg",".","y","=","De",".","y",";","CV","=","kh","(","kg",")",";","Dq","=","mix","(","Dq",",","CV",",","zR",")",";","}"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Dq","=","clamp","(","Dq",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_SOFT_LIGHT",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Dr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ds",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dt",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Du",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","Dr",",","_0_0",",","_1_0",")",";","float","Cv","=","_1_0","-","zR",";","vec3","Dv","=","Dt","+","Ds","-","Dt","*","Ds",";","Du","=","Ds","*","(","vec3","(","Cv",")","+","vec3","(","zR",")","*","(","(","vec3","(","_1_0",")","-","Ds",")","*","Dt","+","Dv",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Du","=","clamp","(","Du",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_LINEAR_LIGHT",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Dw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dx",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dy",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Dz",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","Dw",",","_0_0",",","_1_0",")",";","Dz","=","Dx","+","zR","*","(","2.0","*","Dy","-","vec3","(","_1_0",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Dz","=","clamp","(","Dz",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_WORLD_RGB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"DA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DD",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","DA",",","_0_0",",","_1_0",")",";","DD","=","mix","(","DB",",","DC",",","zR",")",";"]}]},{TYPE:"node",NAME:"ADD_WORLD_RGB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"DE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DH",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","DE",",","_0_0",",","_1_0",")",";","DH","=","mix","(","DF",",","DF","+","DG",",","zR",")",";"]}]},{TYPE:"node",NAME:"OUTPUT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"DI",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DJ",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["E","=","DI",";","I","=","DJ",";"]}]},{TYPE:"node",NAME:"OUTPUT_SURFACE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"DK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DL",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["E","=","DK",";","I","=","DL",";"]}]},{TYPE:"node",NAME:"OUTPUT_WORLD_SURFACE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"DM",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["E","=","DM",";","I","=","_1_0",";"]}]},{TYPE:"node",NAME:"MATERIAL_BEGIN",NODE_VARS:[{TYPE:"node_var",NAME:"MATERIAL_EXT",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_MATERIAL_NORMAL",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_MATERIAL_DIFFUSE",TOKENS:["0"]},{TYPE:"node_var",NAME:"SHADELESS_MAT",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DQ",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"DR",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"DS",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DW",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DX",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DY",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DZ",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sl",QUALIFIER:["const","vec2"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sm",QUALIFIER:["const","vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["DU","=","DN",";","DV","=","sm","[","0","]","*","DO",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_NORMAL"],STATEMENTS:[{TYPE:"txt",TOKENS:["DW","=","normalize","(","DQ",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["DW","=","ot",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["SHADELESS_MAT",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATERIAL_EXT"],STATEMENTS:[{TYPE:"txt",TOKENS:["DS","=","DR","*","DU",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["DS","=","sC","*","DU",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_DIFFUSE"],STATEMENTS:[{TYPE:"txt",TOKENS:["DU","*=","DP",";"]}]}]},{TYPE:"txt",TOKENS:["DT","=","sD","*","u_environment_energy","*","cz","(","DW",")",";","DZ","=","cC","(","DU",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NUM_LIGHTS",0,{TYPE:"g_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["DX","=","vec2","(","sl","[","0","]",",","sl","[","1","]",")",";","DY","=","vec2","(","sm","[","1","]",",","sm","[","2","]",")",";"]}]}]},{TYPE:"txt",TOKENS:["H","=","DZ",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["DS","=","vec3","(","_0_0",")",";","DT","=","vec3","(","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATERIAL_END",NODE_VARS:[{TYPE:"node_var",NAME:"MATERIAL_EXT",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_MATERIAL_DIFFUSE",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_MATERIAL_SPECULAR",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"D_",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ea",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Eb",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ec",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"Ed",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"Ee",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Ef",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Eg",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Eh",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Ei",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Ej",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"sn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"so",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ef"],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_DIFFUSE"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ef","=","D_",".","rgb",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["Ef","=","vec3","(","_0_0",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATERIAL_EXT","REFLECTION_TYPE","REFL_NONE",{TYPE:"non_equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["cL","(","Ef",",","ou",",","Eb",",","Ec",",","u_view_tsr_frag",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["cL","(","Ef",",","ou",",","Eb",",","Ec",",","mat3","(","_0_0",")",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_SPECULAR"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ef","+=","Ea",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Eh"],STATEMENTS:[{TYPE:"txt",TOKENS:["Eh","=","Eb",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATERIAL_EXT"],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ei"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ei","=","D_",".","rgb",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ej"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ej","=","Ea",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Eg"],STATEMENTS:[{TYPE:"txt",TOKENS:["Eg","=","clamp","(","Ee",",","_0_0",",","_1_0",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_SPECULAR"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","t","=","max","(","max","(","Ea",".","r",",","Ea",".","g",")",",","Ea",".","b",")","*","Ed",";","Eg","=","clamp","(","Ee","*","(","_1_0","-","t",")","+","t",",","_0_0",",","_1_0",")",";"]}]}]}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Eg"],STATEMENTS:[{TYPE:"txt",TOKENS:["Eg","=","clamp","(","sn",",","_0_0",",","_1_0",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_SPECULAR"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","t","=","max","(","max","(","Ea",".","r",",","Ea",".","g",")",",","Ea",".","b",")","*","so",";","Eg","=","sn","*","(","_1_0","-","t",")","+","t",";"]}]}]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_SPECULAR"],STATEMENTS:[{TYPE:"txt",TOKENS:["F","=","Ea",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["F","=","vec3","(","_0_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["G","=","Eb",";"]}]},{TYPE:"node",NAME:"LIGHTING_AMBIENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"oL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"oM",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"oN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oO",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oP",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["oO","=","vec4","(","oL","+","oN","*","oM",",","_0_0",")",";","oP","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"LIGHTING_LAMP",NODE_VARS:[{TYPE:"node_var",NAME:"LAMP_TYPE",TOKENS:["HEMI"]},{TYPE:"node_var",NAME:"LAMP_IND",TOKENS:["0"]},{TYPE:"node_var",NAME:"LAMP_SPOT_SIZE",TOKENS:["0.8"]},{TYPE:"node_var",NAME:"LAMP_SPOT_BLEND",TOKENS:["0.03"]},{TYPE:"node_var",NAME:"LAMP_LIGHT_DIST",TOKENS:["30.0"]},{TYPE:"node_var",NAME:"LAMP_SHADOW_MAP_IND",TOKENS:["-","1"]},{TYPE:"node_var",NAME:"LAMP_USE_SPHERE",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"oQ",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oS",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oU",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["oS","=","vec2","(","u_light_positions","[","LAMP_IND","]",".","w",",","u_light_color_intensities","[","LAMP_IND","]",".","w",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","HEMI",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["oU","=","_0_5",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["oU","=","_0_0",";"]}]}]},{TYPE:"txt",TOKENS:["oT","=","u_light_color_intensities","[","LAMP_IND","]",".","xyz",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_SHADOW_MAP_IND",1,{TYPE:"negative_expr",PLACES:1},{TYPE:"non_equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["oT","*=","oQ","[","LAMP_SHADOW_MAP_IND","]",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2},"LAMP_TYPE","POINT",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","oV","=","u_light_positions","[","LAMP_IND","]",".","xyz",";","oR","=","oV","-","os",";","float","aM","=","length","(","oR",")",";","oT","*=","LAMP_LIGHT_DIST","/","(","LAMP_LIGHT_DIST","+","aM","*","aM",")",";","oR","=","normalize","(","oR",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","oX","=","u_light_directions","[","LAMP_IND","]",";","float","oY","=","dot","(","oR",",","oX",")",";","oY","*=","smoothstep","(","_0_0",",","_1_0",",","(","oY","-","LAMP_SPOT_SIZE",")","/","LAMP_SPOT_BLEND",")",";","oT","*=","oY",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_USE_SPHERE"],STATEMENTS:[{TYPE:"txt",TOKENS:["oT","*=","max","(","LAMP_LIGHT_DIST","-","aM",",","_0_0",")","/","LAMP_LIGHT_DIST",";"]}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["oR","=","u_light_directions","[","LAMP_IND","]",";"]}]}]}]},{TYPE:"node",NAME:"DIFFUSE_FRESNEL",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"oZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"o_",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pa",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pc",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pd",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","r_","=","pa",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pe","=","cross","(","oZ",",","B",".","xyz",")",";","r_","=","cross","(","pe",",","B",".","xyz",")",";","r_","=","-","normalize","(","r_",")",";"]}]}]},{TYPE:"txt",TOKENS:["pd","=","_0_0",";","if","(","o_",".","r","!=","_0_0",")","{","float","pf","=","(","_1_0","-","pb",")","*","dot","(","r_",",","oZ",")","+","pb",";","if","(","pc","[","0","]","==","_0_0",")","{","pd","=","_1_0",";","}","else","{","float","t","=","_1_0","+","abs","(","pf",")",";","t","=","pc","[","1","]","+","(","_1_0","-","pc","[","1","]",")","*","pow","(","t",",","pc","[","0","]",")",";","pd","=","clamp","(","t",",","_0_0",",","_1_0",")",";","}","pd","=","max","(","pd",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"DIFFUSE_LAMBERT",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ph",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pi",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pk",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","r_","=","pi",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pe","=","cross","(","pg",",","B",".","xyz",")",";","r_","=","cross","(","pe",",","B",".","xyz",")",";","r_","=","-","normalize","(","r_",")",";"]}]}]},{TYPE:"txt",TOKENS:["pk","=","_0_0",";","if","(","ph",".","r","!=","_0_0",")","{","float","pf","=","(","_1_0","-","pj",")","*","dot","(","r_",",","pg",")","+","pj",";","pk","=","max","(","pf",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"DIFFUSE_OREN_NAYAR",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pl",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pm",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pn",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"po",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pr",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pu",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","r_","=","pn",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pe","=","cross","(","pl",",","B",".","xyz",")",";","r_","=","cross","(","pe",",","B",".","xyz",")",";","r_","=","-","normalize","(","r_",")",";"]}]}]},{TYPE:"txt",TOKENS:["pu","=","_0_0",";","if","(","pm",".","r","!=","_0_0",")","{","float","pf","=","(","_1_0","-","po",")","*","dot","(","r_",",","pl",")","+","po",";","if","(","pr","[","0","]",">","_0_0",")","{","float","pv","=","max","(","dot","(","r_",",","ou",")",",","_0_0",")",";","float","pw","=","pr","[","0","]","*","pr","[","0","]",";","float","cB","=","_1_0","-","_0_5","*","(","pw","/","(","pw","+","0.33",")",")",";","vec3","px","=","pl","-","pf","*","r_",";","vec3","py","=","ou","-","pv","*","r_",";","if","(","length","(","px",")","==","_0_0","||","length","(","py",")","==","_0_0","||","abs","(","pf",")",">","_1_0","||","abs","(","pv",")",">","_1_0",")","pu","=","pf","*","cB",";","else","{","float","pz","=","acos","(","pf",")",";","float","pA","=","acos","(","pv",")",";","vec3","pB","=","normalize","(","px",")",";","vec3","pC","=","normalize","(","py",")",";","float","a",",","b",";","a","=","max","(","pz",",","pA",")",";","b","=","min","(","pz",",","pA",")",";","b","*=","0.95",";","float","t","=","max","(","dot","(","pB",",","pC",")",",","_0_0",")",";","float","hO","=","0.45","*","(","pw","/","(","pw","+","0.09",")",")",";","pu","=","pf","*","(","cB","+","(","hO","*","t","*","sin","(","a",")","*","tan","(","b",")",")",")",";","}","}","else","pu","=","pf",";","pu","=","max","(","pu",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"DIFFUSE_MINNAERT",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pD",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pE",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pG",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pH",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pI",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","r_","=","pF",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pe","=","cross","(","pD",",","B",".","xyz",")",";","r_","=","cross","(","pe",",","B",".","xyz",")",";","r_","=","-","normalize","(","r_",")",";"]}]}]},{TYPE:"txt",TOKENS:["pI","=","_0_0",";","if","(","pE",".","r","!=","_0_0",")","{","float","pf","=","(","_1_0","-","pG",")","*","dot","(","r_",",","pD",")","+","pG",";","float","pv","=","max","(","dot","(","r_",",","ou",")",",","_0_0",")",";","if","(","pH","[","0","]","<=","_1_0",")","pI","=","pf","*","pow","(","max","(","pv","*","pf",",","0.1",")",",","pH","[","0","]","-","_1_0",")",";","else","pI","=","pf","*","pow","(","1.0001","-","pv",",","pH","[","0","]","-","_1_0",")",";","pI","=","max","(","pI",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"DIFFUSE_TOON",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pK",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pN",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pO",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","r_","=","pL",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pe","=","cross","(","pJ",",","B",".","xyz",")",";","r_","=","cross","(","pe",",","B",".","xyz",")",";","r_","=","-","normalize","(","r_",")",";"]}]}]},{TYPE:"txt",TOKENS:["pO","=","_0_0",";","if","(","pK",".","r","!=","_0_0",")","{","float","pf","=","(","_1_0","-","pM",")","*","dot","(","r_",",","pJ",")","+","pM",";","float","pP","=","acos","(","pf",")",";","if","(","pP","<","pN","[","0","]",")","pO","=","_1_0",";","else","if","(","pP",">","(","pN","[","0","]","+","pN","[","1","]",")","||","pN","[","1","]","==","_0_0",")","pO","=","_0_0",";","else","pO","=","_1_0","-","(","(","pP","-","pN","[","0","]",")","/","pN","[","1","]",")",";","pO","=","max","(","pO",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_PHONG",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pR",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pS",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pT",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pU",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pV",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["pV","=","_0_0",";","if","(","pR",".","g","==","_1_0",")","{","vec3","pW","=","normalize","(","pQ","+","ou",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["if","(","pT","==","_0_0",")","{","pV","=","dot","(","B",".","xyz",",","pW",")",";","pV","=","sqrt","(","_1_0","-","pV","*","pV",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["pV","=","(","_1_0","-","pT",")","*","max","(","dot","(","pS",",","pW",")",",","_0_0",")","+","pT",";"]}]}]},{TYPE:"txt",TOKENS:["pV","=","pow","(","pV",",","pU","[","0","]",")",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_COOKTORR",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pY",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"p_",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qa",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qb",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["qb","=","_0_0",";","if","(","pY",".","g","!=","_0_0",")","{","vec3","pW","=","normalize","(","pX","+","ou",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["if","(","p_","==","_0_0",")","{","qb","=","dot","(","B",".","xyz",",","pW",")",";","qb","=","sqrt","(","_1_0","-","qb","*","qb",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["qb","=","max","(","dot","(","pZ",",","pW",")",",","_0_0",")",";","qb","=","(","_1_0","-","p_",")","*","qb","+","p_",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","pv","=","max","(","dot","(","B",".","xyz",",","ou",")",",","_0_0",")",";","pv","=","sqrt","(","_1_0","-","pv","*","pv",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","pv","=","max","(","dot","(","pZ",",","ou",")",",","_0_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["qb","=","pow","(","qb",",","qa","[","0","]",")",";","qb","=","qb","/","(","0.1","+","pv",")",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_WARDISO",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qd",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qe",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qf",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qg",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qh",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["qh","=","_0_0",";","if","(","qd",".","g","==","_1_0",")","{","vec3","pW","=","normalize","(","qc","+","ou",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","qi","=","_0_0",";","float","pv","=","_0_0",";","float","qj","=","_0_0",";","if","(","qf","==","_0_0",")","{","qi","=","dot","(","B",".","xyz",",","pW",")",";","pv","=","dot","(","B",".","xyz",",","ou",")",";","qj","=","dot","(","B",".","xyz",",","qc",")",";","qi","=","sqrt","(","_1_0","-","qi","*","qi",")",";","pv","=","sqrt","(","_1_0","-","pv","*","pv",")",";","qj","=","sqrt","(","_1_0","-","qj","*","qj",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","qi","=","max","(","dot","(","qe",",","pW",")",",","0.01",")",";","float","pv","=","max","(","dot","(","qe",",","ou",")",",","0.01",")",";","float","qj","=","max","(","dot","(","qe",",","qc",")",",","0.01",")",";"]}]}]},{TYPE:"txt",TOKENS:["float","bK","=","tan","(","acos","(","qi",")",")",";","float","L","=","max","(","qg","[","0","]",",","0.01",")",";","qh","=","qj","*","(","_1_0","/","(","4.0","*","M_PI","*","L","*","L",")",")","*","(","exp","(","-","(","bK","*","bK",")","/","(","L","*","L",")",")","/","(","sqrt","(","pv","*","qj",")",")",")",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_TOON",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qk",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ql",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qm",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qo",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qr",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["qr","=","_0_0",";","if","(","ql",".","g","==","_1_0",")","{","vec3","cj","=","normalize","(","qk","+","ou",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","qu","=","dot","(","cj",",","B",".","xyz",")",";","float","bK","=","qo","[","0","]","+","qo","[","1","]",";","if","(","qn","==","_0_0",")","bK","=","acos","(","sqrt","(","_1_0","-","qu","*","qu",")",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","bK","=","acos","(","dot","(","cj",",","qm",")",")",";"]}]}]},{TYPE:"txt",TOKENS:["if","(","bK","<","qo","[","0","]",")","qr","=","_1_0",";","else","if","(","bK",">=","qo","[","0","]","+","qo","[","1","]","||","qo","[","1","]","==","_0_0",")","qr","=","_0_0",";","else","qr","=","_1_0","-","(","bK","-","qo","[","0","]",")","/","qo","[","1","]",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_BLINN",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qv",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qw",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qx",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qy",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qz",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qA",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","qB","=","qz","[","0","]",";","float","qC","=","qz","[","1","]",";","qA","=","_0_0",";","if","(","qw",".","g","==","_1_0",")","{","if","(","qB","<","_1_0","||","qC","==","_0_0",")","qA","=","_0_0",";","else","{","if","(","qC","<","100.0",")","qC","=","sqrt","(","_1_0","/","qC",")",";","else","qC","=","10.0","/","qC",";","vec3","pW","=","normalize","(","ou","+","qv",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","qi","=","_0_0",";","if","(","qy","==","_0_0",")","{","float","qD","=","dot","(","B",".","xyz",",","pW",")",";","qi","=","sqrt","(","_1_0","-","qD","*","qD",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","qi","=","(","_1_0","-","qy",")","*","max","(","dot","(","qx",",","pW",")",",","_0_0",")","+","qy",";"]}]}]},{TYPE:"txt",TOKENS:["if","(","qi","<","_0_0",")","qA","=","_0_0",";","else","{","float","pv","=","max","(","dot","(","qx",",","ou",")",",","0.01",")",";","float","qj","=","dot","(","qx",",","qv",")",";","if","(","qj","<=","0.01",")","qA","=","_0_0",";","else","{","float","qE","=","max","(","dot","(","ou",",","pW",")",",","0.01",")",";","float","a","=","_1_0",";","float","b","=","(","2.0","*","qi","*","pv",")","/","qE",";","float","du","=","(","2.0","*","qi","*","qj",")","/","qE",";","float","g","=","min","(","min","(","a",",","b",")",",","du",")",";","float","p","=","sqrt","(","pow","(","qB",",","2.0",")","+","pow","(","qE",",","2.0",")","-","_1_0",")",";","float","mi","=","pow","(","p","-","qE",",","2.0",")","/","pow","(","p","+","qE",",","2.0",")","*","(","_1_0","+","pow","(","qE","*","(","p","+","qE",")","-","_1_0",",","2.0",")","/","pow","(","qE","*","(","p","-","qE",")","+","_1_0",",","2.0",")",")",";","float","pP","=","acos","(","qi",")",";","qA","=","max","(","mi","*","g","*","exp","(","-","pow","(","pP",",","2.0",")","/","(","2.0","*","pow","(","qC",",","2.0",")",")",")",",","_0_0",")",";","}","}","}","}"]}]},{TYPE:"node",NAME:"LIGHTING_APPLY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"qF",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qI",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qL",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qM",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qQ",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qR",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NODE_B4W_TRANSLUCENCY"],STATEMENTS:[{TYPE:"txt",TOKENS:["if","(","dot","(","qJ",",","qK",")","*","dot","(","ou",",","qK",")","<","_0_0",")","{","float","Ek","=","qL",".","x",";","float","El","=","qL",".","y",";","float","Em","=","qL",".","z",";","float","En","=","qL",".","w",";","float","Eo","=","clamp","(","abs","(","dot","(","qJ",",","qK",")",")",",","_0_0",",","_1_0",")",";","float","Ep","=","clamp","(","dot","(","ou",",","-","qJ",")",",","_0_0",",","_1_0",")",";","float","Eq","=","pow","(","Ep",",","El",")",";","qQ","=","qF","+","qP","*","vec4","(","qO","*","Eo","*","pow","(","qM",",","vec3","(","Ek",")",")",",","_1_0",")",";","qQ","+=","Em","*","mix","(","vec4","(","qM",",","_1_0",")",",","vec4","(","_1_0",")",",","En",")","*","qP","*","vec4","(","qO","*","Eo","*","vec3","(","Eq",")",",","_1_0",")",";","}","else","{","qQ","=","qF","+","vec4","(","qO","*","qM","*","qH",",","qI",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["qQ","=","qF","+","vec4","(","qO","*","qM","*","qH",",","qI",")",";"]}]}]},{TYPE:"txt",TOKENS:["qR","=","qG","+","qO","*","qN","*","qI",";"]}]},{TYPE:"node",NAME:"RGB",NODE_VARS:[{TYPE:"node_var",NAME:"RGB_IND",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_out",NAME:"Er",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Er","=","u_node_rgbs","[","RGB_IND","]",";"]}]},{TYPE:"node",NAME:"RGBTOBW",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Es",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Et",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Et","=","dot","(","Es",",","vec3","(","0.35",",","0.45",",","0.2",")",")",";"]}]},{TYPE:"node",NAME:"SEPRGB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Eu",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ev",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Ew",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Ex",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ev"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ev","=","Eu",".","r",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ew"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ew","=","Eu",".","g",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ex"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ex","=","Eu",".","b",";"]}]}]}]},{TYPE:"node",NAME:"SEPHSV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Ey",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ez",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"EA",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"EB",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","EC","=","kf","(","Ey",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ez"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ez","=","EC",".","r",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_EA"],STATEMENTS:[{TYPE:"txt",TOKENS:["EA","=","EC",".","g",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_EB"],STATEMENTS:[{TYPE:"txt",TOKENS:["EB","=","EC",".","b",";"]}]}]}]},{TYPE:"node",NAME:"SQUEEZE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"ED",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EF",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EG",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["EG","=","_1_0","/","(","_1_0","+","pow","(","2.71828183",",","-","(","ED","-","EF",")","*","EE",")",")",";"]}]},{TYPE:"node",NAME:"GAMMA",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"EH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EI",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["EJ","=","EH",";","if","(","EJ",".","x",">","_0_0",")","EJ",".","x","=","pow","(","EH",".","x",",","EI",")",";","if","(","EJ",".","y",">","_0_0",")","EJ",".","y","=","pow","(","EH",".","y",",","EI",")",";","if","(","EJ",".","z",">","_0_0",")","EJ",".","z","=","pow","(","EH",".","z",",","EI",")",";"]}]},{TYPE:"node",NAME:"B4W_SRGB_TO_LINEAR",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"EK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EL",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["EL","=","max","(","vec3","(","_0_0",")",",","EK",")",";","EL","=","pow","(","EL",",","vec3","(","2.2",")",")",";"]}]},{TYPE:"node",NAME:"B4W_LINEAR_TO_SRGB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"EM",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EN",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["EN","=","max","(","vec3","(","_0_0",")",",","EM",")",";","EN","=","pow","(","EN",",","vec3","(","_1_0","/","2.2",")",")",";"]}]},{TYPE:"node",NAME:"TEXTURE_EMPTY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"EO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EP",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EQ",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_EO"],STATEMENTS:[{TYPE:"txt",TOKENS:["EO","=","vec3","(","_0_0",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_EP"],STATEMENTS:[{TYPE:"txt",TOKENS:["EP","=","vec3","(","_0_0",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_EQ"],STATEMENTS:[{TYPE:"txt",TOKENS:["EQ","=","_0_0",";"]}]}]}]},{TYPE:"node",NAME:"TEXTURE_ENVIRONMENT_CUBE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"ER",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ES",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"ET",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"node_TEXTURE_ENVIRONMENT_CUBE_var_texture",QUALIFIER:["uniform","samplerCube"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","EU","=","vec3","(","ER",".","x",",","ER",".","y",",","ER",".","z",")",";","vec4","AV","=","GLSL_TEXTURE_CUBE","(","node_TEXTURE_ENVIRONMENT_CUBE_var_texture",",","EU",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_ES"],STATEMENTS:[{TYPE:"txt",TOKENS:["ES","=","AV",".","xyz",";","bC","(","ES",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_ET"],STATEMENTS:[{TYPE:"txt",TOKENS:["ET","=","AV",".","w",";"]}]}]}]},{TYPE:"node",NAME:"TEXTURE_ENVIRONMENT_EQUIRECTANGULAR",NODE_VARS:[{TYPE:"node_var",NAME:"USE_VECTOR_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"EV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EW",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"node_TEXTURE_ENVIRONMENT_EQUIRECTANGULAR_var_texture",QUALIFIER:["uniform","sampler2D"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_VECTOR_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","EX","=","normalize","(","EV",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["IS_WORLD"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","EX","=","sr",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","EX","=","ot",";"]}]}]},{TYPE:"txt",TOKENS:["float","dC","=","-","atan","(","EX",".","y",",","EX",".","x",")","/","(","2.0","*","M_PI",")","+","_0_5",";","float","kQ","=","atan","(","EX",".","z",",","sqrt","(","EX",".","x","*","EX",".","x","+","EX",".","y","*","EX",".","y",")",")","/","M_PI","+","_0_5",";","vec4","AV","=","GLSL_TEXTURE","(","node_TEXTURE_ENVIRONMENT_EQUIRECTANGULAR_var_texture",",","vec2","(","dC",",","kQ",")",")",";","EW","=","AV",".","xyz",";","bC","(","EW",")",";"]}]},{TYPE:"node",NAME:"TEXTURE_ENVIRONMENT_MIRROR_BALL",NODE_VARS:[{TYPE:"node_var",NAME:"USE_VECTOR_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"EY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"node_TEXTURE_ENVIRONMENT_MIRROR_BALL_var_texture",QUALIFIER:["uniform","sampler2D"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_VECTOR_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","EX","=","normalize","(","EY",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["IS_WORLD"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","EX","=","sr",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","EX","=","ot",";"]}]}]},{TYPE:"txt",TOKENS:["EX",".","y","-=","_1_0",";","float","E_","=","2.0","*","sqrt","(","max","(","-","_0_5","*","EX",".","y",",","_0_0",")",")",";","if","(","E_",">","_0_0",")","EX","/=","E_",";","float","dC","=","_0_5","*","(","EX",".","x","+","_1_0",")",";","float","kQ","=","_0_5","*","(","EX",".","z","+","_1_0",")",";","vec4","AV","=","GLSL_TEXTURE","(","node_TEXTURE_ENVIRONMENT_MIRROR_BALL_var_texture",",","vec2","(","dC",",","kQ",")",")",";","EZ","=","AV",".","xyz",";","bC","(","EZ",")",";"]}]},{TYPE:"node",NAME:"TEXTURE_COLOR",NODE_VARS:[{TYPE:"node_var",NAME:"NON_COLOR",TOKENS:["0"]},{TYPE:"node_var",NAME:"CONVERT_UV",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv2",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv3",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv4",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Fa",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"Fb",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"Fc",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"Fd",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fe",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Ff",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fg",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fh",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fi",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fj",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fk",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fl",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"node_TEXTURE_COLOR_var_texture",QUALIFIER:["uniform","sampler2D"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_UV"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec4","AV","=","GLSL_TEXTURE","(","node_TEXTURE_COLOR_var_texture",",","rY","(","Fa",")",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec4","AV","=","GLSL_TEXTURE","(","node_TEXTURE_COLOR_var_texture",",","Fa",".","xy",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fe"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fe","=","AV",".","xyz",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NON_COLOR",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["bC","(","Fe",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ff"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ff","=","AV",".","w",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv2"],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_UV"],STATEMENTS:[{TYPE:"txt",TOKENS:["AV","=","GLSL_TEXTURE","(","node_TEXTURE_COLOR_var_texture",",","rY","(","Fb",")",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["AV","=","GLSL_TEXTURE","(","node_TEXTURE_COLOR_var_texture",",","Fb",".","xy",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fg"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fg","=","AV",".","xyz",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NON_COLOR",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["bC","(","Fg",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fh"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fh","=","AV",".","w",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv3"],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_UV"],STATEMENTS:[{TYPE:"txt",TOKENS:["AV","=","GLSL_TEXTURE","(","node_TEXTURE_COLOR_var_texture",",","rY","(","Fc",")",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["AV","=","GLSL_TEXTURE","(","node_TEXTURE_COLOR_var_texture",",","Fc",".","xy",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fi"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fi","=","AV",".","xyz",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NON_COLOR",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["bC","(","Fi",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fj"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fj","=","AV",".","w",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv4"],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_UV"],STATEMENTS:[{TYPE:"txt",TOKENS:["AV","=","GLSL_TEXTURE","(","node_TEXTURE_COLOR_var_texture",",","rY","(","Fd",")",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["AV","=","GLSL_TEXTURE","(","node_TEXTURE_COLOR_var_texture",",","Fd",".","xy",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fk"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fk","=","AV",".","xyz",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NON_COLOR",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["bC","(","Fk",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fl"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fl","=","AV",".","w",";"]}]}]}]}]}]},{TYPE:"node",NAME:"TEXTURE_NORMAL",NODE_VARS:[{TYPE:"node_var",NAME:"USE_uv2",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv3",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv4",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Fm",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"Fn",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"Fo",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"Fp",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fq",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fr",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fs",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Ft",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fu",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fv",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fw",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fx",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"node_TEXTURE_NORMAL_var_texture",QUALIFIER:["uniform","sampler2D"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec4","AV","=","GLSL_TEXTURE","(","node_TEXTURE_NORMAL_var_texture",",","rY","(","Fm",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fq"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fq","=","normalize","(","sy","*","(","AV",".","xyz","-","_0_5",")",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fr"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fr","=","AV",".","w",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv2"],STATEMENTS:[{TYPE:"txt",TOKENS:["AV","=","GLSL_TEXTURE","(","node_TEXTURE_NORMAL_var_texture",",","rY","(","Fn",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fs"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fs","=","normalize","(","sy","*","(","AV",".","xyz","-","_0_5",")",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ft"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ft","=","AV",".","w",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv3"],STATEMENTS:[{TYPE:"txt",TOKENS:["AV","=","GLSL_TEXTURE","(","node_TEXTURE_NORMAL_var_texture",",","rY","(","Fo",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fu"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fu","=","normalize","(","sy","*","(","AV",".","xyz","-","_0_5",")",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fv"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fv","=","AV",".","w",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv4"],STATEMENTS:[{TYPE:"txt",TOKENS:["AV","=","GLSL_TEXTURE","(","node_TEXTURE_NORMAL_var_texture",",","rY","(","Fp",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fw"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fw","=","normalize","(","sy","*","(","AV",".","xyz","-","_0_5",")",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fx"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fx","=","AV",".","w",";"]}]}]}]}]}]},{TYPE:"node",NAME:"VALUE",NODE_VARS:[{TYPE:"node_var",NAME:"VALUE_ROW_IND",TOKENS:["0"]},{TYPE:"node_var",NAME:"VALUE_COL_IND",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_out",NAME:"Fy",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Fy","=","u_node_values","[","VALUE_ROW_IND","]","[","VALUE_COL_IND","]",";"]}]},{TYPE:"node",NAME:"VECT_MATH_ADD",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Fz",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"FA",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FC",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["FB","=","Fz","+","FA",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FC"],STATEMENTS:[{TYPE:"txt",TOKENS:["FC","=","(","abs","(","FB","[","0","]",")","+","abs","(","FB","[","1","]",")","+","abs","(","FB","[","2","]",")",")","/","3.0",";"]}]}]}]},{TYPE:"node",NAME:"VECT_MATH_SUBTRACT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"FD",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"FE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FG",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["FF","=","FD","-","FE",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FG"],STATEMENTS:[{TYPE:"txt",TOKENS:["FG","=","(","abs","(","FF","[","0","]",")","+","abs","(","FF","[","1","]",")","+","abs","(","FF","[","2","]",")",")","/","3.0",";"]}]}]}]},{TYPE:"node",NAME:"VECT_MATH_AVERAGE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"FH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"FI",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FK",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["FJ","=","FH","+","FI",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FK"],STATEMENTS:[{TYPE:"txt",TOKENS:["FK","=","length","(","FJ",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FJ"],STATEMENTS:[{TYPE:"txt",TOKENS:["FJ","=","normalize","(","FJ",")",";"]}]}]}]},{TYPE:"node",NAME:"VECT_MATH_DOT_PRODUCT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"FL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"FM",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FO",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["FN","=","vec3","(","_0_0",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FO"],STATEMENTS:[{TYPE:"txt",TOKENS:["FO","=","dot","(","FL",",","FM",")",";"]}]}]}]},{TYPE:"node",NAME:"VECT_MATH_CROSS_PRODUCT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"FP",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"FQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FS",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["FR","=","cross","(","FP",",","FQ",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FS"],STATEMENTS:[{TYPE:"txt",TOKENS:["FS","=","length","(","FR",")",";","FR","/=","FS",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["FR","=","normalize","(","FR",")",";"]}]}]}]},{TYPE:"node",NAME:"VECT_MATH_NORMALIZE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"FT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"FU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FW",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["FV","=","normalize","(","FT",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FW"],STATEMENTS:[{TYPE:"txt",TOKENS:["FW","=","length","(","FT",")",";"]}]}]},{TYPE:"txt",TOKENS:["FU",";"]}]},{TYPE:"node",NAME:"FRESNEL",NODE_VARS:[{TYPE:"node_var",NAME:"USE_FRESNEL_NORMAL",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"FX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"FY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FZ",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_FRESNEL_NORMAL"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","cr","=","normalize","(","FY",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","cr","=","ot",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CAMERA_TYPE","CAM_TYPE_PERSP",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","Ax","=","normalize","(","ou",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","Ax","=","u_camera_direction",";"]}]}]},{TYPE:"txt",TOKENS:["float","sa","=","max","(","FX",",","0.00001",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["sa","=","gl_FrontFacing","==","false","?","sa",":","_1_0","/","sa",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["sa","=","gl_FrontFacing","?","sa",":","_1_0","/","sa",";"]}]}]},{TYPE:"txt",TOKENS:["FZ","=","sb","(","Ax",",","cr",",","sa",")",";"]}]},{TYPE:"node",NAME:"BACKGROUND",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"F_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ga",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Gb",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Gb","=","F_","*","Ga",";"]}]},{TYPE:"node",NAME:"B4W_REFLECT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Gc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Gd",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ge",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Ge","=","reflect","(","_","(","u_view_tsr_inverse",",","Gc",")",",","Gd",")",";"]}]},{TYPE:"node",NAME:"B4W_REFLECT_WORLD",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Gf",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Gg",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Gg","=","reflect","(","-","ou",".","xyz",",","Gf",")",";"]}]},{TYPE:"node",NAME:"B4W_PARALLAX",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Gh",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Gi",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Gj",QUALIFIER:["const","float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Gk",QUALIFIER:["const","float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Gl",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"node_B4W_PARALLAX_var_texture",QUALIFIER:["uniform","sampler2D"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","bN","=","length","(","sB",")",";","if","(","bN","<","Gk",")","{","vec2","b_","=","rY","(","Gh",")",";","float","cd","=","clamp","(","_0_5","*","(","Gk","-","bN",")",",","_0_0",",","_1_0",")",";","float","hG","=","Gi","*","cd",";","vec3","cf","=","normalize","(","ou","*","sy",")",";","float","cg","=","_1_0","/","Gj",";","vec2","ch","=","cf",".","xy","*","hG","/","(","Gj","*","cf",".","z",")",";","float","ci","=","_1_0",";","float","cj","=","GLSL_TEXTURE","(","node_B4W_PARALLAX_var_texture",",","b_",")",".","a",";","for","(","float","cl","=","1.0",";","cl","<=","Gj",";","cl","++",")","{","if","(","cj","<","ci",")","{","ci","-=","cg",";","b_","-=","ch",";","cj","=","GLSL_TEXTURE","(","node_B4W_PARALLAX_var_texture",",","b_",")",".","a",";","}","}","vec2","cm","=","b_","+","ch",";","float","cn","=","GLSL_TEXTURE","(","node_B4W_PARALLAX_var_texture",",","cm",")",".","a","-","(","ci","+","cg",")",";","float","co","=","cj","-","ci",";","float","cp","=","co","/","(","co","-","cn",")",";","b_","=","cp","*","cm","+","(","_1_0","-","cp",")","*","b_",";","Gl","=","rX","(","b_",")",";","}","else","Gl","=","Gh",";"]}]},{TYPE:"node",NAME:"B4W_CLAMP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Gm",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Gn",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Gn","=","clamp","(","Gm",",","_0_0",",","_1_0",")",";"]}]},{TYPE:"node",NAME:"B4W_REFRACTION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Go",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Gp",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Gq",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Gq","=","rW","(","Go",",","Gp",")",";"]}]},{TYPE:"node",NAME:"B4W_TRANSLUCENCY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Gr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Gs",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Gt",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Gu",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Gv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Gw",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gx",QUALIFIER:["vec4"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gw"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gw","=","Gr",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gx"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gx","=","vec4","(","Gs",",","Gt",",","Gu",",","Gv",")",";"]}]}]}]},{TYPE:"node",NAME:"B4W_TIME",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"Gy",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Gy","=","u_time",";"]}]},{TYPE:"node",NAME:"B4W_SMOOTHSTEP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Gz",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GB",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GC",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["GC","=","smoothstep","(","GA",",","GB",",","Gz",")",";"]}]},{TYPE:"node",NAME:"B4W_GLOW_OUTPUT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GD",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GE",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["E","=","GD",";","I","=","GE",";"]}]},{TYPE:"node",NAME:"B4W_VECTOSCAL",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GG",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["GG","=","(","GF",".","r","+","GF",".","g","+","GF",".","b",")","/","3.0",";"]}]},{TYPE:"node",NAME:"B4W_SCALTOVEC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GI",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["GI","[","0","]","=","GH",";","GI","[","1","]","=","GH",";","GI","[","2","]","=","GH",";"]}]},{TYPE:"nodes_global"},{TYPE:"txt",TOKENS:["void","J","(","in","vec3","ou",",","out","vec3","E",",","out","vec3","F",",","out","vec3","G",",","out","vec4","H",",","out","float","I",")","{","E","=","vec3","(","_0_0",")",";","F","=","vec3","(","_0_0",")",";","G","=","vec3","(","_0_0",")",";","H","=","vec4","(","_0_0",")",";","I","=","_0_0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["IS_WORLD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_TEXTURE_ENVIRONMENT_EQUIRECTANGULAR","USE_NODE_TEXTURE_ENVIRONMENT_MIRROR_BALL","USE_NODE_TEX_COORD_GE","USE_NODE_TEX_COORD_OB",{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sr","=","-","ou",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_GL"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","os","=","-","ou",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_TEX_COORD_NO"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ot","=","ou",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_NO"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","su","=","ou",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_NORMAL_MAP","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:11}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sv","=","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","gl_FrontFacing","==","false",")"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","gl_FrontFacing",")"]}]}}]},{TYPE:"txt",TOKENS:["sv","=","sv",";","else","sv","=","-","sv",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_NORMAL_MAP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sw","=","sv",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sx","=","normalize","(","sv",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DOUBLE_SIDED_LIGHTING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ot","=","sx",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ot","=","normalize","(","j",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_NO"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","su","=","sx",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","W","=","cross","(","sx",",","k",".","xyz",")","*","k",".","w",";","mat3","sy","=","mat3","(","k",".","xyz",",","W",",","sx",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_NORMAL_MAP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sz","=","cross","(","sv",",","k",".","xyz",")","*","k",".","w",";","mat3","sA","=","mat3","(","k",".","xyz",",","sz",",","sv",")",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["vec3","os","=","h",";","vec4","sB","=","i",";","float","sC","=","u_emit",";","float","sD","=","u_ambient",";"]}]}}]},{TYPE:"nodes_main"},{TYPE:"txt",TOKENS:["}"]}]}}]}]},e["include/nodes.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"NODES_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"NODES_GLSLV",TOKENS:[""]},{TYPE:"var",NAME:"PARTICLE_BATCH",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{TYPE:"logical_or_expr",PLACES:2},"PARTICLE_BATCH",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_orco_tex_coord",";","GLSL_OUT","vec3","rT",";"]}]}}]},{TYPE:"node",NAME:"TEX_COORD_UV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_param",NAME:"node_TEX_COORD_UV_var_a_uv",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sj",QUALIFIER:["GLSL_OUT","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["sj","=","node_TEX_COORD_UV_var_a_uv",";"]}]},{TYPE:"node",NAME:"UV_MERGED",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_param",NAME:"node_UV_MERGED_var_a_uv",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"si",QUALIFIER:["GLSL_OUT","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["si","=","node_UV_MERGED_var_a_uv",";"]}]},{TYPE:"node",NAME:"UVMAP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_param",NAME:"node_UVMAP_var_a_uv",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sk",QUALIFIER:["GLSL_OUT","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["sk","=","node_UVMAP_var_a_uv",";"]}]},{TYPE:"node",NAME:"GEOMETRY_UV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_param",NAME:"node_GEOMETRY_UV_var_a_uv",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sc",QUALIFIER:["GLSL_OUT","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["sc","=","node_GEOMETRY_UV_var_a_uv",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_param",NAME:"node_GEOMETRY_VC_var_a_vertex_color",QUALIFIER:["GLSL_IN","vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"GJ",QUALIFIER:["GLSL_OUT","vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["GJ","=","node_GEOMETRY_VC_var_a_vertex_color",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC1",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_param",NAME:"node_GEOMETRY_VC1_var_a_vertex_color",QUALIFIER:["GLSL_IN","float"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"GK",QUALIFIER:["GLSL_OUT","float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["GK","=","node_GEOMETRY_VC1_var_a_vertex_color",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC2",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_param",NAME:"node_GEOMETRY_VC2_var_a_vertex_color",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"GL",QUALIFIER:["GLSL_OUT","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["GL","=","node_GEOMETRY_VC2_var_a_vertex_color",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC3",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_param",NAME:"node_GEOMETRY_VC3_var_a_vertex_color",QUALIFIER:["GLSL_IN","vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"GM",QUALIFIER:["GLSL_OUT","vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["GM","=","node_GEOMETRY_VC3_var_a_vertex_color",";"]}]},{TYPE:"nodes_global"},{TYPE:"txt",TOKENS:["void","J","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["rT","=","a_orco_tex_coord",";"]}]}}]},{TYPE:"nodes_main"},{TYPE:"txt",TOKENS:["}"]}]}}]}]},e["include/pack.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"PACK_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"PACK_GLSLF",TOKENS:[""]},{TYPE:"txt",TOKENS:["vec4","er","(","const","in","float","il",")","{","vec4","fq","=","vec4","(","_255_0","*","_255_0","*","_255_0",",","_255_0","*","_255_0",",","_255_0",",","_1_0",")",";","vec4","GN","=","vec4","(","_0_0",",","_1_0","/","_255_0",",","_1_0","/","_255_0",",","_1_0","/","_255_0",")",";","vec4","jB","=","fract","(","il","*","fq",")",";","jB","-=","jB",".","xxyz","*","GN",";","return","jB",";","}","float","cQ","(","const","in","vec4","GO",")","{","float","eq",";","vec4","fq","=","vec4","(","_1_0","/","(","_255_0","*","_255_0","*","_255_0",")",",","_1_0","/","(","_255_0","*","_255_0",")",",","_1_0","/","_255_0",",","_1_0",")",";","eq","=","dot","(","GO",",","fq",")",";","return","eq",";","}","vec4","er","(","const","in","vec2","rf",")","{","vec2","fq","=","vec2","(","_255_0",",","_1_0",")",";","vec2","GN","=","vec2","(","_0_0",",","_1_0","/","_255_0",")",";","vec4","jB","=","fract","(","rf",".","xxyy","*","fq",".","xyxy",")",";","jB","-=","jB",".","xxzz","*","GN",".","xyxy",";","if","(","rf",".","r","==","_1_0",")","jB",".","rg","=","vec2","(","_0_0",",","_1_0",")",";","if","(","rf",".","g","==","_1_0",")","jB",".","ba","=","vec2","(","_0_0",",","_1_0",")",";","return","jB",";","}","vec2","jg","(","const","in","vec4","GP",")","{","vec2","rf",";","vec2","fq","=","vec2","(","_1_0","/","_255_0",",","_1_0",")",";","rf",".","r","=","dot","(","GP",".","rg",",","fq",")",";","rf",".","g","=","dot","(","GP",".","ba",",","fq",")",";","return","rf",";","}"]}]}}]}]},e["include/particles.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"PARTICLES_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"PARTICLES_GLSLV",TOKENS:[""]},{TYPE:"var",NAME:"EPSILON",TOKENS:["0.000001"]},{TYPE:"var",NAME:"COLOR_RAMP_LENGTH",TOKENS:["0"]},{TYPE:"var",NAME:"WORLD_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_COLOR_RAMP",TOKENS:["0"]},{TYPE:"include",FILE:"math.glslv"},{TYPE:"txt",TOKENS:["struct","cY","{","float","df",";","vec3","O",";","float","L",";","vec3","aQ",";","float","bK",";","vec3","dl",";","vec3","dm",";","float","dn",";","}",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COLOR_RAMP_LENGTH",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["void","GT","(","inout","vec3","aQ",",","float","GQ",",","vec4","kb",",","vec4","bv",")","{","float","GR","=","bv",".","x","-","kb",".","x",";","float","GS","=","(","GQ","-","kb",".","x",")","/","GR",";","aQ","=","mix","(","aQ",",","bv",".","yzw",",","clamp","(","GS",",","0.0",",","1.0",")",")",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COLOR_RAMP_LENGTH",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","GW","(","float","t",",","float","GU",",","vec4","GV","[","COLOR_RAMP_LENGTH","]",")","{","float","GQ","=","t","/","GU",";","vec3","aQ","=","GV","[","0","]",".","yzw",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COLOR_RAMP_LENGTH",1,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GT","(","aQ",",","GQ",",","GV","[","0","]",",","GV","[","1","]",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COLOR_RAMP_LENGTH",2,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GT","(","aQ",",","GQ",",","GV","[","1","]",",","GV","[","2","]",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COLOR_RAMP_LENGTH",3,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GT","(","aQ",",","GQ",",","GV","[","2","]",",","GV","[","3","]",")",";"]}]}}]},{TYPE:"txt",TOKENS:["return","aQ",";","}"]}]}}]},{TYPE:"txt",TOKENS:["float","Hb","(","float","t",",","float","GU",",","float","GX",",","float","GY",")","{","float","GZ","=","max","(","0.01",",","min","(","GU",",","GX",")",")",";","float","G_","=","max","(","0.01",",","min","(","GU",",","GY",")",")",";","float","Ha","=","GU","-","G_",";","float","L","=","clamp","(","t","/","GZ",",","0.0",",","1.0",")","-","step","(","Ha",",","t",")","*","(","t","-","Ha",")","/","G_",";","return","L",";","}","cY","cZ","(",")","{","cY","sp",";","float","t",";","float","GU","=","a_p_data","[","0","]",";","float","Hc","=","a_p_data","[","1","]",";","if","(","u_p_cyclic","==","1",")","{","t","=","mod","(","u_p_time",",","u_p_length",")","-","Hc",";","if","(","t","<","0.0",")","t","+=","u_p_length",";","}","if","(","u_p_cyclic","!=","1",")","{","t","=","u_p_time","-","Hc",";","}","if","(","t","<","0.0","||","t",">=","GU",")","{","sp",".","df","=","0.0001",";","sp",".","O","=","vec3","(","99999.0",",","0.0",",","0.0",")",";","}","if","(","!","(","t","<","0.0","||","t",">=","GU",")",")","{","vec4","S","=","R","(","a_tbn",")",";","vec3","bW","=","T","(","S",",","vec3","(","0.0",",","1.0",",","0.0",")",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WORLD_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","fn","=","a_position",";","vec3","r_","=","bW",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","fn","=","ap","(","u_model_tsr",",","a_position",")",";","vec3","r_","=","_","(","u_model_tsr",",","bW",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","Hd","=","u_p_nfactor","*","r_",";","Hd","+=","a_p_vels",".","xyz",";","Hd",".","z","-=","u_p_gravity","*","t","/","2.0",";","float","He","=","max","(","u_p_mass",",","EPSILON",")",";","Hd","+=","(","u_p_wind_fac","*","u_wind","/","He",")","*","t","/","2.0",";","sp",".","dn","=","t",";","sp",".","dl","=","Hd",";","sp",".","dm","=","bW","*","a_p_vels",".","w",";","sp",".","O","=","fn","+","Hd","*","t",";","sp",".","bK","=","a_p_vels",".","w","*","t",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_COLOR_RAMP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["sp",".","df","=","GLSL_TEXTURE","(","u_color_ramp_tex",",","vec2","(","t","/","u_p_max_lifetime",",","0.5",")",")",".","g",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["sp",".","df","=","1.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COLOR_RAMP_LENGTH",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["sp",".","aQ","=","GW","(","t",",","u_p_max_lifetime",",","u_p_color_ramp",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["sp",".","aQ","=","vec3","(","1.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["sp",".","L","=","Hb","(","t",",","a_p_data","[","0","]",",","u_p_fade_in",",","u_p_fade_out",")",";","}","return","sp",";","}"]}]}}]}]},e["include/particles_nodes.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"PARTICLES_NODES_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"PARTICLES_NODES_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"CAUSTICS",TOKENS:["0"]},{TYPE:"var",NAME:"DOUBLE_SIDED_LIGHTING",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_PASS",TOKENS:["REFL_PASS_NONE"]},{TYPE:"var",NAME:"PARTICLE_BATCH",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_BSDF_BEGIN",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"environment.glslf"}]}}]},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{TYPE:"logical_or_expr",PLACES:6}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","kf","(","vec3","rgb",")","{","vec4","hI","=","vec4","(","_0_0",",","-","_1_0","/","3.0",",","2.0","/","3.0",",","-","_1_0",")",";","vec4","p","=","mix","(","vec4","(","rgb",".","bg",",","hI",".","wz",")",",","vec4","(","rgb",".","gb",",","hI",".","xy",")",",","step","(","rgb",".","b",",","rgb",".","g",")",")",";","vec4","q","=","mix","(","vec4","(","p",".","xyw",",","rgb",".","r",")",",","vec4","(","rgb",".","r",",","p",".","yzx",")",",","step","(","p",".","x",",","rgb",".","r",")",")",";","float","dz","=","q",".","x","-","min","(","q",".","w",",","q",".","y",")",";","float","iB","=","1.0e-10",";","return","vec3","(","abs","(","q",".","z","+","(","q",".","w","-","q",".","y",")","/","(","6.0","*","dz","+","iB",")",")",",","dz","/","(","q",".","x","+","iB",")",",","q",".","x",")",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{TYPE:"logical_or_expr",PLACES:6}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","kh","(","vec3","kg",")","{","vec4","hI","=","vec4","(","_1_0",",","2.0","/","3.0",",","_1_0","/","3.0",",","3.0",")",";","vec3","p","=","abs","(","fract","(","vec3","(","kg",".","r",",","kg",".","r",",","kg",".","r",")","+","hI",".","xyz",")","*","6.0","-","hI",".","www",")",";","return","kg",".","b","*","mix","(","hI",".","xxx",",","clamp","(","p","-","hI",".","xxx",",","_0_0",",","_1_0",")",",","kg",".","g",")",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","rX","(","vec2","gT",")","{","return","vec3","(","gT","*","2.0","-","vec2","(","_1_0",",","_1_0",")",",","_0_0",")",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","rY","(","vec3","rf",")","{","return","vec2","(","rf",".","xy","*","_0_5","+","vec2","(","_0_5",",","_0_5",")",")",";","}"]}]}}]},{TYPE:"node",NAME:"CAMERA",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"sE",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"sF",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"sG",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_sE"],STATEMENTS:[{TYPE:"txt",TOKENS:["sE","=","normalize","(","sB",".","xyz",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_sF"],STATEMENTS:[{TYPE:"txt",TOKENS:["sF","=","abs","(","sB",".","z",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_sG"],STATEMENTS:[{TYPE:"txt",TOKENS:["sG","=","length","(","sB",".","xyz",")",";"]}]}]}]},{TYPE:"node",NAME:"COMBRGB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"sH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"sI",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"sJ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"sK",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["sK","=","vec3","(","sH",",","sI",",","sJ",")",";"]}]},{TYPE:"node",NAME:"COMBHSV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"sL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"sM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"sN",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"sO",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["sO","=","kh","(","vec3","(","sL",",","sM",",","sN",")",")",";"]}]},{TYPE:"node",NAME:"EMPTY_UV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"sP",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["sP","=","vec3","(","-","_1_0",",","-","_1_0",",","_0_0",")",";"]}]},{TYPE:"node",NAME:"EMPTY_VC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"sQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["sQ","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_UV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"sR",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["sR","=","rX","(","A",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_OR",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"sS",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["sS","=","2.0","*","vec3","(","A",",","_0_0",")","-","vec3","(","_1_0",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"sT",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["sT","=","vec3","(","_1_0",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC1",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"sU",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["sU","=","_1_0",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC2",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"sV",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"sW",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["sV","=","_1_0",";","sW","=","_1_0",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC3",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"sX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"sY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"sZ",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["sX","=","_1_0",";","sY","=","_1_0",";","sZ","=","_1_0",";"]}]},{TYPE:"node",NAME:"GEOMETRY_NO",NODE_VARS:[{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"s_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ta",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["ta","=","s_",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["ta","=","su",".","xyz",";"]}]}]}]},{TYPE:"node",NAME:"GEOMETRY_FB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tb",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["tb","=","(","gl_FrontFacing",")","?","_0_0",":","_1_0",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["tb","=","(","gl_FrontFacing",")","?","_1_0",":","_0_0",";"]}]}]}]},{TYPE:"node",NAME:"GEOMETRY_VW",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"td",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["td","=","-","_","(","u_view_tsr_frag",",","ou",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_LO",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"te",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["te","[","0","]","=","sB","[","0","]",";","te","[","1","]","=","sB","[","1","]",";","te","[","2","]","=","sB","[","2","]",";"]}]},{TYPE:"node",NAME:"GEOMETRY_GL",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tf",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tf","=","vec3","(","os",".","r",",","os",".","g",",","os",".","b",")",";"]}]},{TYPE:"node",NAME:"NEW_GEOMETRY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"th",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ti",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tj",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tk",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tl",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tm",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"to",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["th","=","vec3","(","_0_0",")",";","ti","=","vec3","(","_0_0",")",";","tj","=","vec3","(","_0_0",")",";","tk","=","vec3","(","_0_0",")",";","tl","=","vec3","(","_0_0",")",";","tm","=","vec3","(","_0_0",")",";","tn","=","_0_0",";","to","=","_0_0",";"]}]},{TYPE:"node",NAME:"HUE_SAT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"tr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tu",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tx",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ty",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","kg","=","kf","(","tx",")",";","kg","[","0","]","+=","(","tr","-","_0_5",")",";","if","(","kg","[","0","]",">","_1_0",")","kg","[","0","]","-=","_1_0",";","else","if","(","kg","[","0","]","<","_0_0",")","kg","[","0","]","+=","_1_0",";","kg","*=","vec3","(","_1_0",",","tu",",","tv",")",";","kg","=","mix","(","vec3","(","_1_0",")",",","mix","(","vec3","(","_0_0",")",",","kg",",","step","(","vec3","(","_0_0",")",",","kg",")",")",",","step","(","kg",",","vec3","(","_1_0",")",")",")",";","ty","=","mix","(","tx",",","kh","(","kg",")",",","tw",")",";"]}]},{TYPE:"node",NAME:"INVERT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"tz",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tA",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tB",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tB","=","mix","(","tA",",","vec3","(","_1_0",")","-","tA",",","tz",")",";"]}]},{TYPE:"node",NAME:"LAMP",NODE_VARS:[{TYPE:"node_var",NAME:"LAMP_TYPE",TOKENS:["HEMI"]},{TYPE:"node_var",NAME:"LAMP_INDEX",TOKENS:["0"]},{TYPE:"node_var",NAME:"LAMP_USE_SPHERE",TOKENS:["0"]},{TYPE:"node_var",NAME:"LAMP_SPOT_SIZE",TOKENS:["0.8"]},{TYPE:"node_var",NAME:"LAMP_SPOT_BLEND",TOKENS:["0.03"]},{TYPE:"node_var",NAME:"LAMP_LIGHT_DIST",TOKENS:["30.0"]}],DECLARATIONS:[{TYPE:"node_out",NAME:"tC",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"tD",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tF",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tC"],STATEMENTS:[{TYPE:"txt",TOKENS:["tC","=","u_lamp_light_color_intensities","[","LAMP_INDEX","]",";"]}]}]},{TYPE:"txt",TOKENS:["vec3","tG","=","u_lamp_light_directions","[","LAMP_INDEX","]",";","vec3","tH","=","u_lamp_light_positions","[","LAMP_INDEX","]",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2},"LAMP_TYPE","POINT",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["tD","=","-","h","+","tH",";","tE","=","length","(","tD",")",";","tD","=","normalize","(","tD",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tF"],STATEMENTS:[{TYPE:"txt",TOKENS:["tF","=","LAMP_LIGHT_DIST","/","(","LAMP_LIGHT_DIST","+","tE","*","tE",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","oY","=","dot","(","tD",",","tG",")",";","oY","*=","smoothstep","(","_0_0",",","_1_0",",","(","oY","-","LAMP_SPOT_SIZE",")","/","LAMP_SPOT_BLEND",")",";","tF","*=","oY",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_USE_SPHERE"],STATEMENTS:[{TYPE:"txt",TOKENS:["tF","*=","max","(","LAMP_LIGHT_DIST","-","tE",",","_0_0",")","/","LAMP_LIGHT_DIST",";"]}]}]}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tD"],STATEMENTS:[{TYPE:"txt",TOKENS:["tD","=","tG",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tE"],STATEMENTS:[{TYPE:"txt",TOKENS:["tE","=","length","(","tH","-","h",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tF"],STATEMENTS:[{TYPE:"txt",TOKENS:["tF","=","_1_0",";"]}]}]}]}]}]},{TYPE:"node",NAME:"NORMAL",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"tI",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tJ",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"tK",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"sh",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tJ"],STATEMENTS:[{TYPE:"txt",TOKENS:["tJ","=","sh",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tK"],STATEMENTS:[{TYPE:"txt",TOKENS:["tK","=","-","dot","(","tI",",","sh",")",";"]}]}]}]},{TYPE:"node",NAME:"B4W_VECTOR_VIEW",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"tL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tM",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tM","=","-","_","(","u_view_tsr_frag",",","tL",")",";"]}]},{TYPE:"node",NAME:"BSDF_BEGIN",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"tN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tR",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tS",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tV",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tW",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"t_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ua",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ub",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uc",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ud",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ue",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uf",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ug",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uh",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ui",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uj",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["t_","=","tO",";","ua","=","tQ",";","ub","=","tT",";","ue","=","tO",";","uf","=","tQ",";","metalness_out","=","tS",";","ug","=","tU",";","uh","=","tV",";","ui","=","tW",";","uj","=","tX",";","tY","=","sC","*","t_",";","tZ","=","sD","*","u_environment_energy","*","cz","(","ub",")",";","ud","=","cC","(","t_",")",";","H","=","ud",";","uc","[","0","]","=","tP",";","uc","[","1","]","=","tR",";","uc","[","2","]","=","tS",";"]}]},{TYPE:"node",NAME:"BSDF_END",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"uk",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ul",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"um",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"un",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uo",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"up",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ur",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"us",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ur",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ut",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uu",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["uu","=","uk",".","rgb","+","ul",";","uu","=","mix","(","uu",",","uq",",","ur",")",";","I","=","_1_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NODE_BSDF_TRANSPARENT"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","ux","=","GLSL_TEXTURE","(","u_refractmap",",","l",".","xy","/","l",".","z",")",".","rgb",";","bC","(","ux",")",";","us","=","us","*","ux",";","uu","+=","us",";"]}]}]},{TYPE:"txt",TOKENS:["um",";"]}]},{TYPE:"node",NAME:"BSDF_COMPUTE",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"uy",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uz",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uA",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uB",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uC",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uD",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uE",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","r_","=","uA",";","float","uF","=","clamp","(","uC","[","0","]",",","_0_0",",","_1_0",")",";","float","uw","=","clamp","(","uC","[","1","]",",","_0_0",",","_1_0",")",";","float","rF","=","uC","[","2","]",";","vec3","pW","=","normalize","(","ou","+","uy",")",";","float","pf","=","(","_1_0","-","uB",")","*","dot","(","r_",",","uy",")","+","uB",";","float","uG","=","(","_1_0","-","uB",")","*","max","(","dot","(","uy",",","pW",")",",","_0_0",")","+","uB",";","float","uH","=","(","_1_0","-","uB",")","*","max","(","dot","(","uA",",","pW",")",",","_0_0",")","+","uB",";","uD","=","_0_0",";","if","(","uz",".","r","!=","_0_0",")","{","if","(","uF",">","_0_0",")","{","float","pv","=","max","(","dot","(","r_",",","ou",")",",","_0_0",")",";","float","pw","=","uF","*","uF",";","float","cB","=","_1_0","-","_0_5","*","(","pw","/","(","pw","+","0.33",")",")",";","vec3","px","=","uy","-","pf","*","r_",";","vec3","py","=","ou","-","pv","*","r_",";","if","(","length","(","px",")","==","_0_0","||","length","(","py",")","==","_0_0","||","abs","(","pf",")",">","_1_0","||","abs","(","pv",")",">","_1_0",")","uD","=","pf","*","cB",";","else","{","float","pz","=","acos","(","pf",")",";","float","pA","=","acos","(","pv",")",";","vec3","pB","=","normalize","(","px",")",";","vec3","pC","=","normalize","(","py",")",";","float","a",",","b",";","a","=","max","(","pz",",","pA",")",";","b","=","min","(","pz",",","pA",")",";","b","*=","0.95",";","float","t","=","max","(","dot","(","pB",",","pC",")",",","_0_0",")",";","float","hO","=","0.45","*","(","pw","/","(","pw","+","0.09",")",")",";","uD","=","pf","*","(","cB","+","(","hO","*","t","*","sin","(","a",")","*","tan","(","b",")",")",")",";","}","}","else","uD","=","pf",";","uD","=","max","(","uD",",","_0_0",")",";","}","float","L","=","uw",";","float","uI","=","L","*","L",";","float","dX","=","(","uH","*","uI","-","uH",")","*","uH","+","_1_0",";","float","cy","=","uI","/","(","M_PI","*","dX","*","dX",")",";","float","uJ",";","float","uK",";","float","uL","=","pow","(","_1_0","-","uG",",","5.0",")",";","uJ","=","_1_0",";","uK","=","uL",";","float","hI","=","L","/","2.0",";","float","uM","=","hI","*","hI",";","float","uN","=","_1_0","-","uM",";","float","uO","=","_1_0","/","(","uG","*","uG","*","uN","+","uM",")",";","uJ","*=","uO",";","uK","*=","uO",";","float","rC","=","mix","(","0.04",",","_1_0",",","rF",")",";","float","uP","=","mix","(","uK",",","uJ",",","rC",")",";","uE","=","max","(","pf","*","cy","*","uP",",","_0_0",")",";"]}]},{TYPE:"node",NAME:"BSDF_ANISOTROPIC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"ve",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vf",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vg",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vh",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vi",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vj",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vk",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vk","=","ve",";","vf",";","vg",";","vh",";","vi",";","vj",";"]}]},{TYPE:"node",NAME:"BSDF_DIFFUSE",NODE_VARS:[{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"vl",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vm",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vn",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vo",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vp",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vq",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vr",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vs",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vt",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vu",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vv",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vx",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vy",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vp","=","vl",";","vq","=","vm",";","vt","=","_0_0",";","vw","=","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["vu","=","vn",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vu","=","ot",";"]}]}]},{TYPE:"txt",TOKENS:["vo",";","vr",";","vs",";","vv",";","vx",";","vy",";"]}]},{TYPE:"node",NAME:"BSDF_GLASS",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"vz",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vB",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vD",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vD","=","vz",";","vA",";","vB",";","vC",";"]}]},{TYPE:"node",NAME:"BSDF_GLOSSY",NODE_VARS:[{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"vE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vF",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vI",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vJ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vR",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vK","=","vE",";","vL","=","vF",";","vM","=","_1_0",";","vP","=","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["vN","=","vG",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vN","=","ot",";"]}]}]},{TYPE:"txt",TOKENS:["vH",";","vI",";","vJ",";","vO",";","vQ",";","vR",";"]}]},{TYPE:"node",NAME:"BSDF_HAIR",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"vS",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vT",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vV",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vW",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vW","=","vS",";","vT",";","vU",";","vV",";"]}]},{TYPE:"node",NAME:"BSDF_TRANSPARENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"vX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"v_",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wa",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wc",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wd",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"we",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wf",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wh",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wg","=","vX",";","wc","=","_0_0",";","wf","=","_0_0",";","wh","=","_0_0",";","wd","=","ot",";","vY",";","vZ",";","v_",";","wa",";","wb",";","we",";"]}]},{TYPE:"node",NAME:"BSDF_TRANSLUCENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"wi",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wj",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wk",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wk","=","wi",";","wj",";"]}]},{TYPE:"node",NAME:"BSDF_REFRACTION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"wl",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wm",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wo",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wp",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wp","[","0","]","=","wp","[","1","]","=","wp","[","2","]","=","_0_0",";","wl",";","wm",";","wn",";","wo",";"]}]},{TYPE:"node",NAME:"BSDF_TOON",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"wq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ws",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wt",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wu",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wu","=","wq",";","wr",";","ws",";","wt",";"]}]},{TYPE:"node",NAME:"BSDF_VELVET",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"wv",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wC",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wC","=","wv",";","wA",";","wB",";"]}]},{TYPE:"node",NAME:"SUBSURFACE_SCATTERING",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"wD",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wG",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wI",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wJ","[","0","]","=","wJ","[","1","]","=","wJ","[","2","]","=","_0_0",";","wD",";","wF",";","wG",";","wH",";","wI",";","wE",";"]}]},{TYPE:"node",NAME:"EMISSION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"wK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wM",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wO",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wP",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wQ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wR",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wS",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wW",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wT","=","wL","*","wK",";","wR","=","_0_0",";","wU","=","_1_0",";","wS","=","ot",";","wM",";","wN",";","wO",";","wP",";","wQ",";","wV",";","wW",";"]}]},{TYPE:"node",NAME:"AMBIENT_OCCLUSION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"wX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wY",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wY","[","0","]","=","wY","[","1","]","=","wY","[","2","]","=","_0_0",";","wX",";"]}]},{TYPE:"node",NAME:"HOLDOUT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"wZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wZ","[","0","]","=","wZ","[","1","]","=","wZ","[","2","]","=","_0_0",";"]}]},{TYPE:"node",NAME:"VOLUME_ABSORPTION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"w_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xa",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xb",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xb","[","0","]","=","xb","[","1","]","=","xb","[","2","]","=","_0_0",";","w_",";","xa",";"]}]},{TYPE:"node",NAME:"VOLUME_SCATTER",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xd",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xe",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xf",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xf","[","0","]","=","xf","[","1","]","=","xf","[","2","]","=","_0_0",";","xc",";","xd",";","xe",";"]}]},{TYPE:"node",NAME:"BUMP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hk",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xi",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hl",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xk",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xk","=","Hl",";","Hj",";","Hk",";","xi",";"]}]},{TYPE:"node",NAME:"DISPLACEMENT_BUMP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xs",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xs","=","ot",";","xr",";"]}]},{TYPE:"node",NAME:"NORMAL_MAP",NODE_VARS:[{TYPE:"node_var",NAME:"SPACE",TOKENS:["NM_TANGENT"]},{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"xt",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xu",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xv",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xA",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","xB","=","xv",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","xB","=","sw",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["SPACE","NM_TANGENT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["xA","=","2.0","*","xu",".","xyz","-","_1_0",";","xA","=","sA","*","xA",";"]}]},{TYPE:"node_elif",EXPRESSION:["SPACE","NM_OBJECT",{TYPE:"equal_expr",PLACES:2},"SPACE","NM_BLENDER_OBJECT",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["xA","=","2.0","*","xu",".","xyz","-","_1_0",";","xA",".","yz","*=","-","_1_0",";","xA","=","_","(","u_model_tsr",",","xA",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["SPACE","NM_WORLD",{TYPE:"equal_expr",PLACES:2},"SPACE","NM_BLENDER_WORLD",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["xA","=","2.0","*","xu",".","xyz","-","_1_0",";","xA",".","yz","*=","-","_1_0",";"]}]}]},{TYPE:"txt",TOKENS:["float","ma","=","max","(","xt",",","_0_0",")",";","xA","=","normalize","(","mix","(","xB",",","xA",",","ma",")",")",";"]}]},{TYPE:"node",NAME:"VECT_TRANSFORM",NODE_VARS:[{TYPE:"node_var",NAME:"CONVERT_TYPE",TOKENS:["VT_WORLD_TO_OBJECT"]},{TYPE:"node_var",NAME:"VECTOR_TYPE",TOKENS:["VT_VECTOR"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"xC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xD",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{TYPE:"equal_expr",PLACES:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",{TYPE:"equal_expr",PLACES:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:3}],STATEMENTS:[{TYPE:"txt",TOKENS:["xD","=","xC",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["VECTOR_TYPE","VT_POINT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["xD","=","ap","(","u_view_tsr_frag",",","xC",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["xD","=","ap","(","u_model_tsr_inverse",",","xC",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["xD","=","ap","(","u_model_tsr",",","xC",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["xD","=","ap","(","u_model_tsr",",","xC",")",";","xD","=","ap","(","u_view_tsr_frag",",","xD",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["xD","=","ap","(","u_view_tsr_inverse",",","xC",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["xD","=","ap","(","u_view_tsr_inverse",",","xC",")",";","xD","=","ap","(","u_model_tsr_inverse",",","xD",")",";"]}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["xD","=","_","(","u_view_tsr_frag",",","xC",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["xD","=","_","(","u_model_tsr_inverse",",","xC",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["xD","=","_","(","u_model_tsr",",","xC",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["xD","=","_","(","u_model_tsr",",","xC",")",";","xD","=","_","(","u_view_tsr_frag",",","xD",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["xD","=","_","(","u_view_tsr_inverse",",","xC",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["xD","=","_","(","u_view_tsr_inverse",",","xC",")",";","xD","=","_","(","u_model_tsr_inverse",",","xD",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["VECTOR_TYPE","VT_NORMAL",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["xD","=","normalize","(","xD",")",";"]}]}]}]}]}]},{TYPE:"node",NAME:"BLACKBODY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xF",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xF","[","0","]","=","xF","[","1","]","=","xF","[","2","]","=","_0_0",";","xE",";"]}]},{TYPE:"node",NAME:"WAVELENGTH",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xG",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xH",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xH","[","0","]","=","xH","[","1","]","=","xH","[","2","]","=","_0_0",";","xG",";"]}]},{TYPE:"node",NAME:"SEPXYZ",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xI",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xJ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xL",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xJ","=","xI","[","0","]",";","xK","=","xI","[","1","]",";","xL","=","xI","[","2","]",";"]}]},{TYPE:"node",NAME:"COMBXYZ",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xN",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xO",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xP",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xP","[","0","]","=","xM",";","xP","[","1","]","=","xN",";","xP","[","2","]","=","xO",";"]}]},{TYPE:"node",NAME:"BRIGHTCONTRAST",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xR",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xS",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xT",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","b","=","xR","-","xS","*","_0_5",";","xT","=","max","(","(","_1_0","+","xS",")","*","xQ","+","b",",","vec3","(","_0_0",")",")",";"]}]},{TYPE:"node",NAME:"LIGHT_FALLOFF",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xV",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xW",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xY",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xW","=","xX","=","xY","=","_0_0",";","xU",";","xV",";"]}]},{TYPE:"node",NAME:"TEX_IMAGE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hm",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Hn",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ho",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Hn","[","0","]","=","Hn","[","1","]","=","Hn","[","2","]","=","_0_0",";","Ho","=","_1_0",";","Hm",";"]}]},{TYPE:"node",NAME:"TEX_ENVIRONMENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hp",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Hq",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Hq","[","0","]","=","Hq","[","1","]","=","Hq","[","2","]","=","_0_0",";","Hp",";"]}]},{TYPE:"node",NAME:"TEX_SKY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"x_",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["x_","[","0","]","=","x_","[","1","]","=","x_","[","2","]","=","_0_0",";","xZ",";"]}]},{TYPE:"node",NAME:"TEX_NOISE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"ya",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yc",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yd",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ye",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yf",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["ye","[","0","]","=","ye","[","1","]","=","ye","[","2","]","=","_0_0",";","yf","=","_1_0",";","ya",";","yb",";","yc",";","yd",";"]}]},{TYPE:"node",NAME:"TEX_WAVE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yh",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yi",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yk",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yl",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ym",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yl","[","0","]","=","yl","[","1","]","=","yl","[","2","]","=","_0_0",";","ym","=","_1_0",";","yg",";","yh",";","yi",";","yj",";","yk",";"]}]},{TYPE:"node",NAME:"TEX_VORONOI",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yn",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yo",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yp",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yq",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","[","0","]","=","yp","[","1","]","=","yp","[","2","]","=","_0_0",";","yq","=","_1_0",";","yn",";","yo",";"]}]},{TYPE:"node",NAME:"TEX_MUSGRAVE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yr",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ys",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yt",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yu",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yB",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yD",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yC","[","0","]","=","yC","[","1","]","=","yC","[","2","]","=","_0_0",";","yD","=","_1_0",";","yr",";","ys",";","yt",";","yu",";","yv",";","yA",";","yB",";"]}]},{TYPE:"node",NAME:"TEX_GRADIENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yG",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yF","[","0","]","=","yF","[","1","]","=","yF","[","2","]","=","_0_0",";","yG","=","_1_0",";","yE",";"]}]},{TYPE:"node",NAME:"TEX_MAGIC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yI",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yJ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yL",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yK","[","0","]","=","yK","[","1","]","=","yK","[","2","]","=","_0_0",";","yL","=","_1_0",";","yH",";","yI",";","yJ",";"]}]},{TYPE:"node",NAME:"TEX_CHECKER",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yM",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yR",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yQ","[","0","]","=","yQ","[","1","]","=","yQ","[","2","]","=","_0_0",";","yR","=","_1_0",";","yM",";","yN",";","yO",";","yP",";"]}]},{TYPE:"node",NAME:"TEX_BRICK",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yS",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yW",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yZ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"y_",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"za",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zb",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["za","[","0","]","=","za","[","1","]","=","za","[","2","]","=","_0_0",";","zb","=","_1_0",";","yS",";","yT",";","yU",";","yV",";","yW",";","yX",";","yY",";","yZ",";","y_",";"]}]},{TYPE:"node",NAME:"ADD_SHADER",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zd",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ze",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["ze","=","clamp","(","zc","+","zd",",","vec3","(","_0_0",")",",","vec3","(","_1_0",")",")",";"]}]},{TYPE:"node",NAME:"MIX_SHADER",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zf",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zh",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zi",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zk",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zl",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zm",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zn",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zo",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zp",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zs",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zt",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zu",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zD",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zF",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zI",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zM",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zO",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zP",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zQ",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","zf",",","_0_0",",","_1_0",")",";","zH","=","mix","(","zi",",","zs",",","zR",")",";","zI","=","mix","(","zj",",","zt",",","zR",")",";","if","(","zm",">","_0_0",")","{","if","(","zA",">","_0_0",")","{","zJ","=","mix","(","zk",",","zu",",","zR",")",";","zK","=","mix","(","zl",",","zv",",","zR",")",";","}","else","{","zJ","=","zk",";","zK","=","zl",";","}","}","else","{","zJ","=","zu",";","zK","=","zv",";","}","if","(","zp",">","_0_0",")","{","if","(","zD",">","_0_0",")","{","zN","=","mix","(","zo",",","zC",",","zR",")",";","}","else","{","zN","=","zo",";","}","}","else","{","zN","=","zC",";","}","zL","=","mix","(","zm",",","zA",",","zR",")",";","zM","=","mix","(","zn",",","zB",",","zR",")",";","zO","=","mix","(","zp",",","zD",",","zR",")",";","zP","=","mix","(","zq",",","zE",",","zR",")",";","zQ","=","mix","(","zr",",","zF",",","zR",")",";"]}]},{TYPE:"node",NAME:"UV_MERGED",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"zS",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zT",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_zS"],STATEMENTS:[{TYPE:"txt",TOKENS:["zS","=","rX","(","A",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_zT"],STATEMENTS:[{TYPE:"txt",TOKENS:["zT","=","vec3","(","A",",","_0_0",")",";"]}]}]}]},{TYPE:"node",NAME:"TEX_COORD_UV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"zU",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zU","=","vec3","(","A",",","_0_0",")",";"]}]},{TYPE:"node",NAME:"TEX_COORD_NO",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"zV",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zV","=","ot",";"]}]},{TYPE:"node",NAME:"TEX_COORD_GE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"zW",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zW","=","vec3","(","A",",","_0_0",")",";"]}]},{TYPE:"node",NAME:"TEX_COORD_OB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"zX",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zX","[","0","]","=","zX","[","1","]","=","zX","[","2","]","=","_1_0",";"]}]},{TYPE:"node",NAME:"TEX_COORD_CA",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"zY",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zY","[","0","]","=","sB","[","0","]",";","zY","[","1","]","=","sB","[","1","]",";","zY","[","2","]","=","_1_0",";"]}]},{TYPE:"node",NAME:"TEX_COORD_WI",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"zZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zZ","[","0","]","=","zZ","[","1","]","=","zZ","[","2","]","=","_1_0",";"]}]},{TYPE:"node",NAME:"TEX_COORD_RE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"z_",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["z_","[","0","]","=","z_","[","1","]","=","z_","[","2","]","=","_1_0",";"]}]},{TYPE:"node",NAME:"UVMAP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"Aa",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Aa","=","vec3","(","A",",","_0_0",")",";"]}]},{TYPE:"node",NAME:"PARTICLE_INFO",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"Ab",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ac",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ad",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ae",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Af",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ag",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ah",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"Hf",QUALIFIER:["GLSL_IN","vec4"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"Hg",QUALIFIER:["GLSL_IN","vec3"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"Hh",QUALIFIER:["GLSL_IN","vec3"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"Hi",QUALIFIER:["GLSL_IN","vec3"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["PARTICLE_BATCH"],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ab"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ab","=","Hf","[","0","]",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ac"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ac","=","Hf","[","1","]",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ad"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ad","=","Hf","[","2","]",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ae"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ae","=","Hg",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Af"],STATEMENTS:[{TYPE:"txt",TOKENS:["Af","=","Hf","[","3","]",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ag"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ag","=","Hh",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ah"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ah","=","Hi",";"]}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["Ab","=","_0_0",";","Ac","=","_0_0",";","Ad","=","_0_0",";","Ae","=","vec3","(","_0_0",")",";","Af","=","_0_0",";","Ag","=","Ae",";","Ah","=","Ae",";"]}]}]}]},{TYPE:"node",NAME:"HAIR_INFO",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"Ai",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Aj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ak",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Al",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Ai","=","_0_0",";","Aj","=","_0_0",";","Ak","=","_0_0",";","Al","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"OBJECT_INFO",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"Am",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"An",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ao",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ap",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["An","=","_0_0",";","Ao","=","_0_0",";","Ap","=","_0_0",";","Am","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"WIREFRAME",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Aq",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ar",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Ar","=","Aq",";"]}]},{TYPE:"node",NAME:"TANGENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"As",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["As","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"LAYER_WEIGHT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hs",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Av",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Aw",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Av","=","Aw","=","_0_0",";","Hs",";","Hr",";"]}]},{TYPE:"node",NAME:"LIGHT_PATH",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"Ay",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Az",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AB",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AC",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AD",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AF",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AG",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AH",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Ay","=","Az","=","AA","=","_0_0",";","AB","=","AC","=","AD","=","_0_0",";","AE","=","AE","=","AG","=","AH","=","_0_0",";","AF","=","_0_0",";"]}]},{TYPE:"node",NAME:"ATTRIBUTE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AL",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AJ","=","AK","=","vec3","(","_0_0",")",";","AL","=","_0_0",";"]}]},{TYPE:"node",NAME:"SCRIPT",NODE_VARS:[],DECLARATIONS:[],STATEMENTS:[]},{TYPE:"node",NAME:"CURVE_VEC",NODE_VARS:[{TYPE:"node_var",NAME:"READ_R",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_G",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_B",TOKENS:["0"]},{TYPE:"node_var",NAME:"NODE_TEX_ROW",TOKENS:["0.0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"AM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"AN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AO",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AO","=","AN",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_R"],STATEMENTS:[{TYPE:"txt",TOKENS:["AO",".","r","=","(","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","_0_5","*","AN",".","r","+","_0_5",",","NODE_TEX_ROW",")",")",".","r","-","_0_5",")","*","2.0",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_G"],STATEMENTS:[{TYPE:"txt",TOKENS:["AO",".","g","=","(","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","_0_5","*","AN",".","g","+","_0_5",",","NODE_TEX_ROW",")",")",".","g","-","_0_5",")","*","2.0",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_B"],STATEMENTS:[{TYPE:"txt",TOKENS:["AO",".","b","=","(","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","_0_5","*","AN",".","b","+","_0_5",",","NODE_TEX_ROW",")",")",".","b","-","_0_5",")","*","2.0",";"]}]}]},{TYPE:"txt",TOKENS:["AO","=","mix","(","AN",",","AO",",","AM",")",";"]}]},{TYPE:"node",NAME:"CURVE_RGB",NODE_VARS:[{TYPE:"node_var",NAME:"READ_A",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_R",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_G",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_B",TOKENS:["0"]},{TYPE:"node_var",NAME:"NODE_TEX_ROW",TOKENS:["_0_0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"AP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"AQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AR",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_A"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","r","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","AQ",".","r",",","NODE_TEX_ROW",")",")",".","a",";","float","g","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","AQ",".","g",",","NODE_TEX_ROW",")",")",".","a",";","float","b","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","AQ",".","b",",","NODE_TEX_ROW",")",")",".","a",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","r","=","AQ",".","r",";","float","g","=","AQ",".","g",";","float","b","=","AQ",".","b",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_R"],STATEMENTS:[{TYPE:"txt",TOKENS:["AR",".","r","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","r",",","NODE_TEX_ROW",")",")",".","r",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["AR",".","r","=","r",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_G"],STATEMENTS:[{TYPE:"txt",TOKENS:["AR",".","g","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","g",",","NODE_TEX_ROW",")",")",".","g",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["AR",".","g","=","g",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_B"],STATEMENTS:[{TYPE:"txt",TOKENS:["AR",".","b","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","b",",","NODE_TEX_ROW",")",")",".","b",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["AR",".","b","=","b",";"]}]}]},{TYPE:"txt",TOKENS:["AR","=","mix","(","AQ",",","AR",",","AP",")",";"]}]},{TYPE:"node",NAME:"VALTORGB",NODE_VARS:[{TYPE:"node_var",NAME:"NODE_TEX_ROW",TOKENS:["_0_0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"AS",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AU",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec4","AV","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","AS",",","NODE_TEX_ROW",")",")",";","AT","=","AV",".","rgb",";","AU","=","AV",".","a",";"]}]},{TYPE:"node",NAME:"MAPPING",NODE_VARS:[{TYPE:"node_var",NAME:"MAPPING_SCALE_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_SCALE",TOKENS:["vec3","(","_1_0",")"]},{TYPE:"node_var",NAME:"MAPPING_TRANS_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_TRANS",TOKENS:["vec3","(","_0_0",")"]},{TYPE:"node_var",NAME:"MAPPING_TRS_MATRIX_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_TRS_MATRIX",TOKENS:["mat4","(","_1_0",")"]},{TYPE:"node_var",NAME:"MAPPING_MIN_CLIP_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_MIN_CLIP",TOKENS:["vec3","(","_0_0",")"]},{TYPE:"node_var",NAME:"MAPPING_MAX_CLIP_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_MAX_CLIP",TOKENS:["vec3","(","_1_0",")"]},{TYPE:"node_var",NAME:"MAPPING_IS_NORMAL",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"AW",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AX",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AX","=","AW",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_SCALE_DEF"],STATEMENTS:[{TYPE:"txt",TOKENS:["AX","=","AX","*","MAPPING_SCALE",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_TRANS_DEF"],STATEMENTS:[{TYPE:"txt",TOKENS:["AX","=","AX","+","MAPPING_TRANS",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_TRS_MATRIX_DEF"],STATEMENTS:[{TYPE:"txt",TOKENS:["AX","=","(","MAPPING_TRS_MATRIX","*","vec4","(","AX",",","_1_0",")",")",".","xyz",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_MIN_CLIP_DEF"],STATEMENTS:[{TYPE:"txt",TOKENS:["AX","=","max","(","AX",",","MAPPING_MIN_CLIP",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_MAX_CLIP_DEF"],STATEMENTS:[{TYPE:"txt",TOKENS:["AX","=","min","(","AX",",","MAPPING_MAX_CLIP",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_IS_NORMAL"],STATEMENTS:[{TYPE:"txt",TOKENS:["AX","=","normalize","(","AX",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_ADD",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"AY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"AZ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"A_",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["A_","=","AY","+","AZ",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["A_","=","clamp","(","A_",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_SUBTRACT",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ba",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Bb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bc",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Bc","=","Ba","-","Bb",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Bc","=","clamp","(","Bc",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_MULTIPLY",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Bd",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Be",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bf",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Bf","=","Bd","*","Be",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Bf","=","clamp","(","Bf",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_DIVIDE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Bg",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Bh",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bi",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Bi","=","(","Bh","!=","_0_0",")","?","Bg","/","Bh",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Bi","=","clamp","(","Bi",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_SINE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Bj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Bk",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bl",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Bl","=","sin","(","Bj",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Bl","=","clamp","(","Bl",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["Bk",";"]}]},{TYPE:"node",NAME:"MATH_COSINE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Bm",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Bn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bo",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Bo","=","cos","(","Bm",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Bo","=","clamp","(","Bo",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["Bn",";"]}]},{TYPE:"node",NAME:"MATH_TANGENT",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Bp",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Bq",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Br",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Br","=","tan","(","Bp",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Br","=","clamp","(","Br",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["Bq",";"]}]},{TYPE:"node",NAME:"MATH_ARCSINE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Bs",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Bt",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bu",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Bu","=","(","Bs","<=","_1_0","&&","Bs",">=","-","_1_0",")","?","asin","(","Bs",")",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Bu","=","clamp","(","Bu",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["Bt",";"]}]},{TYPE:"node",NAME:"MATH_ARCCOSINE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Bv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Bw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bx",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Bx","=","(","Bv","<=","_1_0","&&","Bv",">=","-","_1_0",")","?","acos","(","Bv",")",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Bx","=","clamp","(","Bx",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["Bw",";"]}]},{TYPE:"node",NAME:"MATH_ARCTANGENT",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"By",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Bz",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BA",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BA","=","atan","(","By",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["BA","=","clamp","(","BA",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["Bz",";"]}]},{TYPE:"node",NAME:"MATH_POWER",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BB",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BC",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BD",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["if","(","BB","<","_0_0","&&","BC","!=","floor","(","BC",")",")","BD","=","_0_0",";","else","if","(","BC","==","_0_0",")","BD","=","_1_0",";","else","if","(","BB","<","_0_0",")","BD","=","mix","(","_1_0",",","-","_1_0",",","sign","(","mod","(","-","BC",",","2.0",")",")",")","*","pow","(","-","BB",",","BC",")",";","else","if","(","BB","==","_0_0",")","BD","=","_0_0",";","else","BD","=","pow","(","BB",",","BC",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["BD","=","clamp","(","BD",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_LOGARITHM",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BF",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BG",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BG","=","(","BE",">","_0_0","&&","BF",">","_0_0",")","?","log2","(","BE",")","/","log2","(","BF",")",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["BG","=","clamp","(","BG",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_MINIMUM",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BI",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BJ",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BJ","=","min","(","BH",",","BI",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["BJ","=","clamp","(","BJ",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_MAXIMUM",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BM",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BM","=","max","(","BK",",","BL",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["BM","=","clamp","(","BM",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_ROUND",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BN",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BO",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BP",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BP","=","floor","(","BN","+","_0_5",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["BP","=","clamp","(","BP",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["BO",";"]}]},{TYPE:"node",NAME:"MATH_LESS_THAN",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BQ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BR",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BS",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BS","=","(","BQ","<","BR",")","?","_1_0",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["BS","=","clamp","(","BS",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_GREATER_THAN",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BT",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BV",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BV","=","(","BT",">","BU",")","?","_1_0",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["BV","=","clamp","(","BV",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_MODULO",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BW",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BY",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BY","=","abs","(","BX",")",">","0.000001","?","mod","(","BW",",","BX",")",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["BY","=","clamp","(","BY",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_ABSOLUTE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BZ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"B_",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ca",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Ca","=","abs","(","BZ",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ca","=","clamp","(","Ca",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["B_",";"]}]},{TYPE:"node",NAME:"MIX_RGB_MIX",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cd",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ce",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","Cb",",","_0_0",",","_1_0",")",";","Ce","=","mix","(","Cc",",","Cd",",","zR",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ce","=","clamp","(","Ce",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_ADD",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cf",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ch",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ci",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","Cf",",","_0_0",",","_1_0",")",";","Ci","=","mix","(","Cg",",","Cg","+","Ch",",","zR",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ci","=","clamp","(","Ci",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_MULTIPLY",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ck",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cl",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cm",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","Cj",",","_0_0",",","_1_0",")",";","Cm","=","mix","(","Ck",",","Ck","*","Cl",",","zR",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cm","=","clamp","(","Cm",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_SUBTRACT",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Co",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cp",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cq",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","Cn",",","_0_0",",","_1_0",")",";","Cq","=","mix","(","Co",",","Co","-","Cp",",","zR",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cq","=","clamp","(","Cq",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_SCREEN",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cs",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ct",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cu",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","Cr",",","_0_0",",","_1_0",")",";","float","Cv","=","_1_0","-","zR",";","Cu","=","vec3","(","_1_0",")","-","(","vec3","(","Cv",")","+","zR","*","(","vec3","(","_1_0",")","-","Ct",")",")","*","(","vec3","(","_1_0",")","-","Cs",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cu","=","clamp","(","Cu",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_DIVIDE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cx",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cy",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cz",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","Cw",",","_0_0",",","_1_0",")",";","float","Cv","=","_1_0","-","zR",";","Cy","+=","step","(","Cy",",","vec3","(","_0_0",")",")",";","Cz","=","Cv","*","Cx","+","zR","*","Cx","/","Cy",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cz","=","clamp","(","Cz",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_DIFFERENCE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CD",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","CA",",","_0_0",",","_1_0",")",";","CD","=","mix","(","CB",",","abs","(","CB","-","CC",")",",","zR",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CD","=","clamp","(","CD",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_DARKEN",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CH",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","CE",",","_0_0",",","_1_0",")",";","CH","=","min","(","CF",".","rgb",",","CG",".","rgb","*","zR",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CH","=","clamp","(","CH",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_LIGHTEN",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CI",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CL",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","CI",",","_0_0",",","_1_0",")",";","CL","=","max","(","CJ",".","rgb",",","CK",".","rgb","*","zR",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CL","=","clamp","(","CL",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_OVERLAY",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CP",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","CM",",","_0_0",",","_1_0",")",";","vec3","CQ","=","vec3","(","_1_0","-","zR",")",";","CP","=","mix","(","CN","*","(","CQ","+","2.0","*","zR","*","CO",")",",","vec3","(","_1_0",")","-","(","CQ","+","2.0","*","zR","*","(","vec3","(","_1_0",")","-","CO",")",")","*","(","vec3","(","_1_0",")","-","CN",")",",","step","(","_0_5",",","CN",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CP","=","clamp","(","CP",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_DODGE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CR",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CS",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CU",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","CR",",","_0_0",",","_1_0",")",";","vec3","CV","=","vec3","(","_1_0",")","-","zR","*","CT",";","vec3","CW","=","clamp","(","CS","/","CV",",","_0_0",",","_1_0",")",";","CU","=","mix","(","mix","(","CW",",","vec3","(","_1_0",")",",","step","(","CV",",","vec3","(","_0_0",")",")",")",",","CS",",","step","(","CS",",","vec3","(","_0_0",")",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CU","=","clamp","(","CU",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_BURN",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"C_",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","CX",",","_0_0",",","_1_0",")",";","vec3","ko","=","vec3","(","_1_0","-","zR",")",";","vec3","CV","=","ko","+","zR","*","CZ",";","vec3","CW","=","clamp","(","vec3","(","_1_0",")","-","(","vec3","(","_1_0",")","-","CY",")","/","CV",",","_0_0",",","_1_0",")",";","C_","=","mix","(","CW",",","vec3","(","_0_0",")",",","step","(","CV",",","vec3","(","_0_0",")",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["C_","=","clamp","(","C_",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_HUE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Da",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Db",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Dd",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","Da",",","_0_0",",","_1_0",")",";","vec3","kg",",","De",",","CV",";","Dd","=","Db",";","De","=","kf","(","Dc",")",";","if","(","De",".","y","!=","_0_0",")","{","kg","=","kf","(","Dd",")",";","kg",".","x","=","De",".","x",";","CV","=","kh","(","kg",")",";","Dd","=","mix","(","Dd",",","CV",",","zR",")",";","}"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Dd","=","clamp","(","Dd",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_SATURATION",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Df",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dh",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Di",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","Df",",","_0_0",",","_1_0",")",";","float","Cv","=","_1_0","-","zR",";","Di","=","Dg",";","vec3","kg",",","De",";","kg","=","kf","(","Di",")",";","if","(","kg",".","y","!=","_0_0",")","{","De","=","kf","(","Dh",")",";","kg",".","y","=","Cv","*","kg",".","y","+","zR","*","De",".","y",";","Di","=","kh","(","kg",")",";","}"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Di","=","clamp","(","Di",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_VALUE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Dj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dk",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dl",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Dm",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","Dj",",","_0_0",",","_1_0",")",";","float","Cv","=","_1_0","-","zR",";","vec3","kg",",","De",";","kg","=","kf","(","Dk",")",";","De","=","kf","(","Dl",")",";","kg",".","z","=","Cv","*","kg",".","z","+","zR","*","De",".","z",";","Dm","=","kh","(","kg",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Dm","=","clamp","(","Dm",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_COLOR",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Dn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Do",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dp",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Dq",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","Dn",",","_0_0",",","_1_0",")",";","vec3","kg",",","De",",","CV",";","Dq","=","Do",";","De","=","kf","(","Dp",")",";","if","(","De",".","y","!=","_0_0",")","{","kg","=","kf","(","Dq",")",";","kg",".","x","=","De",".","x",";","kg",".","y","=","De",".","y",";","CV","=","kh","(","kg",")",";","Dq","=","mix","(","Dq",",","CV",",","zR",")",";","}"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Dq","=","clamp","(","Dq",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_SOFT_LIGHT",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Dr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ds",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dt",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Du",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","Dr",",","_0_0",",","_1_0",")",";","float","Cv","=","_1_0","-","zR",";","vec3","Dv","=","Dt","+","Ds","-","Dt","*","Ds",";","Du","=","Ds","*","(","vec3","(","Cv",")","+","vec3","(","zR",")","*","(","(","vec3","(","_1_0",")","-","Ds",")","*","Dt","+","Dv",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Du","=","clamp","(","Du",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_LINEAR_LIGHT",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Dw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dx",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dy",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Dz",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","zR","=","clamp","(","Dw",",","_0_0",",","_1_0",")",";","Dz","=","Dx","+","zR","*","(","2.0","*","Dy","-","vec3","(","_1_0",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Dz","=","clamp","(","Dz",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"OUTPUT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"DI",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DJ",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["E","=","DI",";","I","=","DJ",";"]}]},{TYPE:"node",NAME:"OUTPUT_SURFACE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"DK",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["E","=","DK",";","I","=","_1_0",";"]}]},{TYPE:"node",NAME:"MATERIAL_BEGIN",NODE_VARS:[{TYPE:"node_var",NAME:"MATERIAL_EXT",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_MATERIAL_NORMAL",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_MATERIAL_DIFFUSE",TOKENS:["0"]},{TYPE:"node_var",NAME:"SHADELESS_MAT",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DQ",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"DR",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"DS",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DW",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DX",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DY",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DZ",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sl",QUALIFIER:["const","vec2"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"sm",QUALIFIER:["const","vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["DU","=","clamp","(","DN",",","_0_0",",","_1_0",")",";","DV","=","sm","[","0","]","*","clamp","(","DO",",","_0_0",",","_1_0",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_NORMAL"],STATEMENTS:[{TYPE:"txt",TOKENS:["DW","=","normalize","(","DQ",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["DW","=","ot",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["SHADELESS_MAT",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATERIAL_EXT"],STATEMENTS:[{TYPE:"txt",TOKENS:["DS","=","DR","*","DU",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["DS","=","sC","*","DU",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_DIFFUSE"],STATEMENTS:[{TYPE:"txt",TOKENS:["DU","*=","DP",";"]}]}]},{TYPE:"txt",TOKENS:["DT","=","sD","*","u_environment_energy","*","cz","(","DW",")",";","DZ","=","vec4","(","_1_0",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NUM_LIGHTS",0,{TYPE:"g_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["DX","=","vec2","(","sl","[","0","]",",","sl","[","1","]",")",";","DY","=","vec2","(","sm","[","1","]",",","sm","[","2","]",")",";"]}]}]},{TYPE:"txt",TOKENS:["H","=","DZ",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["DS","=","vec3","(","_0_0",")",";","DT","=","vec3","(","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATERIAL_END",NODE_VARS:[{TYPE:"node_var",NAME:"MATERIAL_EXT",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_MATERIAL_DIFFUSE",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_MATERIAL_SPECULAR",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"D_",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ea",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Eb",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ec",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"Ed",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"Ee",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Ef",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Eg",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Eh",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Ei",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Ej",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"sn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"so",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Ec",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ef"],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_DIFFUSE"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ef","=","D_",".","rgb",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["Ef","=","vec3","(","_0_0",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_SPECULAR"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ef","+=","Ea",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Eh"],STATEMENTS:[{TYPE:"txt",TOKENS:["Eh","=","Eb",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATERIAL_EXT"],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ei"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ei","=","D_",".","rgb",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ej"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ej","=","Ea",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Eg"],STATEMENTS:[{TYPE:"txt",TOKENS:["Eg","=","clamp","(","Ee",",","_0_0",",","_1_0",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_SPECULAR"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","t","=","max","(","max","(","Ea",".","r",",","Ea",".","g",")",",","Ea",".","b",")","*","Ed",";","Eg","=","clamp","(","Ee","*","(","_1_0","-","t",")","+","t",",","_0_0",",","_1_0",")",";"]}]}]}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Eg"],STATEMENTS:[{TYPE:"txt",TOKENS:["Eg","=","clamp","(","sn",",","_0_0",",","_1_0",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_SPECULAR"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","t","=","max","(","max","(","Ea",".","r",",","Ea",".","g",")",",","Ea",".","b",")","*","so",";","Eg","=","sn","*","(","_1_0","-","t",")","+","t",";"]}]}]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_SPECULAR"],STATEMENTS:[{TYPE:"txt",TOKENS:["F","=","Ea",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["F","=","vec3","(","_0_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["G","=","Eb",";"]}]},{TYPE:"node",NAME:"LIGHTING_AMBIENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"oL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"oM",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"oN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oO",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oP",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["oO","=","vec4","(","oL","+","oN","*","oM",",","_0_0",")",";","oP","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"LIGHTING_LAMP",NODE_VARS:[{TYPE:"node_var",NAME:"LAMP_TYPE",TOKENS:["HEMI"]},{TYPE:"node_var",NAME:"LAMP_IND",TOKENS:["0"]},{TYPE:"node_var",NAME:"LAMP_SPOT_SIZE",TOKENS:["0.8"]},{TYPE:"node_var",NAME:"LAMP_SPOT_BLEND",TOKENS:["0.03"]},{TYPE:"node_var",NAME:"LAMP_LIGHT_DIST",TOKENS:["30.0"]},{TYPE:"node_var",NAME:"LAMP_SHADOW_MAP_IND",TOKENS:["-","1"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"oQ",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oS",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oU",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["oS","=","vec2","(","u_light_positions","[","LAMP_IND","]",".","w",",","u_light_color_intensities","[","LAMP_IND","]",".","w",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","HEMI",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["oU","=","_0_5",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["oU","=","_0_0",";"]}]}]},{TYPE:"txt",TOKENS:["oT","=","u_light_color_intensities","[","LAMP_IND","]",".","xyz",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_SHADOW_MAP_IND",1,{TYPE:"negative_expr",PLACES:1},{TYPE:"non_equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["oT","*=","oQ","[","LAMP_SHADOW_MAP_IND","]",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2},"LAMP_TYPE","POINT",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","oV","=","u_light_positions","[","LAMP_IND","]",".","xyz",";","oR","=","oV","-","os",";","float","aM","=","length","(","oR",")",";","oT","*=","LAMP_LIGHT_DIST","/","(","LAMP_LIGHT_DIST","+","aM","*","aM",")",";","oR","=","normalize","(","oR",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","oX","=","u_light_directions","[","LAMP_IND","]",";","float","oY","=","dot","(","oR",",","oX",")",";","oY","*=","smoothstep","(","_0_0",",","_1_0",",","(","oY","-","LAMP_SPOT_SIZE",")","/","LAMP_SPOT_BLEND",")",";","oT","*=","oY",";"]}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["oR","=","u_light_directions","[","LAMP_IND","]",";"]}]}]}]},{TYPE:"node",NAME:"DIFFUSE_FRESNEL",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"oZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"o_",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pa",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pc",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pd",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pe","=","cross","(","oZ",",","k",".","xyz",")",";","pa","=","cross","(","pe",",","k",".","xyz",")",";","pa","=","-","normalize","(","pa",")",";"]}]}]},{TYPE:"txt",TOKENS:["pd","=","_0_0",";","if","(","o_",".","r","!=","_0_0",")","{","float","pf","=","(","_1_0","-","pb",")","*","dot","(","pa",",","oZ",")","+","pb",";","if","(","pc","[","0","]","==","_0_0",")","{","pd","=","_1_0",";","}","else","{","float","t","=","_1_0","+","abs","(","pf",")",";","t","=","pc","[","1","]","+","(","_1_0","-","pc","[","1","]",")","*","pow","(","t",",","pc","[","0","]",")",";","pd","=","clamp","(","t",",","_0_0",",","_1_0",")",";","}","pd","=","max","(","pd",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"DIFFUSE_LAMBERT",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ph",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pi",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pk",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pe","=","cross","(","pg",",","k",".","xyz",")",";","pi","=","cross","(","pe",",","k",".","xyz",")",";","pi","=","-","normalize","(","pi",")",";"]}]}]},{TYPE:"txt",TOKENS:["pk","=","_0_0",";","if","(","ph",".","r","!=","_0_0",")","{","float","pf","=","(","_1_0","-","pj",")","*","dot","(","pi",",","pg",")","+","pj",";","pk","=","max","(","pf",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"DIFFUSE_OREN_NAYAR",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pl",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pm",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pn",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"po",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pr",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pu",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pe","=","cross","(","pl",",","k",".","xyz",")",";","pn","=","cross","(","pe",",","k",".","xyz",")",";","pn","=","-","normalize","(","pn",")",";"]}]}]},{TYPE:"txt",TOKENS:["pu","=","_0_0",";","if","(","pm",".","r","!=","_0_0",")","{","float","pf","=","(","_1_0","-","po",")","*","dot","(","pn",",","pl",")","+","po",";","if","(","pr","[","0","]",">","_0_0",")","{","float","pv","=","max","(","dot","(","pn",",","ou",")",",","_0_0",")",";","float","pw","=","pr","[","0","]","*","pr","[","0","]",";","float","cB","=","_1_0","-","_0_5","*","(","pw","/","(","pw","+","0.33",")",")",";","vec3","px","=","pl","-","pf","*","pn",";","vec3","py","=","ou","-","pv","*","pn",";","if","(","length","(","px",")","==","_0_0","||","length","(","py",")","==","_0_0","||","abs","(","pf",")",">","_1_0","||","abs","(","pv",")",">","_1_0",")","pu","=","pf","*","cB",";","else","{","float","pz","=","acos","(","pf",")",";","float","pA","=","acos","(","pv",")",";","vec3","pB","=","normalize","(","px",")",";","vec3","pC","=","normalize","(","py",")",";","float","a",",","b",";","a","=","max","(","pz",",","pA",")",";","b","=","min","(","pz",",","pA",")",";","b","*=","0.95",";","float","t","=","max","(","dot","(","pB",",","pC",")",",","_0_0",")",";","float","hO","=","0.45","*","(","pw","/","(","pw","+","0.09",")",")",";","pu","=","pf","*","(","cB","+","(","hO","*","t","*","sin","(","a",")","*","tan","(","b",")",")",")",";","}","}","else","pu","=","pf",";","pu","=","max","(","pu",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"DIFFUSE_MINNAERT",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pD",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pE",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pG",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pH",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pI",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pe","=","cross","(","pD",",","k",".","xyz",")",";","pF","=","cross","(","pe",",","k",".","xyz",")",";","pF","=","-","normalize","(","pF",")",";"]}]}]},{TYPE:"txt",TOKENS:["pI","=","_0_0",";","if","(","pE",".","r","!=","_0_0",")","{","float","pf","=","(","_1_0","-","pG",")","*","dot","(","pF",",","pD",")","+","pG",";","float","pv","=","max","(","dot","(","pF",",","ou",")",",","_0_0",")",";","if","(","pH","[","0","]","<=","_1_0",")","pI","=","pf","*","pow","(","max","(","pv","*","pf",",","0.1",")",",","pH","[","0","]","-","_1_0",")",";","else","pI","=","pf","*","pow","(","1.0001","-","pv",",","pH","[","0","]","-","_1_0",")",";","pI","=","max","(","pI",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"DIFFUSE_TOON",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pK",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pN",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pO",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pe","=","cross","(","pJ",",","k",".","xyz",")",";","pL","=","cross","(","pe",",","k",".","xyz",")",";","pL","=","-","normalize","(","pL",")",";"]}]}]},{TYPE:"txt",TOKENS:["pO","=","_0_0",";","if","(","pK",".","r","!=","_0_0",")","{","float","pf","=","(","_1_0","-","pM",")","*","dot","(","pL",",","pJ",")","+","pM",";","float","pP","=","acos","(","pf",")",";","if","(","pP","<","pN","[","0","]",")","pO","=","_1_0",";","else","if","(","pP",">","(","pN","[","0","]","+","pN","[","1","]",")","||","pN","[","1","]","==","_0_0",")","pO","=","_0_0",";","else","pO","=","_1_0","-","(","(","pP","-","pN","[","0","]",")","/","pN","[","1","]",")",";","pO","=","max","(","pO",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_PHONG",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pR",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pS",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pT",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pU",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pV",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["pV","=","_0_0",";","if","(","pR",".","g","==","_1_0",")","{","vec3","pW","=","normalize","(","pQ","+","ou",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["if","(","pT","==","_0_0",")","{","pV","=","dot","(","k",".","xyz",",","pW",")",";","pV","=","sqrt","(","_1_0","-","pV","*","pV",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["pV","=","(","_1_0","-","pT",")","*","max","(","dot","(","pS",",","pW",")",",","_0_0",")","+","pT",";"]}]}]},{TYPE:"txt",TOKENS:["pV","=","pow","(","pV",",","pU","[","0","]",")",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_COOKTORR",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pY",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"p_",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qa",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qb",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["qb","=","_0_0",";","if","(","pY",".","g","!=","_0_0",")","{","vec3","pW","=","normalize","(","pX","+","ou",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["if","(","p_","==","_0_0",")","{","qb","=","dot","(","B",".","xyz",",","pW",")",";","qb","=","sqrt","(","_1_0","-","qb","*","qb",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["qb","=","max","(","dot","(","pZ",",","pW",")",",","_0_0",")",";","qb","=","(","_1_0","-","p_",")","*","qb","+","p_",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","pv","=","max","(","dot","(","B",".","xyz",",","ou",")",",","_0_0",")",";","pv","=","sqrt","(","_1_0","-","pv","*","pv",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","pv","=","max","(","dot","(","pZ",",","ou",")",",","_0_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["qb","=","pow","(","qb",",","qa","[","0","]",")",";","qb","=","qb","/","(","0.1","+","pv",")",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_WARDISO",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qd",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qe",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qf",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qg",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qh",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["qh","=","_0_0",";","if","(","qd",".","g","==","_1_0",")","{","vec3","pW","=","normalize","(","qc","+","ou",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","qi","=","_0_0",";","float","pv","=","_0_0",";","float","qj","=","_0_0",";","if","(","qf","==","_0_0",")","{","qi","=","dot","(","k",".","xyz",",","pW",")",";","pv","=","dot","(","k",".","xyz",",","ou",")",";","qj","=","dot","(","k",".","xyz",",","qc",")",";","qi","=","sqrt","(","_1_0","-","qi","*","qi",")",";","pv","=","sqrt","(","_1_0","-","pv","*","pv",")",";","qj","=","sqrt","(","_1_0","-","qj","*","qj",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","qi","=","max","(","dot","(","qe",",","pW",")",",","0.01",")",";","float","pv","=","max","(","dot","(","qe",",","ou",")",",","0.01",")",";","float","qj","=","max","(","dot","(","qe",",","qc",")",",","0.01",")",";"]}]}]},{TYPE:"txt",TOKENS:["float","bK","=","tan","(","acos","(","qi",")",")",";","float","L","=","max","(","qg","[","0","]",",","0.01",")",";","qh","=","qj","*","(","_1_0","/","(","4.0","*","M_PI","*","L","*","L",")",")","*","(","exp","(","-","(","bK","*","bK",")","/","(","L","*","L",")",")","/","(","sqrt","(","pv","*","qj",")",")",")",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_TOON",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qk",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ql",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qm",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qo",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qr",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["qr","=","_0_0",";","if","(","ql",".","g","==","_1_0",")","{","vec3","cj","=","normalize","(","qk","+","ou",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","qu","=","dot","(","cj",",","k",".","xyz",")",";","float","bK","=","qo","[","0","]","+","qo","[","1","]",";","if","(","qn","==","_0_0",")","bK","=","acos","(","sqrt","(","_1_0","-","qu","*","qu",")",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","bK","=","acos","(","dot","(","cj",",","qm",")",")",";"]}]}]},{TYPE:"txt",TOKENS:["if","(","bK","<","qo","[","0","]",")","qr","=","_1_0",";","else","if","(","bK",">=","qo","[","0","]","+","qo","[","1","]","||","qo","[","1","]","==","_0_0",")","qr","=","_0_0",";","else","qr","=","_1_0","-","(","bK","-","qo","[","0","]",")","/","qo","[","1","]",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_BLINN",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qv",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qw",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qx",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qy",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qz",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qA",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["qA","=","_0_0",";","if","(","qw",".","g","==","_1_0",")","{","if","(","qz","[","0","]","<","_1_0","||","qz","[","1","]","==","_0_0",")","qA","=","_0_0",";","else","{","if","(","qz","[","1","]","<","100.0",")","qz","[","1","]","=","sqrt","(","_1_0","/","qz","[","1","]",")",";","else","qz","[","1","]","=","10.0","/","qz","[","1","]",";","vec3","pW","=","normalize","(","ou","+","qv",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","qi","=","_0_0",";","if","(","qy","==","_0_0",")","{","float","qD","=","dot","(","k",".","xyz",",","pW",")",";","qi","=","sqrt","(","_1_0","-","qD","*","qD",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","qi","=","(","_1_0","-","qy",")","*","max","(","dot","(","qx",",","pW",")",",","_0_0",")","+","qy",";"]}]}]},{TYPE:"txt",TOKENS:["if","(","qi","<","_0_0",")","qA","=","_0_0",";","else","{","float","pv","=","max","(","dot","(","qx",",","ou",")",",","0.01",")",";","float","qj","=","dot","(","qx",",","qv",")",";","if","(","qj","<=","0.01",")","qA","=","_0_0",";","else","{","float","qE","=","max","(","dot","(","ou",",","pW",")",",","0.01",")",";","float","a","=","_1_0",";","float","b","=","(","2.0","*","qi","*","pv",")","/","qE",";","float","du","=","(","2.0","*","qi","*","qj",")","/","qE",";","float","g","=","min","(","min","(","a",",","b",")",",","du",")",";","float","p","=","sqrt","(","pow","(","qz","[","0","]",",","2.0",")","+","pow","(","qE",",","2.0",")","-","_1_0",")",";","float","mi","=","pow","(","p","-","qE",",","2.0",")","/","pow","(","p","+","qE",",","2.0",")","*","(","_1_0","+","pow","(","qE","*","(","p","+","qE",")","-","_1_0",",","2.0",")","/","pow","(","qE","*","(","p","-","qE",")","+","_1_0",",","2.0",")",")",";","float","pP","=","acos","(","qi",")",";","qA","=","max","(","mi","*","g","*","exp","(","-","pow","(","pP",",","2.0",")","/","(","2.0","*","pow","(","qz","[","1","]",",","2.0",")",")",")",",","_0_0",")",";","}","}","}","}"]}]},{TYPE:"node",NAME:"LIGHTING_APPLY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"qF",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qI",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qL",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qM",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qQ",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qR",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NODE_B4W_TRANSLUCENCY"],STATEMENTS:[{TYPE:"txt",TOKENS:["if","(","dot","(","qJ",",","qK",")","*","dot","(","ou",",","qK",")","<","_0_0",")","{","float","Ek","=","qL",".","x",";","float","El","=","qL",".","y",";","float","Em","=","qL",".","z",";","float","En","=","qL",".","w",";","float","Eo","=","clamp","(","abs","(","dot","(","qJ",",","qK",")",")",",","_0_0",",","_1_0",")",";","float","Ep","=","clamp","(","dot","(","ou",",","-","qJ",")",",","_0_0",",","_1_0",")",";","float","Eq","=","pow","(","Ep",",","El",")",";","qQ","=","qF","+","qP","*","vec4","(","qO","*","Eo","*","pow","(","qM",",","vec3","(","Ek",")",")",",","_1_0",")",";","qQ","+=","Em","*","mix","(","vec4","(","qM",",","_1_0",")",",","vec4","(","_1_0",")",",","En",")","*","qP","*","vec4","(","qO","*","Eo","*","vec3","(","Eq",")",",","_1_0",")",";","}","else","{","qQ","=","qF","+","vec4","(","qO","*","qM","*","qH",",","qI",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["qQ","=","qF","+","vec4","(","qO","*","qM","*","qH",",","qI",")",";"]}]}]},{TYPE:"txt",TOKENS:["qR","=","qG","+","qO","*","qN","*","qI",";"]}]},{TYPE:"node",NAME:"RGB",NODE_VARS:[{TYPE:"node_var",NAME:"RGB_IND",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_out",NAME:"Er",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Er","=","u_node_rgbs","[","RGB_IND","]",";"]}]},{TYPE:"node",NAME:"RGBTOBW",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Es",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Et",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Et","=","dot","(","Es",",","vec3","(","0.35",",","0.45",",","0.2",")",")",";"]}]},{TYPE:"node",NAME:"SEPRGB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Eu",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ev",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Ew",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Ex",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ev"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ev","=","Eu",".","r",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ew"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ew","=","Eu",".","g",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ex"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ex","=","Eu",".","b",";"]}]}]}]},{TYPE:"node",NAME:"SEPHSV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Ey",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ez",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"EA",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"EB",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","EC","=","kf","(","Ey",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ez"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ez","=","EC",".","r",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_EA"],STATEMENTS:[{TYPE:"txt",TOKENS:["EA","=","EC",".","g",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_EB"],STATEMENTS:[{TYPE:"txt",TOKENS:["EB","=","EC",".","b",";"]}]}]}]},{TYPE:"node",NAME:"SQUEEZE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"ED",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EF",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EG",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["EG","=","_1_0","/","(","_1_0","+","pow","(","2.71828183",",","-","(","ED","-","EF",")","*","EE",")",")",";"]}]},{TYPE:"node",NAME:"GAMMA",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"EH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EI",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["EJ","=","EH",";","if","(","EJ",".","x",">","_0_0",")","EJ",".","x","=","pow","(","EH",".","x",",","EI",")",";","if","(","EJ",".","y",">","_0_0",")","EJ",".","y","=","pow","(","EH",".","y",",","EI",")",";","if","(","EJ",".","z",">","_0_0",")","EJ",".","z","=","pow","(","EH",".","z",",","EI",")",";"]}]},{TYPE:"node",NAME:"B4W_SRGB_TO_LINEAR",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"EK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EL",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["EL","=","max","(","vec3","(","_0_0",")",",","EK",")",";","EL","=","pow","(","EL",",","vec3","(","2.2",")",")",";"]}]},{TYPE:"node",NAME:"B4W_LINEAR_TO_SRGB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"EM",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EN",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["EN","=","max","(","vec3","(","_0_0",")",",","EM",")",";","EN","=","pow","(","EN",",","vec3","(","_1_0","/","2.2",")",")",";"]}]},{TYPE:"node",NAME:"TEXTURE_EMPTY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"EO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EP",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EQ",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_EO"],STATEMENTS:[{TYPE:"txt",TOKENS:["EO","[","2","]","=","EO","[","1","]","=","EO","[","0","]","=","_0_0",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_EP"],STATEMENTS:[{TYPE:"txt",TOKENS:["EP","[","2","]","=","EP","[","1","]","=","EP","[","0","]","=","_0_0",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_EQ"],STATEMENTS:[{TYPE:"txt",TOKENS:["EQ","=","_0_0",";"]}]}]}]},{TYPE:"node",NAME:"TEXTURE_ENVIRONMENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Ht",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Hu",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Hv",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"node_TEXTURE_ENVIRONMENT_var_texture",QUALIFIER:["uniform","samplerCube"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec4","AV","=","GLSL_TEXTURE_CUBE","(","node_TEXTURE_ENVIRONMENT_var_texture",",","Ht",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Hu"],STATEMENTS:[{TYPE:"txt",TOKENS:["Hu","=","AV",".","xyz",";","bC","(","Hu",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Hv"],STATEMENTS:[{TYPE:"txt",TOKENS:["Hv","=","AV",".","w",";"]}]}]}]},{TYPE:"node",NAME:"TEXTURE_COLOR",NODE_VARS:[{TYPE:"node_var",NAME:"NON_COLOR",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv2",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv3",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv4",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Fa",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"Fb",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"Fc",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"Fd",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fe",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Ff",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fg",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fh",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fi",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fj",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fk",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fl",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"node_TEXTURE_COLOR_var_texture",QUALIFIER:["uniform","sampler2D"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec4","AV","=","GLSL_TEXTURE","(","node_TEXTURE_COLOR_var_texture",",","rY","(","Fa",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fe"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fe","=","AV",".","xyz",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NON_COLOR",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["bC","(","Fe",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ff"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ff","=","AV",".","w",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv2"],STATEMENTS:[{TYPE:"txt",TOKENS:["AV","=","GLSL_TEXTURE","(","node_TEXTURE_COLOR_var_texture",",","rY","(","Fb",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fg"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fg","=","AV",".","xyz",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NON_COLOR",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["bC","(","Fg",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fh"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fh","=","AV",".","w",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv3"],STATEMENTS:[{TYPE:"txt",TOKENS:["AV","=","GLSL_TEXTURE","(","node_TEXTURE_COLOR_var_texture",",","rY","(","Fc",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fi"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fi","=","AV",".","xyz",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NON_COLOR",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["bC","(","Fi",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fj"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fj","=","AV",".","w",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv4"],STATEMENTS:[{TYPE:"txt",TOKENS:["AV","=","GLSL_TEXTURE","(","node_TEXTURE_COLOR_var_texture",",","rY","(","Fd",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fk"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fk","=","AV",".","xyz",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NON_COLOR",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["bC","(","Fk",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fl"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fl","=","AV",".","w",";"]}]}]}]}]}]},{TYPE:"node",NAME:"TEXTURE_NORMAL",NODE_VARS:[{TYPE:"node_var",NAME:"USE_uv2",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv3",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv4",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Fm",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"Fn",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"Fo",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"Fp",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fq",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fr",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fs",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Ft",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fu",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fv",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fw",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fx",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"node_TEXTURE_NORMAL_var_texture",QUALIFIER:["uniform","sampler2D"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec4","AV","=","GLSL_TEXTURE","(","node_TEXTURE_NORMAL_var_texture",",","rY","(","Fm",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fq"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fq","=","normalize","(","sy","*","(","AV",".","xyz","-","_0_5",")",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fr"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fr","=","AV",".","w",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv2"],STATEMENTS:[{TYPE:"txt",TOKENS:["AV","=","GLSL_TEXTURE","(","node_TEXTURE_NORMAL_var_texture",",","rY","(","Fn",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fs"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fs","=","normalize","(","sy","*","(","AV",".","xyz","-","_0_5",")",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ft"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ft","=","AV",".","w",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv3"],STATEMENTS:[{TYPE:"txt",TOKENS:["AV","=","GLSL_TEXTURE","(","node_TEXTURE_NORMAL_var_texture",",","rY","(","Fo",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fu"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fu","=","normalize","(","sy","*","(","AV",".","xyz","-","_0_5",")",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fv"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fv","=","AV",".","w",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv4"],STATEMENTS:[{TYPE:"txt",TOKENS:["AV","=","GLSL_TEXTURE","(","node_TEXTURE_NORMAL_var_texture",",","rY","(","Fp",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fw"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fw","=","normalize","(","sy","*","(","AV",".","xyz","-","_0_5",")",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fx"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fx","=","AV",".","w",";"]}]}]}]}]}]},{TYPE:"node",NAME:"VALUE",NODE_VARS:[{TYPE:"node_var",NAME:"VALUE_ROW_IND",TOKENS:["0"]},{TYPE:"node_var",NAME:"VALUE_COL_IND",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_out",NAME:"Fy",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Fy","=","u_node_values","[","VALUE_ROW_IND","]","[","VALUE_COL_IND","]",";"]}]},{TYPE:"node",NAME:"VECT_MATH_ADD",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Fz",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"FA",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FC",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["FB","=","Fz","+","FA",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FC"],STATEMENTS:[{TYPE:"txt",TOKENS:["FC","=","(","abs","(","FB","[","0","]",")","+","abs","(","FB","[","1","]",")","+","abs","(","FB","[","2","]",")",")","/","3.0",";"]}]}]}]},{TYPE:"node",NAME:"VECT_MATH_SUBTRACT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"FD",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"FE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FG",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["FF","=","FD","-","FE",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FG"],STATEMENTS:[{TYPE:"txt",TOKENS:["FG","=","(","abs","(","FF","[","0","]",")","+","abs","(","FF","[","1","]",")","+","abs","(","FF","[","2","]",")",")","/","3.0",";"]}]}]}]},{TYPE:"node",NAME:"VECT_MATH_AVERAGE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"FH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"FI",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FK",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["FJ","=","FH","+","FI",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FK"],STATEMENTS:[{TYPE:"txt",TOKENS:["FK","=","length","(","FJ",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FJ"],STATEMENTS:[{TYPE:"txt",TOKENS:["FJ","=","normalize","(","FJ",")",";"]}]}]}]},{TYPE:"node",NAME:"VECT_MATH_DOT_PRODUCT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"FL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"FM",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FO",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["FN","=","vec3","(","_0_0",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FO"],STATEMENTS:[{TYPE:"txt",TOKENS:["FO","=","dot","(","FL",",","FM",")",";"]}]}]}]},{TYPE:"node",NAME:"VECT_MATH_CROSS_PRODUCT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"FP",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"FQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FS",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["FR","=","cross","(","FP",",","FQ",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FS"],STATEMENTS:[{TYPE:"txt",TOKENS:["FS","=","length","(","FR",")",";"]}]}]}]},{TYPE:"node",NAME:"VECT_MATH_NORMALIZE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"FT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"FU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FW",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["FV","=","normalize","(","FT",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FW"],STATEMENTS:[{TYPE:"txt",TOKENS:["FW","=","length","(","FT",")",";"]}]}]},{TYPE:"txt",TOKENS:["FU",";"]}]},{TYPE:"node",NAME:"B4W_REFLECT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Gc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Gd",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ge",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Ge","=","reflect","(","_","(","u_view_tsr_inverse",",","Gc",")",",","Gd",")",";"]}]},{TYPE:"node",NAME:"B4W_REFLECT_WORLD",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Gf",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Gg",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","Hw","=","-","ou",".","xyz",";","Gg","=","reflect","(","Hw",",","Gf",")",";"]}]},{TYPE:"node",NAME:"B4W_PARALLAX",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Gh",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Gi",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Gj",QUALIFIER:["const","float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Gk",QUALIFIER:["const","float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Gl",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"node_B4W_PARALLAX_var_texture",QUALIFIER:["uniform","sampler2D"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","bN","=","length","(","sB",")",";","if","(","bN","<","Gk",")","{","vec2","b_","=","rY","(","Gh",")",";","float","cd","=","clamp","(","_0_5","*","(","Gk","-","bN",")",",","_0_0",",","_1_0",")",";","float","hG","=","Gi","*","cd",";","vec3","cf","=","normalize","(","ou","*","sy",")",";","float","cg","=","_1_0","/","Gj",";","vec2","ch","=","cf",".","xy","*","hG","/","(","Gj","*","cf",".","z",")",";","float","ci","=","_1_0",";","float","cj","=","GLSL_TEXTURE","(","node_B4W_PARALLAX_var_texture",",","b_",")",".","a",";","for","(","float","cl","=","1.0",";","cl","<=","Gj",";","cl","++",")","{","if","(","cj","<","ci",")","{","ci","-=","cg",";","b_","-=","ch",";","cj","=","GLSL_TEXTURE","(","node_B4W_PARALLAX_var_texture",",","b_",")",".","a",";","}","}","vec2","cm","=","b_","+","ch",";","float","cn","=","GLSL_TEXTURE","(","node_B4W_PARALLAX_var_texture",",","cm",")",".","a","-","(","ci","+","cg",")",";","float","co","=","cj","-","ci",";","float","cp","=","co","/","(","co","-","cn",")",";","b_","=","cp","*","cm","+","(","_1_0","-","cp",")","*","b_",";","Gl","=","rX","(","b_",")",";","}","else","Gl","=","Gh",";"]}]},{TYPE:"node",NAME:"B4W_CLAMP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Gm",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Gn",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Gn","=","clamp","(","Gm",",","_0_0",",","_1_0",")",";"]}]},{TYPE:"node",NAME:"B4W_REFRACTION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Go",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Gp",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Gq",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Gq","=","Go",";"]}]},{TYPE:"node",NAME:"B4W_TRANSLUCENCY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Gr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Gs",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Gt",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Gu",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Gv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Gw",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gx",QUALIFIER:["vec4"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gw"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gw","=","Gr",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gx"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gx","=","vec4","(","Gs",",","Gt",",","Gu",",","Gv",")",";"]}]}]}]},{TYPE:"node",NAME:"B4W_TIME",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"Gy",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Gy","=","u_time",";"]}]},{TYPE:"node",NAME:"B4W_SMOOTHSTEP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Gz",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GB",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GC",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["GC","=","smoothstep","(","GA",",","GB",",","Gz",")",";"]}]},{TYPE:"node",NAME:"B4W_GLOW_OUTPUT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GD",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GE",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["E","=","GD",";","I","=","GE",";"]}]},{TYPE:"node",NAME:"B4W_VECTOSCAL",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GG",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["GG","=","(","GF",".","r","+","GF",".","g","+","GF",".","b",")","/","3.0",";"]}]},{TYPE:"node",NAME:"B4W_SCALTOVEC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GI",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["GI","[","0","]","=","GH",";","GI","[","1","]","=","GH",";","GI","[","2","]","=","GH",";"]}]},{TYPE:"nodes_global"},{TYPE:"txt",TOKENS:["void","J","(","in","vec3","ou",",","out","vec3","E",",","out","vec3","F",",","out","vec3","G",",","out","vec4","H",",","out","float","I",")","{","E","=","vec3","(","_0_0",")",";","F","=","vec3","(","_0_0",")",";","G","=","vec3","(","_0_0",")",";","H","=","vec4","(","_0_0",")",";","I","=","_0_0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_NORMAL_MAP","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:11}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sv","=","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","gl_FrontFacing","==","false",")"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","gl_FrontFacing",")"]}]}}]},{TYPE:"txt",TOKENS:["sv","=","sv",";","else","sv","=","-","sv",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_NORMAL_MAP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sw","=","sv",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sx","=","normalize","(","sv",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DOUBLE_SIDED_LIGHTING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ot","=","sx",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ot","=","normalize","(","j",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_NO"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","su","=","sx",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","W","=","cross","(","sx",",","k",".","xyz",")","*","k",".","w",";","mat3","sy","=","mat3","(","k",".","xyz",",","W",",","sx",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_NORMAL_MAP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","W","=","cross","(","sv",",","k",".","xyz",")","*","k",".","w",";","mat3","sA","=","mat3","(","k",".","xyz",",","W",",","sv",")",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["vec3","os","=","h",";","vec4","sB","=","i",";","float","sC","=","u_emit",";","float","sD","=","u_ambient",";"]},{TYPE:"nodes_main"},{TYPE:"txt",TOKENS:["}"]}]}}]}]},e["include/particles_nodes.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"PARTICLES_NODES_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"PARTICLES_NODES_GLSLV",TOKENS:[""]},{TYPE:"node",NAME:"TEX_COORD_UV",NODE_VARS:[],DECLARATIONS:[],STATEMENTS:[{TYPE:"txt",TOKENS:["A","=","HC",";"]}]},{TYPE:"node",NAME:"UV_MERGED",NODE_VARS:[],DECLARATIONS:[],STATEMENTS:[{TYPE:"txt",TOKENS:["A","=","HC",";"]}]},{TYPE:"node",NAME:"UVMAP",NODE_VARS:[],DECLARATIONS:[],STATEMENTS:[{TYPE:"txt",TOKENS:["A","=","HC",";"]}]},{TYPE:"node",NAME:"GEOMETRY_UV",NODE_VARS:[],DECLARATIONS:[],STATEMENTS:[{TYPE:"txt",TOKENS:["A","=","HC",";"]}]},{TYPE:"node",NAME:"PARTICLE_INFO",NODE_VARS:[{TYPE:"node_var",NAME:"PART_INFO_SIZE",TOKENS:["0"]},{TYPE:"node_var",NAME:"PART_INFO_AGE",TOKENS:["0"]},{TYPE:"node_var",NAME:"PART_INFO_LT",TOKENS:["0"]},{TYPE:"node_var",NAME:"PART_INFO_LOC",TOKENS:["0"]},{TYPE:"node_var",NAME:"PART_INFO_IND",TOKENS:["0"]},{TYPE:"node_var",NAME:"PART_INFO_VEL",TOKENS:["0"]},{TYPE:"node_var",NAME:"PART_INFO_A_VEL",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_param",NAME:"Hf",QUALIFIER:["GLSL_OUT","vec4"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"Hg",QUALIFIER:["GLSL_OUT","vec3"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"Hh",QUALIFIER:["GLSL_OUT","vec3"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"Hi",QUALIFIER:["GLSL_OUT","vec3"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"node_PARTICLE_INFO_var_a_p_indices",QUALIFIER:["GLSL_IN","float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["PART_INFO_SIZE"],STATEMENTS:[{TYPE:"txt",TOKENS:["Hf","[","3","]","=","HB",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["PART_INFO_AGE"],STATEMENTS:[{TYPE:"txt",TOKENS:["Hf","[","1","]","=","HA",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["PART_INFO_LT"],STATEMENTS:[{TYPE:"txt",TOKENS:["Hf","[","2","]","=","HD",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["PART_INFO_LOC"],STATEMENTS:[{TYPE:"txt",TOKENS:["Hg","=","Hx",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["PART_INFO_IND"],STATEMENTS:[{TYPE:"txt",TOKENS:["Hf","[","0","]","=","node_PARTICLE_INFO_var_a_p_indices",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["PART_INFO_VEL"],STATEMENTS:[{TYPE:"txt",TOKENS:["Hh","=","Hy",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["PART_INFO_A_VEL"],STATEMENTS:[{TYPE:"txt",TOKENS:["Hi","=","Hz",";"]}]}]}]},{TYPE:"nodes_global"},{TYPE:"txt",TOKENS:["void","J","(","in","vec3","Hx",",","in","vec3","Hy",",","in","vec3","Hz",",","in","float","HA",",","in","float","HB",",","in","vec2","HC",",","in","float","HD",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["A","=","HC",";"]}]}}]},{TYPE:"nodes_main"},{TYPE:"txt",TOKENS:["}"]}]}}]}]},e["include/precision_statement.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"PRECISION_STATEMENT_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"PRECISION_STATEMENT_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"txt",TOKENS:["precision","PRECISION","float",";"]}]}}]}]},e["include/procedural.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"PROCEDURAL_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"PROCEDURAL_GLSLF",TOKENS:[""]},{TYPE:"txt",TOKENS:["vec4","HE","(","vec4","x",")","{","return","x","-","floor","(","x","*","(","_1_0","/","289.0",")",")","*","289.0",";","}","vec3","HE","(","vec3","x",")","{","return","x","-","floor","(","x","*","(","_1_0","/","289.0",")",")","*","289.0",";","}","vec2","HE","(","vec2","x",")","{","return","x","-","floor","(","x","*","(","_1_0","/","289.0",")",")","*","289.0",";","}","vec4","HF","(","vec4","x",")","{","return","x","-","floor","(","x","*","(","_1_0","/","7.0",")",")","*","7.0",";","}","vec4","HG","(","vec4","x",")","{","return","HE","(","(","34.0","*","x","+","5.0",")","*","x",")",";","}"]},{TYPE:"define",NAME:"K",TOKENS:["0.142857142857"]},{TYPE:"define",NAME:"K2",TOKENS:["0.0714285714285"]},{TYPE:"define",NAME:"JITTER",TOKENS:["0.7"]},{TYPE:"txt",TOKENS:["vec2","fG","(","vec2","HH",")","{","vec2","HI","=","HE","(","floor","(","HH",")",")",";","vec2","HJ","=","fract","(","HH",")",";","vec4","HK","=","HJ",".","x","+","vec4","(","-","0.5",",","-","1.5",",","-","0.5",",","-","1.5",")",";","vec4","HL","=","HJ",".","y","+","vec4","(","-","0.5",",","-","0.5",",","-","1.5",",","-","1.5",")",";","vec4","p","=","HG","(","HI",".","x","+","vec4","(","_0_0",",","_1_0",",","_0_0",",","_1_0",")",")",";","p","=","HG","(","p","+","HI",".","y","+","vec4","(","_0_0",",","_0_0",",","_1_0",",","_1_0",")",")",";","vec4","HM","=","HF","(","p",")","*","K","+","K2",";","vec4","HN","=","HF","(","floor","(","p","*","K",")",")","*","K","+","K2",";","vec4","HO","=","HK","+","JITTER","*","HM",";","vec4","HP","=","HL","+","JITTER","*","HN",";","vec4","dz","=","HO","*","HO","+","HP","*","HP",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:[1],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["dz",".","xy","=","min","(","dz",".","xy",",","dz",".","zw",")",";","dz",".","x","=","min","(","dz",".","x",",","dz",".","y",")",";","return","dz",".","xx",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["dz",".","xy","=","(","dz",".","x","<","dz",".","y",")","?","dz",".","xy",":","dz",".","yx",";","dz",".","xz","=","(","dz",".","x","<","dz",".","z",")","?","dz",".","xz",":","dz",".","zx",";","dz",".","xw","=","(","dz",".","x","<","dz",".","w",")","?","dz",".","xw",":","dz",".","wx",";","dz",".","y","=","min","(","dz",".","y",",","dz",".","z",")",";","dz",".","y","=","min","(","dz",".","y",",","dz",".","w",")",";","return","sqrt","(","dz",".","xy",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}","vec3","kX","(","vec2","HH",",","float","HQ",")","{","vec2","HI","=","HE","(","floor","(","HH",")",")",";","vec2","HJ","=","fract","(","HH",")",";","vec4","HK","=","HJ",".","x","+","vec4","(","-","0.5",",","-","1.5",",","-","0.5",",","-","1.5",")",";","vec4","HL","=","HJ",".","y","+","vec4","(","-","0.5",",","-","0.5",",","-","1.5",",","-","1.5",")",";","vec4","p","=","HG","(","HI",".","x","+","vec4","(","_0_0",",","_1_0",",","_0_0",",","_1_0",")",")",";","p","=","HG","(","p","+","HI",".","y","+","vec4","(","_0_0",",","_0_0",",","_1_0",",","_1_0",")",")",";","vec4","HM","=","HF","(","p",")","*","K","+","K2",";","vec4","HN","=","HF","(","floor","(","p","*","K",")",")","*","K","+","K2",";","vec4","HO","=","HK","+","JITTER","*","HM",";","vec4","HP","=","HL","+","JITTER","*","HN",";","vec4","HR","=","HO","*","HO","+","HP","*","HP",";","HO","+=","HQ",";","HP","+=","HQ",";","vec4","HS","=","HO","*","HO","+","HP","*","HP",";","HO","+=","HQ",";","HP","+=","HQ",";","vec4","HT","=","HO","*","HO","+","HP","*","HP",";","HR",".","xy","=","min","(","HR",".","xy",",","HR",".","zw",")",";","HR",".","x","=","min","(","HR",".","x",",","HR",".","y",")",";","HS",".","xy","=","min","(","HS",".","xy",",","HS",".","zw",")",";","HS",".","x","=","min","(","HS",".","x",",","HS",".","y",")",";","HT",".","xy","=","min","(","HT",".","xy",",","HT",".","zw",")",";","HT",".","x","=","min","(","HT",".","x",",","HT",".","y",")",";","return","vec3","(","HR",".","x",",","HS",".","x",",","HT",".","x",")",";","}","vec3","HU","(","vec3","x",")","{","return","HE","(","(","(","x","*","34.0",")","+","_1_0",")","*","x",")",";","}","float","fv","(","vec2","kQ",")","{","const","vec4","HV","=","vec4","(","0.211324865405187",",","0.366025403784439",",","-","0.577350269189626",",","0.024390243902439",")",";","vec2","cl","=","floor","(","kQ","+","dot","(","kQ",",","HV",".","yy",")",")",";","vec2","HW","=","kQ","-","cl","+","dot","(","cl",",","HV",".","xx",")",";","vec2","HX",";","HX","=","(","HW",".","x",">","HW",".","y",")","?","vec2","(","_1_0",",","_0_0",")",":","vec2","(","_0_0",",","_1_0",")",";","vec4","HY","=","HW",".","xyxy","+","HV",".","xxzz",";","HY",".","xy","-=","HX",";","cl","=","HE","(","cl",")",";","vec3","p","=","HU","(","HU","(","cl",".","y","+","vec3","(","_0_0",",","HX",".","y",",","_1_0",")",")","+","cl",".","x","+","vec3","(","_0_0",",","HX",".","x",",","_1_0",")",")",";","vec3","aA","=","max","(","0.5","-","vec3","(","dot","(","HW",",","HW",")",",","dot","(","HY",".","xy",",","HY",".","xy",")",",","dot","(","HY",".","zw",",","HY",".","zw",")",")",",","_0_0",")",";","aA","=","aA","*","aA",";","aA","=","aA","*","aA",";","vec3","x","=","2.0","*","fract","(","p","*","HV",".","www",")","-","_1_0",";","vec3","cj","=","abs","(","x",")","-","0.5",";","vec3","HM","=","floor","(","x","+","0.5",")",";","vec3","HZ","=","x","-","HM",";","aA","*=","1.79284291400159","-","0.85373472095314","*","(","HZ","*","HZ","+","cj","*","cj",")",";","vec3","g",";","g",".","x","=","HZ",".","x","*","HW",".","x","+","cj",".","x","*","HW",".","y",";","g",".","yz","=","HZ",".","yz","*","HY",".","xz","+","cj",".","yz","*","HY",".","yw",";","return","130.0","*","dot","(","aA",",","g",")",";","}","vec2","Ib","(","vec2","fW",")","{","float","HR","=","dot","(","fW",",","vec2","(","12.9898",",","78.233",")",")",";","float","HS","=","dot","(","fW",",","vec2","(","12.9898",",","78.233",")","*","2.0",")",";","float","H_","=","fract","(","sin","(","HR",")","*","43758.5453",")","*","2.0","-","_1_0",";","float","Ia","=","fract","(","sin","(","HS",")","*","43758.5453",")","*","2.0","-","_1_0",";","return","vec2","(","H_",",","Ia",")",";","}","float","lg","(","vec2","Ic",")","{","return","fract","(","sin","(","dot","(","Ic",",","vec2","(","12.9898",",","78.233",")",")",")","*","43758.5453",")",";","}"]}]}}]}]},e["include/refraction.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"REFRACTION_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"REFRACTION_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"REFRACTIVE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_REFRACTION_CORRECTION",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_REFRACTION_CORRECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"pack.glslf"}]}}]},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_REFRACTION_CORRECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","eS","(","in","float","cR",",","inout","vec2","eR",",","in","vec2","eI",")","{","vec4","Id","=","GLSL_TEXTURE","(","u_scene_depth",",","eR",")",";","float","eT","=","cQ","(","Id",")",";","if","(","eT","<","m",")","{","eR","=","eI",";","return","cR",";","}","else","{","return","eT",";","}","return","cR",";","}"]}]}}]},{TYPE:"txt",TOKENS:["vec3","cN","(","in","vec3","rq",",","in","vec2","Ie",")","{","vec2","eI","=","rq",".","xy","/","rq",".","z",";","vec2","eR","=","eI","+","Ie",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_REFRACTION_CORRECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","cP","=","GLSL_TEXTURE_PROJ","(","u_scene_depth",",","rq",")",";","float","cR","=","cQ","(","cP",")",";","eS","(","cR",",","eR",",","eI",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","eX","=","GLSL_TEXTURE","(","u_refractmap",",","eR",")",".","rgb",";","bC","(","eX",")",";","return","eX",";","}"]}]}}]}]}}]}]},e["include/scale_texcoord.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SCALE_TEXCOORD_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SCALE_TEXCOORD_GLSLV",TOKENS:[""]},{TYPE:"txt",TOKENS:["vec2","az","(","vec2","b_",",","vec3","If",")","{","return","(","b_","+","0.5",")","*","If",".","xy","-","0.5",";","}"]}]}}]}]},e["include/shadow.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SHADOW_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SHADOW_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"SHADOW_TEX_RES",TOKENS:["2048.0"]},{TYPE:"var",NAME:"CSM_FADE_LAST_CASCADE",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_BLEND_BETWEEN_CASCADES",TOKENS:["0"]},{TYPE:"var",NAME:"RGBA_SHADOWS",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"NUM_CAST_LAMPS",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION1",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION2",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION3",TOKENS:["0"]},{TYPE:"var",NAME:"COMPARED_MODE",TOKENS:["0"]},{TYPE:"var",NAME:"POISSON_DISK_NUM",TOKENS:["NO_SOFT_SHADOWS"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"procedural.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","float","Ig","=","0.1",";","const","float","Ih","=","0.1",";","const","float","Ii","=","-","0.01",";","const","float","Ij","=","0.05",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POISSON_DISK_NUM","POISSON_X_16",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","Ik","=","vec4","(","0.14383161",",","0.34495938",",","-","0.38277543",",","-","0.26496911",")",";","vec4","Il","=","vec4","(","0.53742981",",","0.19984126",",","0.79197514",",","-","0.094184101",")",";","vec4","Im","=","vec4","(","-","0.94201624",",","-","0.91588581",",","-","0.2418884",",","0.44323325",")",";","vec4","In","=","vec4","(","-","0.81544232",",","0.94558609",",","-","0.81409955",",","0.97484398",")",";","vec4","Io","=","vec4","(","-","0.1410079",",","0.2938776",",","0.27676845",",","-","0.41893023",")",";","vec4","Ip","=","vec4","(","-","0.4737342",",","0.78641367",",","0.19090188",",","-","0.9293887",")",";","vec4","Iq","=","vec4","(","-","0.39906216",",","0.45771432",",","0.99706507",",","-","0.97511554",")",";","vec4","Ir","=","vec4","(","-","0.87912464",",","-","0.76890725",",","0.9143759",",","0.7564837",")",";"]}]}},{TYPE:"elif",EXPRESSION:["POISSON_DISK_NUM","POISSON_X_8",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","Ik","=","vec2","(","-","0.37192261",",","0.47109537",")",";","vec2","Il","=","vec2","(","-","0.6807477",",","0.69048062",")",";","vec2","Im","=","vec2","(","0.11615683",",","-","0.91318524",")",";","vec2","In","=","vec2","(","0.93688596",",","-","0.16948928",")",";","vec2","Io","=","vec2","(","-","0.89699117",",","0.74092316",")",";","vec2","Ip","=","vec2","(","0.38263656",",","-","0.66119884",")",";","vec2","Iq","=","vec2","(","-","0.08193062",",","-","0.21275223",")",";","vec2","Ir","=","vec2","(","0.05578877",",","0.84225623",")",";"]}]}},{TYPE:"elif",EXPRESSION:["POISSON_DISK_NUM","POISSON_X_4",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","Ik","=","vec2","(","-","0.51808083",",","0.0",")",";","vec2","Il","=","vec2","(","0.5741194",",","0.0",")",";","vec2","Im","=","vec2","(","-","0.68048857",",","0.0",")",";","vec2","In","=","vec2","(","0.82934988",",","0.0",")",";","vec2","Io","=","vec2","(","0.70009436",",","0.0",")",";","vec2","Ip","=","vec2","(","-","0.78790467",",","0.0",")",";","vec2","Iq","=","vec2","(","-","0.58619489",",","0.0",")",";","vec2","Ir","=","vec2","(","0.41902178",",","0.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["bool","It","(","vec2","iK",",","float","Is",")","{","return","all","(","lessThanEqual","(","iK",",","vec2","(","1.0","+","Is",")",")",")","&&","all","(","greaterThanEqual","(","iK",",","vec2","(","0.0","-","Is",")",")",")",";","}","float","IA","(","float","Iu",",","float","Iv",",","mat2","Iw",",","vec3","Ix",",","float","Iy",",","PRECISION","GLSL_SMPLR2D_SHDW","Iz",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","iK",",","fI",";","fI",".","x","=","Iu",";","fI",".","y","=","Iv",";","fI","=","Iw","*","fI",";","iK","=","Ix",".","xy","+","fI","*","Iy","/","SHADOW_TEX_RES",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","iK","=","Ix",".","xy",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","!","It","(","iK",",","Ii",")",")","return","1.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["RGBA_SHADOWS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","eq","=","cQ","(","GLSL_TEXTURE","(","Iz",",","iK",")",")",";","return","step","(","Ix",".","z",",","eq",")",";"]}]}},{TYPE:"elif",EXPRESSION:["COMPARED_MODE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","GLSL_TEXTURE","(","Iz",",","vec3","(","iK",",","Ix",".","z",")",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","step","(","Ix",".","z",",","GLSL_TEXTURE","(","Iz",",","iK",")",".","r",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}","float","IF","(","vec3","Ix",",","PRECISION","GLSL_SMPLR2D_SHDW","Iz",",","float","Iy",")","{","float","IB","=","0.0",";","Ix",".","z","=","clamp","(","Ix",".","z",",","0.0",",","1.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","IC","=","Ib","(","Ix",".","xy",")",".","x","*","M_PI",";","float","ID","=","cos","(","IC",")",";","float","IE","=","sin","(","IC",")",";","mat2","Iw","=","mat2","(","ID",",","IE",",","-","IE",",","ID",")",";","for","(","int","cl","=","0",";","cl","<","POISSON_DISK_NUM",";","cl","++",")","{","IB","+=","IA","(","Ik","[","cl","]",",","Io","[","cl","]",",","Iw",",","Ix",",","Iy",",","Iz",")",";","IB","+=","IA","(","Il","[","cl","]",",","Ip","[","cl","]",",","Iw",",","Ix",",","Iy",",","Iz",")",";","IB","+=","IA","(","Im","[","cl","]",",","Iq","[","cl","]",",","Iw",",","Ix",",","Iy",",","Iz",")",";","IB","+=","IA","(","In","[","cl","]",",","Ir","[","cl","]",",","Iw",",","Ix",",","Iy",",","Iz",")",";","}","return","clamp","(","IB","/","(","float","(","POISSON_DISK_NUM",")","*","4.0",")",",","0.0",",","1.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","IA","(","0.0",",","0.0",",","mat2","(","0.0",")",",","Ix",",","Iy",",","Iz",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}","float","IO","(","vec3","IG",",","PRECISION","GLSL_SMPLR2D_SHDW","IH",",","vec3","II",",","PRECISION","GLSL_SMPLR2D_SHDW","IJ",",","float","IK",",","float","IL",",","float","aL",")","{","float","IM",",","IN",";","IG",".","z","=","clamp","(","IG",".","z",",","0.0",",","1.0",")",";","II",".","z","=","clamp","(","II",".","z",",","0.0",",","1.0",")",";","IM","=","0.0",";","IN","=","0.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","IC","=","Ib","(","IG",".","xy",")",".","x","*","M_PI",";","float","ID","=","cos","(","IC",")",";","float","IE","=","sin","(","IC",")",";","mat2","Iw","=","mat2","(","ID",",","IE",",","-","IE",",","ID",")",";","for","(","int","cl","=","0",";","cl","<","POISSON_DISK_NUM",";","cl","++",")","{","IM","+=","IA","(","Ik","[","cl","]",",","Io","[","cl","]",",","Iw",",","IG",",","IK",",","IH",")",";","IM","+=","IA","(","Il","[","cl","]",",","Ip","[","cl","]",",","Iw",",","IG",",","IK",",","IH",")",";","IM","+=","IA","(","Im","[","cl","]",",","Iq","[","cl","]",",","Iw",",","IG",",","IK",",","IH",")",";","IM","+=","IA","(","In","[","cl","]",",","Ir","[","cl","]",",","Iw",",","IG",",","IK",",","IH",")",";","}","for","(","int","cl","=","0",";","cl","<","POISSON_DISK_NUM",";","cl","++",")","{","IN","+=","IA","(","Ik","[","cl","]",",","Io","[","cl","]",",","Iw",",","II",",","IL",",","IJ",")",";","IN","+=","IA","(","Il","[","cl","]",",","Ip","[","cl","]",",","Iw",",","II",",","IL",",","IJ",")",";","IN","+=","IA","(","Im","[","cl","]",",","Iq","[","cl","]",",","Iw",",","II",",","IL",",","IJ",")",";","IN","+=","IA","(","In","[","cl","]",",","Ir","[","cl","]",",","Iw",",","II",",","IL",",","IJ",")",";","}","IM","=","mix","(","IM",",","IN",",","aL",")",";","IM","/=","(","float","(","POISSON_DISK_NUM",")","*","4.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["IM","+=","IA","(","0.0",",","0.0",",","mat2","(","0.0",")",",","IG",",","IK",",","IH",")",";","IN","+=","IA","(","0.0",",","0.0",",","mat2","(","0.0",")",",","II",",","IL",",","IJ",")",";","IM","=","mix","(","IM",",","IN",",","aL",")",";"]}]}}]},{TYPE:"txt",TOKENS:["return","clamp","(","IM",",","0.0",",","1.0",")",";","}","float","IP","(","vec2","iK",")","{","float","a","=","min","(","iK",".","x",",","iK",".","y",")",";","float","b","=","min","(","1.0","-","iK",".","x",",","1.0","-","iK",".","y",")",";","return","min","(","a",",","b",")",";","}","float","IR","(","float","uO",",","float","IQ",")","{","if","(","IQ",">=","0.0","&&","IQ","<=","Ih",")","uO","=","(","uO","-","1.0",")","/","Ih","*","IQ","+","1.0",";","return","uO",";","}","float","IW","(","vec3","IS",",","vec3","IT",",","PRECISION","GLSL_SMPLR2D_SHDW","IH",",","PRECISION","GLSL_SMPLR2D_SHDW","IJ",",","float","IK",",","float","IL",",","float","IU",",","float","eq",")","{","float","uO",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_BLEND_BETWEEN_CASCADES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","IQ","=","IP","(","IS",".","xy",")",";","if","(","-","eq",">","IU","&&","IQ",">=","0.0","&&","IQ","<=","Ig","&&","It","(","IT",".","xy",",","0.0",")",")","{","float","IV","=","1.0","-","IQ","/","Ig",";","uO","=","IO","(","IS",",","IH",",","IT",",","IJ",",","IK",",","IL",",","IV",")",";","}","else"]}]}}]},{TYPE:"txt",TOKENS:["uO","=","IF","(","IS",",","IH",",","IK",")",";","return","uO",";","}","float","IY","(","vec3","IX",",","PRECISION","GLSL_SMPLR2D_SHDW","Iz",",","float","Iy",",","float","IU",",","float","eq",")","{","float","uO","=","IF","(","IX",",","Iz",",","Iy",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_FADE_LAST_CASCADE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","-","eq",">","IU",")","{","float","IQ","=","IP","(","IX",".","xy",")",";","uO","=","IR","(","uO",",","IQ",")",";","}"]}]}}]},{TYPE:"txt",TOKENS:["return","uO",";","}","vec4","es","(","float","eq",")","{","float","uO","=","1.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","IZ","=","u_pcf_blur_radii",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","IZ","=","vec4","(","0.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","IG","=","n",".","xyz","/","n",".","w",";","if","(","n",".","w","<","0.0",")","IG",".","z","=","0.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","II","=","o",".","xyz","/","o",".","w",";","if","(","o",".","w","<","0.0",")","II",".","z","=","0.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","I_","=","u",".","xyz","/","u",".","w",";","if","(","u",".","w","<","0.0",")","I_",".","z","=","0.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","Ja","=","v",".","xyz","/","v",".","w",";","if","(","v",".","w","<","0.0",")","Ja",".","z","=","0.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","It","(","IG",".","xy",",","0.0",")",")","{","uO","=","IW","(","IG",",","II",",","u_shadow_map0",",","u_shadow_map1",",","IZ","[","0","]",",","IZ","[","1","]",",","u_csm_center_dists","[","0","]",",","eq",")",";","}"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","It","(","IG",".","xy",",","Ij",")",")","{","uO","=","IY","(","IG",",","u_shadow_map0",",","IZ","[","0","]",",","u_csm_center_dists","[","0","]",",","eq",")",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["else","{","if","(","It","(","II",".","xy",",","0.0",")",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uO","=","IW","(","II",",","I_",",","u_shadow_map1",",","u_shadow_map2",",","IZ","[","1","]",",","IZ","[","2","]",",","u_csm_center_dists","[","1","]",",","eq",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uO","=","IY","(","II",",","u_shadow_map1",",","IZ","[","1","]",",","u_csm_center_dists","[","1","]",",","eq",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["else","{","if","(","It","(","I_",".","xy",",","0.0",")",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uO","=","IW","(","I_",",","Ja",",","u_shadow_map2",",","u_shadow_map3",",","IZ","[","2","]",",","IZ","[","3","]",",","u_csm_center_dists","[","2","]",",","eq",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uO","=","IY","(","I_",",","u_shadow_map2",",","IZ","[","2","]",",","u_csm_center_dists","[","2","]",",","eq",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["else","{","if","(","It","(","Ja",".","xy",",","0.0",")",")","uO","=","IY","(","Ja",",","u_shadow_map3",",","IZ","[","3","]",",","u_csm_center_dists","[","3","]",",","eq",")",";","}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","Jb","=","IF","(","II",",","u_shadow_map1",",","IZ","[","0","]",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","Jb","=","0.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","Jc","=","IF","(","I_",",","u_shadow_map2",",","IZ","[","0","]",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","Jc","=","0.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","Jd","=","IF","(","Ja",",","u_shadow_map3",",","IZ","[","0","]",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","Jd","=","1.0",";"]}]}}]},{TYPE:"txt",TOKENS:["return","vec4","(","uO",",","Jb",",","Jc",",","Jd",")",";","}"]}]}}]},{TYPE:"txt",TOKENS:["vec4","cC","(","inout","vec3","cy",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","IB","=","GLSL_TEXTURE","(","u_shadow_mask",",","l",".","xy","/","l",".","z",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_CAST_LAMPS",3,{TYPE:"l_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cy","*=","IB",".","a",";"]}]}}]},{TYPE:"txt",TOKENS:["return","IB",";"]}]}},{TYPE:"elif",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","IB","=","es","(","i",".","z",")",";","return","IB",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","vec4","(","1.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]}]},e["include/shadow.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SHADOW_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SHADOW_GLSLV",TOKENS:[""]},{TYPE:"var",NAME:"MAC_OS_SHADOW_HACK",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_TEX_RES",TOKENS:["2048.0"]},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"NUM_CAST_LAMPS",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION1",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION2",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION3",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"math.glslv"},{TYPE:"txt",TOKENS:["vec4","Jh","(","mat4","Je",",","vec4","Jf",",","mat4","Jg",")","{","vec2","eu","=","(","Je","*","Jg","[","3","]",")",".","xy",";","float","ev","=","SHADOW_TEX_RES","/","2.0",";","eu","=","floor","(","eu","*","ev","+","0.5",")","/","ev","-","eu",";","vec4","Ix","=","Je","*","Jf",";","Ix",".","xy","+=","eu",";","Ix",".","xyz","=","0.5","*","(","Ix",".","xyz","+","Ix",".","w",")",";","return","Ix",";","}","void","bZ","(","vec3","fn",",","vec3","Ji",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAC_OS_SHADOW_HACK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat4","Jg","=","bc","(","u_v_light_tsr","[","0","]",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat4","Jg","=","bc","(","mat3","(","u_v_light_ts","[","0","]",",","u_v_light_r","[","0","]",",","0.0",")",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec4","Jj","=","Jg","*","vec4","(","fn","+","u_normal_offset","*","Ji",",","1.0",")",";","n","=","Jh","(","u_p_light_matrix0",",","Jj",",","Jg",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAC_OS_SHADOW_HACK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["Jg","=","bc","(","u_v_light_tsr","[","1","]",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["Jg","=","bc","(","mat3","(","u_v_light_ts","[","1","]",",","u_v_light_r","[","1","]",",","0.0",")",")",";"]}]}}]},{TYPE:"txt",TOKENS:["Jj","=","Jg","*","vec4","(","fn","+","u_normal_offset","*","Ji",",","1.0",")",";","o","=","Jh","(","u_p_light_matrix1",",","Jj",",","Jg",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAC_OS_SHADOW_HACK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["Jg","=","bc","(","u_v_light_tsr","[","2","]",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["Jg","=","bc","(","mat3","(","u_v_light_ts","[","2","]",",","u_v_light_r","[","2","]",",","0.0",")",")",";"]}]}}]},{TYPE:"txt",TOKENS:["Jj","=","Jg","*","vec4","(","fn","+","u_normal_offset","*","Ji",",","1.0",")",";","u","=","Jh","(","u_p_light_matrix2",",","Jj",",","Jg",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAC_OS_SHADOW_HACK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["Jg","=","bc","(","u_v_light_tsr","[","3","]",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["Jg","=","bc","(","mat3","(","u_v_light_ts","[","3","]",",","u_v_light_r","[","3","]",",","0.0",")",")",";"]}]}}]},{TYPE:"txt",TOKENS:["Jj","=","Jg","*","vec4","(","fn","+","u_normal_offset","*","Ji",",","1.0",")",";","v","=","Jh","(","u_p_light_matrix3",",","Jj",",","Jg",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["o","=","Jh","(","u_p_light_matrix1",",","Jj",",","Jg",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["u","=","Jh","(","u_p_light_matrix2",",","Jj",",","Jg",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["v","=","Jh","(","u_p_light_matrix3",",","Jj",",","Jg",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]}]}}]}]},e["include/skin.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SKIN_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SKIN_GLSLV",TOKENS:[""]},{TYPE:"var",NAME:"DISABLE_TANGENT_SKINNING",TOKENS:["0"]},{TYPE:"var",NAME:"SKINNED",TOKENS:["0"]},{TYPE:"var",NAME:"FRAMES_BLENDING",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"math.glslv"},{TYPE:"define",NAME:"SKIN_SLERP",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKIN_SLERP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","Jr","(","in","vec4","qV",",","in","vec4","Jk",",","in","float","Jl",")","{","float","Jm","=","qV","[","0","]","*","Jk","[","0","]","+","qV","[","1","]","*","Jk","[","1","]","+","qV","[","2","]","*","Jk","[","2","]","+","qV","[","3","]","*","Jk","[","3","]",";","if","(","Jm","<","0.0",")","{","Jk","*=","-","1.0",";","Jm","=","-","Jm",";","}","if","(","abs","(","Jm",")",">=","1.0",")","return","qV",";","float","Jn","=","acos","(","Jm",")",";","float","Jo","=","sqrt","(","1.0","-","Jm","*","Jm",")",";","if","(","abs","(","Jo",")","<","0.001",")","return","vec4","(","qV","*","0.5","+","Jk","*","0.5",")",";","float","Jp","=","sin","(","(","1.0","-","Jl",")","*","Jn",")","/","Jo",";","float","Jq","=","sin","(","Jl","*","Jn",")","/","Jo",";","return","qV","*","Jp","+","Jk","*","Jq",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FRAMES_BLENDING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","JF","(","in","vec3","O",",","in","vec4","Js",",","in","vec4","Jt",",","in","vec4","Ju",",","in","vec4","Jv",",","in","float","Jw",")","{","vec3","Jx","=","rh","(","u_arm_rel_trans",",","u_arm_rel_quat",",","O",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKIN_SLERP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","qV","=","Jr","(","Js",",","Jt",",","Jw",")",";","vec4","Jy","=","mix","(","Ju",",","Jv",",","Jw",")",";","vec3","Jz","=","T","(","qV",",","Jx",")",";","vec3","JA","=","Jz","*","Jy",".","w","+","Jy",".","xyz",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","JB","=","T","(","Js",",","Jx",")",";","vec3","JC","=","T","(","Jt",",","Jx",")",";","vec3","JD","=","JB","*","Ju",".","w","+","Ju",".","xyz",";","vec3","JE","=","JC","*","Jv",".","w","+","Jv",".","xyz",";","vec3","JA","=","mix","(","JD",",","JE",",","Jw",")",";"]}]}}]},{TYPE:"txt",TOKENS:["return","rk","(","u_arm_rel_trans",",","u_arm_rel_quat",",","JA",")",";","}","vec3","JL","(","in","vec3","JG",",","in","vec4","Js",",","in","vec4","Jt",",","in","float","Jw",")","{","vec3","JH","=","rj","(","u_arm_rel_trans",",","u_arm_rel_quat",",","JG",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKIN_SLERP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","qV","=","Jr","(","Js",",","Jt",",","Jw",")",";","vec3","JI","=","T","(","qV",",","JH",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","JJ","=","T","(","Js",",","JH",")",";","vec3","JK","=","T","(","Jt",",","JH",")",";","vec3","JI","=","mix","(","JJ",",","JK",",","Jw",")",";"]}]}}]},{TYPE:"txt",TOKENS:["return","rl","(","u_arm_rel_trans",",","u_arm_rel_quat",",","JI",")",";","}"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","JF","(","in","vec3","O",",","in","vec4","Js",",","in","vec4","Ju",")","{","vec3","Jx","=","rh","(","u_arm_rel_trans",",","u_arm_rel_quat",",","O",")",";","vec3","Jz","=","T","(","Js",",","Jx",")",";","vec3","JA","=","Jz","*","Ju",".","w","+","Ju",".","xyz",";","return","rk","(","u_arm_rel_trans",",","u_arm_rel_quat",",","JA",")",";","}","vec3","JL","(","in","vec3","JG",",","in","vec4","Js",")","{","vec3","JH","=","rj","(","u_arm_rel_trans",",","u_arm_rel_quat",",","JG",")",";","vec3","JI","=","T","(","Js",",","JH",")",";","return","rl","(","u_arm_rel_trans",",","u_arm_rel_quat",",","JI",")",";","}"]}]}}]},{TYPE:"txt",TOKENS:["void","an","(","inout","vec3","O",",","inout","vec3","V",",","inout","vec3","W",",","inout","vec3","U",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FRAMES_BLENDING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","JM","=","u_frame_factor",";"]}]}}]},{TYPE:"txt",TOKENS:["if","(","a_influence",".","y",">","0.0",")","{","vec3","jD","=","vec3","(","0.0",",","0.0",",","0.0",")",";","vec3","JN","=","vec3","(","0.0",",","0.0",",","0.0",")",";","vec3","JO","=","vec3","(","0.0",",","0.0",",","0.0",")",";","vec3","JP","=","vec3","(","0.0",",","0.0",",","0.0",")",";","vec4","JQ","=","a_influence",";","for","(","int","cl","=","0",";","cl","<","4",";","cl","++",")","{","int","JR","=","int","(","JQ","[","cl","]",")",";","float","JS","=","fract","(","JQ","[","cl","]",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FRAMES_BLENDING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["JN","+=","JS","*","JL","(","V",",","u_quatsb","[","JR","]",",","u_quatsa","[","JR","]",",","JM",")",";","JO","+=","JS","*","JL","(","W",",","u_quatsb","[","JR","]",",","u_quatsa","[","JR","]",",","JM",")",";","JP","+=","JS","*","JL","(","U",",","u_quatsb","[","JR","]",",","u_quatsa","[","JR","]",",","JM",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["jD","+=","JS","*","JF","(","O",",","u_quatsb","[","JR","]",",","u_transb","[","JR","]",")",";","JP","+=","JS","*","JL","(","U",",","u_quatsb","[","JR","]",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_TANGENT_SKINNING",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["JN","+=","JS","*","JL","(","V",",","u_quatsb","[","JR","]",")",";","JO","+=","JS","*","JL","(","W",",","u_quatsb","[","JR","]",")",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FRAMES_BLENDING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["int","JR","=","int","(","JQ","[","0","]",")",";","float","JS","=","fract","(","JQ","[","0","]",")",";","jD","+=","JS","*","JF","(","O",",","u_quatsb","[","JR","]",",","u_quatsa","[","JR","]",",","u_transb","[","JR","]",",","u_transa","[","JR","]",",","JM",")",";","JR","=","int","(","JQ","[","1","]",")",";","JS","=","fract","(","JQ","[","1","]",")",";","jD","+=","JS","*","JF","(","O",",","u_quatsb","[","JR","]",",","u_quatsa","[","JR","]",",","u_transb","[","JR","]",",","u_transa","[","JR","]",",","JM",")",";","JR","=","int","(","JQ","[","2","]",")",";","JS","=","fract","(","JQ","[","2","]",")",";","jD","+=","JS","*","JF","(","O",",","u_quatsb","[","JR","]",",","u_quatsa","[","JR","]",",","u_transb","[","JR","]",",","u_transa","[","JR","]",",","JM",")",";","JR","=","int","(","JQ","[","3","]",")",";","JS","=","fract","(","JQ","[","3","]",")",";","jD","+=","JS","*","JF","(","O",",","u_quatsb","[","JR","]",",","u_quatsa","[","JR","]",",","u_transb","[","JR","]",",","u_transa","[","JR","]",",","JM",")",";"]}]}}]},{TYPE:"txt",TOKENS:["O","=","jD",";","U","=","JP",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_TANGENT_SKINNING",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["V","=","JN",";","W","=","JO",";"]}]}}]},{TYPE:"txt",TOKENS:["}","if","(","!","(","a_influence",".","y",">","0.0",")",")","{","int","JT","=","int","(","a_influence","[","0","]","-","1.0",")",";","if","(","JT",">","-","1",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FRAMES_BLENDING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["O","=","JF","(","O",",","u_quatsb","[","JT","]",",","u_quatsa","[","JT","]",",","u_transb","[","JT","]",",","u_transa","[","JT","]",",","JM",")",";","V","=","JL","(","V",",","u_quatsb","[","JT","]",",","u_quatsa","[","JT","]",",","JM",")",";","W","=","JL","(","W",",","u_quatsb","[","JT","]",",","u_quatsa","[","JT","]",",","JM",")",";","U","=","JL","(","U",",","u_quatsb","[","JT","]",",","u_quatsa","[","JT","]",",","JM",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["O","=","JF","(","O",",","u_quatsb","[","JT","]",",","u_transb","[","JT","]",")",";","U","=","JL","(","U",",","u_quatsb","[","JT","]",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_TANGENT_SKINNING",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["V","=","JL","(","V",",","u_quatsb","[","JT","]",")",";","W","=","JL","(","W",",","u_quatsb","[","JT","]",")",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["}","}","}"]}]}}]}]}}]}]},e["include/sky_blending.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SKY_BLENDING_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SKY_BLENDING_GLSLF",TOKENS:[""]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"blending.glslf"},{TYPE:"var",NAME:"WO_SKYREAL",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYBLEND",TOKENS:["0"]},{TYPE:"var",NAME:"BLENDTYPE",TOKENS:["MIX"]},{TYPE:"var",NAME:"MTEX_RGBTOINT",TOKENS:["0"]},{TYPE:"var",NAME:"WOMAP_HORIZ",TOKENS:["0"]},{TYPE:"var",NAME:"WOMAP_ZENUP",TOKENS:["0"]},{TYPE:"var",NAME:"WOMAP_ZENDOWN",TOKENS:["0"]},{TYPE:"var",NAME:"WOMAP_BLEND",TOKENS:["0"]},{TYPE:"var",NAME:"MTEX_NEGATIVE",TOKENS:["0"]},{TYPE:"txt",TOKENS:["vec3","JU","(","vec3","ki",",","vec3","kj",",","float","aL",",","float","kI",")","{","float","kk","=","aL","*","kI",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLENDTYPE","MIX",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kl","(","kj",",","ki",",","kk",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","ADD",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","km","(","ki",",","kj",",","kk",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","SUBTRACT",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kn","(","ki",",","kj",",","kk",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","MULTIPLY",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kp","(","ki",",","kj",",","kk",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","SCREEN",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kq","(","ki",",","kj",",","kk",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","OVERLAY",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kr","(","ki",",","kj",",","kk",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","DIFFERENCE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","ks","(","ki",",","kj",",","kk",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","DIVIDE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kt","(","ki",",","kj",",","kk",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","DARKEN",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","ku","(","ki",",","kj",",","kk",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","LIGHTEN",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kv","(","ki",",","kj",",","kk",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","HUE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kz","(","kj",",","ki",",","kk",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","SATURATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kA","(","kj",",","ki",",","kk",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","VALUE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kB","(","kj",",","ki",",","kk",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","COLOR",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kC","(","kj",",","ki",",","kk",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","SOFT_LIGHT",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kE","(","kj",",","ki",",","kk",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","LINEAR_LIGHT",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kF","(","kj",",","ki",",","kk",")",";"]}]}}]},{TYPE:"txt",TOKENS:["return","vec3","(","1.0",",","0.0",",","1.0",")",";","}","float","JV","(","float","kG",",","float","kH",",","float","aL",",","float","kI",")","{","vec3","ki","=","vec3","(","kG",")",",","kj","=","vec3","(","kH",")",";","float","kk","=","aL","*","kI",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLENDTYPE","MIX",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kl","(","kj",",","ki",",","kk",")",".","x",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","ADD",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","km","(","ki",",","kj",",","kk",")",".","x",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","SUBTRACT",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kn","(","ki",",","kj",",","kk",")",".","x",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","MULTIPLY",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kJ","(","kG",",","kH",",","kk",",","kI",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","SCREEN",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kK","(","kG",",","kH",",","kk",",","kI",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","OVERLAY",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kL","(","kG",",","kH",",","kk",",","kI",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","DIFFERENCE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","ks","(","ki",",","kj",",","kk",")",".","x",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","DIVIDE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kt","(","ki",",","kj",",","kk",")",".","x",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","DARKEN",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","ku","(","ki",",","kj",",","kk",")",".","x",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","LIGHTEN",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kv","(","ki",",","kj",",","kk",")",".","x",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","SOFT_LIGHT",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kE","(","kj",",","ki",",","kk",")",".","x",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","LINEAR_LIGHT",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kF","(","kj",",","ki",",","kk",")",".","x",";"]}]}}]},{TYPE:"txt",TOKENS:["return","0.0",";","}","vec3","eB","(","vec3","ex",",","vec3","ey",",","vec4","eA",",","float","ew",",","vec3","ez",")","{","float","JW","=","1.0",";","JW","=","eA",".","a",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MTEX_RGBTOINT"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["JW","=","ge","(","eA",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MTEX_NEGATIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MTEX_RGBTOINT",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eA","=","vec4","(","vec3","(","1.0",")","-","eA",".","rgb",",","eA",".","a",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["JW","=","1.0","-","JW",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WOMAP_HORIZ","WOMAP_ZENUP","WOMAP_ZENDOWN",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MTEX_RGBTOINT"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eA","=","vec4","(","u_sky_tex_color",",","1.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["JW","=","eA",".","a",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WOMAP_HORIZ"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["ex","=","JU","(","eA",".","rgb",",","ex",",","JW",",","u_sky_tex_fac","[","1","]",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WOMAP_ZENUP","WOMAP_ZENDOWN",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","JX","=","0.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYREAL"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","dot","(","ez",",","vec3","(","0.0",",","0.0",",","1.0",")",")",">=","0.0",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WOMAP_ZENUP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["JX","=","u_sky_tex_fac","[","2","]",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:[";"]}]}}]},{TYPE:"txt",TOKENS:["}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WOMAP_ZENDOWN"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["else","JX","=","u_sky_tex_fac","[","3","]",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WOMAP_ZENUP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["JX","=","u_sky_tex_fac","[","2","]",";"]}]}},{TYPE:"elif",EXPRESSION:["WOMAP_ZENDOWN"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["JX","=","u_sky_tex_fac","[","3","]",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["if","(","JX","!=","0.0",")","ey","=","JU","(","eA",".","rgb",",","ey",",","JW",",","JX",")",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WOMAP_BLEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MTEX_RGBTOINT",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["JW","=","dot","(","eA",".","rgb",",","vec3","(","0.2126",",","0.7152",",","0.0722",")",")",";"]}]}}]},{TYPE:"txt",TOKENS:["ew","=","JV","(","u_sky_tex_dvar",",","ew",",","JW",",","u_sky_tex_fac","[","0","]",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYBLEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","bs","=","mix","(","ex",",","ey",",","ew",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","bs","=","ex",";"]}]}}]},{TYPE:"txt",TOKENS:["return","bs",";","}"]}]}}]}]},e["include/std.glsl"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"STD_ENUMS_GLSL",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"STD_ENUMS_GLSL",TOKENS:[""]},{TYPE:"var",NAME:"CONSTANTS_HACK",TOKENS:["0"]},{TYPE:"define",NAME:"TEXTURE_COORDS_NONE",TOKENS:["0"]},{TYPE:"define",NAME:"TEXTURE_COORDS_UV_ORCO",TOKENS:["1"]},{TYPE:"define",NAME:"TEXTURE_COORDS_NORMAL",TOKENS:["2"]},{TYPE:"define",NAME:"TEXTURE_BLEND_TYPE_MIX",TOKENS:["1"]},{TYPE:"define",NAME:"TEXTURE_BLEND_TYPE_MULTIPLY",TOKENS:["2"]},{TYPE:"define",NAME:"SHADOW_SRC_NONE",TOKENS:["1"]},{TYPE:"define",NAME:"SHADOW_SRC_DEPTH",TOKENS:["2"]},{TYPE:"define",NAME:"SHADOW_SRC_MASK",TOKENS:["3"]},{TYPE:"define",NAME:"SHADOW_DST_NONE",TOKENS:["1"]},{TYPE:"define",NAME:"SHADOW_DST_DEPTH",TOKENS:["2"]},{TYPE:"define",NAME:"SHADOW_DST_MASK",TOKENS:["3"]},{TYPE:"define",NAME:"NO_SHADOWS",TOKENS:["1"]},{TYPE:"define",NAME:"SHADOW_CASTING",TOKENS:["2"]},{TYPE:"define",NAME:"SHADOW_MASK_GENERATION",TOKENS:["3"]},{TYPE:"define",NAME:"SHADOW_MAPPING_OPAQUE",TOKENS:["4"]},{TYPE:"define",NAME:"SHADOW_MAPPING_BLEND",TOKENS:["5"]},{TYPE:"define",NAME:"POISSON_X_16",TOKENS:["4"]},{TYPE:"define",NAME:"POISSON_X_8",TOKENS:["2"]},{TYPE:"define",NAME:"POISSON_X_4",TOKENS:["1"]},{TYPE:"define",NAME:"NO_SOFT_SHADOWS",TOKENS:["0"]},{TYPE:"define",NAME:"SPECULAR_PHONG",TOKENS:["1"]},{TYPE:"define",NAME:"SPECULAR_COOKTORR",TOKENS:["2"]},{TYPE:"define",NAME:"SPECULAR_WARDISO",TOKENS:["3"]},{TYPE:"define",NAME:"SPECULAR_BLINN",TOKENS:["4"]},{TYPE:"define",NAME:"SPECULAR_TOON",TOKENS:["5"]},{TYPE:"define",NAME:"DIFFUSE_LAMBERT",TOKENS:["1"]},{TYPE:"define",NAME:"DIFFUSE_OREN_NAYAR",TOKENS:["2"]},{TYPE:"define",NAME:"DIFFUSE_FRESNEL",TOKENS:["3"]},{TYPE:"define",NAME:"DIFFUSE_MINNAERT",TOKENS:["4"]},{TYPE:"define",NAME:"DIFFUSE_TOON",TOKENS:["5"]},{TYPE:"define",NAME:"MIX",TOKENS:["0"]},{TYPE:"define",NAME:"ADD",TOKENS:["1"]},{TYPE:"define",NAME:"SUBTRACT",TOKENS:["2"]},{TYPE:"define",NAME:"MULTIPLY",TOKENS:["3"]},{TYPE:"define",NAME:"SCREEN",TOKENS:["4"]},{TYPE:"define",NAME:"OVERLAY",TOKENS:["5"]},{TYPE:"define",NAME:"DIFFERENCE",TOKENS:["6"]},{TYPE:"define",NAME:"DIVIDE",TOKENS:["7"]},{TYPE:"define",NAME:"DARKEN",TOKENS:["8"]},{TYPE:"define",NAME:"LIGHTEN",TOKENS:["9"]},{TYPE:"define",NAME:"HUE",TOKENS:["10"]},{TYPE:"define",NAME:"SATURATION",TOKENS:["11"]},{TYPE:"define",NAME:"VALUE",TOKENS:["12"]},{TYPE:"define",NAME:"COLOR",TOKENS:["13"]},{TYPE:"define",NAME:"SOFT_LIGHT",TOKENS:["14"]},{TYPE:"define",NAME:"LINEAR_LIGHT",TOKENS:["15"]},{TYPE:"define",NAME:"REFL_NONE",TOKENS:["0"]},{TYPE:"define",NAME:"REFL_MIRRORMAP",TOKENS:["1"]},{TYPE:"define",NAME:"REFL_PLANE",TOKENS:["2"]},{TYPE:"define",NAME:"REFL_CUBE",TOKENS:["3"]},{TYPE:"define",NAME:"REFL_PBR_SIMPLE",TOKENS:["4"]},{TYPE:"define",NAME:"REFL_PBR_STANDARD",TOKENS:["5"]},{TYPE:"define",NAME:"INVERSE_QUADRATIC",TOKENS:["0"]},{TYPE:"define",NAME:"LINEAR",TOKENS:["1"]},{TYPE:"define",NAME:"QUADRATIC",TOKENS:["2"]},{TYPE:"define",NAME:"HEMI",TOKENS:["1"]},{TYPE:"define",NAME:"SPOT",TOKENS:["2"]},{TYPE:"define",NAME:"POINT",TOKENS:["3"]},{TYPE:"define",NAME:"SUN",TOKENS:["4"]},{TYPE:"define",NAME:"DOF_SIMPLE",TOKENS:["0"]},{TYPE:"define",NAME:"DOF_BOKEH",TOKENS:["1"]},{TYPE:"define",NAME:"COC_ALL",TOKENS:["0"]},{TYPE:"define",NAME:"COC_FOREGROUND",TOKENS:["1"]},{TYPE:"define",NAME:"COC_COMBINE",TOKENS:["2"]},{TYPE:"define",NAME:"VT_WORLD_TO_WORLD",TOKENS:["0"]},{TYPE:"define",NAME:"VT_WORLD_TO_OBJECT",TOKENS:["1"]},{TYPE:"define",NAME:"VT_WORLD_TO_CAMERA",TOKENS:["2"]},{TYPE:"define",NAME:"VT_OBJECT_TO_WORLD",TOKENS:["3"]},{TYPE:"define",NAME:"VT_OBJECT_TO_OBJECT",TOKENS:["4"]},{TYPE:"define",NAME:"VT_OBJECT_TO_CAMERA",TOKENS:["5"]},{TYPE:"define",NAME:"VT_CAMERA_TO_WORLD",TOKENS:["6"]},{TYPE:"define",NAME:"VT_CAMERA_TO_OBJECT",TOKENS:["7"]},{TYPE:"define",NAME:"VT_CAMERA_TO_CAMERA",TOKENS:["8"]},{TYPE:"define",NAME:"VT_POINT",TOKENS:["0"]},{TYPE:"define",NAME:"VT_VECTOR",TOKENS:["1"]},{TYPE:"define",NAME:"VT_NORMAL",TOKENS:["2"]},{TYPE:"define",NAME:"NM_TANGENT",TOKENS:["0"]},{TYPE:"define",NAME:"NM_OBJECT",TOKENS:["1"]},{TYPE:"define",NAME:"NM_WORLD",TOKENS:["2"]},{TYPE:"define",NAME:"NM_BLENDER_OBJECT",TOKENS:["3"]},{TYPE:"define",NAME:"NM_BLENDER_WORLD",TOKENS:["4"]},{TYPE:"define",NAME:"BILLBOARD_ALIGN_VIEW",TOKENS:["1"]},{TYPE:"define",NAME:"BILLBOARD_ALIGN_XY",TOKENS:["2"]},{TYPE:"define",NAME:"BILLBOARD_ALIGN_YZ",TOKENS:["3"]},{TYPE:"define",NAME:"BILLBOARD_ALIGN_ZX",TOKENS:["4"]},{TYPE:"define",NAME:"POST_EFFECT_NONE",TOKENS:["1"]},{TYPE:"define",NAME:"POST_EFFECT_GRAYSCALE",TOKENS:["2"]},{TYPE:"define",NAME:"POST_EFFECT_BLUR",TOKENS:["3"]},{TYPE:"define",NAME:"POST_EFFECT_GLOW_BLUR",TOKENS:["4"]},{TYPE:"define",NAME:"POST_EFFECT_DOF_BLUR",TOKENS:["5"]},{TYPE:"define",NAME:"POST_EFFECT_ALPHA_BLUR",TOKENS:["6"]},{TYPE:"define",NAME:"POST_EFFECT_EXTEND",TOKENS:["7"]},{TYPE:"define",NAME:"FLIP_CUBEMAP_COORDS",TOKENS:["8"]},{TYPE:"define",NAME:"BLUR_PASS_1",TOKENS:["1"]},{TYPE:"define",NAME:"BLUR_PASS_2",TOKENS:["2"]},{TYPE:"define",NAME:"BLUR_PASS_3",TOKENS:["3"]},{TYPE:"define",NAME:"BLUR_PASS_4",TOKENS:["4"]},{TYPE:"define",NAME:"BLUR_PASS_5",TOKENS:["5"]},{TYPE:"define",NAME:"DV_NONE",TOKENS:["0"]},{TYPE:"define",NAME:"DV_OPAQUE_WIREFRAME",TOKENS:["1"]},{TYPE:"define",NAME:"DV_TRANSPARENT_WIREFRAME",TOKENS:["2"]},{TYPE:"define",NAME:"DV_FRONT_BACK_VIEW",TOKENS:["3"]},{TYPE:"define",NAME:"DV_BOUNDINGS",TOKENS:["4"]},{TYPE:"define",NAME:"DV_CLUSTERS_VIEW",TOKENS:["5"]},{TYPE:"define",NAME:"DV_BATCHES_VIEW",TOKENS:["6"]},{TYPE:"define",NAME:"DV_RENDER_TIME",TOKENS:["7"]},{TYPE:"define",NAME:"SSAO_QUALITY_8",TOKENS:["1"]},{TYPE:"define",NAME:"SSAO_QUALITY_16",TOKENS:["2"]},{TYPE:"define",NAME:"SSAO_QUALITY_24",TOKENS:["3"]},{TYPE:"define",NAME:"SSAO_QUALITY_32",TOKENS:["4"]},{TYPE:"define",NAME:"AA_METHOD_FXAA_LIGHT",TOKENS:["1"]},{TYPE:"define",NAME:"AA_METHOD_FXAA_QUALITY",TOKENS:["2"]},{TYPE:"define",NAME:"AA_QUALITY_LOW",TOKENS:["0"]},{TYPE:"define",NAME:"AA_QUALITY_MEDIUM",TOKENS:["1"]},{TYPE:"define",NAME:"AA_QUALITY_HIGH",TOKENS:["2"]},{TYPE:"define",NAME:"SMAA_RESOLVE",TOKENS:["25"]},{TYPE:"define",NAME:"SMAA_EDGE_DETECTION",TOKENS:["24"]},{TYPE:"define",NAME:"SMAA_BLENDING_WEIGHT_CALCULATION",TOKENS:["23"]},{TYPE:"define",NAME:"SMAA_NEIGHBORHOOD_BLENDING",TOKENS:["26"]},{TYPE:"define",NAME:"AA_METHOD_SMAA_LOW",TOKENS:["1"]},{TYPE:"define",NAME:"AA_METHOD_SMAA_MEDIUM",TOKENS:["2"]},{TYPE:"define",NAME:"AA_METHOD_SMAA_HIGH",TOKENS:["3"]},{TYPE:"define",NAME:"AA_METHOD_SMAA_ULTRA",TOKENS:["4"]},{TYPE:"define",NAME:"REFL_PASS_NONE",TOKENS:["0"]},{TYPE:"define",NAME:"REFL_PASS_PLANE",TOKENS:["1"]},{TYPE:"define",NAME:"REFL_PASS_CUBE",TOKENS:["2"]},{TYPE:"define",NAME:"SRGB_NONE",TOKENS:["0"]},{TYPE:"define",NAME:"SRGB_SIMPLE",TOKENS:["1"]},{TYPE:"define",NAME:"SRGB_PROPER",TOKENS:["2"]},{TYPE:"define",NAME:"CAM_TYPE_ORTHO",TOKENS:["0"]},{TYPE:"define",NAME:"CAM_TYPE_PERSP",TOKENS:["1"]},{TYPE:"define",NAME:"M_PI",TOKENS:["3.14159265359"]},{TYPE:"define",NAME:"M_PI_4",TOKENS:["0.785398163"]},{TYPE:"define",NAME:"INV_PI",TOKENS:["0.318309886"]},{TYPE:"define",NAME:"UP_VECTOR",TOKENS:["vec3","(","0.0",",","0.0",",","1.0",")"]},{TYPE:"define",NAME:"RIGHT_VECTOR",TOKENS:["vec3","(","1.0",",","0.0",",","0.0",")"]},{TYPE:"define",NAME:"TOWARD_VECTOR",TOKENS:["vec3","(","0.0",",","-","1.0",",","0.0",")"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CONSTANTS_HACK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","_0_0","=","0.0",";","float","_0_5","=","0.5",";","float","_1_0","=","1.0",";","float","_255_0","=","255.0",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"_0_0",TOKENS:["0.0"]},{TYPE:"define",NAME:"_0_5",TOKENS:["0.5"]},{TYPE:"define",NAME:"_1_0",TOKENS:["1.0"]},{TYPE:"define",NAME:"_255_0",TOKENS:["255.0"]}]}}]}]}}]}]},e["include/to_world.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"TO_WORLD_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"TO_WORLD_GLSLV",TOKENS:[""]},{TYPE:"include",FILE:"math.glslv"},{TYPE:"var",NAME:"BILLBOARD_ALIGN",TOKENS:["BILLBOARD_ALIGN_VIEW"]},{TYPE:"var",NAME:"BILLBOARD_SPHERICAL",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD_RANDOM",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD_JITTERED",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD_PRES_GLOB_ORIENTATION",TOKENS:["0"]},{TYPE:"var",NAME:"STATIC_BATCH",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_PASS",TOKENS:["REFL_PASS_NONE"]},{TYPE:"define",NAME:"MAX_BILLBOARD_ANGLE",TOKENS:["M_PI_4"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD_SPHERICAL","BILLBOARD",{TYPE:"logic_negative_expr",PLACES:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","bj","(","vec3","JY",",","mat3","N",")","{","vec4","JZ","=","vec4","(","N","[","1","]","[","1","]",",","N","[","1","]","[","2","]",",","N","[","2","]","[","0","]",",","N","[","2","]","[","1","]",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","J_","=","X","(","RIGHT_VECTOR",",","-","M_PI","/","2.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","J_","=","X","(","RIGHT_VECTOR",",","M_PI","/","2.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["JZ","=","qX","(","J_",",","JZ",")",";","JZ","=","kR","(","JZ",")",";","mat3","bk","=","da","(",")",";","bk","[","0","]","=","JY",";","bk","=","dd","(","JZ",",","bk",")",";","return","bk",";","}"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","Kb","(","vec3","lH",",","vec3","JY",")","{","vec3","Ka","=","lH","-","JY",";","Ka",".","z","=","0.0",";","Ka","=","normalize","(","Ka",")",";","vec4","JZ","=","rd","(","Ka",",","TOWARD_VECTOR",")",";","mat3","bk","=","da","(",")",";","bk","[","0","]","=","JY",";","bk","=","dd","(","JZ",",","bk",")",";","return","bk",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD_JITTERED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","at","(","in","vec3","Kc",",","float","Kd",",","float","Ke",",","float","Kf",",","vec3","a_",",","mat3","Z",")","{","float","Ic","=","fract","(","length","(","a_",")","/","0.17",")",";","float","Kg","=","Kf","+","Ic","/","10.0",";","float","Kh","=","Ic",";","if","(","Kf","!=","0.0",")","Kh","/=","Kf",";","Kc","*=","1.0","+","0.5","*","sin","(","Kd",")",";","float","Ki","=","length","(","Kc",")","*","Ke","*","sin","(","2.0","*","3.14","*","Kd","*","Kg","+","Kh",")",";","vec4","Kj","=","X","(","TOWARD_VECTOR",",","Ki",")",";","vec4","Kk","=","vec4","(","Z","[","1","]","[","1","]",",","Z","[","1","]","[","2","]",",","Z","[","2","]","[","0","]",",","Z","[","2","]","[","1","]",")",";","Kk","=","qX","(","Kk",",","Kj",")",";","Z","=","dd","(","Kk",",","Z",")",";","return","Z",";","}"]}]}}]},{TYPE:"txt",TOKENS:["mat3","as","(","in","vec3","lH",",","in","vec3","aq",",","in","mat3","N",",","in","mat3","Z",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD_SPHERICAL","BILLBOARD",{TYPE:"logic_negative_expr",PLACES:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","lW","=","bj","(","aq",",","N",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BILLBOARD_RANDOM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","Ic","=","fract","(","(","aq",".","x","*","1.43","-","aq",".","z","*","0.123","+","aq",".","y","*","6.1",")",")",";","float","Kl","=","2.0","*","M_PI","*","Ic",";","vec4","Km","=","vec4","(","N","[","1","]","[","1","]",",","N","[","1","]","[","2","]",",","N","[","2","]","[","0","]",",","N","[","2","]","[","1","]",")",";","float","Kn","=","asin","(","2.0","*","(","Km",".","x","*","Km",".","y","-","Km",".","z","*","Km",".","w",")",")",";","float","hu","=","Kn","-","Kl",";","if","(","hu","<","0.0",")","hu","=","2.0","*","M_PI","+","hu",";","float","Ko","=","Kl",";","if","(","hu","<=","MAX_BILLBOARD_ANGLE",")","Ko","+=","hu",";","else","if","(","hu","<=","M_PI","-","MAX_BILLBOARD_ANGLE",")","Ko","+=","MAX_BILLBOARD_ANGLE","*","(","2.0","*","hu","-","M_PI",")","/","(","2.0","*","MAX_BILLBOARD_ANGLE","-","M_PI",")",";","else","if","(","hu","<=","M_PI","+","MAX_BILLBOARD_ANGLE",")","Ko","+=","hu","-","M_PI",";","else","if","(","hu","<=","2.0","*","M_PI","-","MAX_BILLBOARD_ANGLE",")","Ko","+=","MAX_BILLBOARD_ANGLE","*","(","2.0","*","hu","-","M_PI",")","/","(","2.0","*","MAX_BILLBOARD_ANGLE","-","M_PI",")","+","M_PI",";","else","Ko","+=","hu","-","2.0","*","M_PI",";","vec4","Kp","=","X","(","UP_VECTOR",",","Ko",")",";","mat3","lW","=","da","(",")",";","lW","[","0","]","=","aq",";","lW","=","dd","(","Kp",",","lW",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","lW","=","Kb","(","lH",",","aq",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["Z","[","0","]","=","vec3","(","0.0",",","0.0",",","0.0",")",";","lW","=","aY","(","lW",",","Z",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["lW","[","1","]","[","0","]","*=","Z","[","1","]","[","0","]",";"]}]}}]},{TYPE:"txt",TOKENS:["return","lW",";","}","au","av","(","in","vec3","fn",",","in","vec3","Kq",",","in","vec3","Kr",",","in","vec3","Ks",",","in","vec3","Kt",",","in","vec3","Ku",",","in","mat3","Z",")","{","fn","=","ap","(","Z",",","fn",")",";","Kq","=","ap","(","Z",",","Kq",")",";","Kr","=","_","(","Z",",","Kr",")",";","Ks","=","_","(","Z",",","Ks",")",";","Kt","=","_","(","Z",",","Kt",")",";","Ku","=","_","(","Z",",","Ku",")",";","return","lX","(","au","(","fn",",","Kq",",","Kr",",","Ks",",","Kt",",","Ku",",","vec3","(","0.0",")",")",")",";","}"]}]}}]}]},e["include/wind_bending.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"WIND_BENDING_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"WIND_BENDING_GLSLV",TOKENS:[""]},{TYPE:"var",NAME:"WIND_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"MAIN_BEND_COL",TOKENS:["0"]},{TYPE:"var",NAME:"DETAIL_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"BEND_CENTER_ONLY",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_PASS",TOKENS:["REFL_PASS_NONE"]},{TYPE:"var",NAME:"BILLBOARD",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["void","KH","(","inout","vec3","bo",",","in","vec3","Kv",",","in","float","Kw",",","in","float","Kx",",","in","float","fu",",","in","vec3","Kc",",","in","float","Ky",",","in","mat4","bV",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2},"BILLBOARD",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","Kz","=","(","bV","*","vec4","(","bo",",","1.0",")",")",".","xyz",";","vec3","KA","=","(","bV","*","vec4","(","Kv",",","1.0",")",")",".","xyz",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","Kz","=","bo",";","vec3","KA","=","Kv",";"]}]}}]},{TYPE:"txt",TOKENS:["float","dA","=","length","(","KA",")",";","float","KB","=","Kx","*","(","1.0","+","0.1","*","fract","(","dA",")",")",";","float","KC","=","Kw","*","Ky","*","(","1.0","+","sin","(","2.0","*","3.14","*","fu","*","KB","+","dA",")",")",";","float","KD","=","(","Kz",".","z","-","KA",".","z",")","*","abs","(","KC",")",";","KD","+=","1.0",";","KD","*=","KD",";","KD","=","KD","*","KD","-","KD",";","vec3","KE","=","Kz",";","KE",".","xy","+=","Kc",".","xy","*","KD","*","sign","(","KC",")",";","vec3","KF","=","KE","-","KA",";","if","(","all","(","equal","(","KF",",","vec3","(","0.0",")",")",")",")","bo","=","Kv",";","else","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2},"BILLBOARD",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["KF","=","(","bV","*","vec4","(","KF",",","0.0",")",")",".","xyz",";"]}]}}]},{TYPE:"txt",TOKENS:["float","KG","=","length","(","Kz","-","KA",")",";","bo","=","Kv","+","normalize","(","KF",")","*","KG",";","}","}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DETAIL_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","KI","(","vec4","x",")","{","return","x","*","x","*","(","3.0","-","2.0","*","x",")",";","}","vec4","KJ","(","vec4","x",")","{","return","abs","(","fract","(","x","+","0.5",")","*","2.0","-","1.0",")",";","}","vec4","KK","(","vec4","x",")","{","return","KI","(","KJ","(","x",")",")",";","}","void","KW","(","inout","vec3","bo",",","in","float","fu",",","in","vec3","U",",","in","vec3","Kc",",","in","vec3","Kv",",","in","float","KL",",","in","float","KM",",","in","float","KN",",","in","vec3","KO",",","in","mat4","bV",")","{","float","KP",";","float","KQ",";","float","KR",";","vec2","KS",";","vec4","KT",";","vec2","KU",";","vec3","KV",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2},"BILLBOARD",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","Kz","=","(","bV","*","vec4","(","bo",",","1.0",")",")",".","xyz",";","vec3","KA","=","(","bV","*","vec4","(","Kv",",","1.0",")",")",".","xyz",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","Kz","=","bo",";","vec3","KA","=","Kv",";"]}]}}]},{TYPE:"txt",TOKENS:["KP","=","dot","(","KA",",","vec3","(","1.0",")",")",";","KQ","=","KP","+","KO",".","g",";","KR","=","dot","(","Kz",",","vec3","(","KO",".","g",")",")",";","KS","=","(","fu","+","vec2","(","KR",",","KQ",")",")",";","KT","=","(","(","fract","(","(","KS",".","xxyy","*","vec4","(","1.975",",","0.793",",","0.375",",","0.193",")",")",")","*","2.0",")","-","1.0",")","*","length","(","Kc",")","*","KL",";","KT","=","KK","(","KT",")",";","KU","=","KT",".","xz","+","KT",".","yw",";","KU",".","y","=","0.5","-","KU",".","y",";","KV","=","KU",".","xxy","*","KO",".","rrb","*","vec3","(","KM","*","U",".","x",",","KM","*","U",".","y",",","KN",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2},"BILLBOARD",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["KV","=","(","bV","*","vec4","(","KV",",","0.0",")",")",".","xyz",";"]}]}}]},{TYPE:"txt",TOKENS:["bo","+=","KV",";","}"]}]}}]},{TYPE:"txt",TOKENS:["void","ax","(","inout","vec3","O",",","inout","vec3","ao",",","in","vec3","U",",","in","mat4","bV",")","{","vec3","KX","=","u_wind","*","1.0","+","0.7","*","sin","(","u_time",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BEND_CENTER_ONLY"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","KY","=","ao",";","vec3","KZ","=","a_emitter_center",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2},"BILLBOARD",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["KZ","=","(","bV","*","vec4","(","KZ",",","1.0",")",")",".","xyz",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","KY","=","O",";","vec3","KZ","=","ao",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAIN_BEND_COL"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DETAIL_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["KW","(","KY",",","u_time",",","U",",","KX",",","KZ",",","au_detail_bending_freq",",","au_detail_bending_amp",",","au_branch_bending_amp",",","a_bending_col_detail",",","bV",")",";"]}]}}]},{TYPE:"txt",TOKENS:["KH","(","KY",",","KZ",",","au_wind_bending_amp",",","au_wind_bending_freq",",","u_time",",","KX",",","a_bending_col_main",",","bV",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["KH","(","KY",",","KZ",",","au_wind_bending_amp",",","au_wind_bending_freq",",","u_time",",","KX",",","1.0",",","bV",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BEND_CENTER_ONLY"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["O","+=","KY","-","ao",";","ao","=","KY",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["O","=","KY",";","ao","=","KZ",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]}]}}]}]}}},function(e,t,_){"use strict";function r(e,t){var _=e[0],r=e[1],a=e[2],E=e[3];_=n(_,r,a,E,t[0],7,-680876936),E=n(E,_,r,a,t[1],12,-389564586),a=n(a,E,_,r,t[2],17,606105819),r=n(r,a,E,_,t[3],22,-1044525330),_=n(_,r,a,E,t[4],7,-176418897),E=n(E,_,r,a,t[5],12,1200080426),a=n(a,E,_,r,t[6],17,-1473231341),r=n(r,a,E,_,t[7],22,-45705983),_=n(_,r,a,E,t[8],7,1770035416),E=n(E,_,r,a,t[9],12,-1958414417),a=n(a,E,_,r,t[10],17,-42063),r=n(r,a,E,_,t[11],22,-1990404162),_=n(_,r,a,E,t[12],7,1804603682),E=n(E,_,r,a,t[13],12,-40341101),a=n(a,E,_,r,t[14],17,-1502002290),r=n(r,a,E,_,t[15],22,1236535329),_=o(_,r,a,E,t[1],5,-165796510),E=o(E,_,r,a,t[6],9,-1069501632),a=o(a,E,_,r,t[11],14,643717713),r=o(r,a,E,_,t[0],20,-373897302),_=o(_,r,a,E,t[5],5,-701558691),E=o(E,_,r,a,t[10],9,38016083),a=o(a,E,_,r,t[15],14,-660478335),r=o(r,a,E,_,t[4],20,-405537848),_=o(_,r,a,E,t[9],5,568446438),E=o(E,_,r,a,t[14],9,-1019803690),a=o(a,E,_,r,t[3],14,-187363961),r=o(r,a,E,_,t[8],20,1163531501),_=o(_,r,a,E,t[13],5,-1444681467),E=o(E,_,r,a,t[2],9,-51403784),a=o(a,E,_,r,t[7],14,1735328473),r=o(r,a,E,_,t[12],20,-1926607734),_=i(_,r,a,E,t[5],4,-378558),E=i(E,_,r,a,t[8],11,-2022574463),a=i(a,E,_,r,t[11],16,1839030562),r=i(r,a,E,_,t[14],23,-35309556),_=i(_,r,a,E,t[1],4,-1530992060),E=i(E,_,r,a,t[4],11,1272893353),a=i(a,E,_,r,t[7],16,-155497632),r=i(r,a,E,_,t[10],23,-1094730640),_=i(_,r,a,E,t[13],4,681279174),E=i(E,_,r,a,t[0],11,-358537222),a=i(a,E,_,r,t[3],16,-722521979),r=i(r,a,E,_,t[6],23,76029189),_=i(_,r,a,E,t[9],4,-640364487),E=i(E,_,r,a,t[12],11,-421815835),a=i(a,E,_,r,t[15],16,530742520),r=i(r,a,E,_,t[2],23,-995338651),_=s(_,r,a,E,t[0],6,-198630844),E=s(E,_,r,a,t[7],10,1126891415),a=s(a,E,_,r,t[14],15,-1416354905),r=s(r,a,E,_,t[5],21,-57434055),_=s(_,r,a,E,t[12],6,1700485571),E=s(E,_,r,a,t[3],10,-1894986606),a=s(a,E,_,r,t[10],15,-1051523),r=s(r,a,E,_,t[1],21,-2054922799),_=s(_,r,a,E,t[8],6,1873313359),E=s(E,_,r,a,t[15],10,-30611744),a=s(a,E,_,r,t[6],15,-1560198380),r=s(r,a,E,_,t[13],21,1309151649),_=s(_,r,a,E,t[4],6,-145523070),E=s(E,_,r,a,t[11],10,-1120210379),a=s(a,E,_,r,t[2],15,718787259),r=s(r,a,E,_,t[9],21,-343485551),e[0]=d(_,e[0]),e[1]=d(r,e[1]),e[2]=d(a,e[2]),e[3]=d(E,e[3])}function a(e,t,_,r,a,n){return t=d(d(t,e),d(r,n)),d(t<<a|t>>>32-a,_)}function n(e,t,_,r,n,o,i){return a(t&_|~t&r,e,t,n,o,i)}function o(e,t,_,r,n,o,i){return a(t&r|_&~r,e,t,n,o,i)}function i(e,t,_,r,n,o,i){return a(t^_^r,e,t,n,o,i)}function s(e,t,_,r,n,o,i){return a(_^(t|~r),e,t,n,o,i)}function E(e){var t,_=e.length,a=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)r(a,c(e.substring(t-64,t)));e=e.substring(t-64);var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)n[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(n[t>>2]|=128<<(t%4<<3),t>55)for(r(a,n),t=0;t<16;t++)n[t]=0;return n[14]=8*_,r(a,n),a}function c(e){var t,_=[];for(t=0;t<64;t+=4)_[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return _}function l(e){for(var t="",_=0;_<4;_++)t+=f[e>>8*_+4&15]+f[e>>8*_&15];return t}function T(e){for(var t=0;t<e.length;t++)e[t]=l(e[t]);return e.join("")}function d(e,t){return e+t&4294967295}function u(e){return T(E(e))}t.a=u;var f="0123456789abcdef".split("")},function(e,t,_){"use strict";function r(e,t){function _(e){switch(e.type){case"VALTORGB":e.color_ramp||(e.color_ramp={elements:[{position:.5,color:[1,1,1,1]}]},O("node Color Ramp",e,"color_ramp"));break;case"CURVE_RGB":e.curve_mapping||(e.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},O("node RGB Curves",e,"curve_mapping"));break;case"CURVE_VEC":e.curve_mapping||(e.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},O("node Vector Curves",e,"curve_mapping"));break;case"MAPPING":e.vector_type||(e.vector_type="POINT",O("node Mapping",e,"vector_type"));break;case"MATERIAL":case"MATERIAL_EXT":"alpha"in e||(e.alpha=1,O("node material",e,"alpha")),"darkness"in e||(e.darkness=1,O("node material",e,"darkness")),"diffuse_toon_size"in e||(e.diffuse_toon_size=.5,O("node material",e,"diffuse_toon_size")),"diffuse_toon_smooth"in e||(e.diffuse_toon_smooth=.1,O("node material",e,"diffuse_toon_smooth")),"diffuse_intensity"in e||(e.diffuse_intensity=1,O("node material",e,"diffuse_intensity")),"use_tangent_shading"in e||(e.use_tangent_shading=!1,O("node material",e,"use_tangent_shading")),"specular_shader"in e||(e.specular_shader="COOKTORR",O("node material",e,"specular_shader")),"specular_ior"in e||(e.specular_ior=4,O("node material",e,"specular_ior")),"specular_hardness"in e||(e.specular_hardness=50,O("node material",e,"specular_hardness")),"specular_slope"in e||(e.specular_slope=.1,O("node material",e,"specular_slope")),"specular_toon_size"in e||(e.specular_toon_size=.5,O("node material",e,"specular_toon_size")),"specular_toon_smooth"in e||(e.specular_toon_smooth=.1,O("node material",e,"specular_toon_smooth")),"specular_intensity"in e||(e.specular_intensity=.5,O("node material",e,"specular_intensity")),"diffuse_shader"in e||(e.diffuse_shader="LAMBERT",O("node material",e,"diffuse_shader")),"roughness"in e||(e.roughness=.5,O("node material",e,"roughness")),"diffuse_fresnel"in e||(e.diffuse_fresnel=.1,O("node material",e,"diffuse_fresnel")),"diffuse_fresnel_factor"in e||(e.diffuse_fresnel_factor=.5,O("node material",e,"diffuse_fresnel_factor"));break;case"MATH":case"MIX_RGB":"use_clamp"in e||(e.use_clamp=!1,O("node "+e.type,e,"use_clamp"));break;case"GROUP":switch(e.node_tree_name=e.node_tree_name.replace(/\.[0-9]{3,}$/g,""),e.node_tree_name){case"CLAMP":case"LEVELS_OF_QUALITY":case"LINEAR_TO_SRGB":case"NORMAL_VIEW":case"PARALLAX":case"REFLECT":case"REFRACTION":case"REPLACE":case"SMOOTHSTEP":case"SRGB_TO_LINEAR":case"TIME":case"TRANSLUCENCY":case"VECTOR_VIEW":e.node_tree_name="B4W_"+e.node_tree_name}break;case"VECT_TRANSFORM":"convert_from"in e||(e.convert_from="WORLD",O("node "+e.type,e,"convert_from")),"convert_to"in e||(e.convert_to="WORLD",O("node "+e.type,e,"convert_to")),"vector_type"in e||(e.vector_type="POINT",O("node "+e.type,e,"vector_type"));break;case"ATTRIBUTE":e.color_layer="";break;case"BSDF_TRANSPARENT":"b4w_use_alpha"in e||(e.b4w_use_alpha=!1,O("node "+e.type,e,"b4w_use_alpha"))}}function r(e){var t=e.nla_tracks;if(t)for(var _=0;_<t.length;_++)for(var r=t[_],a=0;a<r.strips.length;a++){var n=r.strips[a];"action"in n||(n.action=null,O("strip",n,"action")),"action_frame_start"in n||(n.action_frame_start=0,O("strip",n,"action_frame_start")),"action_frame_end"in n||(n.action_frame_end=n.frame_end-n.frame_start,O("strip",n,"action_frame_end")),"repeat"in n||(n.repeat=1,O("strip",n,"repeat")),"use_reverse"in n||(n.use_reverse=!1,O("strip",n,"use_reverse")),"scale"in n||(n.scale=1,O("strip",n,"scale"))}}function a(e){for(var t=["b4w_apply_scale","b4w_apply_modifiers","b4w_export_edited_normals","b4w_loc_export_vertex_anim","b4w_shape_keys"],_=null,r=0;r<t.length;r++)e[t[r]]&&(_?(e[t[r]]=!1,F.warn('WARNING property "'+t[r]+'" of object "'+e.name+'" has been set to "false". Foreground property "'+_+'" already exists.')):_=t[r])}function S(e){var t=e.game,_=t.collision_bounds_type;t.use_collision_bounds&&"BOX"!=_&&"CYLINDER"!=_&&"CONE"!=_&&"SPHERE"!=_&&"CAPSULE"!=_&&"EMPTY"!=_&&(F.error("Wrong collision bounds type "+_+". Disable physics for object "+e.name),e.b4w_collision=!1,e.b4w_floating=!1,e.b4w_vehicle=!1,e.b4w_character=!1)}function p(e,t){var _=e[0],r=e[1],a=e[2],n=e[3];return t[0]=n,t[1]=_,t[2]=r,t[3]=a,t}function O(e,t,_){if(!B)return void(X=!0);var r=_+">>"+e;r in H||(H[r]={storage:[],report_type:"undefined",type:e}),H[r].storage.push(t.name)}function v(e,t){if(!B)return void(X=!0);F.warn("WARNING Datablock "+e+' is missing, reexport "'+t+'" scene')}function m(e,t,_){if(!B)return void(X=!0);var r=_+">>"+e;r in H||(H[r]={storage:[],report_type:"deprecated",type:e}),H[r].storage.push(t.name)}function N(e,t,_){if(!B)return void(X=!0);F.error("WARNING Incomplete modifier "+String(e)+' for "'+t.name+'", reexport "'+_+'" scene')}function g(e){if(!B)return void(X=!0);F.warn(e)}function R(e){var t=e.scale;if(0==t[0]&&0==t[1]&&0==t[2])return!0;var _=Math.abs((t[0]-t[1])/t[0]),r=Math.abs((t[1]-t[2])/t[1]);return _<.005&&r<.005}function I(e){return e.scale[0]<0||e.scale[1]<0||e.scale[2]<0}function b(e){for(var t=e.modifiers,_=0;_<t.length;_++){var r=t[_],a=r.type;if("ARRAY"==a||"CURVE"==a)return!0}return!1}function h(e,t){for(var _=0,r=0,a=0,n=new Float32Array(16),o=[],i=1;i<t.count;i++){if(t.use_constant_offset&&(_+=t.constant_offset_displace[0],r+=t.constant_offset_displace[1],a+=t.constant_offset_displace[2]),t.use_relative_offset){var s=e.b4w_boundings.bb;_+=(s.max_x-s.min_x)*t.relative_offset_displace[0],r+=(s.max_y-s.min_y)*t.relative_offset_displace[1],a+=(s.max_z-s.min_z)*t.relative_offset_displace[2]}d._59(_,r,a,n);var E=M(e);U(E,n),o.push(E)}for(var i=0;i<o.length;i++)x(e,o[i])}function Y(e,t){for(var _=t.object,r=D.create_spline(_),a=new Float32Array(16),n=r.is_3d?4:3,o=new Float32Array(n),i=new Float32Array(n),s=new Float32Array(3),c=new Float32Array(4),d=new Float32Array(4),f=new Float32Array(3),P=new Float32Array(3),A=new Float32Array(3),S=0;S<e.submeshes.length;S++){var p=e.submeshes[S],O=p.position,v=p.tbn,m=L(t.deform_axis);f[0]=0,f[1]=0,f[2]=0,f[m]=1;for(var N=D.spline_length(r),g=0;g<O.length/3;g++){A[0]=O[3*g],A[1]=O[3*g+1],A[2]=O[3*g+2];var R=A[m],I=D.spline_len_to_t(r,R);if(D.spline_point(r,I,o),s[0]=o[0],s[1]=o[1],s[2]=o[2],D.spline_derivative(r,I,i),P[0]=i[0],P[1]=0,P[2]=i[2],u.normalize(P,P),l.rotationTo(f,P,c),R<0?(o[0]=P[0],o[1]=P[1],o[2]=P[2],u.scale(o,R,o),u.add(s,o,s)):R>N&&(o[0]=P[0],o[1]=P[1],o[2]=P[2],u.scale(o,R-N,o),u.add(s,o,s)),E.fromRotationTranslation(c,s,a),r.is_3d){var b=o[3];l.setAxisAngle(f,b,d),u.transformQuat(A,d,A)}A[m]=0,u.transformMat4(A,a,A),O[3*g]=A[0],O[3*g+1]=A[1],O[3*g+2]=A[2];var h=T.e(v,g,Q);T.j(h,c,h),T.n(v,h,g)}}}function L(e){switch(e){case"POS_X":case"NEG_X":return 0;case"POS_Y":case"NEG_Y":return 1;case"POS_Z":case"NEG_Z":return 2;default:w.panic("Wrong deform axis value "+e)}}function M(e,t){t||(t=e.name+"_COPY");var _=e.materials,r=e.submeshes;e.materials=null,e.submeshes=null;var a=d.O(e);e.materials=_,e.submeshes=r,a.name=t,a.materials=e.materials.slice(0),a.submeshes=[];for(var n=0;n<r.length;n++){var o=r[n],i=d.N(o);a.submeshes.push(i)}return a}function x(e,t){for(var _=0;_<e.submeshes.length;_++){var r=e.submeshes[_],a=t.submeshes[_],n=r.base_length,o=r.indices.length;if(n)for(var i in r)switch(i){case"base_length":r[i]+=a[i];break;case"boundings":break;case"indices":r[i]=d._66(r[i],a[i]);for(var s=o;s<r[i].length;s++)r[i][s]+=n;break;case"position":r[i]=y(r[i],a[i],r[i].length/n/3);break;case"tbn":r[i]=y(r[i],a[i],r[i].length/n/4);break;case"shade_tangs":r[i]=y(r[i],a[i],r[i].length/n/3);break;case"group":r[i]=y(r[i],a[i],r[i].length/n);break;case"texcoord":r[i]=y(r[i],a[i],r.uv_layers.length);break;case"color":r[i]=y(r[i],a[i],r.vertex_colors.length);break;case"uv_layers":case"vertex_colors":break;default:F.warn('array_mesh_join(): unknown submesh property "'+i+'"'),r[i]=d._2(r[i],a[i])}}return e}function y(e,t,_){if(_>1){for(var r=e.length/_,a=t.length/_,n=new Float32Array(e.length+t.length),o=0,i=0;i<_;i++)n.set(e.subarray(r*i,r*(i+1)),o),o+=r,n.set(t.subarray(a*i,a*(i+1)),o),o+=a;return n}return d._2(e,t)}function U(e,t){for(var _=f.fromMat4(t,j),r=l.fromMat3(_,z),a=0;a<e.submeshes.length;a++){var n=e.submeshes[a];d._27(n.position,t,n.position,0),T.j(n.tbn,r,n.tbn)}}var w=Object(n.a)(e),C=Object(i.a)(e),D=Object(s.a)(e),F=Object(c.a)(e),G=Object(P.a)(e),k=Object(A.a)(e),K=C.defaults,B=!0,X=!1,H={},j=f.create(),Q=T.c(),z=l.create();t.check_bpy_data=function(e){H={};var t=e.worlds;if(0==t.length){v("world",e.b4w_filepath_blend);var n={name:"DEFAULT",horizon_color:new Float32Array([0,0,0]),zenith_color:new Float32Array([0,0,0]),light_settings:{use_environment_light:!1,environment_energy:1,environment_color:"PLAIN"},fog_settings:{use_fog:!1,intensity:0,depth:25,start:5,height:0,falloff:"INVERSE_QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},use_sky_paper:!1,use_sky_blend:!1,use_sky_real:!1,use_nodes:!1,node_tree:null,texture_slots:[]};t.push(n)}for(var o=0;o<t.length;o++){var n=t[o];"use_sky_blend"in n||(O("world",n,"use_sky_blend"),n.use_sky_blend=!1),"use_sky_paper"in n||(O("world",n,"use_sky_paper"),n.use_sky_paper=!1),"use_sky_real"in n||(O("world",n,"use_sky_real"),n.use_sky_real=!1),"b4w_sky_settings"in n&&"rayleigh_brightness"in n.b4w_sky_settings||(O("world",n,"rayleigh_brightness"),n.b4w_sky_settings={render_sky:!1,procedural_skydome:!1,use_as_enviroment_map:!1,color:[.24,.43,.75],rayleigh_brightness:3.3,mie_brightness:.1,spot_brightness:10,scatter_strength:.2,rayleigh_strength:.2,mie_strength:.006,rayleigh_collection_power:.5,mie_collection_power:.5,mie_distribution:.4}),"fog_settings"in n||(O("world",n,"fog_settings"),n.fog_settings={use_fog:!1,intensity:0,depth:25,start:0,height:0,falloff:"QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},"b4w_fog_color"in n&&(n.fog_settings.use_custom_color=!0,n.fog_settings.color=n.b4w_fog_color),"b4w_fog_density"in n&&n.b4w_fog_density>0&&(n.fog_settings.depth=1/n.b4w_fog_density)),"render_sky"in n.b4w_sky_settings||(O("world",n,"render_sky"),n.b4w_sky_settings.render_sky=!1);for(var i=n.texture_slots,s=0;s<i.length;s++){var E=i[s];"blend_type"in E||(E.blend_type="MIX",O("world_texture_slot",E,"blend_type")),"use_map_blend"in E||(E.use_map_blend=!1,O("world_texture_slot",E,"use_map_blend")),"use_map_horizon"in E||(E.use_map_horizon=!0,O("world_texture_slot",E,"use_map_horizon")),"use_map_zenith_up"in E||(E.use_map_zenith_up=!1,O("world_texture_slot",E,"use_map_zenith_up")),"use_rgb_to_intensity"in E||(E.use_rgb_to_intensity=!1,O("world_texture_slot",E,"use_rgb_to_intensity")),"invert"in E||(E.invert=!1,O("world_texture_slot",E,"invert")),"color"in E||(E.color=[1,0,1],O("world_texture_slot",E,"color")),"blend_factor"in E||(E.blend_factor=0,O("world_texture_slot",E,"blend_factor")),"horizon_factor"in E||(E.horizon_factor=1,O("world_texture_slot",E,"horizon_factor")),"zenith_up_factor"in E||(E.zenith_up_factor=0,O("world_texture_slot",E,"zenith_up_factor")),"zenith_down_factor"in E||(E.zenith_down_factor=0,O("world_texture_slot",E,"zenith_down_factor")),"default_value"in E||(E.default_value=1,O("world_texture_slot",E,"default_value"))}"b4w_use_default_animation"in n||(O("world",n,"b4w_use_default_animation"),n.b4w_use_default_animation=!1),"b4w_anim_behavior"in n||(O("world",n,"b4w_anim_behavior"),n.b4w_anim_behavior="CYCLIC")}for(var c=e.scenes,o=0;o<c.length;o++){var l=c[o],T=l.world;if("timeline_markers"in l||(l.timeline_markers=null,O("scene",l,"timeline_markers")),"boolean"==typeof l.b4w_enable_physics&&(l.b4w_enable_physics="AUTO"),"b4w_reflection_quality"in l||(l.b4w_reflection_quality="MEDIUM",O("scene",l,"b4w_reflection_quality")),"b4w_use_nla"in l||(l.b4w_use_nla=!1,O("scene",l,"b4w_use_nla")),"fps"in l||(l.fps=24,O("scene",l,"fps")),"b4w_nla_cyclic"in l||(l.b4w_nla_cyclic=!1,O("scene",l,"b4w_nla_cyclic")),"b4w_logic_nodes"in l||(l.b4w_logic_nodes=[],O("scene",l,"b4w_logic_nodes")),"b4w_detect_collisions"in l&&(m("scene",l,"b4w_detect_collisions"),delete l.b4w_detect_collisions),"audio_doppler_speed"in l||(l.audio_doppler_speed=343.3),"audio_doppler_factor"in l||(l.audio_doppler_factor=1),"b4w_dynamic_compressor_settings"in l||(l.b4w_dynamic_compressor_settings={threshold:-24,knee:30,ratio:12,attack:.003,release:.25},O("scene",l,"b4w_dynamic_compressor_settings")),"b4w_enable_convolution_engine"in l||(l.b4w_enable_convolution_engine=!1),"b4w_enable_bloom"in l||(l.b4w_enable_bloom=!1,O("scene",l,"b4w_enable_bloom")),"b4w_enable_motion_blur"in l||(l.b4w_enable_motion_blur=!1,O("scene",l,"b4w_enable_motion_blur")),"b4w_enable_color_correction"in l||(l.b4w_enable_color_correction=!1,O("scene",l,"b4w_enable_color_correction")),"b4w_antialiasing_quality"in l||(l.b4w_antialiasing_quality="MEDIUM",O("scene",l,"b4w_antialiasing_quality")),"b4w_tags"in l||(l.b4w_tags={title:"",description:""},O("scene",l,"b4w_tags")),"b4w_lod_smooth_type"in l||(l.b4w_lod_smooth_type="OFF",O("scene",l,"b4w_lod_smooth_type")),"b4w_lod_hyst_interval"in l||(l.b4w_lod_hyst_interval=0,O("scene",l,"b4w_lod_hyst_interval")),"b4w_enable_object_selection"in l||(l.b4w_enable_object_selection="AUTO",O("scene",l,"b4w_enable_object_selection")),"b4w_enable_outlining"in l||(l.b4w_enable_outlining="AUTO",O("scene",l,"b4w_enable_outlining")),"b4w_enable_glow_materials"in l||(l.b4w_enable_glow_materials="AUTO",O("scene",l,"b4w_enable_glow_materials")),"b4w_enable_anchors_visibility"in l||(l.b4w_enable_anchors_visibility="AUTO",O("scene",l,"b4w_enable_anchors_visibility")),"b4w_outline_color"in l||(l.b4w_outline_color=[1,1,1],O("scene",l,"b4w_outline_color")),"b4w_outline_factor"in l||(l.b4w_outline_factor="b4w_glow_factor"in l?l.b4w_glow_factor:1,O("scene",l,"b4w_outline_factor")),!("b4w_shadow_settings"in l)){O("scene",l,"b4w_shadow_settings");var u=T.b4w_shadow_settings;l.b4w_shadow_settings=u||{csm_resolution:2048,blur_samples:"16x",self_shadow_polygon_offset:1,b4w_enable_csm:!1,csm_num:1,csm_first_cascade_border:10,first_cascade_blur_radius:3,csm_last_cascade_border:100,last_cascade_blur_radius:1.5,fade_last_cascade:!0,blend_between_cascades:!0}}var f=l.b4w_shadow_settings;if("csm_resolution"in f||(O("scene",l,"b4w_shadow_settings.csm_resolution"),f.csm_resolution=2048),"blur_samples"in f||(O("scene",l,"b4w_shadow_settings.blur_samples"),f.blur_samples="16x"),"soft_shadows"in f||(O("scene",l,"b4w_shadow_settings.soft_shadows"),f.soft_shadows=!0),"self_shadow_polygon_offset"in f||(O("scene",l,"b4w_shadow_settings.self_shadow_polygon_offset"),f.self_shadow_polygon_offset=1),"self_shadow_normal_offset"in f||(O("scene",l,"b4w_shadow_settings.self_shadow_normal_offset"),f.self_shadow_normal_offset=.01),"b4w_enable_csm"in f||(O("scene",l,"b4w_shadow_settings.b4w_enable_csm"),f.b4w_enable_csm=!1),"csm_num"in f||(O("scene",l,"b4w_shadow_settings.csm_num"),f.csm_num=1),"csm_first_cascade_border"in f||(O("scene",l,"b4w_shadow_settings.csm_first_cascade_border"),f.csm_first_cascade_border=10),"first_cascade_blur_radius"in f||(O("scene",l,"b4w_shadow_settings.first_cascade_blur_radius"),f.first_cascade_blur_radius=3),"csm_last_cascade_border"in f||(O("scene",l,"b4w_shadow_settings.csm_last_cascade_border"),f.csm_last_cascade_border=100),"last_cascade_blur_radius"in f||(O("scene",l,"b4w_shadow_settings.last_cascade_blur_radius"),f.last_cascade_blur_radius=1.5),"fade_last_cascade"in f||(O("scene",l,"b4w_shadow_settings.fade_last_cascade"),f.fade_last_cascade=!0),"blend_between_cascades"in f||(O("scene",l,"b4w_shadow_settings.blend_between_cascades"),f.blend_between_cascades=!0),!("b4w_ssao_settings"in l)){O("scene",l,"b4w_ssao_settings");var P=T.b4w_ssao_settings;l.b4w_ssao_settings=P||{dist_factor:0,samples:16,hemisphere:!1,blur_depth:!1,blur_discard_value:1}}var A=l.b4w_ssao_settings;if("dist_factor"in A||(O("scene",l,"b4w_ssao_settings.dist_factor"),A.dist_factor=0),"samples"in A||(O("scene",l,"b4w_ssao_settings.samples"),A.samples=16),"hemisphere"in A||(O("scene",l,"b4w_ssao_settings.hemisphere"),A.hemisphere=!1),"blur_depth"in A||(O("scene",l,"b4w_ssao_settings.blur_depth"),A.blur_depth=!1),"blur_discard_value"in A||(O("scene",l,"b4w_ssao_settings.blur_discard_value"),A.blur_discard_value=1),!("b4w_bloom_settings"in l)){O("scene",l,"b4w_bloom_settings");var b=T.b4w_bloom_settings;l.b4w_bloom_settings=b||{key:.2,blur:4,edge_lum:1}}if("key"in l.b4w_bloom_settings||(O("scene",l,"b4w_bloom_settings.key"),l.b4w_bloom_settings.key=.2),"blur"in l.b4w_bloom_settings||(O("scene",l,"b4w_bloom_settings.blur"),l.b4w_bloom_settings.blur=4),"edge_lum"in l.b4w_bloom_settings||(O("scene",l,"b4w_bloom_settings.edge_lum"),l.b4w_bloom_settings.edge_lum=1),"adaptive"in l.b4w_bloom_settings||(O("scene",l,"b4w_bloom_settings.adaptive"),l.b4w_bloom_settings.adaptive=!0),"average_luminance"in l.b4w_bloom_settings||(O("scene",l,"b4w_bloom_settings.average_luminance"),l.b4w_bloom_settings.average_luminance=.5),!("b4w_motion_blur_settings"in l)){O("scene",l,"b4w_motion_blur_settings");var h=T.b4w_motion_blur_settings;l.b4w_motion_blur_settings=h||{motion_blur_factor:.01,motion_blur_decay_threshold:.01}}if("motion_blur_factor"in l.b4w_motion_blur_settings||(O("scene",l,"b4w_motion_blur_settings.motion_blur_factor"),l.b4w_motion_blur_settings.motion_blur_factor=.01),"motion_blur_decay_threshold"in l.b4w_motion_blur_settings||(O("scene",l,"b4w_motion_blur_settings.motion_blur_decay_threshold"),l.b4w_motion_blur_settings.motion_blur_decay_threshold=.01),!("b4w_color_correction_settings"in l)){O("scene",l,"b4w_color_correction_settings");var Y=T.b4w_color_correction_settings;l.b4w_color_correction_settings=Y||{brightness:0,contrast:0,exposure:1,saturation:1}}if(!("b4w_god_rays_settings"in l)){O("scene",l,"b4w_god_rays_settings");var L=T.b4w_god_rays_settings;l.b4w_god_rays_settings=L||{intensity:.7,max_ray_length:1,steps_per_pass:10}}if("steps_per_pass"in l.b4w_god_rays_settings||(O("scene",l,"b4w_god_rays_settings.steps_per_pass"),l.b4w_god_rays_settings.steps_per_pass=10),!("b4w_glow_settings"in l)){O("scene",l,"b4w_glow_settings"),l.b4w_glow_settings={render_glow_over_blend:!1,small_glow_mask_coeff:2,large_glow_mask_coeff:2,small_glow_mask_width:2,large_glow_mask_width:6};var M=l.b4w_glow_settings;"b4w_render_glow_over_blend"in T&&(M.render_glow_over_blend=T.b4w_render_glow_over_blend),"b4w_small_glow_mask_coeff"in T&&(M.small_glow_mask_coeff=T.b4w_small_glow_mask_coeff),"b4w_large_glow_mask_coeff"in T&&(M.large_glow_mask_coeff=T.b4w_large_glow_mask_coeff),"b4w_small_glow_mask_width"in T&&(M.small_glow_mask_width=T.b4w_small_glow_mask_width),"b4w_large_glow_mask_width"in T&&(M.large_glow_mask_width=T.b4w_large_glow_mask_width)}var x=l.b4w_render_shadows;"AUTO"!=x&&"OFF"!=x&&"ON"!=x&&(l.b4w_render_shadows=x?"ON":"OFF");var y=l.b4w_render_reflections;"OFF"!=y&&"ON"!=y&&(l.b4w_render_reflections=y?"ON":"OFF");var U=l.b4w_render_refractions;"AUTO"!=U&&"OFF"!=U&&"ON"!=U&&(l.b4w_render_refractions=U?"ON":"OFF"),"b4w_render_dynamic_grass"in l||(O("scene",l,"b4w_render_dynamic_grass"),l.b4w_render_dynamic_grass="AUTO"),l.b4w_nla_script&&m("scene",l,"b4w_nla_script"),"audio_distance_model"in l||(O("scene",l,"audio_distance_model"),l.audio_distance_model="INVERSE_CLAMPED"),"b4w_custom_prop"in l||(O("scene",l,"b4w_custom_prop"),l.b4w_custom_prop=null)}for(var w=e.meshes,o=0;o<w.length;o++){var C=w[o];if(!C.b4w_boundings){O("mesh",C,"b4w_boundings"),C.b4w_boundings={};var D=C.b4w_boundings;if(C.b4w_bounding_box?D.bb=C.b4w_bounding_box:D.bb={max_x:0,max_y:0,max_z:0,min_x:0,min_y:0,min_z:0},C.b4w_bounding_box_source?D.bb_src=C.b4w_bounding_box_source:D.bb_src=C.b4w_bounding_box,C.b4w_bounding_sphere_center?D.bs_cen=C.b4w_bounding_sphere_center:D.bs_cen=[0,0,0],C.b4w_bounding_cylinder_center?D.bc_cen=C.b4w_bounding_cylinder_center:D.bc_cen=[0,0,0],C.b4w_bounding_ellipsoid_center?D.be_cen=C.b4w_bounding_ellipsoid_center:D.be_cen=[0,0,0],C.b4w_bounding_ellipsoid_axes)D.be_ax=C.b4w_bounding_ellipsoid_axes;else{var G=D.bb;D.be_ax=[(G.max_x-G.min_x)/2,(G.max_y-G.min_y)/2,(G.max_z-G.min_z)/2]}if(C.b4w_rotated_bounding_box)D.rbb=C.b4w_rotated_bounding_box;else{var G=D.bb;D.rbb={rbb_c:[(G.max_x+G.min_x)/2,(G.max_y+G.min_y)/2,(G.max_z+G.min_z)/2],rbb_s:[1,1,1]}}C.b4w_cov_axis_x?D.caxis_x=C.b4w_cov_axis_x:D.caxis_x=[1,0,0],C.b4w_cov_axis_y?D.caxis_y=C.b4w_cov_axis_y:D.caxis_y=[0,1,0],C.b4w_cov_axis_z?D.caxis_z=C.b4w_cov_axis_z:D.caxis_z=[0,0,1]}"is_boundings_overridden"in C||(O("mesh",C,"is_boundings_overridden"),C.is_boundings_overridden=!1),"b4w_shape_keys"in C||(C.b4w_shape_keys=[],O("mesh",C,"b4w_shape_keys"));for(var k=!0,B=0;B<C.submeshes.length;B++){var j=C.submeshes[B];if("boundings"in j||(k=!1,j.boundings={be_ax:C.b4w_bounding_ellipsoid_axes,be_cen:C.b4w_bounding_ellipsoid_center,bb:{max_x:C.b4w_bounding_box.max_x,max_y:C.b4w_bounding_box.max_y,max_z:C.b4w_bounding_box.max_z,min_x:C.b4w_bounding_box.min_x,min_y:C.b4w_bounding_box.min_y,min_z:C.b4w_bounding_box.min_z}}),"uv_layers"in j||(O("submesh",C,"uv_layers"),j.uv_layers=C.uv_textures),"be_ax"in j.boundings||(j.boundings.be_ax=C.b4w_bounding_ellipsoid_axes),"be_cen"in j.boundings||(j.boundings.be_cen=C.b4w_bounding_ellipsoid_center),"bb"in j.boundings||(j.boundings.bb=C.b4w_bounding_box),!("rbb"in j.boundings)){var G=C.b4w_bounding_box;j.boundings.rbb={rbb_c:[(G.max_x+G.min_x)/2,(G.max_y+G.min_y)/2,(G.max_z+G.min_z)/2],rbb_s:[1,1,1]}}"caxis_x"in j.boundings||(j.boundings.caxis_x=[1,0,0]),"caxis_y"in j.boundings||(j.boundings.caxis_y=[0,1,0]),"caxis_z"in j.boundings||(j.boundings.caxis_z=[0,0,1])}k||O("mesh",C,"submesh_bd"),a(C);for(var s=0;s<C.b4w_vertex_anim.length;s++){var Q=C.b4w_vertex_anim[s];"allow_nla"in Q||(O('mesh["b4w_vertex_anim"]',C,"allow_nla"),Q.allow_nla=!0)}"active_uv_name"in C||(O("mesh",C,"active_uv_name"),C.active_uv_name="")}for(var z=e.cameras,o=0;o<z.length;o++){var V=z[o];V.type||(V.type="PERSP",O("camera",V,"type")),"b4w_eye_target_dist"in V&&(delete V.b4w_eye_target_dist,m("camera",V,"b4w_eye_target_dist")),"b4w_hover_zero_level"in V||(V.b4w_hover_zero_level=0,O("camera",V,"b4w_hover_zero_level")),"b4w_trans_velocity"in V||(V.b4w_trans_velocity=1,O("camera",V,"b4w_trans_velocity")),"b4w_rot_velocity"in V||(V.b4w_rot_velocity=1,O("camera",V,"b4w_rot_velocity")),"b4w_zoom_velocity"in V||(V.b4w_zoom_velocity=.1,O("camera",V,"b4w_zoom_velocity")),"b4w_use_target_distance_limits"in V||(V.b4w_use_target_distance_limits=V.b4w_use_distance_limits||!1,O("camera",V,"b4w_use_target_distance_limits")),"b4w_use_zooming"in V||(V.b4w_use_zooming=V.b4w_use_distance_limits||!1,O("camera",V,"b4w_use_zooming")),"b4w_distance_min"in V||(V.b4w_distance_min=1,O("camera",V,"b4w_distance_min")),"b4w_distance_max"in V||(V.b4w_distance_max=100,O("camera",V,"b4w_distance_max")),"b4w_horizontal_translation_min"in V||(V.b4w_horizontal_translation_min=-100,O("camera",V,"b4w_horizontal_translation_min")),"b4w_horizontal_translation_max"in V||(V.b4w_horizontal_translation_max=100,O("camera",V,"b4w_horizontal_translation_max")),"b4w_vertical_translation_min"in V||(V.b4w_vertical_translation_min=-100,O("camera",V,"b4w_vertical_translation_min")),"b4w_vertical_translation_max"in V||(V.b4w_vertical_translation_max=100,O("camera",V,"b4w_vertical_translation_max")),"b4w_use_horizontal_clamping"in V||(V.b4w_use_horizontal_clamping=!1,O("camera",V,"b4w_use_horizontal_clamping")),"b4w_rotation_left_limit"in V||(V.b4w_rotation_left_limit=-Math.PI,O("camera",V,"b4w_rotation_left_limit")),"b4w_rotation_right_limit"in V||(V.b4w_rotation_right_limit=Math.PI,O("camera",V,"b4w_rotation_right_limit")),"b4w_horizontal_clamping_type"in V||(V.b4w_horizontal_clamping_type="LOCAL",O("camera",V,"b4w_horizontal_clamping_type")),"b4w_use_vertical_clamping"in V||(V.b4w_use_vertical_clamping=!1,O("camera",V,"b4w_use_vertical_clamping")),"b4w_rotation_down_limit"in V||(V.b4w_rotation_down_limit=-Math.PI/2,O("camera",V,"b4w_rotation_down_limit")),"b4w_rotation_up_limit"in V||(V.b4w_rotation_up_limit=Math.PI/2,O("camera",V,"b4w_rotation_up_limit")),"b4w_vertical_clamping_type"in V||(V.b4w_vertical_clamping_type="LOCAL",O("camera",V,"b4w_vertical_clamping_type")),"b4w_hover_angle_min"in V||(V.b4w_hover_angle_min=Math.PI/6,O("camera",V,"b4w_hover_angle_min")),"b4w_hover_angle_max"in V||(V.b4w_hover_angle_max=Math.PI/6,O("camera",V,"b4w_hover_angle_max")),"b4w_enable_hover_hor_rotation"in V||(V.b4w_enable_hover_hor_rotation=!0,O("camera",V,"b4w_enable_hover_hor_rotation")),"b4w_use_panning"in V||(V.b4w_use_panning=!0,O("camera",V,"b4w_use_panning")),"b4w_use_pivot_limits"in V||(V.b4w_use_pivot_limits=!1,V.b4w_pivot_z_min=0,V.b4w_pivot_z_max=10,O("camera",V,"b4w_use_pivot_limits")),"b4w_dof_bokeh"in V||(V.b4w_dof_bokeh=!1,O("camera",V,"b4w_dof_bokeh")),"b4w_dof_bokeh_intensity"in V||(V.b4w_dof_bokeh_intensity=.3,O("camera",V,"b4w_dof_bokeh_intensity")),"b4w_dof_foreground_blur"in V||(V.b4w_dof_foreground_blur=!1,O("camera",V,"b4w_dof_foreground_blur")),"b4w_dof_front_start"in V||(V.b4w_dof_front_start=0,O("camera",V,"b4w_dof_front_start")),"b4w_dof_front_end"in V||(V.b4w_dof_front_end=V.b4w_dof_front,O("camera",V,"b4w_dof_front_end")),"b4w_dof_rear_start"in V||(V.b4w_dof_rear_start=0,O("camera",V,"b4w_dof_rear_start")),"b4w_dof_rear_end"in V||(V.b4w_dof_rear_end=V.b4w_dof_rear,O("camera",V,"b4w_dof_rear_end")),"sensor_fit"in V||(V.sensor_fit="VERTICAL",O("camera",V,"sensor_fit"))}for(var q=e.lamps,o=0;o<q.length;o++){var W=q[o];"b4w_generate_shadows"in W||(W.b4w_generate_shadows=!1,O("lamp",W,"b4w_generate_shadows")),"b4w_dynamic_intensity"in W||(W.b4w_dynamic_intensity=!1,O("lamp",W,"b4w_dynamic_intensity")),"use_diffuse"in W||(W.use_diffuse=!0,O("lamp",W,"use_diffuse")),"use_specular"in W||(W.use_specular=!0,O("lamp",W,"use_specular")),"clip_start"in W||(W.clip_start=.1,O("lamp",W,"clip_start")),"clip_end"in W||(W.clip_end=30,O("lamp",W,"clip_end")),"POINT"!=W.type&&"SPOT"!=W.type||("use_sphere"in W||(W.use_sphere=!1,O("lamp",W,"use_sphere")),K.mali4_lamps_hack&&(W.type="SUN"))}for(var J=e.speakers,o=0;o<J.length;o++){var Z=J[o];"b4w_behavior"in Z||(Z.b4w_background_music?Z.b4w_behavior="BACKGROUND_SOUND":Z.b4w_behavior="POSITIONAL"),"b4w_auto_play"in Z||(Z.b4w_auto_play=!1,O("speaker",Z,"b4w_auto_play")),"b4w_enable_doppler"in Z||(Z.b4w_enable_doppler=!1,O("speaker",Z,"b4w_enable_doppler")),"b4w_delay"in Z||(Z.b4w_delay=0),"b4w_delay_random"in Z||(Z.b4w_delay_random=0),"b4w_volume_random"in Z||(Z.b4w_volume_random=0),"b4w_pitch_random"in Z||(Z.b4w_pitch_random=0),"b4w_fade_in"in Z||(Z.b4w_fade_in=0),"b4w_fade_out"in Z||(Z.b4w_fade_out=0),"b4w_loop"in Z||(Z.b4w_loop=!1),"b4w_loop_start"in Z||(Z.b4w_loop_start=0,O("speaker",Z,"b4w_loop_start")),"b4w_loop_end"in Z||(Z.b4w_loop_end=0,O("speaker",Z,"b4w_loop_end")),Z.animation_data&&r(Z.animation_data)}for(var $=e.textures,o=0;o<$.length;o++){var ee=$[o];"b4w_anisotropic_filtering"in ee||(ee.b4w_anisotropic_filtering="OFF",O("texture",ee,"b4w_anisotropic_filtering")),"b4w_water_foam"in ee||(ee.b4w_water_foam=!1,O("texture",ee,"b4w_water_foam")),"b4w_foam_uv_freq"in ee||(ee.b4w_foam_uv_freq=[1,1],O("texture",ee,"b4w_foam_uv_freq")),"b4w_foam_uv_magnitude"in ee||(ee.b4w_foam_uv_magnitude=[1,1],O("texture",ee,"b4w_foam_uv_magnitude")),"b4w_parallax_steps"in ee||(ee.b4w_parallax_steps=5,O("material",ee,"b4w_parallax_steps")),"b4w_parallax_lod_dist"in ee||(ee.b4w_parallax_lod_dist=10,O("material",ee,"b4w_parallax_lod_dist")),"b4w_shore_dist_map"in ee||(ee.b4w_shore_dist_map=!1,O("texture",ee,"b4w_shore_dist_map")),"b4w_shore_boundings"in ee||(ee.b4w_shore_boundings=[1e3,-1e3,1e3,-1e3],O("texture",ee,"b4w_shore_boundings")),"b4w_max_shore_dist"in ee||(ee.b4w_max_shore_dist=100,O("texture",ee,"b4w_max_shore_dist")),"b4w_disable_compression"in ee||(ee.b4w_disable_compression=!1,O("texture",ee,"b4w_disable_compression")),"b4w_source_type"in ee||(ee.b4w_source_type="",O("texture",ee,"b4w_source_type")),"b4w_source_id"in ee||(ee.b4w_source_id="",O("texture",ee,"b4w_source_id")),"b4w_source_size"in ee||(ee.b4w_source_size=1024,O("texture",ee,"b4w_source_size")),"b4w_enable_canvas_mipmapping"in ee||(ee.b4w_enable_canvas_mipmapping=!0,O("texture",ee,"b4w_enable_canvas_mipmapping")),"b4w_nla_video"in ee||(ee.b4w_nla_video=!1,O("texture",ee,"b4w_nla_video"))}for(var te=e.images,o=0;o<te.length;o++){var _e=te[o];"colorspace_settings_name"in _e||(_e.colorspace_settings_name="sRGB",O("image",_e,"colorspace_settings_name"))}for(var re=e.materials,o=0;o<re.length;o++){var ae=re[o];"ALPHA_ANTIALIASING"==ae.game_settings.alpha_blend&&(K.mali_alpha_antialias_hack?ae.game_settings.alpha_blend="CLIP":K.msaa_samples<2&&(F.warn('Material "'+ae.name+'" has the "Alpha Anti-Aliasing" transparency type, but multisampling is disabled. Changed to "Alpha Clip".'),ae.game_settings.alpha_blend="CLIP")),"use_tangent_shading"in ae||(ae.use_tangent_shading=!1,O("material",ae,"use_tangent_shading")),"b4w_node_mat_type"in ae&&m("material",ae,"b4w_node_mat_type"),"b4w_skydome"in ae&&m("material",ae,"b4w_skydome"),"b4w_procedural_skydome"in ae&&m("material",ae,"b4w_procedural_skydome"),"b4w_lens_flares"in ae||(ae.b4w_lens_flares=!1,O("material",ae,"b4w_lens_flares")),"LENS_FLARES"===ae.name&&(ae.b4w_lens_flares||F.warn('"LENS_FLARES" material name has been found. Enable the "Lens Flare" property for this material.'),ae.b4w_lens_flares=!0),ae.b4w_water&&("b4w_water_shore_smoothing"in ae||(ae.b4w_water_shore_smoothing=!1,O("material",ae,"b4w_water_shore_smoothing")),"b4w_water_dynamic"in ae||(ae.b4w_water_dynamic=!1,O("material",ae,"b4w_water_dynamic")),"b4w_waves_height"in ae||(ae.b4w_waves_height=1,O("material",ae,"b4w_waves_height")),"b4w_waves_length"in ae||(ae.b4w_waves_length=1,O("material",ae,"b4w_waves_length")),"b4w_water_dst_noise_scale0"in ae||(ae.b4w_water_dst_noise_scale0=.05,O("material",ae,"b4w_water_dst_noise_scale0")),"b4w_water_dst_noise_scale1"in ae||(ae.b4w_water_dst_noise_scale1=.03,O("material",ae,"b4w_water_dst_noise_scale1")),"b4w_water_dst_noise_freq0"in ae||(ae.b4w_water_dst_noise_freq0=1.3,O("material",ae,"b4w_water_dst_noise_freq0")),"b4w_water_dst_noise_freq1"in ae||(ae.b4w_water_dst_noise_freq1=1,O("material",ae,"b4w_water_dst_noise_freq1")),"b4w_water_dir_min_shore_fac"in ae||(ae.b4w_water_dir_min_shore_fac=.4,O("material",ae,"b4w_water_dir_min_shore_fac")),"b4w_water_dir_freq"in ae||(ae.b4w_water_dir_freq=.5,O("material",ae,"b4w_water_dir_freq")),"b4w_water_dir_noise_scale"in ae||(ae.b4w_water_dir_noise_scale=.05,O("material",ae,"b4w_water_dir_noise_scale")),"b4w_water_dir_noise_freq"in ae||(ae.b4w_water_dir_noise_freq=.07,O("material",ae,"b4w_water_dir_noise_freq")),"b4w_water_dir_min_noise_fac"in ae||(ae.b4w_water_dir_min_noise_fac=.5,O("material",ae,"b4w_water_dir_min_noise_fac")),"b4w_water_dst_min_fac"in ae||(ae.b4w_water_dst_min_fac=.2,O("material",ae,"b4w_water_dst_min_fac")),"b4w_water_waves_hor_fac"in ae||(ae.b4w_water_waves_hor_fac=5,O("material",ae,"b4w_water_waves_hor_fac")),"b4w_water_absorb_factor"in ae||(ae.b4w_water_absorb_factor=6,O("material",ae,"b4w_water_absorb_factor")),"b4w_water_fog_color"in ae||(ae.b4w_water_fog_color=[.5,.7,.7],O("material",ae,"b4w_water_fog_color")),"b4w_foam_factor"in ae||(ae.b4w_foam_factor=5,O("material",ae,"b4w_foam_factor")),"b4w_generated_mesh"in ae||(ae.b4w_generated_mesh=!1,O("material",ae,"b4w_generated_mesh")),"b4w_water_num_cascads"in ae||(ae.b4w_water_num_cascads=5,O("material",ae,"b4w_water_num_cascads")),"b4w_water_subdivs"in ae||(ae.b4w_water_subdivs=64,O("material",ae,"b4w_water_subdivs")),"b4w_water_detailed_dist"in ae||(ae.b4w_water_detailed_dist=1e3,O("material",ae,"b4w_water_detailed_dist")),"b4w_water_enable_caust"in ae||(ae.b4w_water_enable_caust=!1,O("material",ae,"b4w_water_enable_caust")),"b4w_water_caust_scale"in ae||(ae.b4w_water_caust_scale=.25,O("material",ae,"b4w_water_caust_scale")),"b4w_water_caust_brightness"in ae||(ae.b4w_water_caust_brightness=.5,O("material",ae,"b4w_water_caust_brightness"))),"b4w_dynamic_grass_size"in ae||(ae.b4w_dynamic_grass_size=""),"b4w_dynamic_grass_color"in ae||(ae.b4w_dynamic_grass_color=""),"diffuse_intensity"in ae||(ae.diffuse_intensity=1,O("material",ae,"diffuse_intensity")),"b4w_use_ghost"in ae||(ae.b4w_use_ghost=!1),"b4w_collision_margin"in ae||(ae.b4w_collision_margin=.04,O("material",ae,"b4w_collision_margin")),"b4w_collision_group"in ae||(ae.b4w_collision_group=128,O("material",ae,"b4w_collision_group")),"b4w_collision_mask"in ae||(ae.b4w_collision_mask=127,O("material",ae,"b4w_collision_mask")),"b4w_do_not_render"in ae||(ae.b4w_do_not_render=!1,O("material",ae,"b4w_do_not_render")),"HALO"!=ae.type||"b4w_halo_sky_stars"in ae||(ae.b4w_halo_sky_stars=!1,O("material",ae,"b4w_halo_sky_stars")),"HALO"!=ae.type||"b4w_halo_stars_blend_height"in ae||(ae.b4w_halo_stars_blend_height=10,O("material",ae,"b4w_halo_stars_blend_height")),"HALO"!=ae.type||"b4w_halo_stars_min_height"in ae||(ae.b4w_halo_stars_min_height=0,O("material",ae,"b4w_halo_stars_min_height")),"specular_shader"in ae||(ae.specular_shader="COOKTORR",O("material",ae,"specular_shader")),"diffuse_shader"in ae||(ae.diffuse_shader="LAMBERT",O("material",ae,"diffuse_shader")),"roughness"in ae||(ae.roughness=.5,O("material",ae,"roughness")),"diffuse_fresnel"in ae||(ae.diffuse_fresnel=.1,O("material",ae,"diffuse_fresnel")),"diffuse_fresnel_factor"in ae||(ae.diffuse_fresnel_factor=.5,O("material",ae,"diffuse_fresnel_factor")),"specular_slope"in ae||(ae.specular_slope=.2,O("material",ae,"specular_slope")),"specular_toon_size"in ae||(ae.specular_toon_size=.5,O("material",ae,"specular_toon_size")),"specular_toon_smooth"in ae||(ae.specular_toon_smooth=.1,O("material",ae,"specular_toon_smooth")),"specular_alpha"in ae||(ae.specular_alpha=1,O("material",ae,"specular_alpha")),"b4w_wettable"in ae||(ae.b4w_wettable=!1,O("material",ae,"b4w_wettable")),"b4w_refractive"in ae||(ae.b4w_refractive=!1,O("material",ae,"b4w_refractive")),"b4w_refr_bump"in ae||(ae.b4w_refr_bump=0,O("material",ae,"b4w_refr_bump")),"b4w_shallow_water_col"in ae||(ae.b4w_shallow_water_col=[0,.8,.3],O("material",ae,"b4w_shallow_water_col")),"b4w_shore_water_col"in ae||(ae.b4w_shore_water_col=[0,.9,.2],O("material",ae,"b4w_shore_water_col")),"b4w_shallow_water_col_fac"in ae||(ae.b4w_shallow_water_col_fac=1,O("material",ae,"b4w_shallow_water_col_fac")),"b4w_shore_water_col_fac"in ae||(ae.b4w_shore_water_col_fac=.5,O("material",ae,"b4w_shore_water_col_fac")),"b4w_water_sss_strength"in ae||(ae.b4w_water_sss_strength=5.9,O("material",ae,"b4w_water_sss_strength")),"b4w_water_sss_width"in ae||(ae.b4w_water_sss_width=.45,O("material",ae,"b4w_water_sss_width")),"b4w_render_above_all"in ae||(ae.b4w_render_above_all=!1,O("material",ae,"b4w_render_above_all")),"b4w_water_norm_uv_velocity"in ae||(ae.b4w_water_norm_uv_velocity=.05,O("material",ae,"b4w_water_norm_uv_velocity")),"specular_ior"in ae||(ae.specular_ior=1,O("material",ae,"specular_ior")),"darkness"in ae||(ae.darkness=0,O("material",ae,"darkness")),"diffuse_toon_size"in ae||(ae.diffuse_toon_size=0,O("material",ae,"diffuse_toon_size")),"diffuse_toon_smooth"in ae||(ae.diffuse_toon_smooth=0,O("material",ae,"diffuse_toon_smooth")),"pass_index"in ae||(ae.pass_index=0,O("material",ae,"pass_index"));for(var i=ae.texture_slots,s=0;s<i.length;s++){var E=i[s];"blend_type"in E||(E.blend_type="MIX",O("texture_slot",E,"blend_type"))}if(ae.node_tree){for(var ne=ae.node_tree.nodes,s=0;s<ne.length;s++)_(ne[s]);ae.node_tree.animation_data&&r(ae.node_tree.animation_data)}}for(var oe=e.node_groups,o=0;o<oe.length;o++)for(var ne=oe[o].node_tree.nodes,s=0;s<ne.length;s++)_(ne[s]);for(var ie=e.objects,o=0;o<ie.length;o++){var se=ie[o];switch(se.type){case"MESH":"b4w_dynamic_geometry"in se||(se.b4w_dynamic_geometry=!1),"b4w_reflexible"in se||(se.b4w_reflexible=!1),"b4w_reflexible_only"in se||(se.b4w_reflexible_only=!1),"b4w_reflective"in se||(se.b4w_reflective=!1),"b4w_reflection_type"in se||(se.b4w_reflection_type="PLANE",O("object",se,"b4w_reflection_type")),"b4w_wind_bending"in se||(se.b4w_wind_bending=!1,O("object",se,"b4w_wind_bending")),"b4w_wind_bending_angle"in se||(se.b4w_wind_bending_angle=10,se.b4w_wind_bending_freq=.25,O("object",se,"wind bending params")),"b4w_detail_bending_amp"in se||(se.b4w_detail_bending_amp=.1,se.b4w_branch_bending_amp=.3,O("object",se,"detail bending params")),"b4w_detail_bending_freq"in se||(se.b4w_detail_bending_freq=1,O("object",se,"b4w_detail_bending_freq")),"b4w_main_bend_stiffness_col"in se||(se.b4w_main_bend_stiffness_col="",O("object",se,"b4w_main_bend_stiffness_col")),"b4w_detail_bend_colors"in se||(se.b4w_detail_bend_colors={leaves_stiffness_col:"",leaves_phase_col:"",overall_stiffness_col:""},O("object",se,"b4w_detail_bend_colors")),"b4w_caustics"in se||(se.b4w_caustics=!1),"vertex_groups"in se&&se.vertex_groups.length&&se.data&&0==se.data.vertex_groups.length&&(se.data.vertex_groups=se.vertex_groups,delete se.vertex_groups,O("object",se,"vertex_groups")),"b4w_vertex_anim"in se&&se.b4w_vertex_anim.length&&se.data&&0==se.data.b4w_vertex_anim.length&&(se.data.b4w_vertex_anim=se.b4w_vertex_anim,delete se.b4w_vertex_anim,O("object",se,"b4w_vertex_anim")),"b4w_do_not_render"in se||(se.b4w_do_not_render=!1),"b4w_hidden_on_load"in se||(se.b4w_hidden_on_load=!1),"b4w_hide_chldr_on_load"in se||(se.b4w_hide_chldr_on_load=!1),"use_ghost"in se.game||(se.game.use_ghost=!1),"use_sleep"in se.game||(se.game.use_sleep=!1),"velocity_min"in se.game||(se.game.velocity_min=0),"velocity_max"in se.game||(se.game.velocity_max=0),"collision_group"in se.game||(se.game.collision_group=1),"collision_mask"in se.game||(se.game.collision_mask=255),S(se),"b4w_vehicle_settings"in se?se.b4w_vehicle_settings&&("steering_ratio"in se.b4w_vehicle_settings||(se.b4w_vehicle_settings.steering_ratio=10),"steering_max"in se.b4w_vehicle_settings||(se.b4w_vehicle_settings.steering_max=1),"inverse_control"in se.b4w_vehicle_settings||(se.b4w_vehicle_settings.inverse_control=!1),"force_max"in se.b4w_vehicle_settings||(se.b4w_vehicle_settings.force_max=1500),"brake_max"in se.b4w_vehicle_settings||(se.b4w_vehicle_settings.brake_max=100),"speed_ratio"in se.b4w_vehicle_settings||(se.b4w_vehicle_settings.speed_ratio=.027),"max_speed_angle"in se.b4w_vehicle_settings||(se.b4w_vehicle_settings.max_speed_angle=Math.PI),"delta_tach_angle"in se.b4w_vehicle_settings||(se.b4w_vehicle_settings.delta_tach_angle=4.43),"suspension_compression"in se.b4w_vehicle_settings||(se.b4w_vehicle_settings.suspension_compression=4.4),"suspension_stiffness"in se.b4w_vehicle_settings||(se.b4w_vehicle_settings.suspension_stiffness=20),"suspension_damping"in se.b4w_vehicle_settings||(se.b4w_vehicle_settings.suspension_damping=2.3),"wheel_friction"in se.b4w_vehicle_settings||(se.b4w_vehicle_settings.wheel_friction=1e3),"roll_influence"in se.b4w_vehicle_settings||(se.b4w_vehicle_settings.roll_influence=.1),"max_suspension_travel_cm"in se.b4w_vehicle_settings||(se.b4w_vehicle_settings.max_suspension_travel_cm=30),"floating_factor"in se.b4w_vehicle_settings||(se.b4w_vehicle_settings.floating_factor=3),"floating_factor"in se.b4w_vehicle_settings||(se.b4w_vehicle_settings.floating_factor=3),"water_lin_damp"in se.b4w_vehicle_settings||(se.b4w_vehicle_settings.water_lin_damp=.9),"water_rot_damp"in se.b4w_vehicle_settings||(se.b4w_vehicle_settings.water_rot_damp=.9)):(se.b4w_vehicle_settings=null,O("object",se,"b4w_vehicle_settings")),"b4w_floating_settings"in se?se.b4w_floating_settings&&("floating_factor"in se.b4w_floating_settings||(se.b4w_floating_settings.floating_factor=3),"water_lin_damp"in se.b4w_floating_settings||(se.b4w_floating_settings.water_lin_damp=.8),"water_rot_damp"in se.b4w_floating_settings||(se.b4w_floating_settings.water_rot_damp=.8)):(se.b4w_floating_settings=null,O("object",se,"b4w_floating_settings")),"b4w_character_settings"in se?se.b4w_character_settings&&("walk_speed"in se.b4w_character_settings||(se.b4w_character_settings.walk_speed=4),"run_speed"in se.b4w_character_settings||(se.b4w_character_settings.run_speed=8),"step_height"in se.b4w_character_settings||(se.b4w_character_settings.step_height=.25),"jump_strength"in se.b4w_character_settings||(se.b4w_character_settings.jump_strength=5),"waterline"in se.b4w_character_settings||(se.b4w_character_settings.waterline=0)):(se.b4w_character_settings=null,O("object",se,"b4w_character_settings")),"b4w_selectable"in se||(se.b4w_selectable=!1,O("object",se,"b4w_selectable")),"b4w_outlining"in se||(se.b4w_outlining=!1,O("object",se,"b4w_outlining")),"b4w_outline_on_select"in se||(se.b4w_outline_on_select=!1,O("object",se,"b4w_outline_on_select")),"b4w_billboard"in se||(se.b4w_billboard=!1,O("object",se,"b4w_billboard")),"b4w_billboard_geometry"in se||(se.b4w_billboard_geometry="SPHERICAL",O("object",se,"b4w_billboard_geometry")),"b4w_pres_glob_orientation"in se||(se.b4w_pres_glob_orientation=!1,O("object",se,"b4w_pres_glob_orientation")),"b4w_outline_settings"in se||("b4w_glow_settings"in se?se.b4w_outline_settings=se.b4w_glow_settings:(se.b4w_outline_settings={},se.b4w_outline_settings.outline_duration=1,se.b4w_outline_settings.outline_period=1,se.b4w_outline_settings.outline_relapses=0),O("object",se,"b4w_outline_settings")),"lod_levels"in se||(se.lod_levels=[],O("object",se,"lod_levels")),"b4w_animation_mixing"in se||(se.b4w_animation_mixing=!1,O("object",se,"b4w_animation_mixing"));break;case"EMPTY":"b4w_anchor"in se||(se.b4w_anchor=null,O("object",se,"b4w_anchor")),!se.b4w_anchor||"max_width"in se.b4w_anchor||(se.b4w_anchor.max_width=250)}if("collision_margin"in se.game||(se.game.collision_margin=.04,O("object",se,"collision_margin")),"b4w_anim_behavior"in se||(se.b4w_anim_behavior=se.b4w_cyclic_animation?"CYCLIC":"FINISH_STOP",O("object",se,"b4w_anim_behavior")),!("rotation_quaternion"in se)){var Ee=[0,0,0,1];d.Y(se.rotation_euler,Ee),p(Ee,Ee),se.rotation_quaternion=Ee,O("object",se,"rotation_quaternion")}"webgl_do_not_batch"in se&&(se.b4w_do_not_batch=se.webgl_do_not_batch,se.webgl_do_not_batch&&m("object",se,"webgl_do_not_batch")),"b4w_shadow_cast_only"in se||(se.b4w_shadow_cast_only=!1,O("object",se,"b4w_shadow_cast_only")),"b4w_correct_bounding_offset"in se||(se.b4w_correct_bounding_offset="AUTO",O("object",se,"b4w_correct_bounding_offset"));for(var ce=se.particle_systems,s=0;s<ce.length;s++){var le=ce[s],Te=le.settings;"use_rotation_dupli"in Te||(Te.use_rotation_dupli=!1,O("particle_settings",Te,"use_rotation_dupli")),"use_whole_group"in Te||(Te.use_whole_group=!1,O("particle_settings",Te,"use_whole_group")),le.transforms||(le.transforms=new Float32Array,O("particle_system",le,"transforms")),"b4w_billboard_align"in Te||(Te.b4w_billboard_align="VIEW",O("particle_settings",Te,"b4w_billboard_align")),"b4w_dynamic_grass"in Te||(Te.b4w_dynamic_grass=!1,O("object",Te,"b4w_dynamic_grass")),"b4w_dynamic_grass_scale_threshold"in Te||(Te.b4w_dynamic_grass_scale_threshold=.01,O("object",Te,"b4w_dynamic_grass_scale_threshold")),"b4w_initial_rand_rotation"in Te||(Te.b4w_initial_rand_rotation=!1,O("particle_settings",Te,"b4w_initial_rand_rotation")),"b4w_rotation_type"in Te||(Te.b4w_rotation_type="Z",O("particle_settings",Te,"b4w_rotation_type")),"b4w_rand_rotation_strength"in Te||(Te.b4w_rand_rotation_strength=1,O("particle_settings",Te,"b4w_rand_rotation_strength")),"b4w_hair_billboard"in Te||(Te.b4w_hair_billboard=!1,O("particle_settings",Te,"b4w_hair_billboard")),"b4w_hair_billboard_type"in Te||(Te.b4w_hair_billboard_type="BASIC",O("particle_settings",Te,"b4w_hair_billboard_type")),"b4w_hair_billboard_jitter_amp"in Te||(Te.b4w_hair_billboard_jitter_amp=0,O("particle_settings",Te,"b4w_hair_billboard_jitter_amp")),"b4w_hair_billboard_jitter_freq"in Te||(Te.b4w_hair_billboard_jitter_freq=0,O("particle_settings",Te,"b4w_hair_billboard_jitter_freq")),"b4w_hair_billboard_geometry"in Te||(Te.b4w_hair_billboard_geometry="SPHERICAL",O("particle_settings",Te,"b4w_hair_billboard_geometry")),"b4w_wind_bend_inheritance"in Te||(Te.b4w_wind_bend_inheritance="PARENT",O("particle_settings",Te,"b4w_wind_bend_inheritance")),"b4w_shadow_inheritance"in Te||(Te.b4w_shadow_inheritance="PARENT",O("particle_settings",Te,"b4w_shadow_inheritance")),"b4w_reflection_inheritance"in Te||(Te.b4w_reflection_inheritance="PARENT",O("particle_settings",Te,"b4w_reflection_inheritance")),"b4w_vcol_from_name"in Te||(Te.b4w_vcol_from_name="",O("particle_settings",Te,"b4w_vcol_from_name")),"b4w_vcol_to_name"in Te||(Te.b4w_vcol_to_name="",O("particle_settings",Te,"b4w_vcol_to_name")),"b4w_coordinate_system"in Te||(Te.b4w_coordinate_system="LOCAL",O("particle_settings",Te,"b4w_coordinate_system")),"b4w_allow_nla"in Te||(Te.b4w_allow_nla=!0,O("particle_settings",Te,"b4w_allow_nla")),"b4w_enable_soft_particles"in Te||(Te.b4w_enable_soft_particles=!1,O("particle_settings",Te,"b4w_enable_soft_particles")),"b4w_particles_softness"in Te||(Te.b4w_particles_softness=1,O("particle_settings",Te,"b4w_particles_softness")),"billboard_tilt"in Te||(Te.billboard_tilt=0,O("particle_settings",Te,"billboard_tilt")),"billboard_tilt_random"in Te||(Te.billboard_tilt_random=0,O("particle_settings",Te,"billboard_tilt_random")),"use_rotations"in Te||(Te.use_rotations=!1,O("particle_settings",Te,"use_rotations"))}"constraints"in se||(se.constraints=[],O("object",se,"constraints"));for(var de=se.constraints,s=0;s<de.length;s++){var ue=de[s];"influence"in ue||(ue.influence=1),"axes"in ue||(ue.axes=[1,1,1])}for(var fe=se.modifiers,s=0;s<fe.length;s++)(function(t,_){switch(t.type){case"ARRAY":if(!("fit_type"in t))return N(t.type,_,e.b4w_filepath_blend),!1}return!0})(fe[s],se)||(fe.splice(s,1),s--);if("animation_data"in se||(se.animation_data={action:null,nla_tracks:[]},O("object",se,"animation_data")),se.animation_data){if("action"in se.animation_data){if(se.animation_data.action){var Pe=se.animation_data.action.fcurves;for(var Ae in Pe){var Se=Pe[Ae];for(var pe in Se){var Oe=Se[pe];"num_channels"in Oe||(Oe.num_channels=1,g('B4W Warning: no channels number in animation fcurve for "'+se.animation_data.action.name+'" action, reexport scene'))}}}}else se.animation_data.action=null,g("no action in animation data "+se.name);"nla_tracks"in se.animation_data||(se.animation_data.nla_tracks=[],g("no NLA in animation data "+se.name)),r(se.animation_data)}"b4w_collision_id"in se||(se.b4w_collision_id="",O("object",se,"b4w_collision_id")),"b4w_viewport_alignment"in se||(se.b4w_viewport_alignment=null,O("object",se,"b4w_viewport_alignment")),"pinverse_tsr"in se||(se.pinverse_tsr=null,O("object",se,"pinverse_tsr")),"b4w_cluster_data"in se||(se.b4w_cluster_data={cluster_id:-1,cluster_center:null},O("object",se,"b4w_cluster_data")),"pass_index"in se||(se.pass_index=0,O("object",se,"pass_index")),"b4w_custom_prop"in se||(O("object",se,"b4w_custom_prop"),se.b4w_custom_prop=null),I(se)&&g('negative scale for object "'+se.name+'", can lead to some errors'),R(se)||g("non-uniform scale for object "+se.name)}X&&F.error("Compatibility issues detected");for(var ve in H){var me=H[ve],Ne=ve.match(/.*?(?=>>|$)/i)[0];F.warn('Property "'+String(Ne)+'" is '+me.report_type+' for "'+me.type+'". To fix this, reexport '+e.b4w_filepath_blend)}},t.apply_mesh_modifiers=function(e){if(!b(e))return null;for(var t=M(e.data,e.data.name+"_MOD"),_=e.modifiers,r=0;r<_.length;r++){var a=_[r];switch(a.type){case"ARRAY":h(t,a);break;case"CURVE":Y(t,a)}o.N(t)}return t},t.assign_logic_nodes_object_params=function(e,t,_){function r(t,_){var r=t[0];if(t.length>1)for(var a=1;a<t.length;a++)r+="*"+t[a];for(var a=0;a<e.length;a++){var n=e[a];if(n.name==r)for(var o in _)n[o]=_[o]}}function a(e,t){for(var _ in e)r(e[_],t)}for(var n=_.b4w_logic_nodes,o=0;o<n.length;o++)for(var i=n[o],s=0;s<i.length;s++){var E=i[s],c={register1:"variable1",register2:"variable2",registerd:"variabled"};for(var l in c)l in E&&(E[c[l]]=E[l]);for(var T in E.variables)"boolean"!=typeof E.variables[T][0]&&(E.variables[T]=[!1,E.variables[T]]);["MATH","CONDJUMP","PAGEPARAM","REGSTORE"].indexOf(E.type)>=0&&("variable1"in E&&(E.variables.id0=[!1,E.variable1]),"variable2"in E&&(E.variables.id1=[!1,E.variable2]),"variabled"in E&&(E.variables.vd=[!1,E.variabled]));for(var d in E.links)d.startsWith("id")||delete E.links[d];var u=E.common_usage_names,f=E.variables;switch(E.type){case"SELECT":for(var P=0;P<e.length;P++){var A=e[P];A.name==E.object&&(A.b4w_selectable=!0)}E.bools||(E.bools={}),E.bools.not_wait||(E.bools.not_wait=!1),g('Logic nodes type "SELECT" is deprecated');break;case"SWITCH_SELECT":if(a(E.objects_paths,{b4w_selectable:!0}),E.links instanceof Array){g('Format of a "SWITCH_SELECT" node is outdated. It is recommended to reexport the scene "'+_.name+'"');var S={},p=0;for(P in E.objects_paths)S[P]=E.links[p],p++;E.links=S}break;case"SELECT_PLAY":g('Logic nodes type "SELECT_PLAY" is deprecated, node will be muted. To fix this, reexport the scene "'+_.name+'"'),E.mute=!0;break;case"SELECT_PLAY_ANIM":g('Logic nodes type "SELECT_PLAY_ANIM" is deprecated');break;case"SHOW":case"HIDE":E.bools||(E.bools={}),void 0===E.bools.ch&&(E.bools.ch=!1),E.bools.id0||a(E.objects_paths,{b4w_do_not_batch:!0});break;case"SET_SHADER_NODE_PARAM":case"INHERIT_MAT":a(E.objects_paths,{b4w_do_not_batch:!0});break;case"PLAY":_.b4w_use_nla=!0;break;case"MOVE_TO":a(E.objects_paths,{b4w_do_not_batch:!0});break;case"TRANSFORM_OBJECT":switch(a(E.objects_paths,{b4w_do_not_batch:!0}),u.space_type){case"WORLD":u.space_type=G.NST_WORLD;break;case"PARENT":u.space_type=G.NST_PARENT;break;case"LOCAL":u.space_type=G.NST_LOCAL}break;case"OUTLINE":a(E.objects_paths,{b4w_outlining:!0});break;case"CONDJUMP":if(E.condition&&(u.condition=E.condition),"cnd"in E.floats)u.condition=E.floats.cnd;else switch(u.condition){case"GEQUAL":u.condition=G.NC_GEQUAL;break;case"LEQUAL":u.condition=G.NC_LEQUAL;break;case"GREATER":u.condition=G.NC_GREATER;break;case"LESS":u.condition=G.NC_LESS;break;case"NOTEQUAL":u.condition=G.NC_NOTEQUAL;break;case"EQUAL":u.condition=G.NC_EQUAL}switch(void 0!=E.number1&&(E.input1=E.number1),void 0!=E.number2&&(E.input2=E.number2),E.bools||(E.bools={}),E.bools.str&&(u.variable_type="STRING"),u.variable_type){case"NUMBER":u.variable_type=G.NT_NUMBER;break;case"STRING":u.variable_type=G.NT_STRING;break;case"OBJECT":u.variable_type=G.NT_OBJECT}void 0===u.variable_type&&(u.variable_type=G.NT_NUMBER,E.floats.inp1=E.input1,E.floats.inp2=E.input2),void 0===f.id0&&(f.id0=f.v1,f.id1=f.v2);break;case"SEND_REQ":E.bools||(E.bools={}),E.strings||(E.strings={}),void 0===E.bools.ct&&(E.bools.ct=!1),void 0!=E.url&&(E.bools.url=!1,E.strings.url=E.url);break;case"MATH":switch(void 0!=E.number1&&(E.input1=E.number1),void 0!=E.number2&&(E.input2=E.number2),void 0!=E.input1&&(E.floats.inp1=E.input1),void 0!=E.input2&&(E.floats.inp2=E.input2),E.operation){case"DIV":E.operation=G.NMO_DIV;break;case"SUB":E.operation=G.NMO_SUB;break;case"MUL":E.operation=G.NMO_MUL;break;case"ADD":E.operation=G.NMO_ADD;break;case"RAND":E.operation=G.NMO_RAND;break;case"SIN":E.operation=G.NMO_SIN;break;case"COS":E.operation=G.NMO_COS;break;case"TAN":E.operation=G.NMO_TAN;break;case"ARCSIN":E.operation=G.NMO_ARCSIN;break;case"ARCCOS":E.operation=G.NMO_ARCCOS;break;case"ARCTAN":E.operation=G.NMO_ARCTAN;break;case"LOG":E.operation=G.NMO_LOG;break;case"MIN":E.operation=G.NMO_MIN;break;case"MAX":E.operation=G.NMO_MAX;break;case"ROUND":E.operation=G.NMO_ROUND;break;case"MOD":E.operation=G.NMO_MOD;break;case"ABS":E.operation=G.NMO_ABS}void 0===f.id0&&(f.id0=f.v1,f.id1=f.v2);break;case"REGSTORE":if(E.floats||(E.floats={}),E.strings||(E.strings={}),void 0!=E.number1&&(E.input1=E.number1),void 0!=E.input1)switch(typeof E.input1){case"number":E.floats.inp1=E.input1,u.variable_type="NUMBER";break;default:E.strings.inp1=E.input1,u.variable_type="STRING"}switch(u.variable_type){case"NUMBER":u.variable_type=G.NT_NUMBER;break;case"STRING":u.variable_type=G.NT_STRING;break;case"OBJECT":u.variable_type=G.NT_OBJECT,a(E.objects_paths,{b4w_do_not_batch:!0})}break;case"PAGEPARAM":E.bools||(E.bools={}),void 0===E.bools.hsh&&(E.bools.hsh=!1),E.floats||(E.floats={}),void 0===E.floats.ptp&&(E.floats.ptp=0);break;case"STOP_ANIM":case"PLAY_ANIM":if(E.bools||(E.bools={}),void 0===E.bools.env&&(E.bools.env=!1),void 0===E.bools.id0&&(E.bools.id0=!1),E.bools.id0||r(E.objects_paths.id0,{b4w_do_not_batch:!0}),"PLAY_ANIM"==E.type){var O=u.param_anim_behavior;O||(O="FINISH_STOP"),u.param_anim_behavior=k.anim_behavior_bpy_b4w(O)}break;case"STRING":switch(u.string_operation){case"JOIN":u.string_operation=G.NSO_JOIN;break;case"FIND":u.string_operation=G.NSO_FIND;break;case"REPLACE":u.string_operation=G.NSO_REPLACE;break;case"SPLIT":u.string_operation=G.NSO_SPLIT;break;case"COMPARE":u.string_operation=G.NSO_COMPARE}if("cnd"in E.floats)u.condition=E.floats.cnd;else switch(u.condition){case"GEQUAL":u.condition=G.NC_GEQUAL;break;case"LEQUAL":u.condition=G.NC_LEQUAL;break;case"GREATER":u.condition=G.NC_GREATER;break;case"LESS":u.condition=G.NC_LESS;break;case"NOTEQUAL":u.condition=G.NC_NOTEQUAL;break;case"EQUAL":u.condition=G.NC_EQUAL}break;case"REDIRECT":void 0!=E.url&&(E.bools.url=!1,E.strings.url=E.url);break;case"SET_CAMERA_MOVE_STYLE":switch(u.camera_move_style){case"STATIC":u.camera_move_style=G.NCMS_STATIC;break;case"TARGET":u.camera_move_style=G.NCMS_TARGET;break;case"EYE":u.camera_move_style=G.NCMS_EYE;break;case"HOVER":u.camera_move_style=G.NCMS_HOVER}break;case"ENTRYPOINT":E.bools||(E.bools={}),void 0===E.bools.js&&(E.bools.js=!1),E.bools.js&&(E.mute=!0);break;case"JS_CALLBACK":var v=u.js_cb_params;for(var l in v)switch(v[l]){case"OBJECT":v[l]=G.NCPT_OBJECT;break;case"VARIABLE":v[l]=G.NCPT_VARIABLE}}}}}var a=_(0),n=_(5),o=_(25),i=_(4),s=_(75),E=_(21),c=_(1),l=_(9),T=_(36),d=_(2),u=_(3),f=_(27),P=_(59),A=_(37),S=Object(a.a)("__reformer",r);t.a=S},function(e,t,_){"use strict";function r(e,t){function _(e,t,_){var a=[];for(var n in e)E._8(e[n])>1&&a.push([n,e[n]]);if(a.sort(function(e,t){var _=E._8(e[1]),r=E._8(t[1]);return r!=_?r-_:e<t?-1:t<e?1:0}),a.length){c.groupCollapsed(t+" "+_),c.log_raw("Property different variants (>1) | Property name");for(var o=0;o<a.length;o++)c.groupCollapsed(E._8(a[o][1]),a[o][0]),r(a[o][1]);c.groupEnd()}}function r(e){c.log_raw("Batches count for this property value | Property value");var t=[];for(var _ in e)t.push([_,e[_]]);t.sort(function(e,t){return t[1]!=e[1]?t[1]-e[1]:e[0]<t[0]?-1:t[0]<e[0]?1:0});for(var r=0;r<t.length;r++)c.log_raw(t[r][1],t[r][0]);c.groupEnd()}var a=Object(n.a)(e),c=Object(o.a)(e),l=Object(i.a)(e),T=Object(s.a)(e);t.print_batches_stat=function(){for(var e={},t=["bounds_local","bufs_data","id","attribute_setters","num_vertices","num_triangles","material_names","shader","bpy_tex_names"],r=0,n=0,o=l.get_scene_objs(T.get_main(),"MESH",l.DATA_ID_ALL),i=0;i<o.length;i++)for(var s=0;s<o[i].scenes_data.length;s++)for(var E=0;E<o[i].scenes_data[s].batches.length;E++){var d=a.clone_batch(o[i].scenes_data[s].batches[E]),u=d.shaders_info.vert+"/"+d.shaders_info.frag;d["shaders_info.directives"]=d.shaders_info.directives,d["shaders_info.node_elements"]=d.shaders_info.node_elements,delete d.shaders_info;for(var f=0;f<t.length;f++)delete d[t[f]];if(o[i].is_dynamic)n++;else{r++,d.type in e||(e[d.type]={}),u in e[d.type]||(e[d.type][u]={});for(var P in d){P in e[d.type][u]||(e[d.type][u][P]={});var A=JSON.stringify(d[P]);A in e[d.type][u][P]||(e[d.type][u][P][A]=0),e[d.type][u][P][A]++}}}c.group("Batches statistics:"),c.log_raw("STATIC/DYNAMIC count:",r+"/"+n),c.group("STATIC batches diversity:");for(var S in e)for(var u in e[S])_(e[S][u],S,u);c.groupEnd(),c.groupEnd()}}var a=_(0),n=_(16),o=_(1),i=_(12),s=_(10),E=_(2),c=Object(a.a)("__debug_batch",r);t.a=c},function(e,t,_){"use strict";function r(e,t){function _(e,t,_){var n=a.get_camera_angles(e,N)[0],o=r(e,n,t.left,t.right,g);return _*Math.min(1,o[0]/v,o[1]/v)}function r(e,t,_,r,n){var o=O.angle_wrap_0_2pi(t-_),i=Math.min(o,2*Math.PI-o),s=O.angle_wrap_0_2pi(r-t),E=Math.min(s,2*Math.PI-s);return(Math.abs(i)<m||2*Math.PI-Math.abs(i)<m)&&(i=0),(Math.abs(E)<m||2*Math.PI-Math.abs(E)<m)&&(E=0),a.is_eye_camera(e)?(n[0]=E,n[1]=i):(n[0]=i,n[1]=E),n}var a=Object(n.a)(e),u=Object(o.a)(e),f=Object(i.a)(e),P=Object(s.a)(e),A=Object(E.a)(e),S=Object(c.a)(e),p=Object(l.a)(e),O=Object(T.a)(e),v=.2,m=1e-6,N=new Float32Array(2),g=new Float32Array(2),R=new Float32Array(3),I=new Float32Array(3),b=new Float32Array(3),h=p.create(),Y=p.create(),L=p.create(),M={},x=!1,y=!1,U=!1,w=!1;t.track_to_target=function(e,t,_,r,n,o,i,s){if(!a.is_eye_camera(e))return void f.error("track_to_target(): Wrong camera object or camera move style");if(O.is_vector(t))var E=t;else{var E=R;S.get_object_center(t,!1,E)}_=_||1,r=r||2,n=n||1,o=o||1;var c=S.get_translation(e,I),l=d.subtract(E,c,b),T=a.get_camera_angles(e,N),P=a.get_camera_angles_dir(l,g),p=P[0]-T[0],v=P[1]-T[1],m=Math.acos(Math.cos(p)*Math.cos(v)),h=Math.abs(m/_),Y=d.length(l)*(1-1/r),L=function(e){return 6*e*(1-e)},M=A.get_timeline(),x=0,y=function(t,_,r){if(!a.is_eye_camera(t))return void U();if(1==r){var i=u.get_sensor_value(t,_,0)-M,E=u.get_sensor_value(t,_,1);if(i<h){var l=L(i/h),T=l*p*E/h,d=l*v*E/h;a.rotate_camera(e,T,d)}else if(i<h+n){0==x&&(a.rotate_camera(e,P[0],P[1],!0),x++);var l=L(i-h/n),f=l*Y*E/n;S.move_local(t,0,0,-f)}else if(i<h+n+o)x<=1&&(a.rotate_camera(e,P[0],P[1],!0),a.eye_set_look_at(e,c),S.move_local(t,0,0,-Y),s&&s(),x++);else if(i<h+n+o+n){x<=2&&(a.rotate_camera(e,P[0],P[1],!0),a.eye_set_look_at(e,c),S.move_local(t,0,0,-Y),x++);var l=L(i-h-n-o/n),f=l*Y*E/n;S.move_local(t,0,0,f)}else a.rotate_camera(e,P[0],P[1],!0),a.eye_set_look_at(e,c),U()}},U=function(){u.remove_sensor_manifold(e,"TRACK_TO_TARGET"),i&&i()},w=u.create_timeline_sensor(),C=u.create_elapsed_sensor();u.create_sensor_manifold(e,"TRACK_TO_TARGET",u.CT_CONTINUOUS,[w,C],null,y)},t.auto_rotate=function(e,t,n){function o(t){T=T||{},T.left=t.left,T.right=t.right,d=Math.min(v,O.angle_wrap_0_2pi(T.right-T.left)/2),A=_(l,T,e)}function i(e,t,_){if(1==_){var r=a.get_move_style(e);if(r==a.MS_STATIC)c();else if(r!=a.MS_TARGET_CONTROLS&&r!=a.MS_EYE_CONTROLS||!a.has_horizontal_rot_limits(e))T=null,E(e,t);else{var n=r==a.MS_EYE_CONTROLS?a.eye_get_horizontal_limits(e,M):a.target_get_horizontal_limits(e,M);null!==T&&n.left==T.left&&n.right==T.right||o(n),s(e,t)}}}function s(t,_){var n=u.get_sensor_value(t,_,0),o=a.get_camera_angles(t,N)[0],i=r(t,o,T.left,T.right,g);i[1]>d&&i[0]>d?A=O.sign(A)*e:i[1]<d?A-=Math.pow(e,2)/(2*v)*n:i[0]<d&&(A+=Math.pow(e,2)/(2*v)*n),a.rotate_camera(t,n*A,0)}function E(t,_){var r=u.get_sensor_value(t,_,0);a.rotate_camera(t,r*e,0)}function c(){u.remove_sensor_manifold(l,"AUTO_ROTATE"),u.remove_sensor_manifold(l,"DISABLE_AUTO_ROTATE"),t()}t=t||function(){};var l=P.get_active_camera();if(a.is_static_camera(l))return void f.error("auto_rotate(): Wrong camera move style");var T={},d=0,A=0;if(u.check_sensor_manifold(l,"AUTO_ROTATE"))c();else{var S=u.create_mouse_move_sensor("X"),p=u.create_mouse_move_sensor("Y"),m=u.create_mouse_click_sensor(),R=u.create_touch_move_sensor(),I=u.create_touch_zoom_sensor(),b=u.create_elapsed_sensor();if(n)var h=u.create_mouse_wheel_sensor();else var h=u.create_custom_sensor(0);var Y=function(e){return e[0]&&e[2]||e[1]&&e[2]||e[3]||e[4]||e[5]};u.create_sensor_manifold(l,"DISABLE_AUTO_ROTATE",u.CT_LEVEL,[S,p,m,R,I,h],Y,c),u.create_sensor_manifold(l,"AUTO_ROTATE",u.CT_CONTINUOUS,[b],function(e){return e[0]},i)}},t.is_auto_rotate=function(){var e=P.get_active_camera();return u.check_sensor_manifold(e,"AUTO_ROTATE")},t.check_auto_rotate=function(){var e=P.get_active_camera();return a.get_move_style(e)!=a.MS_STATIC},t.move_camera_to_point=function(e,t,_,r,n){if(a.get_move_style(e)!=a.MS_STATIC)return void f.error("move_camera_to_point(): wrong camera type");if(!x){if(!e)return void f.error("move_camera_to_point(): you must specify the camera object");if(!t)return void f.error("move_camera_to_point(): you must specify the point object");if(_=_||1,r=r||.01,O.is_vector(e))var o=e;else var o=S.get_tsr(e,h);if(O.is_vector(t))var i=t;else var i=S.get_tsr(t,Y);var s=d.distance(p.get_trans_view(o),p.get_trans_view(i)),E=s/_,c=O.quat_to_dir(p.get_quat_view(o),O.AXIS_MZ,R),l=O.quat_to_dir(p.get_quat_view(i),O.AXIS_MZ,I),T=Math.min(Math.abs(d.dot(c,l)),1),u=Math.acos(T),P=u/r,v=1e3*Math.max(E,P);x=!0;var m=A.animate(0,1,v,function(t){var _=p.interpolate(o,i,O.smooth_step(t),L);if(U)return A.clear_animation(m),U=!1,void(x=!1);S.set_tsr(e,_),1==t&&(x=!1,n&&n())})}},t.rotate_camera=function(e,t,_,r,n){function o(){y&&(y=!1,n&&n())}if(a.get_move_style(e)==a.MS_STATIC)return void f.error("rotate_camera(): not supported for STATIC cameras");if(!y){if(!e)return void f.error("rotate_camera(): you must specify the camera object");if(!t&&!_)return void f.error("rotate_camera(): you must specify the rotation angle");r=r||1e3,y=!0;var i=0,s=A.animate(0,t,r,function(_){if(w||_>=t)return w=!1,A.clear_animation(s),void o();a.rotate_camera(e,i-_,0),i=_}),E=0,c=A.animate(0,_,r,function(t){if(w||t>=_)return w=!1,A.clear_animation(c),void o();a.rotate_camera(e,0,E-t),E=t})}},t.stop_cam_moving=function(){U=!0},t.stop_cam_rotating=function(){w=!0},t.is_moving=function(){return x},t.is_rotating=function(){return y}}var a=_(0),n=_(33),o=_(24),i=_(1),s=_(29),E=_(68),c=_(40),l=_(80),T=_(26),d=_(3),u=Object(a.a)("camera_anim",r);t.a=u},function(e,t,_){"use strict";function r(e,t){function _(e,t,_){var r=$.get_active_camera();W.rotate_camera(r,t,_);var a=W.get_camera_angles_char(r,Ke);Z.set_character_rotation_h(e,a[0]),Z.set_character_vert_move_dir_angle(e,a[1])}function r(e,t,_,r){if(Math.abs(Le[0])>.01||Math.abs(Le[1])>.01){var a=J.get_sensor_value(e,t,0),n=ee.smooth(Le[0],0,a,p()),o=ee.smooth(Le[1],0,a,p());Le[0]-=n,Le[1]-=o,r(e,-n*xe,-o*xe)}}function a(e){Me=e}function p(){return me*Me}function O(e,t){var _=document.createElement("div");_.style.cssText="position: absolute;left: 10px;bottom: 70px;width: 53px;height: 53px;background-image: "+pe,_.setAttribute("id",Ae);var r=document.createElement("div");r.style.cssText="position: absolute;left: 10px;bottom: 10px;width: 53px;height: 53px;background-image: "+pe+"transform: rotate(180deg);transform-origin: center;",r.setAttribute("id",Se),t.appendChild(_),t.appendChild(r)}function v(e){return"function"==typeof(e.requestPointerLock||e.webkitRequestPointerLock||e.mozRequestPointerLock)}function m(e,t,_,r){var a=J.get_sensor_value(e,_,1),n=J.get_sensor_value(e,_,2),o=r*ge,i=Math.abs(n)<Ne?0:n,s=-i*o,E=Math.abs(a)<Ne?0:a,c=-E*o;s=ee.clamp(s,Re,Ie),W.rotate_camera(t,c,s);var l=W.get_camera_angles(t,Ke);Z.set_character_rotation_h(e,l[0]+Math.PI)}function N(e,t){J.check_sensor_manifolds(t,"FPS_PLOCK")&&J.remove_sensor_manifold(t,"FPS_PLOCK"),J.check_sensor_manifolds(null,"FPS_ACTIVATE_PLOCK")&&J.remove_sensor_manifold(null,"FPS_ACTIVATE_PLOCK"),J.check_sensor_manifolds(t,"FPS_CAM_ROT")&&J.remove_sensor_manifold(t,"FPS_CAM_ROT"),J.check_sensor_manifolds(null,"FPS_DRAG_PRESS")&&J.remove_sensor_manifold(null,"FPS_DRAG_PRESS"),J.check_sensor_manifolds(null,"FPS_DRAG_MOVE")&&J.remove_sensor_manifold(null,"FPS_DRAG_MOVE"),J.check_sensor_manifolds(t,"FPS_SMOOTH_DRAG")&&J.remove_sensor_manifold(t,"FPS_SMOOTH_DRAG")}function g(e,t){if(v(e)&&!te.detect_mobile()){var _=J.create_plock_mouse_sensor(e),a=we||J.create_plock_sensor(e);we=a;var n=function(e){return e[0]&&e[1]},o=function(e,t,_){if(_>0){var r=J.get_sensor_payload(e,t,0);De(e,-r.coords[0]*xe,-r.coords[1]*xe)}};J.create_sensor_manifold(t,"FPS_PLOCK",J.CT_CONTINUOUS,[_,a],n,o);var i=function(e){return e[0]},s=function(t,_,r){r>0?Ce.enable_cb&&Ce.enable_cb(e):Ce.disable_cb&&Ce.disable_cb(e)};J.create_sensor_manifold(null,"FPS_ACTIVATE_PLOCK",J.CT_TRIGGER,[a],i,s)}else{if(te.detect_mobile())var E=J.create_touch_move_sensor("XY",e),c=J.create_touch_click_sensor(e),l=Oe;else{var E=J.create_mouse_move_sensor("XY",e),c=J.create_mouse_click_sensor(e),l=ve,T=$.get_active_camera(),d=function(e,t,_){if(_>0){var r=J.get_sensor_value(e,t,0);m(e,T,t,r)}},u=function(e){return Math.abs(e[1])>Ne||Math.abs(e[2])>Ne},f=J.create_elapsed_sensor(),P=J.create_gamepad_axis_sensor(re.GMPD_AXIS_2),A=J.create_gamepad_axis_sensor(re.GMPD_AXIS_3);J.create_sensor_manifold(t,"FPS_CAM_ROT",J.CT_CONTINUOUS,[f,P,A],u,d)}var S=0,p=0,O=function(e){return e[0]},N=function(e,t,_){if(1==_){var r=J.get_sensor_payload(e,t,0),a=r.coords;S=a[0],p=a[1]}};J.create_sensor_manifold(null,"FPS_DRAG_PRESS",J.CT_SHOT,[c],O,N);var g=function(e){return e[0]&&e[1]},R=function(e,t,_){if(1==_){var r=J.get_sensor_payload(e,t,0),a=r.coords;Le[0]+=(a[0]-S)*l,Le[1]+=(a[1]-p)*l,S=a[0],p=a[1]}};J.create_sensor_manifold(null,"FPS_DRAG_MOVE",J.CT_CONTINUOUS,[E,c],g,R);var I=J.create_elapsed_sensor();J.create_sensor_manifold(t,"FPS_SMOOTH_DRAG",J.CT_CONTINUOUS,[I],null,r,De)}}function R(e,t){var _=$.get_active_camera();if(t){var r=ne.get_translation(_,Be),a=ne.get_translation(e,Xe);P.subtract(r,a,r),oe.append_stiff_trans(_,e,r)}var n=W.get_camera_angles_char(_,Ke);Z.set_character_rotation_h(e,n[0]),Z.set_character_vert_move_dir_angle(e,n[1])}function I(e,t){re.add_click_listener(e,function(){ae.request_fullscreen_hmd(e,function(){N(e,t),ie.enable_hmd(ie.HMD_ALL_AXES_MOUSE_NONE),b(t),He&&He()},function(){h(t),ie.disable_hmd(),g(e,t),je&&je()})})}function b(e){var t=J.create_elapsed_sensor(),_=$.get_active_camera(),r=function(e,t,r){var a=W.get_camera_angles_char(_,Ke)[0];Z.set_character_rotation_h(e,a)};J.create_sensor_manifold(e,"FPS_CHARECTER_VR_ROT",J.CT_CONTINUOUS,[t],null,r)}function h(e){J.remove_sensor_manifold(e,"FPS_CHARECTER_VR_ROT")}function Y(){var e=ie.check_browser_support()&&!te.detect_mobile(),t=re.get_device_by_type_element(re.DEVICE_HMD);return t&&(e=e&&re.get_value_param(t,re.HMD_WEBVR_TYPE)&re.HMD_WEBVR1),e}function L(e,t){Y()&&I(e,t),g(e,t)}function M(e,t,_,r){if(te.detect_mobile()){var a=e.parentElement?e.parentElement:e;O(t,a)}var n=k(t),o={left:0,right:0,forw:0,back:0},i=-1,s=r.move_dir_cd,E=function(){return!ke||(o.left=0,o.right=0,o.forw=0,o.back=0,!1)},c=function(e,t){var _=D(n).id;e||t||_==Pe?_==Te&&(i>0?G(n,ue):G(n,de)):G(n,Te)},l=function(e){if(E()){var r=o.forw+o.back;o.forw=e;var a=o.forw+o.back,n=o.left+o.right;Z.set_character_move_dir(t,a,n),_&&_(a,n),c(a,n),s&&r!=a&&s(a,n,0)}},T=function(e){if(E()){e=e>0?1:e,e=e<0?-1:e;var r=o.forw+o.back;o.back=-e;var a=o.forw+o.back,n=o.left+o.right;Z.set_character_move_dir(t,a,n),_&&_(a,n),c(a,n),s&&r!=a&&s(a,n,0)}},d=function(e){if(E()){D(n).id==Pe&&(e=0),e=e>0?1:e,e=e<0?-1:e;var r=o.left+o.right;o.right=-e;var a=o.forw+o.back,i=o.left+o.right;Z.set_character_move_dir(t,a,i),_&&_(a,i),c(a,i),s&&r!=i&&s(a,i,0)}},u=function(e){if(E()){D(n).id==Pe&&(e=0);var r=o.left+o.right;o.left=e;var a=o.forw+o.back,i=o.left+o.right;Z.set_character_move_dir(t,a,i),_&&_(a,i),c(a,i),s&&r!=i&&s(a,i,0)}},f=function(e){E()&&e>0&&(Z.character_jump(t),s&&s(o.forw+o.back,o.left+o.right,1))},P=function(e){i=e,Math.abs(o.forw+o.back)+Math.abs(o.left+o.right)?(e>0?G(n,ue):G(n,de),s&&s(o.forw+o.back,o.left+o.right,0)):G(n,Te)},A=function(e){if(e>0){var t=D(Ue).id;t==de||t==Te?G(n,fe):G(n,de)}},S=r.forward_sens_arr,p=r.backward_sens_arr,v=r.right_sens_arr,m=r.left_sens_arr,N=r.jump_sens_arr,g=r.run_sens_arr,R=r.fly_sens_arr;z(Ee,S,l),z(Ee,p,T),z(Ee,v,d),z(Ee,m,u),z(Ee,N,f),z(le,[re.GMPD_AXIS_0],d),z(le,[re.GMPD_AXIS_1],T),z(Ee,g,P),z(Ee,R,A)}function x(){return Ue||(Ue={nodes:[],current_node:null,lock:!1,last_state:null}),Ue}function y(e,t,_,r,a,n){e.nodes.push({id:t,allowed_ids:_,call_switch:r,call_before_switch:a,call_after_switch:n})}function U(e){for(var t=[],_=0;_<e.nodes;_++){var r=e.nodes[_].id;if(t.indexOf(r)>=0)return!1;t.push(r)}for(var _=0;_<e.nodes;_++)for(var a=e.nodes[_],n=0;n<a.allowed_ids.length;n++)if(t.indexOf(a.allowed_ids[n])<0)return!1;return!0}function w(e,t){for(var _=null,r=0;r<e.nodes.length;r++)if(e.nodes[r].id==t){_=e.nodes[r];break}return _}function C(e,t){var _=w(e,t);return e.current_node=_,_}function D(e){return e.current_node}function F(e,t,_){w(e,t).call_after_switch=_}function G(e,t){if(e.last_state=t,e.lock)return!1;var _=D(e),r=_.id;if(_.allowed_ids.indexOf(t)>=0){var a=!0;if(_.call_before_switch&&(a=_.call_before_switch(r,t)),a)return C(e,t),_.call_switch&&_.call_switch(r,t),_.call_after_switch&&_.call_after_switch(r,t),!0}return!1}function k(e){var t=x(),_=function(t,_){switch(_){case Te:case de:Z.set_character_move_type(e,Z.CM_WALK);break;case ue:Z.set_character_move_type(e,Z.CM_RUN);break;case fe:Z.set_character_move_type(e,Z.CM_FLY);break;case Pe:Z.set_character_move_type(e,Z.CM_CLIMB)}};return y(t,Te,[de,fe,ue,Pe],_,null,null),y(t,de,[ue,fe,Pe,Te],_,null,null),y(t,ue,[de,fe,Pe,Te],_,null,null),y(t,fe,[de],_,null,null),y(t,Pe,[de,ue,Te],_,null,null),U(t),C(t,Te),Ue}function K(){for(var e=0;e<ye;e++)J.remove_sensor_manifold(null,"FPS_USER_CONTROL_ACTION_"+e.toString())}function B(e,t){v(t)&&!te.detect_mobile()&&(Ce.disable_cb&&Ce.disable_cb(t),J.remove_sensor_manifold(e,"FPS_PLOCK"),J.remove_sensor_manifold(null,"FPS_ACTIVATE_PLOCK"))}function X(e,t){v(t)&&!te.detect_mobile()||(J.remove_sensor_manifold(e,"FPS_CAM_ROT"),J.remove_sensor_manifold(e,"FPS_DRAG_PRESS"),J.remove_sensor_manifold(e,"FPS_DRAG_MOVE"),J.remove_sensor_manifold(e,"FPS_SMOOTH_DRAG"))}function H(e){Y()&&J.remove_sensor_manifold(e,"FPS_CHARECTER_VR_ROT")}function j(e,t){if(te.detect_mobile()){var _=document.getElementById(Ae),r=document.getElementById(Se);_&&t.removeChild(_),r&&t.removeChild(r)}}function Q(e){Fe=e}function z(e,t,_){if(t.length){for(var r=[],a=0;a<t.length;a++)if("number"==typeof t[a])t[a]<he?r.push(J.create_keyboard_sensor(t[a])):t[a]<Ye?r.push(J.create_gamepad_btn_sensor(t[a],Fe)):r.push(J.create_gamepad_axis_sensor(t[a]));else if("string"==typeof t[a]){var n=document.getElementById(t[a]);n?r.push(J.create_touch_click_sensor(n)):se.error("Couldn't find element with "+t[a]+" ID.")}var o=function(e){return!1},i=J.CT_SHOT,s=function(e,t,_,r){};switch(e){case Ee:i=J.CT_TRIGGER,o=function(e){for(var t=0;t<e.length;t++)if(e[t])return!0;return!1},s=function(e,t,r,a){_(r>0?1:0)};break;case ce:i=J.CT_TRIGGER,o=function(e){for(var t=0;t<e.length;t++)if(e[t])return!0;return!1},s=function(e,t,r,a){_(r<0?1:0)};break;case le:i=J.CT_CONTINUOUS,o=function(e){for(var t=0;t<e.length;t++)if(Math.abs(e[t])>Ne)return!0;return!1},s=function(e,t,r,a){if(r>0)for(var n=0;n<a;n++){var o=J.get_sensor_value(e,t,n);if(Math.abs(o)>Ne)return void _(o)}else _(0)}}var E="FPS_USER_CONTROL_ACTION_"+ye.toString(),c=r.length;J.create_sensor_manifold(null,E,i,r,o,s,c),ye++}}function V(e){xe=e/be}function q(){return xe*be}var W=Object(n.a)(e),J=Object(o.a)(e),Z=Object(i.a)(e),$=Object(s.a)(e),ee=Object(E.a)(e),te=Object(c.a)(e),_e=Object(l.a)(e),re=Object(T.a)(e),ae=Object(d.a)(e),ne=Object(u.a)(e),oe=Object(f.a)(e),ie=Object(A.a)(e),se=Object(S.a)(e),Ee=1,ce=2,le=3,Te=0,de=1,ue=2,fe=3,Pe=4,Ae="B4W_DEFAULT_BTN_1",Se="B4W_DEFAULT_BTN_2",pe="url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyBpZD0ic3ZnMzQwMCIgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQuMTExbW0iIHdpZHRoPSIxNC4xMTFtbSIgdmVyc2lvbj0iMS4xIiB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHZpZXdCb3g9IjAgMCA0OS45OTk5OTggNDkuOTk5OTk5Ij4gPG1ldGFkYXRhIGlkPSJtZXRhZGF0YTM0MDUiPjxyZGY6UkRGPjxjYzpXb3JrIHJkZjphYm91dD0iIj48ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD48ZGM6dHlwZSByZGY6cmVzb3VyY2U9Imh0dHA6Ly9wdXJsLm9yZy9kYy9kY21pdHlwZS9TdGlsbEltYWdlIi8+PGRjOnRpdGxlLz48L2NjOldvcms+PC9yZGY6UkRGPiA8L21ldGFkYXRhPiA8ZyBpZD0ibGF5ZXIxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIC0xMDAyLjQpIj48cmVjdCBpZD0icmVjdDI0MTI2IiBvcGFjaXR5PSIwLjU0MyIgZmlsbC1vcGFjaXR5PSIuODM2MTEiIGhlaWdodD0iNTAiIHdpZHRoPSI1MCIgeT0iMTAwMi40IiB4PSIwIiBmaWxsPSIjZmZmIi8+PHBhdGggaWQ9InBhdGgyNDEyOCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZD0ibTM5LjE0MiAxMDMzLjUtMTQuMTQyLTE0LjE0Mi0xNC4xNDIgMTQuMTQyIiBzdHJva2U9IiM2ZTZlNmUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBmaWxsPSJub25lIi8+IDwvZz48L3N2Zz4=);",Oe=4,ve=2,me=.2,Ne=.05,ge=2.5,Re=(.1-Math.PI)/2,Ie=(Math.PI-.1)/2,be=2e5,he=300,Ye=326,Le=new Float32Array(2),Me=1,xe=4e-4,ye=0,Ue=null,we=null,Ce={enable_cb:null,disable_cb:null},De=function(){},Fe=0,Ge=4,ke=!1,Ke=new Float32Array(2),Be=new Float32Array(3),Xe=new Float32Array(3),He=null,je=null;t.append_switch_vr_cbs=function(e,t){He=e,je=je},t.CS_STAY=Te,t.CS_WALK=de,t.CS_RUN=ue,t.CS_FLY=fe,t.CS_CLIMB=Pe,t.AT_PRESSED=Ee,t.AT_RELEASED=ce,t.AT_CONTINUOUS=le,t.bind_action=z,t.enable_fps_controls=function(e){e=e||{lock_camera:!0};var t=e.character||$.get_first_character();if(t){var r=e.element||_e.get_canvas(),a=e.motion_cb||null;Q(e.gamepad_id||0);var n=e.forward_sens||[J.KEY_W,re.GMPD_BUTTON_12],o=e.backward_sens||[J.KEY_S,re.GMPD_BUTTON_13],i=e.right_sens||[J.KEY_D,re.GMPD_BUTTON_15],s=e.left_sens||[J.KEY_A,re.GMPD_BUTTON_14],E=e.jump_sens||[J.KEY_SPACE,re.GMPD_BUTTON_1],c=e.run_sens||[J.KEY_SHIFT,re.GMPD_BUTTON_7],l=e.fly_sens||[];te.detect_mobile()&&(n.push(Ae),o.push(Se));var T=e.move_dir_cd||null,d={forward_sens_arr:n,backward_sens_arr:o,right_sens_arr:i,left_sens_arr:s,jump_sens_arr:E,run_sens_arr:c,fly_sens_arr:l,move_dir_cd:T};De=e.rotation_cb||_;R(t,void 0===e.lock_camera||e.lock_camera),L(r,t),M(r,t,a,d)}},t.disable_fps_controls=function(e,t){e=e||$.get_first_character(),t=t||_e.get_container(),e&&(K(),B(e,t),X(e,t),H(e),j(e,t))},t.set_state_change_cb=function(e,t){F(Ue,e,t)},t.set_cam_smooth_factor=function(e){J.set_plock_smooth_factor(e),a(e)},t.get_cam_smooth_factor=function(){return Me},t.set_cam_sensitivity=V,t.get_cam_sensitivity=q,t.set_plock_enable_cb=function(e){Ce.enable_cb=e},t.set_plock_disable_cb=function(e){Ce.disable_cb=e},t.get_character_state=function(){return D(Ue).id},t.add_new_state=function(){return Ge++},t.add_state=function(e,t,_){var r=x();y(r,e,t,_,null,null),U(r)||se.error("Incorrect state machine.")},t.switch_state=function(e){G(x(),e)},t.lock_character=function(){x().lock=!0},t.unlock_character=function(){x().lock=!1},t.is_character_locked=function(){return x().lock},t.set_rotation_cb=function(e){De=e||_},t.freeze_movements=function(){ke=!0},t.unfreeze_movements=function(){ke=!1}}var a=_(0),n=_(33),o=_(24),i=_(54),s=_(29),E=_(26),c=_(60),l=_(39),T=_(49),d=_(50),u=_(40),f=_(67),P=_(3),A=_(81),S=_(1),p=Object(a.a)("fps",r);t.a=p},function(e,t,_){"use strict";function r(e,t){function _(e,t,_,r){var a=I.get_sensor_value(t,_,r)*D,n=I.get_sensor_value(t,_,r+1)*D;e.style.transform="translate3d("+a+"px, "+n+"px, 0px) rotate(0rad)"}function r(e,t,_){if(!(_+1>2*Ne.length)){var r=I.get_sensor_value(e,t,_),a=I.get_sensor_value(e,t,_+1);if(Re[_]>-2){var n=r-Re[_],o=a-Re[_+1],i=Ne[Math.floor(_/2)],s=i.getAttribute("data-svgid");if(de==G)i.style.backgroundImage=n||o?Y+btoa(ce[s].replace(y,x))+"')":Y+btoa(ce[s])+"')";else if(de==K){var E=b.get_moved_gmpd_axis(le);if(E>=0){E%2!=0&&E--,de=G,i.style.backgroundImage=Y+btoa(ce[s])+"')";var c=parseFloat(Te.getAttribute("data-key"));b.set_gamepad_key(le,c,E),b.set_gamepad_key(le,c+1,E+1),Te=null,document.getElementById("action_label").textContent=U}}}Re[_]=r,Re[_+1]=a}}function a(e,t,_){if(!(_>=Ne.length)){var r=I.get_sensor_value(e,t,_);if(Re[_]>-2){var a=r-Re[_],n=Ne[_],o=n.getAttribute("data-svgid");if(de==G)n.style.backgroundImage=a?Y+btoa(ce[o].replace(y,x))+"')":Y+btoa(ce[o])+"')";else if(de==K){var i=b.get_moved_gmpd_axis(le);if(i>=0){de=G,n.style.backgroundImage=Y+btoa(ce[o])+"')";var s=parseFloat(Te.getAttribute("data-key"));b.set_gamepad_key(le,s,i),Te=null,document.getElementById("action_label").textContent=U}}}Re[_]=r}}function E(e,t,_){if(de==G){if(t&&"B"==e.getAttribute("data-colorstate")){var r=ce[_];e.style.backgroundImage=Y+btoa(r.replace(L,x))+"')",e.setAttribute("data-colorstate","G")}if(!t&&"B"!=e.getAttribute("data-colorstate")){var r=ce[_];e.style.backgroundImage=Y+btoa(r)+"')",e.setAttribute("data-colorstate","B")}}else{var a=b.get_pressed_gmpd_btn(le);if(a>=0&&Te&&de==k){var n=Te.getAttribute("data-key");b.set_gamepad_key(le,n,a),l(n,a),Te=null,document.getElementById("action_label").textContent=U,de=G}}}function c(){Oe.length=0;for(var e=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],t=0;t<e.length;t++)e[t]&&Oe.push(e[t]);return Oe}function l(e,t){var _=h.get(le+"_gmpd_stngs","b4w")||"{}",r=JSON.parse(_);r[e]=t,h.set(le+"_gmpd_stngs",JSON.stringify(r),"b4w")}function T(e){var t=JSON.stringify(F);h.set(e+"_gmpd_stngs",t,"b4w")}function d(e,t){for(var _ in e)b.set_gamepad_key(t,_,e[_])}function u(e){var t=h.get(e+"_gmpd_stngs","b4w");t?d(JSON.parse(t),e):T(e)}function f(e){ge=!0;var t=document.createElement("div"),_=document.createElement("div"),r=document.createElement("div"),a=document.createElement("div"),n=document.createElement("div"),o=document.createElement("div"),i=document.createElement("div"),s=document.createElement("div"),E=document.createElement("div"),c=document.createElement("div"),l=document.createElement("div"),T=document.createElement("div"),d=document.createElement("div"),u=document.createElement("div"),f=document.createElement("div"),P=document.createElement("div"),A=document.createElement("div"),S=document.createElement("div"),p=document.createElement("div"),O=document.createElement("div"),v=document.createElement("div"),N=document.createElement("div");fe=t,t.style.cssText="position: absolute;height: auto;background-image: "+Y+btoa(B)+"');width: 637px;height: 455px;background-size: 100% 100%;left: 50%;margin-bottom: 40px;-moz-transform: translateX(-50%);-ms-transform: translateX(-50%);-webkit-transform: translateX(-50%);bottom: 0px;",_.style.cssText="background-image: "+Y+btoa(X)+"');position: absolute;top: 47px;left: 65px;width: 135px;height: 135px;",r.style.cssText="background-image: "+Y+btoa(H)+"');width: 36px;height: 38px;left: 49px;top: 8px;position: absolute;",a.style.cssText="background-image: "+Y+btoa(j)+"');width: 38px;height: 36px;top: 47px;left: 84px;position: absolute;",n.style.cssText="background-image: "+Y+btoa(Q)+"');width: 36px;height: 38px;bottom: 11px;left: 51px;position: absolute;",o.style.cssText="background-image: "+Y+btoa(z)+"');width: 38px;height: 36px;top: 47px;left: 13px;position: absolute;",i.style.cssText="position: absolute;top: 55px;left: 434px;width: 150px;height: 150px;",s.style.cssText="background-image: "+Y+btoa(V)+"');width: 50px;height: 50px;left: 53px;top: 0px;position: absolute;",E.style.cssText="background-image: "+Y+btoa(V)+"');width: 50px;height: 50px;left: 107px;top: 51px;position: absolute;",c.style.cssText="background-image: "+Y+btoa(V)+"');width: 50px;height: 50px;left: 53px;bottom: 0px;position: absolute;",l.style.cssText="background-image: "+Y+btoa(V)+"');width: 50px;height: 50px;top: 51px;position: absolute;",T.style.cssText="background-image: "+Y+btoa(q)+"');position: absolute;top: 222px;left: 183px;width: 85px;height: 85px;",d.style.cssText="background-image: "+Y+btoa(q)+"');position: absolute;top: 223px;left: 376px;width: 85px;height: 85px;",u.style.cssText="background-image: "+Y+btoa(W)+"');position: absolute;top: 76px;left: 227px;width: 34px;height: 34px;",f.style.cssText="background-image: "+Y+btoa(W)+"');position: absolute;top: 76px;left: 376px;width: 34px;height: 34px;",P.style.cssText="background-image: "+Y+btoa(Z)+"');position: absolute;top: 4px;left: 78px;width: 79px;height: 33px;",A.style.cssText="background-image: "+Y+btoa($)+"');position: absolute;top: 4px;left: 477px;width: 79px;height: 33px;",S.style.cssText="background-image: "+Y+btoa(J)+"');position: absolute;top: -7px;left: 425px;width: 50px;height: 17px;",p.style.cssText="background-image: "+Y+btoa(J)+"');position: absolute;top: -7px;left: 164px;width: 50px;height: 17px;",O.style.cssText="background-image: "+Y+btoa(ee)+"');position: absolute;top: 68px;left: 274px;width: 92px;height: 92px;",v.style.cssText="background-image: "+Y+btoa(te)+"');position: absolute;top: 186px;left: 148px;width: 157px;height: 157px;",N.style.cssText="background-image: "+Y+btoa(te)+"');position: absolute;top: 187px;left: 339px;width: 157px;height: 157px;",t.appendChild(v),t.appendChild(N),_.appendChild(r),_.appendChild(a),_.appendChild(n),_.appendChild(o),t.appendChild(_),i.appendChild(s),i.appendChild(E),i.appendChild(c),i.appendChild(l),t.appendChild(i),t.appendChild(T),t.appendChild(d),t.appendChild(u),t.appendChild(f),t.appendChild(P),t.appendChild(A),t.appendChild(S),e.appendChild(t),t.appendChild(p),t.appendChild(O),ve.length=0,ce.length=0,me.length=0,Ne.length=0,ve.push(c,E,l,s,P,A,p,S,u,f,T,d,r,n,o,a,O),ce.push(V,V,V,V,Z,$,J,J,W,W,q,q,H,Q,z,j,ee),me.push(T,T,d,d),Ne.push(v,N);for(var g=0;g<ve.length;g++)ve[g].setAttribute("id","pad_btn_"+g),ve[g].setAttribute("data-colorstate","B"),ve[g].setAttribute("data-key",g),ve[g].setAttribute("data-svgid",g);v.setAttribute("id","pad_left_axis"),v.setAttribute("data-colorstate","GR"),v.setAttribute("data-key",b.GMPD_AXIS_0),v.setAttribute("data-svgid",ce.length),N.setAttribute("id","pad_right_axis"),N.setAttribute("data-colorstate","GR"),N.setAttribute("data-key",b.GMPD_AXIS_2),N.setAttribute("data-svgid",ce.length+1),ce.push(te,te),m(ve,L),m(Ne,y)}function P(e){ge=!1;var t=document.createElement("div"),_=document.createElement("div"),r=document.createElement("div"),a=document.createElement("div"),n=document.createElement("div"),o=document.createElement("div"),i=document.createElement("div"),s=document.createElement("div"),E=document.createElement("div"),c=document.createElement("div"),l=document.createElement("div"),T=document.createElement("div"),d=document.createElement("div"),u=document.createElement("div"),f=document.createElement("div"),P=document.createElement("div"),A=document.createElement("div"),S=document.createElement("div"),p=document.createElement("div"),O=document.createElement("div"),v=document.createElement("div"),N=document.createElement("div"),g=document.createElement("div"),R=document.createElement("div"),I=document.createElement("div"),h=document.createElement("div"),M=document.createElement("div"),x=document.createElement("div"),U=document.createElement("div"),w=document.createElement("div");fe=t;var C="position: absolute;height: auto;background-image: "+Y+btoa(re)+"');width: 19px;height: 19px;background-size: 100% 100%;";t.style.cssText="position: absolute;background-image: "+Y+btoa(_e)+"');width: 397px;height: 455px;-moz-transform: translateX(-50%);-ms-transform: translateX(-50%);-webkit-transform: translateX(-50%);transform: translateX(-50%);background-size: 100% 100%;left: 50%;margin-left: 25px;margin-bottom: 40px;bottom: 0px;",_.style.cssText=C+"top: 132px;left: 331px;",r.style.cssText=C+"top: 122px;left: 315px;",a.style.cssText=C+"top: 122px;left: 347px;",n.style.cssText=C+"top: 113px;left: 331px;",o.style.cssText="position: absolute;height: auto;background-image: "+Y+btoa(ae)+"');width: 54px;height: 37px;background-size: 100% 100%;top: 84px;left: 166px;",i.style.cssText="position: absolute;height: auto;background-image: "+Y+btoa(ne)+"');width: 54px;height: 37px;background-size: 100% 100%;top: 84px;left: 36px;",s.style.cssText=C+"top: 107px;left: 141px;",E.style.cssText=C+"top: 107px;left: 90px;",c.style.cssText=C+"top: 185px;left: 321px;",l.style.cssText=C+"top: 185px;left: 340px;",T.style.cssText=C+"top: 179px;left: 358px;",d.style.cssText=C+"top: 178px;left: 303px;",u.style.cssText=C+"top: 210px;left: 299px;",f.style.cssText=C+"top: 279px;left: 299px;",P.style.cssText=C+"top: 210px;left: 321px;",A.style.cssText=C+"top: 279px;left: 321px;",S.style.cssText=C+"top: 210px;left: 344px;",p.style.cssText=C+"top: 278px;left: 344px;",O.style.cssText=C+"top: 124px;left: 147px;",v.style.cssText=C+"top: 138px;left: 133px;",N.style.cssText=C+"top: 124px;left: 82px;",g.style.cssText=C+"top: 138px;left: 96px;",R.style.cssText=C+"top: 278px;left: 367px;";var D="position: absolute;background-image: "+Y+btoa(oe)+"');width: 19px;height: 46px;background-size: 100% 100%;";I.style.cssText=D+"top: 291px;left: 50px;",h.style.cssText=D+"top: 291px;left: 111px;",M.style.cssText=D+"top: 291px;left: 171px;",x.style.cssText="position: absolute;background-image: "+Y+btoa(ie)+"');width: 297px;height: 179px;background-size: 100% 100%;top: 43px;left: -25px;",U.style.cssText="position: absolute;background-image: "+Y+btoa(se)+"');width: 33px;height: 10px;background-size: 100% 100%;top: 159px;left: 324px;",w.style.cssText="position: absolute;background-image: "+Y+btoa(Ee)+"');width: 10px;height: 33px;background-size: 100% 100%;top: 148px;left: 335px;",e.appendChild(t),t.appendChild(I),t.appendChild(h),t.appendChild(M),t.appendChild(x),t.appendChild(U),t.appendChild(w),t.appendChild(_),t.appendChild(r),t.appendChild(a),t.appendChild(n),t.appendChild(o),t.appendChild(i),t.appendChild(s),t.appendChild(E),t.appendChild(c),t.appendChild(l),t.appendChild(T),t.appendChild(d),t.appendChild(u),t.appendChild(f),t.appendChild(P),t.appendChild(A),t.appendChild(S),t.appendChild(p),t.appendChild(O),t.appendChild(v),t.appendChild(N),t.appendChild(g),t.appendChild(R),ve.length=0,ce.length=0,me.length=0,Ne.length=0,ve.push(_,r,a,n,o,i,s,E,c,l,T,d,u,f,P,A,S,p,O,v,N,g,R),ce.push(re,re,re,re,ae,ne,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re),Ne.push(x,I,M,h,U,w);for(var F=0;F<ve.length;F++)ve[F].setAttribute("id","wheel_btn_"+F),ve[F].setAttribute("data-colorstate","B"),ve[F].setAttribute("data-key",F),ve[F].setAttribute("data-svgid",F);for(var F=0;F<Ne.length;F++)ve[F].setAttribute("id","wheel_axis_"+F),ve[F].setAttribute("data-colorstate","GR");x.setAttribute("data-key",b.GMPD_AXIS_0),x.setAttribute("data-svgid",ce.length),I.setAttribute("data-key",b.GMPD_AXIS_1),I.setAttribute("data-svgid",ce.length+1),M.setAttribute("data-key",b.GMPD_AXIS_2),M.setAttribute("data-svgid",ce.length+2),h.setAttribute("data-key",b.GMPD_AXIS_3),h.setAttribute("data-svgid",ce.length+3),U.setAttribute("data-key",b.GMPD_AXIS_4),U.setAttribute("data-svgid",ce.length+4),w.setAttribute("data-key",b.GMPD_AXIS_5),w.setAttribute("data-svgid",ce.length+5),ce.push(ie,oe,oe,oe,se,Ee),m(ve,L),m(Ne,y)}function A(e){return[I.create_gamepad_btn_sensor(b.GMPD_BUTTON_0,e),I.create_gamepad_btn_sensor(b.GMPD_BUTTON_1,e),I.create_gamepad_btn_sensor(b.GMPD_BUTTON_2,e),I.create_gamepad_btn_sensor(b.GMPD_BUTTON_3,e),I.create_gamepad_btn_sensor(b.GMPD_BUTTON_4,e),I.create_gamepad_btn_sensor(b.GMPD_BUTTON_5,e),I.create_gamepad_btn_sensor(b.GMPD_BUTTON_6,e),I.create_gamepad_btn_sensor(b.GMPD_BUTTON_7,e),I.create_gamepad_btn_sensor(b.GMPD_BUTTON_8,e),I.create_gamepad_btn_sensor(b.GMPD_BUTTON_9,e),I.create_gamepad_btn_sensor(b.GMPD_BUTTON_10,e),I.create_gamepad_btn_sensor(b.GMPD_BUTTON_11,e),I.create_gamepad_btn_sensor(b.GMPD_BUTTON_12,e),I.create_gamepad_btn_sensor(b.GMPD_BUTTON_13,e),I.create_gamepad_btn_sensor(b.GMPD_BUTTON_14,e),I.create_gamepad_btn_sensor(b.GMPD_BUTTON_15,e),I.create_gamepad_btn_sensor(b.GMPD_BUTTON_16,e),I.create_gamepad_btn_sensor(b.GMPD_BUTTON_17,e),I.create_gamepad_btn_sensor(b.GMPD_BUTTON_18,e),I.create_gamepad_btn_sensor(b.GMPD_BUTTON_19,e),I.create_gamepad_btn_sensor(b.GMPD_BUTTON_20,e),I.create_gamepad_btn_sensor(b.GMPD_BUTTON_21,e),I.create_gamepad_btn_sensor(b.GMPD_BUTTON_22,e),I.create_gamepad_btn_sensor(b.GMPD_BUTTON_23,e),I.create_gamepad_btn_sensor(b.GMPD_BUTTON_24,e),I.create_gamepad_btn_sensor(b.GMPD_BUTTON_25,e)]}function S(e){return[I.create_gamepad_axis_sensor(b.GMPD_AXIS_0,e),I.create_gamepad_axis_sensor(b.GMPD_AXIS_1,e),I.create_gamepad_axis_sensor(b.GMPD_AXIS_2,e),I.create_gamepad_axis_sensor(b.GMPD_AXIS_3,e),I.create_gamepad_axis_sensor(b.GMPD_AXIS_4,e),I.create_gamepad_axis_sensor(b.GMPD_AXIS_5,e),I.create_gamepad_axis_sensor(b.GMPD_AXIS_6,e),I.create_gamepad_axis_sensor(b.GMPD_AXIS_7,e),I.create_gamepad_axis_sensor(b.GMPD_AXIS_8,e),I.create_gamepad_axis_sensor(b.GMPD_AXIS_9,e),I.create_gamepad_axis_sensor(b.GMPD_AXIS_10,e),I.create_gamepad_axis_sensor(b.GMPD_AXIS_11,e)]}function p(e,t){var _=document.createElement("input");_.style.cssText="display: inline-block;position = relative;",_.setAttribute("type","radio"),_.setAttribute("name","choice");var r=document.createElement("label");return r.textContent=t,r.style.cssText="position = relative;display: inline-block;color: white;",e.appendChild(_),e.appendChild(r),_}function O(){ue.removeChild(fe),fe=null}function v(e){switch(O(),e){case"PAD":Se.checked=!0,f(ue);break;case"WHEEL":Ae.checked=!0,P(ue)}}function m(e,t){for(var _=function(e){var _=e.target;if(!(le<0||"G"==_.getAttribute("data-colorstate")))if(de!=G){if("R"==_.getAttribute("data-colorstate")&&(Te=null,document.getElementById("action_label").textContent=U,de=G),"B"==_.getAttribute("data-colorstate")||"GR"==_.getAttribute("data-colorstate")){var r=parseFloat(Te.getAttribute("data-svgid"));Te.style.backgroundImage=Y+btoa(ce[r])+"')",Te.setAttribute("data-colorstate",_.getAttribute("data-colorstate")),Te=_,r=parseFloat(_.getAttribute("data-svgid")),_.style.backgroundImage=Y+btoa(ce[r].replace(t,M))+"')",_.setAttribute("data-colorstate","R")}}else{var r=parseFloat(_.getAttribute("data-svgid")),a="B"==_.getAttribute("data-colorstate")?k:K;de=a,_.style.backgroundImage=Y+btoa(ce[r].replace(t,M))+"')",_.setAttribute("data-colorstate","R"),document.getElementById("action_label").textContent=a==k?w:C,Te=_}},r=0;r<e.length;r++){var a=e[r];b.add_click_listener(a,_)}}function N(e){var t=document.createElement("label");return t.style.cssText="position: relative;display: inline-block;width: 50px;color: white;margin: 0 10px;font-size: 36px;line-height: 50px;background-color: black;border: 3px solid white;border-radius: 5px;height: 50px;",t.textContent=e,t}function g(){var e=window.innerWidth,t=window.innerHeight;ue.style.zoom=t<=750&&t>400||e<=750&&e>400?"0.5":e<=400||t<=400?"0.3":"1"}var R=Object(n.a)(e),I=Object(o.a)(e),b=Object(i.a)(e),h=Object(s.a)(e),Y="url('data:image/svg+xml;base64,",L=new RegExp("#5276cf","g"),M="#ff0000",x="#00ff00",y="#e6e6e6",U="Click on the buttons & arrows to setup your controller",w="Now press the button on the device",C="Now move the axis on the device",D=20,F={};F[b.GMPD_BUTTON_12]=b.GMPD_BUTTON_12,F[b.GMPD_BUTTON_13]=b.GMPD_BUTTON_13,F[b.GMPD_BUTTON_15]=b.GMPD_BUTTON_15,F[b.GMPD_BUTTON_14]=b.GMPD_BUTTON_14,F[b.GMPD_BUTTON_3]=b.GMPD_BUTTON_3,F[b.GMPD_BUTTON_0]=b.GMPD_BUTTON_0,F[b.GMPD_BUTTON_1]=b.GMPD_BUTTON_1,F[b.GMPD_BUTTON_2]=b.GMPD_BUTTON_2,F[b.GMPD_BUTTON_5]=b.GMPD_BUTTON_5,F[b.GMPD_BUTTON_7]=b.GMPD_BUTTON_7,F[b.GMPD_BUTTON_4]=b.GMPD_BUTTON_4,F[b.GMPD_BUTTON_6]=b.GMPD_BUTTON_6,F[b.GMPD_BUTTON_8]=b.GMPD_BUTTON_8,F[b.GMPD_BUTTON_9]=b.GMPD_BUTTON_9,F[b.GMPD_BUTTON_10]=b.GMPD_BUTTON_10,F[b.GMPD_BUTTON_11]=b.GMPD_BUTTON_11,F[b.GMPD_BUTTON_16]=b.GMPD_BUTTON_16;var G=0,k=1,K=2,B='<svg id="svg26627" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="128.51mm" viewBox="0 0 636.63517 455.33329" width="179.67mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:dc="http://purl.org/dc/elements/1.1/"><defs id="defs26629"><linearGradient id="linearGradient4691"><stop id="stop4693" offset="0"/><stop id="stop4695" stop-opacity="0" offset="1"/></linearGradient><linearGradient id="linearGradient4358"><stop id="stop4360" stop-color="#2e2e2e" offset="0"/><stop id="stop4362" stop-color="#2e2e2e" stop-opacity="0" offset="1"/></linearGradient><linearGradient id="linearGradient4364" x1="1141.5" xlink:href="#linearGradient4358" gradientUnits="userSpaceOnUse" y1="255.95" gradientTransform="matrix(-1 0 0 1 1531.4 560.1)" x2="1165.2" y2="309.88"/><linearGradient id="linearGradient4368" x1="1141.5" xlink:href="#linearGradient4358" gradientUnits="userSpaceOnUse" y1="255.95" gradientTransform="translate(-896.37 560.1)" x2="1165.2" y2="309.88"/><linearGradient id="linearGradient4430" x1="959.32" gradientUnits="userSpaceOnUse" y1="653.07" gradientTransform="matrix(-1 0 0 1 1531.4 70.097)" x2="1467.6" y2="653.07"><stop id="stop4426" stop-color="#4f4f4f" offset="0"/><stop id="stop4428" stop-color="#4f4f4f" stop-opacity="0" offset="1"/></linearGradient><linearGradient id="linearGradient4701" x1="529.91" xlink:href="#linearGradient4691" gradientUnits="userSpaceOnUse" y1="111.1" gradientTransform="translate(-52.276 546.89)" x2="481.49" y2="85.746"/><linearGradient id="linearGradient4713" x1="529.91" xlink:href="#linearGradient4691" gradientUnits="userSpaceOnUse" y1="111.1" gradientTransform="matrix(-1 0 0 1 689.01 546.89)" x2="481.49" y2="85.746"/><linearGradient id="linearGradient4725" x1="367.39" xlink:href="#linearGradient4691" gradientUnits="userSpaceOnUse" y1="125.6" gradientTransform="matrix(-1.3272 0 0 .68317 806.95 579.14)" x2="367.39" y2="116.11"/></defs><metadata id="metadata26632"><rdf:RDF><cc:Work rdf:about="">    <dc:format>image/svg+xml</dc:format>    <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/>    <dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -597.03)"><g id="g20" fill-rule="evenodd"><path id="path4209" fill="#434343" d="m576.71 1052.4c42.015-1.9097 64.296-46.468 59.204-122.86-5.0928-76.387-27.374-175.69-44.562-224.7-17.188-49.015-25.501-62.531-26.737-65.565-3.7697-9.2504-11.278-19.949-62.379-27.691-28.97-4.3891-16.697-7.9577-27.084-9.4696-17.96-2.6141-43.609-1.229-52.203 1.6354-8.594 2.8645-12.709 29.16-24.486 35.207-11.777 6.0473-19.416 10.185-80.149 10.185s-68.372-4.1376-80.149-10.185c-11.777-6.0473-18.113-32.099-25.736-36.993-11.183-7.1796-26.985-5.6722-54.891-0.57481-5.64 1.0302-1.1304 7.6212-18.165 12.509-32.913 9.4438-52.094 3.7056-65.087 20.831-1.9807 2.6106-11.822 21.096-29.01 70.111-17.179 48.95-39.46 148.25-44.553 224.64-5.0929 76.39 17.188 120.99 59.204 122.89 73.339-1.7 55.219-116.53 258.4-116.53s185.05 114.82 258.4 116.49z"/><path id="path4366" fill="url(#linearGradient4368)" d="m249.77 838.51c-107.76 0-171.55 96.288-176.84 121.23-5.2294 24.634-17.658 55.705 3.8195 53.789 9.6996-0.8655 18.053-15.713 37.559-38.193 18.78-21.643 41.379-54.425 96.763-54.425s73.209-44.877 75.119-53.152c1.9098-8.2752 2.4146-27.976-36.418-29.25z"/><path id="path4217" fill="url(#linearGradient4364)" d="m385.23 838.51c107.76 0 171.55 96.288 176.84 121.23 5.2293 24.634 17.658 55.705-3.8195 53.789-9.6996-0.8655-18.053-15.713-37.559-38.193-18.78-21.643-41.379-54.425-96.763-54.425s-73.209-44.877-75.119-53.152c-1.9098-8.2752-2.4146-27.976 36.418-29.25z"/><path id="path4370" fill="url(#linearGradient4430)" d="m572.06 654.81c-60.48-19.09-76.79-18.6-89.84-17.96-13.05 0.63657-22.638 16.617-45.237 49.4s-67.48 125.27-116.23 125.27c-48.746 0-93.626-92.491-116.23-125.27-22.599-32.783-32.008-48.942-45.059-49.579-13.05-0.63648-35.251 1.8354-95.728 20.932l1.1161-2.3404c60.494-19.1 81.754-20.83 94.804-20.19 13.05 0.63657 22.281 13.049 44.88 45.832s67.48 123.49 116.23 123.49c48.746 0 93.626-90.709 116.23-123.49 22.599-32.783 31.83-45.195 44.88-45.832 13.05-0.63648 28.783-1.6248 89.26 17.472"/><path id="path4315" fill="#343434" d="m570.99 652.48c-60.477-19.097-76.074-18.269-89.124-17.633-13.05 0.63658-22.281 14.832-44.88 47.614-22.599 32.783-67.48 125.27-116.23 125.27-48.746 0-93.626-92.491-116.23-125.27-22.599-32.783-31.83-46.978-44.88-47.614-13.05-0.63648-34.715 1.2996-95.192 20.396l1.1161-2.3404c60.474-19.1 81.024-22.26 94.074-21.62 13.05 0.63658 22.281 13.049 44.88 45.832s67.48 123.49 116.23 123.49c48.746 0 93.626-90.709 116.23-123.49 22.599-32.783 31.83-45.195 44.88-45.832 13.05-0.63647 27.71-0.17274 88.186 18.924"/></g><g id="g15645" transform="matrix(.75439 0 0 1 1558.5 -6638.3)" fill-rule="evenodd"><rect id="rect15584" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="2" ry="1.8461" height="44.307" width="570" y="6558.3" x="100.71" fill="#4164bb"/><rect id="rect15331" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="2" ry="1.8461" height="44.307" width="570" y="6554.6" x="100.71" fill="#5276cf"/></g><text id="text15623-9" style="word-spacing:0px;letter-spacing:0px" font-weight="300" xml:space="preserve" font-size="22px" line-height="430.99999428%" y="-53.755863" x="1792.7805" font-family="&apos;Noto Sans CJK TC&apos;" fill="#ffffff"><tspan id="tspan15625-5" y="-53.755863" x="1792.7805"/></text><text id="text15657" style="word-spacing:0px;letter-spacing:0px" font-weight="300" xml:space="preserve" font-size="13px" line-height="430.99999428%" y="-3.7607465" x="1670.2437" font-family="&apos;Noto Sans CJK TC&apos;" fill="#828282"><tspan id="tspan15659" y="-3.7607465" x="1670.2437"/></text><g id="g34" fill-rule="evenodd"><path id="path4675" fill="#303030" d="m551.75 628.4c9.3003 4.1796 8.2375 11.558 2.1302 9.9581-6.1073-1.6003-33.792-9.1405-46.239-11.577-12.446-2.4363-34.904-3.0623-36.951-4.0165-2.0474-0.95416 0.93313-7.7247 5.491-7.3449 23.258 0.91012 59.905 6.0339 75.569 12.98z"/><path id="path4677" fill="#303030" d="m474.88 602.61c3.6488 0.63684 4.1169 1.3708 2.4115 5.2499-0.80967 1.8416-1.261 3.904-3.4715 3.7336-4.456-0.34344-16.578-1.2846-25.692-1.3764-9.1139-0.0918-23.83 1.217-25.307 0.79399-1.4771-0.42301-1.8834-4.9141 1.7769-6.7458 4.6221-1.3593 38.698-3.2021 50.281-1.6553z"/><path id="path4699" opacity=".384" fill="url(#linearGradient4701)" d="m475.53 611.7c-11.693-0.63604-8.4597-0.73151-44.068 54.448-6.5182 8.6489-22.874 37.231-36.865 35.326-6.7491-1.4177 15.436-67.299 22.724-75.767 11.112-12.911 19.255-16.122 58.209-14.007z"/><path id="path4703" fill="#303030" d="m84.068 628.4c-9.3003 4.1796-8.2375 11.558-2.1302 9.9581 6.1073-1.6003 33.792-9.1405 46.239-11.577 12.446-2.4363 34.904-3.0623 36.951-4.0165 2.0474-0.95416-0.93313-7.7247-5.491-7.3449-23.258 0.91012-59.905 6.0339-75.569 12.98z"/><path id="path4705" fill="#303030" d="m161.86 602.61c-3.6488 0.63684-4.1169 1.3708-2.4115 5.2499 0.80967 1.8416 1.261 3.904 3.4715 3.7336 4.456-0.34344 16.578-1.2846 25.692-1.3764 9.1139-0.0918 23.83 1.217 25.307 0.79399 1.4771-0.42301 1.8834-4.9141-1.7769-6.7458-4.6221-1.3593-38.698-3.2021-50.281-1.6553z"/><path id="path4711" opacity=".384" fill="url(#linearGradient4713)" d="m161.2 611.7c11.693-0.63604 8.4597-0.73151 44.068 54.448 6.5182 8.6489 22.874 37.231 36.865 35.326 6.7491-1.4177-15.436-67.299-22.724-75.767-11.112-12.911-19.255-16.122-58.209-14.007z"/><path id="path4717" opacity=".115" fill="url(#linearGradient4725)" d="m413.37 645.84c-9.0496 10.007-29.401 19.937-36.775 19.937h-52.205c-31.171 0-37.359 0.34506-47.75 0.51758-10.39 0.17253-18.682 0.65628-23.653-3.278-5.0513-3.9977-24-15.425-24-15.425 53.346 4.1464 144.49 4.3368 184.38-1.7523z"/></g></g><g id="layer1-0" fill-rule="evenodd" transform="translate(159.08 -720.76)"><g id="g4527-3" transform="translate(-961.22,330.69)"><ellipse id="circle4233-8" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="circle4235-8" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="circle4237-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g><g id="g4523-1" transform="translate(-961.22,330.69)"><ellipse id="circle4239-4" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="circle4243-3" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g><g id="g3506" transform="translate(-961.22,330.69)"><ellipse id="ellipse3508" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="ellipse3510" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="ellipse3512" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g></g><g id="layer1-7" fill-rule="evenodd" transform="translate(352.57 -719.72)"><g id="g4527-3-4" transform="translate(-961.22,330.69)"><ellipse id="circle4233-8-8" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="circle4235-8-9" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="circle4237-7-3" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g><g id="g4523-1-1" transform="translate(-961.22,330.69)"><ellipse id="circle4239-4-4" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="circle4243-3-5" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g><g id="g3506-2" transform="translate(-961.22,330.69)"><ellipse id="ellipse3508-1" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="ellipse3510-1" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="ellipse3512-4" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g></g></svg>',X='<svg id="svg3904" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="35.924mm" width="35.926mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 127.29808 127.28933"><metadata id="metadata3909"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -925.07)"><ellipse id="circle4330" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="63.649" ry="63.645" cy="988.72" cx="63.649" fill="#303030"/><ellipse id="circle4223" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="59.705" ry="59.701" cy="988.72" cx="63.649" fill="#4c4c4c"/></g></svg>',H='<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4326" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1017.1c-15.254-3.8172-24.634-1.7612-34.31 0v16.247h0.015c-0.013 0.097-0.013 0.1951-0.015 0.2928 0.0006 9.4753 7.6813 18.256 17.156 18.256 9.4739-0.0005 17.154-8.7813 17.154-18.256 0-0.097-0.014-0.1952-0.014-0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',j='<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m35.298 1017.6c3.8175 15.253 1.7611 24.633 0 34.308h-16.248v-0.015c-0.098 0.01-0.1952 0.01-0.2928 0.015-9.476-0.0006-18.258-7.6807-18.257-17.154 0.0005-9.4733 8.7818-17.153 18.257-17.153 0.098 0 0.1952 0.01 0.2928 0.011v-0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',Q='<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4328" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1049.7c-15.254 3.8172-24.634 1.7612-34.31 0v-16.247h0.015c-0.013-0.097-0.013-0.1951-0.015-0.2928 0.0006-9.4753 7.6813-18.256 17.156-18.256 9.4739 0.0005 17.154 8.7813 17.154 18.256 0 0.097-0.014 0.1952-0.014 0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',z='<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m2.6552 1051.9c-3.8175-15.253-1.7611-24.633 0-34.308h16.248v0.015c0.098-0.01 0.1952-0.01 0.2928-0.015 9.476 0.0006 18.258 7.6807 18.257 17.154-0.0005 9.4733-8.7818 17.153-18.257 17.153-0.098 0-0.1952-0.01-0.2928-0.011v0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',V='<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>',q='<svg id="svg3461" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="22.608mm" width="22.61mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 80.114398 80.108405"><metadata id="metadata3466"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(.0000019915 -972.25)"><g id="g3514-7" fill-rule="evenodd" transform="translate(-987.45 356.91)"><ellipse id="ellipse3516-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="ellipse3518-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g></g></svg>',W='<svg id="svg3699" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2811mm" width="9.2817mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.8879 32.88565"><metadata id="metadata3704"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -1019.5)"><ellipse id="ellipse4575" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="16.444" ry="16.443" cy="1035.9" cx="16.444" fill="#2e2e2e"/><ellipse id="ellipse4577" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="15.112" ry="15.11" stroke="#4364b2" cy="1035.9" cx="16.444" fill="#5276cf"/><ellipse id="ellipse4579" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="11.867" ry="11.866" cy="1035.9" cx="16.444" fill="#434343"/></g></svg>',J='<svg id="svg3560" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="4.7796mm" width="13.57mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 48.082162 16.935645"><metadata id="metadata3565"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1035.4)"><path id="path4727" d="m42.857 1052.2c4.7071 0.4081 4.7981 0.6563 5.1414-4.9139 0.16344-2.6517 0.16699-6.1108-0.72615-8.0342-0.59471-1.2808-1.7793-2.049-3.7642-2.4662-2.5264-0.531-16.253-1.4345-26.685-1.3241-15.118 0.16-15.362 1.4769-15.855 4.1522-0.35071 1.9018-0.5016 3.5056-0.74837 5.5967-0.55261 7.0693-0.44908 7.0921 5.0452 6.5411 11.661-1.1062 25.929-0.7359 37.592 0.4484z" fill-rule="evenodd" fill="#5276cf"/></g></svg>',Z='<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="21.241671mm" height="8.8544388mm" viewBox="0 0 75.265762 31.373996" id="svg3447" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="l1.svg"><defs id="defs3449" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.4" inkscape:cx="-254.57869" inkscape:cy="228.81952" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(1.5000945e-8,-1020.9882)"><path style="fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" d="m 11.026383,1051.1651 c -7.4440599,1.9144 -7.5133499,2.2466 -9.7963799,-4.4934 -1.81058997,-5.3452 -2.44278,-8.8152 4.01547,-12.116 2.74038,-1.4007 13.7365799,-5.877 38.4768299,-10.72 24.26031,-4.749 25.16653,-2.7967 26.79132,0.3418 1.15503,2.2311 1.8961,4.1561 2.94279,6.651 3.08552,8.5188 2.92609,8.5778 -6.08214,9.5501 -19.09891,2.1414 -37.95723,5.8307 -56.34789,10.7865 z" id="path4289" inkscape:connector-curvature="0" sodipodi:nodetypes="cssssccc" /></g></svg>',$='<svg id="svg3447" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="8.8544mm" width="21.242mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 75.265762 31.373996"><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(1.5001e-8 -1021)"><path id="path4715" d="m64.239 1051.2c7.4441 1.9144 7.5134 2.2466 9.7964-4.4934 1.8106-5.3452 2.4428-8.8152-4.0155-12.116-2.7404-1.4007-13.737-5.877-38.477-10.72-24.26-4.749-25.167-2.7967-26.791 0.3418-1.155 2.2311-1.8961 4.1561-2.9428 6.651-3.0855 8.5188-2.9261 8.5778 6.0822 9.5501 19.099 2.1414 37.957 5.8307 56.348 10.786z" fill-rule="evenodd" fill="#5276cf"/></g></svg>',ee='<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="24.603382mm" height="24.601696mm" viewBox="0 0 87.177338 87.171363" id="svg3640" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="main.svg"><defs id="defs3642" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.979899" inkscape:cx="61.113463" inkscape:cy="69.71796" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3645"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(0,-965.19093)"><ellipse ry="43.585682" rx="43.588669" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#2e2e2e;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="ellipse4372" cx="43.588669" cy="1008.7766" /><ellipse cy="1008.7766" cx="43.588669" id="circle4239-1" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:#4364b2;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" rx="40.056705" ry="40.053959" /><ellipse style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#434343;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="circle4243-0" cx="43.588669" cy="1008.7766" rx="31.455994" ry="31.453836" /></g></svg>',te='<svg id="svg3407" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="41.787mm" width="41.786mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 148.0624 148.06251"><metadata id="metadata3412"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -904.3)" fill="#e6e6e6"><path id="rect4545" d="m74.031 904.3-14.469 22.156h8.0313v8.2187h12.875v-8.2187h8.0625l-14.5-22.156z"/><path id="rect4603" d="m125.94 963.86v8.0313h-8.25v12.906h8.25v8.0313l22.125-14.5-22.125-14.469z"/><path id="rect4609" d="m67.594 1022v8.25h-8.0313l14.469 22.125 14.5-22.125h-8.0625v-8.25h-12.875z"/><path id="rect4615" d="m22.156 963.86-22.156 14.47l22.156 14.5v-8.2188h8.2188v-12.906h-8.2188v-7.8438z"/><path id="path4619" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m54.393 924.58c-15.821 5.7885-28.404 18.385-34.188 34.219h11.156c4.6667-10.175 12.865-18.361 23.031-23.031v-11.188zm39.219 0.031v11.156c10.167 4.6713 18.361 12.86 23.031 23.031h11.156c-5.7846-15.821-18.379-28.393-34.188-34.188zm-73.375 73.438c5.7899 15.816 18.348 28.403 34.156 34.188v-11.156c-10.163-4.6691-18.364-12.861-23.031-23.031h-11.125zm96.406 0c-4.6712 10.167-12.868 18.361-23.031 23.031v11.125c15.796-5.7901 28.366-18.352 34.156-34.156h-11.125z"/></g></svg>',_e='<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="112.08413mm" height="128.46834mm" viewBox="0 0 397.14849 455.20277" id="svg3440" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel.svg"><defs id="defs3442" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="0.98994949" inkscape:cx="421.01508" inkscape:cy="52.510802" inkscape:document-units="px" inkscape:current-layer="g87" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3445"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title /></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(-2.3645008e-8,-597.15942)"><path inkscape:connector-curvature="0" style="fill:#4d4d4d;stroke:#6e6e6e;stroke-width:2.99125171;stroke-miterlimit:4;stroke-dasharray:none" id="path4140" d="m 307.84153,715.52552 c -4.35995,43.11849 -2.78952,86.66385 -15.90234,128.54337 -10.85452,25.86023 -13.33477,47.2976 6.91492,61.09536 7.23778,50.7442 78.38013,47.39232 82.20535,0 23.06079,-14.19054 13.49405,-42.79138 6.91492,-61.09536 -17.40045,-40.83001 -4.82581,-86.43019 -15.90235,-128.54337 -8.3177,-20.33228 -56.75348,-20.7661 -64.22927,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#cccccc;stroke:#1a1a1a;stroke-width:2.09465766;stroke-miterlimit:4;stroke-dasharray:none" id="path4266" d="m 313.11812,724.1957 -3.84514,68.80568 c 4.64168,13.40814 62.19981,10.8172 61.83082,0 l -3.84515,-68.80568 c -4.46942,-24.00369 -52.58756,-18.95946 -54.13979,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#353535;stroke:#2c2c2c;stroke-width:2.11880326;stroke-miterlimit:4;stroke-dasharray:none" id="path4156" d="m 304.91419,870.673 c -12.36924,67.40381 80.42804,69.69607 70.55134,0 -6.57605,-36.5947 -65.0964,-34.8253 -70.55134,0 z m 60.53812,3.9862 c 8.65841,48.24354 -57.58987,49.86644 -50.52489,0 4.7009,-26.27069 46.6394,-24.84292 50.52489,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#e6e6e6;stroke:#969696;stroke-width:2.99125171;stroke-miterlimit:4;stroke-dasharray:none" id="path4011" d="m 106.04576,696.97906 c -11.197076,4.25792 -17.123706,8.24834 -17.123706,8.24834 l -66.18493,16.33946 1.40291,30.64619 46.54715,-7.67623 c 17.00932,-1.6438 32.551896,8.94676 38.302026,23.34506 l 2.78663,65.4778 27.6363,0 2.78663,-65.4778 c 8.0428,-15.3291 20.46247,-27.10803 38.30202,-23.34506 l 46.54716,7.67623 1.40291,-30.64619 -66.18493,-16.33946 c 0,0 -5.92627,-3.99074 -17.12371,-8.24834 -13.45408,-4.31874 -26.62772,-4.20804 -39.08982,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#252525;stroke:#6e6e6e;stroke-width:2.99125171;stroke-miterlimit:4;stroke-dasharray:none" id="path2996" d="m 38.311064,931.09899 c -8.01574,5.05649 -22.76006,21.74743 -26.34852,58.0567 -4.1290804,35.18581 -4.8394604,60.59901 28.55878,61.68771 l 162.934726,0 c 39.19437,1.1693 30.46155,-41.5992 28.55878,-61.68771 -3.58839,-36.30927 -18.33277,-52.99983 -26.34851,-58.0567 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#373737;stroke:#6e6e6e;stroke-width:2.83429575;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none" id="path3019" d="m 26.230254,979.1291 c -11.50334,14.44882 -11.98241,47.3999 -0.33519,57.1202 l 191.802226,0 c 12.10111,-12.3068 9.93082,-46.99573 -0.33518,-57.1202 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#808080;stroke:#1a1a1a;stroke-width:2.14882827;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0" id="path4133" d="m 360.82498,854.6914 a 20.634815,21.265151 0 1 1 -41.269,0 20.634815,21.265151 0 1 1 41.269,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#333333;stroke:#000000;stroke-width:2.11880326;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0" id="path4280" d="m 351.64051,761.132 a 11.444622,11.75148 0 1 1 -22.88896,0 11.444622,11.75148 0 1 1 22.88896,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#313131;stroke:#565656;stroke-width:2.93434715;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0" id="path3993" d="m 125.52855,598.62659 c -68.528026,0 -124.0613764,57.81925 -124.0613764,129.13695 0,71.31265 55.5370404,129.13696 124.0613764,129.13696 68.52804,0 124.07984,-57.81926 124.07984,-129.13696 0,-71.31264 -55.55611,-129.13695 -124.07984,-129.13695 z m -1.00095,23.63932 c 10.01261,0.0734 20.238,1.32074 28.95237,3.51006 11.62203,3.80301 21.53624,8.52304 31.01135,16.15381 26.21752,19.0207 43.36275,50.36277 43.36275,85.83029 0,58.01564 -45.80548,105.05244 -102.30928,105.05244 -56.500726,0 -102.309276,-47.03364 -102.309276,-105.05244 0,-32.14848 14.06783,-60.91918 36.22336,-80.19121 11.45168,-11.11714 23.14136,-17.13322 37.3943,-21.79731 7.855846,-2.48302 17.655666,-3.5835 27.668276,-3.51006 z" stroke-miterlimit="4" /><g style="stroke-miterlimit:4;stroke-dasharray:none" id="g4127" stroke-miterlimit="4" transform="matrix(0.61498728,0,0,0.63147657,-18.171616,453.28593)"><g id="g4111"><path style="fill:#808080;stroke:#373737;stroke-width:3.56837296" inkscape:connector-curvature="0" id="rect3040" d="m 110.97,771.16 31.694,4.8776 1.3007,44.257 -32.995,0 z" /><path style="fill:#b3b3b3;stroke:#565656;stroke-width:3.4000001;stroke-linecap:butt;stroke-linejoin:miter" inkscape:connector-curvature="0" id="path3024" d="m 96.83,686.82 58.353,-5.0761 c 15.608,27.569 6.8304,64.333 -5.0761,90.545 l -53.841,-2.538 z" /></g><g id="g4115" transform="translate(97.984785,0)"><path style="fill:#808080;stroke:#373737;stroke-width:3.56837296" inkscape:connector-curvature="0" id="path4117" d="m 110.97,771.16 31.694,4.8776 1.3007,44.257 -32.995,0 z" /><path style="fill:#b3b3b3;stroke:#565656;stroke-width:3.4000001;stroke-linecap:butt;stroke-linejoin:miter" inkscape:connector-curvature="0" id="path4119" d="m 96.83,686.82 58.353,-5.0761 c 15.608,27.569 6.8304,64.333 -5.0761,90.545 l -53.841,-2.538 z" /></g><g id="g4121" transform="translate(195.96959,0)"><path style="fill:#808080;stroke:#373737;stroke-width:3.56837296" inkscape:connector-curvature="0" id="path4123" d="m 110.97,771.16 31.694,4.8776 1.3007,44.257 -32.995,0 z" /><path style="fill:#b3b3b3;stroke:#565656;stroke-width:3.4000001;stroke-linecap:butt;stroke-linejoin:miter" inkscape:connector-curvature="0" id="path4125" d="m 96.83,686.82 58.353,-5.0761 c 15.608,27.569 6.8304,64.333 -5.0761,90.545 l -53.841,-2.538 z" /></g></g><g style="fill:#666666;stroke:#969696;stroke-width:3.99777174;stroke-miterlimit:4;stroke-dasharray:none" id="g4051" transform="translate(-42.878584,98.083591)" stroke-miterlimit="4"><g id="g4437" transform="matrix(0.74686368,0,0,0.74686368,-73.374214,285.30447)"><path inkscape:connector-curvature="0" id="rect4348" style="color:#000000;text-indent:0;text-transform:none;block-progression:tb;fill:#ffffff" d="m 567.31,584.22 0,42.25 0,3.4062 0,42.25 3.375,0 0,-42.25 27.062,0 0,42.25 3.375,0 0,-42.25 27.062,0 0,42.25 3.375,0 0,-42.25 27.062,0 0,42.25 3.4062,0 0,-43.969 0,-1.6875 -1.7188,0 -28.75,0 0,-42.25 -3.375,0 0,42.25 -27.062,0 0,-42.25 -3.375,0 0,42.25 -27.062,0 0,-42.25 -3.375,0 z" /><g style="fill:#a02c2c;stroke:#ffffff;stroke-width:3.4000001;stroke-linecap:square" id="g87" /></g></g></g></svg>',re='<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',ae='<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4049" d="m26.584 1016.1c-12.631 0-23.15 9.858-25.478 22.922l50.705 12.18c0.47921-2.1565 0.73023-4.4099 0.73023-6.7204 0-15.677-11.621-28.382-25.957-28.382z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>',ne='<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4033" d="m26.92 1016.1c-14.337 0-25.957 12.707-25.957 28.382 0 2.3225 0.26742 4.5784 0.74876 6.7386l50.681-12.18c-2.321-13.072-12.841-22.944-25.476-22.944z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>',oe='<svg id="svg3386" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="12.859mm" width="5.2917mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 18.749999 45.562501"><metadata id="metadata3391"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1006.8)"><path id="rect4575" d="m9.3125 1006.8-9.3125 14.25h5.3125v17.094h-5.1875l9.3125 14.219 9.3125-14.219h-5.1562v-17.094h5.0312l-9.3125-14.25z" fill="#e6e6e6"/></g></svg>',ie='<svg id="svg3458" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="50.447mm" width="83.899mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 297.28131 178.75"><metadata id="metadata3463"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -873.61)" fill="#e6e6e6"><path id="path4535" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m33.875 873.61-18.5 8.8125 5.0626 3.0625c-12.899 22.78-20.438 49.17-20.438 77.44 0 28.284 7.5315 54.691 20.438 77.469l-5.0626 3.0625 18.5 8.8125 0.6563-20.469-5.531 3.3c-12.002-21.2-18.937-45.8-18.937-72.18 0-26.362 6.9415-50.99 18.937-72.188l5.5313 3.3438-0.6563-20.469z"/><path id="path4551" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m263.38 873.71-0.6562 20.469 5.5312-3.3438c11.996 21.198 18.969 45.825 18.969 72.188 0 26.371-6.9672 51.011-18.969 72.219l-5.5312-3.3437 0.6562 20.469 18.5-8.8125-5.0312-3.0625c12.906-22.778 20.438-49.184 20.438-77.469 0-28.275-7.5391-54.665-20.438-77.438l5.0312-3.0625-18.5-8.8125z"/></g></svg>',se='<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="2.9016mm" width="9.2516mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.781198 10.281199"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1042.1)"><path id="rect4585" d="m32.781 1047.2-7.875-5.125v2.8437h-17.031v-2.8437l-7.875 5.1 7.875 5.1562v-2.8437h17.031v2.8437z" fill="#e6e6e6"/></g></svg>',Ee='<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2516mm" width="2.9016mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 10.281248 32.7812"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1019.6)"><path id="rect4585" d="m5.125 1019.6-5.125 7.9h2.8437v17.031h-2.8437l5.125 7.875 5.1562-7.875h-2.8438v-17.031h2.8438z" fill="#e6e6e6"/></g></svg>',ce=[],le=-1,Te=null,de=G,ue=null,fe=null,Pe=null,Ae=null,Se=null,pe=null,Oe=[],ve=[],me=[],Ne=[],ge=!0,Re={};Re[b.GMPD_AXIS_0]=-2,Re[b.GMPD_AXIS_1]=-2,Re[b.GMPD_AXIS_2]=-2,Re[b.GMPD_AXIS_3]=-2,Re[b.GMPD_AXIS_4]=-2,Re[b.GMPD_AXIS_5]=-2,Re[b.GMPD_AXIS_6]=-2,Re[b.GMPD_AXIS_7]=-2,Re[b.GMPD_AXIS_8]=-2,Re[b.GMPD_AXIS_9]=-2,Re[b.GMPD_AXIS_10]=-2,Re[b.GMPD_AXIS_11]=-2,t.show=function(){function e(e,t,_){var r=c(),a=r.length;-1==le&&r.length&&(le=r[0].index,Pe=d[le]);for(var n=0;n<d.length;n++)n<a?(d[n].textContent=r[n].index,d[n]==Pe?(d[n].style.backgroundColor="green",pe.textContent="Selected device: "+r[n].index+". Data: "+r[n].id):d[n].style.backgroundColor="blue"):d[n].style.backgroundColor="black";a||(le=-1,pe.textContent="")}var t=document.createElement("div");ue=t,t.style.cssText="position: absolute;width: 720px;height: 750px;top: 50%;left: 50%;-moz-transform: translateY(-50%) translateX(-50%);-ms-transform: translateY(-50%) translateX(-50%);-webkit-transform: translateY(-50%) translateX(-50%);transform: translateY(-50%) translateX(-50%);background-color: black;border: 4px solid white;border-radius: 35px;box-shadow: 0px 0px 20px 0px rgba(50, 50, 50, 1);",R.insert_to_container(t,"LAST"),f(t);var n=document.createElement("div");n.style.cssText="position: absolute;width: 637px;top: 0px;font-family: sans-serif;text-align: center;margin-top: 40px;-moz-transform: translateX(-50%);-ms-transform: translateX(-50%);-webkit-transform: translateX(-50%);transform: translateX(-50%);left: 50%;";var o=document.createElement("div");o.innerHTML="Select a device",o.style.cssText="color: #fff;display: inline-block;",n.appendChild(o);for(var i=0;i<4;i++){var s=A(i),l=function(){return!0},T=function(e,t,_){if(t==le)for(var r=0;r<ve.length;r++){var a=ve[r];E(a,I.get_sensor_value(e,t,r),r)}};I.create_sensor_manifold(null,i,I.CT_CONTINUOUS,s,l,T)}c().length>0&&(le=0);var d=[],P=document.createElement("div");P.style.cssText="margin-top: 20px;";for(var O=0;O<4;O++){var m=N(O);O==le&&(m.style.backgroundColor="green",Pe=m),u(O),P.appendChild(m),m.setAttribute("data-device_type","PAD"),d.push(m);var h=function(e){for(var t=c(),_=e.target,r=0;r<t.length;r++)d[r]==_&&(le=r,Pe=_,u(le),v(_.getAttribute("data-device_type")))};b.add_click_listener(m,h)}n.appendChild(P),pe=document.createElement("label"),pe.style.cssText="position: relative;display: block;color: white;",n.appendChild(pe);var Y=document.createElement("div");Y.style.cssText="margin-top: 20px;";var L=p(Y,"Pad"),M=p(Y,"Wheel");L.setAttribute("checked","true"),L.onchange=function(){v("PAD"),Pe&&Pe.setAttribute("data-device_type","PAD")},M.onchange=function(){v("WHEEL"),Pe&&Pe.setAttribute("data-device_type","WHEEL")},L.setAttribute("id","test"),Se=L,Ae=M;var x=document.createElement("label");x.style.cssText+="color: #fff;display: block;",Y.appendChild(x),x.textContent=U,x.setAttribute("id","action_label"),n.appendChild(Y),t.appendChild(n);var y=I.create_elapsed_sensor();I.create_sensor_manifold(null,"UPDATE_GAMEPAD_DATA",I.CT_CONTINUOUS,[y],l,e);for(var i=0;i<4;i++){var s=S(i),w=function(){return!0},T=function(e,t,n){if(t=="AXES"+le){for(var o=0;o<me.length;o+=2){_(me[o],e,t,o)}if(ge)for(var o=0;o<12;o+=2)r(e,t,o);else for(var o=0;o<12;o++)a(e,t,o)}};I.create_sensor_manifold(null,"AXES"+i,I.CT_CONTINUOUS,s,w,T)}g(),window.addEventListener("resize",g)},t.hide=function(){de=G,le=-1,Pe=null,Te=null,Ae=null,Se=null,me.length=0,ve.length=0,Ne.length=0,R.get_container().removeChild(ue),ue=null,I.remove_sensor_manifold(null,"UPDATE_GAMEPAD_DATA");for(var e=0;e<4;e++)I.remove_sensor_manifold(null,e),I.remove_sensor_manifold(null,"AXES"+e);window.removeEventListener("resize",g)},t.update=function(){for(var e=0;e<4;e++)u(e)}}var a=_(0),n=_(39),o=_(24),i=_(49),s=_(69),E=Object(a.a)("gp_conf",r);t.a=E},function(e,t,_){"use strict";function r(e,t){function _(e){var t=a.create_gyro_angles_sensor(),_=a.create_gyro_quat_sensor(),n=!0,o=function(e,t,_){if(_>0)if(r.is_eye_camera(e)){var o=a.get_sensor_payload(e,t,1),i=c.transformQuat(d.AXIS_MY,o,P);r.set_vertical_axis(e,i),T.set_rotation_v(e,o)}else{f=a.get_sensor_payload(e,t,0),n&&(u[0]=f[0],u[1]=f[1],u[2]=f[2],n=!1);var s=0,E=0;0==window.orientation&&(s=f[1]-u[1],E=f[0]-u[0],f[1]>S&&f[1]<A&&(E=0)),180==window.orientation&&(s=f[1]-u[1],f[1]<0&&(s=-s),E=u[0]-f[0],(s>Math.PI/2||s<-Math.PI/2)&&(s=0),f[1]>-A&&f[1]<-S&&(E=0)),-90==window.orientation&&(s=f[0]-u[0],(s>Math.PI/2||s<-Math.PI/2)&&(s=0),E=u[1]-f[1],(f[0]>p||f[0]<O)&&(E=0)),90==window.orientation&&(s=u[0]-f[0],(s>Math.PI/2||s<-Math.PI/2)&&(s=0),E=f[1]-u[1],(f[0]>p||f[0]<O)&&(E=0)),r.rotate_camera(e,E,s),u[0]=f[0],u[1]=f[1],u[2]=f[2]}};a.create_sensor_manifold(e,"CAMERA_ROTATE_GYRO",a.CT_CONTINUOUS,[t,_],null,o)}var r=Object(n.a)(e),a=Object(o.a)(e),l=Object(i.a)(e),T=Object(s.a)(e),d=Object(E.a)(e),u=new Float32Array(3),f=new Float32Array(3),P=c.create(),A=d.deg_to_rad(110),S=d.deg_to_rad(70),p=d.deg_to_rad(70),O=-d.deg_to_rad(70);t.enable_camera_rotation=function(){_(l.get_active_camera())},t.disable_camera_rotation=function(){var e=l.get_active_camera();a.remove_sensor_manifold(e,"CAMERA_ROTATE_GYRO")}}var a=_(0),n=_(33),o=_(24),i=_(29),s=_(40),E=_(26),c=_(3),l=Object(a.a)("gyroscope",r);t.a=l},function(e,t,_){"use strict";function r(e,t){function _(){if(!Y.can_use_device(Y.DEVICE_HMD))return!1;var e=Y.get_device_by_type_element(Y.DEVICE_HMD),t=Y.get_value_param(e,Y.HMD_WEBVR_TYPE);return t&(Y.HMD_NON_WEBVR|Y.HMD_WEBVR_MOBILE|Y.HMD_WEBVR_DESKTOP)&&!(t&Y.HMD_WEBVR1)}function r(){var e=M.get("hmd_conf","b4w"),t=JSON.parse(e||"{}"),_=t.profile||"custom",r=document.createElement("div"),n=document.createElement("label");n.innerHTML="Profile: ",n.className="text_label",n.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;width: 120px;height: 30px;display: block;float: left;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: left;padding-left: 8px;line-height: 28px;margin-bottom: 4px;box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);",r.appendChild(n);var o=document.createElement("select");r.appendChild(o),o.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;height: 30px;display: block;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: left;padding-left: 8px;line-height: 28px;margin-bottom: 4px;box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);";var i=Y.get_device_by_type_element(Y.DEVICE_HMD);if(i)for(var s in Z)if(Z[s].type==W||Y.get_value_param(i,Y.HMD_WEBVR_TYPE)&(Y.HMD_NON_WEBVR|Y.HMD_WEBVR_MOBILE)&&Z[s].type==J){var E=document.createElement("option");E.value=s,E.text=Z[s].name,o.appendChild(E)}return o.value=_,x.is_ie11()?o.onchange=a:o.oninput=a,r}function a(e){var t=e.target.value,_=Z[t];for(var r in F)if(r in _){var a=document.getElementById(r+"_slider");a&&(a.disabled="custom"!==t,a.value=_[r]);var n=document.getElementById(r+"_number");n&&(n.disabled="custom"!==t,n.value=_[r]),F[r]=_[r]}}function l(){h.remove_sensor_manifold(null,"UPDATE_HMD_RENDERING"),p(),v(),y&&(y=!1,u())}function T(){p(!0),v(),d()}function d(){for(var e in F){var t=document.getElementById(e+"_slider");t&&(t.value=F[e]);var _=document.getElementById(e+"_number");_&&(_.value=F[e])}}function u(){b.get_container().removeChild(U),document.head.removeChild(w),U=null,C=null,w=null}function f(){return Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio}function P(){return Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio}function A(e,t,_,r){return e.ua&&t.indexOf(e.ua)>=0||!e.ua&&e.res&&e.res[0]&&e.res[1]&&Math.min(_,r)==Math.min(e.res[0],e.res[1])&&Math.max(_,r)==Math.max(e.res[0],e.res[1])}function S(e,t,_,r){if(1!=e.format||!e.devices||!e.devices.length)return L.error("DPDB isn't correct."),-1;for(var a=0;a<e.devices.length;a++){var n=e.devices[a];if(n.rules&&("ios"==n.type&&V||"android"==n.type)){for(var o=!1,i=0;i<n.rules.length;i++){if(A(n.rules[i],t,_,r)){o=!0;break}}if(o)return a}}return-1}function p(e){var t=navigator.userAgent||navigator.vendor||window.opera,_=f(),r=P(),a=0,n=0,o=0,i=S(ee,t,_,r);if(-1!=i){var s=ee.devices[i],E=s.dpi[0]||s.dpi,c=s.dpi[1]||s.dpi;a=Math.round(_*z/E),n=Math.round(r*z/c),o=Math.round(s.bw)}var l=M.get("hmd_conf","b4w"),T=JSON.parse(l||"{}");e?(F.first_distortion=G,F.second_distortion=k,F.bevel_size=o||K,F.screen_width=a||B,F.screen_height=n||X,F.screen_lense=H,F.ipd=j,F.baseline=Q):(F.first_distortion="first_distortion"in T?parseFloat(T.first_distortion):G,F.second_distortion="second_distortion"in T?parseFloat(T.second_distortion):k,F.bevel_size="bevel_size"in T?parseFloat(T.bevel_size):o||K,F.screen_width="screen_width"in T?parseFloat(T.screen_width):a||B,F.screen_height="screen_height"in T?parseFloat(T.screen_height):n||X,F.screen_lense="screen_lense"in T?parseFloat(T.screen_lense):H,F.ipd="ipd"in T?parseFloat(T.ipd):j,F.baseline="baseline"in T?parseFloat(T.baseline):Q),D=!0}function O(){M.set("hmd_conf",JSON.stringify(F),"b4w"),l()}function v(){if(D){var e=Y.get_device_by_type_element(Y.DEVICE_HMD);e&&(Y.set_config(e,Y.HMD_DISTORTION,[F.first_distortion,F.second_distortion]),Y.get_value_param(e,Y.HMD_WEBVR_TYPE)&(Y.HMD_NON_WEBVR|Y.HMD_WEBVR_MOBILE)&&(Y.set_config(e,Y.HMD_BEVEL_SIZE,F.bevel_size*q),Y.set_config(e,Y.HMD_SCREEN_WIDTH,F.screen_width*q),Y.set_config(e,Y.HMD_SCREEN_HEIGHT,F.screen_height*q),Y.set_config(e,Y.HMD_SCREEN_LENS_DIST,F.screen_lense*q),Y.set_config(e,Y.HMD_EYE_DISTANCE,F.ipd*q),Y.set_config(e,Y.HMD_BASELINE_DIST,F.baseline*q))),D=!1}}function m(e){var t=e.target.id,_=t.split("_"),r=_.splice(0,_.length-1).join("_");if(r in F&&F[r]!=e.target.value){D=!0,F[r]=e.target.value;document.getElementById(r+"_slider").value=e.target.value;document.getElementById(r+"_number").value=e.target.value}}function N(e,t){var _=document.createElement("div"),r=document.createElement("label");r.className="text_label";var a="8px";t%2&&(a="0"),r.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;width: 100%;height: 30px;display: block;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: left;padding-left: 8px;line-height: 28px;margin-bottom: 4px;box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);",r.textContent=e.label,_.appendChild(r),_.style.cssText="margin-top: 16px;float: left;width: 240px;margin-right: "+a+";border-top: 2px solid rgba(98, 98, 98, .4);box-sizing: border-box;-webkit-box-sizing: border-box;padding-top: 8px;";for(var n=0;n<e.inputs.length;n++){var o=e.inputs[n],i=g(o);_.appendChild(i)}return _}function g(e){var t=document.createElement("div");t.className="row";var _=document.createElement("input");_.className="input_slider",_.style.cssText="-webkit-appearance: none;width: 192px;display: block;float: left;height: 8px;margin-bottom: 16px;margin-top: 16px;box-sizing: border-box;margin-right: 8px;margin-left: 0;",_.setAttribute("id",e.id+"_slider"),_.setAttribute("type","range"),_.setAttribute("min","0.00"),_.setAttribute("step",e.step),_.setAttribute("value",F[e.id]),_.setAttribute("max",e.max),t.appendChild(_);var r=document.createElement("input");return r.className="input_text",r.setAttribute("id",e.id+"_number"),r.setAttribute("type","number"),r.setAttribute("min","0.00"),r.setAttribute("step",e.step),r.setAttribute("value",F[e.id]),r.setAttribute("max",e.max),t.appendChild(r),r.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;width: 40px;height: 30px;display: block;float: left;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: center;box-sizing: border-box;line-height: 28px;margin-top: 4px;margin-right: 0;margin-left: 0;box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);",x.is_ie11()?(_.onchange=m,r.onchange=m):(_.oninput=m,r.oninput=m),t}function R(){var e=document.createElement("div"),t=I(O,"SAVE","4px"),_=I(l,"CANCEL","4px"),r=I(T,"RESET","0px");return e.className="row",e.style.cssText="padding-top: 32px;clear: both;box-sizing: border-box;-webkit-box-sizing: border-box;",e.appendChild(t),e.appendChild(_),e.appendChild(r),e}function I(e,t,_){var r=document.createElement("button");return r.onclick=e,r.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;width: 160px;height: 30px;display: block;float: left;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: center;padding-left: 8px;line-height: 28px;margin-right:"+_+";box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);",r.innerHTML=t,r}var b=Object(n.a)(e),h=Object(o.a)(e),Y=Object(i.a)(e),L=Object(s.a)(e),M=Object(E.a)(e),x=Object(c.a)(e),y=!1,U=null,w=null,C=null,D=!0,F={profile:"custom",first_distortion:0,second_distortion:0,bevel_size:0,screen_width:0,screen_height:0,screen_lense:0,ipd:0,baseline:0},G=.34,k=.55,K=4,B=110,X=65,H=50,j=64,Q=32,z=25.4,V=/iPad|iPhone|iPod/.test(navigator.platform),q=.001,W=0,J=1,Z={oculus_dk2:{name:"Oculus Rift DK2",type:2,first_distortion:.22,second_distortion:.28},cardboard_1:{name:"Cardboard (2014)",type:J,ipd:60,baseline:35,screen_lense:42,first_distortion:.441,second_distortion:.156},cardboard_2:{name:"Cardboard (2015)",type:J,ipd:64,baseline:35,screen_lense:39,first_distortion:.34,second_distortion:.55},custom:{name:"Custom",type:W,ipd:64,baseline:35,screen_lense:39,first_distortion:0,second_distortion:0}},$=[{label:"Tray to lens-center distance.",is_mobile:!0,inputs:[{id:"baseline",max:"50",step:"0.5"}]},{label:"Interpupillary distance.",is_mobile:!0,inputs:[{id:"ipd",max:"100",step:"1"}]},{label:"Screen to lense distance.",is_mobile:!0,inputs:[{id:"screen_lense",max:"100",step:"1"}]},{label:"Screen height.",is_mobile:!0,inputs:[{id:"screen_height",max:"150",step:"1"}]},{label:"Screen width.",is_mobile:!0,inputs:[{id:"screen_width",max:"200",step:"1"}]},{label:"Bevel width.",is_mobile:!0,inputs:[{id:"bevel_size",max:"20",step:"1"}]},{label:"Distortion coefficients.",inputs:[{id:"first_distortion",max:"1.0",step:"0.01"},{id:"second_distortion",max:"1.0",step:"0.01"}]}];t.check=_,t.show=function(e){if(_()){var t=b.get_container();if(w=document.createElement("style"),w.innerHTML="."+e+" input[type=range]::-webkit-slider-runnable-track {width: 100%; height: 8px;cursor: pointer;background-color: #fff;border: 2px solid rgba(98, 98, 98, .2);box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);}."+e+" input[type=range]::-webkit-slider-thumb {box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);height: 30px;width: 16px;border-radius: 2px;background-color: #323232;cursor: pointer;margin-top: -13px;-webkit-appearance: none;}",document.head.appendChild(w),!y){y=!0,p();var a=Y.get_device_by_type_element(Y.DEVICE_MOUSE,t);Y.switch_prevent_default(a,!1);var n=Y.get_device_by_type_element(Y.DEVICE_TOUCH,t);Y.switch_prevent_default(n,!1),U=document.createElement("div"),U.className=e,t.appendChild(U),C=document.createElement("div"),U.appendChild(C),C.style.cssText="background-color: #484848;border: 2px solid rgba(150, 150, 150, 0.7);box-shadow: 0px 0px 10px 0px rgba(150, 150, 150, 0.7);position: relative;width: 524px;padding: 16px;overflow: hidden;";var o=r();C.appendChild(o);for(var i=Y.get_device_by_type_element(Y.DEVICE_HMD),s=0;s<$.length;s++)if(Y.get_value_param(i,Y.HMD_WEBVR_TYPE)&(Y.HMD_NON_WEBVR|Y.HMD_WEBVR_MOBILE)||!$[s].is_mobile){var E=N($[s],s);C.appendChild(E)}var c=R();C.appendChild(c);var l=h.create_timeline_sensor();h.create_sensor_manifold(null,"UPDATE_HMD_RENDERING",h.CT_CONTINUOUS,[l],null,v)}}},t.hide=l,t.reset=T,t.update=function(){p(),v()};var ee={_comment:"AUTOMATICALLY GENERATED BY generate_dpdb.py. DO NOT EDIT.",format:1,last_updated:"2016-01-26T23:11:18Z",devices:[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,401.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],dpi:[403.4,402.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],dpi:[217.7,231.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],dpi:285.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1e3},{type:"ios",rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1e3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1e3}]}}var a=_(0),n=_(39),o=_(24),i=_(49),s=_(1),E=_(69),c=_(26),l=Object(a.a)("hmd_conf",r);t.a=l},function(e,t,_){"use strict";function r(e,t){function _(){y.length=0,U=0,w=r(100),C=new Float32Array(w.length),D=new Float32Array(w.length);var e=L.get_speaker_objects();if(e.length){y.push(a());for(var t=0;t<e.length;t++){var _=e[t];y.push(T(_))}y.sort(function(e,t){return"MASTER"==e.id?-1:"MASTER"==t.id?1:"COMPRESSOR"==e.id?-1:"COMPRESSOR"==t.id?1:e.id.toUpperCase()<t.id.toUpperCase()?-1:e.id.toUpperCase()>t.id.toUpperCase()?1:0})}}function r(e){for(var t=new Float32Array(e),_=0,r=0;r<e;r++)t[r]=20*Math.pow(1e3,_),_+=1/(e-1);return t}function a(){var e=l("MASTER"),t=L.get_compressor_params();return t&&(e.params.push(["THRESHOLD",t.threshold,-100,0,100,!1]),e.params.push(["KNEE",t.knee,0,40,40,!1]),e.params.push(["RATIO",t.ratio,1,20,20,!1]),e.params.push(["ATTACK",t.attack,0,1,1e3,!1]),e.params.push(["RELEASE",t.release,0,1,1e3,!1])),e.params.push(["VOLUME",L.get_volume(null),0,1,50,!1]),e.mute=L.is_muted(null)?1:0,e.solo=-1,e}function l(e){return{id:e,params:[],active_param:0,mute:-1,solo:-1,speaker:null}}function T(e){var t=l(h.get_object_name(e));return t.mute=L.is_muted(e)?1:0,t.solo=0,t.speaker=e,t}function d(e){if(y.length){1==e&&U<y.length-1?U++:-1==e&&U>0&&U--;for(var t=R(),_=t[0];_<=t[1];_++)u(y[_])}}function u(e){if(e.speaker){e.params.length=0;var t=L.get_positional_params(e.speaker);t&&(e.params.push(["DIST_REF",t.dist_ref,0,1e3,1e4,!1]),e.params.push(["ATTENUATION",t.attenuation,0,50,1e3,!1]),e.params.push(["DIST_MAX",t.dist_max,0,1e4,1e4,!1]));var _=L.get_filter_params(e.speaker);_&&(e.params.push(["EQ_FREQ",_.freq,20,2e4,100,!0]),e.params.push(["EQ_Q",_.Q,0,10,100,!1]),e.params.push(["EQ_GAIN",_.gain,-70,30,100,!1])),e.params.push(["VOLUME",L.get_volume(e.speaker),0,1,50,!1]),M.clamp(e.active_param,0,e.params.length-1)}}function f(e){var t=y[U];t&&(1==e&&t.active_param<t.params.length-1?t.active_param++:-1==e&&t.active_param>0&&t.active_param--)}function P(e){var t=y[U];if(t){var _=t.params[t.active_param];switch(_[5]?_[1]*=Math.pow(_[3]/_[2],e/_[4]):_[1]+=e*((_[3]-_[2])/_[4]),_[1]=M.clamp(_[1],_[2],_[3]),_[0]){case"VOLUME":"MASTER"!=t.id?L.set_volume(t.speaker,_[1]):L.set_volume(null,_[1]);break;case"DIST_REF":var r=L.get_positional_params(t.speaker);r.dist_ref=_[1],L.set_positional_params(t.speaker,r);break;case"ATTENUATION":var r=L.get_positional_params(t.speaker);r.attenuation=_[1],L.set_positional_params(t.speaker,r);break;case"DIST_MAX":var r=L.get_positional_params(t.speaker);r.dist_max=_[1],L.set_positional_params(t.speaker,r);break;case"EQ_FREQ":var a=L.get_filter_params(t.speaker);a.freq=_[1],L.set_filter_params(t.speaker,a);break;case"EQ_Q":var a=L.get_filter_params(t.speaker);a.Q=_[1],L.set_filter_params(t.speaker,a);break;case"EQ_GAIN":var a=L.get_filter_params(t.speaker);a.gain=_[1],L.set_filter_params(t.speaker,a);break;case"THRESHOLD":var n=L.get_compressor_params();n.threshold=_[1],L.set_compressor_params(n);break;case"KNEE":var n=L.get_compressor_params();n.knee=_[1],L.set_compressor_params(n);break;case"RATIO":var n=L.get_compressor_params();n.ratio=_[1],L.set_compressor_params(n);break;case"ATTACK":var n=L.get_compressor_params();n.attack=_[1],L.set_compressor_params(n);break;case"RELEASE":var n=L.get_compressor_params();n.release=_[1],L.set_compressor_params(n);break;default:b.error("Unknown strip param")}}}function A(){var e=y[U];e&&e.mute>=0&&S(e)}function S(e){"MASTER"!=e.id?0==e.mute?(e.mute=1,L.mute(e.speaker,!0),1==e.solo&&(e.solo=0,p(e)||v(e))):(e.mute=0,p(e)||L.mute(e.speaker,!1)):0==e.mute?(e.mute=1,L.mute(null,!0)):(e.mute=0,L.mute(null,!1))}function p(e){for(var t=0;t<y.length;t++){var _=y[t];if(_!=e&&1==_.solo)return!0}return!1}function O(e){for(var t=0;t<y.length;t++){var _=y[t];_!=e&&0==_.mute&&0==_.solo&&L.mute(_.speaker,!0)}}function v(e){for(var t=0;t<y.length;t++){var _=y[t];_!=e&&0==_.mute&&0==_.solo&&L.mute(_.speaker,!1)}}function m(){var e=y[U];e&&e.solo>=0&&N(e)}function N(e){0==e.solo?(e.solo=1,L.mute(e.speaker,!1),1==e.mute&&(e.mute=0),O(e)):(e.solo=0,p(e)?L.mute(e.speaker,!0):v(e))}function g(){if(y[U])for(var e=R(),t=e[0];t<=e[1];t++){var _=y[t];if(Y.draw_mixer_strip(_.id,t==U,t%8,_.params,_.active_param,_.mute,_.solo),_.speaker&&L.get_filter_params(_.speaker)){L.get_filter_freq_response(_.speaker,w,C,D);for(var r=0;r<C.length;r++){var a=C[r];C[r]=20*Math.log(a)/Math.LN10}Y.plot_array("EQ",t%8,C,20,2e4,-10,10)}}}function R(){if(0==y.length)return[0,-1];var e=8*Math.floor(U/8),t=e+7;return e=M.clamp(e,0,y.length-1),t=M.clamp(t,0,y.length-1),[e,t]}var I=Object(n.a)(e),b=Object(o.a)(e),h=Object(i.a)(e),Y=Object(s.a)(e),L=Object(E.a)(e),M=Object(c.a)(e),x=["SWITCH_STRIP","SWITCH_STRIP_HOLD","SWITCH_PARAM","INC_DEC","INC_DEC_HOLD","MUTE_SOLO"],y=[],U=0,w=null,C=null,D=null;t.enable_mixer_controls=function(){_();var e=I.create_keyboard_sensor(I.KEY_NUM4),t=I.create_keyboard_sensor(I.KEY_NUM6),r=I.create_keyboard_sensor(I.KEY_NUM8),a=I.create_keyboard_sensor(I.KEY_NUM2),n=I.create_keyboard_sensor(I.KEY_ADD),o=I.create_keyboard_sensor(I.KEY_SUB),i=I.create_keyboard_sensor(I.KEY_NUM7),s=I.create_keyboard_sensor(I.KEY_NUM9),E=I.create_timer_sensor(.15,!0),c=I.create_timer_sensor(.05,!0),l=[e,t,E],T=function(e){return e[0]||e[1]},S=function(e){return(e[0]||e[1])&&e[2]},p=function(e,t,_){if(1==_){d(Boolean(I.get_sensor_value(e,t,0))?-1:1),"SWITCH_STRIP"==t?I.reset_timer_sensor(e,t,2,.15+.3):I.reset_timer_sensor(e,t,2,.15)}else I.reset_timer_sensor(e,t,2,10)};I.create_sensor_manifold(null,"SWITCH_STRIP",I.CT_TRIGGER,l,T,p),I.create_sensor_manifold(null,"SWITCH_STRIP_HOLD",I.CT_SHOT,l,S,p);var O=[r,a],v=function(e){return e[0]||e[1]},N=function(e,t,_){f(Boolean(I.get_sensor_value(e,t,0))?-1:1)};I.create_sensor_manifold(null,"SWITCH_PARAM",I.CT_SHOT,O,v,N);var b=[o,n,c],h=function(e,t,_){if(1==_){P(Boolean(I.get_sensor_value(e,t,0))?-1:1),"INC_DEC"==t?I.reset_timer_sensor(e,t,2,.35):I.reset_timer_sensor(e,t,2,.05)}else I.reset_timer_sensor(e,t,2,10)},Y=function(e){return e[0]||e[1]},L=function(e){return(e[0]||e[1])&&e[2]};I.create_sensor_manifold(null,"INC_DEC",I.CT_TRIGGER,b,Y,h),I.create_sensor_manifold(null,"INC_DEC_HOLD",I.CT_SHOT,b,L,h);var M=[i,s],x=function(e,t,_){Boolean(I.get_sensor_value(e,t,0))?A():m()},U=function(e){return e[0]||e[1]};I.create_sensor_manifold(null,"MUTE_SOLO",I.CT_SHOT,M,U,x);var w=I.create_elapsed_sensor();I.create_sensor_manifold(null,"MIXER_DRAW",I.CT_CONTINUOUS,[w],null,function(){g()});var C=I.create_timer_sensor(1,!0);I.create_sensor_manifold(null,"MIXER_UPDATE",I.CT_TRIGGER,[C],null,function(){for(var e=R(),t=e[0];t<=e[1];t++)u(y[t])})},t.disable_mixer_controls=function(){for(var e=0;x.length;e++)I.remove_sensor_manifold(null,x[e])}}var a=_(0),n=_(24),o=_(1),i=_(29),s=_(50),E=_(82),c=_(26),l=Object(a.a)("mixer",r);t.a=l},function(e,t,_){"use strict";function r(e,t){function _(){j==D&&(j=C);var e=document.exitPointerLock||document.webkitExitPointerLock||document.mozExitPointerLock;"function"==typeof e&&e.apply(document),I.remove_sensor_manifold(Y.get_active_camera(),"SMOOTH_PL")}function r(e,t,r,a){if(j!=F){j=F,_(),X=t||function(){return!0},r=r||A,z=Boolean(a),e.addEventListener("mousedown",u,!1),e.addEventListener("mouseup",f,!1);var n=Y.get_active_camera();if(!I.check_sensor_manifold(n,"SMOOTH_DRAG")){var o=I.create_elapsed_sensor();I.create_sensor_manifold(n,"SMOOTH_DRAG",I.CT_CONTINUOUS,[o],null,P,r)}}}function a(e){j==F&&(j=C),e.removeEventListener("mousedown",u,!1),e.removeEventListener("mouseup",f,!1),e.removeEventListener("mousemove",d,!1),I.remove_sensor_manifold(Y.get_active_camera(),"SMOOTH_DRAG")}function d(e){if(X()){if(z)var t=R.get_coords_target_space(e,B);else{var t=B;t[0]=e.clientX,t[1]=e.clientY}K[0]+=(t[0]-G)*y,K[1]+=(t[1]-k)*y,G=t[0],k=t[1]}e.preventDefault()}function u(e){if(z)var t=R.get_coords_target_space(e,B);else{var t=B;t[0]=e.clientX,t[1]=e.clientY}G=t[0],k=t[1],e.currentTarget.addEventListener("mousemove",d,!1),e.preventDefault()}function f(e){e.currentTarget.removeEventListener("mousemove",d,!1),e.preventDefault()}function P(e,t,_,r){if(Math.abs(K[0])>.01||Math.abs(K[1])>.01){var a=I.get_sensor_value(e,t,0),n=L.smooth(K[0],0,a,N()),o=L.smooth(K[1],0,a,N());K[0]-=n,K[1]-=o,r(-n*x,-o*x)}}function A(e,t){var _=Y.get_first_character(),r=Y.get_active_camera();if(g.rotate_camera(r,e,t),_){var a=g.get_camera_angles_char(r,B);b.set_character_rotation_h(_,a[0]),b.set_character_vert_move_dir_angle(_,a[1])}}function S(e){if(Q=Boolean(e),!M.detect_mobile()){R.get_canvas().addEventListener("mousemove",O)}}function p(){if(!M.detect_mobile()){R.get_canvas().removeEventListener("mousemove",O),H&&Y.set_outline_intensity(H,0)}}function O(e){if(Q)var t=R.get_coords_target_space(e,!1,B),_=Y.pick_object(t[0],t[1]);else var _=Y.pick_object(e.clientX,e.clientY);_?(Y.outlining_is_enabled(_)&&Y.set_outline_intensity(_,1),Y.outlining_is_enabled(H)&&_!=H&&Y.set_outline_intensity(H,0)):Y.outlining_is_enabled(H)&&Y.set_outline_intensity(H,0),H=_}function v(e,t,_){if(_)return R.get_coords_target_space(e,t,B)[0];if("clientX"in e)return e.clientX;if("touchend"==e.type)var r=e.changedTouches;else var r=t?e.targetTouches:e.touches;return r&&r[0]&&"clientX"in r[0]?r[0].clientX:-1}function m(e,t,_){if(_)return R.get_coords_target_space(e,t,B)[1];if("clientY"in e)return e.clientY;if("touchend"==e.type)var r=e.changedTouches;else var r=t?e.targetTouches:e.touches;return r&&r[0]&&"clientY"in r[0]?r[0].clientY:-1}function N(){return w*U}var g=Object(n.a)(e),R=Object(o.a)(e),I=Object(i.a)(e),b=Object(s.a)(e),h=Object(E.a)(e),Y=Object(c.a)(e),L=Object(l.a)(e),M=Object(T.a)(e),x=4e-4,y=2,U=1,w=.1,C=0,D=1,F=2,G=0,k=0,K=new Float32Array(2),B=new Float32Array(2),X=null,H=null,j=C,Q=!1,z=!1;t.request_pointerlock=function(e,t,_,r,n,o){function i(){if(document.pointerLockElement===e||document.webkitPointerLockElement===e||document.mozPointerLockElement===e){a(e),e.addEventListener("mousemove",r,!1);var n=Y.get_active_camera();if(!I.check_sensor_manifold(n,"SMOOTH_PL")){var s=I.create_elapsed_sensor();I.create_sensor_manifold(n,"SMOOTH_PL",I.CT_CONTINUOUS,[s],null,P,o)}t()}else e.removeEventListener("mousemove",r,!1),j=C,document.removeEventListener("pointerlockchange",i,!1),document.removeEventListener("webkitpointerlockchange",i,!1),document.removeEventListener("mozpointerlockchange",i,!1),_()}if(j!=D){j=D,t=t||function(){},_=_||function(){},o=o||A,n=n||function(){return!0},r=r||function(e){if(n()){if("number"==typeof e.movementX)var t=e.movementX,_=e.movementY;else if("number"==typeof e.webkitMovementX)var t=e.webkitMovementX,_=e.webkitMovementY;else if("number"==typeof e.mozMovementX)var t=e.mozMovementX,_=e.mozMovementY;else var t=0,_=0;K[0]+=t,K[1]+=_}},document.addEventListener("pointerlockchange",i,!1),document.addEventListener("webkitpointerlockchange",i,!1),document.addEventListener("mozpointerlockchange",i,!1);var s=e.requestPointerLock||e.webkitRequestPointerLock||e.mozRequestPointerLock;"function"==typeof s?s.apply(e):h.error("Pointer lock is not available")}},t.exit_pointerlock=_,t.check_pointerlock=function(e){return"function"==typeof(e.requestPointerLock||e.webkitRequestPointerLock||e.mozRequestPointerLock)},t.request_mouse_drag=r,t.exit_mouse_drag=a,t.enable_mouse_hover_outline=S,t.disable_mouse_hover_outline=p,t.get_coords_x=v,t.get_coords_y=m,t.set_plock_smooth_factor=function(e){U=e},t.get_plock_smooth_factor=function(){return U}}var a=_(0),n=_(33),o=_(39),i=_(24),s=_(54),E=_(1),c=_(29),l=_(26),T=_(60),d=Object(a.a)("mouse",r);t.a=d},function(e,t,_){"use strict";function r(e,t){function _(){return{obj:null,rig:null,collider:null,empty:null,type:$,state:_e,actions:{},base_pos:new Float32Array(3),destination:new Float32Array(3),path:[],start:[],ended:[],fired:[],delay:[],random:!0,reached:!0,ground_level:0,vert_correction:0,vert_cor_water:0,rotation_mult:1,speed:1,rot_speed:.1,max_height:0,min_height:0,max_depth:0,min_depth:0}}function r(e,t){var _=t.destination,r=t.base_pos,n=z;K.get_translation(t.collider,n);var o=0,i=n[2];switch(_[2]=i,t.type){case $:if(t.random&&t.reached&&(_[0]=(12*Math.random()-6)*t.speed+r[0],_[1]=-(12*Math.random()-6)*t.speed+r[1],a(t,_,n),t.reached=!1),t.ground_level){o=t.ground_level-i;var s=t.speed*e;o>s?o=s:o<-s&&(o=-s)}t.vert_correction=o;break;case ee:case te:if(t.vert_cor_water?o=t.vert_cor_water:t.vert_correction&&(o=t.vert_correction,t.type==te&&(o*=e)),t.random&&t.reached){if(t.type==te){t.speed=Math.random()+.1;var E=t.max_depth-t.min_depth}else var E=t.max_height-t.min_height;_[0]=10*Math.random()-5+r[0],_[1]=10*Math.random()-5+r[1],_[2]=i-(Math.random()*E-.5*E),t.reached=!1}}o&&(_[2]=i+o),f(e,t)}function a(e,t,_){var r=J,a=V,n=e.speed,o=e.rot_speed;K.get_rotation(e.collider,r),l.transformQuat(H.AXIS_MY,r,a),a[2]=0,l.normalize(a,a);var i=Math.sin(o/2),s=.5*n/i,E=l.dist(t,_);E<2*s&&l.scaleAndAdd(t,a,2*s-E,t)}function f(e,t){var _=Q,r=z,a=V,n=Z,o=t.rig,i=t.collider,s=t.destination,E=t.speed,c=t.actions,l=D.get_current_anim_name(o);if(!D.is_play(o)||!c.idle||-1==c.idle.indexOf(l)){K.get_translation(i,_);var T=s[0]-_[0],d=s[1]-_[1],u=Math.sqrt(T*T+d*d);u>2*E*e?(t.state=re,H.horizontal_direction(s,_,a),C(t,s,u,a),P(t,r,e,n,a),A(t,r,e,n),K.set_rotation_v(i,n),S(e,n,t,_,s)):t.type==$?c.move&&l&&-1!=c.move.indexOf(l)&&D.is_play(o)?t.state=re:(t.state=_e,t.reached=!0):t.type!=te&&t.type!=ee||(t.reached=!0),b(t)&&h(t)}}function P(e,t,_,r,a){var n=J,o=q;K.get_rotation(e.collider,n),l.transformQuat(H.AXIS_MY,n,t),o[0]=t[0],o[1]=t[1],o[2]=0,l.normalize(o,o);var s=l.dot(o,a),E=Math.acos(s),c=Math.abs(E)/Math.PI,T=_/c*e.rot_speed*e.rotation_mult;if(i.rotationTo(o,a,r),i.rotationTo(H.AXIS_MY,o,n),Math.abs(s)>=1)return void i.copy(n,r);i.multiply(r,n,r),i.slerp(n,r,Math.min(T,1),r)}function A(e,t,_,r){if(e.type!=ee){_=Math.max(_,1/60);var a=W,n=J,o=Math.asin(-t[2]);i.setAxisAngle(H.AXIS_X,-o,n);var s=e.speed*_,E=e.vert_correction,c=Math.atan(E/s);i.setAxisAngle(H.AXIS_X,-c,a),i.slerp(n,a,_,a),i.multiply(r,a,r)}}function S(e,t,_,r,a){var n=V,o=q,i=H.AXIS_MY;H.quat_to_dir(t,i,n),l.scale(n,_.speed*e,o),l.add(o,r,o),_.type!=$?o[2]=(a[2]-r[2])*e*.1+r[2]:o[2]=a[2],K.set_translation_v(_.collider,o)}function p(e,t){if(G.is_visible(e.obj))if(e.random)r(t,e);else{for(var _=k.get_timeline(),a=0;a<e.path.length;a++)if(!e.ended[a]){if(e.fired[a]||(e.fired[a]=!0,e.destination[0]=e.path[a][0],e.destination[1]=e.path[a][1],e.destination[2]=e.path[a][2],e.start[a]=_+e.delay[a]),_<e.start[a])break;r(t,e),e.ended[a]=e.reached;break}v(e)&&O(e)}}function O(e){for(var t=0;t<e.path.length;t++)e.fired[t]=!1,e.ended[t]=!1}function v(e){for(var t=0;t<e.path.length;t++)if(0==e.ended[t])return!1;return!0}function m(e,t,_,r){if(r)if(1==_)switch(r.type){case ee:var a=100*N(e,t);a<r.min_height?r.vert_correction=10:a>r.max_height?r.vert_correction=-10:r.vert_correction=0;break;case $:var n=F.get_sensor_payload(e,t,0);r.ground_level=n.hit_pos[2];break;case te:var n=F.get_sensor_payload(e,t,0);"CLOSE_GROUND"==t?(r.vert_correction=100*n.hit_fract-1,r.vert_correction<.1?r.vert_correction=.05:r.vert_correction=0):"CLOSE_WATER"==t&&(r.vert_cor_water=100*n.hit_fract,r.vert_cor_water<r.min_depth?r.vert_cor_water=-.02:r.vert_cor_water>r.max_depth?r.vert_cor_water=.02:r.vert_cor_water=0)}else r.vert_correction=0}function N(e,t){for(var _=0;_<3;_++){var r=F.get_sensor_payload(e,t,_).hit_fract;if(r)return r}}function g(){for(var e=0;e<j.length;e++){var t=j[e];R(t),I(t),D.get_current_anim_name(t.rig)&&D.play(t.rig)}}function R(e){var t=l.create(),_=e.collider;switch(e.type){case ee:var r=F.create_ray_sensor(_,t,[0,0,-100],"TERRAIN",!0,!0),a=F.create_ray_sensor(_,t,[0,0,-100],"STONE",!0,!0),n=F.create_ray_sensor(_,t,[0,0,-100],"WATER",!0,!0),o=[r,a,n];F.create_sensor_manifold(_,"CLOSE_GROUND",F.CT_CONTINUOUS,o,function(e){return e[0]||e[1]||e[2]},m,e);break;case $:var r=F.create_ray_sensor(_,[0,0,1],[0,0,-99],"TERRAIN",!0,!0),o=[r];F.create_sensor_manifold(_,"CLOSE_GROUND",F.CT_CONTINUOUS,o,null,m,e);break;case te:var r=F.create_ray_sensor(_,[0,0,1],[0,0,-99],"TERRAIN",!0,!0),n=F.create_ray_sensor(_,t,[0,0,100],"WATER",!0,!0),o=[r],i=[n];F.create_sensor_manifold(_,"CLOSE_WATER",F.CT_CONTINUOUS,i,null,m,e),F.create_sensor_manifold(_,"CLOSE_GROUND",F.CT_CONTINUOUS,o,null,m,e)}}function I(e){function t(t,_,r){1==r?(l.copy(e.base_pos,e.destination),e.rotation_mult=4):e.rotation_mult=1}var _=e.collider;if(e.type==$){var r=F.create_collision_sensor(_,"CONSTRUCTION",!1);F.create_sensor_manifold(_,"CONSTRUCTION_COLL",F.CT_CONTINUOUS,[r],null,t)}}function b(e){var t=e.rig;if(!D.is_play(t))return!0;var _=D.get_current_anim_name(t);if(!_)return!0;var r=e.actions;switch(e.state){case _e:if(!r.idle)return!1;if(-1==r.idle.indexOf(_))return!0;break;case re:if(!r.move)return!1;if(-1!=r.move.indexOf(_))return!1;if(r.move_start&&-1!=r.move_start.indexOf(_))return!1;if(r.move_blends&&-1!=r.move_blends.indexOf(_))return!1;break;default:return!1}return!0}function h(e){var t=e.rig;if(!D.is_play(t)){var _=null;switch(e.state){case _e:_=Y(e);break;case re:_=L(e)}_&&(D.apply(t,_),D.set_behavior(t,D.AB_FINISH_RESET),D.set_frame(t,0),D.play(t))}}function Y(e){var t=e.actions;return t.idle?H.random_from_array(t.idle):null}function L(e){var t=D.get_current_anim_name(e.rig),_=e.actions;return x(e,t)?U(e,t):M(e,t)?w(e,t):y(e,t)?H.random_from_array(_.move_start):null}function M(e,t){var _=e.actions;return!!_.move&&(-1!=_.move.indexOf(t)||(!_.move_blends&&!_.move_start||(!_.move_start&&!t||(!(!_.move_blends||-1==_.move_blends.indexOf(t))||!(!_.move_start||-1==_.move_start.indexOf(t))))))}function x(e,t){var _=e.actions;if(!_.move_blends)return!1;if(-1!=_.move_blends.indexOf(t))return!1;if(_.move&&-1!=_.move.indexOf(t)){return Math.random()>.33}return!1}function y(e,t){var _=e.actions;return!!_.move_start&&(-1==_.move_start.indexOf(t)&&!(!_.move||-1!=_.move.indexOf(t)))}function U(e,t){var _=e.actions,r=_.move.indexOf(t);return _.move_blends[r]}function w(e,t){var _=e.actions;if(!_.move_blends)return H.random_from_array(_.move);var r=_.move_blends.indexOf(t);if(-1!=r){var a=r+1;return a=a<_.move.length?a:0,_.move[a]}return-1!=_.move.indexOf(t)?t:H.random_from_array(_.move)}function C(e,t,_,r){var a=e.rig;if(D.is_animated(a)){var n=e.speed,o=_,i=D.get_frame(a),s=D.get_anim_length(a),E=s/24*n,c=(1-i/s)*E;if(o/c<.9){var T=c-o;l.scaleAndAdd(t,r,T,t)}}}var D=Object(n.a)(e),F=Object(o.a)(e),G=Object(s.a)(e),k=Object(E.a)(e),K=Object(c.a)(e),B=Object(T.a)(e),X=Object(d.a)(e),H=Object(u.a)(e),j=[],Q=new Float32Array(3),z=new Float32Array(3),V=new Float32Array(3),q=new Float32Array(3),W=new Float32Array(4),J=new Float32Array(4),Z=new Float32Array(4),$=t.NT_WALKING=10,ee=t.NT_FLYING=20,te=t.NT_SWIMMING=30,_e=10,re=20;t.new_event_track=function(e){var t=_();if("object"!=typeof e.obj)return void X.error("Can't create event track. Wrong object.");if("object"!=typeof e.rig)return void X.error("Can't create event track. Wrong rig object.");if("object"!=typeof e.collider||!B.has_physics(e.collider))return void X.error("Can't create event track. Wrong collider object.");if(t.obj=e.obj,t.collider=e.collider,t.rig=e.rig,K.get_translation(e.collider,t.base_pos),"object"==typeof e.actions&&(t.actions=e.actions),"boolean"==typeof e.random&&(t.random=e.random),"number"==typeof e.type&&(t.type=e.type),"number"==typeof e.speed&&(t.speed=e.speed),"number"==typeof e.rot_speed&&(t.rot_speed=e.rot_speed),"number"==typeof e.max_height&&(t.max_height=e.max_height),"number"==typeof e.min_height&&(t.min_height=e.min_height),!t.random){for(var r=0;r<e.path.length;r++)t.start[r]=-1,t.ended[r]=!1,t.fired[r]=!1;t.path=e.path,t.delay=e.delay}var a=e.actions,n=D.get_current_anim_name(t.rig);for(var o in a)for(var i=a[o],s=0;s<i.length;s++)D.apply(t.rig,i[s]);n&&D.apply(t.rig,n),j.push(t)},t.enable_animation=function(){if(j.length){g();var e=function(e,t,_){if(1==_)for(var r=F.get_sensor_value(e,t,0),a=0;a<j.length;a++)p(j[a],r)},t=F.create_elapsed_sensor();F.create_sensor_manifold(j[0].collider,"ELAPSED",F.CT_CONTINUOUS,[t],function(e){return e[0]},e)}},t.disable_animation=function(){if(!(j.length<=0))for(var e=0;e<j.length;e++){var t=j[e];F.check_sensor_manifolds(t.collider)&&F.remove_sensor_manifold(t.collider),D.is_play(t.rig)&&D.stop(t.rig)}}}var a=_(0),n=_(83),o=_(24),i=_(9),s=_(29),E=_(68),c=_(40),l=_(3),T=_(54),d=_(1),u=_(26),f=Object(a.a)("npc_ai",r);t.a=f},function(e,t,_){"use strict";function r(e,t){var _=Object(n.a)(e),r={},a=null;t.create_preloader=function(e){var t="#484848",a="#5276cf",n="rgba(150, 150, 150, 0.7)",o="#fff";for(var i in e)switch(i){case"container_color":t=e.container_color;break;case"bar_color":a=e.bar_color;break;case"frame_color":n=e.frame_color;break;case"font_color":o=e.font_color}var s=document.createElement("div"),E=s.cloneNode(!1),c=s.cloneNode(!1),l=s.cloneNode(!1),T=_.get_container();c.appendChild(E),c.appendChild(l),s.appendChild(c),T.appendChild(s),s.style.cssText="background-color: "+t+";width: 100%;height: 100%;position: absolute;top: 0;left: 0;",c.style.cssText="position: absolute;left: 50%;top: 50%;margin-left: -150px;margin-top: -30px;width: 300px;height: 28px;box-shadow: 0px 0px 10px 0px "+n+";border: 2px solid "+n+";",E.style.cssText="position: absolute;width: 0%;top: 0;left: 0;background-color: "+a+";height: 100%;",l.style.cssText="font-family: Arial, sans-serif;line-height: 28px;height: 100%;width: 100%;top: 0;left: 0;text-align: center;position: absolute;font-size: 16px;font-weight: bold;text-shadow: 0px 0px 6px "+n+";color: "+o+";",r.bar=E,r.caption=l,r.container=s,r.type="DEFAULT"},t.create_simple_preloader=function(e){var t=null,_=null,n="#bf9221",o="#000";for(var i in e)switch(i){case"canvas_container_id":t=e.canvas_container_id;break;case"background_container_id":_=e.background_container_id;break;case"bg_color":o=e.bg_color;break;case"bar_color":n=e.bar_color;break;case"preloader_fadeout":r.fadeout=e.preloader_fadeout}var s=document.createElement("div"),E=document.createElement("div");s.id="simple_preloader_container";var c=document.createElement("div"),l=document.createElement("div"),T=document.getElementById(_);a=document.getElementById(t),s.style.cssText="z-index: 4;background-color: "+o+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;",E.style.cssText="position: absolute;left: 50%;top: 82%;width: 300px;height: 20px;margin-left: -150px;margin-top: -10px;border-style:solid;border-width:4px;border-color: #000;border-radius: 0px;",c.style.cssText="position: absolute;left: 0px;top: 1px;width: 0px;height: 18px;background-color: "+n+";border-radius: 0px;",l.style.cssText="position: absolute;left: 50%;top: 50%;width: 100%;height: 100%;margin-left: -150px;margin-top: -10px;text-align: center;font-size: 17px;font-weight: bold;color: #000;font-family: Verdana;"+E.appendChild(c),E.appendChild(l),s.appendChild(E),document.body.appendChild(s),r.type="SIMPLE",r.container=s,r.bar=c,r.caption=l,r.background=T},t.create_rotation_preloader=function(e){var t=null,_=null,n="rgba(0,0,0,0)",o="",i="",s="rgba(0,0,0,0)";for(var E in e)switch(E){case"canvas_container_id":t=e.canvas_container_id;break;case"background_container_id":_=e.background_container_id;break;case"frame_bg_color":n=e.frame_bg_color;break;case"bg_color":s=e.bg_color;break;case"frame_class":o=e.frame_class;break;case"anim_elem_class":i=e.anim_elem_class}var c=document.createElement("div"),l=document.createElement("div"),T=document.createElement("div"),d=document.createElement("div"),u=document.getElementById(_);a=document.getElementById(t),c.style.cssText="z-index: 4;background-color: "+s+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;",l.style.cssText="position: absolute;left: 50%;top: 50%;width: 117px;height: 117px;margin-left: -58px;margin-top: -58px;background-color: "+n+";",T.style.cssText="position: absolute;left: 0px;top: 0px;width: 100%;height: 100%;background-position: center;background-repeat: no-repeat;",d.style.cssText="position: absolute;width: 100%;height: 100%;text-align: center;margin-top: 38px;font-size: 36px;color: #ffffff;font-family: Arial;font-weight: bold;",T.className=i,l.appendChild(T),l.className=o,l.appendChild(d),c.appendChild(l),a.appendChild(c),r.type="ROTATION",r.container=c,r.anim_elem=T,r.caption=d,r.background=u},t.create_advanced_preloader=function(e){var t=e.img_width,_=e.preloader_width,n=e.canvas_container_id,o=_-t,i=_/o,s=document.getElementById(e.preloader_bar_id),E=document.getElementById(e.fill_band_id),c=document.getElementById(e.preloader_caption_id),l=document.getElementById(e.preloader_container_id),T=document.getElementById(e.background_container_id);a=document.getElementById(n),r.type="ADVANCED",r.bar=s,r.fill=E,r.ratio=i,r.caption=c,r.container=l,r.background=T},t.update_preloader=function(e){r.caption.innerHTML=e+"%","SIMPLE"==r.type?r.bar.style.width=e+"%":"ADVANCED"==r.type?(r.bar.style.width=e/r.ratio+"%",r.fill.style.width=100-e+"%"):"ROTATION"==r.type?r.anim_elem.style.transform="rotate("+e+"deg)":"DEFAULT"==r.type&&(r.bar.style.width=e+"%"),100==e&&(r.container.parentNode.removeChild(r.container),r.background&&r.background.parentNode.removeChild(r.background))}}var a=_(0),n=_(39),o=Object(a.a)("preloader",r);t.a=o},function(e,t,_){"use strict";function r(e,t){var _=Object(n.a)(e),r=Object(o.a)(e);t.shot=function(e,t){r.error_deprecated("shot","screen.shot"),_.shot(e,t)}}var a=_(0),n=_(50),o=_(1),i=Object(a.a)("screenshooter",r);t.a=i},function(e,t,_){"use strict";function r(e,t){var _=Object(n.a)(e);t.attach_move_cb=_.attach_move_cb,t.detach_move_cb=_.detach_move_cb,t.is_anchor=_.is_anchor,t.get_element_id=_.get_element_id,t.update=function(){_.update(!0)}}var a=_(0),n=_(55),o=Object(a.a)("anchors",r);t.a=o},function(e,t,_){"use strict";function r(e,t){var _=Object(o.a)(e),r=Object(i.a)(e),a=Object(s.a)(e);t.get_bone_tsr=function(e,t,r){return _.is_armature(e)?n.a(e,t)?(r||(r=new Float32Array(8)),n.b(e,t,!1,!1,r),r):(a.error('There is no bone: "',t,'" in "',e.name,'".'),null):null},t.get_bone_tsr_rel=function(e,t,r){return _.is_armature(e)?n.a(e,t)?(r||(r=new Float32Array(8)),n.b(e,t,!1,!0,r),r):(a.error('There is no bone: "',t,'" in "',e.name,'".'),null):null},t.set_bone_tsr=function(e,t,o){if(_.is_armature(e)){if(!n.a(e,t))return void a.error('There is no bone: "',t,'" in "',e.name,'".');n.c(e,t,o,!1),r.update_transform(e)}},t.set_bone_tsr_rel=function(e,t,o){if(_.is_armature(e)){if(!n.a(e,t))return void a.error('There is no bone: "',t,'" in "',e.name,'".');n.c(e,t,o,!0),r.update_transform(e)}}}var a=_(0),n=_(56),o=_(8),i=_(13),s=_(1),E=Object(a.a)("armature",r);t.a=E},function(e,t,_){"use strict";function r(e,t){var _=Object(n.a)(e);t.AT_ARRAYBUFFER=_.AT_ARRAYBUFFER,t.AT_ARRAYBUFFER_ZIP=_.AT_ARRAYBUFFER_ZIP,t.AT_JSON=_.AT_JSON,t.AT_JSON_ZIP=_.AT_JSON_ZIP,t.AT_TEXT=_.AT_TEXT,t.AT_AUDIOBUFFER=_.AT_AUDIOBUFFER,t.AT_IMAGE_ELEMENT=_.AT_IMAGE_ELEMENT,t.AT_AUDIO_ELEMENT=_.AT_AUDIO_ELEMENT,t.AT_VIDEO_ELEMENT=_.AT_VIDEO_ELEMENT,t.AT_SEQ_VIDEO_ELEMENT=_.AT_SEQ_VIDEO_ELEMENT,t.enqueue=function(e,t,r,a){e.length&&_.enqueue(e,t,r,a)}}var a=_(0),n=_(43),o=Object(a.a)("assets",r);t.a=o},function(e,t,_){"use strict";function r(e,t){var _=Object(n.a)(e),r=Object(o.a)(e),a=Object(i.a)(e),c=Object(s.a)(e);t.extract_vertex_array=function(e,t,n){if(!r.has_dyn_geom(e))return a.error("Wrong object:",e.name),null;var o=_.find_batch_material(e,t,"MAIN");if(o){var i=o.bufs_data;return i&&i.pointers&&("a_normal"==n&&i.pointers.a_tbn||i.pointers[n])?r.extract_array_float(i,n):(a.error("Attribute not found:"+n),null)}return a.error("Wrong material:",t),null},t.extract_index_array=function(e,t){if(!r.has_dyn_geom(e))return a.error("Wrong object:",e.name),null;var n=_.find_batch_material(e,t,"MAIN");if(n){var o=n.bufs_data;return o&&o.pointers?o.ibo_array:(a.error("Buffer data not found"),null)}return a.error("Wrong material:",t),null},t.update_vertex_array=function(e,t,n,o){if(!r.has_dyn_geom(e))return void a.error("Wrong object:",e.name);for(var i=["MAIN","SHADOW","COLOR_ID"],s=0;s<i.length;s++){var E=i[s],c=_.find_batch_material(e,t,E);if(c){var l=c.bufs_data;l&&l.pointers&&("a_normal"==n&&l.pointers.a_tbn||l.pointers[n])&&r.update_bufs_data_array(l,n,0,o)}}},t.override_geometry=function(e,t,n,o,i){if(!r.has_dyn_geom(e))return void a.error("Wrong object:",e.name);if(!(n instanceof Uint16Array||n instanceof Uint32Array))return void a.error("Wrong ibo_array type");if(!(o instanceof Float32Array))return void a.error("Wrong positions_array type");for(var s=["MAIN","SHADOW","COLOR_ID"],l=0;l<s.length;l++){var T=s[l],d=_.find_batch_material(e,t,T);if(d){var u=d.bufs_data;if(u){r.update_bufs_data_index_array(u,d.draw_mode,n);var f={};for(var P in u.pointers){var A=u.pointers[P],S=o.length/3*A.num_comp,p=r.get_vbo_type_by_attr_name(P);f[p]||(f[p]=0),f[p]+=S}var O=r.init_vbo_source_data(f);u.vbo_source_data=O;var v={};for(var P in u.pointers){var A=u.pointers[P],p=r.get_vbo_type_by_attr_name(P);switch(v[p]||(v[p]=0),P){case"a_position":r.vbo_source_data_set_attr(u.vbo_source_data,"a_position",o,v[p]),A.offset=v[p],A.length=o.length,v[p]+=A.length;break;case"a_tbn":var m;i&&(m=r.calc_shared_indices(n,o,o));var N=r.calc_normals(n,o,m);A.length=o.length/3*A.num_comp;for(var g=new Float32Array(A.length),R=0;R<g.length;R+=4)g[R]=1,g[R+3]=1;var I=E.d(N,g);r.vbo_source_data_set_attr(u.vbo_source_data,"a_tbn",I,v[p]),A.offset=v[p],v[p]+=A.length;break;default:A.offset=v[p],A.length=o.length/3*A.num_comp;var b=r.get_constructor_by_type(p),h=new b(A.length);r.vbo_source_data_set_attr(u.vbo_source_data,P,h,v[p]),v[p]+=A.length}}r.update_gl_buffers(u),c.assign_attribute_setters(d);var Y=_.find_batch_material_forked(e,d);Y&&Y.bufs_data&&(Y.bufs_data=u)}}}},t.set_shape_key_value=function(e,t,_){if(!r.check_shape_keys(e))return void a.error("Wrong object:",e.name);if(!r.has_shape_key(e,t))return void a.error("Wrong key name:",t);var n=parseFloat(_);r.apply_shape_key(e,t,n)},t.check_shape_keys=function(e){return r.check_shape_keys(e)},t.get_shape_keys_names=function(e){return r.check_shape_keys(e)?r.get_shape_keys_names(e):(a.error("Wrong object:",e.name),[])},t.get_shape_key_value=function(e,t){return r.check_shape_keys(e)?r.has_shape_key(e,t)?r.get_shape_key_value(e,t):(a.error("Wrong key name:",t),0):(a.error("Wrong object:",e.name),0)},t.draw_line=function(e,t,n){if(n=n||!1,!(t instanceof Float32Array))return void a.error("Wrong positions type");var o=_.get_first_batch(e);o&&(r.draw_line(o,t,n),c.assign_attribute_setters(o))}}var a=_(0),n=_(16),o=_(20),i=_(1),s=_(22),E=_(36),c=Object(a.a)("geometry",r);t.a=c},function(e,t,_){"use strict";function r(e,t){var _=Object(n.a)(e),r=Object(o.a)(e);t.draw_mixer_strip=function(e,t,a,n,o,i,s){r.error_deprecated("draw_mixer_strip","screen.draw_mixer_strip"),_.draw_mixer_strip(e,t,a,n,o,i,s)},t.plot_array=function(e,t,a,n,o,i,s){r.error_deprecated("plot_array","screen.plot_array"),_.plot_array(e,t,a,n,o,i,s)}}var a=_(0),n=_(51),o=_(1),i=Object(a.a)("hud",r);t.a=i},function(e,t,_){"use strict";function r(e,t){function _(){for(var e=p.get_active(),t=P.get_scene_objs(e,"LAMP",P.DATA_ID_ALL),_=null,r=0;r<t.length;r++){var a=t[r];if("SUN"==a.light.type){_=a;break}}if(_){var n=_.light.direction,o=T._38(Math.atan2(-n[1],n[0]))+90;o>180&&(o-=360);var i=T._38(Math.atan2(n[2],Math.sqrt(n[0]*n[0]+n[1]*n[1]))),s={};return s.hor_position=o,s.vert_position=i,s}return null}function r(e){for(var t=p.get_active(),_=P.get_scene_objs(t,"LAMP",P.DATA_ID_ALL),r=0;r<_.length;r++){var a=_[r];if("SUN"==a.light.type){var o=a;break}}if(!o)return void S.error("There is no sun on the scene");if("number"==typeof e.hor_position&&"number"==typeof e.vert_position){var i=T.T(180-e.hor_position),s=T.T(90-e.vert_position),E=o.render;O.set_rotation_euler(o,[s,0,i]);var c=new Float32Array(3),u=l.g(E.world_tsr);T._33(u,T.f,c);var f=l.j(E.world_tsr),A=d.length(f);d.copy(c,v),d.scale(v,A,v),O.set_translation(o,v),O.update_transform(o);var m=o.light;if(m.dynamic_intensity){var N=t.world.light_settings.environment_energy,g=t.world.horizon_color,R=t.world.zenith_color,I=Math.cos(Math.abs(s)),b=Math.max(Math.min(3*I,1),0)*m.default_energy,h=Math.max(I,.1)*N;n.d(m,b),p.set_environment_colors(t,h,g,R)}p.update_lamp_scene(o,t)}}function a(e){for(var t=p.get_active(),_=P.get_scene_objs(t,"LAMP",P.DATA_ID_ALL),r=0;r<_.length;r++){var a=_[r];if("SUN"==a.light.type){var n=a;break}}if(!n)return void S.error("There is no sun on the scene");f(e)}function u(e){return A.is_lamp(e)?e.light.type:(S.error("get_light_type(): Wrong object"),"")}function f(e){var t=e<12?15*e:15*(e-24),_=-Math.cos(e/12*Math.PI)*N,a={};a.hor_position=t,a.vert_position=_,r(a)}var P=Object(o.a)(e),A=Object(i.a)(e),S=Object(s.a)(e),p=Object(E.a)(e),O=Object(c.a)(e),v=new Float32Array(3),m={},N=60;t.get_lamps=function(e){var t=p.get_active(),_=P.get_scene_objs(t,"LAMP",P.DATA_ID_ALL);if(!e)return _;for(var r=[],a=0;a<_.length;a++){var n=_[a];n.light.type===e&&r.push(n)}return r},t.get_sun_params=_,t.set_sun_params=r,t.set_day_time=a,t.set_date=function(e){return m.y=e.getFullYear(),m.m=e.getMonth(),m.d=e.getDate(),m.y?1582==m.y&&9==m.m&&m.d>4&&m.d<15?void S.error("The dates 5 through 14 October, 1582, do not exist in the Gregorian system!"):void 0:void S.error("There is no year 0 in the Julian system!")},t.set_max_sun_angle=function(e){N=Math.min(Math.max(e,0),90)},t.get_light_params=function(e){if(!A.is_lamp(e))return S.error("get_light_params(): Wrong object"),null;var t=e.light,_=u(e);if(_)switch(_){case"SPOT":var r={light_type:_,light_color:new Float32Array(3),light_energy:t.energy,light_spot_blend:t.spot_blend,light_spot_size:t.spot_size,light_distance:t.distance};r.light_color.set(t.color);break;case"POINT":var r={light_type:_,light_color:new Float32Array(3),light_energy:t.energy,light_distance:t.distance};r.light_color.set(t.color);break;default:var r={light_type:_,light_color:new Float32Array(3),light_energy:t.energy};r.light_color.set(t.color)}return r||null},t.get_light_type=u,t.set_light_params=function(e,t){if(!A.is_lamp(e))return void S.error("set_light_params(): Wrong object");var _=e.light,r=p.get_active(),a=!1;"number"==typeof t.light_energy&&n.d(_,t.light_energy),"object"==typeof t.light_color&&n.b(_,t.light_color),"number"==typeof t.light_spot_blend&&(n.e(_,t.light_spot_blend),a=!0),"number"==typeof t.light_spot_size&&(n.f(_,t.light_spot_size),a=!0),"number"==typeof t.light_distance&&(n.c(_,t.light_distance),a=!0),p.update_lamp_scene(e,r),a&&p.update_all_mesh_shaders(r)},t.get_light_energy=function(e){return A.is_lamp(e)?e.light.energy:(S.error("get_light_energy(): Wrong object"),0)},t.set_light_energy=function(e,t){if(!A.is_lamp(e))return void S.error("set_light_energy(): Wrong object");var _=p.get_active();n.d(e.light,t),p.update_lamp_scene(e,_)},t.get_light_color=function(e,t){return A.is_lamp(e)?(t=t||new Float32Array(3),t.set(e.light.color),t):(S.error("get_light_color(): Wrong object"),null)},t.set_light_color=function(e,t){if(!A.is_lamp(e))return void S.error("set_light_color(): Wrong object");var _=p.get_active();n.b(e.light,t),p.update_lamp_scene(e,_)}}var a=_(0),n=_(57),o=_(12),i=_(8),s=_(1),E=_(10),c=_(13),l=_(6),T=_(2),d=_(3),u=Object(a.a)("lights",r);t.a=u},function(e,t,_){"use strict";function r(e,t){var _=Object(n.a)(e);t.append_custom_callback=function(e,t){_.append_custom_cb(e,t)},t.remove_custom_callback=function(e){_.remove_custom_cb(e)},t.run_entrypoint=function(e,t){_.run_ep(e,t)}}var a=_(0),n=_(59),o=Object(a.a)("logic_nodes",r);t.a=o},function(e,t,_){"use strict";function r(e,t){var _=Object(n.a)(e),r=Object(o.a)(e),a=Object(i.a)(e),u=Object(s.a)(e),f=Object(E.a)(e),P=Object(c.a)(e),A=Object(l.a)(e),S=Object(d.a)(e),p=r.defaults;t.inherit_material=function(e,t,_,r){if(!a.has_dyn_geom(_)||!a.has_dyn_geom(e))return void P.error('inherit_material(): both objects "'+e.origin_name+'" and "'+_.origin_name+'" must have the "Dynamic Geometry & Materials" flag enabled.');var n=e.mat_inheritance_data.original_mat_names.indexOf(t);if(-1==n)return void P.error('inherit_material(): material "'+t+'" not found on the object "'+e.origin_name+'".');var o=_.mat_inheritance_data.original_mat_names.indexOf(r);if(-1==o)return void P.error('inherit_material(): material "'+r+'" not found on the object "'+_.origin_name+'".');0==_._bpy_obj.data.submeshes[o].shade_tangs.length&&e.materials[n].use_tangent_shading&&P.warn('The target material "'+r+'" was exported without tangent shading data. However, the "'+t+'" material requires it. It\'s needed to enable the "Tangent Shading" option on the target material for correct rendering.'),u.inherit_material(e,t,_,r)},t.get_materials_names=function(e){var t=[];if(!f.is_dynamic_mesh(e))return P.error('get_materials_names(): Object "'+e.name+'" is not a dynamic MESH.'),t;for(var _=e.scenes_data,r=0;r<_.length;r++)for(var a=_[r].batches,n=0;n<a.length;n++){var o=a[n];if("MAIN"==o.type)for(var i=0;i<o.material_names.length;i++)-1==t.indexOf(o.material_names[i])&&t.push(o.material_names[i])}return t},t.set_diffuse_color=function(e,t,r){if(!f.is_dynamic_mesh(e))return void P.error('set_diffuse_color(): Object "'+e.name+'" is not a dynamic MESH.');var a=_.find_batch_material(e,t,"MAIN");if(!a)return void P.error('set_diffuse_color(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".');if(a.has_nodes)return void P.error("set_diffuse_color(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");a.diffuse_color.set(r);var n=_.find_batch_material_forked(e,t,"MAIN");n&&n.diffuse_color.set(r)},t.get_diffuse_color=function(e,t){var r=new Float32Array(4);if(!f.is_dynamic_mesh(e))return P.error('get_diffuse_color(): Object "'+e.name+'" is not a dynamic MESH.'),r;var a=_.find_batch_material(e,t,"MAIN");return a?a.has_nodes?(P.error("get_diffuse_color(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),r):(r.set(a.diffuse_color),r):(P.error('get_diffuse_color(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),r)},t.set_diffuse_intensity=function(e,t,r){if(!f.is_dynamic_mesh(e))return void P.error('set_diffuse_intensity(): Object "'+e.name+'" is not a dynamic MESH.');var a=_.find_batch_material(e,t,"MAIN");if(!a)return void P.error('set_diffuse_intensity(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".');if(a.has_nodes)return void P.error("set_diffuse_intensity(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");a.diffuse_intensity=r;var n=_.find_batch_material_forked(e,t,"MAIN");n&&(n.diffuse_intensity=r)},t.get_diffuse_intensity=function(e,t){if(!f.is_dynamic_mesh(e))return P.error('get_diffuse_intensity(): Object "'+e.name+'" is not a dynamic MESH.'),0;var r=_.find_batch_material(e,t,"MAIN");return r?r.has_nodes?(P.error("get_diffuse_intensity(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):r.diffuse_intensity:(P.error('get_diffuse_intensity(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),0)},t.set_specular_color=function(e,t,r){if(!f.is_dynamic_mesh(e))return void P.error('set_specular_color(): Object "'+e.name+'" is not a dynamic MESH.');var a=_.find_batch_material(e,t,"MAIN");if(!a)return void P.error('set_specular_color(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".');if(a.has_nodes)return void P.error("set_specular_color(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");a.specular_color.set(r);var n=_.find_batch_material_forked(e,t,"MAIN");n&&n.specular_color.set(r)},t.get_specular_color=function(e,t){var r=new Float32Array(3);if(!f.is_dynamic_mesh(e))return P.error('get_specular_color(): Object "'+e.name+'" is not a dynamic MESH.'),r;var a=_.find_batch_material(e,t,"MAIN");return a?a.has_nodes?(P.error("get_specular_color(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),r):(r.set(a.specular_color),r):(P.error('get_specular_color(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),r)},t.set_specular_color_factor=function(e,t,r){if(!f.is_dynamic_mesh(e))return void P.error('set_specular_color_factor(): Object "'+e.name+'" is not a dynamic MESH.');var a=_.find_batch_material(e,t,"MAIN");if(!a)return void P.error('set_specular_color_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".');if(a.has_nodes)return void P.error("set_specular_color_factor(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");a.specular_color_factor=r;var n=_.find_batch_material_forked(e,t,"MAIN");n&&(n.specular_color_factor=r)},t.get_specular_color_factor=function(e,t){if(!f.is_dynamic_mesh(e))return P.error('get_specular_color_factor(): Object "'+e.name+'" is not a dynamic MESH.'),0;var r=_.find_batch_material(e,t,"MAIN");return r?r.has_nodes?(P.error("get_specular_color_factor(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):r.specular_color_factor:(P.error('get_specular_color_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),0)},t.set_specular_intensity=function(e,t,r){if(!f.is_dynamic_mesh(e))return void P.error('set_specular_intensity(): Object "'+e.name+'" is not a dynamic MESH.');var a=_.find_batch_material(e,t,"MAIN");if(!a)return void P.error('set_specular_intensity(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".');if(a.has_nodes)return void P.error("set_specular_intensity(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");a.specular_params[0]=r;var n=_.find_batch_material_forked(e,t,"MAIN");n&&(n.specular_params[0]=r)},t.get_specular_intensity=function(e,t){if(!f.is_dynamic_mesh(e))return P.error('get_specular_intensity(): Object "'+e.name+'" is not a dynamic MESH.'),0;var r=_.find_batch_material(e,t,"MAIN");return r?r.has_nodes?(P.error("get_specular_intensity(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):r.specular_params[0]:(P.error('get_specular_intensity(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),0)},t.check_specular_intensity=function(e,t){P.error_once("check_specular_intensity() is deprecated, not needed anymore");var r=_.find_batch_material(e,t,"MAIN");return Boolean(r&&r.specular_params[0])},t.set_specular_hardness=function(e,t,r){if(!f.is_dynamic_mesh(e))return void P.error('set_specular_hardness(): Object "'+e.name+'" is not a dynamic MESH.');var a=_.find_batch_material(e,t,"MAIN");if(!a)return void P.error('set_specular_hardness(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".');if(a.has_nodes)return void P.error("set_specular_hardness(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");a.specular_params[1]=r;var n=_.find_batch_material_forked(e,t,"MAIN");n&&(n.specular_params[1]=r)},t.get_specular_hardness=function(e,t){if(!f.is_dynamic_mesh(e))return P.error('get_specular_hardness(): Object "'+e.name+'" is not a dynamic MESH.'),0;var r=_.find_batch_material(e,t,"MAIN");return r?r.has_nodes?(P.error("get_specular_hardness(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):r.specular_params[1]:(P.error('get_specular_hardness(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),0)},t.check_specular_hardness=function(e,t){P.error_once("check_specular_hardness() is deprecated, not needed anymore");var r=_.find_batch_material(e,t,"MAIN");return Boolean(r&&r.specular_params[1])},t.set_emit_factor=function(e,t,r){if(!f.is_dynamic_mesh(e))return void P.error('set_emit_factor(): Object "'+e.name+'" is not a dynamic MESH.');var a=_.find_batch_material(e,t,"MAIN");if(!a)return void P.error('set_emit_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".');if(a.has_nodes)return void P.error("set_emit_factor(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");a.emit=r;var n=_.find_batch_material_forked(e,t,"MAIN");n&&(n.emit=r)},t.get_emit_factor=function(e,t){if(!f.is_dynamic_mesh(e))return P.error('get_emit_factor(): Object "'+e.name+'" is not a dynamic MESH.'),0;var r=_.find_batch_material(e,t,"MAIN");return r?r.has_nodes?(P.error("get_emit_factor(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):r.emit:(P.error('get_emit_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),0)},t.set_ambient_factor=function(e,t,r){if(!f.is_dynamic_mesh(e))return void P.error('set_ambient_factor(): Object "'+e.name+'" is not a dynamic MESH.');var a=_.find_batch_material(e,t,"MAIN");if(!a)return void P.error('set_ambient_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".');if(a.has_nodes)return void P.error("set_ambient_factor(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");a.ambient=r;var n=_.find_batch_material_forked(e,t,"MAIN");n&&(n.ambient=r)},t.get_ambient_factor=function(e,t){if(!f.is_dynamic_mesh(e))return P.error('get_ambient_factor(): Object "'+e.name+'" is not a dynamic MESH.'),0;var r=_.find_batch_material(e,t,"MAIN");return r?r.has_nodes?(P.error("get_ambient_factor(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):r.ambient:(P.error('get_ambient_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),0)},t.set_diffuse_color_factor=function(e,t,r){if(!f.is_dynamic_mesh(e))return void P.error('set_diffuse_color_factor(): Object "'+e.name+'" is not a dynamic MESH.');var a=_.find_batch_material(e,t,"MAIN");if(!a)return void P.error('set_diffuse_color_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".');if(a.has_nodes)return void P.error("set_diffuse_color_factor(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");a.diffuse_color_factor=r;var n=_.find_batch_material_forked(e,t,"MAIN");n&&(n.diffuse_color_factor=r)},t.get_diffuse_color_factor=function(e,t){if(!f.is_dynamic_mesh(e))return P.error('get_diffuse_color_factor(): Object "'+e.name+'" is not a dynamic MESH.'),0;var r=_.find_batch_material(e,t,"MAIN");return r?r.has_nodes?(P.error("get_diffuse_color_factor(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):r.diffuse_color_factor:(P.error('get_diffuse_color_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),0)},t.set_alpha_factor=function(e,t,r){if(!f.is_dynamic_mesh(e))return void P.error('set_alpha_factor(): Object "'+e.name+'" is not a dynamic MESH.');var a=_.find_batch_material(e,t,"MAIN");if(!a)return void P.error('set_alpha_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".');if(a.has_nodes)return void P.error("set_alpha_factor(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");a.alpha_factor=r;var n=_.find_batch_material_forked(e,t,"MAIN");n&&(n.alpha_factor=r)},t.get_alpha_factor=function(e,t){if(!f.is_dynamic_mesh(e))return P.error('get_alpha_factor(): Object "'+e.name+'" is not a dynamic MESH.'),0;var r=_.find_batch_material(e,t,"MAIN");return r?r.has_nodes?(P.error("get_alpha_factor(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):r.alpha_factor:(P.error('get_alpha_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),0)},t.get_material_extended_params=function(e,t){if(!f.is_dynamic_mesh(e))return P.error('get_material_extended_params(): Object "'+e.name+'" is not a dynamic MESH.'),null;var r=_.find_batch_material(e,t,"MAIN");if(!r)return P.error('get_material_extended_params(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),null;if(r.has_nodes)return P.error("get_material_extended_params(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),null;var a={};return a.reflect_factor=r.reflect_factor,a.fresnel=r.fresnel_params[0],a.fresnel_factor=5*(1-r.fresnel_params[1]),a.parallax_scale=r.parallax_scale,a.parallax_steps=parseFloat(_.get_batch_directive(r,"PARALLAX_STEPS")[1]),a},t.set_material_extended_params=function(e,t,r){if(!f.is_dynamic_mesh(e))return void P.error('set_material_extended_params(): Object "'+e.name+'" is not a dynamic MESH.');var a=_.find_batch_material(e,t,"MAIN");if(!a)return void P.error('set_material_extended_params(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".');if(a.has_nodes)return void P.error("set_material_extended_params(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");var n=[a],o=_.find_batch_material_forked(e,t,"MAIN");o&&n.push(o);for(var i=0;i<n.length;i++)a=n[i],"number"==typeof r.reflect_factor&&(a.reflect_factor=r.reflect_factor),"number"==typeof r.fresnel&&(a.fresnel_params[0]=r.fresnel),"number"==typeof r.fresnel_factor&&(a.fresnel_params[1]=1-r.fresnel_factor/5),"number"==typeof r.parallax_scale&&(a.parallax_scale=r.parallax_scale),"number"==typeof r.parallax_steps&&(_.set_batch_directive(a,"PARALLAX_STEPS",A.glsl_value(r.parallax_steps)),_.update_shader(a),S.recalculate_draw_data(a))},t.get_water_material_params=function(e,t){if(!f.is_dynamic_mesh(e))return P.error('get_water_material_params(): Object "'+e.name+'" is not a dynamic MESH.'),null;var r=_.find_batch_material(e,t,"MAIN");if(!r||!r.water)return P.error('get_water_material_params(): Material "'+t+'" wasn\'t found on the object "'+e.name+"\" or it's not a water material."),null;if(r.has_nodes)return P.error("get_water_material_params(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),null;var a={};return a.shore_smoothing=p.shore_smoothing&&r.water_shore_smoothing&&Boolean(parseFloat(_.get_batch_directive(r,"SHORE_SMOOTHING")[1])),a.absorb_factor=parseFloat(_.get_batch_directive(r,"ABSORB")[1]),a.foam_factor=r.foam_factor,a.shallow_water_col=new Float32Array(3),a.shore_water_col=new Float32Array(3),a.shallow_water_col_fac=0,a.shore_water_col_fac=0,p.shore_distance&&(a.shallow_water_col.set(r.shallow_water_col),a.shore_water_col.set(r.shore_water_col),a.shallow_water_col_fac=r.shallow_water_col_fac,a.shore_water_col_fac=r.shore_water_col_fac),a.norm_uv_velocity=r.water_norm_uv_velocity,a.water_dynamic=p.water_dynamic&&r.water_dynamic&&Boolean(parseFloat(_.get_batch_directive(r,"DYNAMIC")[1])),a.sss_strength=parseFloat(_.get_batch_directive(r,"SSS_STRENGTH")[1]),a.sss_width=parseFloat(_.get_batch_directive(r,"SSS_WIDTH")[1]),a.waves_height=parseFloat(_.get_batch_directive(r,"WAVES_HEIGHT")[1]),a.waves_length=parseFloat(_.get_batch_directive(r,"WAVES_LENGTH")[1]),a.dst_noise_scale0=parseFloat(_.get_batch_directive(r,"DST_NOISE_SCALE_0")[1]),a.dst_noise_scale1=parseFloat(_.get_batch_directive(r,"DST_NOISE_SCALE_1")[1]),a.dst_noise_freq0=parseFloat(_.get_batch_directive(r,"DST_NOISE_FREQ_0")[1]),a.dst_noise_freq1=parseFloat(_.get_batch_directive(r,"DST_NOISE_FREQ_1")[1]),a.dir_min_shore_fac=parseFloat(_.get_batch_directive(r,"DIR_MIN_SHR_FAC")[1]),a.dir_freq=parseFloat(_.get_batch_directive(r,"DIR_FREQ")[1]),a.dir_noise_scale=parseFloat(_.get_batch_directive(r,"DIR_NOISE_SCALE")[1]),a.dir_noise_freq=parseFloat(_.get_batch_directive(r,"DIR_NOISE_FREQ")[1]),a.dir_min_noise_fac=parseFloat(_.get_batch_directive(r,"DIR_MIN_NOISE_FAC")[1]),a.dst_min_fac=parseFloat(_.get_batch_directive(r,"DST_MIN_FAC")[1]),a.waves_hor_fac=parseFloat(_.get_batch_directive(r,"WAVES_HOR_FAC")[1]),a},t.set_water_material_params=function(e,t,r){if(!f.is_dynamic_mesh(e))return void P.error('set_water_material_params(): Object "'+e.name+'" is not a dynamic MESH.');var a=_.find_batch_material(e,t,"MAIN");if(!a||!a.water)return void P.error('set_water_material_params(): Material "'+t+'" wasn\'t found on the object "'+e.name+"\" or it's not a water material.");if(a.has_nodes)return void P.error("set_water_material_params(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");var n=[a],o=_.find_batch_material_forked(e,t,"MAIN");o&&n.push(o);for(var i=0;i<n.length;i++){if(a=n[i],"boolean"==typeof r.shore_smoothing&&(p.shore_smoothing&&a.water_shore_smoothing&&r.shore_smoothing?_.set_batch_directive(a,"SHORE_SMOOTHING",1):_.set_batch_directive(a,"SHORE_SMOOTHING",0)),"number"==typeof r.absorb_factor){var s=A.glsl_value(parseFloat(r.absorb_factor));_.set_batch_directive(a,"ABSORB",s)}if("number"==typeof r.foam_factor&&p.foam&&(a.foam_factor=r.foam_factor),p.shore_distance&&("object"==typeof r.shallow_water_col&&a.shallow_water_col.set(r.shallow_water_col),"number"==typeof r.shallow_water_col_fac&&(a.shallow_water_col_fac=r.shallow_water_col_fac),"object"==typeof r.shore_water_col&&a.shore_water_col.set(r.shore_water_col),"number"==typeof r.shore_water_col_fac&&(a.shore_water_col_fac=r.shore_water_col_fac)),"number"==typeof r.norm_uv_velocity&&(a.water_norm_uv_velocity=r.norm_uv_velocity),p.water_dynamic&&a.water_dynamic){if("boolean"==typeof r.water_dynamic&&(r.water_dynamic?_.set_batch_directive(a,"DYNAMIC",1):_.set_batch_directive(a,"DYNAMIC",0)),"number"==typeof r.sss_strength){var E=A.glsl_value(parseFloat(r.sss_strength));_.set_batch_directive(a,"SSS_STRENGTH",E)}if("number"==typeof r.sss_width){var E=A.glsl_value(parseFloat(r.sss_width));_.set_batch_directive(a,"SSS_WIDTH",E)}if("number"==typeof r.waves_height){var c=A.glsl_value(parseFloat(r.waves_height));_.set_batch_directive(a,"WAVES_HEIGHT",c)}if("number"==typeof r.waves_length){var E=A.glsl_value(parseFloat(r.waves_length));_.set_batch_directive(a,"WAVES_LENGTH",E)}if("number"==typeof r.dst_noise_scale0){var l=A.glsl_value(parseFloat(r.dst_noise_scale0));_.set_batch_directive(a,"DST_NOISE_SCALE_0",l)}if("number"==typeof r.dst_noise_scale1){var T=A.glsl_value(parseFloat(r.dst_noise_scale1));_.set_batch_directive(a,"DST_NOISE_SCALE_1",T)}if("number"==typeof r.dst_noise_freq0){var d=A.glsl_value(parseFloat(r.dst_noise_freq0));_.set_batch_directive(a,"DST_NOISE_FREQ_0",d)}if("number"==typeof r.dst_noise_freq1){var u=A.glsl_value(parseFloat(r.dst_noise_freq1));_.set_batch_directive(a,"DST_NOISE_FREQ_1",u)}if("number"==typeof r.dir_min_shore_fac){var O=A.glsl_value(parseFloat(r.dir_min_shore_fac));_.set_batch_directive(a,"DIR_MIN_SHR_FAC",O)}if("number"==typeof r.dir_freq){var v=A.glsl_value(parseFloat(r.dir_freq));_.set_batch_directive(a,"DIR_FREQ",v)}if("number"==typeof r.dir_noise_scale){var m=A.glsl_value(parseFloat(r.dir_noise_scale));_.set_batch_directive(a,"DIR_NOISE_SCALE",m)}if("number"==typeof r.dir_noise_freq){var N=A.glsl_value(parseFloat(r.dir_noise_freq));_.set_batch_directive(a,"DIR_NOISE_FREQ",N)}if("number"==typeof r.dir_min_noise_fac){var g=A.glsl_value(parseFloat(r.dir_min_noise_fac));_.set_batch_directive(a,"DIR_MIN_NOISE_FAC",g)}if("number"==typeof r.dst_min_fac){var R=A.glsl_value(parseFloat(r.dst_min_fac));_.set_batch_directive(a,"DST_MIN_FAC",R)}if("number"==typeof r.waves_hor_fac){var I=A.glsl_value(parseFloat(r.waves_hor_fac));_.set_batch_directive(a,"WAVES_HOR_FAC",I)}}_.update_shader(a),S.recalculate_draw_data(a)}},t.set_line_params=function(e,t){if(!f.is_line(e))return void P.error('set_line_params(): Object "'+e.name+'" is not a LINE object.');var r=_.get_first_batch(e);if(!r)return void P.error("set_line_params(): Couldn't set line parameters!");T._16(t.color)&&r.diffuse_color.set(t.color),T._16(t.width)&&(r.line_width=t.width)},t.get_line_params=function(e){if(!f.is_line(e))return P.error('get_line_params(): Object "'+e.name+'" is not a LINE object.'),null;var t=_.get_first_batch(e);return t?{color:new Float32Array(t.diffuse_color),width:t.line_width}:(P.error("get_line_params(): Couldn't get line parameters!"),null)},t.set_nodemat_value=function(e,t,r){var a=f.is_dynamic_mesh(e),n=f.is_world(e),o=n?u.get_world_name(e):e.name;if(!a&&!n)return void P.error('set_nodemat_value(): Object "'+o+'" is not a dynamic MESH or WORLD.');if(a){var i=t[0],s=1,E=_.find_batch_material_any(e,i,"MAIN")||_.find_batch_material_any(e,i,"PARTICLES");if(!E)return void P.error('set_nodemat_value(): Material "'+i+'" wasn\'t found on the object "'+o+'".')}else if(n){var c=S.get_active(),i="",s=0,E=_.get_batch_by_type(e,"SKY",c);if(!E)return void P.error("set_nodemat_value(): Sky node material wasn't found on the world object \""+o+'".')}var l=_.name_list_to_node_name(t,s);u.set_nodemat_value(e,i,l,r)||P.error('set_nodemat_value(): Value node "'+t[t.length-1]+'" was not found in the object "'+o+'".')},t.get_nodemat_value=function(e,t){var r=f.is_dynamic_mesh(e),a=f.is_world(e),n=a?u.get_world_name(e):e.name;if(!r&&!a)return P.error('get_nodemat_value(): Object "'+n+'" is not a dynamic MESH or WORLD.'),0;if(r){var o=t[0],i=1,s=_.find_batch_material_any(e,o,"MAIN")||_.find_batch_material_any(e,o,"PARTICLES");if(!s)return P.error('get_nodemat_value(): Material "'+o+'" wasn\'t found on the object "'+n+'".'),0}else if(a){var E=S.get_active(),o="",i=0,s=_.get_batch_by_type(e,"SKY",E);if(!s)return P.error("get_nodemat_value(): Sky node material wasn't found on the world object \""+n+'".'),0}var c=_.name_list_to_node_name(t,i),l=u.get_nodemat_value(e,o,c);return null===l&&P.error('get_nodemat_value(): Value node "'+t[t.length-1]+'" was not found in the object "'+n+'".'),l},t.set_nodemat_rgb=function(e,t,r,a,n){var o=f.is_dynamic_mesh(e),i=f.is_world(e),s=i?u.get_world_name(e):e.name;if(!o&&!i)return void P.error('set_nodemat_rgb(): Object "'+s+'" is not a dynamic MESH or WORLD.');if(o){var E=t[0],c=1,l=_.find_batch_material_any(e,E,"MAIN")||_.find_batch_material_any(e,E,"PARTICLES");if(!l)return void P.error('set_nodemat_rgb(): Material "'+E+'" wasn\'t found on the object "'+s+'".')}else if(i){var T=S.get_active(),E="",c=0,l=_.get_batch_by_type(e,"SKY",T);if(!l)return void P.error("set_nodemat_rgb(): Sky node material wasn't found on the world object \""+s+'".')}var d=_.name_list_to_node_name(t,c);u.set_nodemat_rgb(e,E,d,r,a,n)||P.error('set_nodemat_rgb(): RGB node "'+t[t.length-1]+'" was not found in the object "'+s+'".')},t.get_nodemat_rgb=function(e,t,r){var a=f.is_dynamic_mesh(e),n=f.is_world(e),o=n?u.get_world_name(e):e.name;if(!a&&!n)return P.error('get_nodemat_rgb(): Object "'+o+'" is not a dynamic MESH or WORLD.'),null;if(a){var i=t[0],s=1,E=_.find_batch_material_any(e,i,"MAIN")||_.find_batch_material_any(e,i,"PARTICLES");if(!E)return P.error('get_nodemat_rgb(): Material "'+i+'" wasn\'t found on the object "'+o+'".'),null}else if(n){var c=S.get_active(),i="",s=0,E=_.get_batch_by_type(e,"SKY",c);if(!E)return P.error("get_nodemat_rgb(): Sky node material wasn't found on the world object \""+o+'".'),null}r||(r=new Float32Array(3));var l=_.name_list_to_node_name(t,s);return r=u.get_nodemat_rgb(e,i,l,r),r||P.error('get_nodemat_rgb(): RGB node "'+t[t.length-1]+'" was not found in the object "'+o+'".'),r},t.is_node_material=function(e,t){if(!f.is_dynamic_mesh(e))return P.error('is_node_material(): Object "'+e.name+'" is not a dynamic MESH.'),!1;var r=_.find_batch_material(e,t,"MAIN");return r?r.has_nodes:(P.error('is_node_material(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),!1)},t.is_water_material=function(e,t){if(!f.is_dynamic_mesh(e))return P.error('is_water_material(): Object "'+e.name+'" is not a dynamic MESH.'),!1;var r=_.find_batch_material(e,t,"MAIN");return r?r.water&&!r.has_nodes:(P.error('is_water_material(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),!1)}}var a=_(0),n=_(16),o=_(4),i=_(20),s=_(12),E=_(8),c=_(1),l=_(34),T=_(2),d=_(10),u=Object(a.a)("material",r);t.a=u},function(e,t,_){"use strict";function r(e,t){var _=new Float32Array(3);t.create_pline_from_points=function(e,t){var r=new Float32Array(6);return i.R(r,e),n.subtract(t,e,_),i.Q(r,_),r},t.create_pline_from_point_vec=function(e,t){var _=new Float32Array(6);return i.R(_,e),i.Q(_,t),_},t.create_pline=function(){return new Float32Array(6)},t.get_pline_directional_vec=i.M,t.get_pline_initial_point=i.N,t.set_pline_initial_point=i.R,t.set_pline_directional_vec=i.Q,t.line_plane_intersect=o._21,t.calc_pline_point=i.f,t.point_plane_dist=i.P,t.linear_tween=i.O,t.ease_in_quad=i.x,t.ease_out_quad=i.H,t.ease_in_out_quad=i.t,t.ease_in_cubic=i.k,t.ease_out_cubic=i.E,t.ease_in_out_cubic=i.q,t.ease_in_quart=i.y,t.ease_out_quart=i.I,t.ease_in_out_quart=i.u,t.ease_in_quint=i.z,t.ease_out_quint=i.J,t.ease_in_out_quint=i.v,t.ease_in_sine=i.A,t.ease_out_sine=i.K,t.ease_in_out_sine=i.w,t.ease_in_expo=i.m,t.ease_out_expo=i.G,t.ease_in_out_expo=i.s,t.ease_in_circ=i.j,t.ease_out_circ=i.D,t.ease_in_out_circ=i.p,t.ease_in_elastic=i.l,t.ease_out_elastic=i.F,t.ease_in_out_elastic=i.r,t.ease_in_back=i.h,t.ease_out_back=i.B,t.ease_in_out_back=i.n,t.ease_in_bounce=i.i,t.ease_out_bounce=i.C,t.ease_in_out_bounce=i.o}var a=_(0),n=_(3),o=_(2),i=_(41),s=Object(a.a)("math",r);t.a=s},function(e,t,_){"use strict";function r(e,t){var _=Object(n.a)(e),r=Object(o.a)(e),a=Object(i.a)(e);t.set_frame=function(e){if(e=s.M(e,_.get_frame_start(),_.get_frame_end()),_.check_logic_nodes())return void a.error("The active scene is using the Logic Editor.");_.set_frame(e,r.get_timeline())},t.get_frame=function(){return _.get_frame(r.get_timeline())},t.stop=function(){_.check_logic_nodes()&&a.warn("The active scene is using the Logic Editor. It may conflicts with your JS-code."),_.stop_nla()},t.play=function(e){_.check_logic_nodes()&&a.warn("The active scene is using the Logic Editor. It may conflicts with your JS-code."),_.play_nla(e)},t.is_play=function(){return _.is_play()},t.get_frame_start=function(){return _.get_frame_start()},t.get_frame_end=function(){return _.get_frame_end()},t.check_nla=function(){return _.check_nla()},t.check_logic_nodes=function(){return _.check_logic_nodes()},t.set_range=function(e,t){if(_.check_logic_nodes())return void a.error("The active scene is using the Logic Editor.");t=parseFloat(t)||_.get_frame_end(),e=parseFloat(e)||_.get_frame_end(),t=s.M(t,_.get_frame_start(),_.get_frame_end()),e=s.M(e,_.get_frame_start(),t),_.set_range(e,t)},t.reset_range=function(){if(_.check_logic_nodes())return void a.error("The active scene is using the Logic Editor.");_.reset_range()},t.set_cyclic=function(e){if(_.check_logic_nodes())return void a.error("The active scene is using the Logic Editor.");_.set_cyclic(e)},t.clear_callback=function(){if(_.check_logic_nodes())return void a.error("The active scene is using the Logic Editor.");_.clear_callback()}}var a=_(0),n=_(52),o=_(18),i=_(1),s=_(2),E=Object(a.a)("nla",r);t.a=E},function(e,t,_){"use strict";function r(e,t){var _=Object(n.a)(e),r=Object(o.a)(e),a=Object(i.a)(e),T=Object(s.a)(e),d=Object(E.a)(e),u=Object(c.a)(e);t.get_meta_tags=function(e){if(e)return r.get_meta_tags(e)},t.get_custom_prop=function(e){if(e)return r.get_custom_prop(e)},t.copy=function(e,t,a){return T.is_mesh(e)?T.is_dynamic(e)?_.has_dyn_geom(e)||_.check_shape_keys(e)||!a?-1==r.get_scene_objs(u.get_active(),"MESH",r.DATA_ID_ALL).indexOf(e)?(d.error('object "'+e.name+'" does not belong to the active scene.'),!1):(t=t||"",r.copy(e,t,a)):(d.error('object "'+e.name+'" has not dynamic geometry for deep copying.'),!1):(d.error('object "'+e.name+'" is not dynamic.'),!1):(d.error('object "'+e.name+'" is not of type "MESH".'),!1)},t.update_boundings=function(e){return T.is_mesh(e)?_.has_dyn_geom(e)||_.check_shape_keys(e)?void r.update_boundings(e):void d.error('object "'+e.name+'" has not dynamic geometry.'):void d.error('The type of the object "'+e.name+'" is not "MESH".')},t.get_parent=T.get_parent,t.get_dg_parent=T.get_dg_parent,t.is_mesh=T.is_mesh,t.is_armature=T.is_armature,t.is_speaker=T.is_speaker,t.is_camera=T.is_camera,t.is_lamp=T.is_lamp,t.is_empty=T.is_empty,t.is_line=T.is_line,t.is_world=T.is_world,t.get_selectable_objects=function(){return r.get_selectable_objects()},t.get_outlining_objects=function(){return r.get_outlining_objects()},t.is_dynamic=T.is_dynamic,t.set_wind_bending_params=function(e,t){if(!T.is_dynamic_mesh(e))return void d.error('The type of the object "'+e.name+'" is not "MESH" or it is not dynamic.');var _=e.render;if(!_.wind_bending)return void d.error('The "'+e.name+"\" object doesn't have wind bending parameters.");if("number"==typeof t.angle){var n=a.wb_angle_to_amp(l.T(t.angle),_.bb_original,_.world_tsr[3]);_.wind_bending_amp=n}"number"==typeof t.main_frequency&&(_.wind_bending_freq=t.main_frequency),"number"==typeof t.detail_frequency&&(_.detail_bending_freq=t.detail_frequency),"number"==typeof t.detail_amplitude&&(_.detail_bending_amp=t.detail_amplitude),"number"==typeof t.branch_amplitude&&(_.branch_bending_amp=t.branch_amplitude),r.set_hair_particles_wind_bend_params(e)},t.get_wind_bending_params=function(e){var t=e.render;if(!t.wind_bending)return null;var _={},r=l._38(a.wb_amp_to_angle(t.wind_bending_amp,t.bb_original,t.world_tsr[3]));return _.angle=r,_.main_frequency=t.wind_bending_freq,_.detail_frequency=t.detail_bending_freq,_.detail_amplitude=t.detail_bending_amp,_.branch_amplitude=t.branch_bending_amp,_},t.create_line=function(e){return r.create_line(e)},t.hide_all_by_data_id=function(e){for(var t=r.get_all_objects("ALL",e),_=0;_<t.length;_++)u.change_visibility(t[_],!0)},t.show_all_by_data_id=function(e){for(var t=r.get_all_objects("ALL",e),_=0;_<t.length;_++)u.change_visibility(t[_],!1)}}var a=_(0),n=_(20),o=_(12),i=_(16),s=_(8),E=_(1),c=_(10),l=_(2),T=Object(a.a)("objects",r);t.a=T},function(e,t,_){"use strict";function r(e,t){var _=Object(n.a)(e),r=Object(o.a)(e);t.set_size=function(e,t,a){if(!_.obj_has_psys(e,t))return void r.error('set_size(): Object "'+e.name+'" has not a particle system named "'+t+'"');_.set_size(e,t,a)},t.set_normal_factor=function(e,t,a){if(!_.obj_has_psys(e,t))return void r.error('set_normal_factor(): Object "'+e.name+'" has not a particle system named "'+t+'"');_.set_normal_factor(e,t,a)},t.set_factor=function(e,t,a){if(!_.obj_has_psys(e,t))return void r.error('set_factor(): Object "'+e.name+'" has not a particle system named "'+t+'"');a=Math.min(a,1),a=Math.max(a,0),_.set_factor(e,t,a)}}var a=_(0),n=_(47),o=_(1),i=Object(a.a)("particles",r);t.a=i},function(e,t,_){"use strict";function r(e,t){var _=new Float32Array(3);t.create=function(){return new Float32Array(3)},t.from_values=function(e,t,_){var r=new Float32Array(3);return r[0]=e,r[1]=t,r[2]=_,r},t.set=function(e,t,_,r){return r[0]=e,r[1]=t,r[2]=_,r},t.css_to_rgb=function(e,t,_,r){return r=r||new Float32Array(3),r[0]=e/255,r[1]=t/255,r[2]=_/255,n._56(r,r),r},t.rgb_to_css=function(e){var t=n._20(e,_);return[Math.round(255*t[0]),Math.round(255*t[1]),Math.round(255*t[2])]},t.rgb_to_css_hex=function(e){var t=function(e){var t=Math.round(255*e).toString(16);return 1==t.length?"0"+t:t},r=n._20(e,_);return"#"+t(r[0])+t(r[1])+t(r[2])}}var a=_(0),n=_(2),o=Object(a.a)("rgb",r);t.a=o},function(e,t,_){"use strict";function r(e,t){var _=Object(n.a)(e),r=Object(o.a)(e),a=Object(i.a)(e),l=Object(s.a)(e),T=Object(E.a)(e);t.play_video=function(e,t){t||(t=0);var n=a.get_video_texture(e,t);return n?r.get_active().b4w_use_nla&&a.video_allow_nla(n)?void _.error("NLA texture can't be controlled directly through API."):void a.play_video(n):void _.error('Texture with name "'+e+'" not found!')},t.pause_video=function(e,t){t||(t=0);var n=a.get_video_texture(e,t);return n?r.get_active().b4w_use_nla&&a.video_allow_nla(n)?void _.error("NLA texture can't be controlled directly through API."):void a.pause_video(n):void _.error('Texture with name "'+e+'" not found!')},t.reset_video=function(e,t){t||(t=0);var n=a.get_video_texture(e,t);return n?r.get_active().b4w_use_nla&&a.video_allow_nla(n)?void _.error("NLA texture can't be controlled directly through API."):void a.reset_video(n):void _.error('Texture with name "'+e+'" not found!')},t.get_canvas_ctx=function(e,t){if(l.is_mesh(e)){var r=a.get_canvas_context_by_object(e,t);if(r)return r;_.error("Couldn't find canvas texture with this name: "+t)}else _.error("Object must be type of mesh.");return null},t.update_canvas_ctx=function(e,t){if(!l.is_mesh(e))return _.error("Object must be type of mesh."),!1;var r=a.get_texture_by_name(e,t);return r&&"CANVAS"==r.source?(a.update_texture_canvas(r),!0):(_.error("Couldn't find canvas texture \""+t+'" in object "'+e.name+'".'),!1)},t.change_image=function(e,t,r,n){_.error_deprecated("change_image","replace_image"),n=n||function(){};var o=a.get_texture_by_name(e,t);if(!o)return _.error("Couldn't find texture \""+t+'" in object "'+e.name+'".'),void n(!1);if(o.is_movie)return _.error("Changing video textures is forbidden."),void n(!1);var i=Object(c.b)(r);if(o.img_full_filepath==i)return void n(!0);var s={id:r,type:T.AT_IMAGE_ELEMENT,url:r,request_method:"GET"},E=function(_,i,s,E){_?(a.change_image(e,o,t,_,r),n(!0)):n(!1)};T.enqueue([s],E,null,null)},t.replace_image=function(e,t,r,n){n=n||function(){};var o=a.get_texture_by_name(e,t);if(!o)return _.error("Couldn't find texture \""+t+'" in object "'+e.name+'".'),void n(!1);if(o.is_movie)return _.error("Changing video textures is forbidden."),void n(!1);if(!("src"in r))return _.error("Incorrect image."),void n(!1);var i=r.src;a.change_image(e,o,t,r,i)},t.get_texture_names=function(e){return l.is_mesh(e)?a.get_texture_names(e):(_.error("Object must be type of mesh."),[])}}var a=_(0),n=_(1),o=_(10),i=_(17),s=_(8),E=_(43),c=_(48),l=Object(a.a)("textures",r);t.a=l},function(e,t,_){"use strict";function r(e,t){t.version=n.e,t.version_str=n.f,t.type=n.d,t.date=n.a,t.date_str=n.b,t.get_build_version=n.c}var a=_(0),n=_(46),o=Object(a.a)("version",r);t.a=o}]);